var xmjd=mstrmojo&&mstrmojo.descriptors;var mstrmojo={helpPath:function(){return(mstrApp.helpUrl||"../help/")+"MSTRWeb/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/Content/";},helpPathMobileAdmin:function(){return(mstrApp.helpUrl||"../help/")+"MobileAdmin/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/";},upgradeHelpPath:function(){return(mstrApp.upgradeHelpUrl||"../help/")+"WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/Content/";},descriptors:xmjd||{},meta:{TP:"t",STP:"st"},emptyFn:function(){},tstid:function(B){var A;if(B){if(typeof (B)==="object"){A=B.tstid;}else{A=B;}}return A?'tstid="'+A+'"':"";},getMissingFn:function getMissingFn(){return function(){var C=this.scriptClass,A;try{for(A in this){if(this[A]===arguments.callee){C+="."+A;break;}}}catch(B){}throw new Error("Missing abstract method: "+C);};},now:function now(){return new Date().getTime();},usesFrames:false};(function(){mstrmojo.global=(function(){var F=function(){return this;};return F.call(null);}());mstrmojo.dbg=mstrmojo.emptyFn;mstrmojo.dbg_stack=mstrmojo.emptyFn;mstrmojo.dbg_xhr=mstrmojo.emptyFn;mstrmojo.dbg_profile=mstrmojo.emptyFn;mstrmojo.debugBundles=(function(){return(window.mstrConfig&&(mstrConfig.debugFlags!==undefined)&&((mstrConfig.debugFlags&4)>0));})();mstrmojo.platform={};mstrmojo.prompt={};mstrmojo.settings={};mstrmojo.models={datasets:{},template:{}};mstrmojo.ui={editors:{controls:{}},menus:{},pathbar:{}};mstrmojo.prefs={};mstrmojo.ACL={};mstrmojo.CMS={};mstrmojo.storage={};mstrmojo.maps={};mstrmojo.maps.androidmap={};mstrmojo.maps.jsmap={};mstrmojo.graph={};mstrmojo.IPA={};mstrmojo.IPA.Monitors={};mstrmojo.IPA.Alerts={};mstrmojo.IPA.Environment={};mstrmojo.IPA.Groups={};mstrmojo.IPA.Heartbeat={};mstrmojo.IPA.Managers={};mstrmojo.sm={};mstrmojo.sort={};mstrmojo.customviz={};mstrmojo.ME={};mstrmojo.architect={ui:{editors:{},panels:{},factories:{}},obj:{},menu:{},projectmanagement:{}};mstrmojo.warehouse={ui:{editors:{}},obj:{},dbroles:{},menu:{}};mstrmojo.plugins={};mstrmojo.AS={};mstrmojo.DI={controller:{},model:{},ui:{dialogs:{}}};mstrmojo.Refine={};mstrmojo.qb={bigquery:{},es:{},mdx:{},menu:{},thirdParty:{}};mstrmojo.WH={};mstrmojo.fe={};mstrmojo.txEditor={};mstrmojo.condTx={};mstrmojo.threshold={};mstrmojo.express={ui:{}};mstrmojo.rw={model:{},xtab:{}};mstrmojo.util={ui:{}};mstrmojo.android={controllers:{},factories:{},inputControls:{},large:{controllers:{},factories:{},ui:{}},medium:{controllers:{},factories:{},ui:{nativebar:{}}},selectors:{},ui:{},nativedialog:{}};mstrmojo.vi={controllers:{},factories:{},models:{editors:{}},enums:{},ui:{menus:{},editors:{fe:{},cm:{},nlp:{}},rw:{selectors:{},xtab:{}},tabs:{},toolbars:{},tutorial:{}},viz:{},util:{}};mstrmojo.onetier={controllers:{},vi:{acl:{},prefs:{model:{}},ui:{tutorial:{}}}};mstrmojo.config={vi:{},onetier:{}};mstrmojo.chart={common:{},enums:{},model:{enums:{}}};mstrmojo.nativeandroid={};mstrmojo.gm={touch:{}};mstrmojo.ngm={};mstrmojo.heatmap={vi:{}};mstrmojo.netviz={};mstrmojo.imagelayout={};mstrmojo.kpicard={layout:{},editors:{}};mstrmojo.iphone={};mstrmojo.winphone={};mstrmojo.mstr={search:{}};mstrmojo.mstr.ui={};mstrmojo.gmaps={basemap:{},graphic:{},geometry:{},layer:{svg:{},canvas:{},mapbox:{}}};mstrmojo.esrimap={};mstrmojo.mapbox={ui:{selectors:{}}};mstrmojo.examples={};mstrmojo.home={controllers:{},models:{},views:{},ui:{}};mstrmojo.workstation={pages:{}};mstrmojo.err=function D(I,H){var G=I.name+': "'+I.message+'"';if(mstrmojo.debug){if(I.fileName){G+=" at\n    "+I.fileName;}if(I.hasOwnProperty("lineNumber")){G+=": "+I.lineNumber;}else{if(I.hasOwnProperty("line")&&I.sourceURL){var F=I.sourceURL.split("/");G+="("+F[F.length>1?F.length-1:0]+":"+I.line+")";}}}this.dbg(G);if(mstrmojo.Dialog){mstrmojo.error({longDesc:I.message,code:I.code},H,{title:I.name});}else{window.alert(G);}};mstrmojo.confirm=function B(F){return window.confirm(F);};mstrmojo.alert=function E(F){window.alert(F);};var C=!!(/return true/.test(String(function(){return true;})));mstrmojo.mixin=function A(J,H){if(J){H=H||{};var I=/this\.\_super/;var G=function(N,M){return function L(){var P=this._super;this._super=M;var O=N.apply(this,arguments||[]);this._super=P;return O;};};var F=J.__onmixin__;if(F){delete J.__onmixin__;}var K;for(K in J){if((typeof J[K]==="function")&&(!C||I.test(J[K]))){H[K]=G(J[K],H[K]);}else{H[K]=J[K];}}if(F){J.__onmixin__=F;}}return H;};}());(function(){var $XHR;var $MISSING={};var getApp=function(){return mstrmojo.global.mstrApp||{};},getJsRoot=function(){return getApp().jsRoot||"../javascript/";},getJsBundlesRoot=function(){return getJsRoot()+"bundles/";},getJsMojoRoot=function(){return getApp().jsMojoRoot||"../javascript/mojo/js/source/";},getPluginRoot=function(){return getApp().pluginRoot||"../plugins/";},getPluginMojoRoot=function(){return getApp().pluginMojoRoot||getJsMojoRoot();},isIE=!!document.all;function getXHR(){$XHR=self.XMLHttpRequest?new XMLHttpRequest():(self.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null);}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){if(params.hasOwnProperty(p)){url[++x]=p+"="+encodeURIComponent(params[p]);}}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function syncXHR(method,baseUrl,params){var result=null;method=method.toUpperCase();if(!$XHR){getXHR();}if($XHR){try{var m=null,app=window.mstrApp;if(window.microstrategy!==undefined&&microstrategy){m=microstrategy;}params.taskContentType=params.taskContentType||"json";params.taskEnv="xhr";params.xts=mstrmojo.now();params=mstrmojo.addCSRFTokenToTaskParams(params);var ptp=(app&&app.persistTaskParams)||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}$XHR.open(method,appendUrlParams(method,baseUrl,params),false);$XHR.setRequestHeader("X-Requested-With","XMLHttpRequest");if(method!=="POST"){params=null;}else{params=encodeParams(params);$XHR.setRequestHeader("Content-type","application/x-www-form-urlencoded");}$XHR.send(params);result=$XHR.responseText||null;}catch(localerr){if(window.console){window.console.log(localerr);}}}return result;}function _jsGet(file,nullCheck){var js=mstrmojo.loadFileSync(file);if(js){try{eval(js);return nullCheck?!!verifyJsLoaded(nullCheck):true;}catch(localerr){window.alert("JavaScript compile error:\n\nFile: "+file+"\n\nError: "+localerr.message);}}return false;}mstrmojo.requiresBundle=function reqBundle(bundleName){return _jsGet(getJsBundlesRoot()+bundleName);};mstrmojo.requiresDepLib=function requiresDepLib(file,AMD){if(reqCache[file]){return true;}function isAMD(){return"function"===typeof define&&define.amd;}var AMDCache=window.define;if(!AMD&&isAMD()){delete window.define;}var value=_jsGet(file);reqCache[file]=true;window.define=AMDCache;return value;};mstrmojo.loadFileSync=function loadFileSync(file){var result=null;if(!$XHR){getXHR();}if($XHR){try{$XHR.open("GET",mstrmojo.util.version.getResourcePathWithVersion(file),false);$XHR.setRequestHeader("X-Requested-With","XMLHttpRequest");$XHR.send(null);result=$XHR.responseText||null;}catch(localerr){}if(!isIE&&$XHR.abort){$XHR.abort();}}return result;};mstrmojo.insertCSSLinks=function insertCSSLinks(files){var css,firsthead;if(files&&files.length>0){firsthead=document.getElementsByTagName("head")[0];files.forEach(function(file){css=document.createElement("link");css.setAttribute("id",file.replace(/[^a-zA-Z0-9]/g,""));css.setAttribute("rel","stylesheet");css.setAttribute("type","text/css");css.setAttribute("href",file);firsthead.appendChild(css);});}};mstrmojo.loader={loaded:{mstrmojo:true,"mstrmojo.loader":true},isLoaded:function isLd(fqcn){var isLoaded=!!verifyJsLoaded(fqcn);if(isLoaded){this.loaded[fqcn]=true;}return isLoaded;},load:function ld(fqcn){if($MISSING[fqcn]){return false;}if(this.loaded[fqcn]||this.isLoaded(fqcn)){return true;}if(_jsGet(this.fqcnToFile(fqcn),fqcn)){this.loaded[fqcn]=true;return true;}$MISSING[fqcn]=true;return false;},fqcnToFile:function fqcnToFile(fqcn){if(fqcn.match(/^mstrmojo\.plugins\./)){var pluginName=fqcn.substring(17,fqcn.indexOf(".",17)),pluginFile=pluginName+"/javascript/"+getPluginMojoRoot()+fqcn.replace("mstrmojo.plugins."+pluginName+".","").replace(/\./gm,"/");if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode()&&mstrConfig.dossierServerPluginNames&&mstrConfig.dossierServerPluginNames.indexOf(pluginName)>-1){fqcn=mstrApp.dossierServerBaseUrl+"plugins/"+pluginFile;}else{fqcn=getPluginRoot()+pluginFile;}}else{if(fqcn.match(/^mstrmojo\./)){fqcn=getJsMojoRoot()+fqcn.replace("mstrmojo.","").replace(/\./gm,"/");}else{fqcn=getJsRoot()+fqcn.replace(/\./gm,"/");}}return fqcn+".js";}};var $LOADER=mstrmojo.loader,isLoaded=$LOADER.loaded;var reqCache={},addPackagesToReqCache=function addPkg(n,ns){var ps=n.split("."),klen=ps.length,k;for(k=1;k<klen;k++){var s=ps.slice(0,k).join(".");if(!reqCache[s]){ns.push(s);reqCache[s]=true;}}},loadInputScripts=function loadInputScripts(ns){var jlen=ns.length,j;for(j=0;j<jlen;j++){if(!$LOADER.load(ns[j])){window.alert("Warning: Javascript class not found:\n"+ns[j]);break;}}};mstrmojo.requiresCls=function reqCls(){var argLen=arguments.length,ns=[],i,len;for(i=0,len=argLen;i<len;i++){var n=arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){addPackagesToReqCache(n,ns);}ns.push(n);reqCache[n]=true;}loadInputScripts(ns);return true;};mstrmojo.requiresClsP=function reqClsP(){var argLen=arguments.length,ns=[],pkgName=arguments[0],i,len;addPackagesToReqCache(pkgName,ns);for(i=1,len=argLen;i<len;i++){var n=pkgName+"."+arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){ns.push(n);reqCache[n]=true;}}loadInputScripts(ns);return true;};var $DESCRIPTORS=mstrmojo.descriptors,descPrefix="mstrWeb.";function populateDescriptors(ds){if(ds){var dlen=ds.length,di;for(di=0;di<dlen;di++){var d=ds[di];$DESCRIPTORS[d.key]=d.v;}}}mstrmojo.populateDescriptors=populateDescriptors;if(window.mstrConfig!==undefined){populateDescriptors(mstrConfig.mstrDescs&&mstrConfig.mstrDescs.descriptors);mstrConfig.mstrDescs=null;}if(window.mstrApp!==undefined){populateDescriptors(mstrApp.mstrDescs&&mstrApp.mstrDescs.descriptors);}var requestDescriptor=function(prefix,ids){var ns=[],len=ids.length,i;for(i=0;i<len;i++){var k=ids[i];if(k&&!($DESCRIPTORS.hasOwnProperty(prefix+k))){ns.push(k);}}if(ns.length>0){var response=syncXHR("POST",(window.mstrConfig&&mstrConfig.taskURL)||"taskProc",{taskId:"getDescriptors",keys:ns.join(","),prefix:prefix});if(response){var r=JSON.parse(response.replace(/\\'/g,"'"));populateDescriptors(r&&r.descriptors);}}};mstrmojo.requiresDescsWPrefix=function reqDescP(prefix){var args=[].slice.call(arguments);args[0]=null;requestDescriptor(prefix,args);};mstrmojo.requiresDescs=function reqDesc(){if(window.mstrConfig!==undefined&&!mstrConfig.onMobileDevice){requestDescriptor(descPrefix,arguments);}};mstrmojo.desc=function desc(descID,defText){if(descID!==null&&descID!==undefined){mstrmojo.requiresDescs(descID);if($DESCRIPTORS.hasOwnProperty(descPrefix+descID)){return $DESCRIPTORS[descPrefix+descID];}defText=defText||"No string descriptor found for descID="+descID;}var decDefText="["+defText+"]";$DESCRIPTORS[descPrefix+descID]=decDefText;return decDefText;};mstrmojo.descP=function descP(prefix,descID,defText){mstrmojo.requiresDescsWPrefix(prefix,descID);if($DESCRIPTORS.hasOwnProperty(prefix+descID)){return $DESCRIPTORS[prefix+descID];}defText=defText||"No string descriptor found for descID="+descID;var decDefText="*"+defText+"*";$DESCRIPTORS[prefix+descID]=decDefText;return decDefText;};mstrmojo.provide=function prv(fqcn,cls){isLoaded[fqcn]=!!cls;return cls;};mstrmojo.invalidateCls=function rel(fqcn){reqCache[fqcn]=false;isLoaded[fqcn]=false;this.invalidateJsLoaded(fqcn);};var mx=mstrmojo.mixin;mstrmojo.declare=function declare(SuperCls,mixins,config){function Constr(props){if((!props||!props.dontInit)&&this.init){this.init(props);}}if(SuperCls){Constr.prototype=new SuperCls({dontInit:true});Constr.prototype.constructor=Constr;}var proto=Constr.prototype;var cnt=(mixins&&mixins.length)||0,i;for(i=0;i<cnt;i++){mx(mixins[i],proto);}if(config){mx(config,proto);if(config.scriptClass){isLoaded[config.scriptClass]=true;}}return Constr;};mstrmojo.findAncestor=function findAncestor(src,property,value,limitClass){var ancestor=src&&src.parent;while(ancestor&&(!limitClass||!(ancestor instanceof limitClass))){var targetProperty=ancestor[property];if(targetProperty!==undefined){if(value!==undefined&&value!==null){if(targetProperty===value){return ancestor;}}else{return ancestor;}}ancestor=ancestor.parent;}return null;};mstrmojo.isDescendant=function isDescendant(parent,child){var ancestor;if(!child||!parent){return false;}ancestor=child.parent;while(ancestor){if(ancestor===parent){return true;}ancestor=ancestor.parent;}return false;};mstrmojo.getCSRFToken=function getCSRFToken(url){var tkn=null;try{if(url){if(url.indexOf("validateRandNum=")>=0){return tkn;}if(this.isUrlExternal(url)){return tkn;}}if(window.mstrApp&&mstrApp.validateRandNum){tkn=mstrApp.validateRandNum;}else{if(window.mstrConfig&&mstrConfig.validateRandNum){tkn=mstrConfig.validateRandNum;}else{if(window.microstrategy!==undefined&&microstrategy&&microstrategy.validateRandNum){tkn=microstrategy.validateRandNum;}}}}catch(err){}return tkn;};mstrmojo.addCSRFTokenToURL=function addCSRFTknToURL(url){if(!url){return"";}var tkn=mstrmojo.getCSRFToken(url);if(tkn&&tkn.length>0){if(url.indexOf("?")>-1){url+="&";}else{url+="?";}url+="validateRandNum="+tkn;}return url;};mstrmojo.addCSRFTokenToTaskParams=function addCSRFTknToTaskParams(params){if(params){var tkn=mstrmojo.getCSRFToken();if(tkn&&tkn.length>0){params.validateRandNum=tkn;}}return params;};mstrmojo.getInstance=function getInstance(config){var Clazz=mstrmojo.hash.walk(config.scriptClass,window);if(Clazz){return new Clazz(config);}return null;};mstrmojo.isUrlExternal=function isUrlExternal(url){var curURL=window.location.href;var servletName=window.mstrApp&&mstrApp.name,taskProcName=window.mstrConfig.taskURL&&mstrConfig.taskURL,isSameWebApp=(url.indexOf("?")===0||url.indexOf(servletName)===0||url.indexOf("./"+servletName)===0||url.indexOf(taskProcName)===0||url.indexOf("./"+taskProcName)===0||url.indexOf(curURL)===0||((curURL.indexOf("?")>0)&&(url.indexOf(curURL.substring(0,curURL.indexOf("?")))===0)));return !isSameWebApp;};mstrmojo.resolveFeature=function resolveFeature(feature){var features=mstrApp.features;return features&&features[feature];};mstrmojo.getStyleRoot=function getStyleRoot(){var c=mstrConfig||{},styleRoot=c.styleRoot||"../style";return styleRoot;};mstrmojo.getJsRoot=getJsRoot;function verifyJsLoaded(name){name=name.trim();var path=name.split(".");var o=window;for(var i=0;i<path.length;i++){o=o[path[i]];if(!o){break;}}return o;}mstrmojo.invalidateJsLoaded=function invalidateJsLoaded(name){var path=name&&name.trim().split("."),len=(path&&path.length)||0,tmp=window,i;for(i=0;i<len-1;i++){if(!tmp){return ;}tmp=tmp[path[i]];}if(tmp&&path[i]){tmp[path[i]]=undefined;}};mstrmojo.util.version=mstrmojo.provide("mstrmojo.util.version",{getResourcePathWithVersion:function(filePath){var versionStr="";if(window.mstrConfig){if(mstrConfig.webVersion){versionStr="?v="+mstrConfig.webVersion+(filePath.indexOf("plugins/")>=0&&mstrConfig.appVersion?"&apv="+mstrConfig.appVersion:"");}}return filePath+versionStr;}});}());
/* -- 
    Mojo JavaScript Library
    Copyright (C) 1996-2011 MicroStrategy Incorporated, All rights reserved. Confidential. 
-- */
mstrmojo.vi.enums.EnumDerivedElementType={LIST:1,CALCULATION:2,RESIDUE:4};mstrmojo.EnumDSSDisplayMode={RESERVED:0,GRID:1,GRAPH:2,ENGINE:3,TEXT:4,DATAMART:5,BASE:6,GRIDGRAPH:7,NONINTERACTIVE:8};(function(){var E=2147762227,A=2147762262,D=2147762890,B=2147762269;mstrmojo.RaErrorHandler=mstrmojo.provide("mstrmojo.RaErrorHandler",{embeddedErrStr:'<div class="{@cssClass}"><div class="error-content" style="visibility: visible"><div class="text ra-limit-err-title" style="padding-top: 0">'+mstrmojo.desc(16605,"QueryEngine encountered error:")+'</div><div class="text">'+mstrmojo.desc(16606,"Maximum number of result rows retrieved per MDX Query was exceeded. Please filter your data.")+"</div></div></div>",handleRAPopUpError:function C(G){var F=parseInt(G.code,10)+4294967296;if(F!==E&&F!==A&&F!==B){if(F===D){var H={shortDesc:'<div style ="font-weight:bold">'+mstrmojo.desc(16605,"QueryEngine encountered error:")+"</div>",longDesc:mstrmojo.desc(16606,"Maximum number of result rows retrieved per MDX Query was exceeded. Please filter your data.")};mstrmojo.error(H);}else{mstrmojo.alert(G.message);}}}});}());(function(){mstrmojo.func=mstrmojo.provide("mstrmojo.func",{composite:function D(E){if(!E||!E.length){return mstrmojo.emptyFn;}return function(){var F=E.length,G;for(G=0;G<F;G++){E[G].apply(this,arguments);}};},wrapMethods:function C(J,H){function I(L,K){K=K||{};mstrmojo.hash.forEach(L,function(M,N){K[N]=(K.hasOwnProperty(N)&&typeof M==="function")?mstrmojo.func.composite([M,K[N]]):M;});return K;}if(arguments.length<3){return I(J,H);}var F=arguments.length,G=[].slice.call(arguments,0,F-1).reverse(),E=arguments[F-1];mstrmojo.array.forEach(G,function(K){E=I(K,E);});return E;},override:function A(G,E){var F=function(J,I){return function H(){var L=this._super,K;this._super=I||mstrmojo.emptyFn;try{K=J.apply(this,arguments||[]);}finally{this._super=L;}return K;};};E=E||{};mstrmojo.hash.forEach(G,function(H,I){E[I]=F(H,E[I]);});return E;},throttle:function(G,I,E){var F,K,N,L=null,J=0,M=E||{};var H=function(){J=M.leading===false?0:mstrmojo.date.now();L=null;N=G.apply(F,K);F=K=null;};return function(){var O=mstrmojo.date.now();if(!J&&M.leading===false){J=O;}var P=I-(O-J);F=this;K=arguments;if(P<=0){clearTimeout(L);L=null;J=O;N=G.apply(F,K);F=K=null;}else{if(!L&&M.trailing!==false){L=setTimeout(H,P);}}return N;};},debounce:function(H,J,G){var M,L,F,K,N,E=mstrmojo.date.now;var I=function(){var O=E()-K;if(O<J){M=setTimeout(I,J-O);}else{M=null;if(!G){N=H.apply(F,L);F=L=null;}}};return function(){F=this;L=arguments;K=E();var O=G&&!M;if(!M){M=setTimeout(I,J);}if(O){N=H.apply(F,L);F=L=null;}return N;};},addMethods:function B(F,E){E=E||{};mstrmojo.hash.forEach(F,function(G,H){if(!E.hasOwnProperty(H)&&typeof G==="function"){E[H]=G;}});return E;}});}());(function(){mstrmojo._HasPopup=mstrmojo.provide("mstrmojo._HasPopup",{_mixinName:"mstrmojo._HasPopup",_lastOpened:null,openPopup:function A(G,E){var C=!!G&&(typeof G==="string")&&!G.match(/\./)&&!!this[G],D=mstrmojo.registry.ref(C?this[G]:G);if(D&&D.open){if(C){this[G]=D;}if(D.disposable!==false){this.addDisposable(D);}var J=D.slot&&this[D.slot];if(J){if(D.parent!==this){if(this.addChildren){this.addChildren([D]);}else{var I=false,F=D.domNode||D.placeholder;if(F&&typeof F==="string"){F=document.getElementById(F);}if(!F){I=true;F=document.createElement("span");D.placeholder=F;}if(I||(F.parentNode!==J)){J.appendChild(F);}}}}try{D.open(this,E);}catch(H){console.log("Error opening popup: "+H);}this._lastOpened=D;}},closePopup:function B(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}});}());mstrmojo.chart.model.enums.EnumDSSAxisName={DssAxisReserved:0,DssAxisRows:1,DssAxisColumns:2,DssAxisPages:3,DssAxisChapters:4,DssAxisAll:5,DssAxisDropZoneIndexRoot:8,DssAxisDropZoneIndexEnd:8+255,DssAxisDynamicShortcutRoot:300,DssAxisDynamicShortcutEnd:300+255};mstrmojo.chart.model.enums.EnumDSSBaseFormType={DssBaseFormReserved:0,DssBaseFormDateTime:1,DssBaseFormNumber:2,DssBaseFormText:3,DssBaseFormPicture:4,DssBaseFormUrl:5,DssBaseFormEmail:6,DssBaseFormHTMLTag:7,DssBaseFormDate:8,DssBaseFormTime:9,DssBaseFormSymbol:10,DssBaseFormBigDecimal:11};(function(){var C="xviPopopNode";function A(G){var H={};H[C]=G;return H;}mstrmojo.ui.menus._IsMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._IsMenuPopup",{init:function E(G){this._super(G);var J=this.popupConfig;if(!J){throw new Error("Cannot instantiate popup without supplying the popupConfig property.");}this.addDisposable(J);var H=mstrmojo.all[J.hostId],I=J.hostElement;if(J.isHostedWithin&&H&&I){H.addSlots(A(I));this.slot=C;}},closeAllMenus:function F(){var G=this.opener;if(G&&G.closePopup){G.closePopup();}if(G&&G.closeAllMenus){G.closeAllMenus();}},open:function B(H,G){if(this._super){this._super(H,G);}},close:function D(G){if(this.slot===C){this.opener.removeSlots(A(null));}if(this._super){this._super(G);}var H=mstrmojo.all[this.popupConfig.hostId];if(H){H.closePopup();}this.destroy();}});}());mstrmojo.gmaps.MapEnums={};mstrmojo.gmaps.EnumBaseMapType={Reserved:"-1",Esri:"1",Google:"2",Image:"3",Mapbox:"4"};mstrmojo.gmaps.EnumDefaultMapStyle={Esri:"Light Gray Map",Google:"0",Image:"",Mapbox:"mapbox://styles/microstrategy/cj4fnd0xu1ax82rnuq287rwvu"};mstrmojo.gmaps.EnumLanguageType={Local:"{name}",English:"{name_en}",Both:"{name_en}\n{name}"};mstrmojo.gmaps.EnumGraphicType={Marker:"1",Bubble:"2",Area:"3",Density:"4",Path:"5"};mstrmojo.gmaps.EnumMarkerType={Pin:"1",Square:"2",Diamond:"3",Image:"4",Circle:"5"};mstrmojo.gmaps.EnumPolygonSource={Cloud:"1",Custom:"2",MapBoxPolygon:"3",MapboxCustomShape:"4"};mstrmojo.gmaps.EnumShapeType={polygon:"polygon",multiPolygon:"multipolygon"};mstrmojo.gmaps.EnumGeometryType={Point:"Point",Extent:"2",Polygon:"Polygon"};mstrmojo.gmaps.EnumExtraCfgTaskId={Esri:"getESRIExtraConfig",Google:"getGoogleExtraConfig"};mstrmojo.gmaps.EnumGlobalCfgName={Esri:"esriConfig",Google:"googleConfig"};mstrmojo.gmaps.EnumThresholdType={Default:-1,Number:2,Text:3,Image:4,Url:5,QuickSymbol:10};mstrmojo.gmaps.EnumPropertyType={applyThreshold:"at",clusterMode:"mc",clusterRadius:"cr",clusterMaxZoom:"cmz",shapeFile:"lid",mapStyle:"dv",languageType:"lang",themeType:"dms",markerType:"mtp",zoomSetting:"rosa",legendSwitch:"ls",tooltipSwitch:"ts",legendWidthScale:"lwr",imageUrl:"mstyl",needMapToolbar:"mt",attributeId:"atf",useAttributeForm:"af",showZoomBtns:"zb",showAffinityLines:"da",showArcsLines:"dal",maxLineThickness:"lwm",maxBubbleSize:"mbs",useAbsolute:"mss",customInfoWinTpl:"iwd",pathColor:"pcp",affinityLineGrid:"ag",collapseLegend:"clgd",legendSize:"lgds",satf:"satf",dm:"dm",mvo:"mvo",baseMapType:"bmt",editingLayerIdx:"elx",mapGeoExtent:"mext",graphicType:"gtp",layerName:"ln",layerIdx:"lx",isRemoved:"ird",isHidden:"ih",enableZoomThroughLayer:"eztl",minLayerZoomLvl:"minlzl",maxLayerZoomLvl:"maxlzl",MAX_SIZE_TYPE:"maxst",MAX_SIZE_VALUE:"maxsv",MIN_SIZE_TYPE:"minst",MIN_SIZE_VALUE:"minsv",showMapLable:"mlb",mapLabelOnTop:"mlbt",distUnit:"mdu",geoAttribute:"ga",latitude:"lat",longitute:"lng",slice:"slc",angle:"amt",colorby:"cmt",sizeby:"smt",tooltip:"tooltip",geometry:"gmt",keepZoomAndPos:"kzp",zoomLevel:"mz",mapCenter:"mp",mapBearing:"mbr",mapPitch:"mpt",dirtyVp:"dirtyVp",plotMapBasedOn:"pmbo",tooltipForms:"ttpmf",colorByOpacity:"cbo"};mstrmojo.gmaps.EnumGeographicRole={EnumGeographicRoleNone:"0",EnumGeographicRoleCity:"1",EnumGeographicRoleState:"2",EnumGeographicRoleCountry:"3",EnumGeographicRoleLocation:"4",EnumGeographicRoleLatitiude:"5",EnumGeographicRoleLongitude:"6",EnumGeographicRoleOther:"7",EnumGeographicRoleZipCode:"8",EnumGeographicRoleCounty:"9",EnumGeographicRoleLastOne:"10",EnumGeographicRoleGeometry:"11"};mstrmojo.gmaps.EnumClusterMode={MOBILE_OFF:"0",MOBILE_ON:"1",ON:"2",OFF:"3",PIE:"4"};mstrmojo.gmaps.EnumZoomBehavior={Keep:"0",Automatic:"1"};mstrmojo.gmaps.EnumDistUnitType={KM:"0",Miles:"1"};mstrmojo.gmaps.EnumDataLabel={DATA_LABEL_SHOW:"dlShw",DATA_LABEL_SHOW_ALL:"dlShwAll",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle",DATA_LABEL_FONT_HALO_COLOR:"dlFntHaloClr",DATA_LABEL_FONT_HALO_WIDTH:"dlFntHaloWidth"};mstrmojo.gmaps.EnumShapeFormatting={SHAPE_FORMAT_FILL_COLOR:"shapeClr",SHAPE_FORMAT_FILL_OPACITY:"shapeFillTrans",SHAPE_FORMAT_BORDER_COLOR:"shapeLineClr",SHAPE_FORMAT_BORDER_STYLE:"shapeLineStyle"};mstrmojo.gmaps.EnumCombinedLineStyle={NONE:99,THIN:1,THICK:2,DASHED:3,DOTTED:4};mstrmojo.gmaps.EnumDefaultShapeFormatStyle={FILL_COLOR:"#436CD3",FILL_OPACITY:"85",FILL_OPACITY_VALUE:"0.85",FILL_OPACITY_FACTOR_HOVER:0.75,FILL_OPACITY_FACTOR_UNSEL:0.5,BORDER_STYLE:mstrmojo.gmaps.EnumCombinedLineStyle.THIN,BORDER_STYLE_CIRCLE:mstrmojo.gmaps.EnumCombinedLineStyle.NONE,BORDER_COLOR:"#FFFFFF",BORDER_WIDTH:"1"};mstrmojo.gmaps.DEFAULT_DATA_LABEL_PROPS={dlShw:[0],dlShwAll:[false],dlFntFml:["Arial"],dlFntSz:["8pt"],dlFntStyle:[0],dlFntClr:[0]};mstrmojo.gmaps.EnumDataLabelShowOption={NONE:0,SHOW_TEXT:1,SHOW_VALUE:2,SHOW_BOTH:3};mstrmojo.gmaps.MarkerAlignOption={CENTER:0,TOP:1,LEFT:2,RIGHT:3,BOTTOM:4,TOP_LEFT:5,TOP_RIGHT:6,BOTTOM_LEFT:7,BOTTOM_RIGHT:8};mstrmojo.gmaps.EnumToolbarButtonType={DRILL:1,SINGLE_SELECT:2,RECTANGLE_SELECT:4,EDIT_INFO_WINDOW:8,CLEAR_ALL:16,AFFINITY:32,FREE_SELECT:64,CIRCLE_SELECT:128,ZOOM:256,LAYERS_SELECT:512,KEEP_ONLY:1024,EXCLUDE:2048,SHOW_DATA:4096,SEARCH_BAR:8192,MAP_STYLE:16384};mstrmojo.gmaps.EnumToolbarState={NORMAL:0,SINGLE_SELECT:1,RECTANGLE_SELECT:2,ZOOM:3,AFFINITY:4,FREE_SELECT:5,CIRCLE_SELECT:6,CLEAR_ALL:7,LAYERS_SELECT:8,MARKERTYPE:9,CLUSTER:10,MAP_TYPE:11};mstrmojo.gmaps.EnumActions={rename:"renameUnit",remove:"removeDropZoneUnit",add:"addDropZoneUnit",addForm:"addForm",removeForm:"removeForm"};mstrmojo.gmaps.TARGET_MAPOPTIONS=1;mstrmojo.gmaps.TARGET_FORMATTING_LAYERS=2;mstrmojo.gmaps.SelectionHashType={PRIMARY:0,TEMPLATE_SELECTION:1,EDITING_LAYER:2,RMC_LAYER:3};mstrmojo.gmaps.EnumTransformState={ReadyToUse:-1,UseExistingLine:0,CrossFromExistingToNewLine:1,UseNewLine:2,CrossFromNewToExistingLine:3};mstrmojo.gmaps.EnumDrillLinkAnswerType={SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,DYNAMIC_OR_SAME_PROMPT:9};mstrmojo.gmaps.EnumMinSizeType={PROPORTIONAL:1,FULL_RANGE:2,ADJUSTED_RANGE:3};mstrmojo.gmaps.EnumMaxSizeType={AUTOMATIC:1,MANUAL:2};mstrmojo.gmaps.EnumDynamicZoomStatus={INIT:0,NO_GEO_ATTR:1,FIRST_ADD_GEO_ARR:2,FIRST_GEO_ADD_FINISHED:3};mstrmojo.gmaps.ZoomAnimationDelta=0.15;mstrmojo.gmaps.LAYER_INDEX_MAX=100;mstrmojo.gmaps.LASSOLAYER_ZINDEX=mstrmojo.gmaps.LAYER_INDEX_MAX+1;mstrmojo.gmaps.ZOOMBTN_ZINDEX=mstrmojo.gmaps.LAYER_INDEX_MAX+50;mstrmojo.gmaps.ENABLE_MAX_MIN_SIZE_CONTROL=true;mstrmojo.gmaps.EnumRenderMethod={svg:"svg",canvas:"canvas",mapbox:"mapbox"};mstrmojo.gmaps.EnumLayerZoneSource={DROP_ZONE:"dzpn",PROPERTY_PANEL:"pppn"};mstrmojo.gmaps.CustomShapeId="3000";(function(){var E=new RegExp("^[A-Z0-9]{8}[A-Z0-9]{4}[A-Z0-9]{4}[A-Z0-9]{4}[A-Z0-9]{12}$","i");var A=2147483648;var G=Array.apply(null,Array(256)).map(function(H,I){return(I<16?"0":"")+I.toString(16).toUpperCase();});var F=(window.crypto&&window.crypto.getRandomValues)?function(){var H=new Uint32Array(4);window.crypto.getRandomValues(H);return{d0:H[0],d1:H[1],d2:H[2],d3:H[3]};}:function(){return{d0:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d1:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d2:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d3:Math.abs(Math.floor(Math.random()*A)^(+new Date()))};};function D(H){var L=H.d0,K=H.d1,J=H.d2,I=H.d3;return G[L&255]+G[L>>8&255]+G[L>>16&255]+G[L>>24&255]+G[K&255]+G[K>>8&255]+G[K>>16&15|64]+G[K>>24&255]+G[J&63|128]+G[J>>8&255]+G[J>>16&255]+G[J>>24&255]+G[I&255]+G[I>>8&255]+G[I>>16&255]+G[I>>24&255];}mstrmojo.UUID=mstrmojo.provide("mstrmojo.UUID",{create:function C(){return D(F());},isUUID:function B(H){return H&&E.test(H.toString());}});mstrmojo.UUID.EMPTY="00000000000000000000000000000000";}());mstrmojo.chart.enums.EnumFontStyle={FS_NORMAL:0,FS_BOLD:1,FS_ITALIC:2,FS_BOTH:3,FS_UNDERLINE:4,FS_STRIKETHROUGH:8};mstrmojo.vi.controllers.EnumEvents={UPDATE_TOC:"updateTOC",MANIPULATE_LAYOUT:"layoutManipulation",MANIPULATE_PANEL:"panelManipulation",LAST_MODIFIED_CHANGE:"lastModifiedChange",CHANGE_COVER_IMAGE:"changeCoverImage",WSITEM_DRAG_OVER:"WSItemDragOver",WSITEM_DRAG_ENTER:"WSItemDragEnter",WSITEM_DRAG_EXIT:"WSItemDragExit",WSITEM_DROP:"WSItemDrop",CONTENTS_PANEL_VISIBILITY_CHANGE:"contentPanelVisibilityChange",DO_LAYOUT:"doLayout"};(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};}());(function(){mstrmojo.vi.ui.theme=mstrmojo.provide("mstrmojo.vi.ui.theme",{getThemeClass:function A(){var D=this.parent||this.opener,C="",B;while(D){var E=D.themeClassName;if(E){C=E;break;}B=D.parent||D.opener;if(B===D){break;}D=B;}return C;}});}());(function(){mstrmojo.vi.ui._MonitorsTocPage=mstrmojo.provide("mstrmojo.vi.ui._MonitorsTocPage",{tocPanel:null,currentLayoutKey:undefined,currentPanelKey:undefined,onTocPageChange:function(B){if(B.value){this.currentLayoutKey=B.value.layoutKey;this.currentPanelKey=B.value.panelKey;}if(this._super){this._super(B);}},init:function A(B){this._super(B);if(!this.tocPanel){throw new Error("You must pass the tocPanel when instantiating mstrmojo.vi.ui._MonitorsTocPage.");}if(this.tocPanel.attachEventListener){this.tocPanel.attachEventListener("displayPageInfoChange",this.id,"onTocPageChange");}}});}());(function(){mstrmojo.boxmodel=mstrmojo.provide("mstrmojo.boxmodel",{rangeIntersect:function E(J,H,I,G){if(J<I){return I<=H;}if(J>I){return J<=G;}return true;},px2Inches:function C(H,G){G=parseInt(G,10);return mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep).format(parseFloat((G/H.zf/H.dpi).toFixed(4)));},offset:function F(I,H){var L=I,G=0,K=0;while(I){G+=I.offsetLeft;K+=I.offsetTop;I=I.offsetParent;if(I===H){break;}}var J;for(J=L&&L.parentNode;J&&J!==H;J=J.parentNode){if(J.scrollTop){K-=J.scrollTop;}if(J.scrollLeft){G-=J.scrollLeft;}}return{left:G,top:K};},convert2px:function D(K,I){if(!/px$/.test(I)){var H=document.createElement("img"),G=H.style,J;G.zIndex=-1;G.left=I;K.appendChild(H);J=G.pixelLeft;K.removeChild(H);return J+"px";}return I;},getEdgeQuadrantByPoint:function B(I,H){var G=H.x-I.x,M=H.y-I.y,J=I.w,L=I.h,K=[["Left","Bottom"],["Top","Right"]];if(M>L/J*G){K=K[0];}else{K=K[1];}return(M<-L/J*G+L)?K[0]:K[1];},isPtInPolygon:function A(I,K){var G=I.x,J=I.y,H=false;K.forEach(function(N,L){var M=K[L-1]||K[K.length-1];if((N.y>=J)!==(M.y>=J)){if((G<(M.x-N.x)*(J-N.y)/(M.y-N.y)+N.x)){H=!H;}}});return H;}});}());mstrmojo.vi.viz.EnumDSSDropZones={Reserved:0,Rows:1,Columns:2,XAxis:3,YAxis:4,BreakBy:5,SliceBy:6,ColorBy:7,SizeBy:8,AdditionalMetrics:9,Angle:10,Grouping:11,GeoAttribute:12,Layout:13,FromItem:14,ToItem:15,ItemSize:16,Latitude:17,Longitude:18,Metric:19,Trend:20,Geometry:21};mstrmojo.mstr.EnumDSSXMLObjectTypes={Generic:-2,Unknown:-1,Reserved:0,Filter:1,Template:2,ReportDefinition:3,Metric:4,Style:6,AggMetric:7,Folder:8,SubscriptionDevice:9,Prompt:10,Function:11,Attribute:12,Fact:13,Dimension:14,Table:15,DatamartReport:16,FactGroup:17,Shortcut:18,Resolution:19,Monitor:20,AttributeForm:21,Schema:22,Format:23,Catalog:24,CatalogDefn:25,Column:26,PropertySet:28,DBRole:29,DBLogin:30,DBConnection:31,Project:32,ServerDef:33,User:34,Configuration:36,Request:37,Script:38,Search:39,SearchFolder:40,Datamart:41,FunctionPackageDefinition:42,Role:43,SecurityRole:44,Locale:45,Consolidation:47,ConsolidationElement:48,ScheduleEvent:49,ScheduleObject:50,ScheduleTrigger:51,Link:52,DbTable:53,TableSource:54,DocumentDefinition:55,DrillMap:56,DBMS:57,MDSecurityFilter:58,PromptAnswer:59,PromptAnswers:60,ObjectTag:65,ReservedLastOne:66};(function(){mstrmojo.hash=mstrmojo.provide("mstrmojo.hash",{copy:function B(S,R){if(S){R=R||{};var U;for(U in S){R[U]=S[U];}}return R;},copyProps:function C(U,W,R){R=R||{};if(W){var V=(U&&U.length)||0,S;for(S=0;S<V;S++){var X=U[S];if(W[X]!==undefined){R[X]=W[X];}}}return R;},forEach:function I(V,U,S){if(V){var R;for(R in V){if(S){if(U.call(S,V[R],R,V)===false){break;}}else{if(U(V[R],R,V)===false){break;}}}}return V;},walk:function P(W,S){if(!S){S=mstrmojo.global;}var V=W.split(".");if(V.length===1){return S[W];}var U=(V&&V.length)||0,R;for(R=0;R<U;R++){S=S[V[R]];if(!S){break;}}return S;},isEmpty:function F(S){if(!S){return true;}var R;for(R in S){if(S[R]!==null&&S[R]!==undefined){return false;}}return true;},clear:function G(S){if(S){var R;for(R in S){delete S[R];}}return S;},any:function J(V,W){var U;if(V){var S=this.keyarray(V);if(S.length>0){var R=S[0];U=W?R:V[R];}}return U;},clone:function M(W){if(!W){return null;}var Y;if(W.constructor===Array){Y=W.concat();var X=Y[0];if(X&&typeof X==="object"){var R=Y.length,V;for(V=0;V<R;V++){Y[V]=this.clone(W[V]);}}}else{Y={};var U;for(U in W){var S=W[U];if(S&&typeof S==="object"){Y[U]=this.clone(S);}else{Y[U]=S;}}}return Y;},cloneArray:function E(S){var U=[],R=(S&&S.length)||0,V;for(V=0;V<R;V++){U[V]=this.clone(S[V]);}return U;},keyarray:function K(U,V){var R=[],S;if(U){if(Object.keys&&!V){R=Object.keys(U);}else{for(S in U){R.push(V?Number(S):S);}}}return R;},valarray:function L(U){var R=[];if(U){var S;for(S in U){R.push(U[S]);}}return R;},equals:function Q(Z,Y){var S=mstrmojo.hash,X=(Z&&Y)||(!Z&&!Y&&(Z===Y));if(X&&Z){X=(Z.constructor===Y.constructor);if(X){if(Z.constructor===Array){var W=Z.length;X=(W===Y.length);if(X&&W){var U;for(U=0;U<W;U++){X=X&&S.equals(Z[U],Y[U]);}}}else{if(typeof Z==="object"){var a=S.keyarray(Z),V=S.keyarray(Y);X=a.length===V.length;if(X){var R;for(R in Z){X=X&&(S.equals(Z[R],Y[R]));}}}else{X=(Z===Y);}}}}return X;},obj2array:function O(X){var Y;for(Y in X){var W=X[Y];if(W&&typeof W==="object"){X[Y]=this.obj2array(W);}}var S=X.isArray;if(S!==undefined&&S===true){var V=[],R=X.length,U;for(U=0;U<R;U++){V.push(X[U]);}return V;}return X;},min:function D(V,W,X){var R=null,U;if(V){for(U in V){var S=W?V[U]:U;if(X){S=Number(S);}if((R===null)||(S<R)){R=S;}}}return R;},max:function N(V,W,X){var R=null,U;if(V){for(U in V){var S=W?V[U]:U;if(X){S=Number(S);}if((R===null)||(S>R)){R=S;}}}return R;},make:function A(S,U,R){if(!S||!U){return null;}if(S.attachEventListener){return S;}if(U.makeObservable){S=U.makeObservable(S,R)||S;}else{this.copy(U.prototype,S);if(S.init){S=S.init(R)||S;}}return S;},mergeHashes:function H(R,S){R=this.clone(R)||{};if(S){mstrmojo.array.forEach(mstrmojo.array.distinct(this.keyarray(S).concat(this.keyarray(R))),function(U){var W=R[U],V=S[U];if(W===undefined){R[U]=V;}else{if(W&&V){if(typeof W==="object"){if(W.constructor===Array){R[U]=W.concat(V);}else{R[U]=this.mergeHashes(W,V);}}else{R[U]=V;}}}},this);}return R;},invert:function(S){var U={};if(S){var R;for(R in S){if(S.hasOwnProperty(R)){if(typeof R==="number"||typeof R==="string"){U[S[R].toString()]=R;}}}}return U;}});}());(function(){function A(C){return C.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");}mstrmojo._ImageHelper=mstrmojo.provide("mstrmojo._ImageHelper",{getImage:function B(D){var E=mstrApp,C=E.getConfiguration();if(D){if(D.indexOf("\\")>=0){D=D.replace(/\\/g,"/");}D=A(D);if(D===decodeURI(D)){D=encodeURI(D);}}if(C&&D&&D.indexOf("://")===-1){D=C.getHostUrlByProject(E.getCurrentProjectId())+D;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(D)):D;}});}());(function(){function AM(Ax,Ay){return Ay||(Ax||window).event;}function o(Ax){var Ay=parseInt(Ax,10);return Ay===null||isNaN(Ay)?0:Ay;}mstrmojo.PositionType=null;var At=!!document.all,AK=document.documentMode,w=navigator.userAgent,m=false,k=false,i=false,h=false,V=false,S=!At&&"ActiveXObject" in window,y=false;At=At||S;if(At){if(window.mstrConfig&&mstrConfig.isEdgeModeEnabled){m=!!w.match(/MSIE 6/);k=((!!w.match(/MSIE 7/)&&!AK)||AK===7);i=(AK===8);h=(AK===9);V=(AK===10);y=(!AK||AK<=9);}else{m=!!w.match(/MSIE 6/);k=!!w.match(/MSIE 7/);i=!!w.match(/MSIE 8/);h=!!w.match(/MSIE 9/);V=!!w.match(/MSIE 10/);y=!V;}}var g=!At&&!!w.match(/Firefox/),p=0,x=!!w.match(/Android/),Aj=!!w.match(/iPad/),AR=!!w.match(/iPhone/),AZ=!!document.createTouch||x,u=!!w.match(/PlayBook/),Q=!!w.match(/Windows Phone/),Au=!At&&!!w.match(/Trident.*rv/),f=g?"-moz-":(At||Au)?"":"-webkit-",AL=g?"Moz":(V||Au)?"":At?"ms":"webkit",AW=((V||Au)?"t":"T"),AQ=AL+AW+"ransition";function Ao(){return AL+AW+"ransform";}function AI(){return AQ+"Property";}function W(){return AQ+"Duration";}function P(){return(V||g)?"transitionend":"webkitTransitionEnd";}function j(){return AL+"BoxShadow";}var Ar=Ao(),Af=AI(),AD=W(),A=P(),s=j();function AV(){if(!p&&g){var Ax=w.match(/.*Firefox\/([\d|\.]*).*/);if(Ax){p=parseFloat(Ax[1]);}}return p;}function Ab(){var Ay=0,A2=0,Az=window,A0=document,Ax=A0.body,A1=A0.documentElement;if(typeof Az.pageYOffset==="number"){A2=Az.pageYOffset;Ay=Az.pageXOffset;}else{if(Ax&&(Ax.scrollLeft||Ax.scrollTop)){A2=Ax.scrollTop;Ay=Ax.scrollLeft;}else{if(A1&&(A1.scrollLeft||A1.scrollTop)){A2=A1.scrollTop;Ay=A1.scrollLeft;}}}return{x:Ay,y:A2};}function AJ(Ax){Ax=Ax||0;Ax=String(Ax);return((Ax.indexOf("%",0))!==-1)?Ax:(Ax+"px");}function AT(Az,A3,A2,A1,A0){if(!mstrmojo.dom.isWinPhone){A1=(A1||false||this.isHWAccelerated);}else{A1=false;}var Ay=A0+(A1?"3d":"")+"(",Ax=A1?(","+A2+")"):")";return Ay+Az+","+A3+Ax;}var Ah=2,Z=3;function z(A3,A2,A6){var A5=A3.style,Az=A5.display,A1=this.windowDim(),A0=Ab();A5.display="block";var A4=A1.w-A3.clientWidth,A7=Math.max(A1.h-A3.clientHeight,0),Ax={4:0,5:A4,3:A4/2},Ay={1:0,3:A7/2,2:A7};A5.left=Ax[A2]+A0.x+"px";A5.top=Ay[A6]+A0.y+"px";A5.display=Az;}function q(A0,Az,A1,Ax){if(A0.addEventListener){return A0.addEventListener(Az,A1,!!Ax);}A1._id=A1._id||q.guid++;A0.events=A0.events||{};var Ay=A0.events[Az];if(!Ay){Ay=A0.events[Az]={};if(A0["on"+Az]){Ay[0]=A0["on"+Az];}}Ay[A1._id]=A1;function A2(A5){A5=A5||window.event;var A4=this.events[A5.type],A3;for(A3 in A4){A4[A3].call(this,A5);}}A0["on"+Az]=A2;}q.guid=1;function l(Az,Ay,A0,Ax){if(!Az){return ;}if(Az.removeEventListener){Az.removeEventListener(Ay,A0,!!Ax);}else{if(Az.events&&Az.events[Ay]){delete Az.events[Ay][A0._id];}}}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:w,isIE:At,isIE6:m,isIE7:k,isIE8:i,isIE9:h,isIE10:V,isIE11:S,isIEW3C:Au,isNSIE:y,isDXIE:y,isFF:g,isWK:!!w.match(/AppleWebKit/),isSafari:!!w.match(/Safari/)&&!w.match(/Chrome/),isChrome:!!w.match(/AppleWebKit/)&&w.match(/Chrome/),isEdge:!!w.match(/Edge/),isHWAccelerated:!x,isAndroid:x,isIPad:Aj,isPlayBook:u,isWinPhone:Q,isMobile:Aj||AR||Q||x,isIOSTouch:(Aj||AR)&&!window.MSStream,supportsTouches:AZ,TOUCHSTART:AZ?"touchstart":"mousedown",TOUCHMOVE:AZ?"touchmove":"mousemove",TOUCHEND:AZ?"touchend":"mouseup",TOUCHCANCEL:AZ?"touchcancel":"",RESIZE:AZ?"orientationchange":"resize",CSS3_PREFIX:f,CSS3_BOXSHADOW:s,CSS3_TRANSFORM:Ar,CSS3_TRANSITION:AQ,CSS3_TRANSITION_PROPERTY:Af,CSS3_TRANSITION_DURATION:AD,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh",INNER_TEXT:"innerText"},htmlFeatures:{FILE_READER:"fr"},MOUSE_BUTTON:{LEFT:1,RIGHT:2},supports:function B(Ax){var Ay=this.isFF&&AV();switch(Ax){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||Ay>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||Ay>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);case this.htmlFeatures.FILE_READER:return !!(window.FileReader);case this.cssFeatures.INNER_TEXT:return !this.isFF||Ay>44;}return false;},getOSInfo:function AS(){var A2="Unknown",Ay=navigator.appVersion,A1=navigator.userAgent,A0=A2;var Ax=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];var Az;for(Az=0;Az<Ax.length;Az++){var A4=Ax[Az];if(A4.r.test(A1)){A0=A4.s;break;}}var A3=A2;if(/Windows/.test(A0)){A3=/Windows (.*)/.exec(A0)[1];A0="Windows";}switch(A0){case"Mac OS X":A3=/Mac OS X (10[\.\_\d]+)/.exec(A1)[1];break;case"Android":A3=/Android ([\.\_\d]+)/.exec(A1)[1];break;case"iOS":A3=/OS (\d+)_(\d+)_?(\d+)?/.exec(Ay);A3=A3[1]+"."+A3[2]+"."+(A3[3]|0);break;}return{name:A0,version:A3};},transEndEvtNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},animationEndEvtNames:{WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",MozAnimation:"animationend",animation:"animationend"},replace:function t(Az,Ax){if(Az&&Ax){var Ay=Az.parentNode;if(Ay){Ay.replaceChild(Ax,Az);}}return Ax;},attachEvent:function b(Az,Ay,A0,Ax){if(Az.addEventListener){return Az.addEventListener(Ay,A0,!!Ax);}return Az.attachEvent("on"+Ay,A0);},detachEvent:function Ad(Az,Ay,A0,Ax){if(!Az){return ;}if(Az.removeEventListener){Az.removeEventListener(Ay,A0,!!Ax);}else{Az.detachEvent("on"+Ay,A0);}},attachMarkupEvent:function AB(A0,Az,Ax){var Ay=function(A1){mstrmojo.all[A0].captureDomEvent(Ax,window,A1);};this.attachEvent(Az,Ax,Ay);return Ay;},attachOneTimeEvent:function a(A0,Ay,A1,Ax){var Az=function(A2){A1(A2);if(Ax){l(this,Ay,Az);}else{mstrmojo.dom.detachEvent(this,Ay,Az);}};if(Ax){q(A0,Ay,Az);}else{this.attachEvent(A0,Ay,Az);}A0=null;return Az;},attachMouseMoveEvents:function D(A0,Ax){var Az=this,Ay=function(A1){if(Ax){Ax(A1);}Az.detachEvent(document,"mousemove",A0);Az.detachEvent(document,"mouseup",Ay);};Az.attachEvent(document,"mousemove",A0);Az.attachEvent(document,"mouseup",Ay);},captureDomEvent:function AP(A2,A0,Ay,A1,Az){var Ax=mstrmojo.all[A2];if(Ax){Ax.captureDomEvent(A0,Ay,A1,Az);}},captureEventInfo:function AO(A0){var Ay=mstrmojo.hash.copy(A0,{}),Az=Ay.hWin=Ay.hWin||window,Ax=Ay.e=Ay.e||Az.event;Ay.node=this.eventTarget(Az,Ax);Ay.pos=this.getMousePosition(Ax,Az);return Ay;},translate:function N(Az,Ay,A2,A1,Ax,A0){Ax=(Ax&&" "+Ax)||"";Az.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(Ay,A2,A1,A0)+Ax;},createTranslateString:function R(Ax,A0,Az,Ay){Ax=AJ(Ax);A0=AJ(A0);Az=AJ(Az);return AT(Ax,A0,Az,Ay,"translate");},createScaleString:function AA(Ax,A0,Az,Ay){Ax=Ax||0;A0=A0||0;Az=Az||0;return AT(Ax,A0,Az,Ay,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function C(Az,Ax,A0,A2){var Ay=Az.id+"-"+Ax,A1=this._bufferConnects[Ay];if(!A1){A1=this._bufferConnects[Ay]={elId:Az.id,eventName:Ax,timer:null,bufferSize:A2,listeners:[],callback:function(A3){mstrmojo.dom._callback(A3,mstrmojo.global,Ay);return true;}};this.attachEvent(Az,Ax,A1.callback);}A1.listeners.push(A0);},_callback:function An(A1,Ax,Az){var A0=this._bufferConnects[Az],A2=A0&&A0.timer;if(A0&&!A2){var Ay=(A0.bufferSize===null)?this._bufferSize:A0.bufferSize;if(A0.bufferSize){A0.timer=Ax.setTimeout(function(){mstrmojo.dom.updateBuffers(Az);},Ay);}else{mstrmojo.dom.updateBuffers(Az);}}},updateBuffers:function J(A0){var A1=this._bufferConnects[A0],Ay=A1&&A1.listeners,Ax=(Ay&&Ay.length)||0,Az;for(Az=0;Az<Ax;Az++){Ay[Az]();}if(A1&&A1.timer){delete A1.timer;}},detachBufferedEvent:function AG(Ay,A2,A3){if(!Ay){return ;}var A5=Ay.id+"-"+A2,Az=this._bufferConnects[A5],A1=Az&&Az.listeners,A4=(A1&&A1.length)||0,A0;if(A4){for(A0=A4-1;A0>-1;A0--){if(A1[A0]===A3){A1.splice(A0,1);}}if(!A1.length){this.detachEvent(Ay,A2,Az.callback);delete this._bufferConnects[A5];if(Az.timer){var Ax=mstrmojo.global;Ax.clearTimeout(Az.timer);}}}},eventTarget:function AE(Ax,Ay){Ay=AM(Ax,Ay);return Ay&&(Ay.target||Ay.srcElement);},isMac:function AC(){return this.getOSInfo().name.toLowerCase().indexOf("mac")>=0;},isMetaKey:function L(Ax,A0){var Az=this.getOSInfo().name.toLowerCase().indexOf("mac")>=0,Ay=AM(Ax,A0)||{};return(Ay.ctrlKey&&!Az)||(Ay.metaKey&&Az);},ctrlKey:function Aq(Ax,Ay){return(AM(Ax,Ay)||{}).ctrlKey;},shiftKey:function AF(Ax,Ay){return(AM(Ax,Ay)||{}).shiftKey;},metaKey:function d(Ax,Ay){return(AM(Ax,Ay)||{}).metaKey;},getButton:function AX(Ax,Ay){return((Number(AM(Ax,Ay).button))===2)?2:1;},isPrimaryMouseBtn:function Ak(Ay,Ax){return this.getButton(Ax||window,Ay)===1;},isRMC:function Ag(Ay,Ax){return Ay&&(Ay.button===2||Ay.type==="contextmenu"||this.isMac()&&this.ctrlKey(Ax,Ay)&&Ay.button===0);},getMousePosition:function n(A0,Az){Az=Az||window;var Ay,A3;if(mstrmojo.dom.isIE){A0=A0||Az.event;var A1=document,Ax=A1.body,A2=A1.documentElement;Ay=A0.clientX+Ax.scrollLeft+(A2.scrollLeft||0);A3=A0.clientY+Ax.scrollTop+(A2.scrollTop||0);}else{Ay=A0.pageX;A3=A0.pageY;}return{x:Ay,y:A3};},position:function AY(Ay,Az){var A2={x:0,y:0,w:0,h:0};if(Ay&&Ay.getBoundingClientRect){try{A2=Ay.getBoundingClientRect();}catch(A1){A2={left:0,top:0,right:0,bottom:0,height:0,width:0};}A2={x:A2.left,y:A2.top,w:A2.right-A2.left,h:A2.bottom-A2.top};if(this.isIE6||this.isIE7){var Ax=Ay.ownerDocument;if(Ax){var A4=Ax.documentElement,A3=A4.getBoundingClientRect();A2.x-=A3.left;A2.y-=A3.top;}}}if(Az){var A0=Ab();A2.x+=A0.x;A2.y+=A0.y;}return A2;},delta:function G(Az,Ax){Ax=Ax||document.body;var Ay=this.position(Az),A0=this.position(Ax);return{x:Math.round(Ay.x-A0.x),y:Math.round(Ay.y-A0.y)};},windowDim:function U(){var Ax=0,Az=0,A0=window,A1=document,A2=A1.documentElement,Ay=A1.body;if(typeof (A0.innerWidth)=="number"&&typeof (A0.innerHeight)=="number"){Ax=A0.innerWidth;Az=A0.innerHeight;}else{if(A2&&(A2.clientWidth||A2.clientHeight)){Ax=A2.clientWidth;Az=A2.clientHeight;}else{if(Ay&&(Ay.clientWidth||Ay.clientHeight)){Ax=Ay.clientWidth;Az=Ay.clientHeight;}}}return{w:Ax,h:Az};},center:function AN(Ax){z.call(this,Ax,Z,Z);},bottomCenter:function E(Ax){z.call(this,Ax,Z,Ah);},clearBrowserHighlights:function M(Ax){Ax=Ax||self;if(!Ax.getSelection){var A3=Ax.document,A2=A3&&A3.selection,A0=A2&&A2.empty;if(A0){try{A2.empty();}catch(Az){}}}else{var Ay=Ax.getSelection,A1=Ay&&Ax.getSelection();if(A1&&!A1.isCollapsed){if(A1.empty){A1.empty();}else{if(A1.removeAllRanges){A1.removeAllRanges();}}}}},findAncestorByAttr:function AU(A1,Az,Ay,Ax){var A2=Ay?A1:A1&&A1.parentNode;while(A2&&(A2!==Ax)){var A0=A2.getAttribute&&A2.getAttribute(Az);if(A0!=null){return{node:A2,value:A0};}A2=A2.parentNode;}return null;},findAncestorByName:function Ap(Az,A2,Ay,Ax){A2=A2&&A2.toLowerCase();var A0=Ay?Az:Az&&Az.parentNode;while(A0&&(A0!==Ax)){var A1=A0.nodeName;if(A1&&(A1.toLowerCase()===A2)){return A0;}A0=A0.parentNode;}return null;},contains:function K(A0,A1,Ay,Ax){var Az=A1;if(!Ay){Az=Az.parentNode;}while(Az){if(Az===A0){return true;}if(Az===Ax){break;}Az=Az.parentNode;}return false;},toggleSelection:function Av(Ay,Ax){Ay.setAttribute("unselectable",Ax?"off":"on");mstrmojo.css.toggleClass(Ay,"unselectable",!Ax);Ay.onselectstart=function(){return Ax;};if(!Ax){this.clearBrowserHighlights();}},preventDefault:function Y(Ax,Ay){Ay=Ay||Ax.event;if(Ay.preventDefault){Ay.preventDefault();}else{Ay.returnValue=false;}},stopPropogation:function O(Ax,Ay){Ay=Ay||Ax.event;if(Ay.stopPropagation){Ay.stopPropagation();}else{Ay.cancelBubble=true;}},firstTouch:function Aa(Ax,Ay){return Ay&&Ay.touches&&Ay.touches.length?Ay.touches[0]:(Ay||Ax.event);},firstChangedTouch:function Ai(Ax,Ay){return Ay&&Ay.changedTouches&&Ay.changedTouches.length?Ay.changedTouches[0]:(Ay||Ax.event);},isLandscape:function X(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function Ac(Ax){while(Ax){var Ay=Ax.mstrmojoId;if(Ay!==null&&Ay!==undefined){return mstrmojo.all[Ay];}Ax=Ax.parentNode;}return null;},setCaret:function H(Ax,Az){if(Ax.setSelectionRange){Ax.focus();Ax.setSelectionRange(Az,Az);}else{if(Ax.createTextRange){var Ay=Ax.createTextRange();Ay.move("character",Az);Ay.select();}}},setInputSelection:function c(Ax){if(Ax.select){Ax.focus();Ax.select();}else{if(Ax.createTextRange){Ax.createTextRange().select();}}},setElementSelection:function e(Az){if(window.getSelection){var Ax=document.createRange(),Ay=window.getSelection();Ax.selectNodeContents(Az);Ay.removeAllRanges();Ay.addRange(Ax);}else{if(document.body.createTextRange){var A0=document.body.createTextRange();A0.moveToElementText(Az);A0.select();}}},getHorizontalScroll:function As(){return Ab().x;},getVerticalScroll:function AH(){return Ab().y;},getMaxScrollHeight:function I(){return mstrmojo.dom.windowDim().h-22;},getComputedScrollbarWidth:function Al(Ay){if(Ay){var Ax=mstrmojo.css.getComputedStyle(Ay);if(Ax){return(Ay.offsetWidth-o(Ax.borderLeftWidth)-o(Ax.borderRightWidth)-Ay.clientWidth);}}return null;},removeNode:function Am(Az){var Ay=document.getElementById(Az),Ax=Ay&&Ay.parentNode;if(Ax){return Ax.removeChild(Ay);}},redirectUrlToFormWrapper:function Ae(A0){var Az=function Az(A2){A2.preventDefault();var A4=A2.target,A3=A4&&A4.href;if(A3&&window&&window.FormWrapper){window.FormWrapper.openPage(A3.replace(/ /g,"%20"));}};var A1=A0&&A0.getElementsByTagName("a"),Ay=A1.length;for(var Ax=0;Ax<Ay;Ax++){if(!A1[Ax].openWithFormWrapper){A1[Ax].addEventListener("click",Az,true);A1[Ax].openWithFormWrapper=true;}}},checkTagName:function Aw(Ay,Ax){return Ay&&Ay.tagName&&Ay.tagName.toLowerCase()===Ax;},getComputedMargin:function F(Ay){var Ax=mstrmojo.css.getComputedStyle(Ay);return[parseInt(Ax.marginTop,10)||0,parseInt(Ax.marginRight,10)||0,parseInt(Ax.marginBottom,10)||0,parseInt(Ax.marginLeft,10)||0];}});}());(function(){function V(b,a){if(b.start===undefined||b.end===undefined){throw new Error("invalid interval value");}this.start=parseFloat(b.start);this.end=parseFloat(b.end);this.mid=(this.start+(this.end-this.start)/2).toFixed(2);this.maxEnd=b.end;this.color=a?"black":"red";}function H(){this.parent=this;this.left=this;this.right=this;D.call(this,"black");}function N(){return this.color==="red";}function D(a){this.color=a;}function G(){return this.parent.left===this;}function X(){this.maxEnd=Math.max(this.end,this.right&&this.right.maxEnd||-Infinity,this.left&&this.left.maxEnd||-Infinity);}function K(){var a=this.right,b=null;while(!M(a)){b=a;a=a.left;}return b?b:a;}function Y(){var a=this.right,b=null;this.right=a.left;if(!M(a.left)){a.left.parent=this;}a.parent=this.parent;if(!this.parent){b=a;}else{if(G.call(this)){this.parent.left=a;}else{this.parent.right=a;}}a.left=this;this.parent=a;X.call(this);X.call(a);return b;}function Z(){var a=this.left,b=null;this.left=a.right;if(!M(a.right)){a.right.parent=this;}a.parent=this.parent;if(!this.parent){b=a;}else{if(G.call(this)){this.parent.left=a;}else{this.parent.right=a;}}a.right=this;this.parent=a;X.call(this);X.call(a);return b;}function B(){var b=this,c=null,a;while(b.parent&&N.call(b.parent)){if(G.call(b.parent)){a=b.parent.parent&&b.parent.parent.right;if(N.call(a)){D.call(b.parent,"black");D.call(a,"black");D.call(b.parent.parent,"red");b=b.parent.parent;}else{if(!G.call(b)){b=b.parent;c=Y.call(b);}D.call(b.parent,"black");D.call(b.parent.parent,"red");c=Z.call(b.parent.parent);}}else{a=b.parent.parent&&b.parent.parent.left;if(N.call(a)){D.call(b.parent,"black");D.call(a,"black");D.call(a.parent,"red");b=a.parent;}else{if(G.call(b)){b=b.parent;c=Z.call(b);}D.call(b.parent,"black");D.call(b.parent.parent,"red");c=Y.call(b.parent.parent);}}}return c;}function C(){var b=this,c=null,a;while(b.parent&&b.color==="black"){if(G.call(b)){a=b.parent.right;if(a.color==="red"){D.call(a,"black");D.call(b.parent,"red");c=Y.call(b.parent)||c;a=b.parent.right;}if(a.left.color==="black"&&a.right.color==="black"){D.call(a,"red");b=b.parent;}else{if(a.right.color==="black"){D.call(a.left,"black");D.call(a,"red");c=Z.call(a)||c;a=b.parent.right;}a.color=b.parent.color;D.call(b.parent,"black");D.call(a.right,"black");c=Y.call(b.parent)||c;break;}}else{a=b.parent.left;if(a.color==="red"){D.call(a,"black");D.call(b.parent,"red");c=Z.call(b.parent)||c;a=b.parent.left;}if(a.left.color==="black"&&a.right.color==="black"){D.call(a,"red");b=b.parent;}else{if(a.left.color==="black"){D.call(a.right,"black");D.call(a,"red");c=Y.call(a)||c;a=b.parent.left;}a.color=b.parent.color;D.call(b.parent,"black");D.call(a.left,"black");c=Z.call(b.parent)||c;break;}}}D.call(b,"black");return c;}function J(a){if(!a){return ;}this.start=a.start;this.end=a.end;this.mid=a.mid;this.maxEnd=a.maxEnd;}function M(a){return a instanceof H;}function O(a){return this.start<=a&&a<=this.end;}function L(){var a=this;X.call(a);while(a.parent){a=a.parent;X.call(a);}}mstrmojo.vi.util.IntervalTree=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.util.IntervalTree",root:null,init:function R(){},reconstructTree:function F(a){this.root=null;(a||[]).forEach(function(b){this.insertNode(b);},this);},insertNode:function E(a){var b=new V(a);b.left=new H();b.right=new H();if(this.insertHelper(b,this.root)){this.root=B.call(b)||this.root;D.call(this.root,"black");}},insertHelper:function P(c,a){if(!a){this.root=c;return true;}var b=false;if(c.start==a.start&&c.end==a.end){return false;}else{if(c.start<a.start){if(M(a.left)){a.left=c;c.parent=a;b=true;}else{b=b||this.insertHelper(c,a.left);}}else{if(M(a.right)){a.right=c;c.parent=a;b=true;}else{b=b||this.insertHelper(c,a.right);}}}if(b){a.maxEnd=Math.max(a.maxEnd,c.maxEnd);}return b;},searchNode:function S(a){return this.searchNodeHelper(a,this.root);},searchNodeHelper:function Q(b,a){if(M(a)){return null;}if(b.start==a.start&&b.end==a.end){return a;}else{if(b.start<a.start){return this.searchNodeHelper(b,a.left);}}return this.searchNodeHelper(b,a.right);},searchForPoint:function W(a){var b=[];this.searchHelper(a,this.root,b);return b;},searchHelper:function U(b,a,c){if(M(a)||b>a.maxEnd){return ;}if(O.call(a,b)){c.push(a);}this.searchHelper(b,a.left,c);if(b>=a.start){this.searchHelper(b,a.right,c);}},calculateCloset:function A(a,b){if(!b.length){return[];}return b.reduce(function(c,d){return Math.abs(c.mid-a)<Math.abs(d.mid-a)?c:d;});},deleteNode:function I(c){var b=this.searchNode(c),a=b;if(!b||M(b)){return ;}if(!M(b.left)&&!M(b.right)){a=K.call(b);J.call(b,a);L.call(b);}var d=!M(a.left)?a.left:a.right;d.parent=a.parent;if(!a.parent){this.root=d;}else{if(G.call(a)){a.parent.left=d;L.call(a);}else{a.parent.right=d;L.call(a);}}if(a.color==="black"){this.root=C.call(d)||this.root;}}});}());mstrmojo.vi.viz.EnumVizStyles={GRAPH_MATRIX:"GraphMatrixVisualizationStyle",NETWORK:"NetworkVisualizationStyle",HEAT_MAP:"VIHeatMapVisualizationStyle",GOOGLE_MAP:"GoogleMapVisualizationStyle",ESRI_MAP:"ESRIMapVisualizationStyle",IMAGE_LAYOUT:"ImageLayoutVisualizationStyle",NEW_GRAPH_MATRIX:"NewGraphMatrixVisualizationStyle",MAPBOX:"MapboxVisualizationStyle",KPICARD:"KPICardVisualizationStyle"};mstrmojo.mstr.EnumWebAPIErrorCodes={MSI_INBOX_MSG_NOT_FOUND:-2147468986,POOL_OBJECT_NOT_FOUND_BY_ID:-2147467398,DOCDATA_PREPARE_TASK_REPORT_INCOMP:-2147466604,AUTHEN_E_LOGIN_FAIL_EXPIRED_PWD:-2147216963,AUTHEN_E_LOGIN_FAILED_NEW_PASSWORD_REQD:-2147216960,AUTHEN_E_LOGIN_FAIL:-2147216959,E_INVALID_EXPRESSION:-2147214839,MSI_ADDUSERJOB_ERROR:-2147209185,E_MSI_USERMGR_USER_NOTFOUND:-2147209051,MSI_SERVER_NOT_FOUND:-2147206923,DFC_QRYENG_RES_TRUNC:-2147205488,MSI_CUBE_NOT_PUBLISHED:-2147072488,MDSVR_E_NO_ID:-2147216373,E_UNUSED:4294967295,UICMD_DEFAULT_ERROR:10};mstrmojo.vi.viz.EnumWidgetTypes={GRID:0,GRAPH_MATRIX:1,HEATMAP:2,NETWORK:3,IMAGELAYOUT:4,ESRIMAP:5,GOOGLEMAP:6,CUSTOM:7,MAPBOX:8,KPICARD:9};mstrmojo.chart.model.enums.EnumDSSDynamicShortcut={DssDynamicShortcutReserved:0,DssDynamicShortcutAuto:1,DssDynamicShortcutAcrossThenDown:2,DssDynamicShortcutDownThenAcross:3,DssDynamicShortcutColumns:4,DssDynamicShortcutRows:5,DssDynamicShortcutCell:6,DssDynamicShortcutShape:7,DssDynamicShortcutLastOne:8,DssDynamicShortcutRangeEnd:255};mstrmojo.vi.enums.EnumFilterClearActionType={CLEAR_ALL:0,CLEAR_KEEP_ONLY:1,CLEAR_ADV_QUALIFICATION:2,CLEAR_LINKING:3,CLEAR_KEEP_ONLY_AND_LINKING:4,CLEAR_DRILLING:5};(function(){if(!mstrmojo.LoadedExternalJSURLs){mstrmojo.LoadedExternalJSURLs={};}var LOADING_STATUS={LOADING:0,LOADED:1};function getUrl4AllPlatform(url){if(url.substr(0,7)==="file://"){url=url.substr(7);}else{if(mstrApp.isSingleTier&&url.substr(0,4)!=="http"){url="http:"+url;}}return url;}window.LoadScriptsExternalJSCallback=function(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]={status:LOADING_STATUS.LOADED};mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;};if(!mstrmojo._LoadsScript){mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function requiresMethod(n){if(!n){return false;}if(typeof this[n]==="function"){return true;}var fqcn=this[n]||(this.methods&&(this.methods[n]||this.methods["*"]));if(typeof fqcn==="string"){this.requiresCls(fqcn);return typeof this[n]==="function";}return false;},requiresCls:function req(mixins,callback){if(mixins){if(typeof mixins==="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin,i,len;for(i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(propName,bForceStartup){var fqcn=this[propName];if(fqcn){var c,firstTime=false;if(typeof fqcn==="string"){c=mstrmojo.registry.ref(fqcn);this[propName]=c;firstTime=true;}else{c=fqcn;}if(c&&(firstTime||bForceStartup)){c.parent=this;if(c.startup){c.startup();}}return c;}return null;},requiresExternalScripts:function requiresExternalScripts(esScripts,callback,context){if(esScripts&&esScripts instanceof Array){if(esScripts.length===0){if(callback){callback.call(context);}return false;}var nextScriptConfig=esScripts[0],originalUrl=nextScriptConfig&&nextScriptConfig.url,scriptLoadedInfo=mstrmojo.LoadedExternalJSURLs[originalUrl],onScriptLoaded=function(){esScripts.splice(0,1);return this.requiresExternalScripts(esScripts,callback,context);}.bind(this);if(nextScriptConfig&&nextScriptConfig.forceReload===false&&scriptLoadedInfo){if(scriptLoadedInfo.status===LOADING_STATUS.LOADED){return onScriptLoaded();}else{return scriptLoadedInfo.onLoadedCallbacks.push(onScriptLoaded);}}var script=document.createElement("script"),isIE=!!document.all,onError=nextScriptConfig.onError;script.type="text/javascript";script.src=getUrl4AllPlatform(originalUrl);if(onError){script.onerror=function(){if(onError&&onError.callback&&context){onError.callback.call(context,onError.params);}};}var callbackParamName=nextScriptConfig.callbackParamName;if(!callbackParamName){var onScriptFirstLoaded=function(){var loadedInfo=mstrmojo.LoadedExternalJSURLs[nextScriptConfig.url],onLoadedCallbacks=loadedInfo&&loadedInfo.onLoadedCallbacks;loadedInfo.status=LOADING_STATUS.LOADED;onScriptLoaded();if(loadedInfo&&onLoadedCallbacks.length>0){var i=0;for(;i<onLoadedCallbacks.length;i++){onLoadedCallbacks[i]();}loadedInfo.onLoadedCallbacks=[];}};if(isIE){script.onreadystatechange=function(){if(script.readyState==="loaded"||script.readyState==="complete"){script.onreadystatechange=null;script.onerror=null;onScriptFirstLoaded();}};}else{script.onload=function(){script.error=null;script.onload=null;onScriptFirstLoaded();};}}else{if(callbackParamName.length!==0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy===true){var that=this;window.setTimeout(function(){that.requiresExternalScripts(esScripts,callback,context);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;script.src+="&"+callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=esScripts;mstrmojo._LoadsScript.callback=callback;mstrmojo._LoadsScript.esScritsContext=context;}}mstrmojo.LoadedExternalJSURLs[originalUrl]={status:LOADING_STATUS.LOADING,onLoadedCallbacks:[]};document.getElementsByTagName("head")[0].appendChild(script);}}});}}());mstrmojo.VisEnum={ControlType:{BUTTON:"button",LASSO_SELECTOR:"lasso-selector",LASSO_RESIZER:"lasso-resizer",SPLITTER:"splitter",GM_ROW_HEADER:"rh",GM_ROW_HEADER_TEXT:"rhtext",GM_ROW_HEADER_EXTRA:"rhext",GM_COL_HEADER:"ch",GM_COL_HEADER_TEXT:"chtext",GM_COL_HEADER_EXTRA:"chext",GM_YAXIS:"y",GM_XAXIS:"x",GM_YLABEL:"y-label",GM_XLABEL:"x-label",GM_ROW_HEADER_TITLE:"rht",GM_ROW_HEADER_TITLE_TEXT:"rhttext",GM_COL_HEADER_TITLE:"cht",GM_COL_HEADER_TITLE_TEXT:"chttext",GM_MINI_CHART:"chart",GM_TEXT_BODY:"text-body",GM_SHAPE:"shape",GM_MARKER:"marker",GM_SET_SHAPE:"set-shape",GM_YAXIS2:"y2",GM_XAXIS2:"x2",GM_TREND_LINE:"trendLine",GM_TREND_LINE_HOVER:"trendLineHover",GM_TREND_LINE_SELECT:"trendLineSelect",GM_REF_LINE:"referenceLine",GM_REF_LINE_HOVER:"referenceLineHover",GM_REL_LINE_SELECT:"referenceLineSelect",GM_HIGHLIGHT_BOX:"highlight-box",GM_AXIS_TEXT:"axis-text",GM_AXIS_WORD:"axis-word",GM_SVG_X_NUMERIC:"svg-x-numeric",GM_SVG_X_CATEGORY:"svg-x-category",GM_SVG_Y_NUMERIC:"svg-y-numeric",GM_SVG_Y_CATEGORY:"svg-y-category",GM_X_NUMERIC:"x-numeric",GM_X_CATEGORY:"x-category",GM_Y_NUMERIC:"y-numeric",GM_Y_CATEGORY:"y-category",GM_SVG_CHART:"svg-chart",GM_DATA_LABEL:"data-label",GM_YAXIS_LINE:"y-line",GM_XAXIS_LINE:"x-line",GM_YAXIS2_LINE:"y2-line",GM_XAXIS2_LINE:"x2-line",LGD_TITLE:"lgd-title",LGD_TEXT:"lgd-text",LGD_COLORBOX:"lgd-colorbox",LGD_COLORBOX_CTN:"lgd-colorbox-ctn",LGD_CANVAS:"lgd-canvas",LINE_CONTAINER:"line-ctn",GM_V_MATRIX_LINE:"v-line",GM_H_MATRIX_LINE:"h-line",GM_V_CHART_LINE:"v-ctline",GM_H_CHART_LINE:"h-ctline",GM_CHART_ROW:"ct-row",GM_CHART_COL:"ct-col",GM_H_GRID_LINE:"h-gline",GM_V_GRID_LINE:"v-gline",GM_H_MINOR_GRID_LINE:"h-gline-minor",GM_V_MINOR_GRID_LINE:"v-gline-minor",GM_ORIGIN_LINE:"originLine",GM_ORIGIN_LABEL:"origin-label",GM_ORIGIN_LINE_H:"origin-line-h",GM_ORIGIN_LINE_V:"origin-line-v",GM_ORIGIN_LABEL_H:"origin-label-h",GM_ORIGIN_LABEL_V:"origin-label-v",GM_DUMMY_A:"dummy-a",GM_V_EXTRA_LINE:"v-extra-line",GM_REF_LABEL:"ref-label",GM_RIGHT_BORDER:"border-r",GM_BOTTOM_BORDER:"border-b",KPI_V_SCROLLBAR:"kpi-vertical-scrollbar",KPI_H_SCROLLBAR:"kpi-horizontal-scrollbar"},GMDropZoneID:{ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10},NETWORK_LOCAL_PROPS:{ZOOM_FACTOR:"zf",NODE_POSITION:"np"},NETWORK_PROPERTIES:{showLegend:"showLegend",showEdgeDirection:"showedgearrow",showTransition:"animatelayout",nodeSizeAggregation:"nodesizeaggfunc",minNodeSize:"minns",maxNodeSize:"maxns",themeType:"th",circleLabelFont:"BubFnt",modifiedNodes:"mn",layoutMode:"layout",legendPosition:"legendposition",dragMode:"mode",bubbleStyle:"bbs",propsCategory:"pc",lgdBgFillClr:"lgdBgFillClr",lgdBgFillTrans:"lgdBgFillTrans",lgdFntClr:"lgdFntClr",lgdFntSz:"lgdFntSz",lgdFntFml:"lgdFntFml",lgdFntStyle:"lgdFntStyle"},NETWORK_LAYOUT:{CIRCULAR:"circular",LINEAR:"linear",FORCE_DIRECTED:"forceDirected"},NETWORK_DRAG_MODE:{pan:0,select:1},NETWORK_AGGREGATION_METHOD:{"Count of":0,"Sum of":1,"Average of":2,"Min of":3,"Max of":4},NETWORK_MIN_NODE_SIZE_TYPE:{PROPORTIONAL:1,FULL_RANGE:2,ADJUSTED_RANGE:3},NETWORK_MAX_NODE_SIZE_TYPE:{AUTOMATIC:1,MANUAL:2},NETWORK_FORCE_DIRECTED_LAYOUT_EDGE_CURVATURE:[0,0.2],HEATMAP_PROPERTIES:{showLegend:"showLegend",deleteButton:"ed",showMetricValues:"mv",labelSize:"lb",layout:"la",themeType:"th",headerType:"he",deletedList:"dl",refreshType:"rt",metricList:"ml",colorByType:"cbt",absoluteFixed:"abs",blendColor:"blc",background:"bg",legendBackground:"lbg",headerColors:"hcl",fonts:"fts",propsCategory:"pc",attrColorByOpacity:"acbo",metricColorByOpacity:"mcbo"},HEATMAP_LABEL_SIZE:{On:0,Off:1,Proportional:2},MAPS_PROPERTIES:{SHOW_LEGEND:"showLegend"},VIS_CARDLIMIT:{GRID:250,NON_GRID:8000,AREA_MAP:1000},GMLegendDataType:{COLOR_BY:1,SIZE_BY:2},GMLegendFormatingPropertyTag:{LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",COLOR_SQUARE_COLOR:"clrSqrClr"},LegendPropertyTag:{LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr"},EnumLegendMode:{RESTORED:1,MINIMIZED:2},EnumSingleLegendMode:{RESTORE:1,COLLAPSE:2},EnumColorRankMode:{INVALID:-1,VALUE:0,TOP:1,BOTTOM:2,TOP_PERCENT:3,BOTTOM_PERCENT:4},FormNameDisplayType:{OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4},SERVER_JSON_ERROR_TYPE:{EMPTY_DATA:0,NO_DATASET:1,AE_ERROR:2,NO_TEMPLATE_UNIT:3},NETWORK_CIRCLE_BORDER_WIDTH:8,IMAGELAYOUT_PROPERTIES:{DISPLAY_MODE:"mt",MAX_SIZE_TYPE:"ty",MAX_SIZE_VALUE:"val",MIN_SIZE_TYPE:"mst",MIN_SIZE_VALUE:"msv",MAP_FILE_PATH:"mf",SHAPE_FILL_OPC_PER:"shapeFillTrans",SHAPE_FILL_COLOR:"shapeClr",SHAPE_BORDER_STYLE:"shapeBorderCmbStyle",SHAPE_BORDER_COLOR:"shapeBorderClr",DATA_LABEL_SWITCH:"dls",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle",BLANK_MAP_BORDER_STYLE:"blankMapBorderStyle",BLANK_MAP_BORDER_COLOR:"blankMapBorderClr",BLANK_MAP_COLOR:"blankMapClr",DEFAULT_MAP_COLOR:"dftMapClr",DEFAULT_BUBBLE_COLOR:"dftBubbleClr",DEFAULT_MAP_BORDER_COLOR:"dftMapBorderClr",DEFAULT_BUBBLE_BORDER_COLOR:"dftBubbleBorderClr",LEGEND_FONT_SIZE:"lgFntSz",LEGEND_FONT_FAMILY:"lgFntFml",LEGEND_FONT_COLOR:"lgFntClr",LEGEND_FONT_STYLE:"lgFntStyle",LEGEND_BACKGROUND_COLOR:"lgBgClr",LEGEND_OPC_PER:"lgBgFillTrans",LEGEND_POSITION:"lgPos",LEGEND_SHOW:"lgShow",LEGEND_MODE:"lgMode",LEGEND_SCALE:"lgScale",H_MATRIX_LINE_COLOR:"hMatrixLnClr",V_MATRIX_LINE_COLOR:"vMatrixLnClr",ALL_MATRIX_LINE_COLOR:"allMatrixLnClr",H_MATRIX_LINE_STYLE:"hMatrixLnCmbStyle",V_MATRIX_LINE_STYLE:"vMatrixLnCmbStyle",ALL_MATRIX_LINE_STYLE:"allMatrixLnCmbStyle"}};mstrmojo.mstr.EnumFunction={FunctionCustom:-1,FunctionReserved:0,FunctionPlus:1,FunctionMinus:2,FunctionTimes:3,FunctionDivide:4,FunctionUnaryMinus:5,FunctionEquals:6,FunctionNotEqual:7,FunctionGreater:8,FunctionLess:9,FunctionGreaterEqual:10,FunctionLessEqual:11,FunctionSum:12,FunctionCount:13,FunctionAvg:14,FunctionMin:15,FunctionMax:16,FunctionBetween:17,FunctionLike:18,FunctionAnd:19,FunctionOr:20,FunctionNot:21,FunctionIn:22,FunctionRank:23,FunctionAbs:24,FunctionRunningSum:25,FunctionRunningAvg:26,FunctionMovingSum:28,FunctionMovingAvg:27,FunctionProduct:29,FunctionMedian:30,FunctionMode:31,FunctionStdev:32,FunctionVar:33,FunctionGeomean:34,FunctionEqualEnhanced:35,FunctionNotEqualEnhanced:36,FunctionGreaterEqualEnhanced:37,FunctionLessEqualEnhanced:38,FunctionBetweenEnhanced:39,FunctionBanding:40,FunctionBandingC:41,FunctionBandingP:42,FunctionNotLike:43,FunctionNotBetween:44,FunctionIntersect:45,FunctionIntersectIn:46,FunctionNullToZero:47,FunctionZeroToNull:48,FunctionApplySimple:49,FunctionApplyAggregation:50,FunctionApplyLogic:51,FunctionApplyComparison:52,FunctionApplyRelative:53,FunctionIsNull:54,FunctionIsNotNull:55,FunctionUcase:56,FunctionNotIn:57,FunctionNTile:58,FunctionPercentile:59,FunctionMovingMax:60,FunctionMovingMin:61,FunctionMovingDifference:62,FunctionMovingStdev:63,FunctionExpWghMovingAvg:64,FunctionMovingCount:65,FunctionRunningMax:66,FunctionRunningMin:67,FunctionRunningStdev:68,FunctionRunningCount:69,FunctionExpWghRunningAvg:70,FunctionNotBetweenEnhanced:71,FunctionConcat:72,FunctionFirstInRange:73,FunctionLastInRange:74,FunctionValueSegment:75,FunctionContains:76,FunctionBeginsWith:77,FunctionEndsWith:78,FunctionNotContains:79,FunctionNotBeginsWith:80,FunctionNotEndsWith:81,FunctionCase:82,FunctionCaseV:83,FunctionStdevP:84,FunctionRunningStdevP:85,FunctionMovingStdevP:86,FunctionNTileS:87,FunctionNTileVS:88,FunctionVarP:89,FunctionCurrentDate:90,FunctionDayOfMonth:91,FunctionDayOfWeek:92,FunctionDayOfYear:93,FunctionWeek:94,FunctionMonth:95,FunctionQuarter:96,FunctionYear:97,FunctionCurrentDateTime:98,FunctionCurrentTime:99,FunctionHour:100,FunctionMinute:101,FunctionSecond:102,FunctionMilliSecond:103,FunctionConcatNoBlank:104,FunctionLength:105,FunctionLower:106,FunctionLTrim:107,FunctionPosition:108,FunctionRTrim:109,FunctionSubStr:110,FunctionInitCap:111,FunctionTrim:112,FunctionRightStr:113,FunctionLeftStr:114,FunctionGreatest:115,FunctionLeast:116,FunctionFirst:117,FunctionLast:118,FunctionAdd:134,FunctionAverage:135,FunctionMultiply:136,FunctionBandingM:137,FunctionOLAPSum:138,FunctionOLAPAvg:139,FunctionOLAPCount:140,FunctionOLAPMax:141,FunctionOLAPMin:142,FunctionLag:143,FunctionLead:144,FunctionPercentRank:166,FunctionConcatAgg:177,FunctionTuple:1000};(function(){mstrmojo.requiresDescs(5774,2266,2287,2496,2495,2493,2267,2498,2500,2279,2491,2476,2271,2478,2268,2492,2273,2280,2490,2488,2494,2487,2269,2477,2499,2292,2489,2281,2484,2483,2480,2497,2274,2485,2486,2282,2481,2479,2482,2290,2293);var A=[{n:mstrmojo.desc(5774,"No Fill"),id:"transparent"},{n:mstrmojo.desc(2266,"Black"),id:"#000000"},{n:mstrmojo.desc(2287,"Brown"),id:"#993300"},{n:mstrmojo.desc(2496,"Olive Green"),id:"#333300"},{n:mstrmojo.desc(2495,"Dark Green"),id:"#003300"},{n:mstrmojo.desc(2493,"Dark Teal"),id:"#003366"},{n:mstrmojo.desc(2267,"Dark Blue"),id:"#000080"},{n:mstrmojo.desc(2498,"Indigo"),id:"#333399"},{n:mstrmojo.desc(2500,"Grey-80%"),id:"#333333"},{n:mstrmojo.desc(2279,"Dark Red"),id:"#800000"},{n:mstrmojo.desc(2491,"Orange"),id:"#ff6600"},{n:mstrmojo.desc(2476,"Dark Yellow"),id:"#808000"},{n:mstrmojo.desc(2271,"Green"),id:"#008000"},{n:mstrmojo.desc(2478,"Teal"),id:"#008080"},{n:mstrmojo.desc(2268,"Blue"),id:"#0000ff"},{n:mstrmojo.desc(2492,"Blue-Grey"),id:"#666699"},{n:mstrmojo.desc(2273,"Grey-50%"),id:"#808080"},{n:mstrmojo.desc(2280,"Red"),id:"#ff0000"},{n:mstrmojo.desc(2490,"Light Orange"),id:"#ff9900"},{n:mstrmojo.desc(2488,"Lime"),id:"#99cc00"},{n:mstrmojo.desc(2494,"Sea Green"),id:"#339966"},{n:mstrmojo.desc(2487,"Aqua"),id:"#33cccc"},{n:mstrmojo.desc(2269,"Light Blue"),id:"#3366ff"},{n:mstrmojo.desc(2477,"Violet"),id:"#800080"},{n:mstrmojo.desc(2499,"Grey-40%"),id:"#969696"},{n:mstrmojo.desc(2292,"Pink"),id:"#ff00ff"},{n:mstrmojo.desc(2489,"Gold"),id:"#ffcc00"},{n:mstrmojo.desc(2281,"Yellow"),id:"#ffff00"},{n:mstrmojo.desc(2484,"Bright Green"),id:"#00ff00"},{n:mstrmojo.desc(2483,"Turquoise"),id:"#00ffff"},{n:mstrmojo.desc(2480,"Sky Blue"),id:"#00ccff"},{n:mstrmojo.desc(2497,"Plum"),id:"#993366"},{n:mstrmojo.desc(2274,"Grey-25%"),id:"#c0c0c0"},{n:mstrmojo.desc(2485,"Rose"),id:"#ff99cc"},{n:mstrmojo.desc(2486,"Tan"),id:"#ffcc99"},{n:mstrmojo.desc(2282,"Light Yellow"),id:"#ffff99"},{n:mstrmojo.desc(2481,"Light Green"),id:"#ccffcc"},{n:mstrmojo.desc(2479,"Light Turquoise"),id:"#ccffff"},{n:mstrmojo.desc(2482,"Pale Blue"),id:"#99ccff"},{n:mstrmojo.desc(2290,"Lavender"),id:"#cc99ff"},{n:mstrmojo.desc(2293,"White"),id:"#ffffff"}];var E=[];mstrmojo.util.ui.ColorPicker={getBasicColors:function B(){return A.slice();},getCustomColors:function D(){return E.slice();},addCustomColor:function C(G){var F=function(H){return H.id===G;};if(!A.filter(F)[0]&&!E.filter(F)[0]){E.push({n:G,id:G});if(E.length>8){E.shift();}}}};}());mstrmojo._ShowsStatus=mstrmojo.provide("mstrmojo._ShowsStatus",{showStatus:function showStatus(A,G,D){var C=this._STATUS;if(!this.hasRendered||!C){return ;}var E=C.style;if(!A){if(this.showingStatus){E.display="none";}}else{if(C){var F=this._STATUS_TXT;if(F){F.innerHTML=G||"";}var B=this._STATUS_BAR;if(B){B.style.width=(D||0)+"%";}if(!this.isStatusBarPositioned){E.top=Math.max((this.scrollboxHeight||0)-50,12)+"px";this.isStatusBarPositioned=true;}if(!this.showingStatus){E.display="block";}}}this.showingStatus=A;},updateStatus:function updateStatus(A,B){this.showStatus(this.showingStatus,A,B);}});mstrmojo.mstr.EnumDSSXMLBaseFormType={DssXmlBaseFormReserved:0,DssXmlBaseFormHidden:-1,DssXmlBaseFormDateTime:1,DssXmlBaseFormNumber:2,DssXmlBaseFormText:3,DssXmlBaseFormPicture:4,DssXmlBaseFormUrl:5,DssXmlBaseFormEmail:6,DssXmlBaseFormHTMLTag:7,DssXmlBaseFormDate:8,DssXmlBaseFormTime:9,DssXmlBaseFormSymbol:10,DssXmlBaseFormBigDecimal:11,DssXmlBaseFormPhoneNumber:12};mstrmojo.mstr.EnumDSSXMLBaseFormType.convertDataType2BaseFormType=function(B){var A={0:2,1:2,2:2,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:2,12:2,13:2,14:8,15:9,16:1,17:3,18:3,21:2,22:2,23:3,30:11,31:2,33:3,34:2};return A[B]||0;};mstrmojo.chart.model.enums.EnumDSSGraphProperty={DssGraphTextContent:9999,DssGraphContent:9999,DssGraphPropertyReserved:0,DssGraphAutoFitO1:4,DssGraphAutoFitO2:5,DssGraphAutoFitX:6,DssGraphAutoFitY1:7,DssGraphAutoFitY2:8,DssGraphGroupSpacing:10,DssGraphRiserWidth:11,DssGraphColorBySeries:12,DssGraphCurveColorAsSeries:13,DssGraphSDMOVAFactor:14,DssGraph2DAngle:18,DssGraph2DDepth:20,DssGraphDepthMode:21,DssGraph2ScaleDirectionX:22,DssGraph2ScaleDirectionY1:23,DssGraph2ScaleDirectionY2:24,DssGraph2ExcludeZeroX:25,DssGraph2ExcludeZeroY1:26,DssGraph2ExcludeZeroY2:27,DssGraphFormatDataTextX:28,DssGraphFormatDataTextY1:29,DssGraphFormatDataTextY2:30,DssGraphFormatX:33,DssGraphFormatY1:34,DssGraphFormatY2:35,DssGraphFormatZ:36,DssGraphGridLineO1:37,DssGraphGridLineO2:38,DssGraphGridLineX:39,DssGraphGridLineY1:40,DssGraphGridLineY2:41,DssGraphLabelModeO1:48,DssGraphLabelModeO2:49,DssGraphLegendLocation:52,DssGraphTitleXLocation:54,DssGraphTitleY1Location:55,DssGraphTitleY2Location:56,DssGraph2LogScaleX:57,DssGraph2LogScaleY1:58,DssGraph2LogScaleY2:59,DssGraphMarkerShape:60,DssGraphMarkerSize:61,DssGraph2DPlaceX:65,DssGraph2DPlaceY1:66,DssGraph2DPlaceY2:67,DssGraphConnectLine:68,DssGraphShowStepLine:70,DssGraph2ScaleEndX:74,DssGraph2ScaleEndY1:75,DssGraph2ScaleEndY2:76,DssGraph2DScaleFreqO1:87,DssGraph2DScaleFreqO2:88,DssGraph2DScaleFreqX:89,DssGraph2DScaleFreqY1:90,DssGraph2DScaleFreqY2:91,DssGraphScaleX:92,DssGraphScaleY1:93,DssGraphScaleY2:94,DssGraphShowSDDataLineType:96,DssGraphSDRiserType:97,DssGraphShowSDLine:98,DssGraphShowSDCurve:99,DssGraphShowSDLinrCorr:101,DssGraphShowSDLinrExp:102,DssGraphShowSDLinrFormula:103,DssGraphShowSDLinrLine:104,DssGraphShowSDLinrLog:105,DssGraphShowSDLinrNatLog:106,DssGraphShowSDLinrNPoly:107,DssGraphSDPolyFactor:108,DssGraphShowSDMeanLine:109,DssGraphShowSDMOVALine:110,DssGraphShowSDSTDDLine:111,DssGraphShowDataText:113,DssGraphShowDivBiPolar:114,DssGraphShowErrorBar:115,DssGraphShowLegendText:116,DssGraphShow2DO1Label:117,DssGraphShow2DO1:-117,DssGraphShow2DO2:118,DssGraphOffScaleTypeX:119,DssGraphOffScaleTypeY1:120,DssGraphOffScaleTypeY2:121,DssGraphShowQuadrants:122,DssGraphShowRiserShadows:123,DssGraphShow2DXTitle:124,DssGraphShow2DY1Title:125,DssGraphShow2DY2Title:126,DssGraphShow2DXLabel:127,DssGraphShow2DX:-127,DssGraphShow2DY1Label:128,DssGraphShow2DY1:-128,DssGraphShow2DY2Label:129,DssGraphShow2DY2:-129,DssGraphShowZeroLineX:130,DssGraphShowZeroLineY1:131,DssGraphShowZeroLineY2:132,DssGraph2DSideO1:133,DssGraph2DSideO2:134,DssGraph2DSideX:135,DssGraph2DSideY1:136,DssGraph2DSideY2:137,DssGraph2DSDSplitY:140,DssGraphStaggerO1:142,DssGraphStaggerO2:143,DssGraphStaggerX:144,DssGraphStaggerY1:145,DssGraphStaggerY2:146,DssGraphUniformBorders:148,DssGraphPieDepthValue:192,DssGraphPieHoleSizeValue:198,DssGraphPieInset:200,DssGraphPiesPerRowValue:201,DssGraphPieRotationValue:202,DssGraphShowFeeler:204,DssGraphShowLBLFeelerLabel:205,DssGraphShowLBLFeeler:-205,DssGraphShowLBLPie:206,DssGraphShowLBLRing:207,DssGraphDeleteSlice:208,DssGraphDetachSlice:209,DssGraphPieRestore:210,DssGraphPieTiltValue:211,DssGraphPieTiltOn:212,DssGraphShowPolarCoordinateAxis:215,DssGraphShowPolarConnectLines:218,DssGraphStockDataValueType:222,DssGraphShowBubbleGrid:245,DssGraphSDShowDataText:247,DssGraphShowTitleSeries:248,DssGraphConnectStackBars:249,DssGraphLegendBox:250,DssGraphLinkColors:260,DssGraph3DCustomView:265,DssGraph3DGridFloor:277,DssGraph3DGridLWall:278,DssGraph3DGridRiser:279,DssGraph3DGridRWall:280,DssGraph3DColTitleLocation:285,DssGraph3DLYTitleLocation:287,DssGraph3DRowTitleLocation:288,DssGraph3DRYTitleLocation:289,DssGraph3DScalefreqX:299,DssGraph3DScalefreqY:300,DssGraph3DScalefreqZ:301,DssGraphShow3DScatterLine:308,DssGraphShow3DLineToLWall:309,DssGraphShow3DLineToFloor:310,DssGraphShow3DLineToRWall:311,DssGraphSD3DRiserType:312,DssGraphShow3DShowDataLabelsBox:313,DssGraph3DOffScaleTypeX:314,DssGraph3DOffScaleTypeY:315,DssGraph3DOffScaleTypeZ:316,DssGraphShow3DCHeader:318,DssGraphShow3DColTitle:319,DssGraph3DShowDataText:320,DssGraphShow3DLNumber:321,DssGraphShow3DLYTitle:322,DssGraphShow3DRNumber:323,DssGraphShow3DRYTitle:324,DssGraphShow3DRHeader:325,DssGraphShow3DRowTitle:326,DssGraphShow3DFloor:327,DssGraphShow3DLegend:328,DssGraphShow3DLWall:329,DssGraphShow3DRWall:330,DssGraph3DViewStruct:337,DssGraphACMColorModel:549,DssGraphLegendItems:554,DssGraphSeriesColor:556,DssGraphReverseGroup:558,DssGraphReverseSeries:559,DssGraphSeriesByColumn:560,DssGraphAreaBackColor:561,DssGraphAreaTransparency:563,DssGraphAreaColor:564,DssGraphAreaPattern:566,DssGraphAreaSFX:567,DssGraphFontAlign:570,DssGraphFontTransparency:573,DssGraphFontColor:574,DssGraphFontName:576,DssGraphFontRotation:578,DssGraphVirtualFontSize:583,DssGraphFontStyle:584,DssGraphType:585,DssGraphLineTransparency:587,DssGraphLineColor:588,DssGraphLinePattern:589,DssGraphVirtualLineWidth:591,DssGraphFootnoteLocation:592,DssGraphFrameLocation:593,DssGraphSubTitleLocation:594,DssGraphTitleLocation:595,DssGraphShowfootnote:596,DssGraphShowSubtitle:597,DssGraphShowTitle:598,DssGraphFontBox:601,DssGraphFontSize:603,DssGraphLockFontSize:604,DssGraphLineWidth:605,DssGraphAreaAlpha:608,DssGraphLineAlpha:609,DssGraphFontAlpha:610,DssGraphAreaCustomBevelEffect:612,DssGraphFormatDataTextAdv:616,DssGraphFormatXAdv:618,DssGraphFormatY1Adv:619,DssGraphFormatY2Adv:620,DssGraphFormatZAdv:621,DssGraphMiddleValue:630,DssGraphSplitYPosition:631,DssGraphAxisShowUserLine:632,DssGraphAxisUserLineValue:633,DssGraphAxisUserLineAxis:634,DssGraphMarkerLayout:637,DssGraphPieDataValueLoc:638,DssGraphPieDataLabelLoc:639,DssGraph2DOrdSpaceMode:642,DssGraphLegendLock:644,DssGraphGridStepY1:645,DssGraphGridStepY2:646,DssGraphGridStepX:647,DssGraphDataTextShowConnectLine:652,DssGraphGridLineZ:658,DssGraphScaleZ:659,DssGraphStaggerZ:660,DssGraph2ScaleEndZ:662,DssGraph2ExcludeZeroZ:663,DssGraph2ScaleDirectionZ:664,DssGraphGridStepZ:665,DssGraphGaugeInfo:668,DssGraphGaugeFancyBox:669,DssGraphSDMarkerSize:671,DssGraphSDMarkerShape:683,DssGraphMetric1:690,DssGraphMetric2:691,DssGraphStockStyle:692,DssGraph2ScaleDirectionY3:693,DssGraph2ExcludeZeroY3:694,DssGraphGridLineY3:697,DssGraphFormatY3Adv:699,DssGraphGridStepY3:701,DssGraphOffScaleTypeY3:702,DssGraphShow2DY3:704,DssGraph2DSideY3:706,DssGraphStaggerY3:707,DssGraph2DPlaceY3:709,DssGraph2ScaleEndY3:710,DssGraph2DScaleFreqY3:713,DssGraphScaleY3:714,DssGraph2ScaleDirectionY4:715,DssGraph2ExcludeZeroY4:716,DssGraphGridLineY4:719,DssGraphFormatY4Adv:721,DssGraphGridStepY4:723,DssGraphOffScaleTypeY4:724,DssGraphShow2DY4:726,DssGraph2DSideY4:728,DssGraphStaggerY4:729,DssGraph2DPlaceY4:731,DssGraph2ScaleEndY4:732,DssGraph2DScaleFreqY4:735,DssGraphScaleY4:736,DssGraphSpiderLines:739,DssGraphPolarStartAngle:740,DssGraphMetric3:742,DssGraphRadarCircularDataLines:782,DssGraphRemoteAxis:784,DssGraphConnectFirstLast:790,DssGraphGaugeShowAxisLabelsOutside:791,DssGraphGaugeShowNeedle:792,DssGraphTailShape:793,DssGraphPieForceRound:794,DssGraphGaugeStyleValue:795,DssGraphGaugeBorderStyleValue:796,DssGraphGaugeBorderThicknessValue:797,DssGraphGaugeRangeThicknessValue:798,DssGraphGaugeRangeStartAngleValue:799,DssGraphGaugeRangeStopAngleValue:800,DssGraphGaugeNeedleStyleValue:801,DssGraphCurvedLines:804,DssGraphAreaBevelEffect:879,DssGraphFontAntiAlias:881,DssGraphFormatDataTextY3:695,DssGraphFormatDataTextY4:717,DssGraphColorPalette:10000,DssGraphOriContent:10001,DssGraphFillEffect:10002,DssGraphGradient:10003,DssGraphSDShowToolTip:10004,DssGraphSDToolTip:10005,DssGraphSDRegressionType:10006,DssGraph2LogScale:10007,DssGraphManualMajor:10008,DssGraphManualMinor:10009,DssGraph2ScaleDirection:10010,DssGraphShow2DAxisLine:10011,DssGraph2ExcludeZero:10012,DssGraph2ScaleUseMax:10013,DssGraph2ScaleUseMin:10014,DssGraph2ScaleMax:10015,DssGraph2ScaleMin:10016,DssGraphShow2DAxisLabels:10017,DssGraph2ScaleEndMax:10018,DssGraph2ScaleEndMin:10019,DssGraphShow2DAxisMajor:10020,DssGraphShow2DAxisMinor:10021,DssGraph2DSide:10022,DssGraphStyleMajor:10023,DssGraphStyleMinor:10024,DssGraphCountMajor:10025,DssGraphCountMinor:10026,DssGraphShowTotalValue:10027,DssGraph2DPie:10028,DssGraphShowDataValue:10029,DssGraphShowDVPercent:10030,DssGraphShowDataLabel:10031,DssGraphShowPieLabelOnSide:10032,DssGraphShowMarker:10033,DssGraphShowMetric1:10034,DssGraphShowMetric2:10035,DssGraphShowMetric3:10036,DssGraphMetric1Style:10037,DssGraphMetric2Style:10038,DssGraphMetric3Style:10039,DssGraphShowLine:10040,DssGraphShowToolTip:10041,DssGraphToolTip:10042,DssGraphAxisAutoFit:10043,DssGraphAxisStagger:10044,DssGraphAxisScaleFreq:10045,DssGraphMetric1Value:10046,DssGraphMetric2Value:10047,DssGraphMetric3Value:10048,DssGraph2AxisFormatText:10049,DssGraph2AxisFormatDataText:10050,DssGraphDPI:10051,DssGraphDocSize:10052,DssGraphAutoArrange:10053,DssGraph2DSplitYAutomatic:10054,DssGraphHistogramRangeMin:10055,DssGraphHistogramRangeMax:10056,DssGraphHistogramBuckets:10057,DssGraphGaugeSAngle:10058,DssGraphGaugeEAngle:10059,DssGraphGaugeThickness:10060,DssGraphGauge1Show:10061,DssGraphGauge1Min:10062,DssGraphGauge1Max:10063,DssGraphGauge2Show:10064,DssGraphGauge2Min:10065,DssGraphGauge2Max:10066,DssGraphGauge3Show:10067,DssGraphGauge3Min:10068,DssGraphGauge3Max:10069,DssGraphGauge4Show:10070,DssGraphGauge4Min:10071,DssGraphGauge4Max:10072,DssGraphGauge5Show:10073,DssGraphGauge5Min:10074,DssGraphGauge5Max:10075,DssGraphAxisDataTextPlace:10076,DssGraphAxisNumberFormat:10077,DssGraphAxisDataNumberFormat:10078,DssGraphAxisHasErrorBar:10079,DssGraphAxisHasMiddleValue:10080,DssGraphHeight:10081,DssGraphWidth:10082,DssGraphPicture:10083,DssGraph3DTurnXCounterClockwise:10084,DssGraph3DTurnYCounterClockwise:10085,DssGraph3DTurnZCounterClockwise:10086,DssGraph3DTurnXClockwise:10087,DssGraph3DTurnYClockwise:10088,DssGraph3DTurnZClockwise:10089,DssGraph3DMoveXTowardsOrigin:10090,DssGraph3DMoveYTowardsOrigin:10091,DssGraph3DMoveZTowardsOrigin:10092,DssGraph3DMoveXAwayFromOrigin:10093,DssGraph3DMoveYAwayFromOrigin:10094,DssGraph3DMoveZAwayFromOrigin:10095,DssGraph3DDecreaseCubeX:10096,DssGraph3DDecreaseCubeY:10097,DssGraph3DDecreaseCubeZ:10098,DssGraph3DIncreaseCubeX:10099,DssGraph3DIncreaseCubeY:10100,DssGraph3DIncreaseCubeZ:10101,DssGraph3DDecreaseWallX:10102,DssGraph3DDecreaseWallY:10103,DssGraph3DDecreaseWallZ:10104,DssGraph3DIncreaseWallX:10105,DssGraph3DIncreaseWallY:10106,DssGraph3DIncreaseWallZ:10107,DssGraph3DPanXLeft:10108,DssGraph3DPanYUp:10109,DssGraph3DRelative:10110,DssGraph3DPanXRight:10111,DssGraph3DPanYDown:10112,DssGraph3DAbsolute:10113,DssGraph3DZoomIn:10114,DssGraph3DIncreasePerspectiveDistortion:10115,DssGraph3DStepSize:10116,DssGraph3DZoomOut:10117,DssGraph3DDecreasePerspectiveDistortion:10118,DssGraph3DInitMatrix:10119,DssGraphGaugeQBShow:10120,DssGraphGaugeQBStart:10121,DssGraphGaugeQBStop:10122,DssGraphEnhancedSeriesEffect:10123,DssGraphLocale:10124,DssGraph3DViewStructName:10125,DssGraphLabelsDistance:10126,DssGraphLegendDetails:10127,DssGraphDefaultsInitialized:10128,DssGraphShow3DAxisMajor:10129,DssGraphGradientColorMode:10130,DssGraphLegendDetailsNEW:10131,DssGraphFrameLocationNEW:10132,DssGraph3DColTitleLocationNEW:10133,DssGraph3DRowTitleLocationNEW:10134,DssGraphLabelsDistanceNEW:10135,DssGraphDocSizeNEW:10136,DssGraphUseManualHistogramBuckets:10137,DssGraphFontSize100:10138,DssGraphUseSpecialSeries:10140,DssGraphIsOnlyAdditionalMetrics:10170};mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap={DssXmlAxisNone:0,DssXmlAxisRowsBit:1,DssXmlAxisColumnsBit:2,DssXmlAxisPagesBit:4,DssXmlAxisChaptersBit:8};mstrmojo.EnumSelectionType={ALL:0,ELEMENT:1,BRANCH:2,LEVEL:3,BRANCH_LEVEL:4};(function(){function B(J,E){if(!E.domNode){return 0;}var K="_fixed"+J;if(E[K]){return E[K];}var H=E.getFormats(),I=J.toLowerCase();if(H&&H.hasOwnProperty(I)){var F=H[I];if(F.charAt(F.length-1)!=="%"){var G=parseInt(F,10);if(!isNaN(G)){E[K]=G;return G;}}}return(E.domNode["client"+J]||0);}mstrmojo._ContainsDocObjects=mstrmojo.provide("mstrmojo._ContainsDocObjects",{getHeight:function D(){return B("Height",this);},getWidth:function A(){return B("Width",this);},getMaxZIndex:function C(){var F=0;mstrmojo.array.forEach(this.children,function E(G){F=Math.max(F,parseInt(G.getFormats()["z-index"],10));});return F;}});}());(function(){var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",G=String.fromCharCode;function D(H){H=H.replace(/\r\n/g,"\n");var I="";for(var K=0;K<H.length;K++){var J=H.charCodeAt(K);if(J<128){I+=G(J);}else{if((J>127)&&(J<2048)){I+=G((J>>6)|192);I+=G((J&63)|128);}else{I+=G((J>>12)|224);I+=G(((J>>6)&63)|128);I+=G((J&63)|128);}}}return I;}function F(L){var H="",J=0,M=0,K=0,I=0;while(J<L.length){M=L.charCodeAt(J);if(M<128){H+=G(M);J++;}else{if((M>191)&&(M<224)){K=L.charCodeAt(J+1);H+=G(((M&31)<<6)|(K&63));J+=2;}else{K=L.charCodeAt(J+1);I=L.charCodeAt(J+2);H+=G(((M&15)<<12)|((K&63)<<6)|(I&63));J+=3;}}}return H;}mstrmojo.base64=mstrmojo.provide("mstrmojo.base64",{decodeHttpHeader:function E(K){var I=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(K&&K.indexOf("=?UTF-8?B?")===0){var J="",H;while((H=I.exec(K))!==null){J+=mstrmojo.base64.decode(H[1]);}return J;}return K;},encode:function B(J){var H="";var Q,O,M,P,N,L,K;var I=0;J=D(J);while(I<J.length){Q=J.charCodeAt(I++);O=J.charCodeAt(I++);M=J.charCodeAt(I++);P=Q>>2;N=((Q&3)<<4)|(O>>4);L=((O&15)<<2)|(M>>6);K=M&63;if(isNaN(O)){L=K=64;}else{if(isNaN(M)){K=64;}}H+=A.charAt(P)+A.charAt(N)+A.charAt(L)+A.charAt(K);}return H;},decode:function C(J){var H="",I=0;var Q,O,M,P,N,L,K;J=J.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(I<J.length){P=A.indexOf(J.charAt(I++));N=A.indexOf(J.charAt(I++));L=A.indexOf(J.charAt(I++));K=A.indexOf(J.charAt(I++));Q=(P<<2)|(N>>4);O=((N&15)<<4)|(L>>2);M=((L&3)<<6)|K;H+=G(Q);if(L!==64){H+=G(O);}if(K!==64){H+=G(M);}}H=F(H);return H;}});})();mstrmojo.mstr.EnumNodeProperties={NORMAL:0,DRILL:1,CONDITION:2};mstrmojo.chart.model.enums.EnumDSSGraphDataTextShowType={DssGraphDataTextNone:0,DssGraphDataTextValue:1,DssGraphDataTextLabel:2,DssGraphDataTextBoth:3,DssGraphDataTextAbs:4,DssGraphDataTextAbsValue:5,DssGraphDataTextAbsBoth:7,DssGraphDataTextTotal:8,DssGraphDataTextZValue:16,DssGraphDataTextPercent:32,DssGraphDataTextYValue:64,DssGraphDataTextInternal:128,DssGraphDataTextSeriesDependent:256,DssGraphDataTextQualityObjectMode:512};(function(){var B={NetworkVisualizationStyle:{b:"vi-network.js",s:"VisualizationServerJsonDataStyle",c:"netviz.VisNetwork",oivmb:"oivm-network.js",vib:"vi-network.js"},ReportTimelineAjaxVisualizationStyle:{s:"TimelineMojoVisualizationDataStyle",c:"VisTimeline"},visAjaxDatePicker:{s:"AjaxDatePickerReportStyle",c:"VisDateSelection"},SurveyVisualizationStyle:{s:"VisualizationDataStyle",c:"SurveyVis"},VIHeatMapVisualizationStyle:{b:"vi-heatmap.js",s:"VisualizationServerJsonDataStyle",c:"heatmap.vi.VisHeatMap",oivmb:"oivm-heatmap.js",vib:"vi-heatmap.js"},KPICardVisualizationStyle:{b:"vi-kpi.js",s:"VisualizationServerJsonDataStyle",c:"kpicard.VisKPICard",lib:'[["libraries/echarts.common.min.js"],["libraries/slick/slick.min.js"]]'},GraphMatrixVisualizationStyle:{b:"vi-gm.js",s:"VisualizationServerJsonDataStyle",c:"gm.VisGraphMatrix",oivmb:"oivm-gm.js",vib:"vi-gm.js"},ESRIMapVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"VisMapBase"},MapboxVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"mapbox.VisMapbox",lib:'[["libraries/mapbox/mapbox-gl.js"],["libraries/mapbox/supercluster.min.js"],["libraries/mapbox/turf.min.4.7.3.js"]]'},NewGraphMatrixVisualizationStyle:{b:"vi-ngm.js",s:"VisualizationServerJsonDataStyle",c:"ngm.VisNewGraphMatrix",lib:'[["../VisFramework/ngm/dist/bundle/ngm.js"]]',oivmb:"oivm-ngm.js",vib:"vi-ngm.js"},GoogleMapVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"VisMapBase"}};var E={"com.microstrategy.web.vf.viewer.EsriMapApplicationViewer":"ESRIMapVisualizationStyle","com.microstrategy.web.vf.viewer.HeatMapApplicationViewer":"VIHeatMapVisualizationStyle","com.microstrategy.flex.viewer.GraphMatrixViewer":"GraphMatrixVisualizationStyle","com.microstrategy.flex.viewer.NewGraphMatrixViewer":"NewGraphMatrixVisualizationStyle","com.microstrategy.web.vf.viewer.DatePickerApplicationViewer":"visAjaxDatePicker","com.microstrategy.flex.viewer.NetViz":"NetworkVisualizationStyle"};mstrmojo.ExpressVisList=mstrmojo.provide("mstrmojo.ExpressVisList",{getVis:function D(F){return B[F]||(mstrConfig&&mstrConfig.pluginsVisList&&mstrConfig.pluginsVisList[F])||null;},findVisName:function(F){return E[F]||(mstrConfig&&mstrConfig.pluginsWidgetVisMap[F])||null;},findWidgetName:function C(H){var G;for(var F in E){if(E.hasOwnProperty(F)&&E[F]===H){G=F;break;}}if(!G&&mstrConfig&&mstrConfig.pluginsWidgetVisMap){for(var F in mstrConfig.pluginsWidgetVisMap){if(mstrConfig.pluginsWidgetVisMap.hasOwnProperty(F)&&mstrConfig.pluginsWidgetVisMap[F]===H){G=F;break;}}}return G;},getVisClass:function A(F,G){if(G.txi&&G.t===115){F=mstrmojo.DynamicClassFactory.newComponent(F,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab]);}return F;}});}());mstrmojo.vi.viz.EnumVisualizationTemplates={UNKNOWN_GRAPHMATRIX_TYPE:-1,GRID:0,HEATMAP:1,GOOGLEMAP:2,PIE:3,RING:4,GRAPHMATRIXVERTICALBARSTACKED:6,GRAPHMATRIXVERTICALBARCLUSTERED:7,GRAPHMATRIXVERTICALBARPERCENT:8,GRAPHMATRIXHORIZONTALBARSTACKED:9,GRAPHMATRIXHORIZONTALBARCLUSTERED:10,GRAPHMATRIXHORIZONTALBARPERCENT:11,GRAPHMATRIXVERTICALLINESTACKED:12,GRAPHMATRIXVERTICALLINECLUSTERED:13,GRAPHMATRIXVERTICALLINEPERCENT:14,GRAPHMATRIXHORIZONTALLINESTACKED:15,GRAPHMATRIXHORIZONTALLINECLUSTERED:16,GRAPHMATRIXHORIZONTALLINEPERCENT:17,GRAPHMATRIXSCATTERCIRCLEMM:18,GRAPHMATRIXSCATTERGRIDCIRCLEAA:19,GRAPHMATRIXBUBBLECIRCLEMM:21,GRAPHMATRIXBUBBLEGRIDCIRCLEAA:22,GRAPHMATRIXSCATTERSQUAREAM:23,GRAPHMATRIXSCATTERSQUAREMM:24,GRAPHMATRIXSCATTERGRIDSQUAREAA:25,GRAPHMATRIXBUBBLESQUAREAM:26,GRAPHMATRIXBUBBLESQUAREMM:27,GRAPHMATRIXBUBBLEGRIDSQUAREAA:28,GRAPHHORIZONTALBARCLUSTERED:29,GRAPHMATRIXVERTICALAREASTACKED:30,GRAPHMATRIXVERTICALAREAPERCENT:31,GRAPHMATRIXVERTICALAREACLUSTERED:32,GRAPHMATRIXHORIZONTALAREASTACKED:40,GRAPHMATRIXHORIZONTALAREAPERCENT:41,GRAPHMATRIXHORIZONTALAREACLUSTERED:42,GRAPHHORIZONTALBARDUALAXISCLUSTERED:33,GRAPHHORIZONTALBARDUALAXISABSOLUTE:34,GRAPHHORIZONTALLINEABSOLUTE:35,GRAPHHORIZONTALLINEDUALAXISABSOLUTE:36,GRAPHHORIZONTALAREAABSOLUTE:37,GRAPHHORIZONTALAREADUALAXISABSOLUTE:38,GRAPHVERTICALBARCLUSTERED:39,GRAPHVERTICALBARDUALAXISCLUSTERED:43,GRAPHVERTICALBARDUALAXISABSOLUTE:44,GRAPHVERTICALBARDUALAXISSTACKED:45,GRAPHVERTICALLINEABSOLUTE:46,GRAPHVERTICALLINESTACKED:47,GRAPHVERTICALLINEPERCENT:48,GRAPHVERTICALLINEDUALAXISABSOLUTE:49,GRAPHVERTICALLINEDUALAXISSTACKED:50,GRAPHVERTICALAREAABSOLUTE:51,GRAPHVERTICALAREAPERCENT:52,GRAPHVERTICALAREASTACKED:53,GRAPHVERTICALAREADUALAXISABSOLUTE:54,GRAPHVERTICALAREADUALAXISSTACKED:55,GRAPHCOMBINATIONBARAREA:56,GRAPHCOMBINATIONBARAREADUALAXIS:57,NETWORK:58,IMAGELAYOUT:59,GOOGLEMAPDENSITY:60,GRAPHMATRIXPIE:61,GRAPHMATRIXRING:62,GRAPHHORIZONTALBARABSOLUTE:63,GRAPHHORIZONTALBARPERCENT:64,GRAPHHORIZONTALBARSTACKED:65,GRAPHVERTICALBARABSOLUTE:66,GRAPHVERTICALBARPERCENT:67,GRAPHVERTICALBARSTACKED:68,ESRIMAP:69,GRAPHMATRIXVERTICALBARAUTOMATIC:70,GRAPHMATRIXHORIZONTALBARAUTOMATIC:71,GRAPHMATRIXVERTICALLINEAUTOMATIC:72,GRAPHMATRIXHORIZONTALLINEAUTOMATIC:73,GRAPHMATRIXVERTICALAREAAUTOMATIC:74,GRAPHMATRIXHORIZONTALAREAAUTOMATIC:75,GRAPHMATRIXVERTICALHISTOGRAM:76,GRAPHMATRIXGRIDCHART:78,GRAPHMATRIXVERTICALBOXPLOT:79,GRAPHMATRIXHORIZONTALBOXPLOT:80,GRAPHMATRIXVERTICALWATERFALL:81,GRAPHMATRIXHORIZONTALWATERFALL:82,KPICARD:83};var T=mstrmojo.vi.viz.EnumVisualizationTemplates;mstrmojo.vi.viz.EnumAggregatedVisTemplates={COMBOCHART:[T.GRAPHHORIZONTALBARDUALAXISCLUSTERED,T.GRAPHHORIZONTALBARDUALAXISABSOLUTE,T.GRAPHHORIZONTALLINEDUALAXISABSOLUTE,T.GRAPHHORIZONTALAREADUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISCLUSTERED,T.GRAPHVERTICALBARDUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISSTACKED,T.GRAPHVERTICALLINEDUALAXISABSOLUTE,T.GRAPHVERTICALLINEDUALAXISSTACKED,T.GRAPHVERTICALAREADUALAXISABSOLUTE,T.GRAPHVERTICALAREADUALAXISSTACKED,T.GRAPHCOMBINATIONBARAREADUALAXIS,T.GRAPHCOMBINATIONBARAREA],BUBBLECHART:[T.GRAPHMATRIXSCATTERCIRCLEMM,T.GRAPHMATRIXSCATTERGRIDCIRCLEAA,T.GRAPHMATRIXBUBBLECIRCLEMM,T.GRAPHMATRIXBUBBLEGRIDCIRCLEAA,T.GRAPHMATRIXSCATTERSQUAREAM,T.GRAPHMATRIXSCATTERSQUAREMM,T.GRAPHMATRIXSCATTERGRIDSQUAREAA,T.GRAPHMATRIXBUBBLESQUAREAM,T.GRAPHMATRIXBUBBLESQUAREMM,T.GRAPHMATRIXBUBBLEGRIDSQUAREAA],BARCHART:[T.GRAPHMATRIXVERTICALBARSTACKED,T.GRAPHMATRIXVERTICALBARCLUSTERED,T.GRAPHMATRIXVERTICALBARPERCENT,T.GRAPHMATRIXHORIZONTALBARSTACKED,T.GRAPHMATRIXHORIZONTALBARCLUSTERED,T.GRAPHMATRIXHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARCLUSTERED,T.GRAPHVERTICALBARCLUSTERED,T.GRAPHHORIZONTALBARABSOLUTE,T.GRAPHHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARSTACKED,T.GRAPHVERTICALBARABSOLUTE,T.GRAPHVERTICALBARPERCENT,T.GRAPHVERTICALBARSTACKED,T.GRAPHMATRIXVERTICALBARAUTOMATIC,T.GRAPHMATRIXHORIZONTALBARAUTOMATIC],LINECHART:[T.GRAPHMATRIXVERTICALLINESTACKED,T.GRAPHMATRIXVERTICALLINECLUSTERED,T.GRAPHMATRIXVERTICALLINEPERCENT,T.GRAPHMATRIXHORIZONTALLINESTACKED,T.GRAPHMATRIXHORIZONTALLINECLUSTERED,T.GRAPHMATRIXHORIZONTALLINEPERCENT,T.GRAPHHORIZONTALLINEABSOLUTE,T.GRAPHVERTICALLINEABSOLUTE,T.GRAPHVERTICALLINESTACKED,T.GRAPHVERTICALLINEPERCENT,T.GRAPHMATRIXVERTICALLINEAUTOMATIC,T.GRAPHMATRIXHORIZONTALLINEAUTOMATIC],PIECHART:[T.PIE,T.RING,T.GRAPHMATRIXPIE,T.GRAPHMATRIXRING],AREACHART:[T.GRAPHMATRIXVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAPERCENT,T.GRAPHMATRIXVERTICALAREACLUSTERED,T.GRAPHMATRIXHORIZONTALAREASTACKED,T.GRAPHMATRIXHORIZONTALAREAPERCENT,T.GRAPHMATRIXHORIZONTALAREACLUSTERED,T.GRAPHHORIZONTALAREAABSOLUTE,T.GRAPHVERTICALAREAABSOLUTE,T.GRAPHVERTICALAREAPERCENT,T.GRAPHVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAAUTOMATIC,T.GRAPHMATRIXHORIZONTALAREAAUTOMATIC],HISTOGRAM:[T.GRAPHMATRIXVERTICALHISTOGRAM,],BOXPLOT:[T.GRAPHMATRIXVERTICALBOXPLOT,T.GRAPHMATRIXHORIZONTALBOXPLOT],WATERFALL:[T.GRAPHMATRIXVERTICALWATERFALL,T.GRAPHMATRIXHORIZONTALWATERFALL]};(function(){mstrmojo.vi._MonitorsLayoutMode=mstrmojo.provide("mstrmojo.vi._MonitorsLayoutMode",{onLayoutModeChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("layoutModeChange",this.id,"onLayoutModeChange");}}});}());mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,UNITCONTAINER:11,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());(function(){mstrmojo.vi._MonitorsAppState=mstrmojo.provide("mstrmojo.vi._MonitorsAppState",{onAppStateChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("appStateChange",this.id,"onAppStateChange");}}});}());mstrmojo.chart.enums.EnumGraphMajorType={GMT_INVALID:0,GMT_CATEGORY:1,GMT_PIE:2,GMT_SCATTER:3,GMT_POLAR:4,GMT_RADAR:5,GMT_BUBBLE:6,GMT_STOCK:7,GMT_HISTOGRAM:8,GMT_GAUGE:9,GMT_FUNNEL:10,GMT_BOX:11,GMT_GANTT:12,GMT_SPECTRAL:13,GMT_TABLE:14,GMT_3D_CATEGORY:15,GMT_3D_SCATTER:16,GMT_GRID:17};(function(){mstrmojo.ui.editors._HostsControls=mstrmojo.provide("mstrmojo.ui.editors._HostsControls",{_mixinName:"mstrmojo.ui.editors._HostsControls",setFormatSource:function D(F){this.throwAbstractMethodError("setFormatSource");},syncControls:function A(F){var G=this._sync;this._sync=true;F.call(this);this._sync=G;},raiseFormatValueChange:function E(G,H,F){if(this._sync){return false;}this.onGroupValueChange(G,H,F);return true;},raiseFormatLayoutChange:function B(G,H,F){if(this._sync){return false;}this.onGroupLayoutChange(G,H,F);return true;},onGroupValueChange:function C(G,H,F){},onGroupLayoutChange:mstrmojo.emptyFn});}());mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};(function(){mstrmojo._SupportPagination=mstrmojo.provide("mstrmojo._SupportPagination",{_mixinName:"mstrmojo._SupportPagination",supportPagination:true,getPaginationContainer:function D(){return this.domNode;},preExport:function C(){var J=this.getPaginationContainer();if(!J){return ;}var Q=Math.ceil(J.scrollHeight/J.clientHeight)*J.clientHeight,M=Math.ceil(J.scrollWidth/J.clientWidth)*J.clientWidth,N=1,K=1,L=this.canScrollRight()&&Math.abs(M-J.scrollWidth)>N,O=this.canScrollDown()&&Math.abs(Q-J.scrollHeight)>N,P=Math.abs(J.scrollWidth-J.clientWidth)>N,H=Math.abs(J.scrollHeight-J.clientHeight)>N;if(!O||!H){Q=K;}if(!L||!P){M=K;}if(L||O){var I=document.createElement("div");I.innerHTML='<div style="display: inline-block; width: '+M+"px; height: "+Q+'px; visibility: hidden; position: absolute; left: 0; top: 0"></div>';J.appendChild(I.firstElementChild);}},postExport:mstrmojo.emptyFn,canScrollDown:function E(){var H=this.getPaginationContainer();return H&&Math.ceil(H.scrollTop+H.clientHeight)<Math.floor(H.scrollHeight);},canScrollRight:function G(){var H=this.getPaginationContainer();return H&&Math.ceil(H.scrollLeft+H.clientWidth)<Math.floor(H.scrollWidth);},prePrint:mstrmojo.emptyFn,postPrint:mstrmojo.emptyFn,scrollToNextVerticalPage:function B(){if(!this.canScrollDown()){return Promise.reject(new Error("Scrolled to the end vertically."));}var H=this.getPaginationContainer();if(!H){return Promise.reject(new Error("Failed to get container node."));}var I=H.scrollTop;H.scrollTop+=H.clientHeight;if(Math.abs(H.scrollTop-I)<1){return Promise.reject(new Error("Try to scroll down but failed."));}else{return new Promise(function(K,J){setTimeout(K,0);});}},scrollToNextHorizontalPage:function F(){if(!this.canScrollRight()){return Promise.reject(new Error("Scrolled to the end horizontally."));}var H=this.getPaginationContainer();if(!H){return Promise.reject(new Error("Failed to get container node."));}var I=H.scrollLeft;H.scrollLeft+=H.clientWidth;if(Math.abs(H.scrollLeft-I)<1){return Promise.reject(new Error("Try to scroll right but failed."));}else{return new Promise(function(K,J){setTimeout(K,0);});}},scrollToFirstHorizontalPage:function A(){var H=this.getPaginationContainer();if(!H){return Promise.reject(new Error("Failed to get container node."));}return new Promise(function(J,I){H.scrollLeft=0;setTimeout(function(){if(H.scrollLeft===0){J();}else{I(new Error("Try to scroll to leftmost side but failed."));}},0);});},});}());(function(){function B(L,Q,N){var M,O;M=0;if(N){M=Math.max(L,L-Q);M=Math.max(M,-Q);}else{M=L-Q;}if(M===0){this.mIsShown=false;return 1;}var P=M;O=1;while(M<1){M*=10;O/=10;}while(M>=10){M/=10;O*=10;}if(M<1.8){O*=2;O/=10;}else{if(M<3.1){O*=4;O/=10;}else{if(M<4.6){O*=5;O/=10;}else{if(M>=8.1){O*=2;}}}}return O;}function K(P){var L,N;this.mStep=B.call(this,this.mMaximum,this.mMinimum,P.mAlwaysIncludeZero);this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:this.mMinTick;if(P.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}var M=this.mMaxTick-this.mMinTick;if(this.mStep>=M){return ;}L=Math.floor((this.mMaxTick-this.mMinTick+this.mStep/100)/this.mStep)+1;for(N=1;N<L-1;++N){var O=this.mMinTick+N*this.mStep;this.mTicks.push(O);}}function C(M){var L;this.mMaxTick=1;this.mStep=this.mMinimum<0?0.2:0.1;if(M.mUseCustomMinMax){this.mMaxTick=M.mAxisMaxValue;this.mMinTick=M.mAxisMinValue;this.mMaxTick=Math.min(1,this.mMaxTick);this.mMinTick=Math.max(-1,this.mMinTick);this.mStep=0.1;}else{if(this.mMaximum>=0.5){this.mMaxTick=1;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:(this.mMinTick>0?0:this.mMinTick);if(this.mMinimum<-0.5){this.mMinTick=-1;}}else{if(this.mMaximum>0){this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=-1;}else{this.mStep=0.1;this.mMaxTick=0;this.mMinTick=-1;}}}for(L=this.mMinTick+this.mStep;L+0.01<this.mMaxTick;L+=this.mStep){this.mTicks.push(Math.round(L*100)/100);}}function I(L){return Math.log(L)/Math.log(10);}function H(O){var N,L,M;this.mStep=1;if(this.mMaximum<=0){this.mMinTick=1;this.mMaxTick=10;return ;}if(this.mMinimum<=0){L=this.mMaximum>1?0:-1;this.mMinTick=Math.pow(10,L);if(O.mUseCustomMinMax){this.mMaxTick=this.mMaximum;N=Math.floor(I.call(this,this.mMaximum));if(I.call(this,this.mMaximum)===N){N--;}}else{N=Math.ceil(I.call(this,this.mMaximum));this.mMaxTick=Math.pow(10,N);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}return ;}if(O.mUseCustomMinMax){N=I.call(this,this.mMaximum);L=I.call(this,this.mMinimum);this.mMaxTick=this.mMaximum;this.mMinTick=this.mMinimum;}else{N=Math.ceil(I.call(this,this.mMaximum));L=Math.floor(I.call(this,this.mMinimum));this.mMaxTick=Math.pow(10,N);this.mMinTick=Math.pow(10,L);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}}function J(L){this.mTicks.splice(0,this.mTicks.length);if(this.mIsPercent){return C.call(this,L);}if(L.mUseLogarithmicScale){return H.call(this,L);}K.call(this,L);}function G(Q){if(Q.mUseCustomMinMax||Q.mUseLogarithmicScale){return ;}var M=0.1,O=false,L=false,P=[];this.GetTicks(P);if(P.length>=2){var N=P.length;L=((Math.abs(this.mMaximum-P[N-2])<M*this.mStep));O=((Math.abs(this.mMinimum-P[1])<M*this.mStep));if(this.mIsPercent){L=false;}}if(L&&O){this.mMinTick=this.mMinimum;this.mMaxTick=this.mMaximum;Q.mUseMinValue=Q.mShowMinLabel=true;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(L){this.mMaxTick=this.mMaximum;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(O){this.mMinTick=this.mMinimum;Q.mUseMinValue=Q.mShowMinLabel=true;}else{}}}if(Q.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}}mstrmojo.chart.common.ScalePlate=mstrmojo.provide("mstrmojo.chart.common.ScalePlate",{mOptions:{mShowMinLabel:true,mShowMaxLabel:true},isStackedChart:false,mStep:0,mIsPercent:false,mMinimum:0,mMaximum:0,mMaxTick:0,mMinTick:0,mTicks:[],clear:function F(){this.isStackedChart=this.mIsPercent=false;this.mMinimum=this.mMaximum=0;this.mMinTick=this.mMaxTick=0;this.mStep=0;this.mTicks=[];},GetTicks:function A(M){if(this.mOptions.mShowMinLabel){M.push(this.mMinTick);}var L;for(L=0;L<this.mTicks.length;++L){M.push(this.mTicks[L]);}if(this.mOptions.mShowMaxLabel){M.push(this.mMaxTick);}},getMaxMinTickValue:function D(O,N,L,M){this.computeTicks(O,N,L,M);return{Max:this.mMaxTick,Min:this.mMinTick};},computeTicks:function E(Q,P,L,N){this.mMinimum=N;this.mMaximum=L;this.mIsPercent=!!(P&1);this.isStackedChart=!!(P&2);var O=1e-14;if(!Q.mUseLogarithmicScale&&this.isStackedChart){this.mMinimum=Math.min(this.mMinimum,0);this.mMaximum=Math.max(this.mMaximum,0);}if(Q.mDrawCustomLine){this.mMinimum=Math.min(this.mMinimum,Q.mAxisCustomValue);this.mMaximum=Math.max(this.mMaximum,Q.mAxisCustomValue);}if(this.mIsPercent&&this.mMinimum===this.mMaximum&&1===this.mMaximum){if(this.mMinimum===1){this.mMinimum=0;}}if(Math.abs(this.mMinimum-this.mMaximum)<O){if(this.mMinimum<-O||this.mMinimum>O){var M=Math.abs(this.mMinimum)*0.5;this.mMaximum=this.mMaximum+M;this.mMinimum=this.mMinimum-M;}else{this.mMinimum=-6;this.mMaximum=6;}}J.call(this,Q);if(Q.mUseLogarithmicScale&&this.isStackedChart){this.mMaximum=Q.mDrawCustomLine?Math.max(this.mMaximum+this.mMinTick,Q.mAxisCustomValue):this.mMaximum+this.mMinTick;this.mMinimum=Math.min(this.mMinimum,0);this.mTicks.splice(0,this.mTicks.length);H.call(this,Q);}G.call(this,Q);}});}());(function(){mstrmojo.vi.ui._IsUnitContainerTitleBar=mstrmojo.provide("mstrmojo.vi.ui._IsUnitContainerTitleBar",{_mixinName:"mstrmojo.vi.ui._IsUnitContainerTitleBar",layoutConfig:{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},xt:true},setDimensions:function A(D,C){return this._super("auto",C);},getTitleChildrenLayoutOffsets:function B(){return{h:0,w:12};}});}());(function(){function Z(c){var d=[].slice.call(c),e=d[d.length-1],f=function(h,g){return h===g;};if(/function|string/.test(typeof e)){f=typeof e==="function"?e:function(h,g){return h[e]===g[e];};d=d.slice(0,d.length-1);}return{sets:d,compareFunc:f};}mstrmojo.array=mstrmojo.provide("mstrmojo.array",{indexOf:function D(d,f){var c=(d&&d.length)||0,e;for(e=0;e<c;e++){if(d[e]==f){return e;}}return -1;},includes:function(c,d){if(!c||!c.length){return false;}return c.indexOf(d)>-1;},indexOfMulti:function V(c,d){var h=[],g={},f=0,e=this;e.forEach(c,function(j,i){e.forEach(d,function(k,l){var m=(k===j);if(m){h[l]=g[l]=i;f++;}return !m;});});return{indices:h.length?h:null,map:g,count:f};},forEach:function S(d,j,g){var c=(d&&d.length)||0,e;for(e=0;e<c;e++){var h=e===(c-1);if(g){if(j.call(g,d[e],e,d,h)===false){break;}}else{if(j(d[e],e,d,h)===false){break;}}}return d;},map:function a(d,h){var c=(d&&d.length)||0,e=[],g;for(g=0;g<c;g++){e[g]=h(d[g],g);}return e;},filter:function J(e,f,g){var k=[],j=0,d=(e&&e.length)||0,c=(g&&g.max)||0,h;for(h=0;h<d;h++){if(f(e[h],h,e)){k[j]=e[h];j++;if(c&&j>=c){break;}}}return k;},filterOne:function M(c,d){var e=this.filter(c,d,{max:1});if(e.length){return e[0];}return null;},ensureArray:function Q(c){return[].concat(c||[]);},find:function N(d,h,e){var c=(d&&d.length)||0,f;for(f=0;f<c;f++){var g=d[f];if(g&&g[h]==e){return f;}}return -1;},distinct:function B(d,h){if(d.reduce&&!h){return d.reduce(function(j,i){if(j.indexOf(i)<0){j.push(i);}return j;},[]);}var c=(d&&d.length)||0,e,g,f=[];for(e=0;e<c;e++){g=d[e];if((g!==undefined)&&((h&&this.find(f,h,g[h])<0)||(!h&&this.indexOf(f,g)<0))){f.push(g);}}return f;},findBin:function E(e,j,k,d){var i=(d||e.length)-1,f=0,c,g=j[k];while(i-f>1){if(e[c=i+f>>1][k]<g){f=c;}else{i=c;}}if(e[f][k]===g){return f;}return e[i][k]===g?i:-1;},search:function I(k,f,i){var g=k.length,e=-1,d,j=f.toUpperCase(),c=f.length;while(g-e>1){if(k[d=g+e>>1][i].substr(0,c).toUpperCase()<j){e=d;}else{g=d;}}return g;},findMulti:function R(l,e,o){if(!o){return{indices:null,map:{},count:0};}var m=o.length,s=[],d={},p=0,g=(l&&l.length)||0,h;for(h=0;h<g;h++){var q=l[h][e],f;for(f=0;f<m;f++){if(o[f][e]===q){s[f]=h;d[f]=h;p++;break;}}}return{indices:s,map:d,count:p};},removeItem:function Y(c,e){var d=this.indexOf(c,e);if(d>-1){this.removeIndices(c,d,1);}return d;},removeItems:function O(c,h,d){var e=this.findMulti(c,h,d);if(e.count){var g=e.indices.concat().sort(this.numSorter).slice(0,e.count),f;for(f=g.length-1;f>-1;f--){c.splice(g[f],1);}}},numSorter:function b(d,c){return Number(d)-Number(c);},stringSorter:function K(e,d){var c=e.toLowerCase(),f=d.toLowerCase();if(c<f){return -1;}if(c>f){return 1;}return 0;},objectKeySorter:function(d,c){if(typeof c==="undefined"){c="asc";}return function(f,e){if(!f.hasOwnProperty(d)||!e.hasOwnProperty(d)){return 0;}var h=(typeof f[d]==="string")?f[d].toUpperCase():f[d];var g=(typeof e[d]==="string")?e[d].toUpperCase():e[d];var i=0;if(h>g){i=1;}else{if(h<g){i=-1;}}return((c==="asc")?i:(i*-1));};},removeIndices:function P(c,e,d){c.splice(e,d);},insert:function F(d,c,e){if(!d){d=[];}if(c===null||c===undefined){c=d.length;}Array.prototype.splice.apply(d,[c,0].concat(e));return d;},hash:function C(d,f){f=f||{};var c=(d&&d.length)||0,e;for(e=0;e<c;e++){f[d[e]]=true;}return f;},get:function W(d,g){if(!g){return null;}var e=[],c=g.length,f;for(f=0;f<c;f++){e[f]=d[g[f]];}return e;},deepSortArr:function G(d,f,c,e){return d.sort(function(i,g){var j=i[c][f],h=g[c][f];if(!e){return(j<=h);}return(j>h)?-1:1;});},isArray:function(c){var d=Array.isArray;if(d){return d(c);}return Object.prototype.toString.call(c)==="[object Array]";},some:function L(d,e){if(!d){return false;}if(d.some){return d.some(e);}var c=false;this.forEach(d,function(g,f){c=e(g,f,d);return !c;});return c;},difference:function X(){if(arguments.length<2){throw new Error("difference should get at least 2 parameters");}var f=Z(arguments),d=f.sets,e=f.compareFunc,g=d[0],c=[].concat.apply([],d.slice(1));return g.filter(function(h){return !c.some(function(i){return e(h,i);});});},intersection:function U(){if(arguments.length<2){throw new Error("intersection should get at least 2 parameters");}var g=Z(arguments),e=g.sets,f=g.compareFunc,c=e[0],d=e.slice(1);d.forEach(function(h){c=c.filter(function(i){return h.some(function(j){return f(i,j);});});});return c;},fnReduceNumber:function A(c,d){return c+d;},applyLargeArray:function H(f,i,k,l){var g=f.length,j=1000,c,d,e,h=k;if(g){for(c=0,d=j;c<g;c=d,d+=j){e=i.apply(l,f.slice(c,d));h=i.apply(l,[h,e]);}}else{h=i.apply(l,f);}return h;}});}());mstrmojo.mstr.EnumDSSXMLDrillType={DssXmlDrillReserved:0,DssXmlDrillToParent:1,DssXmlDrillToChild:2,DssXmlDrillToUnit:3,DssXmlDrillToTemplate:4,DssXmlDrillToForm:5,DssXmlDrillToDetails:6,DssXmlDrillToMetric:7,DssXmlDrillFixTemplate:8,DssXmlDrillRemoveMetric:9,DssXmlDrillRemoveUnit:10,DssXmlDrillToGraphCoordinates:11};mstrmojo.mstr.EnumDSSXMLObjectSubTypes={Unknown:-1,Reserved:0,Filter:256,CustomGroup:257,Template:512,ReportGrid:768,ReportGraph:769,ReportEngine:770,ReportText:771,ReportDatamart:772,ReportBase:773,ReportGridAndGraph:774,ReportNonInteractive:775,ReportCube:776,ReportIncrementalRefresh:777,ReportTransaction:778,ReportEmmaCube:779,ReportEmmaIncrementalRefresh:780,Metric:1024,SubtotalDefinition:1025,SystemSubtotal:1026,MetricDMX:1027,DssSubTypeMetricTraining:1028,Style:1536,AggMetric:1792,Folder:2048,Device:2304,Prompt:2560,PromptBoolean:2561,PromptLong:2562,PromptString:2563,PromptDouble:2564,PromptDate:2565,PromptObjects:2566,PromptElements:2567,PromptExpression:2568,PromptExpressionDraft:2569,PromptDimty:2570,PromptBigDecimal:2571,Function:2816,Attribute:3072,AttributeRole:3073,AttributeTransformation:3074,AttributeAbstract:3075,AttributeRecursive:3076,Fact:3328,DimensionSystem:3584,DimensionUser:3585,DimensionOrdered:3586,DimensionUserHierarchy:3587,Table:3840,TablePartitionMD:3841,TablePartitionWH:3842,DatamartReport:4096,FactGroup:4352,Resolution:4864,AttributeForm:5376,FormSystem:5377,FormNormal:5378,Schema:5632,Format:5888,Catalog:6144,CatalogDefn:6400,Column:6656,PropertyGroup:6912,PropertySet:7168,DBRole:7424,DBRoleDataImport:7425,DBRoleOAuth:7427,DBRoleGenericDataConnector:7430,DBLogin:7680,DBConnection:7936,Project:8192,ServerDef:8448,User:8704,UserGroup:8705,Transmitter:8705,Configuration:9216,Request:9472,Search:9984,SearchFolder:10240,Datamart:10496,FunctionPackageDefinition:10752,Role:11008,RoleTransformation:11009,SecurityRole:11264,InBox:11520,InBoxMsg:11776,Consolidation:12032,ConsolidationManaged:12033,ConsolidationElement:12288,ScheduleEvent:12544,ScheduleObject:12800,ScheduleTrigger:13056,Link:13312,DBTable:13568,DBTablePMT:13569,TableSource:13824,DocumentDefinition:14080,ReportWritingDocument:14081,DocumentTheme:14082,DrillMap:14336,DBMS:14592,MDSecurityFilter:14848,MonitorPerformance:15104,MonitorJobs:15105,MonitorUserConnections:15106,MonitorDBConnections:15107,PromptAnswer:15232,PromptAnswers:15360,PromptAnswerBoolean:15233,PromptAnswerLong:15234,PromptAnswerString:15235,PromptAnswerDouble:15236,PromptAnswerDate:15237,PromptAnswerObjects:15238,PromptAnswerElements:15239,PromptAnswerExpression:15240,PromptAnswerExpressionDraft:15241,PromptAnswerDimty:15242,PromptAnswerBigDecimal:15243,PromptAnswerInt64:15244,GraphStyle:15616,ChangeJournalSearch:15872,BlobUnknown:16128,BlobOther:16129,BlobImage:16130,BlobProjectPackage:16131,BlobExcel:16132,BlobHTMLTemplate:16133,DashboardTemplate:16384,Flag:16640,ChangeJournal:16896,ExternalShortcutUnknown:17152,ExternalShortcutURL:17153,ExternalShortcutSnapshot:17154,ExternalShortcutTarget:17408,Reconciliation:17664,DerivedAttribute:3077,PaletteSystem:17920,PaletteCustom:17921,Thresholds:18432,SubscriptionAddress:65281,SubscriptionContact:65282,SubscriptionInstance:65283};(function(){mstrmojo._Fetchable=mstrmojo.provide("mstrmojo._Fetchable",{_mixinName:"mstrmojo._Fetchable",blockBegin:1,blockCount:-1,concat:false,items:null,size:function A(){var B=this.items;return(B&&B.length)||0;},next:function(B){if(this.hasNext()){this.getItems(this.blockBegin+this.blockCount,B);}},previous:function(B){if(this.hasPrevious()){var C=this.blockBegin-this.blockCount;C=C<0?0:C;this.getItems(C,B);}},getItems:function(H,F,B){F=F||{};var E=this,D=mstrmojo.emptyFn,C=F.success||D,G=F.failure||D,I=F.complete||D;this._retrieveItems(H,{success:function(J){E.blockBegin=H;E.blockCount=J.bc||30;E.set("items",(E.concat?(E.items||[]).concat(J.items||[]):(J.items||[])));if(J.totalSize){E.totalSize=J.totalSize;}C(J);},failure:function(J){G(J);},complete:function(J){I(J);}},B);},_retrieveItems:function(D,C,B){alert("Object which mixes in this mixin has not implemented this method - _retrieveItems().");},hasNext:function(){return(((this.concat?1:this.blockBegin)+((this.items&&this.items.length)||0))<((mstrApp.isAppStatePause&&mstrApp.isAppStatePause())?this.totalSize:(this.totalSize+1)));},hasPrevious:function(){return this.blockBegin>1;}});}());(function(){mstrmojo.models.template.MetricValue=mstrmojo.declare(null,null,{init:function G(H){this.data=H.data;this.value=H.value;},getValue:function B(){return this.value.v;},getThresholdType:function D(){return this.value.ty;},getRawValue:function A(){return this.value.rv;},getCSS:function C(){return this.data.css[this.value.cni].n;},getThresholdValue:function F(H){if(this.value.ti===undefined){return H;}return this.data.th[this.value.ti].n;},getFillColor:function E(H){if(this.value.ci===undefined){return H;}return this.data.fc[this.value.ci].n;}});}());mstrmojo.warehouse.EnumDatabaseType={SAP:1200,MSAS:1500,EssBase:1600,TM1:2900,SAPHana:4000,BDE:5400,SearchEngineSOLR:5500,Hive:3100,Impala:4100,SearchEngineSPLUNK:5600,Pig:6400,PHOENIX:6800,IBMBigInsights:700,Drill:7300,DB_TYPE_NEWDB_1:8100,DB_TYPE_NEWDB_5:8500,AzureCosmosDB:8700};mstrmojo.mstr.EnumDSSConsolidationType={DssNormal:0,DssDerivedElement:1,DssRecursiveDerivedElement:2};mstrmojo.mstr.EnumNodeDimty={NodeDimtyReserved:0,NodeDimtyNone:1,NodeDimtyContinuation:2,NodeDimtyExclusiveContinuation:3,NodeDimtyOutputLevel:4,NodeDimtyBreakBy:5,NodeDimtyEmbedded:6,NodeDimtyUnspecified:7};(function(){var A=/^mstrmojo./;mstrmojo.DynamicClassFactory={newComponent:function(C,B,F){var H=C.prototype.scriptClass.replace(A,"");for(var E=0,D=B&&B.length||0;E<D;E++){if(!B[E]._mixinName){throw new Error('Mixins must have a "_mixinName" property to be used with DynamicClassFactory');}H+="_"+B[E]._mixinName.replace(A,"");}var G=mstrmojo[H];if(!G){G=mstrmojo.declare(C,B,F);mstrmojo[H]=G;}return G;}};}());mstrmojo.mstr.EnumDataType={DataTypeUnknown:-1,DataTypeReserved:0,DataTypeInteger:1,DataTypeUnsigned:2,DataTypeNumeric:3,DataTypeDecimal:4,DataTypeReal:5,DataTypeDouble:6,DataTypeFloat:7,DataTypeChar:8,DataTypeVarChar:9,DataTypeLongVarChar:10,DataTypeBinary:11,DataTypeVarBin:12,DataTypeLongVarBin:13,DataTypeDate:14,DataTypeTime:15,DataTypeTimeStamp:16,DataTypeShort:21,DataTypeLong:22,DataTypeMBChar:23,DataTypeBool:24,DataTypePattern:25,DataTypeBigDecimal:30,DataTypeCellFormatData:31,DataTypeInt64:34};mstrmojo.warehouse.EnumObjectTypes={FILTER:1,METRIC:4,ATTRIBUTE:12,FACT:13,DIMENSION:14,TABLE:15,TABLE_LOGICAL_VIEW:151,TABLE_PARTITION:152,FORM:21,COLUMN:26,DBROLE:29,PROJECT:32,TRANSFORMATION:43,DBTABLE:53,LAYER:70,RELATIONSHIP:99,COMPOUND_FORM:1001,RELATIONSHIP_ATTRIBUTE:1002};mstrmojo.chart.model.enums.EnumDSSObjectType={DssTypeUnknown:-1,DssTypeReserved:0,DssTypeGeneric:5,DssTypeFormatBAD:46,DssTypeFilter:1,DssTypeTemplate:2,DssTypeReportDefinition:3,DssTypeMetric:4,DssTypeStyle:6,DssTypeAggMetric:7,DssTypeFolder:8,DssTypeDevice:9,DssTypePrompt:10,DssTypeFunction:11,DssTypeAttribute:12,DssTypeFact:13,DssTypeDimension:14,DssTypeTable:15,DssTypeDatamartReport:16,DssTypeFactGroup:17,DssTypeShortcut:18,DssTypeResolution:19,DssTypeMonitor:20,DssTypeAttributeForm:21,DssTypeSchema:22,DssTypeFormat:23,DssTypeCatalog:24,DssTypeCatalogDefn:25,DssTypeColumn:26,DssTypePropertyGroup:27,DssTypePropertySet:28,DssTypeDBRole:29,DssTypeDBLogin:30,DssTypeDBConnection:31,DssTypeProject:32,DssTypeServerDef:33,DssTypeUser:34,DssTypeTransmitter:35,DssTypeConfiguration:36,DssTypeRequest:37,DssTypeScript:38,DssTypeSearch:39,DssTypeSearchFolder:40,DssTypeDatamart:41,DssTypeFunctionPackageDefinition:42,DssTypeRole:43,DssTypeSecurityRole:44,DssTypeLocale:45,DssTypeConsolidation:47,DssTypeConsolidationElement:48,DssTypeScheduleEvent:49,DssTypeScheduleObject:50,DssTypeScheduleTrigger:51,DssTypeLink:52,DssTypeDbTable:53,DssTypeTableSource:54,DssTypeDocumentDefinition:55,DssTypeDrillMap:56,DssTypeDBMS:57,DssTypeMDSecurityFilter:58,DssTypePromptAnswer:59,DssTypePromptAnswers:60,DssTypeGraphStyle:61,DssTypeChangeJournalSearch:62,DssTypeNCSObjects:255,DssTypeReservedLastOne:63};(function(){var A=400,B=1500;mstrmojo._CanHandleTwoClicks=mstrmojo.provide("mstrmojo._CanHandleTwoClicks",{firstClickTimeStamp:undefined,firstClickTarget:undefined,onclick:function(C){var D=new Date();timeStamp=D.getTime();if(D-this.firstClickTimeStamp<B&&D-this.firstClickTimeStamp>A){C.secondTarget=C.getTarget();C.firstTarget=this.firstClickTarget;this.onTwoClicks(C);C.cancel();}else{this.firstClickTarget=C.getTarget();this.firstClickTimeStamp=timeStamp;}if(this._super){this._super(C);}},onTwoClicks:mstrmojo.emptyFn});}());mstrmojo.vi.enums.EnumFeatures={SUPPORT_RESPONSIVE:"support-responsive",SUPPORT_RESPONSIVE_RESIZING:"support-responsive-resizing",SUPPORT_GHOST_IMG:"support-ghost-img",SUPPORT_NLP:"use-natural-language",SUPPORT_CONDITION_METRIC:"support_condition_metric",USE_WORKSTATION_NAMING_STYLE:"use-workstation-naming-style",SUPPORT_TOC_UPDATEPOISITION:"support-toc-updatePosition",SUPPORT_LIVEMODE:"support-livemode",NUMBER_FORMATTING:"number-formatting",SAVE_ANALYSIS:"save-analysis",INSERT_NEW_METRIC:"insert-new-metric",DATA_ENGINE_VERSION:"data-engine-version",WEB_DRILL_AND_LINK:"web-drill-and-link",WEB_IMPORT_DATABASE:"web-import-database",APPSCHEMA:"enable-app-schema",USE_METRIC_EDITOR:"use-metric-editor",CREATE_APP_OBJ:"create-app-object"};mstrmojo.chart.model.enums.EnumDSSGraphObject={DssGraphNull:-3,DssGraphBackground:1,DssGraphFrame:2,DssGraphFootnote:3,DssGraphSubtitle:4,DssGraphTitle:5,DssGraphLegendArea:6,DssGraphLegendLine:7,DssGraphLegendMarker:8,DssGraphLegendText:9,DssGraphCurve:257,DssGraphDataLine:258,DssGraphDataMarker:259,DssGraphDataText:260,DssGraphDivBiPolar:261,DssGraphErrorBar:262,DssGraphLinrExp:263,DssGraphLinrLine:264,DssGraphLinrLog:265,DssGraphLinrNatLog:266,DssGraphLinrNPoly:267,DssGraphLinrText:268,DssGraphMeanLine:269,DssGraphMovAvgLine:270,DssGraphO1Body:271,DssGraph2DO1Label:272,DssGraphO1Major:273,DssGraphO1Minor:274,DssGraphO1Super:275,DssGraphO1Title:276,DssGraphO2Body:277,DssGraph2DO2Label:278,DssGraphO2Major:279,DssGraphO2Minor:280,DssGraphO2Title:281,DssGraphConnectDataLine:282,DssGraphRiser:286,DssGraphRiserShadow:287,DssGraphStdDevLine:288,DssGraphX1Body:289,DssGraphX1Label:290,DssGraphX1Major:291,DssGraphX1Minor:292,DssGraphXTitle:293,DssGraphY1Body:295,DssGraphY1Label:296,DssGraphY1Major:297,DssGraphY1Minor:298,DssGraphY1Title:299,DssGraphY2Body:301,DssGraphY2Label:302,DssGraphY2Major:303,DssGraphY2Minor:304,DssGraphY2Title:305,DssGraph3DShowColumnHeaders:318,DssGraph3DShowLeftHeaders:321,DssGraph3DShowRightHeaders:323,DssGraph3DShowRowHeaders:325,DssGraphOBPBox:329,DssGraphOBPMedian:330,DssGraphOBPStem:331,DssGraphOBPTail:332,DssGraphPieFeelerLine:337,DssGraphPieFeelerLabel:338,DssGraphPieGroupLabel:339,DssGraphPieRingLabel:340,DssGraphPieSlice:341,DssGraphSeriesTitle:398,DssGraphConnectStackLine:399,DssGraphDataTextStackTotal:401,DssGraphOPILBLValue:418,DssGraphUserLine1:414,DssGraphUserLine2:415,DssGraphUserLine3:416,DssGraphUserLine4:417,DssGraphDataTextConnectLine:431,DssGraphGauge:444,DssGraphGaugeTitle:450,DssGraphGaugeRange:451,DssGraphY3Body:477,DssGraphY3Label:478,DssGraphY3Major:479,DssGraphY3Minor:480,DssGraphY4Body:483,DssGraphY4Label:484,DssGraphY4Major:485,DssGraphY4Minor:486,DssGraph3DColHeader:512,DssGraph3DColTitle:515,DssGraph3DDataText:518,DssGraph3DRowHeader:552,DssGraph3DRowTitle:555,DssGraph3DRYHeader:558,DssGraph3DRYTitle:561,DssGraphGaugeBorder:1319,DssGraphGaugeNeedleBase:1320,DssGraphGaugeNeedleBaseLine:1330,DssGraphZBody:10003,DssGraphTrendLine:10004,DssGraphY1RightBody:10005,DssGraphY1RightTitle:10006,DssGraphReferenceLine:10007,DssGraphStraightLine:10008,DssGraphTargetLine:10009,DssGraphRefLineText:10010,DssGraphTrendLineText:10011,DssGraphUserLabel1:100100,DssGraphUserLabel2:100101,DssGraphUserLabel3:100102,DssGraphUserLabel4:100103,DssGraphX2Body:100200,DssGraphX2Label:100201,DssGraphX2Major:100202,DssGraphX2Minor:100203,DssGraphX2Title:100204};(function(){mstrmojo.requiresDescs(9380,9381,9382,9383,9384,9385,9379,15106,15107,10639,10159,9705,9704);mstrmojo.DI.DIConstants=mstrmojo.provide("mstrmojo.DI.DIConstants",{invalidObjectNameChars:'\\"[]',invalidObjectNameCharsRegex:/[\\"\[\]]/,acceptFileTypes:".xls,.xlsx,.csv,.txt,.tsv,.prn,.json,.sas7bdat,.geojson,.kml",acceptFileTypesMatcher:/(\.xls|\.xlsx|\.csv|\.txt|\.tsv|\.prn|\.json|\.sas7bdat|\.geojson|\.kml)$/i,sourceItemLinkType:{dbList:0,oauthPara:1},setDefaultOAuthParamCMD:"MSTR_DEFAULT_OAUTH_PARAMS",actions:{none:0,importSource:1,editImport:2,transform:3,changeSheet:4,publish:5,changeMappings:6,refine:7,quickPreview:8,savePublish:9,getFlatPreview:10,refreshData:11,mergeCube:12},localStorageKey:{HGOSFileTypeTooltipPop:"HGOSFileTypeTooltipPop"},requestFlag:{mapping:1,preview:2,sourceInfo:4,refineSourceInfo:8,sheets:16,crb:32,transformations:64,transformedPreview:128,relationship:256,stateInfo:512,anyState:268435456,fullData:1024,refineInnerData:2048},formMappingFlag:{formMappingFlagReserved:0,formMappingFlagRemoveGeoRole:1,formMappingFlagRemoveTimeRole:2,formMappingFlagRemoveDeriveFlags:4},browseFlag:{reportBindingTable:1,dataPreview:4,publish:16,cubeConfig:68,reportLevelProperty:256},importBehaviorFlag:{reserved:0,newColumnsSilent:1,dataTypeSilent:2},saveAsFlags:{saveAsOverWrite:32,saveAsManaged:524288,saveAsDDA:33554432,saveAsInMemory:67108864,saveAsWithPrompts:4096,saveAsWithAnswers:4},connectLiveSupport:{connectLiveSupportUnknown:0,connectLiveSupportDDAOrInMemory:1,connectLiveSupportInMemoryOnly:2,connectLiveSupportDDAOnly:3},xdaType:{excel:272,text:288,refine:384,salesforce:337,querybuilder:352,ffsql:304,mdx:2,customFreeFormSQL:3,googleAnalytics:390,googleBigQuery:341,googleBigQueryFFSQL:342,googleBigQuerySingleTable:345,qbSingleTable:368,twitter:343,facebook:344,dataImport:256,projectsImport:400,sparkDataset:416,dataImportFileExcel:16|256,dataImportFileText:32|256,dataImportCustomSQL:48|256,dataImportTable:64|256,dataImportOAuth:80|256,dataImportBISource:144|256,dataImportOAuthSalesforce:1|336,dataImportOAuthGDocs:2|336,dataImportOAuthGDrive:2|336,dataImportOAuthDropbox:3|336,dataImportOAuthGAnalytics:4|336,dataImportOAuthGBigQuery:5|336,dataImportOAuthGBigQueryFFSQL:6|336,dataImportOAuthGBigQuerySingleTable:9|336,spark:160|256},fileTypes:[{n:"CSV/TXT",v:"CSV"},{n:"PARQUET",v:"PARQUET"},{n:"AVRO",v:"AVRO"},{n:"ORC",v:"ORC"},{n:"JSON",v:"JSON"},{n:"PARQ",v:"PARQUET",visible:false}],sourceInfoDesc:{json:"DB_FILE_TYPE_JSON"},sourceType:{file:1,salesforce:2,dropbox:3,googleDrive:4,googleAnalytics:5,googleBigQuery:6,querybuilder:7,mstrFile:8,mdx:9,hadoop:10,twitter:11,facebook:12,bisource:13,remoteProject:14,importfromcube:15,dataFromPushApi:16,newConnector:17,cloudElement:18},sourceSubtype:{localFile:1,url:2,salesforce:3,dropbox:4,googleDrive:5,googleAnalytics:6,googleBigQuery:7,querybuilder:8,samplefile:9,clipboard:10,googleBigQueryFFSQL:11,searchOnSource:12,mdx:13,hadoop:14,twitter:15,facebook:16,bisource:17,remoteProject:18,googleBigQuerySingleTable:19,hanaSingleTable:20,publicData:21,importfromcube:22,dataFromPushApi:23,cloudElement:24,},backendSourceSubtype:{localFile:65537,url:65539,samplefile:65540,clipboard:65538,newConnector:65544,cloudElement:65552,hadoopFileBrowser:65541,customSQL:131073,customSQLWizard:131074,singleTable:131075,bISources:131076,searchAsASource:131078,salesforce:196609,dropbox:196610,facebook:196611,twitter:196612,googleDrive:196613,googleAnalytics:196614,googleBigQuery:196615,googleBigQueryFFSQLModel:196616,googleBigQuerySingleTable:196617,OLAPSources:327681,publicData:65542,dataFromPushApi:65543,dataFromPushApiV2:65545,cloudElement:65552,},sourceItemType:{file:0,url:1,database:2,hadoop:3,olap:4,publicData:5,salesforce:6,googleAnalytics:7,googleBigQuery:8,googleDrive:9,dropbox:10,searchAsASource:11,clipboard:12,bISources:13,facebook:14,twitter:15,samplefile:16,importFromCube:17,addNewConnector:18,newConnector:19,cloudElement:20,unknow:-1},columnState:{reserved:0,unchanged:1,newColumn:2,missing:4,changed:8},operationMode:{create:0,edit:1,refresh:2,subscribe:3,enterCredentials:4,oauth:5,pickTable:6,hadoopPickTable:7,ffsql:8,hadoopFFsql:9},statusCode:{obtainSource:-2147071874,xformsError:-2147071872,mappingError:-2147071871,edit:1,republish:2,schedule:3,enterCredentials:4,pickTable:5,hadoopPickTable:6,ffsql:7,hadoopFFsql:8},pageType:{intro:0,file:1,database:2,emmaPreview:3,redirect:4,analytics:5,dataSelection:6,suggestNewSource:7,sourceIntro:8,sourceObjects:10,sampleFiles:11,dataset:12,externalPage:13,preview:14,clipboard:15,refine:16,parse:17,mstrFile:18,allProjectSource:19,hadoop:20,twitter:21,facebook:22,sourceObjectsDnD:23,schedule:24,publicData:25,republish:26,sourceAdmin:27,importFromCube:28,addNewConnector:29,newConnector:30,addConnectorList:31,cloudElement:32},backendError:{overwriteObject:-2147212339,noPermission:-2147214579,invalidObjectName:-2147213715,unexpectedDataType:-2147212539,noExternalSession:-2147071844,noPrivilege:-2147212082,salesforceUnsavedReport:-2147212081,salesforceObsoleteReport:-2147212080,maxSizeExceeded:-2147212076,maxSizeExceededURL:-2147212121,salesforceUnresolvedFilter:-2147212074,incrementalRefresh:-2147212287,invalidUrl:-2147212062,fileVersionError:-2147212064,emptySheet:-2147212144,refreshTokenUnavailable:-2147202875,cubeQuotaExceeded:-2147071825,notEnoughSpace:-2147071811,importedURLInvalid:-2147212122,unsupportedFileFormat:-2147212063,objectNameTooLong:-2147217407,noExternalSourceInfo:-2147215346,memoryConsumptionExceeded:-2147215346,cubeQuotaReached:-2147071870,switchingFileType:-2147212140,memoryGovernSizeExceeded:-2147181051,stringTooLong:-2147213718,missingColumn:-2147071871,dataDiscoveryError:-2147211998,refineApplyError:-2147202299,serverOutOfMemory:-2147212055,columnCountMatchError:-2147467259,incompatibleDataTypeError:-2147211983,reportTimeout:-2147212335,requestTimeout:-2147206497,databaseCredentialsNotAvailable:-2147212037,ddasupportIncompatible:-2147215326,mergeInvalidXdatype:-2147215325,notFullyControl:-2147214579,shouldBeIgnored:-2147212123,CECredentialNotAvailable:-2147215317,AuthenticationError:-2147215346,queryEngineGeneralError:-2147212544},transformation:{xtab:1,delimiter:2},application:{platform:"Platform",cloudPersonal:"Personal",cloudProfessional:"Professional"},refreshOptions:{replace:1,append:2,update:4},cubeRefreshType:{dummy:-1,reserved:0,add:1,remove:2,update:3,upsert:4,addNewTable:5,deleteTable:6,replaceTable:7,preserve:8},tableStatsExecutionAction:{reserved:0,forceExecution:1,ignore:4,requireFreshData:268435456},sourcesInfoFlags:{none:0,getReports:1,getUserName:2,getTokensInfo:4,revokeSession:8,getGAnalyticsAccount:64},queryBuilderType:{individualTable:1,multipleTables:2,queryScript:3},relationshipEditType:{create:1,changeERType:2,remove:3,flip:8001},ERType:{reserved:0,ERType11:1,ERType1M:2,ERTypeM1:3,ERTypeMM:4,ERTypeParallel:5,ERTypePerpendicular:6},RSType:{reserved:0,auto:1,geo:2,defined:3},tableStates:{newly:1,old:2},behaviorChangeFlag:{multiSheet:4,remapping:8,refreshData:16},menuItems:{SEPARATOR:-1,NONE:0,TABLE_RENAME:1,DO_NOT_IMPORT:2,FLIP_ORDER:3,DELETE:4,RELATIONSHIP_TYPE:5,ONE_TO_ONE:6,ONE_TO_MANY:7,MANY_TO_ONE:8,MANY_TO_MANY:9,REMOVE:10,REFRESH_DATA:11,REFINE:12,CANCEL_REFINE:13,UNLINK:14,CHANGE_DATA_TYPE:15,MARK_GEO_ROLES:16,CREATE_TIME_ATTRIBUTES:17,TO_METRIC:18,TO_ATTRIBUTE:19,MAP_TO_PROJECT_ATTRIBUTE:20,UNMAP:21,MODIFY_ATTRIBUTE_GROUP:22,CREATE_ATTRIBUTE_GROUP:23,HIDE_ALL_ATTRIBUTE_FORMS:24,DEFINE_RELATIONSHIPS:25,LINK:26,ITEM_RENAME:27,CREATE_MULTIFORM_ATTRIBUTE:28,EDIT_MULTIFORM_ATTRIBUTE:29,ADDTO_MULTIFORM_ATTRIBUTE:30,SHOW_ALL_ATTRIBUTE_FORMS:31,SHOW_ALL_COLUMNS:32,PARTITION:33,REFINE_RENAME:34,REFINE_DELETE:35,REFINE_DELETE_ALL:36,REFINE_RESET:37,REFINE_RESET_ALL:38,PARSE:39,IMPORT:40,UNLINK_ALL:41,CREATE_HIERARCHY_ATTRIBUTE:42,EDIT_HIERARCHY_ATTRIBUTE:43,RESET_HIERARCHY_ATTRIBUTE:44,DESCRIPTION:45},dataTypeMenuItems:{DATE_TIME:"1",NUMBER:"2",TEXT:"3",URL:"5",EMAIL:"6",HTML_TAG:"7",DATE:"8",TIME:"9",SYMBOL:"10",BIG_DECIMAL:"11",PHONE_NUMBER:"12"},columnDataTypes:{reserved:0,integer:1,unsigned:2,numeric:3,decimal:4,real:5,dtdouble:6,dtfloat:7,dtchar:8,varChar:9,longVarChar:10,binary:11,varBin:12,longVarBin:13,date:14,dttime:15,timeStamp:16,nChar:17,nVarChar:18,nlong:22,bigDecimal:30,cellFormatData:31,utf8Char:33,int64:34},formsOptions:{CREATE_MULTIFORM_ATTRIBUTE:1,EDIT_MULTIFORM_ATTRIBUTE:2,ADDTO_MULTIFORM_ATTRIBUTE:3},hierarchyOptions:{CREATE_HIERARCHY_ATTRIBUTE:1,EDIT_HIERARCHY_ATTRIBUTE:2,RESET_HIERARCHY_ATTRIBUTE:3},rdcsFlag:{ID:1,JOIN_ID:2,FILTER_ID:3,DISTANCE:4},timeRoles:{NONE:0,DATE:1,DATE_TIME:2,TIME:3,SECOND:4,MINUTE:5,HOUR:6,DAY:7,WEEK:8,MONTH:9,QUARTER:10,YEAR:11},contextMenuType:{ITEM_MENU:0,TABLE_MENU:1,PREVIEW_ITEM_MENU:2,LINK_MENU:3},dialogType:{fixRefreshErrorDialog:1,allObjectsViewDialog:2,missingColumnsDialog:3,diPageDialog:4,refreshHistoryDialog:5,alternateSourceValidateDialog:6,ddaConfirmDialog:7,publishStatusDialog:8,saveAsDialog:9,cubesList:10,refinePage:11,multiFormEditor:12,sheetsSelectionDialog:13,partitionGroupDialog:14,parseDataDialog:15,errorDialog:16,warningDialog:17,relationDefineDialog:18,qbImportOptionDialog:19,previewRenameDialog:20,mapProjectsAttributeDialog:21,setOAuthParaDialog:22,objectPicker:23,refineClusteringPage:24,refineExtractDialog:25,refineImportDialog:26,twitterAdvOptDialog:27,credentialsDialog:28,mapProjectsAttributeDialog2:29,setWhiteListDialog:30,binaryUploadDialog:31,authenticationDialog:32,sharingDialog:33,hadoopGatewayManagerDialog:34,hadoopGatewayDialog:35,addConnectorDialog:36,hierarchyAttributeDialog:37,hierarchyAttributeResetDialog:38,objectDescDialog:39},dataEvents:{DATA_PREVIEW_EVENT:"dataReturned",NO_DATA_RETURNED_EVENT:"noDataReturned"},cubeSchedStatus:{unexecuted:1,successful:2,unscheduled:3,failed:4},privilegeType:{accessDatabase:1,accessFile:2,accessCloud:3},dbType:{MS_ACCESS:100,ORACLE:200,SQL_SERVER:300,INFORMIX:400,SYBASE:500,REDBRICK:600,DB2:700,TANDEM:800,TERADATA:900,UNKNOWN:1000,GENERIC:1100,SAP:1200,NETEZZA:1300,EXCEL:1400,MSFT_AS:1500,ESSBASE:1600,MYSQL:1700,POSTGRESQL:1800,HPNEOVIEW:1900,METAMATRIX:2000,DATALLEGRO:2100,COMPOSITE:2200,ASTER:2300,VERTICA:2400,OPENACCESS:2500,SYBASE_SQL_ANY:2600,SYBASE_IQ:2700,PARACCEL:2800,TM1:2900,XQUERY:3000,HIVE:3100,SAND:3200,SALESFORCE:3300,HIVETHRIFT:3400,VECTORWISE:3500,ENTERPRISEDB:3600,KOGNITIOWX2:3700,EXASOLUTION:3800,INFORMATICA:3900,SAPHANA:4000,IMPALA:4100,AMAZON_REDSHIFT:4200,DENODO:4300,GOOGLE_DRIVE:4400,DROPBOX:4500,GOOGLE_ANALYTICS:4600,GOOGLE_BIGQUERY:4700,CONNECTION_CLOUD:4800,GOOGLE_BIG_QUERY_FFSQL_MODEL:4900,PARSTREAM:5100,MONGODB:5200,MARKLOGIC:5300,BIG_DATA_ENGINE:5400,SEARCH_ENGINE_SOLR:5500,SPLUNK:5600,TWITTER:5700,FACEBOOK:5800,PIG:6400,URL:7700,newConnector:7900,LOCALFILE:8200},getCubeQuotaAndInfosOptions:{GetCubeQuotaAndInfosReserved:0,GetCubeQuotaAndInfosDefault:1,GetCubeQuotaAndInfosQuotaOnly:2,GetCubeQuotaAndInfosAll:3,GetCubeQuotaAndInfosVI:4},homepageViewMode:{GRID_VIEW:0,LIST_VIEW:1},datasetServeMode:{inMemory:1,dda:2,unknow:3},cubePollStatus:{msgID:0,result:1,prompt:2,error:3,xmlResult:21},ibmDb2Versions:[17,18,21,22,23,24,25,37,45,46,47,48,63,66,74,89,92,101,103,105,123,134,157,172,202,232],hadoopDbTypes:[3100,1100,700,4100,7300,6800,6400,8100],formCategory:{longitude:"2345134F4F5E261C3BB902A874467080",latitude:"B191051C48221A6AE44CA2B65B1B65E3"},formCategoryName:{ID:"ID",DESC:"DESC",GEOMETRY:"Geometry"},urlAuthDBRoles:{anonymous:"CB1CB472A07E41D5AE038232839F2064",windows:"95A5ACC02FE94CBABCB65E4F2D2415B2",kerberos:"317D6F016D784836A724AD4D739E1E9C",integrated:"E966E1A0A4C949108287B2E5086B68EB"},urlAuthDBMSId:"497F2406FA154B86810C71EA3D401D6D",newConnectorDBMSId:"565D5DC3A1124726B85FE53EF992472A",hadoopGateWay:{HGoS_CONFIG_HAS_EXIT:1510,CONNOT_AUTHENTICATE:1511,SPACE_OVER:1512,FAIL_COPY_TO_HOST:1513,INSUFFICIENT:1514,DIRECTORY_NO_EXIST:1515,HGOS_DEPLOYED:1518,HGOS_DEPLOYING:1519,CONNOT_AUTHENTICATE2:1520,HGOS_RUNNING:1521,HGOS_STOPPED:1522,HGOS_NOT_DEPLOYING:1523,HGOST_TAR_NOT_EXIST:1524,HGOS_CONF_NOT_EXIST:1530},workstation:{filerBreakLine:new RegExp("[\r\n]","g"),utils:{shouldShowTitleBar:function(){var A=mstrApp.getRootController().rootView.inPageDialog;return !!mstrApp.isWorkstation&&(!!mstrApp.isPopup||!!A);},setNativeWindow:function(C,F){var B=1010,E=552,D=parseInt(C,10),A=parseInt(F,10);if(!window.FormWrapper||!window.FormWrapper.setWindowFrame){return ;}if(C.match(/%$/)&&F.match(/%$/)){window.FormWrapper.setWindowContentSize(1200,680);}else{D=D<B?B:D;A=A<E?E:A;window.FormWrapper.setWindowContentSize(D,A);}},lockResize:function(){if(!window.FormWrapper||!window.FormWrapper.lockResize){return ;}window.FormWrapper.lockResize();},unlockResize:function(){if(!window.FormWrapper||!window.FormWrapper.unlockResize){return ;}window.FormWrapper.unlockResize();}}},authMode:{ANONYMOUS:0,USERNAME:1,OAUTH:2},authModePrefix:{ANONYMOUS:"AuthMode=Anonymous;URL=",USERNAME:"AuthMode=Basic;URL=",OAUTH:"AuthMode=OAuth;URL="},sdkUrl:{MARKPLACE_URL:"https://community.microstrategy.com/s/gallery?tabset-89baf=202df",QUICK_START_URL:"https://lw.microstrategy.com/msdz/MSDL/GARelease_Current/docs/projects/DataConnectorSDK/Content/topics/Quick_Start_Guide.htm"},originalConnector:{elastic:"DE4A8E15405A36D80BF1E1A2BA6F9B66",tapClicks:"1E8ADD3975DA4609B8D00E6211ACAB6A"},googleAnalyticsUrl:{queryExplorer:"https://ga-dev-tools.appspot.com/query-explorer/"},weekDay:[{n:mstrmojo.desc(9380,"Monday"),v:0},{n:mstrmojo.desc(9381,"Tuesday"),v:1},{n:mstrmojo.desc(9382,"Wednesday"),v:2},{n:mstrmojo.desc(9383,"Thursday"),v:3},{n:mstrmojo.desc(9384,"Friday"),v:4},{n:mstrmojo.desc(9385,"Saturday"),v:5},{n:mstrmojo.desc(9379,"Sunday"),v:6}],dateMon:[{n:mstrmojo.desc(15106,"1st day"),v:"1"},{n:mstrmojo.desc(15107,"15th day"),v:"15"}],timeOfDay:[{n:"12:00AM",v:"12:00AM"},{n:"1:00AM",v:"1:00AM"},{n:"2:00AM",v:"2:00AM"},{n:"3:00AM",v:"3:00AM"},{n:"4:00AM",v:"4:00AM"},{n:"5:00AM",v:"5:00AM"},{n:"6:00AM",v:"6:00AM"},{n:"7:00AM",v:"7:00AM"},{n:"8:00AM",v:"8:00AM"},{n:"9:00AM",v:"9:00AM"},{n:"10:00AM",v:"10:00AM"},{n:"11:00AM",v:"11:00AM"},{n:"12:00PM",v:"12:00PM"},{n:"1:00PM",v:"1:00PM"},{n:"2:00PM",v:"2:00PM"},{n:"3:00PM",v:"3:00PM"},{n:"4:00PM",v:"4:00PM"},{n:"5:00PM",v:"5:00PM"},{n:"6:00PM",v:"6:00PM"},{n:"7:00PM",v:"7:00PM"},{n:"8:00PM",v:"8:00PM"},{n:"9:00PM",v:"9:00PM"},{n:"10:00PM",v:"10:00PM"},{n:"11:00PM",v:"11:00PM"}],schedule:{DAILY:"Daily",WEEKDAY:"Weekday",WEEKLY:"Weekly",MONTHLY:"Monthly"},mainPage:{GRID_MODE:0,LIST_MODE:1},sourceIconClsName:{0:"ds-Generic",1:"ds-DB2",2:"ds-DB2",3:"ds-DB2",4:"ds-InformixWire",5:"ds-InformixXPS",6:"ds-PostgreSQL",7:"ds-SAP",8:"ds-SAP",9:"ds-Oracle",10:"ds-MicroSoft",11:"ds-Teradata",12:"ds-MySQL",13:"ds-GreenPlum",14:"ds-Netezza",15:"ds-WebServices",17:"ds-Infobright",18:"ds-Salesforce",19:"ds-MicroSoft",20:"ds-Actian-n",21:"ds-Amazon-Redshift",22:"ds-Impala",23:"ds-Aster",25:"ds-Actian-n",26:"ds-EnterpriseDB",27:"ds-Vertica",28:"ds-Denodo",29:"ds-CiscoDataVirtualization",31:"ds-MicroSoft",32:"ds-GoogleBigQuery",33:"ds-SAP",35:"ds-IBMBigInsights",39:"ds-TM1",41:"ds-WebServices",43:"ds-Amazon-EMR",44:"ds-Apache-Hive",45:"ds-ClouderaHive",46:"ds-HortonworksHive",47:"ds-MapRHive",48:"ds-apache",49:"ds-SharkSpark",50:"ds-MongoDB",52:"ds-MariaDB",51:"ds-MarkLogic",54:"ds-Splunk",55:"ds-DataDirectCloud",56:"ds-ParStream",58:"ds-Phoenix",59:"ds-MicroSoft",60:"ds-DB2",61:"ds-Oracle",62:"ds-Teradata",63:"ds-SAP",65:"ds-PostgreSQL",66:"ds-MySQL",67:"ds-MariaDB",68:"ds-Amazon-EMR",69:"ds-Apache-Hive",70:"ds-ClouderaHive",71:"ds-HortonworksHive",72:"ds-MapRHive",73:"ds-SharkSpark",75:"ds-Amazon-Redshift",76:"ds-PIVOTALHAWQ",77:"ds-MemSQL",78:"ds-Arcadia-Platform",79:"ds-Altibase",80:"ds-MongoDB",81:"ds-Presto",82:"ds-DB2",83:"ds-DB2",84:"ds-InformixWire",85:"ds-SAP",86:"ds-MicroSoft",87:"ds-MicroSoft",88:"ds-MemSQL",90:"ds-GreenPlum",91:"ds-PIVOTALHAWQ",92:"ds-Netezza",93:"ds-Infobright",94:"ds-Actian-n",95:"ds-Impala",96:"ds-IBMBigInsights",97:"ds-Aster",99:"ds-Actian-n",100:"ds-EnterpriseDB",101:"ds-Vertica",102:"ds-Denodo",103:"ds-CiscoDataVirtualization",105:"ds-DataDirectCloud",106:"ds-ParStream",107:"ds-Arcadia-Platform",109:"ds-Presto",110:"ds-Phoenix",111:"ds-Kognitio",112:"ds-Kognitio",113:"ds-Informatica",114:"ds-Informatica",115:"ds-Apache-Cassandra-JDBC",116:"ds-SAP",117:"ds-Actian",118:"ds-Actian",119:"ds-InformixXPS",120:"ds-Apache-Cassandra-JDBC",121:"ds-MapRDrill",122:"ds-Cirro",123:"ds-EXASolution",124:"ds-EXASolution",125:"ds-Oracle",126:"ds-Oracle",127:"ds-Snowflake",128:"ds-Snowflake",129:"ds-Amazon-Aurora",130:"ds-Amazon-Aurora",131:"ds-Amazon-Athena",132:"ds-Amazon-Athena",133:"ds-MapRDrill",134:"ds-Druid",135:"ds-Druid",139:"ds-MongoBI",157:"ds-GoogleBigQuery",161:"ds-MapD",168:"ds-HortonworksSpark",169:"ds-HortonworksSpark",170:"ds-Yellowbrick",},dispTag:{1:"Database",2:"OLAP",4:"BigData",8:"Database",16:"BigData",32:"BigData"},searchTags:{100:["Database","ODBC"],200:["Database","ODBC"],300:["Database","ODBC"],400:["Database","ODBC"],500:["Database","ODBC"],600:["Database","ODBC"],700:["Database","ODBC"],900:["Database","ODBC"],1100:["Database","ODBC"],1200:["OLAP","Cube"],1300:["Database","ODBC"],1400:["Database"],1500:["OLAP","Cube"],1600:["OLAP","Cube"],1700:["Database","ODBC"],1800:["Database","ODBC"],2200:["Database","ODBC"],2300:["Database","ODBC"],2400:["Database","ODBC"],2800:["Database","ODBC"],2900:["OLAP","Cube"],3000:["Database"],3100:["Database","BigData","Hadoop"],3300:["Cloud"],3500:["Database","ODBC"],3600:["Database","ODBC","BigData"],3800:["Database"],3900:["Database"],4000:["Database","ODBC"],4100:["Database","BigData","Hadoop"],4200:["Database","ODBC"],4300:["Database","ODBC"],4700:["Database","Cloud","BigData"],4800:["Cloud"],5200:["Database","NoSQL"],5300:["Database","NoSQL"],5400:["Hadoop"],6400:["Database","BigData","Hadoop"],6600:["Database"],6700:["Database"],6800:["BigData"],6900:["BigData"],7100:["NoSQL"],7200:["Database"],7300:["BigData","Hadoop"],7500:["Database"],7600:["Database"],8000:["Database"],8100:["BigData"],},srcItemTypes:{ALL_SOURCES:"ALL_SOURCES",STATIC_SOURCE:"STATIC_SOURCE",DBTYPE_SOURCE:"DBTYPE_SOURCE",CUSTOM_CONNECTOR:"CUSTOM_CONNECTOR",CLOUDELEMENT_CONNECTOR:"CLOUDELEMENT_CONNECTOR"},combination:{BigData:["BigData","NoSQL","Search","Hadoop"],Apps:["Apps","oAuth","Cloud","Social","BI","PublicData","CE"]},GenericDBStr:"Generic",dataSourceType:{MONGODB:"mongodb",FILE_URL:"fileUrl",FILE_LOCAL:"fileLocal",SAMPLE_FILE:"sampleFile",ES:"elasticsearch",DROPBOX:"dropbox",GOOGLE_DRIVE:"googleDrive",GOOGLE_ANALYTICS:"googleAnalytics",GOOGLE_BIGQUERY:"googleBigQuery",SALESFORCE:"salesforce",FILE:"file",GENERIC_JDBC:"genericJdbc"},ERDF:{ENUM_LOAD_REPORT_BROWSE_TYPE_BINDINGTABLE:1,ENUM_LOAD_REPORT_BROWSE_TYPE_DATAPREVIEW:4,ENUM_LOAD_REPORT_BINDING_FLAG_ALL:15,ENUM_LOAD_REPORT_PREVIEW_FLAG_MappingInfo:1,ENUM_LOAD_REPORT_PREVIEW_FLAG_DataInfo:2,ENUM_LOAD_REPORT_PREVIEW_FLAG_SourceInfo:4,ENUM_LOAD_REPORT_PREVIEW_FLAG_InnerDataInfo:2048,},DSSSubType:{DSSSUBTYPEATTRIBUTE:3072,DSSSUBTYPEATTRIBUTEROLE:3073,DSSSUBTYPEATTRIBUTETRANSFORMATION:3074,DSSSUBTYPEATTRIBUTEABSTRACT:3075,DSSSUBTYPEATTRIBUTERECURSIVE:3076},DSSExType:{DSSEXDISPARK:416},URLMode:{NormalUrl:0,NewConnector:1,NewConnectorEdit:2,CloudElement:3},disableFeatures:{DISABLE_CUSTOM_CONNECTOR:"disableCustomerConnector",DISABLE_DDA:"disableDDA",DISABLE_QUOTA:"disableQuota",DISABLE_HADOOP:"disableHadoop",DISABLE_BI_TOOLS:"disableBITools",DISABLE_CLIP_BOARD:"disableClipboard",DISABLE_FACE_BOOK:"disableFacebook",DISABLE_TWITTER:"disableTwitter",DISABLE_SAMPLE_FILES:"disableSampleFiles",DISABLE_PUBLIC_DATA:"disablePublicData",DISABLE_MERGE_CUBE:"disableMergeCube",DISABLE_CE_SOURCE:"disableCESource",DISABLE_FLATTERN_DB_SOURCE:"disabledSources"},DssXmlPrivileges:{DssXmlPrivilegesUseDatabaseInstanceManager:57},Enum_SourceCategoryType:{File:1,BigData:2,Database:3,OLAP:4,Customized:5,Apps:6,},fileTypesDesc:{DB_FILE_TYPE_EXCEL:"DB_FILE_TYPE_EXCEL",DB_FILE_TYPE_CSV:"DB_FILE_TYPE_CSV",DB_FILE_TYPE_HTML:"DB_FILE_TYPE_HTML",DB_FILE_TYPE_JSON:"DB_FILE_TYPE_JSON",DB_FILE_TYPE_SAS:"DB_FILE_TYPE_SAS"},mimeType:{JSON:"application/json",},FormThatDisableGeo:{Latitude:"Latitude",Longitude:"Longitude",Geometry:"Geometry"},DSSViewMedia:{dssViewMediaAvailablePushDataAPI:1048576},multiSheetFileTypes:["PARQUET","AVRO","ORC","JSON",],storageType:{CSV:"CSV",MULTI_SHEET:"MULTI_SHEET",UNKNOWN:"UNKNOWN"}});}());(function(){mstrmojo._IsSelectorTarget=mstrmojo.provide("mstrmojo._IsSelectorTarget",{_mixinName:"mstrmojo._IsSelectorTarget",setDirty:function A(C){var D=(C?"add":"remove")+"DirtyKey",B=this.parent;if(B&&B[D]){this.parent[D](this.k);}}});}());(function(){function D(K){var J=this.h.idx;if(J!==-1){return this.t.es[J][K];}return"";}mstrmojo.models.template.Header=mstrmojo.declare(null,null,{init:function H(J){this.h=J.h;this.t=J.t;},getName:function A(){return D.call(this,"n");},getElementId:function I(){return D.call(this,"id");},getObjectId:function B(){return D.call(this,"oid");},getElementIndex:function G(){return this.h.idx;},getActionType:function F(){return this.h.at;},isTotal:function E(){return this.h.otr===1;},getFormIndex:function C(){return this.h.fi;}});}());mstrmojo.mstr.EnumDSSXMLTokenTypes={EndOfInput:-1,Reserved:0,Error:1,Unknown:2,Empty:3,ExclamationPoint:33,NumberSign:35,Dollar:36,Percent:37,Ampersand:38,LeftParen:40,RightParen:41,Asterisk:42,PlusSign:43,Comma:44,MinusSign:45,Dot:46,FwdSlash:47,Colon:58,Semicolon:59,LeftAngleBracket:60,EqualSign:61,RightAngleBracket:62,QuestionMark:63,AtSign:64,LeftSquareBracket:91,RightSquareBracket:93,Caret:94,Underscore:95,LeftAccolade:123,VerticalBar:124,RightAccolade:125,Tilda:126,Literal:258,Identifier:259,Reserved1:260,DoubleQString:261,Integer:262,Float:263,AttrRef:264,DimRef:265,MetricRef:266,AggMetricRef:267,FactRef:268,ReportRef:269,FilterRef:270,RoleRef:271,TableRef:272,PromptRef:273,ColumnRef:274,AttrFormRef:275,DimFormRef:276,SimpInfixFun1:277,SimpInfixFun2:278,SimpPrefixFun:279,AggFun:280,RelativeFun:281,CompareFun:282,AndFun:283,OrFun:284,NotFun:285,BoolPrefixFun:286,IntersectFun:287,Reserved2:288,InSetFun:289,BetweenFun:290,LikeFun:291,EnhCompareFun:292,EnhBetweenFun:293,ArrowUp:294,ArrowDown:295,ArrowUpDown:296,AggFirstInFact:297,AggLastInFact:298,KwdTrue:299,KwdFalse:300,KwdBreakBy:301,KwdSortBy:302,KwdFactID:303,DateTime:304,CaseFun:305,FreeVariable:306,LongNumber:307,RWMetricRef:308,CSQLRef:309,ConsolidationRef:310,DssTokenTypeKwdCSIUpdate:312,DssTokenTypeKwdCSISet:313,DssTokenTypeKwdCSIInsert:314,DssTokenTypeKwdCSIDelete:315,DssTokenTypeKwdCSIWhere:316,DssTokenTypeKwdCSIInto:317,DssTokenTypeKwdCSIValues:318,DssTokenTypeKwdCSIFrom:319,DssTokenTypeCSIFieldUnit:321,Elements:323,ConsolidationElementRef:324,EndOfTypes:340};mstrmojo.vi.models.EnumDragSources={DATASETS:1,VIZ_EDITOR:2,FILTERS:3,ALL_OBJECT_LIST:4,VIZ:5,TOC_CHAPTER:6,TOC_PAGES_LIST:7,VIZ_LAYER:8};(function(){mstrmojo.models.template.Title=mstrmojo.declare(null,null,{init:function G(J){this.title=J.title;},getActionType:function(){return this.title.at;},getDrillPath:function(){return this.title.dp;},getHeaderValues:function B(){return this.title.es;},getHeaderName:function F(J){return this.title.es[J].n;},getHeaderId:function F(J){return this.title.es[J].id;},getForms:function E(){return this.title.fs;},getFormId:function D(){return this.title.fid;},getFormType:function I(){return this.title.ftp;},getUnitId:function H(){return this.title.id;},getLinkMap:function C(){return this.title.lm;},getName:function A(){return this.title.n;},getUnitDssType:function(){return this.title.otp;},getSelectorControl:function(){return this.title.sc;}});}());(function(){function Q(V,R,S){if(V.nodeType===3&&R){return V;}else{var U=(R&&V.nodeType===1&&V.lastChild)?V.lastChild:F(V,S);return U?D(U,S):null;}}function F(S,R){return(S===R)?null:(S.previousSibling||F(S.parentNode,R));}function D(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.lastChild){return D(S.lastChild);}else{return D(F(S,R));}}}function I(R){return R.textContent||R.nodeValue||R.innerText;}function M(V,R,S){if(V.nodeType===3&&R){return V;}else{var U=(R&&V.nodeType===1&&V.firstChild)?V.firstChild:B(V,S);return U?E(U,S):null;}}function B(S,R){return(S===R)?null:(S.nextSibling||B(S.parentNode,R));}function E(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.firstChild){return E(S.firstChild);}else{return E(B(S,R));}}}mstrmojo.range=mstrmojo.provide("mstrmojo.range",{EDGE:{EDGE_BEGIN:1,EDGE_END:2,EDGE_MIDDLE:-1},getEdgeInfo:function P(U,V){var R=0,S;if(U.nodeType===1){if(window.getSelection){S=document.createRange();S.selectNode(U);R=S.toString().length;}else{S=document.body.createTextRange();S.moveToElementText(U);R=S.text.length;}}else{R=I(U).length;}return V===R?this.EDGE.EDGE_END:(V===0?this.EDGE.EDGE_BEGIN:this.EDGE.EDGE_MIDDLE);},collapseOnNode:function K(V,S){if(!V.offsetParent){return ;}var U=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(V);R.collapse(S);U.removeAllRanges();U.addRange(R);}else{R.moveToElementText(V);R.collapse(S);R.select();}},collapseOnTextNode:function L(V,W){var U=this.getSelection(),S=this.getRange();if(window.getSelection){var R=M(V,true);S.setStart(R,W);S.collapse(true);U.removeAllRanges();U.addRange(S);}else{S.moveToElementText(V);S.collapse(true);S.move("character",W);S.select();}},collapseOnTextNodeIE:function C(S,U){var V=M(S,true),R;while(V!==null){R=I(V).length;if(R>=U){this.collapseOnTextNode(V,U);break;}else{U-=R;V=M(V,false);}}},getRangeInfo:function J(Y,f){var a=null,k,d=this.getRange(),c;if(Y&&Y===d.startContainer){var h=d.startContainer.firstChild,V=h&&h.firstChild,e=V&&V.firstChild;if(e){d.setStart(e,d.startOffset);d.setEnd(e,d.endOffset);}}if(window.getSelection){var X=function(m,o,n){var l=m.cloneRange();l.collapse(n);l.setStartBefore(o);return l.toString().length;},S=d.startContainer,g=d.startOffset;if(S.nodeType===1){g=X(d,S,true);}a={collapsed:d.collapsed,startContainer:S,startOffset:f?f.startOffset:g};if(!d.collapsed){var W=d.endContainer,R=d.endOffset;if(W.nodeType===1){R=X(d,W,false);}a.endContainer=W;a.endOffset=R;}a.range=d;}else{var j,b,Z=function(o,p){var n=o.duplicate(),l=document.body.createTextRange(),m;n.collapse(p);m=n.parentElement();l.moveToElementText(m);l.setEndPoint("EndToStart",n);return{container:m,offset:l.text.length};},i=Z(d,true),U;a={collapsed:(d.compareEndPoints("StartToEnd",d)===0),startContainer:i.container,startOffset:i.offset};if(!a.collapsed){U=Z(d,false);a.endContainer=U.container;a.endOffset=U.offset;}}return a;},collapse:function O(S){if(window.getSelection){var U=this.getSelection();if(S){U.collapseToStart();}else{U.collapseToEnd();}}else{var R=this.getRange();R.collapse(S);R.select();}},selectSingleNode:function H(U){var S=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(U);S.removeAllRanges();S.addRange(R);}else{R.moveToElementText(U);R.select();}},selectMultipleNodes:function N(X,S,Y,V){var W=this.getSelection(),U=this.getRange();if(window.getSelection){U.setStart(X,S);U.setEnd(Y,V);W.removeAllRanges();W.addRange(U);}else{X=(X.nodeType===3)?X.parentNode:X;U.moveToElementText(X);U.move("character",S);Y=(Y.nodeType===3)?Y.parentNode:Y;var R=document.body.createTextRange();R.moveToElementText(Y);R.move("character",V);U.setEndPoint("EndToStart",R);U.select();}},getSelection:function G(){if(window.getSelection){return window.getSelection();}else{return document.selection;}},getRange:function A(){if(window.getSelection){selection=window.getSelection();if(selection.rangeCount>0){return selection.getRangeAt(0);}else{return document.createRange();}}else{return document.selection.createRange();}}});}());mstrmojo.customviz.CustomVisEnums={};mstrmojo.customviz.CustomVisEnums.LEGEND_PROPERTY_SET="sdk_legend";mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS={SHOW_LEGEND:"showLegend",LEGEND_BG_COLOR:"fillColor",LEGEND_BG_FILL_TRANSPARENCY:"fillAlpha",LEGEND_FONT_SIZE:"fontSize",LEGEND_FONT_FAMILY:"fontFamily",LEGEND_FONT_COLOR:"fontColor",LEGEND_FONT_WEIGHT:"fontWeight",LEGEND_FONT_ITALIC:"fontItalic",LEGEND_FONT_UNDERLINE:"fontUnderline",LEGEND_FONT_LINE_THROUGH:"fontLineThrough",LEGEND_MODE:"mode",LEGEND_POSITION:"position",LEGEND_WIDTH_SCALE:"widthRatio"};mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_FORMATTING_PROPERTY=[mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS.LEGEND_FONT_COLOR,mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS.LEGEND_FONT_LINE_THROUGH,mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS.LEGEND_FONT_UNDERLINE,mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS.LEGEND_BG_COLOR,mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS.LEGEND_BG_FILL_TRANSPARENCY];mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPERTY_TYPE={showLegend:"Boolean",fontWeight:"Boolean",fontItalic:"Boolean",fontUnderline:"Boolean",fontLineThrough:"Boolean",fillAlpha:"Integer",mode:"Integer",position:"Integer",widthRatio:"Float"};mstrmojo.customviz.CustomVisEnums.DEFAULT_LEGEND_PROP_VALUE={defaultTheme:{showLegend:true,fillColor:"#EEEEEE",fillAlpha:0,fontSize:"8pt",fontFamily:"Open Sans",fontColor:"#3A3835",mode:1,position:2},classicTheme:{showLegend:true,fillColor:"#EEEEEE",fillAlpha:0,fontSize:"8pt",fontFamily:"Arial",fontColor:"#747474",mode:1,position:2}};mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_DATA_TYPE={COLOR_BY:1,SIZE_BY:2};mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_DISPLAY_MODE={RESTORED:1,MINIMIZED:2};mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_SLOT={RIGHT_TOP:1,RIGHT_MIDDLE:2,RIGHT_BOTTOM:3,LEFT_TOP:4,LEFT_MIDDLE:5,LEFT_BOTTOM:6,LEFT:7,RIGHT:8};mstrmojo.customviz.CustomVisEnums.ENUM_FONT_STYLE={FS_NORMAL:0,FS_BOLD:1,FS_ITALIC:2,FS_BOTH:3,FS_UNDERLINE:4,FS_STRIKETHROUGH:8};mstrmojo.gm.GMEnums={};mstrmojo.gm.DualAxisSubAxisBit={PRIMARY:0,SECONDARY:1};mstrmojo.gm.StackExetrmeId={PRIMARY_Y_AXIS:-2,SECONDARY_Y_AXIS:-18,PRIMARY_X_AXIS:-1,SECONDARY_X_AXIS:-17};mstrmojo.gm.FormNameType={OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4};mstrmojo.gm.EnumSelectionOptionLevel={GLOBAL:1,ITSELF:2,ATTS_METRIC_COMBINATION:3,METRIC_AXIS:4,METRIC:5,AXIS:6,COLOR_BY:7,ALL_SHAPE:8,ITSELF_RESOLVED:9};mstrmojo.gm.EnumLabelRotation={VERTICAL:2,HORIZONTAL:0,AUTOMATIC:-1};mstrmojo.gm.EnumIdentityType={LEGEND:Math.pow(2,0),GRAPH_SHAPE:Math.pow(2,1),X_AXIS:Math.pow(2,2),Y_AXIS:Math.pow(2,3),X2_AXIS:Math.pow(2,4),Y2_AXIS:Math.pow(2,5),GRID_LINE:Math.pow(2,6),TREND_LINE:Math.pow(2,7),REF_LINE:Math.pow(2,8),DATA_LABEL:Math.pow(2,9),COLOR_SQUARE:Math.pow(2,10),ROW_TITLE:Math.pow(2,11),COL_TITLE:Math.pow(2,12),ROW_HEADER:Math.pow(2,13),COL_HEADER:Math.pow(2,14),LOG_SCALE:Math.pow(2,15),H_MATRIX_LINE:Math.pow(2,16),V_MATRIX_LINE:Math.pow(2,17),LEGEND_TEXT:Math.pow(2,18),SHAPE_COLLECTION:Math.pow(2,19),MINOR_GRID_LINE:Math.pow(2,20),AXIS_SCALE:Math.pow(2,22),AXIS_ORIGIN:Math.pow(2,23),ROWS_BACKGROUND:Math.pow(2,24),COLS_BACKGROUND:Math.pow(2,25),X_NUMERIC:Math.pow(2,26),X_CATEGORY:Math.pow(2,27),Y_NUMERIC:Math.pow(2,28),Y_CATEGORY:Math.pow(2,29),X_METRIC_AXIS_TITLE:Math.pow(2,30),Y_METRIC_AXIS_TITLE:Math.pow(2,31),VIZ_BOX_TITLE:Math.pow(2,32),REF_LINE_LABEL:Math.pow(2,33),LINE_MARKER:Math.pow(2,34),X_AXIS_ORIGIN_LABEL:Math.pow(2,35),Y_AXIS_ORIGIN_LABEL:Math.pow(2,36),X_AXIS_ORIGIN_LINE:Math.pow(2,37),Y_AXIS_ORIGIN_LINE:Math.pow(2,38),Y_ATTRIBUTE_AXIS_TITLE:Math.pow(2,39),ROW_HEADER_TEXT:Math.pow(2,40),ROW_TITLE_TEXT:Math.pow(2,41),COL_HEADER_TEXT:Math.pow(2,42),COL_TITLE_TEXT:Math.pow(2,43),VIZ_BOX_CONTAINER:Math.pow(2,44),X_ATTRIBUTE_AXIS_TITLE:Math.pow(2,45),AXIS_ORIGIN_DEFINE:Math.pow(2,46)};mstrmojo.gm.EnumGMZoneIds={ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10};mstrmojo.gm.EnumClickType={NONE:-1,LEFT_CLICK:1,RIGHT_CLICK:2,DOUBLE_CLICK:3};mstrmojo.gm.EnumLegendSlot={RIGHT_TOP:1,RIGHT_MIDDLE:2,RIGHT_BOTTOM:3,LEFT_TOP:4,LEFT_MIDDLE:5,LEFT_BOTTOM:6,LEFT:7,RIGHT:8};mstrmojo.gm.EnumAxisType={ATTRIBUTE:0,METRIC:1};mstrmojo.gm.EnumGraphType={UNDEFINED:-1,AREA:1,BAR:2,LINE:3,SCATTER:4,BUBBLE:5,PIE:6,GRID:7,HISTOGRAM:8,BOXPLOT:9,WATERFALL:10};mstrmojo.gm.EnumContextMenu={SEPARATOR:0,KEEP_ONLY:1,EXCLUDE:2,SORT_ASCENDING:3,SORT_DESCENDING:4,CLEAR_SORT:5,SHOW_DATA:6,SWITCH_THEME:7,KEEP_ONLY_AND_SHOW:8,CLOSE_LEGEND:9,OPEN_LEGEND:10,AXIS_SCALE:11,DRILL_TO:100,CHART_TYPE:200,AREA_ABS:201,AREA_STACKED:202,AREA_PERCENT:203,BAR_SBS:204,BAR_ABS:205,BAR_STACKED:206,BAR_PERCENT:207,LINE_ABS:208,LINE_STACKED:209,LINE_PERCENT:210,BUBBLE:211,SCATTER:212,H_AREA_ABS:213,H_AREA_STACKED:214,H_AREA_PERCENT:215,H_BAR_SBS:216,H_BAR_ABS:217,H_BAR_STACKED:218,H_BAR_PERCENT:219,H_LINE_ABS:220,H_LINE_STACKED:221,H_LINE_PERCENT:222,GRID:223,CIRCLE:224,SQUARE:225,PIE:226,TICKER:227,RING:228,CANVAS:229,SVG:230,LARGE_ABL:231,OUTPUT_EXTREMES:232,COMBINATION:233,ENABLE_PARTIAL_RENDERING:234,DISABLE_PARTIAL_RENDERING:235,OUTPUT_DATA_COUNT:236,ENABLE_TIMER:239,DISABLE_TIMER:240,ENABLE_CE_TIMER:241,DISABLE_CE_TIMER:242};mstrmojo.gm.EnumColorRankMode={RANK_MODE_VALUE:0,RANK_MODE_TOP:1,RANK_MODE_BOTTOM:2,RANK_MODE_TOP_PERCENT:3,RANK_MODE_BOTTOM_PERCENT:4};mstrmojo.gm.EnumColorByType={NULL:0,ATT:1,METRICS_ITEM:2,METRICS:3,ATT_METRICS:4};mstrmojo.gm.EnumDockPosition={TOP:1,RIGHT:2,BOTTOM:3,LEFT:4};mstrmojo.gm.EnumXAxisLabelStatus={NORMAL:1,STAGGER:2,ROTATE:3,HORI_DROP:4};mstrmojo.gm.EnumABLDirection={UNDEFINED:-1,NONE:0,HORIZONTAL:1,VERTICAL:2};mstrmojo.gm.EnumMetricsPosition={MetricsByRow:0,MetricsByColumn:1,MetricsByAxis:2,MetricsByBreakBy:3,MetricsBySlice:4,MetricsByXAxis:5,MetricsByYAxis:6};mstrmojo.gm.EnumDrawingAPI={GET_CHART_WIDTH:0,GET_CHART_HEIGHT:1,GET_ROW_HEADER:2,GET_COLUMN_HEADER:3,CREATE_UNIT_Y_AXIS:4,CREATE_UNIT_X_AXIS:5,GET_FULL_FLEDGED_CHART:6,GET_ROW_SPAN:7,GET_COLUMN_SPAN:8,GET_METRICS_ON_X:9,GET_METRICS_ON_Y:10,GET_METRICS_ON_SIZE_BY:11,UPDATE_MINI_CHART:12,UPDATE_X_AXIS:13,UPDATE_Y_AXIS:14,MAX_RADIUS_CALC:15,GET_EXTRA_COLUMN_HEADER:16,UPDATE_COLUMN_HEADER:17,UPDATE_ROW_HEADER:18,LAYOUT_ALL_X_AXIS_LABELS:19,LAYOUT_ONE_X_AXIS_LABELS:20};mstrmojo.gm.WidgetPropertyTag={FIT_TO:"FitTo",AXIS_SCALE:"MinMax",SHAPE:"Shape",SUB_TYPE:"Subtype",VIS_TYPE:"visType",DATA_LABEL:"DataLabel",DATA_LABELS_PLACEMENT:"DataLabelPalcement",METRIC_LEVEL_DATA_LABEL:"mtcLvlDataLabel",DATA_LABEL_FONT_SIZE_CONSTRAINT:"DataLabelFontSizeConstraint",DATA_LABEL_TEXT_ANGLE:"DataLabelTextAngle",BANDING:"Banding",LEGEND_VISIBLE:"LegendVisibleness",COL_ALIGNMENT:"Columnalignment",ROW_ALIGNMENT:"Rowalignment",MAX_SIZE_TYPE:"SizeType",MAX_SIZE_VALUE:"SizeValue",MIN_SIZE_TYPE:"minSizeType",MIN_SIZE_VALUE:"minSizeValue",OUTSIDE_BORDER:"OutSideBorder",AXES:"AxisLine",MATRIX_LINES:"MatrixLine",GRID_LINES:"GridLine",SELECTION_TYPE:"SelectionType",SELECTIONS:"Selections",LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr",SCALE_CHART_HEIGHT:"rr",SCALE_CHART_WIDTH:"cr",SCALE_ROW_HEADERS:"rvr",SCALE_COL_HEADERS:"chr",SCALE_Y:"yr",SCALE_X:"xr",SCALE_Y2:"y2r",SCALE_X2:"x2r",SCALE_ALL:"scales",SCALE_V_EXTRA_LINE:"vExtraLine",SORT_ORDER:"so",SORT_INDEX:"si",AXIS_SCALE_DATA:"AxisScale",AXIS_SCALE_REAL_MIN:"rMin",AXIS_SCALE_REAL_MAX:"rMax",AXIS_SCALE_MANUAL_MIN:"mMin",AXIS_SCALE_MANUAL_MAX:"mMax",AXIS_SCALE_AUTO_MIN:"autoMin",AXIS_SCALE_AUTO_MAX:"autoMax",SINGLE_AXIS_SCALE_TYPE:"scaleType",LOG_SCALE:"logScale",GROUP_INFO:"groupInfo",METRIC_SHAPES:"metricShapes",AXIS_ORIGIN:"axisOrigin",AXIS_ORIGIN_AUTO:"axOriAuto",AXIS_ORIGIN_VALUE:"axOriValue",TREND_LINE_DEF:"trdDef",REF_LINE_DEF:"refDef",TREND_TYPE:"trdTp",TREND_LEVEL:"trdLvl",TREND_ENABLED:"trdEnabled",TREND_INCLUDE_BREAK_BY:"trdIncBB",TREND_POLY_DEGREE:"trdDgr",TREND_FORECAST_ENABLED:"trdFstEnabled",TREND_BWD_FORECAST:"trdBwdFst",TREND_FWD_FORECAST:"trdFwdFst",TREND_SEASONALITY:"trdSeason",TREND_BUBBLE_FORE_DEF:"trdBbForeDef",TREND_BUBBLE_FORE_FWD:"trdBbForeFwd",TREND_BUBBLE_FORE_BWD:"trdBbForeBwd",TREND_BUBBLE_FORE_ENABLED:"trdBbForeEnabled",TREND_BUBBLE_MAX:"trdBbMax",TREND_BUBBLE_MIN:"trdBbMin",REF_TYPE:"refTp",REF_LEVEL:"refLvl",REF_ENABLED:"refEnabled",REF_SHOW_LABEL:"refLbShw",REF_LABEL_TYPE:"refLbTp",REF_CONST_VALUE:"refCstVl",REF_LINE_NAME:"refLnName",TREND_REF_LINE_THICKNESS:"trdRefLnThk",TREND_REF_LINE_COLOR:"trdRefLnClr",TREND_REF_LINE_STYLE:"trdRefLnStyle",TREND_REF_LINE_COMBINED_STYLE:"trdRefLnCmbStyle",FORMATS_ON_COMBINATION:"fmtOnComb",PARTIAL_RENDER:"prtRdn",SHOW_BOTH_TOTALS:"totalShw:intSumShw"};mstrmojo.gm.FormatingPropertyTag={IS_DEFAULT_VALUE:"_default",MODIFIED_DEF_FILL_COLOR:"modDefFillClr",ALL_SHAPE_FORMAT:"allShpFmt",SHAPE_LINE_THICKNESS:"shpLnThk",SHAPE_LINE_COLOR:"shpLnClr",SHAPE_LINE_STYLE:"shpLnStyle",SHAPE_LINE_COMBINED_STYLE:"shpLnCmbStyle",SHAPE_FILL_COLOR:"shpFillClr",SHAPE_FILL_COLOR_DEFAULT:"shpFillClr_default",SHAPE_FILL_STYLE:"shpFillStyle",SHAPE_FILL_TRANSPARENCY:"shpFillTrans",SHAPE_FILL_EFFECT:"shpFillEff",SHAPE_BORDER_COLOR:"shpBdrClr",SHAPE_BORDER_STYLE:"shpBdrStyle",SHAPE_BORDER_COMBINED_STYLE:"shpBdrCmbStyle",SHAPE_BORDER_THICKNESS:"shpBdrThk",LINE_MARKER_SHOW:"lnMkShw",LINE_MARKER_SHAPE:"lnMkShp",LINE_MARKER_SIZE:"lnMkSz",LINE_MARKER_COLOR:"lnMkClr",LINE_MARKER_COLOR_EQUAL:"lnMkClrEq",LINE_MARKER_BORDER_COLOR:"lnMkBdrClr",PIE_EXPLODE:"pieExpl",DATA_LABELS_SHOW:"dlShw",DATA_LABELS_FONT_FAMILY:"dlFntFml",DATA_LABELS_FONT_SIZE:"dlFntSz",DATA_LABELS_FONT_STYLE:"dlFntStyle",DATA_LABELS_FONT_COLOR:"dlFntClr",REF_LABELS_FONT_FAMILY:"rfLnFntFml",REF_LABELS_FONT_SIZE:"rfLnFntSz",REF_LABELS_FONT_STYLE:"rfLnFntStyle",REF_LABELS_FONT_COLOR:"rfLnFntClr",LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",ALL_LINE_SHOW:"allLnShw",ALL_LINE_COLOR:"allLnClr",ALL_LINE_STYLE:"allLnStyle",ALL_LINE_COMBINED_STYLE:"allLnCmbStyle",ALL_LINE_THICKNESS:"allLnThk",ALL_AXIS_ORIGIN_LINE_SHOW:"axOriLnShw",ALL_AXIS_ORIGIN_LINE_COLOR:"axOriLnClr",ALL_AXIS_ORIGIN_LINE_COMBINED_STYLE:"axOriLnCmbStyle",X_AXIS_ORIGIN_LINE_SHOW:"xAxOriLnShw",X_AXIS_ORIGIN_LINE_COLOR:"xAxOriLnClr",X_AXIS_ORIGIN_LINE_STYLE:"xAxOriLnStyle",X_AXIS_ORIGIN_LINE_COMBINED_STYLE:"xAxOriLnCmbStyle",X_AXIS_ORIGIN_LINE_THICKNESS:"xAxOriLnThk",Y_AXIS_ORIGIN_LINE_SHOW:"yAxOriLnShw",Y_AXIS_ORIGIN_LINE_COLOR:"yAxOriLnClr",Y_AXIS_ORIGIN_LINE_STYLE:"yAxOriLnStyle",Y_AXIS_ORIGIN_LINE_COMBINED_STYLE:"yAxOriLnCmbStyle",Y_AXIS_ORIGIN_LINE_THICKNESS:"yAxOriLnThk",ALL_AXIS_LINE_SHOW:"allAxLnShw",ALL_AXIS_LINE_COLOR:"allAxLnClr",ALL_AXIS_LINE_STYLE:"allAxLnStyle",ALL_AXIS_LINE_COMBINED_STYLE:"allAxLnCmbStyle",ALL_AXIS_LINE_THICKNESS:"allAxLnThk",ALL_AXIS_TITLE_SHOW:"allAxTtShw",ALL_AXIS_TITLE_CONTENT:"allAxTtCtt",ALL_AXIS_TITLE_FONT_COLOR:"allAxTtFntClr",ALL_AXIS_TITLE_FONT_FAMILY:"allAxTtFntFml",ALL_AXIS_TITLE_FONT_STYLE:"allAxTtFntStyle",ALL_AXIS_TITLE_FONT_SIZE:"allAxTtFntSz",ALL_AXIS_LABELS_FONT_SIZE:"allAxLbFntSz",ALL_AXIS_LABELS_FONT_FAMILY:"allAxLbFntFml",ALL_AXIS_LABELS_FONT_STYLE:"allAxLbFntStyle",ALL_AXIS_LABELS_FONT_COLOR:"allAxLbFntClr",ALL_AXIS_LABELS_ROTATION:"allAxLbRtt",ALL_AXIS_LABELS_SHOW:"allAxLbShw",X_AXIS_LINE_SHOW:"xAxLnShw",X_AXIS_LINE_COLOR:"xAxLnClr",X_AXIS_LINE_STYLE:"xAxLnStyle",X_AXIS_LINE_COMBINED_STYLE:"xAxLnCmbStyle",X_AXIS_LINE_THICKNESS:"xAxLnThk",X_AXIS_TITLE_SHOW:"xAxTtShw",X_AXIS_TITLE_CONTENT:"xAxTtCtt",X_AXIS_TITLE_FONT_COLOR:"xAxTtFntClr",X_AXIS_TITLE_FONT_FAMILY:"xAxTtFntFml",X_AXIS_TITLE_FONT_STYLE:"xAxTtFntStyle",X_AXIS_TITLE_FONT_SIZE:"xAxTtFntSz",X_AXIS_LABELS_FONT_SIZE:"xAxLbFntSz",X_AXIS_LABELS_FONT_FAMILY:"xAxLbFntFml",X_AXIS_LABELS_FONT_STYLE:"xAxLbFntStyle",X_AXIS_LABELS_FONT_COLOR:"xAxLbFntClr",X_AXIS_LABELS_ROTATION:"xAxLbRtt",X_AXIS_LABELS_SHOW:"xAxLbShw",Y_AXIS_LINE_SHOW:"yAxLnShw",Y_AXIS_LINE_COLOR:"yAxLnClr",Y_AXIS_LINE_STYLE:"yAxLnStyle",Y_AXIS_LINE_COMBINED_STYLE:"yAxLnCmbStyle",Y_AXIS_LINE_THICKNESS:"yAxLnThk",Y_AXIS_TITLE_SHOW:"yAxTtShw",Y_AXIS_TITLE_CONTENT:"yAxTtCtt",Y_AXIS_TITLE_FONT_COLOR:"yAxTtFntClr",Y_AXIS_TITLE_FONT_FAMILY:"yAxTtFntFml",Y_AXIS_TITLE_FONT_STYLE:"yAxTtFntStyle",Y_AXIS_TITLE_FONT_SIZE:"yAxTtFntSz",Y_AXIS_LABELS_FONT_SIZE:"yAxLbFntSz",Y_AXIS_LABELS_FONT_FAMILY:"yAxLbFntFml",Y_AXIS_LABELS_FONT_STYLE:"yAxLbFntStyle",Y_AXIS_LABELS_FONT_COLOR:"yAxLbFntClr",Y_AXIS_LABELS_ROTATION:"yAxLbRtt",Y_AXIS_LABELS_SHOW:"yAxLbShw",ALL_FILL_COLOR:"allFillClr",ALL_FILL_TRANSPARENCY:"allFillTrans",BG_COLOR:"bgFillClr",BG_FILL_EFFECT:"bgFillEff",BG_FILL_STYLE:"bgFillStyle",BG_FILL_TRANSPARENCY:"bgFillTrans",ROW_HEADER_FILL_COLOR:"rwHdrFillClr",ROW_HEADER_FILL_EFFECT:"rwHdrFillEff",ROW_HEADER_FILL_STYLE:"rwHdrFillStyle",ROW_HEADER_FILL_TRANSPARENCY:"rwHdrFillTrans",COLUMN_HEADER_FILL_COLOR:"colHdrFillClr",COLUMN_HEADER_FILL_EFFECT:"colHdrFillEff",COLUMN_HEADER_FILL_STYLE:"colHdrFillStyle",COLUMN_HEADER_FILL_TRANSPARENCY:"colHdrFillTrans",ALL_MATRIX_LINES_SHOW:"allMatrixLnShw",ALL_MATRIX_LINES_COLOR:"allMatrixLnClr",ALL_MATRIX_LINES_THICKNESS:"allMatrixLnThk",ALL_MATRIX_LINES_STYLE:"allMatrixLnStyle",ALL_MATRIX_LINES_COMBINED_STYLE:"allMatrixLnCmbStyle",V_MATRIX_LINES_SHOW:"vMatrixLnShw",V_MATRIX_LINES_COLOR:"vMatrixLnClr",V_MATRIX_LINES_THICKNESS:"vMatrixLnThk",V_MATRIX_LINES_STYLE:"vMatrixLnStyle",V_MATRIX_LINES_COMBINED_STYLE:"vMatrixLnCmbStyle",H_MATRIX_LINES_SHOW:"hMatrixLnShw",H_MATRIX_LINES_COLOR:"hMatrixLnClr",H_MATRIX_LINES_THICKNESS:"hMatrixLnThk",H_MATRIX_LINES_STYLE:"hMatrixLnStyle",H_MATRIX_LINES_COMBINED_STYLE:"hMatrixLnCmbStyle",OUTSIDE_BORDER_SHOW:"outBdrShw",OUTSIDE_BORDER_COLOR:"outBdrClr",OUTSIDE_BORDER_STYLE:"outBdrStyle",OUTSIDE_BORDER_THICKNESS:"outBdrThk",OUTSIDE_BORDER_COMBINED_STYLE:"outBdrCmbStyle",GRID_LINE_AUTO:"gridLineAuto",ALL_GRID_LINES_SHOW:"allGridLnShw",ALL_GRID_LINES_COLOR:"allGridLnClr",ALL_GRID_LINES_THICKNESS:"allGridLnThk",ALL_GRID_LINES_STYLE:"allGridLnStyle",ALL_GRID_LINES_COMBINED_STYLE:"allGridLnCmbStyle",AUTO_GRID_LINES_COLOR:"autoGridLnClr",AUTO_GRID_LINES_COMBINED_STYLE:"autoGridLnCmbStyle",MAJOR_GRID_LINES_SHOW:"majorGridLnShw",MAJOR_GRID_LINES_COLOR:"majorGridLnClr",MAJOR_GRID_LINES_THICKNESS:"majorGridLnThk",MAJOR_GRID_LINES_STYLE:"majorGridLnStyle",MAJOR_GRID_LINES_COMBINED_STYLE:"majorGridLnCmbStyle",MINOR_GRID_LINES_SHOW:"minerGridLnShw",MINER_GRID_LINES_COLOR:"minerGridLnClr",MINER_GRID_LINES_THICKNESS:"minerGridLnThk",MINER_GRID_LINES_STYLE:"minerGridLnStyle",MINER_GRID_LINES_COMBINED_STYLE:"minerGridLnCmbStyle",ALL_NGM_GRID_LINES_SHOW:"allNGMGridLnShw",X_GRID_LINES_SHOW:"xGridLnShw",Y_GRID_LINES_SHOW:"yGridLnShw",ALL_ROW_COLUMN_SHOW:"allRwColShw",COLUMN_TEXT_SHOW:"colTxtShw",ROW_TEXT_SHOW:"rwTxtShw",COLUMN_HEADER_SHOW:"colHdrShw",ROW_HEADER_SHOW:"rwHdrShw",COLUMN_VALUES_SHOW:"colVlShw",ROW_VALUES_SHOW:"rwVlShw",ALL_TEXT_FONT_COLOR:"allTxtFntClr",ALL_TEXT_FONT_SIZE:"allTxtFntSz",ALL_TEXT_FONT_FAMILY:"allTxtFntFml",ALL_TEXT_FONT_STYLE:"allTxtFntStyle",ALL_ROW_COLUMN_TEXT_FONT_COLOR:"allRwColTxtFntClr",ALL_ROW_COLUMN_TEXT_FONT_SIZE:"allRwColTxtFntSz",ALL_ROW_COLUMN_TEXT_FONT_FAMILY:"allRwColTxtFntFml",ALL_ROW_COLUMN_TEXT_FONT_STYLE:"allRwColTxtFntStyle",ALL_ROW_COLUMN_TEXT_ALIGNMENT_HORIZONTAL:"allRwColTxtAlignH",ALL_ROW_COLUMN_TEXT_ALIGNMENT_VERTICAL:"allRwColTxtAlignV",ROW_TEXT_TEXT_FONT_COLOR:"rwTxtTxtFntClr",ROW_TEXT_TEXT_FONT_SIZE:"rwTxtTxtFntSz",ROW_TEXT_TEXT_FONT_FAMILY:"rwTxtTxtFntFml",ROW_TEXT_TEXT_FONT_STYLE:"rwTxtTxtFntStyle",ROW_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"rwTxtTxtAlignH",ROW_TEXT_TEXT_ALIGNMENT_VERTICAL:"rwTxtTxtAlignV",COLUMN_TEXT_TEXT_FONT_COLOR:"colTxtTxtFntClr",COLUMN_TEXT_TEXT_FONT_SIZE:"colTxtTxtFntSz",COLUMN_TEXT_TEXT_FONT_FAMILY:"colTxtTxtFntFml",COLUMN_TEXT_TEXT_FONT_STYLE:"colTxtTxtFntStyle",COLUMN_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"colTxtTxtAlignH",COLUMN_TEXT_TEXT_ALIGNMENT_VERTICAL:"colTxtTxtAlignV",ROW_HEADER_TEXT_FONT_COLOR:"rwHdrTxtFntClr",ROW_HEADER_TEXT_FONT_SIZE:"rwHdrTxtFntSz",ROW_HEADER_TEXT_FONT_FAMILY:"rwHdrTxtFntFml",ROW_HEADER_TEXT_FONT_STYLE:"rwHdrTxtFntStyle",ROW_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"rwHdrTxtAlignH",ROW_HEADER_TEXT_ALIGNMENT_VERTICAL:"rwHdrTxtAlignV",COLUMN_HEADER_TEXT_FONT_COLOR:"colHdrTxtFntClr",COLUMN_HEADER_TEXT_FONT_SIZE:"colHdrTxtFntSz",COLUMN_HEADER_TEXT_FONT_FAMILY:"colHdrTxtFntFml",COLUMN_HEADER_TEXT_FONT_STYLE:"colHdrTxtFntStyle",COLUMN_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"colHdrTxtAlignH",COLUMN_HEADER_TEXT_ALIGNMENT_VERTICAL:"colHdrTxtAlignV",ROW_VAVLUE_TEXT_FONT_COLOR:"rwVlTxtFntClr",ROW_VAVLUE_TEXT_FONT_SIZE:"rwVlTxtFntSz",ROW_VAVLUE_TEXT_FONT_FAMILY:"rwVlTxtFntFml",ROW_VAVLUE_TEXT_FONT_STYLE:"rwVlTxtFntStyle",ROW_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"rwVlTxtAlignH",ROW_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"rwVlTxtAlignV",COLUMN_VAVLUE_TEXT_FONT_COLOR:"colVlTxtFntClr",COLUMN_VAVLUE_TEXT_FONT_SIZE:"colVlTxtFntSz",COLUMN_VAVLUE_TEXT_FONT_FAMILY:"colVlTxtFntFml",COLUMN_VAVLUE_TEXT_FONT_STYLE:"colVlTxtFntStyle",COLUMN_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"colVlTxtAlignH",COLUMN_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"colVlTxtAlignV",TITLE_FONT_COLOR:"ttlFntClr",TITLE_FONT_SIZE:"ttlFntSz",TITLE_FONT_FAMILY:"ttlFntFml",TITLE_FONT_STYLE:"ttlFntStyle",COLOR_SQUARE_COLOR:"clrSqrClr",SELECTION_LIMIT:"slctnLmt",CONTAINER_FIT_MODE:"cntrFitMode",SHOW_MODEBAR:"showModeBar",MEAN_SD:"meanSD",POINT_SIZE:"ptSize",PTSZ_TYPE:"ptSzType",JITTER:"jitter",JTR_TYPE:"jtrType",POINT_POS:"ptPos",PTPOS_TYPE:"ptPosType",SHOW_OUTLIERS:"shwOutliers",CUSTOM_BINS_MODE:"custMode",MANUAL_BINS_MODE:"manualBinsMode",RANGE_TYPE:"rangeType",NUM_BINS:"numBins",XBINS_START:"xBinsStart",XBINS_END:"xBinsEnd",XBINS_SIZE:"xBinsSize",HAS_UNCHECKED_AUTO:"hasUncheckedAuto",HAS_UNCHECKED_DATASET_RANGE:"hasUncheckedDstRng",TOTAL_SHOW:"totalShw",TOTAL_LABEL:"totalLabel",INT_SUM_SHOW:"intSumShw",POSITIVE_COLOR:"posClr",NEGATIVE_COLOR:"negClr",TOTAL_COLOR:"totalClr",INT_SUM_COLOR:"intSumClr",INT_SUM_FULL:"intSumFull"};mstrmojo.gm.EnumAxis={DssAxisReserved:0,DssAxisRows:1,DssAxisColumns:2,DssAxisPages:3,DssAxisChapters:4,DssAxisAll:5};mstrmojo.gm.EnumCombinedLineStyle={NONE:99,THIN:1,THICK:2,DASHED:3,DOTTED:4};mstrmojo.gm.EnumSizeByType={SQUARE:1,CIRCLE:4};mstrmojo.gm.EnumTheme={DARK:0,LIGHT:1};mstrmojo.gm.EnumFitTo={NONE:1,AUTOMATIC:2,COMPACT:3,MANUAL:4};mstrmojo.gm.EnumAxisScale={GLOBAL:0,PERROWCOL:1,PERCELL:2,CUSTOM:3,DIFFERENT:4};mstrmojo.gm.EnumShape={GENERIC:-1,AREA:0,BAR:1,LINE:2,STEPLINE:3,CIRCLE:4,RECTANGLE:5,SQUARE:6,TICK:7,PIESLICE:8,POLYGON:9,PIE:10,RING:11,DEFAULT:12,BULLET:13};mstrmojo.gm.EnumSubtype={AUTO:1,ABSOLUTE:2,STACKED:3,CLUSTERED:4,PERCENT:5};mstrmojo.gm.EnumDataLabels={HIDE:1,SHOW_VALUE_ONLY:2,SHOW_TEXT_ONLY:3};mstrmojo.gm.EnumDataLabelPlacements={AUTOMATIC:1,GENERIC:2,RESERVED:3};mstrmojo.gm.EnumLegend={SHOW:0,HIDE:1,MINIMIZED:2};mstrmojo.gm.EnumLegendMode={RESTORED:1,MINIMIZED:2};mstrmojo.gm.EnumTextAlignH={LEFT:0,MIDDLE:1,RIGHT:2};mstrmojo.gm.EnumTextAlignV={TOP:0,MIDDLE:1,BOTTOM:2};mstrmojo.gm.EnumMaxSizeType={AUTO:1,MANUAL:2,AUTO_FIT:3};mstrmojo.gm.EnumMinSizeType={AUTO:1,MANUAL:2,PROPORTIONAL:3};mstrmojo.gm.EnumAxes={SHOW_BOTH:1,SHOW_NONE:2,SHOW_X:3,SHOW_Y:4};mstrmojo.gm.EnumMatrixLines={SHOW_ALL:1,SHOW_NONE:2,SHOW_HORIZONTAL:3,SHOW_VERTICAL:4};mstrmojo.gm.EnumGridLines={AUTO:1,SHOW:2,HIDE:3,SHOW_MAJOR_ONLY:4};mstrmojo.gm.EnumNGMGridLines={SHOW_Y:1,SHOW_X:2,SHOW:3,HIDE:4,AUTO:5};mstrmojo.gm.LineMarkerShape={Circle:4,Square:1};mstrmojo.gm.ShapeFillType={Solid:0,Gradient:14,Pattern:3};mstrmojo.gm.ShapeFillEffect={None:1,Bevel:2};mstrmojo.gm.Enum3DGMapping={SizeType:"9999_1002",SizeValue:"9999_1003",lgdBgFillClr:"6_564",lgdBgFillStyle:"6_10002",lgdBgFillEff:"6_608",lgdFntSz:"9_603",lgdFntFml:"9_576",lgdFntStyle:"9_584",lgdFntClr:"9_574",LegendVisibleness:"9999_116",xAxShw:"9999_124",xAxTtCtt:"293_9999",xAxTtFntClr:"293_574",xAxTtFntFml:"293_576",xAxTtFntStyle:"293_584",xAxLbFntSz:"272_603",xAxLbFntFml:"272_576",xAxLbFntStyle:"272_584",yAxShw:"9999_125",yAxTtCtt:"299_9999",yAxTtFntClr:"299_574",yAxTtFntFml:"299_576",yAxTtFntStyle:"299_584",yAxLbFntSz:"296_603",yAxLbFntFml:"296_576",yAxLbFntStyle:"296_584",bgFillClr:"1_564",bgFillEff:"1_879",bgFillTrans:"1_608",outBdrClr:"1_588"};mstrmojo.gm.EnumRefLineModelType={MAX:1,MIN:2,AVG:3,MED:4,FIRST:5,LAST:6,CONST:7};mstrmojo.gm.EnumTrendLineModelType={BEST_FIT:256,LINEAR:257,LOG:258,EXP:259,POW:260,POLY:261};mstrmojo.gm.EnumTrendRefLevel={DssModelLevelReserved:0,DssModelLevelPerCell:1,DssModelLevelPerRow:2,DssModelLevelPerColumn:3,DssModelLevelPerPanel:4,DssModelLevelLastOne:5};mstrmojo.gm.EnumTimeRole={None:0,YearOfDecade:3083,QuarterOfYear:2826,MonthOfYear:2825,MonthOfQuarter:2569,WeekOfYear:2824,WeekOfQuarter:2568,WeekOfMonth:2312,DayOfYear:2823,DayOfQuarter:2567,DayOfMonth:2311,DayOfWeek:2055,HourOfDay:1798,MinuteOfDay:1797,MinuteOfHour:1541,SecondOfDay:1796,SecondOfHour:1540,SecondOfMinute:1284};mstrmojo.gm.EnumTrendRefModelLabels={DssModelLabelsReserved:-1,DssModelLabelsNone:0,DssModelLabelsType:1,DssModelLabelsMetric:2,DssModelLabelsValue:4};mstrmojo.gm.EnumTRFManipulations={AddTRLine:"141",RemoveTRLine:"142",UpdateTRLine:"143",UpdateForecastInfo:"144"};mstrmojo.gm.EnumShapeFormatStatus={NORMAL:0,PER_COLORBY:1,PER_SHAPE:2};mstrmojo.gm.EnumNGMSubtype={CLUSTERED:0,STACKED:1,PERCENT:2};mstrmojo.gm.EnumBoxPlotMean={NO_MEAN:0,ONLY_MEAN:1,MEAN_STDEV:2};mstrmojo.gm.EnumBoxPlotOutliers={OUTLIERS:0,ALL_POINTS:1,JITTER:0,JTR_MAN:0.5,POINT_POS:0,POS_MAN:-1.8,POINT_SIZE:6,SIZE_MAN:10,MANUAL:1};mstrmojo.gm.EnumHistogram={AUTOMATIC:1,MANUAL:0,CUST_INPUT:2,DATASET:3,BY_BIN_SIZE:4,BY_BIN_NUMBER:5};mstrmojo.gm.EnumContainerFitModes={AUTOMATIC:0,FIT_TO_CONTAINER:1,FIT_TO_CONTENT:2};mstrmojo.vi.enums.EnumVisFilterType={KEEP_ONLY:0,ADV_QUALIFICATION:1,LINKING:2,DRILLING:3};(function(){mstrmojo.requiresCls("mstrmojo.gm.GMEnums");var J=mstrmojo.gm,I=J.EnumGraphType,K=J.EnumDataLabels,A=J.EnumLegend,L=J.EnumMinSizeType,H=J.EnumFitTo,B=J.EnumContainerFitModes,D=J.EnumNGMGridLines,N=J.EnumSubtype;var M="Arial",F="Open Sans",E="ALL";var C={DEFAULT:"spatial",CLASSIC:"classic"};var O={THEME_STYLE:C.CLASSIC,LAYOUT:{allFF:M,titleFF:M,dlvPadding:2,dlvMargin:4,dlvLOH_Compensation:1,ucTBLOHeight:1,drpChildPadding:4,drpLOHW_Compensation:0,cueBottomOffset:1},GRID:{paddingSize:5,mRatio:2,lRatio:3,gridTemplateVisible:false},HEATMAP:{smallGap:2,middleGap:4,largeGap:6,largerGap:8},NGM:{GENERAL_PROPS:(function(){var P={};P[E]={dataLabels:K.HIDE};return P;}()),DEFAULT_PROPS:(function(){var P={};P[E]={cntrFitMode:B.AUTOMATIC};return P;}())},OGM:{GENERAL_PROPS:(function(){var P={};P[E]={dataLabels:K.HIDE,minRowHeight:20,fitTo:H.AUTOMATIC};return P;}()),DEFAULT_PROPS:(function(){var P={};P[E]={};P[I.BAR]={shpBdrThk:1,shpBdrStyle:0};P[I.PIE]={shpBdrThk:1,shpBdrStyle:0};P[I.GRID]={shpFillTrans:70};return P;}())},KPI:{fontFamily:M,defaultFontClr:{1:"#444649",2:"#FFFFFF",3:"#FFFFFF",4:"#FFFFFF"}}},G={THEME_STYLE:C.DEFAULT,LAYOUT:{allFF:F,titleFF:F,dlvPadding:0,dlvMargin:0,dlvLOH_Compensation:0,ucTBLOHeight:0,drpChildPadding:12,drpLOHW_Compensation:12,cueBottomOffset:-2},GRID:{paddingSize:4.52,mRatio:1050/452,lRatio:1205/452,gridTemplateVisible:true},HEATMAP:{smallGap:1,middleGap:3,largeGap:5,largerGap:5,cellTextSize:11,fontFamily:"Open Sans SemiBold",leftPadding:10,topPadding:8,lineHeightTime:1.3,marginTop:"3px"},NGM:{GENERAL_PROPS:(function(){var P={};P[E]={dataLabels:K.HIDE};P[I.WATERFALL]={dataLabels:K.HIDE};return P;}()),DEFAULT_PROPS:(function(){var P={};P[E]={dlFntFml:F,rfLnFntFml:F,lgdFntFml:F,xAxTtFntFml:F,xAxLbFntFml:F,yAxTtFntFml:F,yAxLbFntFml:F,allTxtFntFml:F,rwHdrTxtFntFml:F,colHdrTxtFntFml:F,rwVlTxtFntFml:F,colVlTxtFntFml:F,ttlFntFml:F,dlFntSz:"9pt",rfLnFntSz:"9pt",lgdFntSz:"9pt",xAxTtFntSz:"9pt",xAxLbFntSz:"9pt",yAxTtFntSz:"9pt",yAxLbFntSz:"9pt",allTxtFntSz:"9pt",rwHdrTxtFntSz:"9pt",colHdrTxtFntSz:"9pt",rwVlTxtFntSz:"9pt",colVlTxtFntSz:"9pt",ttlFntSz:"9pt"};P[I.WATERFALL]={yGridLnShw:D.AUTO,xGridLnShw:D.AUTO};return P;}())},OGM:{GENERAL_PROPS:(function(){var P={};P[E]={dataLabels:K.HIDE,minRowHeight:20};P[I.PIE]={legend:A.HIDE,legendShow:false,dataLabels:K.SHOW_TEXT_ONLY};P[I.SCATTER]={minSizeType:L.AUTO};return P;}()),DEFAULT_PROPS:(function(){var Q={};Q[E]={rwHdrShw:false,colHdrShw:false,dlFntFml:F,rfLnFntFml:F,lgdFntFml:F,xAxTtFntFml:F,xAxLbFntFml:F,yAxTtFntFml:F,yAxLbFntFml:F,allTxtFntFml:F,rwHdrTxtFntFml:F,colHdrTxtFntFml:F,rwVlTxtFntFml:F,colVlTxtFntFml:F,ttlFntFml:F,dlFntClr:3815477,rfLnFntClr:3815477,lgdFntClr:3815477,xAxTtFntClr:3815477,xAxLbFntClr:3815477,yAxTtFntClr:3815477,yAxLbFntClr:3815477,allTxtFntClr:3815477,rwHdrTxtFntClr:3815477,colHdrTxtFntClr:3815477,rwVlTxtFntClr:3815477,colVlTxtFntClr:3815477,ttlFntClr:3815477,yAxTtFntStyle:1,xAxTtFntStyle:1,rwHdrTxtFntStyle:1,colHdrTxtFntStyle:1,dlFntSz:"9pt",rfLnFntSz:"9pt",lgdFntSz:"9pt",xAxTtFntSz:"9pt",xAxLbFntSz:"9pt",yAxTtFntSz:"9pt",yAxLbFntSz:"9pt",allTxtFntSz:"9pt",rwHdrTxtFntSz:"9pt",colHdrTxtFntSz:"9pt",rwVlTxtFntSz:"9pt",colVlTxtFntSz:"9pt",ttlFntSz:"9pt"};Q[I.AREA]={shpBdrThk:1,shpBdrClr:15461355,};var P=Q[I.AREA];P["SUBTYPE_"+N.ABSOLUTE]={shpFillTrans:70};P["SUBTYPE_"+N.AUTO]={shpFillTrans:100};P["SUBTYPE_"+N.STACKED]={shpFillTrans:100};P["SUBTYPE_"+N.CLUSTERED]={shpFillTrans:100};P["SUBTYPE_"+N.PERCENT]={shpFillTrans:100};Q[I.BAR]={shpBdrClr:15461355,shpBdrStyle:0,shpBdrThk:1,shpFillTrans:100};Q[I.LINE]={shpFillTrans:100};Q[I.PIE]={shpBdrThk:1,shpBdrStyle:0,shpFillTrans:100,shpBdrClr:15461355};Q[I.SCATTER]={shpBdrStyle:99,shpFillTrans:40};Q[I.BUBBLE]={shpBdrStyle:99,shpFillTrans:40};Q[I.GRID]={shpBdrThk:1,shpFillTrans:100};return Q;}())},KPI:{fontFamily:F,defaultFontClr:{1:"#35383A",2:"#FFFFFF",3:"#FFFFFF",4:"#FFFFFF"}}};mstrmojo.vi.enums.EnumThemeProperties={CLASSIC_THEME_PROPS:O,DEFAULT_THEME_PROPS:G};mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE={GRID:"GRID",LAYOUT:"LAYOUT",HEATMAP:"HEATMAP"};mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_THEME=C;mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_STYLE={DEFAULT:0,CARD:1,FLAT:2};mstrmojo.vi.enums.EnumThemeProperties.ENUM_SHADOW_STYLE={VISIBLE:0,HIDDEN:1};})();(function(){mstrmojo.requiresCls("mstrmojo.models.template.Title");mstrmojo.models.template.Titles=mstrmojo.declare(null,null,{init:function D(G){var F=this.gridData=G.data,E=F.gts;this.titles=G.isRow?E.row:E.col;},size:function C(){return this.titles.length;},getTitle:function B(E){return new mstrmojo.models.template.Title({title:this.titles[E]});},getCSS:function A(E){return this.gridData.css[this.titles[E].cni].n;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources");function D(H){this.cleanUpAfterTarget(H);var G=H.tgtData;if(G){delete H.tgtData;}var I=this.getContextDragData(H);if(I&&I.setAvatarClass){I.setAvatarClass("");}}mstrmojo.vi.ui._IsDropTarget=mstrmojo.provide("mstrmojo.vi.ui._IsDropTarget",{_mixinName:"mstrmojo.vi.ui._IsDropTarget",dropZone:true,getDropAvatarIcon:function B(G){return"add";},getContextDragData:function F(G){return G.getCtxtDragData();},cleanUpAfterTarget:mstrmojo.emptyFn,ondragenter:function A(G){var H=this.getContextDragData(G);if(H&&H.setAvatarClass){H.setAvatarClass(this.getDropAvatarIcon(G));}if(this._super){this._super(G);}},ondragleave:function E(G){D.call(this,G);if(this._super){this._super(G);}},ondrop:function C(G){D.call(this,G);if(this._super){this._super(G);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.models.template.Header");mstrmojo.models.template.Headers=mstrmojo.declare(null,null,{init:function D(K){var O=this.isRow=K.isRow,J=this.data=K.data,L=J.gts,G=J.ghs,F=this.hs=O?G.rhs:G.chs,M=this.i=K.i,N=0,I;this.titles=O?L.row:L.col;this.headers=F.items&&F.items[M]&&F.items[M].items;this.missingTitles=this.titles&&this.headers?(this.headers.length-this.titles.length):0;if(O&&this.headers){N=this.titles.length-this.headers.length;if(N){for(I=M-1;I>=0;I--){var E=F.items[I].items,H=E.length-this.headers.length;if(H>0){this.headers=E.slice(0,H).concat(this.headers);if(this.titles.length===this.headers.length){break;}}}}}},size:function B(){var E=this.headers;return(!E?0:E.length);},getHeader:function C(H){var F=this.headers,G=F&&F[H],E=H;if(G&&this.missingTitles){E=isNaN(G.tui)?G.ui:G.tui;}return G&&new mstrmojo.models.template.Header({h:G,t:this.titles[this.isRow?E:this.i]});},getCSS:function A(F){var E=this.headers;return E&&this.data.css[E[F].cni].n;},getHeaderCell:function(F){var E=this.headers;return E&&E[F];}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.hash");var I=mstrmojo.array,B=mstrmojo.hash,D="u;",C="-1";ELEM_HIDDEN_PROP="hid";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function F(R,Q,V){var P,O;for(O in R){P=R[O];if(P.v){var S=P.v.replace(/\\\\/g,"\u001e").replace(/\\\;/g,"\u001f");var U=S.split(";");if(U&&U.length>1){U[1]=Q;if(V&&U.length>2){U.pop();}P.v=U.join(";").replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\;");}}}return R;},buildElemsCountStr:function K(U,Q,P){U=(!U||!U.length)?[]:U;Q=(!Q||!Q.length)?[]:Q;function S(V){return V.filter(function(W){return !W[ELEM_HIDDEN_PROP];});}var R=S(U).length,O=S(Q).length;if(I.find(Q,"v",D)>-1){O-=1;}if(I.find(Q,"v",C)>-1){O-=1;}if(P){R=(R<O)?O-R:0;}if(I.find(U,"v",D)>-1||I.indexOf(U,D)>-1){R=O;}return this.buildElemsCountStrByNum(R,O);},buildElemsCountStrByNum:function K(P,O){if(P===O){if(O===0){return"";}return O.toString();}else{if(O===0){return P+" "+mstrmojo.desc(514);}else{if(P>O){return"("+O+")";}}}return mstrmojo.desc(4891,"").replace("##",String(P)).replace("###",String(O));},browseElements:function G(Q,R,P){var O={doNotHold:!(P&&mstrApp.serverProxy),silent:true};mstrApp.serverRequest(mstrmojo.hash.copy(P,R),Q,O);},getIdPresentation:function J(R){if(!!R){var Q=R.charAt(0),O,P,S;if((Q>="g"&&Q<="w")||(Q>="V"&&Q<="Z")){P=false;for(S=1;S<R.length;++S){if(P){P=false;}else{switch(R.charAt(S)){case";":return"terseLong";case"\\":P=true;break;}}}return"terse";}if(Q>="B"&&Q<="Q"){if(R.length>2){O=R.charAt(1);if(O>="A"&&O<="Q"){if(R.charAt(2)===":"){return"oldLong";}}}}if(R.length>=33&&R.charAt(32)===":"){return"old";}}return null;},terseLong2OldShort:function N(P){if(this.getIdPresentation(P)!=="terseLong"){return P;}var O=P.replace(/\\\\/g,"\u001e").replace(/\\\;/g,"\u001f"),Q=O.substring(1,O.length).split(";");return(Q[1]+":"+Q[0]).replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\;");},oldShort2terseLong:function L(P,S){if(this.getIdPresentation(P)!=="old"){return P;}var O=P.replace(/\\\\/g,"\u001e").replace(/\\\:/g,"\u001f"),R=O.split(":"),Q=R.shift();return(S||"h")+(R.join(":")+";"+Q).replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\:");},isNullElem:function H(O){if(!O){return true;}var R=this.getIdPresentation(O),P=false,Q;switch(R){case"terse":case"terseLong":Q=O.substring(1,O.length).split(";");P=Q[0].indexOf(this.TERSE_NULL)>-1;break;case"old":case"oldLong":P=O.indexOf(this.OLD_NULL)>-1;break;}return P;},isNonGroupNull:function(Q){var O=Q.eid||(Q._e&&Q._e.id),P=O&&O.split(":")[0];return P&&P===this.NON_GROUP_NULL;},getAttributeId:function M(Q){var P,O;if(Q){O=Q.split(";");P=O[1];}return P;},getElementValue:function A(P){var Q,O;if(P){O=P.split(";");if(O.length>2){Q=O[0]+" "+O[2];}else{Q=O[0];}}return Q;},isAttributeIdsLinked:function E(P,O,Q){var S=false,R=B.keyarray(Q);I.forEach(R,function(U){if(U===P){I.forEach(Q[U],function(V){if(V===O){S=true;return false;}});}if(S){return false;}});return S;},ELEM_ALL_ID:"u;",ELEM_DUMMY_ID:"-1",ELEM_SEPARATOR:"\u001E",OLD_NULL:"~!@@~~!@@~",TERSE_NULL:"\\N",NON_GROUP_NULL:"n00000000000000000000000000000000",ELEM_ALL:{t:mstrmojo.chart.model.enums.EnumDSSObjectType.DssTypeDimension,v:"u;",n:"(All)"}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array;function A(E){var D=(E&&E.gts&&E.gts.col)||[],G=(E&&E.gts&&E.gts.row)||[];var F=C.filter(D.concat(G),function(H){return H.otp===-1;})[0];return{tpltProp:E.prop,mxProp:C.map((F&&F.es)||[],function(H){var I={};I[H.oid]=mstrmojo.hash.copy(H.prop,{n:H.n,t:H.otp});return I;})};}mstrmojo._IsDocumentTemplate=mstrmojo.provide("mstrmojo._IsDocumentTemplate",{_mixinName:"mstrmojo._IsDocumentTemplate",gridInfo:null,tmsProps:null,update:function B(D){if(D&&D.data){this.gridInfo=D.data.gsi;this.tmsProps=A(D.data);}if(this._super){return this._super(D);}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.hasRendered&&D.doEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){this._onEllipsizeFlagChange(this.shouldEllipsize,this.shouldEllipsizeChildren);},onshouldEllipsizeChildrenChange:function(){this._onEllipsizeFlagChange(this.shouldEllipsizeChildren,this.shouldEllipsize);},_onEllipsizeFlagChange:function(D,C){if(D&&!C){A(this);this.markupMethods=mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered){this.doEllipsize();}}},mstrmojo.hash.copy(this.markupMethods));}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var I=mstrmojo.array,Q=mstrmojo.desc(2412,"Default"),P=mstrmojo.desc(3433,"Font"),K=mstrmojo.desc(3434,"Number"),D=mstrmojo.desc(3435,"Alignment"),N=mstrmojo.desc(2886,"Borders"),E=mstrmojo.desc(3905,"Background"),R="-1,234.12",C="1,234.12",M="(1,234.12)",H="-$1,234.12",B="$1,234.12",J="($1,234.12)";var O=[{n:Q,v:"pru"}];I.forEach(["Arial","Arial Black","Arial Narrow","Arial Unicode MS","Batang","Book Antiqua","Bookman Old Style","Bookshelf Symbol 1","Bookshelf Symbol 2","Bookshelf Symbol 3","Comic Sans MS","Courier New","Garamond","Haettenschweiler","Helvetica","Impact","Lucida Console","Lucida Sans Unicode","Map Symbols","Marlett","Monotype Corsiva","Monotype Sorts","MS Gothic","MS Outlook","Microsoft Sans Serif","MT Extra","Open Sans SemiBold","Open Sans","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","Wingdings 2","Wingdings 3"],function(S){O.push({n:S,v:S,symbolic:true});});function G(U,S,V){return(S&&S>=U)?G(U,S-V,V).concat(S):[];}var A=G(2,12,1);A=A.concat(G(14,24,2));A=A.concat(G(36,48,12));A=A.concat(G(72,72,1));var F=[{n:Q,v:"pru"}];I.forEach(A,function(S){F.push({n:String(S),v:String(S)});});mstrmojo._FormatDefinition={Formats:[{n:P},{n:K},{n:D},{n:mstrmojo.desc(3436,"Color and Lines")}],FormatTarget:[{n:mstrmojo.desc(7942,"Element Header"),v:1,p:"header_format"},{n:mstrmojo.desc(7943,"Element Value"),v:2,p:"grid_format"},{n:mstrmojo.desc(7944,"Individual Items Header"),v:3,p:"child_header_format"},{n:mstrmojo.desc(7945,"Individual Items Value"),v:4,p:"child_grid_format"}],MetricFormatTarget:[{n:mstrmojo.desc(9710,"Metric Headers"),v:1,p:"header_format"},{n:mstrmojo.desc(9711,"Metric Values"),v:2,p:"grid_format"}],MetricValueFormats:[{n:K},{n:D},{n:P},{n:N},{n:E}],MetricHeaderFormats:[{n:K},{n:D},{n:P},{n:N},{n:E},{n:mstrmojo.desc(12139,"Chart")}],NumberFormatCategory:{Automatic:-3,Default:-2,General:9,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7},DefaultFormat:{FormattingAlignment:{Horizontal:"1",Vertical:"1",TextWrap:"0",TextDirection:"0"},FormattingBorder:{HInsideStyle:"1",VInsideStyle:"1",TopStyle:"1",LeftStyle:"1",BottomStyle:"1",RightStyle:"1",HInsideColor:"0",VInsideColor:"0",TopColor:"0",LeftColor:"0",BottomColor:"0",RightColor:"0",Border3DStyle:"0",Border3DWeight:"0",Border3DBottomColor:"0",Border3DLeftColor:"0",Border3DRightColor:"0",Border3DTopColor:"0"},FormattingFont:{Name:"Arial",Bold:"0",Italic:"0",Size:"10",Strikeout:"0",Underline:"0",Color:"0",Script:"0"},FormattingNumber:{Category:"9",DecimalPlaces:"0",ThousandSeparator:"-1",CurrencySymbol:"$",CurrencyPosition:"0",Format:"General",NegativeNumbers:"3"},FormattingPadding:{LeftPadding:"1",RightPadding:"1",TopPadding:"1",BottomPadding:"1",LineSpacing:"0"},FormattingPatterns:{FillColor:"16777215",PatternColor:"8650752",PatternStyle:"1",FillStyle:"0",ApplyToGraphThreshold:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0",SelectorSelectionColor:"16167264",SelectorSelectionFillStyle:"0",SeriesFillColor:"pru",SeriesPatternColor:"8650752",SeriesPatternStyle:"1",SeriesFillStyle:"0",SeriesApplyToGraphThreshold:"0",SeriesGradientColor:"16777215",SeriesGradientAngle:"0",SeriesGradientXOffset:"0",SeriesGradientYOffset:"0",SeriesSelectorSelectionColor:"16167264",SeriesSelectorSelectionFillStyle:"0"}},Families:O,Sizes:F,SizesInVI:F.slice(7,19),Styles:[{n:Q,v:"pru"},{n:mstrmojo.desc(3440,"Regular"),v:"0,0"},{n:mstrmojo.desc(2718,"Bold"),v:"-1,0",v2:"-1,"},{n:mstrmojo.desc(2719,"Italic"),v:"0,-1",v2:",-1"},{n:mstrmojo.desc(3441,"Bold Italic"),v:"-1,-1"}],Effects:[{n:"Underline",v:0},{n:"Strike",v:1}],Category:[{n:Q,v:-2},{n:mstrmojo.desc(2378,"General"),v:9},{n:mstrmojo.desc(2050,"Fixed"),v:0},{n:mstrmojo.desc(2051,"Currency"),v:1},{n:mstrmojo.desc(2052,"Date"),v:2},{n:mstrmojo.desc(2170,"Time"),v:3},{n:mstrmojo.desc(2053,"Percentage"),v:4},{n:mstrmojo.desc(2054,"Fraction"),v:5},{n:mstrmojo.desc(2055,"Scientific"),v:6},{n:mstrmojo.desc(2056,"Custom"),v:7}],MaxNegativeDidigts:30,FixedNegative:[{n:R,v:1,f:"#,##0.00"},{n:R,r:true,v:5,f:"#,##0.00;[RED]-#,##0.00"},{n:C,r:true,v:2,f:"#,##0.00;[RED]#,##0.00"},{n:M,v:3,f:"#,##0.00;(#,##0.00)"},{n:M,r:true,v:4,f:"#,##0.00;[RED](#,##0.00)"}],CurrencyNegative:[{n:H,v:1,f:'"$"#,##0.00'},{n:H,r:true,v:5,f:'"$"#,##0.00;[RED]-"$"#,##0.00'},{n:B,r:true,v:2,f:'"$"#,##0.00;[RED]"$"#,##0.00'},{n:J,v:3,f:'"$"#,##0.00;("$"#,##0.00)'},{n:J,r:true,v:4,f:'"$"#,##0.00;[RED]("$"#,##0.00)'}],CurrencyPosition:[{n:mstrmojo.desc(2194,"Left"),v:0},{n:mstrmojo.desc(2195,"Right"),v:1},{n:mstrmojo.desc(2183,"Left with space"),v:2},{n:mstrmojo.desc(2182,"Right with space"),v:3}],Date:[{n:mstrmojo.desc(2231,"4/7"),v:"m/d"},{n:mstrmojo.desc(2232,"04/07"),v:"mm/dd"},{n:mstrmojo.desc(2233,"4/7/98"),v:"m/d/yy"},{n:mstrmojo.desc(2234,"04/07/98"),v:"mm/dd/yy"},{n:mstrmojo.desc(2235,"04/07/1998"),v:"mm/dd/yyyy"},{n:mstrmojo.desc(2236,"7-Apr"),v:"d-mmm"},{n:mstrmojo.desc(2237,"7-Apr-98"),v:"d-mmm-yy"},{n:mstrmojo.desc(2238,"Apr-98"),v:"mmm-yy"},{n:mstrmojo.desc(2239,"Apr '98"),v:"mmm 'yy"},{n:mstrmojo.desc(2240,"April 1998"),v:"mmmm yyyy"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2243,"April 7, 1998"),v:"mmmm d, yyyy"}],Time:[{n:mstrmojo.desc(2244,"15:41"),v:"h:mm"},{n:mstrmojo.desc(2245,"3:41 PM"),v:"h:mm AM/PM"},{n:mstrmojo.desc(2246,"15:41:46"),v:"h:mm:ss"},{n:mstrmojo.desc(2247,"3:41:46 PM"),v:"h:mm:ss AM/PM"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2250,"04/07/98 15:41"),v:"mm/dd/yy h:mm"},{n:mstrmojo.desc(2248,"04/07/98 3:41 PM"),v:"mm/dd/yy h:mm AM/PM"}],PercentNegative:[{n:"-12.12%",v:1,f:"0.00%"},{n:"-12.12%",r:true,v:5,f:"0.00%;[RED]-0.00%"},{n:"12.12%",r:true,v:2,f:"0.00%;[RED]0.00%"},{n:"(12.12%)",v:3,f:"0.00%;(0.00%)"},{n:"(12.12%)",r:true,v:4,f:"0.00%;[RED](0.00%)"}],Fraction:[{n:"12 1/3",v:"# ?/?"},{n:"37/3",v:"?/?"},{n:"12 26/81",v:"# ??/??"},{n:"998/81",v:"??/??"}],TextDirection:[{n:Q,v:"pru"},{n:mstrmojo.desc(4601,"Horizontal"),v:0},{n:mstrmojo.desc(5156,"-90 Degree"),v:-90}],Horizontal:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2378,"General"),v:1},{n:mstrmojo.desc(2194,"Left"),v:2},{n:mstrmojo.desc(2193,"Center"),v:3},{n:mstrmojo.desc(2195,"Right"),v:4},{n:mstrmojo.desc(2068,"Justify"),v:6}],Vertical:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2256,"Top"),v:1},{n:mstrmojo.desc(2067,"Center"),v:2},{n:mstrmojo.desc(2257,"Bottom"),v:3}],TextWrap:[{v:0},{v:-1}],BorderStyles:[{n:Q,v:"pru"},{n:mstrmojo.desc(2258,"None"),v:0},{n:mstrmojo.desc(2259,"Dashed"),v:3},{n:mstrmojo.desc(2260,"Dotted"),v:4},{n:mstrmojo.desc(2261,"Hair"),v:7},{n:mstrmojo.desc(2262,"Thin"),v:1},{n:mstrmojo.desc(2264,"Thick"),v:5},{n:mstrmojo.desc(15361,"Double"),v:6}],extractModel:function(V,X,U){var Z=U||this.DefaultFormat,Y;for(Y in V){var S=V[Y];if(!S.attachEventListener){if(!mstrmojo.hash.isEmpty(S)){X[Y]=S;}}else{var W;for(W in S){if(Z[Y]&&Z[Y][W]){if(!X[Y]){X[Y]={};}X[Y][W]=S[W];}}}}},getAvailableFonts:function L(){var S={success:function(V){if(V.name==="fontPicker"){var U=[{n:Q,v:"pru"}];I.forEach(V.shortcuts,function(X){var Y=X.attributes,Z=I.filterOne(Y,function(a){return a.value;}),W=I.filterOne(Y,function(a){return a.symbolic;});U.push({n:Z&&Z.value,v:Z&&Z.value,symbolic:(W&&W.symbolic||"false").toUpperCase()==="TRUE"});});mstrmojo._FormatDefinition.Families=U;}}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,S,{taskId:"getSystemPickerJson",name:"fontPicker"},false,null,true);},getStandardFormat:function(U,S){var W=mstrmojo.hash.clone(S||this.DefaultFormat),V;U=U||{};for(V in W){U[V]=U[V]||{};}for(V in U){if(!U[V].attachEventListener){U[V]=mstrmojo.hash.make(U[V],mstrmojo.Obj);}}return U;},saveFormatModel:function(X,d,U,e){var c=e||this.DefaultFormat,Z,S;for(Z=0;Z<U.length;Z++){var Y=U[Z],W=d[Y]||null,b=X[Y];if(b===undefined){delete d[Y];continue;}for(S in c){var a=c[S],V;if((!W&&!b)||(W&&!W[S]&&!b[S])){continue;}for(V in a){if(b[S]===undefined||b[S]===""||b[S][V]==="pru"||b[S][V]===undefined){if(W&&W[S]&&(W[S][V]!==undefined&&W[S][V]!==null&&W[S][V]!=="pru")){W[S][V]="pru";}}else{W=W||{};W[S]=W[S]||{};W[S][V]=b[S][V];}}}if(W){d[Y]=W;}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var K=mstrmojo.array,D=mstrmojo.hash;function E(W,U){var X=[],Q=W.selectedIndices,P=W.allIdx;var R,S,V=W.items;if(W.multiSelect&&(P>-1)&&(K.indexOf(U,W.allIdx)>-1)){for(R=0,S=V.length;R<S;R++){if(!Q[R]){X.push(R);Q[R]=true;W.selectedIndex=R;W.selectedItem=V[R];}}}else{for(R=0,S=U.length;R<S;R++){var Y=U[R];if(!Q[Y]){Q[Y]=true;X.push(Y);W.selectedIndex=Y;W.selectedItem=V[Y];}}}return X;}function J(R){var Q=[],S=R.selectedIndices,P;for(P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function H(W,V){var S=[],Q=W.selectedIndices,Y=K.indexOf,P=W.allIdx;if(W.multiSelect&&(P>-1)&&(Y(V,P)>-1)){return J(W);}if(V.length>0&&Q[P]){if(Y(V,P)<0){V.push(P);}}var U=V.length,R;for(R=0;R<U;R++){var X=V[R];if(Q[X]){delete Q[X];S.push(X);if(W.selectedIndex===X){W.selectedIndex=-1;W.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var V=S.selectedIndex,U=[],W,Q;for(Q in P){if(!R[Q]){W=parseInt(Q,10);delete P[Q];U.push(W);if(V===W){S.selectedIndex=-1;S.selectedItem=null;}}}var Y=[],X=S.items;for(Q in R){if(!P[Q]){W=parseInt(Q,10);P[Q]=true;Y.push(W);S.selectedIndex=W;S.selectedItem=X&&X[W];}}return{add:Y,rmv:U};}function G(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function F(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=J(this),S=E(this,[P]);if(Q!==true){G(this,S,R);}}},toggleSelect:function O(P,Q){var S,R;if(this.selectedIndices[P]){R=H(this,[P]);}else{S=E(this,[P]);}if(Q!==true){G(this,S,R);}},rangeSelect:function N(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=J(this);if(P!==true){G(this,null,Q);}},select:function L(R,P){var Q=A(this,K.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){G(this,Q.add,Q.rmv);}},addSelect:function B(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=E(this,R);if(P!==true){G(this,Q,null);}return Q;},removeSelect:function M(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=H(this,R);if(P!==true){G(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){G(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(X,U,S){var R=U&&(typeof U==="object"),W=this.itemIdField,Q=-1,V=this.items;if(R&&W!=null){Q=K.find(V,W,U[W]);}else{if(U!=null){Q=K.indexOf(V,U);}}if((Q===-1)&&(U!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(V&&V.length)||0;}Q=P;this.add([U],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function C(U,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(U){this._set_selectedIndices(null,U,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!==null&&P!==undefined){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return D.keyarray(this.selectedIndices,true).sort(K.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return K.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,e){if(!Q||!Q.length){return ;}var S=this.items||[],u=this.itemIdField!=null?K.findMulti(S,this.itemIdField,Q):K.indexOfMulti(S,Q),W=Q.length,U=W-u.count,s=this.allowUnlistedValues,d=this.insertUnlistedValuesAt,Y=(s&&(d>-1))?U:0;if(d<0){d=S.length;}var R=[],V=[],g=u.map;if(U&&s){var q=0,f;for(f=0;f<W;f++){if(g[f]==null){R.push(Q[f]);V.push(d+q++);}}this.add(R,d);}var X=[],l;for(l in g){var p=g[l];if(p>=d){p+=Y;}X.push(p);}var t=X.concat(V),Z=this.addSelect(t,!e);if(!e){var a=K.hash(Z),h=this.selectedIndices,b=[],o;for(o in h){if(!a[o]){b.push(parseInt(o,10));}}var P=this.removeSelect(b,true);G(this,Z,P);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");mstrmojo.customviz.PICKED_TYPE={ATTR:"attribute",METRIC:"metric",BOTH:"both"};mstrmojo.customviz.PICKED_CRITERIA={SUBSET:"subset",INTERSECTION:"intersection"};var P=mstrmojo,K=P.hash,H=P.array;mstrmojo.customviz.GraphicModel=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.customviz.GraphicModel",_$_$_$_sysProperties:null,init:function M(){this._$_$_$_sysProperties={uniqueId:null,graphicCenter:null,selector:null,isAttrSelector:null,groupHeaders:null,drillFromHeader:null,updateDropZoneActions:null};},setCustomProperties:function F(S){K.copy(S,this);},getCustomProperty:function E(S){return this[S];},setSelector:function Q(S,U){this._$_$_$_sysProperties.selector=S;this._$_$_$_sysProperties.isAttrSelector=U;},getSelector:function L(){return this._$_$_$_sysProperties.selector;},isAttributeSelector:function D(){return this._$_$_$_sysProperties.isAttrSelector;},setId:function R(S){this._$_$_$_sysProperties.uniqueId=S;},getId:function I(){return this._$_$_$_sysProperties.uniqueId;},setGroupOptions:function A(S){this._$_$_$_sysProperties.groupHeaders=H.ensureArray(S);},getGroupHeaders:function O(){return this._$_$_$_sysProperties.groupHeaders;},setDrillOptions:function N(U,S){this._$_$_$_sysProperties.drillFromHeader=U;this._$_$_$_sysProperties.updateDropZoneActions=S;},getDrillHeader:function C(){return this._$_$_$_sysProperties.drillFromHeader;},getUpdateDropZoneActions:function J(){return this._$_$_$_sysProperties.updateDropZoneActions;},setGraphicCenter:function G(U,S){this._$_$_$_sysProperties.graphicCenter={x:U,y:S};},getGraphicCenter:function B(){return this._$_$_$_sysProperties.graphicCenter;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var I=mstrmojo.array,M=mstrmojo.hash;function J(V){if(V!==null){return(V.constructor!==Array)?[V]:V;}return null;}function F(f,d,Z){if(!d){return null;}var g=[],W=f.selectedIndices,V=f.allIdx,b=f.noneIdx;if(f.multiSelect&&(b>-1)&&(I.indexOf(d,b)>-1)){return g;}var Y,a,e=f.items,c=f.itemIdField,X=f.selectedItems,j;if(f.multiSelect&&(V>-1)&&(I.indexOf(d,f.allIdx)>-1)){for(Y=0,a=e.length;Y<a;Y++){if(!W[Y]){g.push(Y);W[Y]=true;f.selectedIndex=Y;f.selectedItem=e[Y];}}}else{for(Y=0,a=d.length;Y<a;Y++){var h=d[Y];if(!W[h]){W[h]=true;if(Z){g.push({idx:h,positions:Z});}else{g.push(h);}f.selectedIndex=h;j=f.selectedItem=e[h];if(X){X[j[c]]=j;}}}}return g;}function D(Y,V){var X=[],Z=Y.selectedIndices,a=Y.selectedItems,W;for(W in Z){delete Z[W];if(V){X.push({idx:parseInt(W,10),positions:V});}else{X.push(parseInt(W,10));}}Y.selectedIndex=-1;Y.selectedItem=null;if(a){Y.selectedItems={};}return X;}function U(f,e,Z){if(!e){return null;}var b=[],W=f.selectedIndices,h=I.indexOf,V=f.allIdx,c=f.noneIdx,d=f.itemIdField,X=f.selectedItems;if(f.multiSelect&&(((V>-1)&&(h(e,V)>-1))||((c>-1)&&(h(e,c)>-1)))){return D(f);}if(e.length>0&&W[V]){if(h(e,V)<0){e.push(V);}}var a=e.length,Y;for(Y=0;Y<a;Y++){var g=e[Y];if(W[g]){delete W[g];if(Z){b.push({idx:g,positions:Z});}else{b.push(g);}if(X){delete X[f.items[g][d]];}if(f.selectedIndex===g){f.selectedIndex=-1;f.selectedItem=null;}}}return b;}function C(Y,Z,W,V){if(V){return ;}if(this.raiseEvent){if((Y&&Y.length)||(Z&&Z.length)){try{this.raiseEvent({name:"selectionChange",added:Y,removed:Z});}catch(X){U(this,Y);F(this,Z);throw X;}}}}function B(W){var X=this.itemIdField,V=this.items;if(typeof W==="object"&&X){return I.find(V,X,W[X]);}return I.indexOf(V,W);}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,noneIdx:-1,itemIdField:"",items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(V){this._super(V);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function K(e){e=J(e);if(!e){return ;}var b=this.items,V=this.items.length,X=this.selectedItems,Z=[],W;b=this.items=b.concat(e);W=b.length;if(X){var a=this.itemIdField,Y,d;for(Y=V;Y<b.length;Y++){d=b[Y];if(X[d[a]]){Z.push(Y);}}}if(Z&&Z.length){F(this,Z);}if(W>V){var c=this.itemsContainerNode;if(c){c.innerHTML+=this._buildItemsMarkup(V,W-1).join("");}}},addSelectedItems:function S(V){this.selectItems(V,false);},setSelectedItems:function L(V){this.selectItems(V,true);},selectItems:function R(d,f){d=J(d);if(!d){return ;}if(f&&this.selectedItems){this.selectedItems={};}var X=this.selectedItems,b=this.itemIdField,V=[],Z=this.items.length,a=[],W=this.allowUnlistedValues,e,c,Y;for(Y=0;Y<d.length;Y++){e=d[Y];c=B.call(this,e);if(c<0){if(X===null){if(W){V.push(e);c=Z++;a.push(c);}}else{X[e[b]]=e;}}else{a.push(c);}}if(V.length>0){this.addItems(V);}if(a.length>0){if(f){this.select(a);}else{this.addSelect(a);}}},unselectItems:function A(W){W=J(W);if(!W){return ;}var b=this.selectedItems,X=[],a=this.itemIdField,Z,V,Y;if(b===null){return ;}for(Y=0;Y<W.length;Y++){Z=W[Y];if(b){delete b[Z[a]];}V=B.call(this,Z);if(V<0){X.push(V);}}if(X.length>0){this.removeSelect(X);}},getSelectedItems:function G(){if(this.selectedItems){return M.valarray(this.selectedItems);}return I.get(this.items,M.keyarray(this.selectedIndices,true));},singleSelect:function(W,X,V){if(W!==-1){this.select([W],X,V);}},singleSelectByField:function O(W,X,V){this.singleSelect(I.find(this.items,X,W),V);},toggleSelect:function Q(V){var X,W;if(this.selectedIndices[V]){W=U(this,[V]);}else{X=F(this,[V]);}C.call(this,X,W,[V]);},select:function(X,W,V){X=J(X);if(!X){return ;}var Z=D(this,V),b=F(this,X,V),Y;if(this.selectionPolicy!=="reselect"){for(Y=Z.length-1;Y>=0;Y--){var a=I.indexOf(b,Z[Y]);if(a>-1){Z.splice(Y,1);b.splice(a,1);}}}C.call(this,b,Z,X,W);},rangeSelect:function H(W,V){var b=this.selectedIndex,Z=b,a=this.allIdx,X=[],Y;if(W===a||this.selectedIndices[a]){X.push(a);}else{if(Z===-1&&this.selectedIndices){for(Y in this.selectedIndices){Z=parseInt(Y,10);break;}}Z=Z===-1?0:Z;if(Z>W){Z=W;W=b;}for(Y=Z;Y<=W;Y++){X.push(Y);}}this.select(X,V);this.selectedIndex=b;},clearSelect:function(V){C.call(this,null,D(this),[],V);if(!V){this.raiseEvent({name:"clearSelection"});if(this.parent){this.parent.raiseEvent({name:"clearSelection"});}}},addSelect:function(Y,V,W){Y=J(Y);if(!Y){return ;}var X=F(this,Y,W),a=null,Z=this.noneIdx;if(this.multiSelect&&(Z>-1&&I.indexOf(Y,Z)>-1)){a=U(this,Y);}C.call(this,X,a,Y,V);},removeSelect:function(X,V,W){X=J(X);if(!X){return ;}C.call(this,null,U(this,X,W),X,V);},_set_selectedIndices:function P(X,d,V){if(this.selectedItems){this.selectedItems={};}var W=this.selectedIndices;if(W===d){return false;}if(!W){W={};this.selectedIndices=W;}if(!d){d={};}var b=this.selectedIndex,a=[],c;for(c in W){if(!d[c]){c=parseInt(c,10);delete W[c];a.push(c);if(b===c){this.selectedIndex=-1;this.selectedItem=null;}}}var g=[],e=this.items,Z=this.itemIdField,f;for(c in d){if(!W[c]){c=parseInt(c,10);W[c]=true;g.push(c);this.selectedIndex=c;f=this.selectedItem=e[c];if(this.selectedItems){this.selectedItems[f[Z]]=f;}}}if(V!==true){var Y=[];for(c in d){if(W[c]){c=parseInt(c,10);Y.push(c);}}C.call(this,g,a,Y);}return(g.length||a.length);},_set_selectedIndex:function N(Y,W,V){var X={};if(W>-1){X[W]=true;}return this._set_selectedIndices("selectedIndices",X,V);},_set_selectedItem:function E(Y,X,W){var V=B.call(this,X);if((V<0)&&(X!==null&&X!==undefined)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(X));V=this.items.length-1;}return this._set_selectedIndex("selectedIndex",V,W);},_addSelections:function(V){return F(this,V);},_removeAll:function(){return D(this);}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var B={};var E={};mstrmojo.publisher=mstrmojo.provide("mstrmojo.publisher",{publish:function F(H,Q,L){var M=B[H]&&B[H][Q],O;if(!M){return ;}for(O in M){var J=null;if(O){J=mstrmojo.all[O];if(!J){delete M[O];continue;}}var R=M[O].methods;if(R){var P=J||mstrmojo.global,I;for(I in R){if(P[I]){P[I](L);}}}var N=M[O]&&M[O].functions,S=(N&&N.length)||0;if(S){var K;if(J){for(K=S-1;K>-1;K--){if(N[K]){N[K].apply(J,[L]);}}}else{for(K=S-1;K>-1;K--){if(N[K]){N[K](L);}}}}}},subscribe:function D(I,N,R,J){var S=B[I];if(!S){S={};B[I]=S;}var M=S[N];if(!M){M={};S[N]=M;}var K=M[J||""];if(!K){K={};M[J||""]=K;}if(typeof R==="function"){var L=K.functions;if(!L){L=[];K.functions=L;}L.push(R);}else{var H=K.methods;if(!H){H={};K.methods=H;}H[R]=true;}var Q=E,P=Q[J||""];if(!P){P={};Q[J||""]=P;}var O=P[I];if(!O){O={};P[I]=O;}O[N]=true;return{id:I,type:N,callback:R,listener:J,clear:function(){mstrmojo.publisher.unsubscribe(this);}};},unsubscribe:function C(I){var R=B[I.id],O=R&&R[I.type],L=O&&O[I.listener||""];if(!L){return ;}var K=mstrmojo.array,Q=mstrmojo.hash,P=typeof I.callback,M=false;if(P==="function"){var N=L.functions;if(N){K.removeItem(N,I.callback);if(!N.length){delete L.functions;if(Q.isEmpty(L.methods)){M=true;}}}}else{var J=L.methods;if(J){delete J[I.callback];if(Q.isEmpty(J)){delete L.methods;if(!L.functions||!L.functions.length){M=true;}}}}if(M){delete O[I.listener||""];if(Q.isEmpty(O)){delete R[I.type];}}},hasSubs:function G(K,J){var I=B[K],H=I&&I[J];return !!H;},clearSubscriptions:function A(I){if(!I){I="";}var P=B,M=mstrmojo.hash,H;if(P[I]){delete P[I];}var O=E[I];if(O){for(H in O){var N=P[H],L=O[H],K;if(!N){continue;}for(K in L){var J=N[K];if(!J){continue;}delete J[I];if(M.isEmpty(J)){delete N[K];}}}}delete E[I];}});mstrmojo.publisher.NO_SRC="NO_SRC";mstrmojo.publisher.CONNECTIVITY_CHANGED_EVENT="CONNECTIVITY_CHANGED";mstrmojo.publisher.RECONCILE_END_EVENT="RECONCILE_END";}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");mstrmojo.vi.ui.rw.SelectionType={EMPTY:"empty",ATTS:"att",METRICS:"metric",COL_HEADERS:"col-headers",ROW_HEADERS:"row-headers",METRIC_VALUES:"metric-values"};var A=function(AC){var AA=(mstrApp&&mstrApp.docModelData&&mstrApp.docModelData.mid)||"",AB=AC.k||AC.key;return AB+"-"+AA;},G={},p={},S=mstrmojo.hash,Y=mstrmojo.array,M=function(AC){var AA=S.keyarray(AC).sort(),AB=[],AD;Y.forEach(AA,function(AE){AD=[];Y.forEach(AC[AE],function(AF){AD.push(this.model.getNormalizedFormElementId(AF.id));},this);AB.push(AE+"-"+AD.sort().join("@"));},this);return AB.join("#");},L=function(AA){var AB=M.call(this,AA);if(!this._viSelections[AB]){this._viSelections[AB]=AA;if(mstrApp&&mstrApp.isInVFConfigMode){return ;}G[A(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}},z=function(AA){var AB=M.call(this,AA);if(!this._viContextMenuSelections[AB]){this._viContextMenuSelections[AB]=AA;}},n=function(AB){var AC=M.call(this,AB),AA=this._viSelections[AC];if(AA){delete this._viSelections[AC];if(mstrApp&&mstrApp.isInVFConfigMode){return ;}G[A(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}return AA;},d=function(AB){var AC=M.call(this,AB),AA=this._viContextMenuSelections[AC];if(AA){delete this._viContextMenuSelections[AC];}return AA;},j=function(){var AA=A(this);p=p||{};if(G[AA]){p[AA]=S.clone(G[AA]);}},y=function(AD,AC,AH,AE,AA,AG,AB){var AF={};AF[AD]=[{id:AC,n:AH,fm:AB,ui:AE,o:AA,axis:AG}];return AF;},H=mstrmojo.vi.ui.rw.SelectionType;mstrmojo.vi.ui.rw._HasVisSelections=mstrmojo.provide("mstrmojo.vi.ui.rw._HasVisSelections",{_mixinName:"mstrmojo.vi.ui.rw._HasVisSelections",init:function(AA){if(this._super){this._super(AA);}this._viSelections={};},update:function c(AB){var AA=true;if(this._super){AA=this._super(AB);}if(!mstrApp.isInVFConfigMode){S.copy(G[A(this)],this);}if(!this.updateForInteractiveMode){j.call(this);}return AA;},onSelectionChange:function K(AA){if(this._super){this._super(AA);}},_viSelections:{},_viContextMenuSelections:{},_selectionType:H.EMPTY,_contextMenuSelectionType:H.EMPTY,_cellSelections:[],getSelectionType:function(){return this._selectionType;},getContextMenuSelectionType:function(){return this._contextMenuSelectionType;},isSingleAttrSelection:function(){var AB=null,AA;if(this.getSelectionType()===H.ATTS){AA=this.getSelections();if(AA.length>1){return !AA.some(function(AC){if(!AB){AB=AC[0].tid;return false;}return AB!=AC[0].tid;},this);}return true;}return false;},isSingleContextMenuAttrSelection:function(){var AB=null,AA;if(this.getContextMenuSelectionType()===H.ATTS){AA=this.getContextMenuSelections();if(AA.length>1){return !AA.some(function(AC){if(!AB){AB=AC[0].tid;return false;}return AB!=AC[0].tid;},this);}return true;}return false;},isSingleSelection:function(){return(this._viSelections&&S.keyarray(this._viSelections).length===1);},isSingleContextMenuSelection:function(){return(this._viContextMenuSelections&&S.keyarray(this._viContextMenuSelections).length===1);},getSelectionSize:function q(){return(this._viSelections&&S.keyarray(this._viSelections).length)||0;},getCxtMnuSelectionSize:function C(){return(this._viContextMenuSelections&&S.keyarray(this._viContextMenuSelections).length)||0;},getSelectionHash:function R(){return this._viSelections;},getContextMenuSelectionHash:function i(){return this._viContextMenuSelections;},getSelectionCache:function B(){return G[A(this)];},setSelectionCache:function W(AA){G[A(this)]=AA;},getPrevSelectionInfo:function J(){return p[A(this)];},getSelections:function m(){var AA=[],AB;S.forEach(this.getSelectionHash(),function(AC){AB=[];AA.push(AB);S.forEach(AC,function(AD,AE){Y.forEach(AD,function(AF){AB.push({tid:AE,eid:AF.id,v:AF.n,level:AF.level});});});});return AA;},getContextMenuSelections:function b(){var AA=[],AB;S.forEach(this.getContextMenuSelectionHash(),function(AC){AB=[];AA.push(AB);S.forEach(AC,function(AD,AE){Y.forEach(AD,function(AF){AB.push({tid:AE,eid:AF.id,fm:AF.fm,v:AF.n,axis:AF.axis,o:AF.o,ui:AF.ui});});});});return AA;},isMetricValueSelected:function t(AA){return !!this._viSelections[M.call(this,AA)];},isAttSelected:function U(AB,AA){return this.isMetricValueSelected(y(AB,AA));},isCtxMnuMetricValueSelected:function D(AA){return !!this._viContextMenuSelections[M.call(this,AA)];},isCtxMnuAttSelected:function x(AB,AA){return this.isCtxMnuMetricValueSelected(y(AB,AA));},addAttributeSelection:function g(AB,AA,AC){if(this._selectionType!==H.ATTS){this.clearSelections();this._selectionType=H.ATTS;}var AD=y.call(this,AB,AA,AC);L.call(this,AD);return AD[AB];},addContextMenuAttributeSelection:function e(AD,AC,AG,AE,AA,AF,AB){if(this._contextMenuSelectionType!==H.ATTS){this.clearCxtMnuSelection();this._contextMenuSelectionType=H.ATTS;}var AH=y.call(this,AD,AC,AG,AE,AA,AF,AB);z.call(this,AH);return AH[AD];},removeAttributeSelection:function I(AB,AA){return n.call(this,y.call(this,AB,AA));},removeContextMenuAttributeSelection:function V(AB,AA){return d.call(this,y.call(this,AB,AA));},addMetricValueSelection:function l(AA){if(this._selectionType!==H.METRICS){this.clearSelections();this._selectionType=H.METRICS;}L.call(this,AA);},addContextMenuMetricValueSelection:function l(AA){if(this._contextMenuSelectionType!==H.METRICS){this.clearCxtMnuSelection();this._contextMenuSelectionType=H.METRICS;}z.call(this,AA);},addAttrOrMetricCellSelection:function u(AC,AB,AA){this._cellSelections.push({parentElementIds:AC,target:{selectionType:AA?H.ATTS:H.METRICS,id:AB}});},getCellSelections:function h(){var AA=this;AA.clearCellSelections();var AB=function(AD,AC){var AE=[];if(AD){while(AC.hasOwnProperty("_p")){AE.push(AC._p._e.id);AC=AC._p;}}else{var AF=AA.model.getCellDataUnion(AC);Y.forEach(AF,function(AG){AE.push(AG.eid);});}return AE;};Y.forEach(AA.highlights,function(AG){var AC=AA.getCellForNode(AG),AH=!AC.hasOwnProperty("mix")&&AC._e&&!AC.fi,AF=AB(AH,AC);if(AH){var AD=AC._e.id;AA.addAttrOrMetricCellSelection(AF,AD,true);}else{var AE=AC._tp._e.oid;AA.addAttrOrMetricCellSelection(AF,AE,false);}});return this._cellSelections;},removeMetricValueSelection:function N(AA){return n.call(this,AA);},removeContextMenuMetricValueSelection:function O(AA){return d.call(this,AA);},clearSelections:function a(){if(this._super){this._super();}this._viContextMenuSelections={};this._contextMenuSelectionType=H.EMPTY;this._viSelections={};this._selectionType=H.EMPTY;if(typeof this.clearSelectedGraphicInfo==="function"){this.clearSelectedGraphicInfo();}},clearCxtMnuSelection:function s(){if(this._super){this._super();}this._viContextMenuSelections={};this._contextMenuSelectionType=H.EMPTY;},clearCellSelections:function P(){this._cellSelections=[];},clearSelectionsCache:function Q(){G={};},clearUnitSelections:function a(AB){if(this._super){this._super();}var AA={};S.forEach(this._viSelections,function(AD,AC){if(S.keyarray(AD)[0]!==AB){AA[AC]=AD;}});this._viSelections=AA;},clearAllSelectionsAndHighlight:function f(){this.clearSelections(true);this.endSelections();},endSelections:function F(){if(mstrApp&&mstrApp.isInVFConfigMode){return ;}G[A(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};this.raiseGraphicsSelectedEvent(this);if(this.isInFilterPanel()&&mstrApp&&mstrApp.isDossier){this.raiseGraphicsSelectionChangeEvent();return ;}this.onSelectionChange(this.getSelectionHash());},isInFilterPanel:function E(){var AA=this.node&&this.node.defn;return AA.iifp;},addSelectionsFromExpression:function w(AC){this.clearSelections();this._selectionType=AC.type;var AA=this,AB=function(AI){var AJ=20,AG=19,AH=function(AK){return(AK.nds||[]).length===1?AJ:AK.fn;},AF=function(AK){return parseInt(AK.et,10)===5||parseInt(AH(AK),10)===AG;},AD=function(AK){Y.forEach(AK.es,function(AL){AA.addAttributeSelection(AK.a.did,AL.v,AL.n);});},AE=function(AM){var AL={},AK=function(AN){Y.forEach(AN.es,function(AO){S.copy(y.call(AA,AN.a.did,AO.v,AO.n),AL);});};if(AM.nds){Y.forEach(AM.nds,AK);}else{if(AM.es){AK(AM);}}AA.addMetricValueSelection(AL);};if(AF(AI)){AI={nds:[AI]};}Y.forEach(AI.nds,function(AK){if(AF(AK)){if(AC.type===H.ATTS){AD(AK);}else{AE(AK);}}else{AB(AK);}});};AB(AC.data);},raiseGraphicsSelectedEvent:function o(){if(window.mstrApp&&window.mstrApp.isEmbedded){var AG=this,AF=AG.model,AE=AF&&AF.data,AC=AE&&AE.k,AA=AE&&AE.gts,AK=AA&&AA.row,AD=AA&&AA.col,AH=Y.ensureArray(AK).concat(AD||[]),AB=function(AM){var AL;Y.forEach(AH,function(AN){if(AN&&AN.id===AM){AL=AN.n;return false;}});return AL;},AI=[],AJ=this.getSelectionHash();S.forEach(AJ,function(AM){var AL=[];S.forEach(AM,function(AP,AO){var AN=AB(AO);Y.forEach(AP,function(AQ){AL.push({n:AN,nid:AO,v:AQ.n,vid:AQ.id});});});AI.push(AL);});mstrApp.raiseEvent({name:"graphicsSelected",value:{graphics:AI,vizKey:AC}});}},raiseGraphicsSelectionChangeEvent:function Z(){if(mstrApp&&(typeof mstrApp.raiseEvent==="function")){mstrApp.raiseEvent({name:"graphicsSelectionChange",value:{selections:G[A(this)],vizKey:this.k}});}},copyToContextMenuSelection:function k(){this._contextMenuSelectionType=this._selectionType;S.copy(this._viSelections,this._viContextMenuSelections);}});mstrmojo.vi.ui.rw._HasVisSelections.VisSelectionType=null;mstrmojo.vi.ui.rw._HasVisSelections.clearAllSelectionsCache=function X(){G={};p={};};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var O=/\{\@(en@)?([^\}]+)\}/gm,K=/\</gm,U=/\>/gm,F=/\S/,S=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],G=new RegExp("(\\"+S.join("|\\")+")","g"),V={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;","\u0009":"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},Y={"&amp;":"&","&lt;":"<","&gt;":">","&#x09;":"\u0009","&#x0A;":"\n","&#x0D;":"\r","&quot;":'"'},D={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#39;",'"':"&#34;"},N={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#39;":"'","&#34;":'"'},E={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&#34;","\u20ac":"&#8364;"},L={"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&#34;":'"',"&#8364;":"\u20ac"};var M=function(Z){if(Z===null){return"null";}var a=typeof Z;if(a!=="object"){return a;}if(Z.length===undefined){return"object";}return"array";};var W={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function H(a,d,c){var Z;c=c||[];if(!a){return"";}var b=[];for(Z in d){if(mstrmojo.array.indexOf(c,Z)===-1){b.push(Z.k||Z);}}return a.replace(new RegExp(b.join("|"),"g"),function(e){var f=d[e];return f.v||f;});},trim:function R(Z){return(Z&&Z.replace)?Z.replace(/^\s+/,"").replace(/\s+$/,""):Z;},startsWith:function X(a,Z){return a.length>=Z.length&&a.substring(0,Z.length)==Z;},ellipsize:function A(b,a){var Z=this.trim(b.substr(0,(a||1)-1));if(Z!==b){Z+="&hellip;";}return Z;},isEmpty:function J(Z){return(Z===null)||(Z===undefined)||!(F.test(Z));},regEscape:function Q(Z){return Z.replace(G,"\\$1");},escapeIllegalXML:function C(Z){if(!Z||!Z.replace){return Z;}var a=/\u001a/gm,b="";return Z.replace(a,b);},encodeXMLAttribute:function(Z){return mstrmojo.string.multiReplace(Z,V);},decodeXMLAttribute:function(Z){return mstrmojo.string.multiReplace(Z,Y);},encodeHtmlString:function(a,Z,b){if(!a||!a.replace){return a;}if(b){return mstrmojo.string.multiReplace(a,E);}return mstrmojo.string.multiReplace(a,D,Z?[" "]:[]);},decodeHtmlString:function(a,Z){return Z?mstrmojo.string.multiReplace(a,L):mstrmojo.string.multiReplace(a,N);},htmlAngles:function(Z){if(!mstrmojo.string.isEmpty(Z)){Z=String(Z);return Z.replace(K,"&lt;").replace(U,"&gt;");}return Z;},apply:function I(Z,b){if(!Z){return"";}var a=this;return Z.replace(O,function c(f,g,h){var d;try{d=mstrmojo.hash.walk(h,b);}catch(e){}d=(d===null||d===undefined)?"":d;return(!!g)?a.encodeHtmlString(d,true):d;});},json2xml:function(Z,p,q){if(!(p instanceof Array)){p=[p];}var a=q&&q.isSerializable,o=(q.convertBoolean!==false),u=q&&q.skipFunctions,m,f;var h=[],d=[],g,c,e;for(m=0,f=p.length;m<f;m++){var l=p[m];for(g in l){if(u&&typeof l[g]==="function"){continue;}if(a){var s=a(g,p,m);if(s!==true){if(s===false){continue;}else{if(s.att){h.push(s.att);}if(s.child){d.push(s.child);}continue;}}}c=l[g];e=M(c);switch(e){case"array":var j,k;d.push("<"+g+">");for(j=0,k=c.length;j<k;j++){var b=q.getArrItemName(g,c,j)||j;d.push(this.json2xml(b,c[j],q));}d.push("</"+g+">");break;case"object":d.push(this.json2xml(g,c,q));break;case"string":h.push(g+'="'+mstrmojo.string.encodeXMLAttribute(c)+'"');break;case"boolean":h.push(g+'="'+(o?(c?"-1":"0"):c)+'"');break;case"null":if(!q.skipNull){h.push(g+'="'+q.nullValue+'"');}break;default:h.push(g+'="'+c+'"');break;}}}return"<"+Z+" "+h.join(" ")+">"+d.join("")+"</"+Z+">";},escape4HTMLText:function B(g){if(!g||!g.replace){return g;}var d=/"/gm;var b="&quot;";var h=/&/gm;var f="&amp;";var e=/</gm;var Z="&lt;";var c=/>/gm;var a="&gt;";return g.replace(h,f).replace(d,b).replace(e,Z).replace(c,a);},parseUri:function(d,a){a=a||W;var Z=a.parser[((a.strictMode)?"strict":"loose")].exec(d),c={},b=14;while(b--){c[a.key[b]]=Z[b]||"";}c[a.q.name]={};c[a.key[12]].replace(a.q.parser,function(f,e,g){if(e){c[a.q.name][e]=g;}});return c;},removeSpecialChars:function(Z){return Z.replace(/[^a-zA-Z0-9]/g,"");},hashCode:function P(Z){return Z.split("").reduce(function(d,c){d=((d<<5)-d)+c.charCodeAt(0);return d&d;},0);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,B=mstrmojo.hash;mstrmojo.models.datasets.DataInterface=mstrmojo.provide("mstrmojo.models.datasets.DataInterface",{getFormsByAttrId:function A(F,E){var D=[];E=E||[];B.forEach(E,function(G){C.forEach(G.att||[],function(H){if(H.did===F){D=D.concat(H.fs||[]);return false;}});});D=C.filter(D,function(G){return !!G.obf;});return C.distinct(D,"fid");}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array;function B(){var H=this.buildConfig=this.buildConfig||{};H.pk=this.k;H.fgk=this.defn&&this.defn.fgk;return H;}mstrmojo._HasBuilder={builder:null,postBuildRendering:function D(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function F(){return this.model.getChildren(this.node,false);},buildChildren:function E(H){if(!this.builder||!this.model){return false;}var J=this.children;if(J&&J.length){this.set("children",[]);}var I=this.builder.build(this.getChildren(),this.model,B.call(this));if(!H){this.addChildren(I);}this.builtChildren=true;return H?I:true;},rebuildChildren:function C(J){var P=this.children.slice(0),L=this.model,K=[],I,H=this,M=mstrApp.restoreVFKey,N,O;J=J||P.slice(0);J.forEach(function(S){var Q=G.indexOf(P,S),R=S.k;if(Q===-1){throw new Error("Invalid child requested rebuild in mstrmojo._HasBuilder::rebuildChild.");}this.removeChildren(S);S.destroy();K.push(R);},this);if(mstrApp.isInVFConfigMode&&(mstrApp.showBandingInVFConfigMode||mstrApp.showOutlineInVFConfigMode)&&!!J&&J.length===1&&!!J[0]&&J[0].k===M){delete mstrApp.showBandingInVFConfigMode;delete mstrApp.showOutlineInVFConfigMode;N=L.insertVizBox(M,H,{});L.selectVIUnit(N.id,true,{});I=[N];}else{O=L.getChildrenByKey(this.node,false,K);I=this.builder.build(O,L,B.call(this));this.addChildren(I);}return I;},rebuildChild:function A(H){return this.rebuildChildren([H])[0];}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E="*",A=".",C="-",J="_",H="<";var M=new RegExp("[\\"+E+"\\"+A+"\\"+C+"\\"+J+"\\"+H+"]","g"),G=E+"$&";mstrmojo.Serializer={scriptClass:"mstrmojo.Serializer",serializeValueGroup:function F(B){mstrmojo.array.forEach(B,function(D,K){B[K]=mstrmojo.Serializer.serializeValues(D);});return C+this.serializeValues(B)+J;},serializeValues:function I(D){var B=[];mstrmojo.array.forEach(D,function(K){if(typeof K==="Boolean"){K=K?"1":"0";}B.push(String(K).replace(M,G));});return B.join(A);}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=function(X){var W=(mstrApp.docModelData&&mstrApp.docModelData.mid)||"";return X.k+"-"+W;},O={},K=mstrmojo.array;mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights",{_mixinName:"mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights",postBuildRendering:function J(){this._super();this.setup();this.initialHighlight();},initialHighlight:function B(){if(!this.getExp()){if(O[G(this)]){this.highlight.apply(this,O[G(this)]);}else{if(this.isVisMap){this.highlight("allLayers",this.genSelectionMapping(),true);}else{this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}}},getExp:function(){var W=this.model.data,X=W&&W.sc&&W.sc.exp;return X;},clearsBrushingOnHighlight:true,brushSub:null,clearSub:null,getAssociatedNodes:function V(){var W=this.defn&&this.defn.an;return W&&W.length>0?W:[];},hasAssociatedNodes:function M(){var W=this.getAssociatedNodes();return W.length>0;},getDocModelForEvent:function H(){return this.model&&this.model.docModel;},setup:function Q(){var W=this.getDocModelForEvent(),X=this.id;if(W){[this.brushSub,this.clearSub].forEach(function(Y){if(Y){Y.clear();}});this.brushSub=W.attachEventListener("brushing",X,this.onBrushing);this.clearSub=W.attachEventListener("clearBrush",X,this.onClearBrushing);}},handlesMultiSelection:function F(){return(this._super&&this._super())||this.getAssociatedNodes().length>0;},getHighlightKeys:function P(){var X=[],W=this.getAssociatedNodes();W.forEach(function(Y){X.push(Y.k);});return X;},onSelectionChange:function L(W){var X=false;if(this._super){X=this._super(W);}return this.clearHighlightForSelectionChange(X);},onContextMenuSelectionChange:function I(W){var X=false;if(this._super){X=this._super(W);}return this.clearHighlightForSelectionChange(X);},clearHighlightForSelectionChange:function U(X){var W=this.getDocModelForEvent();if(this.clearsBrushingOnHighlight){W.raiseEvent({name:"clearBrush",from:this});}if(this.handlesMultiSelection()&&!X){W.raiseEvent({name:"brushing",from:this,keys:this.getHighlightKeys()});return true;}return false;},onBrushing:function A(X){var W=X.keys.slice();if(W.indexOf(this.k)!==-1){if(this.highlight){var Y=X.from;this.highlight(Y.getSelectionType(),Y.getSelectionHash(),this.isVIXtab&&Y.isVIXtab&&Y.getSelectionType()==="att"&&this.model.hasRecursiveAttribute()&&Y.model.hasRecursiveAttribute());W.push(Y.k);this.getDocModelForEvent().raiseEvent({name:"clearBrush",from:this,excludeKeys:W});}else{throw new Error(this.scriptClass+" must implement highlight method.");}}},onClearBrushing:function S(X){var W=false;if(K.indexOf(X.excludeKeys,this.k)===-1){if(this._super){W=this._super(X);}if(!W){var Y=this.getAssociatedNodes();if(K.find(Y,"k",X.from.k)!==-1){this.clearSelections(true);}}}return true;},highlight:function E(){O[G(this)]=arguments;if(this._super){this._super.apply(this,arguments);}},clearSelections:function C(){delete O[G(this)];if(this._super){this._super.apply(this,arguments);}},clearCxtMnuSelection:function D(){if(this._super){this._super.apply(this);}},clearHighlightsCache:function R(){delete O[G(this)];},updateAssociatedNodesOnMove:function N(){this.clearSelections(true);this.endSelections();if(this.isLinkedFilter&&this.isLinkedFilter()){return ;}delete this.defn.an;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var A=mstrmojo.array;mstrmojo.fe._IsRelationTreeNode=mstrmojo.provide("mstrmojo.fe._IsRelationTreeNode",{createSetHtml:'<span class="mstrmojo-textset mstrmojo-create-set-text" mstrAttach:click >'+mstrmojo.desc(12034,"Create a Set")+"</span>",syncRootOperator:function(){var F=this.parent,H=function(){var J=this.parent,I=[];if(J){I=J.ctxtBuilder.itemWidgets;}return I;},E,D,B,C,G;if(F){E=H.call(this);B=E.length;D=A.find(E,"noRelationOperator",true)!==-1;for(C=0;C<B;C++){G=E[C];G&&G.set("noRelationOperator",D);}this.set("noRelationOperator",D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var A=mstrmojo,D=A.array;mstrmojo.vi.util.TemplateUtils=mstrmojo.provide("mstrmojo.vi.util.TemplateUtils",{getTemplateUnits:function B(F){var E=[].concat(F.mx);(F.rows||[]).concat(F.cols||[]).forEach(function(G){if(G.did!=="-1"){E.push({did:G.did,t:G.t,n:G.n});}});return E;},findUnitsById:function C(H,F){var E=mstrmojo.vi.util.TemplateUtils.getTemplateUnits(H),G=[];D.ensureArray(F).forEach(function(K){var J=D.find(E,"did",K),I=J>-1?E[J]:null;if(I){G.push(I);}});return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var C=mstrmojo.hash,E=mstrmojo.array;function D(F){return function(G){F[G]=true;};}mstrmojo.rw.model.UpdateKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.UpdateKeysConfig",init:function B(){this.nodes=[];this.selectors={};this.objects={};}});mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig=function A(J){var F={},K={},G={},I={};E.forEach(J,function H(M){var L=M.partialUpdate;if(L){E.forEach(L.nodes,D(K));E.forEach(L.selectors,D(G));E.forEach(L.objects,function(N){if(!I[N.id]||N.flag>I[N.id].flag){I[N.id]=N;}});delete M.partialUpdate;}E.forEach(M.actions,H);});if(!C.isEmpty(K)){F.nodes=C.keyarray(K);}if(!C.isEmpty(G)){F.selectors=C.keyarray(G);}if(!C.isEmpty(I)){F.objects=C.valarray(I);}return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var I="#000000",E=Math.round;function O(Z){return("0"+parseInt(Z,10).toString(16)).slice(-2);}mstrmojo.color=mstrmojo.provide("mstrmojo.color",{rgbStr2rgb:function X(Z){if(Z==="transparent"){return["0","0","0"];}else{return Z.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i).slice(1);}},rgbStr2hex:function G(Z){if(Z.indexOf("rgb")>=0){var a=this.rgbStr2rgb(Z);return"#"+this.rgb2hex(a[0],a[1],a[2]);}return Z;},rgb2hex:function B(c,a,Z){return O(c)+O(a)+O(Z);},rgb2hsv:function W(Z,i,k){var e=Math.min(Z,i,k),l=Math.max(Z,i,k),f=0,o,n;n=l/255;o=(l!==0)?(parseFloat(l)-parseFloat(e))/parseFloat(l):0;if(o===0){f=0;}else{var j=l-e,a=(l-Z)/j,c=(l-i)/j,m=(l-k)/j;if(Z===l){f=m-c;}else{if(i===l){f=2+a-m;}else{f=4+c-a;}}f=f/6;if(f<0){f=f+1;}}return[E(f*360),E(o*100),E(n*100)];},rgb2hsl:function D(Z,e,f){Z/=255;e/=255;f/=255;var i=Math.max(Z,e,f),c=Math.min(Z,e,f),a=(i+c)/2,d,k;if(i===c){d=k=0;}else{var j=i-c;k=a>0.5?j/(2-i-c):j/(i+c);switch(i){case Z:d=(e-f)/j+(e<f?6:0);break;case e:d=(f-Z)/j+2;break;case f:d=(Z-e)/j+4;break;}d/=6;}return[d,k,a];},hsl2rgb:function C(f,k,e){var d=function d(h,g,b){if(b<0){b+=1;}if(b>1){b-=1;}if(b<1/6){return h+(g-h)*6*b;}if(b<1/2){return g;}if(b<2/3){return h+(g-h)*(2/3-b)*6;}return h;},Z,i,j;if(k===0){Z=i=j=e;}else{var a=e<0.5?e*(1+k):e+k-e*k,c=2*e-a;Z=d(c,a,f+1/3);i=d(c,a,f);j=d(c,a,f-1/3);}return[E(Z*255),E(i*255),E(j*255)];},hsl2hex:function J(b,a,Z){return"#"+mstrmojo.array.map(this.hsl2rgb(b,a,Z),function(c){return O(c);}).join("");},hex2rgb:function Q(c){var Z=this.fixFullHexValue("#"+c.replace("#","")),a=[],b;Z=Z.replace("#","");for(b=0;b<3;b++){a.push(parseInt(Z.substr(b*2,2),16));}return a;},hex2bgr:function L(Z){return this.hex2rgb(Z).reverse();},hex2hsv:function U(a){var Z=this.hex2rgb(a);return this.rgb2hsv(Z[0],Z[1],Z[2]);},hex2hsl:function Y(Z){return this.rgb2hsl.apply(this,this.hex2rgb(Z));},hsv2rgb:function H(k,w,o){k=k/360;w=w/100;o=o/100;var Z,l,n;if(w===0){Z=o*255;l=o*255;n=o*255;}else{var d=k*6;if(d===6){d=0;}var j=Math.floor(d);var c=o*(1-w);var a=o*(1-w*(d-j));var u=o*(1-w*(1-(d-j)));var m,e,f;switch(j){case 0:m=o;e=u;f=c;break;case 1:m=a;e=o;f=c;break;case 2:m=c;e=o;f=u;break;case 3:m=c;e=a;f=o;break;case 4:m=u;e=c;f=o;break;default:m=o;e=c;f=a;break;}Z=m*255;l=e*255;n=f*255;}return[E(Z),E(l),E(n)];},hsv2hex:function M(c,b,Z){var a=this.hsv2rgb(c,b,Z);return this.rgb2hex(a[0],a[1],a[2]);},getContrastingColor:function N(c,a,Z){var b=this.hex2rgb(c);return(((b[0]*299)+(b[1]*587)+(b[2]*114))/1000<125)?a:Z;},getLuminance:function F(a){var Z=this.hex2rgb(a);return 0.2126*Z[0]+0.7152*Z[1]+0.0722*Z[2];},getHighlightColor:function S(i,f){var Z,h,j,k,l=this.hex2rgb(!f?"#FFCE7F":"#EFE6D8"),e=parseInt(i[0],10),c=parseInt(i[1],10),n=parseInt(i[2],10),d=parseInt(l[0],10),a=parseInt(l[1],10),m=parseInt(l[2],10);Z=(e*d)/255;h=(c*a)/255;j=(n*m)/255;k=e*0.3+c*0.59+n*0.11;if(k<85){Z=Z+(63*(85-k)/85);Z=Z>255?255:Z;h=h+(63*(85-k)/85);h=h>255?255:h;j=j+(63*(85-k)/85);j=j>255?255:j;}return"#"+this.rgb2hex(E(Z),E(h),E(j));},get3DBorderColor:function R(c,f){var a=parseInt(c[0],10)*0.3+parseInt(c[1],10)*0.59+parseInt(c[2],10)*0.11;var e=parseInt(c[0],10);var d=parseInt(c[1],10);var Z=parseInt(c[2],10);switch(f){case"light":if(a>150){e=e*0.9;d=d*0.9;Z=Z*0.9;}else{e=e*0.6+102;d=d*0.6+102;Z=Z*0.6+102;}break;case"dark":if(a>10){e=e*0.4;d=d*0.4;Z=Z*0.4;}else{e=e*0.8+30;d=d*0.8+30;Z=Z*0.8+30;}break;}return"#"+this.rgb2hex(E(e),E(d),E(Z));},encodeColor:function K(Z,a){if(a!==undefined&&(Z===null||Z.length===0||Z==="undefined")){Z=a;}if(Z==="transparent"){return -1;}if(parseInt(Z,10)===-2){return -2;}if(Z.substring(0,1)==="#"){Z=Z.substring(1);}return parseInt(Z.substring(4)+Z.substring(2,4)+Z.substring(0,2),16);},decodeColor:function A(Z){Z=parseInt(Z,10);if(Z===0){return I;}var a=16777216+(Z&255)*65536+(Z&65280)+(Z&16711680)/65536;return"#"+a.toString(16).substring(1).toUpperCase();},fixFullHexValue:function V(Z){if(Z&&Z.length===4){return Z.replace(/([0-9a-f])/ig,"$1$1");}return Z;},findMidColorHex:function P(c,b){var d=this.hex2rgb(c),Z=this.hex2rgb(b),a=[];d.forEach(function(e,f){a.push(parseInt((e+Z[f])/2,10));});return("#"+this.rgb2hex(a[0],a[1],a[2]));}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var H=mstrmojo.array,D={},G={},A="72px",F="abcdefghijklmnopqrstuvwxyz0123456789";function C(I){return I.name+":"+(I.isItalic?"i":"n")+(I.isBold?"7":"4");}mstrmojo.util.FontLoader=mstrmojo.provide("mstrmojo.util.FontLoader",{load:function E(N,O){var L=this,J=[],K;H.forEach(N,function(P){if(!L.isFontInstalled(P)){K=C(P);if(!D[K]&&!G[K]){J.push(K);}}});if(!window.WebFont||J.length===0){return true;}window.WebFont.load({custom:{families:J},fontactive:function(Q,P){D[Q+":"+P]=true;},fontinactive:function(Q,P){G[Q+":"+P]=true;},active:function M(){O.success();},inactive:function I(){O.failure();}});return false;},isFontInstalled:function B(J){var K=document.createElement("canvas"),L=K.getContext("2d"),P=J.isItalic?"italic":"normal",I=J.isBold?"bold":"normal",N=P+" "+I+" "+A,O,M;L.font=N+" monospace";O=L.measureText(F).width;L.font=N+" '"+J.name+"', monospace";M=L.measureText(F).width;K=null;return O!==M;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var H=mstrmojo.array,B=mstrmojo.hash,J=B.isEmpty;var G=1;function D(Q){return(typeof Q==="object")?Q:{};}function E(R,Q){B.forEach(Q,function(S,W){var U=R[W];if(U===undefined){delete Q[W];return true;}S=Q[W]=D(S);U=R[W]=D(U);if(J(S)&&J(U)){throw (G);}else{if(J(U)){delete R[W];if(J(R[W])){E(R,Q);}}else{if(J(S)){delete R[W];if(J(R[W])){E(R,Q);}}else{try{E(R[W],Q[W]);}catch(V){switch(V){case G:R[W]=Q[W]={};break;}}}}}});}function I(Q){B.forEach(Q,function(R){B.forEach(R,function(V,S){var U=V.include,X=V.exclude;if(J(U)||J(X)){return true;}if(!J(U)&&!J(X)){try{E(X,U);}catch(W){switch(W){case G:R[S]={};break;}}}});});return Q;}function F(S,R,Q){B.forEach(S,function(V,U){if(V===true||J(V)){Q.push(R+U);}else{F(V,R+U+".",Q);}});return Q;}function P(Q){B.forEach(Q,function(R){B.forEach(R,function(V,S){var U=[];F(V.include,"",U);F(V.exclude,"!",U);R[S]=U.join(";");});});return Q;}function K(Q,R){B.forEach(Q,function(S,V){var U=R[V];if(U!==undefined){if(S!==true&&U!==true){K(S,U);}else{if(S===true&&U!==true){R[V]=true;}else{if(S!==true&&U===true){Q[V]=true;}}}}});}function L(R,S){var Q=true;B.forEach(R,function(Z,U){var X=S[U];if(X){var V=Z.include,a=Z.exclude,Y=X.include,W=X.exclude;if(!J(W)&&!J(a)){Q=false;return Q;}if(!J(Y)&&!J(V)){K(Y,V);}}return Q;});return Q;}function C(S,Q){Q=Q||{};if(S){var R=Q;H.forEach(S.split("."),function(X,V,U,W){R[X]=W?true:{};R=R[X];});}return Q;}mstrmojo.rw.model.RetrievalKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.RetrievalKeysConfig",init:function M(){this.nodes=[];this.filters={};},addNode:function A(R,U){var S=this.filters,Q=S[R];if(!Q){this.nodes.push(R);Q=S[R]={data:{},defn:{}};}if(U){if(L(Q,U)){S[R]=B.mergeHashes(Q,U);}else{throw ("The new filters for node key ## cannot be merged with the filters currently defined".replace("##",R));}}return this;}});mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig=function O(U){var Q={},V={},S={};H.forEach(U,function R(X){var W=X.partialRetrieval;if(W){H.forEach(W.nodes,function(Y){V[Y]=true;});S=B.mergeHashes(S,W.filters);delete X.partialRetrieval;}H.forEach(X.actions,R);});if(!J(V)){Q.nodes=B.keyarray(V);}if(!J(S)){Q.filters=P(I(S));}return Q;};mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters=function N(R){var Q=function(U){var S={};B.forEach(U,function(X,W){var V=S[W]={serialized:X,include:{},exclude:{}};H.forEach(X.split(";"),function(Z){var Y=Z.indexOf("!")===0;Z=Y?Z.slice(1):Z;C(Z,Y?V.exclude:V.include);});});return S;};return{data:Q(R.data),defn:Q(R.defn)};};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.util.IntervalTree");var E=5,A=2;mstrmojo.vi.util.snapGuide=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.util.snapGuide",xIntervalHash:{},yIntervalHash:{},xIntervalTree:null,yIntervalTree:null,init:function J(){this.xIntervalTree=new mstrmojo.vi.util.IntervalTree();this.yIntervalTree=new mstrmojo.vi.util.IntervalTree();},reconstructTree:function I(M){this.xIntervalHash={};this.yIntervalHash={};var P=M.getSplitterHost().getBoundingClientRect(),N=this.getSplittersLocation(M,this,true).concat([{start:(P.left-E).toFixed(A),end:(P.left+E).toFixed(A)},{start:(P.right-E).toFixed(A),end:(P.right+E).toFixed(A)},{start:(P.left+(P.width/2)-E).toFixed(A),end:(P.left+(P.width/2)+E).toFixed(A)}]),O=this.getSplittersLocation(M,this,false).concat([{start:(P.top-E).toFixed(A),end:(P.top+E).toFixed(A)},{start:(P.bottom-E).toFixed(A),end:(P.bottom+E).toFixed(A)},{start:(P.top+(P.height/2)-E).toFixed(A),end:(P.top+(P.height/2)+E).toFixed(A)}]);this.fillup(N,this.xIntervalHash);this.fillup(O,this.yIntervalHash);this.xIntervalTree.reconstructTree(N);this.yIntervalTree.reconstructTree(O);},findIntersect:function G(N,P){var O=P+"IntervalTree",Q=this[O].searchForPoint(N),M=Q.length?this[O].calculateCloset(N,Q):null;return M;},findCloset:function F(N,M){return N.interval&&M.interval?Math.abs(N.interval.mid-N.point)<Math.abs(M.interval.mid-M.point)?1:-1:N.interval?1:M.interval?-1:0;},boxIntervalOperations:function K(O,Q,N){var P=this.getSplittersLocation(O,this,true),M=this.getSplittersLocation(O,this,false);this.checkAndOp(P.length?P:(N&&N.x),Q,"x");this.checkAndOp(M.length?M:(N&&N.y),Q,"y");this.validateHash();},checkAndOp:function B(N,O,M){(N||[]).forEach(function(P){var R=this[M+"IntervalHash"],Q=this.middle(P);if(O==="insert"){R[Q]=(R[Q]||0)+1;if(R[Q]===1){this[M+"IntervalTree"].insertNode(P);}}if(O==="delete"){R[Q]--;if(R[Q]===0){delete R[Q];this[M+"IntervalTree"].deleteNode(P);}}},this);},validateHash:function C(){["x","y"].forEach(function(N){var M=this[N+"IntervalHash"];Object.keys(M).forEach(function(O){if(!M[O]){console.warn("NaN value appeared in hash");}},this);},this);},middle:function L(M){return(parseFloat(M.start)+parseFloat(M.end-M.start)/2).toFixed(2);},fillup:function H(M,N){(M||[]).forEach(function(O){var P=this.middle(O);N[P]=(N[P]||0)+1;},this);},getSplittersLocation:function D(O,N,M){return[].filter.call(O.getSplitterHost&&(O.getSplitterHost()||[]).children||[],function(P){return P.style.display==="block"&&P.className.indexOf("edge")!==-1&&M===(P.className.indexOf("v")!==-1);}).reduce(function(V,W){var U=W.getBoundingClientRect(),S=M?{start:(U.left+U.width/2-5).toFixed(2),end:(U.left+U.width/2+5).toFixed(2)}:{start:(U.top+U.height/2-5).toFixed(2),end:(U.top+U.height/2+5).toFixed(2)};V.push(S);if(V.length>0&&V.length%2===0){var X=(parseFloat(V[V.length-2].start)+parseFloat(V[V.length-2].end))/2,R=(parseFloat(V[V.length-1].start)+parseFloat(V[V.length-1].end))/2,Q=(X+R)/2,P={start:(Q-5).toFixed(2),end:(Q+5).toFixed(2)};V.push(P);}return V;},[]).concat((O.children||[]).filter(function(P){return P.unDocked;}).reduce(function(P,Q){P=P.concat(N.getSplittersLocation(Q,N,M));return P;},[]));}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var E=mstrmojo.dom,M=mstrmojo.hash,B,I=mstrmojo.global.document,K="mousedown",O="mousemove",Q="mouseup";function G(Y){if(E.isPrimaryMouseBtn(Y)){B.startDragCheck(self,Y);}}var V,P,A="mstrmojo-dnd-avatar",U;function F(Z,Y){if(Y!==undefined&&Y!==null){P.innerHTML=Y;}U.left=Z.x+"px";U.top=Z.y+"px";}function L(Z,Y){if(!V){V=I.createElement("div");U=V.style;V.className=A;V.innerHTML='<div class="'+A+'-inner"></div>';P=V.firstChild;I.body.appendChild(V);}F(Z,Y);U.display="block";}function R(){if(U){U.display="none";}}function H(Y){var Z=++B.ctxt.moveCount;if(Z>=B.minMoves){B.stopDragCheck();if((Y.buttons===1||Y.buttons===undefined||E.isIE9)&&(Y.which===1||Y.button===0||E.isIE8)){B.startDrag(self,Y);}}}function N(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDragCheck();delete B.ctxt;}}function D(Y){B.onDragMove(self,Y);}function C(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDrag(window,Y);}}function J(Z){var Y=E.findWidget(Z);while(Y){if(Y.draggable){return Y;}Y=Y.parent;}return null;}function S(Y){var a=Y.src,Z=J(a.node);if(!Z){return null;}if(Z.getDragAction){Y.action=Z.getDragAction(Y);}a.widget=Z;a.data=Z.getDragData&&Z.getDragData(Y);if(Z.isDragValid){if(!Z.isDragValid(Y)){if(!mstrApp.isInVFInteractMode&&(!Z.shouldDragBubble||Z.shouldDragBubble(Y)===true)){Y.src.node=Z.domNode.parentNode;return S(Y);}return null;}}if(Z.ondragstart){Z.ondragstart(Y);}return Z;}function X(a,Z){var Y=E.findWidget(a),b=Z.tgt&&Z.tgt.widget;while(Y){if(Y.dropZone){if(Y===b){return Y;}if(Y.allowDrop&&Y.allowDrop(Z)){return Y;}}Y=Y.parent;}return null;}function W(){if(this.set){this.set("allowingDrop",false);}}mstrmojo.dnd=mstrmojo.dnd||mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){E.attachEvent(I,K,G);mstrmojo.dndEnabled=true;}},disable:function(){mstrmojo.dndEnabled=false;E.detachEvent(I,K,G);},startDragCheck:function(Y,Z){delete this.ctxt;var a=E.captureEventInfo({hWin:Y,e:Z});this.ctxt={src:a,moveCount:0,last:M.copy(a.pos),getDirection:function(b){return !!this.dir[b];},getCtxtDragData:function(){var b=this.src;return(b&&b.data)||{};},getCtxtDropData:function(){var b=this.tgt;return(b&&b.data)||{};}};if(this.minMoves){E.attachEvent(I,O,H);E.attachEvent(I,Q,N);}else{this.startDrag(Y,Z);}},stopDragCheck:function(){E.detachEvent(I,O,H);E.detachEvent(I,Q,N);},startDrag:function(Y,b){var Z=this.ctxt;Z.id=mstrmojo.now();var a=S(Z);if(!a){return ;}E.clearBrowserHighlights(Y);E.preventDefault(self,b);E.attachEvent(I,O,D);E.attachEvent(I,Q,C);var d=window.mstrApp;if(d&&d.setInteractive){this._changeAppStatus=d.setInteractive(false);}if(!a.ownAvatar){var c=Z.src;L(c.pos,c.data&&c.data.html);}},stopDrag:function(Y,f){E.detachEvent(I,O,D);E.detachEvent(I,Q,C);var b=this.ctxt,a=b.tgt||{},Z=E.captureEventInfo({hWin:Y,e:f,data:a.data}),d=X(Z.node,b);Z.widget=d;b.tgt=Z;if(d){if(d.ondrop){d.ondrop(b);}else{W.call(d);}}var c=b.src.widget;if(c&&c.ondragend){c.ondragend(b);}if(c&&!c.ownAvatar){R();}if(this._changeAppStatus){window.mstrApp.setInteractive(true);delete this._changeAppStatus;}},onDragMove:function(c,f){if(E.isSafari){E.clearBrowserHighlights();}var Y=this.ctxt,b=Y.tgt||{},Z=b.widget,d=E.captureEventInfo({hWin:c,e:f,data:b.data}),i=d.widget=X(d.node,Y),h=Y.last,a=d.pos;Y.dir={x:a.x>h.x,y:a.y>h.y};Y.last=M.copy(d.pos);Y.tgt=d;if(Z!==i){if(Z){if(Z.ondragleave){Z.ondragleave(Y);}else{W.call(Z);}}if(i){Y.tgt.data=(i.getDropData&&i.getDropData(Y))||{};if(i.ondragenter){i.ondragenter(Y);}else{if(i.set){i.set("allowingDrop",true);}}}}if(i){if(i.ondragover){i.ondragover(Y);}}var g=Y.src.widget;if(g&&g.ondragmove){g.ondragmove(Y);}if(g&&!g.ownAvatar){F(d.pos);}}});B=mstrmojo.dnd;B.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var D=mstrmojo.dom;var G=mstrmojo.array;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function F(I){if(I){return{w:I.innerWidth,h:I.innerHeight};}var H=D.windowDim(),J=(D.isFF||D.isWK)?0:2;return{w:Math.max(H.w,0)+"px",h:Math.max(H.h-J,0)+"px"};},preBuildRendering:function B(){var J=this._super(),I=this.getBrowserDimensions();if(!this.browserResized||this.browserResized(I)!==true){this.height=I.h;this.width=I.w;}if(!this._listenerProc){var L=this.id,K=null,H=this._listenerProc=function(N){if(mstrApp&&mstrApp.isExporting){var M=N||window.event;mstrmojo.all[L].monitorWindow(M);}else{window.clearTimeout(K);K=window.setTimeout(function(){var O=N||window.event;mstrmojo.all[L].monitorWindow(O);},150);}};D.attachEvent(window,"resize",H);}return J;},destroy:function C(H){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);}this._super(H);},getResizeDimensions:function A(H){var K=H.currentTarget,J=this.getBrowserDimensions(),I={w:(K?K.innerWidth+"px":J.w),h:(K?K.innerHeight+"px":J.h)};return I;},monitorWindow:function E(I){var J=this.getResizeDimensions(I);var H=["iframe","video"],N=[],M=false,L=this,K=document.fullscreenElement;if(K){G.forEach(H,function(O){N=N.concat([].slice.call(L.domNode.getElementsByTagName(O)));});G.forEach(N,function(O){if(O===K){M=true;return false;}});}if((J.h===this.height&&J.w===this.width)||parseInt(J.h,10)<=20||parseInt(J.w,10)<=20||M){return ;}if(!this.browserResized||this.browserResized(J,true)!==true){if(J.h!==this.height){this.set("height",J.h);}if(J.w!==this.width){this.set("width",J.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var D=mstrmojo.dom,L=mstrmojo.hash;var O=100;var F=D.supportsTouches?0.5:1;var G=1;var R=100;var P={onvscrollVisibleChange:function(){var V=this.vscrollNode,W=V&&V.style;if(!W){return ;}if(this.vscrollVisible){var U=this.maxPos,X=this.clientSize;W.height=Math.round(X.y*X.y/U.y)+"px";W.left=(X.x-5)+"px";W.display="block";W.opacity=0.5;}else{W.opacity=0;}},onhscrollVisibleChange:function(){var W=this.hscrollNode,V=W&&W.style;if(!V){return ;}if(this.hscrollVisible){var U=this.maxPos,X=this.clientSize;V.width=Math.round(X.x*X.x/U.x)+"px";V.top=(X.y-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}}};var M=L.copy({onposChange:function(){var W=this.clientSize,V=this.maxPos,U=0,X=0;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[D.CSS3_TRANSFORM]="translateY("+Math.round((W.y-(W.y*W.y/V.y))*this.pos.y/V.y)+"px)";}}if(this.scrollsHoriz){U=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[D.CSS3_TRANSFORM]="translateX("+Math.round((W.x-(W.y*W.x/V.x))*this.pos.x/V.x)+"px)";}}this.scrollChild.style[D.CSS3_TRANSFORM]="translate3d(-"+parseInt(U,10)+"px, -"+parseInt(X,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[D.CSS3_TRANSITION]=this.decelerating?(D.CSS3_PREFIX+"transform 0.2s linear"):"";}},L.copy(P));var H=L.copy({onposChange:function(){var W=this.clientSize,V=this.maxPos,U=0,Y=0,X=this.scrollboxNode;if(this.scrollsVert){Y=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((W.y-(W.y*W.y/V.y))*this.pos.y/V.y)+"px";}X.scrollTop=parseInt(Y,10);}if(this.scrollsHoriz){U=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((W.x-(W.y*W.x/V.x))*this.pos.x/V.x)+"px";}X.scrollLeft=parseInt(U,10);}}},L.copy(P));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function N(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var X=this.scrollboxNode,W=this.itemsContainerNode||X.firstChild;if(X&&X!==W){this.scrollChild=W;var U=X.style;U.position="relative";U.overflow="hidden";var V=W.style;V.position="absolute";V.left=0;V.top=0;this.markupMethods=L.copy(D.isSafari?M:H,L.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(U){if(this.usesTouches){this.detachTouchEvents();}this._super(U);},attachTouchEvents:function(){var V=this.touchNode||this.scrollboxNode;if(V){if(!this._tsCallback){var U=this;this._tsCallback=function(W){U.touchesBegin(self,W);};this._tmCallback=function(W){U.touchesMoved(self,W);};this._teCallback=function(W){U.touchesEnd(self,W);};}D.attachEvent(V,D.TOUCHSTART,this._tsCallback);this._tsNode=V;}},detachTouchEvents:function(){var U=this._tsNode;if(U){D.detachEvent(U,D.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function J(U,W){var V=W.target&&W.target.tagName;if(V&&(V==="SELECT"||V==="INPUT")){return ;}D.preventDefault(U,W);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=D.getMousePosition(D.firstTouch(U,W),U);this.dragging=false;D.attachEvent(window,D.TOUCHMOVE,this._tmCallback);D.attachEvent(window,D.TOUCHEND,this._teCallback);},touchesMoved:function E(c,f){var a=D.getMousePosition(D.firstTouch(c,f),c);D.preventDefault(c,f);if(!this.dragging){var U=5,i=Math.abs;if((this.scrollsHoriz&&i(a.x-this.pos.x)>U)||(this.scrollsVert&&i(a.y-this.pos.y)>U)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=a;var W=this.scrollboxNode,Z={x:W.clientWidth,y:W.clientHeight},g={x:W.scrollWidth,y:W.scrollHeight};this.clientSize=Z;this.scrollSize=g;this.maxPos={x:Math.max(g.x-Z.x,0),y:Math.max(g.y-Z.y,0)};this.showScroll();}}if(this.dragging){D.stopPropogation(c,f);var d=this.startTimePos,Y=this.startTouchPos,b=this.maxPos;var X={x:this.scrollsHoriz?Math.max(Math.min(d.x-(a.x-Y.x),b.x),0):0,y:this.scrollsVert?Math.max(Math.min(d.y-(a.y-Y.y),b.y),0):0};this.set("pos",X);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=a;var V=new Date(),h=this.lastDragTime;this.nextLastDragTime=h;this.lastDragTime=V;if((V-h)>R){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:X.x,y:X.y};this.startTouchPos=a;}}},touchesEnd:function I(U,V){D.preventDefault(U,V);D.detachEvent(window,D.TOUCHMOVE,this._tmCallback);D.detachEvent(window,D.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;D.stopPropogation(U,V);if((new Date())-this.lastDragTime<=R){this.startDeceleration(U,V);}else{this.hideScroll();}}},startDeceleration:function B(Z,a){var X=D.getMousePosition(D.firstChangedTouch(Z,a),Z),d=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||X,c={x:X.x-d.x,y:X.y-d.y},U=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),f=U?(new Date())-U:0,W={x:f?Number(c.x*O*F/f).toFixed(2):0,y:f?Number(c.y*O*F/f).toFixed(2):0};var b=this,V=function(e){return(b.scrollsHoriz&&Math.abs(e.x)>=G)||(b.scrollsVert&&Math.abs(e.y)>=G);};if(V(W)){this.velocity=W;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var Y=function(){b.decelerate();if(!V(b.velocity)){b.stopDeceleration();b=null;}};Y();if(this.decelerating){this.decelerationTimer=window.setInterval(Y,O);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var X=this.pos,W=this.velocity,V=this.friction,a=this.maxPos,Y={x:X.x-W.x,y:X.y-W.y},c=this.bounces,U=this.BOUNCEFRICTION;var b=Y.x;if(b<0||b>a.x){Y.x=(b<0)?0:a.x;W.x*=c?-U:0;V.x=U;}var Z=Y.y;if(Z<0||Z>a.y){Y.y=(Z<0)?0:a.y;W.y*=c?-U:0;V.y=U;}this.set("pos",Y);this.velocity={x:V.x*W.x,y:V.y*W.y};},hideScroll:function K(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function Q(){var U=this.maxPos;if(this.scrollsVert&&U.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&U.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;function D(J,I){var G=[];if(J){var F;for(F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function E(L,F,N){if(C.isPrimaryMouseBtn(N.e)){var I=N.hWin,J=N.e,G=C.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=C.ctrlKey(I,J),O=C.shiftKey(I,J);if(K||O){C.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}}},premouseup:function B(H,K,G){var F=G.hWin,J=G.e,L=C.ctrlKey(F,J),I=C.shiftKey(F,J);if(L||I){C.clearBrowserHighlights(F);}},onadd:function A(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=D(K,G),J;for(J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function A(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],U=[],P=false;if(M){var H;for(H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){U.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);var J,N;for(J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(U);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.array;function A(){var G=this.itemsContainerNode,D=(G&&G.childNodes)||[],I=this.multiSelect===true,H;for(H=0;H<D.length;H++){var L=D[H];if(I){L.setAttribute("role","checkbox");var F=L.classList.contains("selected");L.setAttribute("aria-checked",F);var K=this.parent&&this.parent.btnNode&&this.parent.btnNode.children||[];C.forEach(K,function(M){M.setAttribute("aria-role","button");});}else{L.setAttribute("role","menuitem");}L.setAttribute("tabindex","-1");if(L.classList.contains("pop")){L.setAttribute("aria-haspopup",true);}if(H===0){L.focus();}}var E=this.scriptClass==="mstrmojo.vi.ui.InteractiveUnitList"?this.getListContainer():this.domNode;if(E){E.setAttribute("role","menu");var J="mstrmojo.dom.captureDomEvent('"+E.mstrmojoId+"','keydown', self, event)";E.setAttribute("onkeydown",J);}}mstrmojo._IsAccessibleMenu=mstrmojo.provide("mstrmojo._IsAccessibleMenu",{_mixinName:"mstrmojo._IsAccessibleMenu",hasAccessibility:true,enableAccessibility:function B(){if(this._super){this._super();}var E="popup-mid-render";var D=(this.children&&this.children[0])||this;var F=D.accessibilityMenuContainer();mstrmojo.css.removeClass(this.domNode,E);A.call(F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");function G(J){return(J&&J.id);}mstrmojo._HasScrollbox=mstrmojo.provide("mstrmojo._HasScrollbox",{_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,scrollInterval:50,scrollboxNode:undefined,scrollTo:function F(L,K){var J=this.scrollboxNode;J.scrollLeft=L.x;J.scrollTop=L.y;if(K){this.notifyScrollListeners(L);}},connectScrollbox:function E(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(!L){L={};this.scrollListeners=L;}if(!L[J]){L[J]=K;this.scrollListenerCount++;if(this.scrollListenerCount===1){this._attachScrollDom();}}},disconnectScrollbox:function D(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(L&&L.hasOwnProperty(J)){delete this.scrollListeners[J];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function C(M){var P=M||this.getScrollPos(),O=P.y,N=P.x,J=O-this.scrollboxTop,L=N-this.scrollboxLeft;this.scrollboxTop=O;this.scrollboxLeft=N;this.scrollboxRight=N+this.scrollboxWidth;this.scrollboxBottom=O+this.scrollboxHeight;var K=this.scrollListeners,Q;for(Q in K){K[Q].onscroll(this,{deltaX:L,deltaY:J});}},getScrollPos:function H(){var J=this.scrollboxNode;return{x:J.scrollLeft,y:J.scrollTop};},_attachScrollDom:function A(){var M=this.scrollboxNode;if(M){var L=this.usesTouches;if(!L){if(!this.scrollCallback){var K=this.id;this.scrollCallback=function(){mstrmojo.all[K].notifyScrollListeners();};}mstrmojo.dom.attachBufferedEvent(M,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=L?0:M.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=L?0:M.scrollLeft;}var J=function(P){var O=P.toLowerCase();var N=M.style[O];return(!isNaN(N)&&N.charAt(N.length-1)!=="%")?parseInt(N,10):M["client"+P];};if(this.scrollboxHeight===null){this.scrollboxHeight=J("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=J("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=M;}},_detachScrollDom:function I(){var J=this._attachedScrollbox;if(J&&this.scrollCallback){mstrmojo.dom.detachBufferedEvent(J,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function B(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var E=mstrmojo.dom;mstrmojo.ui._IsIncFetchList=mstrmojo.provide("mstrmojo.ui._IsIncFetchList",{_mixinName:"mstrmojo.ui._IsIncFetchList",ifDataHelper:null,supportsIncFetch:false,isFetching:false,initScroll:function A(){var I=this.ifDataHelper,H=this,G=this.scrollNode||this.domNode;this.supportsIncFetch=I&&I.hasNext();if(I&&this.supportsIncFetch){this._scroll=function F(){var J=this.scrollNode||this.domNode||G;if(Math.ceil(J.offsetHeight+J.scrollTop)>=J.scrollHeight){H.raiseEvent({name:"incFetch",id:H.id});}};E.attachEvent(G,"scroll",this._scroll);this.attachEventListener("incFetch",this.id,function(J){if(!this.supportsIncFetch||this.isFetching){return ;}if(this.preNext){this.preNext();}this.set("isFetching",true);I.next({complete:function(K){if(H.postNext){H.postNext();}H.set("isFetching",false);},success:function(K){H.addItems(K.items||null);},failure:function(K){H.supportsIncFetch=false;mstrmojo.alert("Error in fetching next: "+K);}});});}},unrender:function D(F){var G=this.scrollNode||this.domNode;E.detachEvent(G,"scroll",this._scroll);this._super(F);},render:function C(){this._super();if(this.supportsIncFetch){var F=this.scrollNode||this.domNode;E.attachEvent(F,"scroll",this._scroll);}},addItems:function B(F){if(this._super){this._super(F);}if(!this.ifDataHelper.hasNext()){this.supportsIncFetch=false;var G=this.scrollNode||this.domNode;E.detachEvent(G,"scroll",this._scroll);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var F=mstrmojo.dom;var W="touchstart",J="mousedown",P=F.isIOSTouch,S=P?W:J;function X(Z){var Y=Z[Z.hotSlot||"domNode"];if(Y){if(!Z._closeCallback){var b=Z.id,a=function(c){return function(f){var d=mstrmojo.all[b];if(d&&!d.ignoreHover){d["auto"+c](f,self);}};};Z._uncloseCallback=a("Unclose");Z._closeCallback=a("Close");}F.attachEvent(Y,"mouseover",Z._uncloseCallback);F.attachEvent(Y,"mouseout",Z._closeCallback);}}function C(Z){if(Z._closeCallback){var Y=Z[Z.hotSlot||"domNode"];if(Y){F.detachEvent(Y,"mouseover",Z._uncloseCallback);F.detachEvent(Y,"mouseout",Z._closeCallback);}}}function G(b,Z){var Y=b,a;while(Y){if(Y.open||Y.openPopup){a=Y.ignoreHoverCount||0;a=Z?(a+1):(a>0?a-1:a);Y.ignoreHoverCount=a;if(Y.set){Y.set("ignoreHover",(a>0));}else{Y.ignoreHover=(a>0);}}Y=Y.opener||Y.parent;if(Y&&Y.shouldPropagateLockHover&&!Y.shouldPropagateLockHover()){break;}}}function E(){var a=this._lockHoverCallback,Z=this.curtainNode,c=this._onClickChange;if(a){F.detachEvent(document.body,S,a,true);delete this._lockHoverCallback;}if(!Z||!c){return ;}var Y=mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp()||P,b=Y?W:J;F.detachEvent(Z,b,c);delete this._onClickChange;}mstrmojo._CanAutoClose=mstrmojo.provide("mstrmojo._CanAutoClose",{autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function U(){this._super();if(this.autoCloses){X(this);}this.oncloseOnClickChange();},onautoClosesChange:function N(){var Y=(this.autoCloses)?X:C;Y(this);},oncloseOnClickChange:function I(){if(!this.curtainNode){return ;}var a=this,Y=mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp()||P,Z=Y?W:J;this._onClickChange=function(){a.close();if(Y){mstrmojo.touchManager.notify([]);}};F.attachEvent(a.curtainNode,Z,this._onClickChange);},autoUnclose:function H(){var Y=this._autoCloseTimer;if(Y){self.clearTimeout(Y);delete this._autoCloseTimer;}},autoClose:function L(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var Y=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[Y].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function V(Y){E.call(this);this._super(Y);},lockHover:function R(){G(this,true);if(!this._lockHoverCallback){var Z=this.id,Y=this._lockHoverCallback=function(a){mstrmojo.all[Z]._unlockHoverCheck(a,self);};if((F.isIE7||F.isIE8)&&window.event&&(window.event.type===S)&&this.opener){this.opener._ignoreMousedown=true;}F.attachEvent(document.body,S,Y,true);}},unlockHover:function O(){G(this,false);E.call(this);},hoverLock:function(Y){G(this,Y);},suppressClose:function B(Y){return F.contains(this.domNode,Y,true,document.body);},_unlockHoverCheck:function D(b,Y){var Z=this.opener;if(Z&&Z._ignoreMousedown){delete Z._ignoreMousedown;return ;}var a=F.eventTarget(Y,b);if(!this.suppressClose(a)){if(this.isWithinParentWidget(a)){return ;}if(Z&&Z.onPopupAutoClosed){Z.onPopupAutoClosed(b,Y);}this.close(a);}},isWithinParentWidget:function Q(Z){var Y=F.findWidget(Z);while(Y){if(Y===this){return true;}Y=Y.parent||Y.opener;}return false;},open:function K(Z,Y){if(this.autoCloses){this.autoUnclose();}this._super(Z,Y);if(this.locksHover){this.lockHover();}},close:function M(Y){if(this.locksHover){this.unlockHover();}this._super(Y);},shouldPropagateLockHover:function A(){return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(X){mstrmojo.hash.copy(X,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var X=this;this.delayTimer=window.setTimeout(function(){X._start();X=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function V(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var X=this.ease;if(typeof X==="string"){this.ease=mstrmojo.registry.ref(X);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var Y=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Z(){if(Y){Y.exec();Y.counter++;if(Y.counter>=Y.steps){Y._end();Y=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function U(){if(this.getTarget){this.target=this.getTarget();}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var Y=this.target;if(Y&&this.slot&&Y.scriptClass){var Z=Y[this.slot];if(Z){this.widget=Y;this.target=Z;}}}}}if(!this.target){var X=this;while(X=X.parent){if(!X||X.domNode){break;}}if(X){this.widget=X;this.target=X[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(a,b){var Y=a.children,X=(Y&&Y.length)||0,Z;for(Z=0;Z<X;Z++){Y[Z][b]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(a){this._super(a);var Z=this.children;mstrmojo.registry.refArray(Z);var X=(Z&&Z.length)||0,Y;for(Y=0;Y<X;Y++){Z[Y].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function V(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Z=this.props,a;for(a in Z){var Y=Z[a],X=Y.ease;if(typeof X==="string"){Y.ease=mstrmojo.registry.ref(X,{dontInst:true});}}this._super();},exec:function P(){var a=this.props,b;for(b in a){var Y=a[b],X=(Y.ease||mstrmojo.ease.sin)(this.counter,Y.start,Y.stop-Y.start,this.steps-1);if(Y.fn){X=Y.fn(X);}if(Y.suffix){X+=Y.suffix;}var Z=Y.isStyle===false?this.target:this.target.style;Z[b]=X;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var b=this.srcProp,Z;if(b){var X=this.widget||this.parent;Z=X&&X[b];if((Z!=null)&&(typeof (Z)!=="string")){Z=String(Z);}}this.stop=Z;this._dynStop=true;}if(this.stop==null){this.stop="";}var a=this.target,c=null,Y=1;if(a){a.innerHTML="";c=document.createTextNode("");a.appendChild(c);Y=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=c;this.charGroupSize=Y;},exec:function(){var Y=this.targetTextNode;if(!Y){return ;}var X;if(this.counter>=this.steps-1){X=this.stop;}else{if(this.counter===0){X="";}else{X=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}Y.nodeValue=X;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function V(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(X){if(X==null){X=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(X*100,10)+")";}else{this.target.style.opacity=X;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function V(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function W(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Z,Y,a){var X=Math.pow(10,a||2);if(Y){return parseInt(X*Z/Y,10)/X;}return parseInt(X*Z,10)/X;}mstrmojo.ease={linear:function L(Y,X,a,Z){if(Y===Z){return X+a;}if(Y===0){return X;}return X+a*I(Y,Z);},sin:function A(Y,X,a,Z){return X+a*Math.sin((Math.PI/2)*Y/Z);},cos:function B(Y,X,a,Z){return X+a*Math.cos((Math.PI/2)*(1-Y/Z));},sincos:function K(Y,X,a,Z){if(Y>Z/2){return X+a*Math.cos((Math.PI/2)*(1-Y/Z));}return X+a*Math.sin((Math.PI/2)*Y/Z);},cossin:function Q(Y,X,a,Z){if(Y>Z/2){return X+a*Math.sin((Math.PI/2)*Y/Z);}return X+a*Math.cos((Math.PI/2)*(1-Y/Z));},bounce:function G(Y,X,a,Z){if((Y/=Z)<(1/2.75)){return a*(7.5625*Y*Y)+X;}if(Y<(2/2.75)){return a*(7.5625*(Y-=(1.5/2.75))*Y+0.75)+X;}if(Y<(2.5/2.75)){return a*(7.5625*(Y-=(2.25/2.75))*Y+0.9375)+X;}return a*(7.5625*(Y-=(2.625/2.75))*Y+0.984375)+X;},shake:function J(Y,X,a,Z){if(Y<Z/2){return X+a*I(Math.sin(2*Math.PI*Y/8),null,2)*2*Y/Z;}return X+a*I(Math.sin(2*Math.PI*Y/8),null,2)*2*(1-Y/Z);}};}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var E=mstrmojo.func.wrapMethods;function B(L,I,K,H,J){return E({success:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("success",I.target,JSON.stringify(I.memo),JSON.stringify(M));}},complete:function(){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("complete",I.target,JSON.stringify(I.memo));}J.removeCallback(K,H);},failure:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("failure",I.target,JSON.stringify(I.memo),JSON.stringify(M));}}},L);}mstrmojo._CanProxyCallback=mstrmojo.provide("mstrmojo._CanProxyCallback",{_mixinName:"mstrmojo._CanProxyCallback",callbacks:null,isCallbackReceiver:false,newCallback:function D(O){return O;var K=this.callbacks,I=mstrmojo.hash.copy(O),P=(O.index!==undefined)?String(O.index):"index",N=arguments.callee.caller.arguments,L,J,M,H=O.method||"anonymous";if(!K){K=this.callbacks={};}if(!K[H]){K[H]={};}if(!this.isCallbackReceiver){for(J=0,M=N.length;J<M;J++){L=N[J];if(L&&L.target){I=B(I,L,H,P,this);break;}}}if(!O.method){I.proxy=this.getCallbackMemo();}K[H][P]=I;return I;},anonymous:function(J,K,I,H){if(!this.isCallbackReceiver){K=B(K,H,"anonymous","index",this);mstrApp.serverRequest(J,K,I);}},getCallback:function C(K,J){var H=J||"index",I=this.callbacks;return I&&I[K]&&I[K][H];},removeCallback:function G(K,J){var H=J||"index",I=this.callbacks;if(I&&I[K]){delete I[K][H];if(mstrmojo.hash.isEmpty(I[K])){delete I[K];}}},getCallbackMemo:function F(I,H){return{target:'mstrmojo.all["'+this.id+'"].receiveCallback',memo:{method:I||"anonymous",index:H||"index"}};},receiveCallback:function A(L,J,K){var M=J.method,I=J.index,H=this.getCallback(M,I);if(H&&L&&H[L]){H[L](K);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var B=mstrmojo.hash;mstrmojo.Base=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Base",init:function A(C){B.copy(C,this);if(this.postApplyProperties){this.postApplyProperties();}}});}());mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){document.msCSSOMElementFloatMetrics=true;mstrmojo.requiresCls("mstrmojo.hash");var S=mstrmojo.hash,H="containerNode",G="auto",Q="px";var I={v:G,c:undefined,sv:G};function E(d,g,f){var h=this._layoutWidgets[g],k=d.slot||H,i=h.f,j=h.p,e=(i&&i[k]!==undefined),c=(j&&j[k]!==undefined);if(k&&((!f&&e)||c)){return e?i[k]:(h.x*parseInt(j[k],10)/100)+Q;}return d[(g==="h")?"height":"width"];}function K(i,e,c){if(i.ignoreLayout){return ;}var d=(e===G)||e==="NaNpx",g=(c===G)||c==="NaNpx";var f=i.getLayoutOffsets&&i.getLayoutOffsets();if(f){if(!d){e=(parseInt(e,10)-f.h)+Q;}if(!g){c=(parseInt(c,10)-f.w)+Q;}}if(i.setDimensions){i.setDimensions(e,c);}else{if(i.set){if(!d){i.set("height",e);}if(!g){i.set("width",c);}}}}function a(f){var d=this.children,j,l;for(j=0,l=(d&&d.length)||0;j<l;j++){var e=d[j],m=e.slot||H;if(m){var k=E.call(this,e,"h",f),n=E.call(this,e,"w",f);this.setSlotDimensions(m,k,n);K(e,k,n);var c=E.call(this,e,"h",f),g=E.call(this,e,"w",f);if(c!==k||g!==n){K(e,c,g);}this.setSlotDimensions(m,c,g);}}this.afterLayout();}function B(){var d=this.children,c=this._layoutWidgets;S.forEach(this.slotNames,function(i,j){if(!i||this.skipsSlotLayout(j)){return ;}var g=(c.h&&c.h.getSlotSizeInfo(j,d))||I,e=(c.w&&c.w.getSlotSizeInfo(j,d))||I,f=g.c||e.c;mstrmojo.array.forEach(f,function(h){K(h,g.v,e.v);});this.setSlotDimensions(j,g.sv,e.sv);},this);this.afterLayout();}function D(d){var c=this.layoutConfig.xt?B:a;c.call(this,d);}function U(j,f,h){var i=j.slot||H,g=f&&f.a;if(!g||g[i]===undefined){return ;}var c=this[i]["offset"+h],e=g[i];if(c===e){return ;}f.x-=(c-e);g[i]=c;}function J(c){this.beforeLayout();var d=this._layoutWidgets,e=c.src;U.call(this,e,d.h,"Height");U.call(this,e,d.w,"Width");D.call(this,true);}function O(e,j){if(!e){return null;}var c=this.children,t=j.toLowerCase(),k=parseInt(this[t],10),m=k,o={},q={},h={},d={},p={},l,n,f,u,s;for(s in e){if(!e.hasOwnProperty(s)){continue;}u=e[s];if(u.match(/px$/)){k-=parseInt(u,10);o[s]=u;}else{if(u.match(/%$/)){q[s]=u;}else{if(u.match(/all/)){p[s]=m;}else{h[s]=u;}}}}if(!S.isEmpty(h)&&!S.isEmpty(q)){for(l=0,n=(c&&c.length)||0;l<n;l++){f=c[l];s=f.slot||H;if(s&&h[s]&&!f.ignoreLayout){if(f.hasRendered){var g=this[s];d[s]=g.getBoundingClientRect?Math.round(g.getBoundingClientRect()[j.toLowerCase()]):g["offset"+j];k-=d[s];}else{d[s]=0;f.attachEventListener((f instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,J);}}}}return{f:S.isEmpty(o)?undefined:o,p:S.isEmpty(q)?undefined:q,a:S.isEmpty(d)?undefined:d,n:S.isEmpty(p)?undefined:p,x:k,getSlotSizeInfo:function(AC,x){if(!e[AC]){return I;}var w=mstrmojo.array.filter(x,function(AE){var AD=AE.slot;return AD===AC||(AC===H&&!AD);}),AA,AB;var i=o[AC];if(i){AB=i;}var z=q[AC];if(z){AB=(this.x*parseInt(z,10)/100)+Q;}if(h[AC]){AB=d[AC];if(AB){AB+=Q;}else{AB=G;}AA=G;}var y=p[AC];if(y){AB=AA=y+Q;}AB=AB||"0px";return{v:AB,c:w,sv:AA||AB};}};}function R(d){var c=this.domNode;if(!c||!this.layoutConfig){return ;}c.style[d]=this[d];this.doLayout();}mstrmojo._HasLayout=mstrmojo.provide("mstrmojo._HasLayout",{_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",ignoreLayout:false,beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,forceLayout:false,layoutConfig:null,init:function W(c){this._super(c);this.layoutConfig=S.clone(this.layoutConfig);},preBuildRendering:function C(){var e=this.cssText||"";var c=this.height;if(c&&c!==G){e+="height:"+this.height+";";}var d=this.width;if(d&&d!==G){e+="width:"+this.width+";";}this.cssText=e;return(this._super)?this._super():true;},postBuildRendering:function X(){this.doLayout();return this._super();},modifyLayoutConfig:function Z(e,d){var c=this.layoutConfig=this.layoutConfig||{};c.h=S.copy(e,c.h);c.w=S.copy(d,c.w);this.doLayout();},getLayoutOffsets:mstrmojo.emptyFn,set:function P(e,c){var d=this._super(e,c);if(e==="visible"&&this._pendingLayoutOnVisible){delete this._pendingLayoutOnVisible;this.doLayout();}return d;},doLayout:function A(){var c=this.layoutConfig;if(!c||(this.height===G&&this.width===G)){return ;}if(c.xt){if(!this.visible){this._pendingLayoutOnVisible=true;return ;}}this.beforeLayout();this._layoutWidgets={h:O.call(this,c.h,"Height"),w:O.call(this,c.w,"Width")};D.call(this,false);this.widgetResized();},browserResized:function F(c){this.setDimensions(c.h,c.w);return true;},onwidthChange:function N(){R.call(this,"width");},onheightChange:function M(){R.call(this,"height");},skipsSlotLayout:function(c){return false;},adjustParentDimensions:function L(){var d=this.parent,c=d&&d._layoutWidgets;if(c){U.call(d,this,c.h,"Height");U.call(d,this,c.w,"Width");}},setDimensions:function V(f,d){var e=(f===G)||f==="NaNpx",g=(d===G)||d==="NaNpx";if((!e&&parseInt(this.height,10)!==parseInt(f,10))||(!g&&parseInt(this.width,10)!==parseInt(d,10))||this.forceLayout){if(!e){this.height=f;}if(!g){this.width=d;}var c=this.domNode,i=c&&c.style;if(i){if(!e){i.height=f;}if(!g){i.width=d;}this.doLayout();}return true;}return false;},setSlotDimensions:function Y(f,e,d){var c=this[f]&&this[f].style;if(!c){return ;}if(e!==G&&e!==undefined&&e!=="NaNpx"&&c.height!==e&&parseInt(e)>=0){c.height=e;}if(d!==G&&d!==undefined&&d!=="NaNpx"&&c.width!==d&&parseInt(d)>=0){c.width=d;}}});mstrmojo._HasLayout.getSlotSize=function b(f,g){var d=f&&f.prototype.layoutConfig;if(d){var e=d.h,c=d.w;return{h:(e&&e[g])||undefined,w:(c&&c[g])||undefined};}return null;};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.all={};var E=mstrmojo.all,G=mstrmojo.hash;var A=0;function D(){var I;while(!I){var H="mstr"+(A++);if(!E[H]){I=H;}}return I;}mstrmojo.registry=mstrmojo.provide("mstrmojo.registry",{add:function F(H){if(!H){return ;}var I=H.id;if(!I){H.id=I=D();}else{if(E[I]){throw new Error("Tried to register 2 objects with same id: "+I);}}E[I]=H;},remove:function C(H){if(H&&H.id){delete E[H.id];}},dumpAll:function(){var H;for(H in E){var I=E[H].id;if(I){mstrmojo.dbg(I+"("+(E[H].scriptClass||"[unknown class]")+")");}}},ref:function B(I,H){H=H||{};if(I){var L=I;while(L){switch(typeof L){case"string":if(H.skipLoadChecks!==true){mstrmojo.requiresCls(L);}L=G.walk(L,window);break;case"function":return(H.dontInst!==true)?new L():L;case"object":if(L.constructor===Object){var K=L.scriptClass;if(K){if(H.skipLoadChecks!==true){mstrmojo.requiresCls(K);}var J=G.walk(K,window);if(J){return new J((H.clone===true)?G.clone(L):L);}return null;}return L;}return L;default:return null;}}}return null;}});mstrmojo.insert=mstrmojo.registry.ref;}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.requiresDescs(521,522,523,524,525,526,529,530,534,535,546,547,587,686,687,688,696,746,949,950,952,953,954,955,956,1035,1101,1102,1375,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,2171,2202,2203,2204,2219,2220,2295,2784,2785,2786,2795,2796,2816,2903,3086,3344,3852,3853,3854,3855,3856,3857,3858,3859,3860,3861,3862,3863,3945,3946,4406,4407,4737,4738,4739,4740,4998,5282,5283,5924,5925,6047,6076,6077,6078,6079,6080,6081,6082,6114,7899,7900,7901,7902,7903,9379,9380,9381,9382,9383,9384,9385,12298,13889,13890,13896,13897);mstrmojo.locales=mstrmojo.provide("mstrmojo.locales",{load:function(C){var A=this;if(this.isLoaded){C();C=null;}else{var B={taskId:"getLocaleInfo"};if(mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){B.sessionState=mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(D){A.update(D);C();C=null;if(mstrmojo.expr){mstrmojo.expr.onLocaleUpdated();}mstrmojo.locales.isLoaded=true;},failure:function(D){alert(D.getResponseHeader("X-MSTR-TaskFailureMsg"));}},B);}},update:function(A){if(A){mstrmojo.hash.copy(mstrmojo.hash.obj2array(A),this);}},isLoaded:false,datetime:{MONTHNAME_SHORT:[mstrmojo.desc(3852,"Jan"),mstrmojo.desc(3853,"Feb"),mstrmojo.desc(3854,"Mar"),mstrmojo.desc(3855,"Apr"),mstrmojo.desc(3856,"May"),mstrmojo.desc(3857,"Jun"),mstrmojo.desc(3858,"Jul"),mstrmojo.desc(3859,"Aug"),mstrmojo.desc(3860,"Sep"),mstrmojo.desc(3861,"Oct"),mstrmojo.desc(3862,"Nov"),mstrmojo.desc(3863,"Dec")],MONTHNAME_FULL:[mstrmojo.desc(1956,"January"),mstrmojo.desc(1957,"February"),mstrmojo.desc(1958,"March"),mstrmojo.desc(1959,"April"),mstrmojo.desc(1960,"May"),mstrmojo.desc(1961,"June"),mstrmojo.desc(1962,"July"),mstrmojo.desc(1963,"August"),mstrmojo.desc(1964,"September"),mstrmojo.desc(1965,"October"),mstrmojo.desc(1966,"November"),mstrmojo.desc(1967,"December")],dayShortNames:[mstrmojo.desc(1968,"S"),mstrmojo.desc(1969,"M"),mstrmojo.desc(1970,"T"),mstrmojo.desc(1971,"W"),mstrmojo.desc(1972,"T"),mstrmojo.desc(1973,"F"),mstrmojo.desc(1974,"S")],dayNames:[mstrmojo.desc(9379,"Sunday"),mstrmojo.desc(9380,"Monday"),mstrmojo.desc(9381,"Tuesday"),mstrmojo.desc(9382,"Wednesday"),mstrmojo.desc(9383,"Thursday"),mstrmojo.desc(9384,"Friday"),mstrmojo.desc(9385,"Saturday")],DATEINPUTFORMATS:["M/d/yy","M/d/yyyy","MMM d, yy"],TIMEINPUTFORMATS:["h:mm a","H:mm","h:mm:ss a","H:mm:ss","h:mm:ss a z"],DATEOUTPUTFORMAT:"M/d/yyyy",TIMEOUTPUTFORMAT:"h:mm:ss a",DATEDISPLAYFORMAT:"M/d/yy",TIMEDISPLAYFORMAT:"h:mm:ss",AM_NAME:"AM",PM_NAME:"PM",TWODIGITYEARSTART:"2029"},location:{LOCALE_TO_LANG:{"2052":mstrmojo.desc(2816,"Chinese (Simplified)"),"1028":mstrmojo.desc(2903,"Chinese (Traditional)"),"1030":mstrmojo.desc(4998,"Danish"),"1043":mstrmojo.desc(4737,"Dutch (Netherlands)"),"1031":mstrmojo.desc(949,"German"),"1033":mstrmojo.desc(950,"English (US)"),"2057":mstrmojo.desc(2295,"English (UK)"),"1036":mstrmojo.desc(952,"French"),"4108":mstrmojo.desc(4738,"French (Switzerland)"),"2060":mstrmojo.desc(6114,"French (Belgium)"),"2055":mstrmojo.desc(4739,"German (Switzerland)"),"1040":mstrmojo.desc(953,"Italian"),"2064":mstrmojo.desc(4740,"Italian (Switzerland)"),"1041":mstrmojo.desc(954,"Japanese"),"1042":mstrmojo.desc(955,"Korean"),"1045":mstrmojo.desc(6047,"Polish"),"1046":mstrmojo.desc(1035,"Portugese (Brasil)"),"3082":mstrmojo.desc(1375,"Spanish"),"1053":mstrmojo.desc(956,"Swedish")}},number:{NUMBERINPUTFORMATS:{"0":"#,##0.###"},INTEGERINPUTFORMATS:{"0":"#,##0"},NUMBEROUTPUTFORMAT:"#0.##########",INTEGEROUTPUTFORMAT:"#0",DECIMALSEPARATOR:".",THOUSANDSEPARATOR:","},expression:{METRICVALIDATIONLEVEL:"0",PRESERVEWHITESPACE:false,Include:[{did:"1",n:mstrmojo.desc(3945,"Include")},{did:"2",n:mstrmojo.desc(3946,"Exclude")}],BranchQual:[{did:"19",n:mstrmojo.desc(5282,"AND")},{did:"20",n:mstrmojo.desc(5283,"OR")},{did:"21",n:mstrmojo.desc(12298,"NOT")},{did:"19_21",n:mstrmojo.desc(5924,"AND NOT")},{did:"20_21",n:mstrmojo.desc(5925,"OR NOT")}],RootOperator:[{did:"19",n:mstrmojo.desc(534,"All selections")},{did:"20",n:mstrmojo.desc(535,"Any selection")}],ExprType:[{did:"2",n:mstrmojo.desc(546,"Qualify")},{did:"5",n:mstrmojo.desc(547,"Select")}],DimtyLevels:[{did:"1",n:mstrmojo.desc(2171,"Default")},{did:"2",n:mstrmojo.desc(3086,"Metric")},{did:"3",n:mstrmojo.desc(3344,"Report")}],Attribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,76",n:mstrmojo.desc(686,"Contains"),t:1,tp:1},{did:"1,79",n:mstrmojo.desc(2784,"Does not contain"),t:1,tp:1},{did:"1,77",n:mstrmojo.desc(687,"Begins with"),t:1,tp:1},{did:"1,80",n:mstrmojo.desc(2785,"Does not begin with"),t:1,tp:1},{did:"1,78",n:mstrmojo.desc(688,"Ends with"),t:1,tp:1},{did:"1,81",n:mstrmojo.desc(2786,"Does not end with"),t:1,tp:1},{did:"1,18",n:mstrmojo.desc(525,"Like"),t:1,tp:1},{did:"1,43",n:mstrmojo.desc(526,"Not Like"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],Metric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"2,1",n:mstrmojo.desc(529,"Highest"),t:2,tp:2},{did:"2,2",n:mstrmojo.desc(530,"Lowest"),t:2,tp:2},{did:"3,1",n:mstrmojo.desc(4407,"Highest %"),t:3,tp:3},{did:"3,2",n:mstrmojo.desc(4406,"Lowest %"),t:3,tp:3}],MetricRP:[{did:"2,13",n:mstrmojo.desc(13897,"Rank between highest"),t:2,tp:2},{did:"2,4",n:mstrmojo.desc(1101,"Exclude highest"),t:2,tp:2},{did:"2,3",n:mstrmojo.desc(13896,"Rank between lowest"),t:2,tp:2},{did:"2,5",n:mstrmojo.desc(1102,"Exclude lowest"),t:2,tp:2},{did:"3,13",n:mstrmojo.desc(13890,"Between highest")+"%",t:3,tp:3},{did:"3,4",n:mstrmojo.desc(1101,"Exclude highest")+"%",t:3,tp:3},{did:"3,3",n:mstrmojo.desc(13889,"Between lowest")+"%",t:3,tp:3},{did:"3,5",n:mstrmojo.desc(1102,"Exclude lowest")+"%",t:3,tp:3}],MDXAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],MDXMetric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],SAPAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],Element:[{did:"1,22",n:mstrmojo.desc(2219,"In List"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2220,"Not In List"),t:1,tp:1}]},validation:{requiredFieldError:mstrmojo.desc(6078,"This field is required."),invalidCharError:mstrmojo.desc(7899,"This field contains invalid characters for #."),invalidDateStringError:mstrmojo.desc(7900,"This field contains invalid date/time string."),invalidNumericFormatError:mstrmojo.desc(7901,"This field contains numeric value with incorrect format."),outofRangeError:mstrmojo.desc(6079,"This field should be # between ## and ###."),noLessMinError:mstrmojo.desc(6081,"This field should be # greater than or equal to ##."),noGreaterMaxError:mstrmojo.desc(6080,"This field should be # less than or equal to ###."),failRegexTestError:mstrmojo.desc(6082,"This field failed regular expression validation."),invalidValueInListError:mstrmojo.desc(7902,"One of the value (#) in this list is not valid."),integerDataType:mstrmojo.desc(6076,"an Integer value"),numericDataType:mstrmojo.desc(6077,"a Number value"),dateDataType:mstrmojo.desc(7903,"a Date/Time value")},color:{colors:[{n:"Black",v:"#000000"},{n:"Brown",v:"#993300"},{n:"Olive Green",v:"#333300"},{n:"Dark Green",v:"#003300"},{n:"Dark Teal",v:"#003366"},{n:"Dark Blue",v:"#000080"},{n:"Indigo",v:"#333399"},{n:"Grey-80%",v:"#333333"},{n:"Dark Red",v:"#800000"},{n:"Orange",v:"#FF6600"},{n:"Dark Yellow",v:"#808000"},{n:"Green",v:"#008000"},{n:"Teal",v:"#008080"},{n:"Blue",v:"#0000FF"},{n:"Blue-Grey",v:"#666699"},{n:"Grey-50%",v:"#808080"},{n:"Red",v:"#FF0000"},{n:"Light Orange",v:"#FF9900"},{n:"Lime",v:"#99CC00"},{n:"Sea Green",v:"#339966"},{n:"Aqua",v:"#33CCCC"},{n:"Light Blue",v:"#3366FF"},{n:"Violet",v:"#800080"},{n:"Grey-40%",v:"#969696"},{n:"Pink",v:"#FF00FF"},{n:"Gold",v:"#FFCC00"},{n:"Yellow",v:"#FFFF00"},{n:"Bright Green",v:"#00FF00"},{n:"Turquoise",v:"#00FFFF"},{n:"Sky Blue",v:"#00CCFF"},{n:"Plum",v:"#993366"},{n:"Grey-25%",v:"#C0C0C0"},{n:"Rose",v:"#FF99CC"},{n:"Tan",v:"#FFCC99"},{n:"Light Yellow",v:"#FFFF99"},{n:"Light Green",v:"#CCFFCC"},{n:"Light Turquoise",v:"#CCFFFF"},{n:"Pale Blue",v:"#99CCFF"},{n:"Lavender",v:"#CC99FF"},{n:"White",v:"#ffffff"}],userPalette:[{n:"#F00E0E",v:"#F00E0E"},{n:"#080000",v:"#080000"},{n:"#E81A1A",v:"#E81A1A"},{n:"#6E0909",v:"#6E0909"},{n:"#4F2828",v:"#4F2828"},{n:"#141212",v:"#141212"},{n:"#D60202",v:"#D60202"},{n:"#C40404",v:"#C40404"}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.Event=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Event",init:function A(B){if(B&&!B.name){B.name=B.type;}mstrmojo.hash.copy(B,this);},name:"",src:null});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.requiresDescs(2213,3326,3327,3329,4531,13283,13284,13285,13286);mstrmojo.ME.Enum={METRIC_ACTIONS:{ADD:"add",EDIT:"edit",EDIT_NEW:"editNew"},EDITOR_IDS:{ADVANCED:"mstrME",FORMULA:"mstrME",WIZARD:"mstrFE",SIMPLE:"mstrSME",SELECOTR:"mstrFSE"},EDITOR_TYPES:{ADVANCED:"ADVANCED",FUNCTION:"FUNCTION",SIMPLE:"SIMPLE",SELECTOR:"SELECTOR"},METRIC_EDIT_TYPES:{ADVANCED:65536,SIMPLE:131072,FUNCTION:196608},METRIC_TYPES:{65536:"ADVANCED",131072:"SIMPLE",196608:"FUNCTION"},NEW_METRIC_DEFINITION:{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}},getNewDefinition:function(){return{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}};},FBFlag:{Automatic:0,Manual:3},AFB:{Automatic:-1,False:0,True:1},SFB:{Automatic:-1,False:1,True:2},UI_OBJECT_TYPE:{Dimty:-1,Sub_Expression:-2,Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},UI_DATA_TYPE:{Sortby:-1,Breakby:-2,Level:-4,Condition:-5,Transformation:-6},SHORTCUT_FUNCTIONS:{Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},DYNAMIC_DIMTY:{CODES:{auto:{n:mstrmojo.desc(4531,"Automatic"),did:"@auto",t:-1},page:{n:mstrmojo.desc(3329,"Grand Total"),did:"@p",t:-1},byCol:{n:mstrmojo.desc(3326,"By Columns"),did:"@cols",t:-1},byRow:{n:mstrmojo.desc(3327,"By Rows"),did:"@rows",t:-1},byCell:{n:mstrmojo.desc(13283,"By Cell"),did:"@cell",t:-1},byShape:{n:mstrmojo.desc(13284,"By Shape"),did:"@shape",t:-1},downCross:{n:mstrmojo.desc(13285,"Down, Then Across"),did:"@cr",t:-1},crossDown:{n:mstrmojo.desc(13286,"Across, Then Down"),did:"@rc",t:-1}},getItems:function D(G){var F=this.CODES,E=[];switch(G){case"breakby":E=[F.auto,A.copy({n:mstrmojo.desc(2057,"None")},A.copy(F.page)),A.copy({n:mstrmojo.desc(122,"Columns")},A.copy(F.byCol)),A.copy({n:mstrmojo.desc(2968,"Rows")},A.copy(F.byRow)),A.copy({n:mstrmojo.desc(13399,"Cell")},A.copy(F.byCell)),A.copy({n:mstrmojo.desc(2923,"Shape")},A.copy(F.byShape))];break;case"level":E=[F.auto,F.page,F.byCol,F.byRow,F.byCell,F.byShape];break;case"sortby":E=[F.auto,F.downCross,F.crossDown];}return E;},getAutomaticDimtyObject:function C(){return A.copy(this.CODES.auto);},getDimtyObject:function B(E,H){var F=null;var G=false;if(H){A.forEach(mstrmojo.ME.Enum.DYNAMIC_DIMTY.CODES,function(I){if(I.did===E){F=A.copy(I);G=true;return false;}});}if(!G){F={n:E,t:-1,dimty:true};}return F;}},NonExposableParams:["IsNewOLAP","OLAPPattern","OLAPHasWindow"]};mstrmojo.ME.Enum.DEFAULT_MPS={mps:{afb:mstrmojo.ME.Enum.AFB.False,sfb:mstrmojo.ME.Enum.SFB.False,fbf:mstrmojo.ME.Enum.FBFlag.Automatic}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var X=this._sourceFn;if(!X){var W=this.source;if(W!=null){if(typeof (W)=="string"){if(!(W.match("return "))&&!(W.match(/\;\s*\S/))){W="return "+W;}X=new Function(W);}else{if(typeof (W)=="function"){X=W;}}this._sourceFn=X;}}var S,Y=this.parent;if(X){try{S=X.apply(Y,[]);}catch(V){}}var U=this.setter,Z=this.destination;if(U==null){Y[Z]=S;}else{if(typeof (U)=="string"){Y[U](Z,S);}else{if(typeof (U)=="function"){U.apply(Y,[Z,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var U=this._chains;if(!U){this._parseChains();U=this._chains;}for(var S in U){this._attachChain(U[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var U=this._chains;if(U){for(var S in U){this._detachChain(U[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var V=this._chains;var U=this.source;if(U&&(typeof (U)=="function")){U=U.toString&&U.toString();}if(!U){return ;}function S(c,f,W,Y){var X=c,a;while(a=X.match(f)){var d=a[0],b=d.length,e=true;d=d.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Z in V){if(Z.substr(0,b)===d){e=false;break;}else{if(d.indexOf(Z)===0){delete V[Z];}}}if(e){V[d]={host:(W==null)?null:a[W],parts:a[Y].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}X=X.substr(a.index+b);}}if(D.test(U)){S(U,O,null,1);}if(R.test(U)){S(U,M,1,2);}if(B.test(U)){S(U,L,1,2);}},_attachChain:function Q(S,V){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var e=S.evt2idx,h=S.idx2evt,a=S.parts;var f=(V>=0)?V:0,c=this.id,X=mstrmojo.all,d=(V>0)?X[h[f-1].context][a[f-1]]:(S.host?X[S.host]:this.parent),U=a[f];var W=mstrmojo.array;while(d&&U){if(d.attachEventListener){var g=d[U+"_bindEvents"]||(U+"Change");if(typeof (g)=="string"){g=[g];}var Z=[];for(var b=0,Y=g.length;b<Y;b++){Z[b]=d.attachEventListener(g[b],c,"_callback");}for(var b=0;b<g.length;b++){e[d.id+"_"+g[b]]=f;}h[f]={context:d.id,evts:g,subs:Z};}d=d[U];U=S.parts[++f];}},_detachChain:function G(S,U){var V=mstrmojo.all,k=S.idx2evt,e=S.evt2idx,b=this.id;var Z=(U>-1)?U:0,c=k.length;if(Z<c){for(;Z<c;Z++){var a=k[Z];if(!a){break;}var X=a.context,d=V[X],h=a.evts;if(d&&d.detachEventListener){var l=a.subs;for(var g=0,W=l.length;g<W;g++){d.detachEventListener(l[g]);}}k[Z]=null;for(var Y=0,f=h.length;Y<f;Y++){delete e[X+"_"+h[Y]];}}}},_callback:function I(U){this.exec();if(!U||!U.name||!U.src){return ;}var V=U.src.id+"_"+U.name,X=this._chains;for(var Y in X){var W=X[Y],S=W.evt2idx[V];if(S!=null){this._detachChain(W,S+1);this._attachChain(W,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");var E=mstrmojo.hash;var B=function(G){return(mstrmojo.now()-G.getTime());};mstrmojo.storage.DOMStorage=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.storage.DOMStorage",mIsSupported:false,mStorageObj:null,itemTimeToLive:3600,init:function F(G){E.copy(G,this);return this;},isSupported:function C(){return this.mIsSupported;},checkVersion:function A(G){var H=this.getItem("__version__");if(H&&H<G){mstrmojo.dbg("DOMStorage data is old - clearing, v="+H);this.clear();}this.setItem("__version__",G,-1);return this;},length:function(){return(this.mIsSupported?this.mStorageObj.length:0);},_keyExpired:function D(G){return(G&&(G.ts>0)&&(mstrmojo.now()>G.ts));},key:function(G){return(this.mIsSupported?this.mStorageObj.key(G):null);},getItemAsString:function(H){var G=this.getItem(H);if(G){if(typeof G=="object"){G=JSON.stringify(G);}else{G=G+"";}}return G;},getItem:function(H){var G=null;if(this.mIsSupported){var J=this.mStorageObj.getItem(H);if(J){try{J=JSON.parse(J);}catch(I){}if(this._keyExpired(J)){this.removeItem(H);}else{G=J.data;}}}return G;},setItem:function(H,J,G){G=G||this.itemTimeToLive;try{if(this.mIsSupported){this.mStorageObj.removeItem(H);var L=(G>0)?(mstrmojo.now()+(G*1000)):-1;var I={ts:L,data:J};this.mStorageObj.setItem(H,JSON.stringify(I));}}catch(K){if(K!==QUOTA_EXCEEDED_ERR){throw K;}}finally{}return this;},removeItem:function(G){if(this.mIsSupported){this.mStorageObj.removeItem(G);}return this;},clear:function(){if(this.mIsSupported){this.mStorageObj.clear();}return this;}});})();(function(){mstrmojo.requiresCls("mstrmojo.EnumDSSDisplayMode");mstrmojo.requiresDescs(981);var B=mstrmojo.vi.viz;mstrmojo.vi.viz.KnownVisualizations={CUSTOM:-2,UNKNOWN:-1,GRID:0,ESRIMAP:2,GRAPHMATRIX:3,NEWGRAPHMATRIX:13,IMAGELAYOUT:4,HEATMAP:16,GOOGLEMAP:17,NETWORK:18,MAPBOX:19,KPICARD:20,getDefinition:function A(E){var F=B.KnownVisualizations,H={Grid:{id:F.GRID,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,title:mstrmojo.desc(981,"Grid")},visAjaxDatePicker:{id:1},ESRIMapVisualizationStyle:{id:F.ESRIMAP,mobileVIStyles:{IPhoneVisualization:"ViEsriMapAdapter",IPadVisualization:"ViEsriMapAdapter"}},GraphMatrixVisualizationStyle:{id:F.GRAPHMATRIX,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,widgetEnable:"-1",mobileVIStyles:{IPadVisualization:"IPadGraphMatrix2Style"}},NewGraphMatrixVisualizationStyle:{id:F.NEWGRAPHMATRIX,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,widgetEnable:"-1",mobileVIStyles:{IPadVisualization:"IPadGraphMatrix2Style"}},ImageLayoutVisualizationStyle:{id:F.IMAGELAYOUT,mobileVIStyles:{IPadVisualization:"IPhoneImageMapStyle",ATabletVisualization:"AndroidImageMapStyle"}},SurveyVisualizationStyle:{id:8,mobileVIStyles:{IPadVisualization:"SurveyVisualizationStyle"}},VIHeatMapVisualizationStyle:{id:F.HEATMAP,mobileVIStyles:{IPadVisualization:"IPadHeatMapStyle",ATabletVisualization:"HeatMapVisualizationStyle"}},GoogleMapVisualizationStyle:{id:F.GOOGLEMAP,mobileVIStyles:{IPhoneVisualization:"IPhoneMapStyle",IPadVisualization:"IPadMapStyle"}},MapboxVisualizationStyle:{id:F.MAPBOX,mobileVIStyles:{IPhoneVisualization:"IPhoneMapboxStyle",IPadVisualization:"IPhoneMapboxStyle"}},NetworkVisualizationStyle:{id:F.NETWORK,mobileVIStyles:{IPadVisualization:"IPhoneNetVizStyle"}},KPICardVisualizationStyle:{id:F.KPICARD,mobileVIStyles:{IPadVisualization:"IPhoneKPICardStyle"}}};var G=H[E];if(!G){var C=mstrConfig.pluginsVisList,D=C&&C[E];G={id:D?F.CUSTOM:F.UNKNOWN};G.mobileVIStyles=(D&&D.mobileVIStyles)||{};}return G;}};}());(function(){mstrmojo.requiresCls("mstrmojo.storage.DOMStorage");var A=4;mstrmojo.storage.DOMSessionStorage=mstrmojo.declare(mstrmojo.storage.DOMStorage,null,{scriptClass:"mstrmojo.storage.DOMSessionStorage",init:function(B){this._super(B);try{this.mIsSupported=("sessionStorage" in window)&&(window.sessionStorage!==null);this.mStorageObj=this.mIsSupported?window.sessionStorage:null;this.checkVersion(A);}catch(C){this.mIsSupported=false;}}});$SS=mstrmojo.global.sessionStore=new mstrmojo.storage.DOMSessionStorage();})();(function(){mstrmojo.requiresCls("mstrmojo.storage.DOMStorage");var A=4;mstrmojo.storage.DOMLocalStorage=mstrmojo.declare(mstrmojo.storage.DOMStorage,null,{scriptClass:"mstrmojo.storage.DOMLocalStorage",init:function(B){this._super(B);try{this.mIsSupported=("localStorage" in window)&&(window.localStorage!==null);this.mStorageObj=this.mIsSupported?window.localStorage:null;this.checkVersion(A);}catch(C){this.mIsSupported=false;}}});$LS=mstrmojo.global.localStore=new mstrmojo.storage.DOMLocalStorage({itemTimeToLive:(3600*24)});})();(function(){mstrmojo.requiresCls("mstrmojo.locales");var Y=function(){return mstrmojo.locales.datetime;},L=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},now:Date.now||function D(){return new Date().getTime();},isDate:function Z(c,g,b){var e=this.parseDate(c,b);var f=!!(e&&this.doesDateExist(e.month,e.day,e.year));if(g){if(f){var d=this.formatDateInfo(e,Y().DATEOUTPUTFORMAT);if(b){return{match:e.match,formatted:d};}return d;}return null;}return !!f;},formatDateInfo:function R(e,g){if(!g){return"";}var b=e.day,f=e.month,d=e.year;var c=g.replace(/dd/g,this.formatInteger(b,2)).replace(/d/g,Number(b)).replace(/yyyy/g,Number(d)).replace(/yy/g,this.formatInteger(Number(d)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,Y().MONTHNAME_FULL[Number(f)-1]).replace(/\~\~\~\~/g,Y().MONTHNAME_SHORT[Number(f)-1]).replace(/\@\@/g,this.formatInteger(f,2)).replace(/\^/g,Number(e.month));return c;},parseDate:function a(m,g,k){if(m==null){return false;}if(typeof m!=="string"){m=String(m);}m=L.trim(m);var b=this.CACHE.PARSEDATE[g?"CONTAINS":"EQUALS"],d=b[m];if(d||(d===null)){return d;}var c=null;var j;if(k){j=[k];}else{j=[].concat(Y().DATEINPUTFORMATS);j.unshift(Y().DATEOUTPUTFORMAT);}var e,f;for(e=0,f=j.length;e<f;e++){var h=this._buildRegExp4DateFormat(j[e]),l=h&&m.match(g?h.reContains:h.reEquals);if(l){c={match:l[0],year:h.yearIndex&&this.fourDigitYear(l[h.yearIndex]),day:h.dayIndex&&parseInt(Number(l[h.dayIndex]),10),month:h.monthIndex&&this.numericMonth(l[h.monthIndex])};break;}}b[m]=c;return c;},isTime:function I(c,f,b){var g=this.parseTime(c,b);var e=!!(g&&this.doesTimeExist(g.hour,g.min,g.sec));if(f){if(e){var d=this.formatTimeInfo(g,Y().TIMEOUTPUTFORMAT);if(b){return{match:g.match,formatted:d};}return d;}return null;}return !!e;},parseTime:function J(n,g,l){if(n==null){return false;}if(typeof n!=="string"){n=String(n);}n=L.trim(n);var b=this.CACHE.PARSETIME[g?"CONTAINS":"EQUALS"],d=b[n];if(d||(d===null)){return d;}var c=null;var k;if(l){k=[l];}else{k=[].concat(Y().TIMEINPUTFORMATS);k.unshift(Y().TIMEOUTPUTFORMAT);}var e,f;for(e=0,f=k.length;e<f;e++){var j=this._buildRegExp4TimeFormat(k[e]),m=j&&n.match(g?j.reContains:j.reEquals);if(m){var h=j.ampmIndex&&m[j.ampmIndex];c={match:m[0],hour:j.hourIndex&&this.capitalHour(m[j.hourIndex],h),min:j.minIndex&&parseInt(Number(m[j.minIndex]),10),sec:j.secIndex&&parseInt(Number(m[j.secIndex]),10)};break;}}b[n]=c;return c;},formatTimeInfo:function S(e,c){if(!c){return"";}var d=!(Number(e.hour)%12)?12:(Number(e.hour)%12),b=c.replace(/HH/g,this.formatInteger(e.hour,2)).replace(/H/g,Number(e.hour)).replace(/hh/g,this.formatInteger(d,2)).replace(/h/g,d).replace(/mm/g,this.formatInteger(Number(e.min)||0,2)).replace(/m/g,Number(e.min)||0).replace(/ss/g,this.formatInteger(Number(e.sec)||0,2)).replace(/s/g,Number(e.sec)||0).replace(/a/g,(Number(e.hour)<12)?Y().AM_NAME:Y().PM_NAME).replace(/tt/g,(Number(e.hour)<12)?Y().AM_NAME:Y().PM_NAME).replace(/AM\/PM/g,(Number(e.hour)<12)?Y().AM_NAME:Y().PM_NAME);return b;},doesTimeExist:function G(g,c,f){var e=parseInt(g,10);if(e>=0&&e<=23){var b=parseInt(c,10);if(b>=0&&b<=59){if(!f){return true;}var d=parseInt(f,10);if(d>=0&&d<=59){return true;}}}return false;},capitalHour:function C(b,c){b=parseInt(Number(b),10);if(c&&(c.match(Y().AM_NAME)||c.match(/AM/i))){return b%12;}if(c&&(c.match(Y().PM_NAME)||c.match(/PM/i))){return 12+(b%12);}return b;},getTimeStamp:function O(){var c=new Date();var b=[c.getMonth()+1,c.getDate(),c.getFullYear()];var f=[c.getHours(),c.getMinutes(),c.getSeconds()];var e=(f[0]<12)?"AM":"PM";f[0]=(f[0]<12)?f[0]:f[0]-12;f[0]=f[0]||12;for(var d=1;d<3;d++){if(f[d]<10){f[d]="0"+f[d];}}return b.join("-")+" "+f.join("")+" "+e;},isDateAndOrTime:function W(b,c){return this.isDateTime(b,c)||this.isDate(b,c)||this.isTime(b,c);},isDateTime:function B(k,b){var f=this.parseDateAndOrTime(k),i=f&&f.date,e=f&&f.time,h=!!i&&!!e&&this.doesDateExist(i.month,i.day,i.year)&&this.doesTimeExist(e.hour,e.min,e.sec);if(b){if(h){var c=this.formatDateInfo(i,Y().DATEOUTPUTFORMAT),d=this.formatTimeInfo(e,Y().TIMEOUTPUTFORMAT),j=k.indexOf(i.match),g=k.indexOf(e.match);return(g<j)?d+" "+c:c+" "+d;}return null;}return !!h;},parseDateAndOrTime:function Q(c,b,g){var d=this.parseDate(c,true,b);var e=L.trim((d&&d.match)?c.replace(d.match,""):c),f=this.parseTime(e,false,g);if(!d&&!f){return null;}return{date:d,time:f};},inDateTimeRange:function P(d,f,i){var c=this.parseDateAndOrTime(d),g=c&&c.date,j=c&&c.time;if(!g&&!j){return 0;}if(f!=null){var e=this.parseDateAndOrTime(f);if(g&&e&&e.date){var k=this.compareDate(g,e.date);if(k<0){return -1;}if(k==0){if(j&&e.time&&(this.compareTime(j,e.time)<0)){return -1;}}}}if(i!=null){var b=this.parseDateAndOrTime(i);if(g&&b&&b.date){var h=this.compareDate(g,b.date);if(h>0){return 1;}if(h==0){if(j&&b.time&&(this.compareTime(j,b.time)>0)){return 1;}}}}return 0;},compareDate:function A(d,b){if(d===b){return 0;}var e=typeof d==="string"?this.parseDate(d):d,c=typeof b==="string"?this.parseDate(b):b;if(!e){return -1;}if(!c){return 1;}return(e.year-c.year)||(e.month-c.month)||(e.day-c.day)||0;},compareTime:function K(c,b){if(c===b){return 0;}var e=typeof c==="string"?this.parseTime(c):c,d=typeof b==="string"?this.parseTime(b):b;if(!e){return -1;}if(!d){return 1;}return(e.hour-d.hour)||(e.min-d.min)||(e.sec-d.sec)||0;},compareDateTime:function V(c,b){return this.compareDate(c,b)||this.compareTime(c,b);},compareDateAndOrTime:function E(i,g){if(i===g){return 0;}var c=typeof i==="string"?this.parseDateAndOrTime(i):i,b=typeof g==="string"?this.parseDateAndOrTime(g):g;if(!c){return -1;}if(!b){return 1;}var h=c.date,f=b.date,e=c.time,d=b.time;return this.compareDate(h,f)||this.compareTime(e,d);},_buildRegExp4DateFormat:function N(d){if(!d){return null;}var f=this.REGEXPS.DATES[d];if(!f){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=Y().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=Y().MONTHNAME_SHORT.join("|");}f=this.REGEXPS.DATES[d]={};f.formatStr=d;var c=f.reStr=d.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");f.reEquals=new RegExp("^"+c+"$");f.reContains=new RegExp("^"+c+"\\b");var g=[{key:"monthIndex",index:d.indexOf("M")},{key:"dayIndex",index:d.indexOf("d")},{key:"yearIndex",index:d.indexOf("y")}];g.sort(function(i,h){return i.index-h.index;});var b=1,e;for(e=0;e<3;e++){f[g[e].key]=g[e].index>-1?b++:null;}}return f;},_buildRegExp4TimeFormat:function F(e){if(!e){return null;}var g=this.REGEXPS.TIMES[e];if(!g){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[Y().AM_NAME,Y().PM_NAME,String(Y().AM_NAME).toLowerCase(),String(Y().PM_NAME).toLowerCase()].join("|");}g=this.REGEXPS.TIMES[e]={};g.formatStr=e;var d=e.replace(/\'\'/g,'"');var h=d.match(/\'(.+?)\'/g);d.replace(/\'(.+?)\'/g,"*");d=d.replace(/([^H|h|m|s|z|Z|a|t|\s|A|P|M|\/])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/g,"("+this.REGEXPSTR_AMPM+")").replace(/AM\/PM/,"("+this.REGEXPSTR_AMPM+")").replace(/tt/g,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");var f,b;for(f=1,b=(h&&h.length)||0;f<b;f++){d=d.replace(/\*/,h[f]);}d=d.replace(/\"/g,"'");g.reEquals=new RegExp("^"+d+"$");g.reContains=new RegExp(d);var j=[{key:"hourIndex",index:e.search(/h|H/)},{key:"minIndex",index:e.indexOf("m")},{key:"secIndex",index:e.indexOf("s")},{key:"ampmIndex",index:e.search(/tt|a|AM\/PM/)},{key:"zoneIndex",index:e.search(/z|Z/)}];j.sort(function(k,i){return k.index-i.index;});var c=1;for(f=0;f<5;f++){g[j[f].key]=j[f].index>-1?c++:null;}}return g;},doesDateExist:function M(e,b,c){var d=new Date(c,e-1,b);return c==d.getFullYear()&&e==d.getMonth()+1&&b==d.getDate();},fourDigitYear:function U(c){c=parseInt(Number(c),10);if(!isNaN(c)){var b=(Y().TWODIGITYEARSTART%100)||0;if(c>=0&&c<=b){c=2000+c;}else{if(c>b&&c<100){c=1900+c;}}}return c;},numericMonth:function X(f){var e=parseInt(Number(f),10),d=mstrmojo.array;if(!isNaN(e)){return e;}var b=(f&&f.length)||0,c=-1;if(b){if(b<=3){c=d.indexOf(Y().MONTHNAME_SHORT,f);}if(c===-1){c=d.indexOf(Y().MONTHNAME_FULL,f);}}return c+1;},formatInteger:function H(d,c){var g=String(d),f=Math.max(c-g.length,0);if(f>0){var b=[g],e;for(e=1;e<=f;e++){b.push("0");}g=b.reverse().join("");}return g;},getFirstDateOfMonth:function(c,b){return new Date(c,b-1,1);},getDateObject:function(h,b,g,e,f,c){h=h||0;b=b||1;g=g||1;e=e||0;f=f||0;c=c||0;return new Date(h,b-1,g,e,f,c);},getDateFromDateInfo:function(b){return this.getDateObject(b.date&&b.date.year,b.date&&b.date.month,b.date&&b.date.day,b.time&&b.time.hour,b.time&&b.time.min,b.time&&b.time.sec);},getDateJson:function(b){return{year:b.getFullYear(),month:b.getMonth()+1,day:b.getDate(),hour:b.getHours(),min:b.getMinutes(),sec:b.getSeconds()};},isLeapYear:function(b){return !(b%400)||(!(b%4)&&!!(b%100));},getDaysOfMonth:function(d,b){var c=[31,28,31,30,31,30,31,31,30,31,30,31];if(b==2&&this.isLeapYear(d)){return 29;}return c[b-1];},getPreMonth:function(c,b){if(b===1){return{y:c-1,m:12};}return{y:c,m:b-1};},getNextMonth:function(c,b){if(b===12){return{y:c+1,m:1};}return{y:c,m:b+1};}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.string","mstrmojo.array");var N=mstrmojo.locales,J=mstrmojo.string,Q=window.mstrConfig,G=mstrmojo.array,D=Q.units,S={CM:1,IN:2,MM:3,PT:4,PC:5,PX:6},B={1:"cm",2:"in",3:"mm",4:"pt",5:"pc",6:"px"},F={DEFAULT:-2,FIXED:0,CURR:1,PERCENT:4,FRACTION:5,SCIENTIFIC:6,GENERAL:9};var H=96;String.prototype.reverse=function(){var W="",V;for(V=this.length;V>0;--V){W+=this.charAt(V-1);}return W;};function L(V,X){V=V||"";X=X||V.match(/\".+?\"/g)||[];for(var W=0;W<X.length;W++){V=V.replace(X[W],X[W].substring(1,X[W].length-1).replace(/\$/g,"$$$$"));}return V;}function U(a){var V=86400000,Z=new Date(1900,0,1,0,0,0,0),W=Math.floor(a)-1,Y=a-W-1;if(a>=59){W--;}var X=new Date(Z.getTime()+(W*V));X.setTime(X.getTime()+Y*V+500);return X;}function I(Z,g,i){var a={"d+":Z.getDate(),"h+|H":Z.getHours(),"s+":Z.getSeconds()},V=N.datetime,b;if(/(y+)/.test(g)){var Y=Z.getFullYear().toString(),f=RegExp.$1,X=f.length===2,W=Y.length;g=g.replace(f,Y.substr(X?W-2:0,X?2:W));}if(/(^\[h\])/.test(g)&&i){g=g.replace(RegExp.$1,""+(Math.floor(i*24)));}if(/(\"?:\"?mm)/.test(g)){var c=Z.getMinutes();g=g.replace(RegExp.$1,":"+(RegExp.$1.length===1?c:("00"+c).substr(c.toString().length)));}if(/(AM\/PM)/.test(g)){var h=a["h+"],d=h>11;a["h+"]=h-(d?12:0);g=g.replace(RegExp.$1,d?"PM":"AM");}for(b in a){if(new RegExp("("+b+")").test(g)){g=g.replace(RegExp.$1,RegExp.$1.length===1?a[b]:("00"+a[b]).substr((a[b].toString()).length));}}if(/(mmmm)/.test(g)){g=g.replace(RegExp.$1,V.MONTHNAME_FULL[Z.getMonth()]);}else{if(/(mmm)/.test(g)){g=g.replace(RegExp.$1,V.MONTHNAME_SHORT[Z.getMonth()].substr(0,3));}else{if(/((m|M)+)/.test(g)){var e=(Z.getMonth()+1).toString();g=g.replace(RegExp.$1,RegExp.$1.length===1?e:("00"+e).substr(e.length));}}}return L(g);}function O(W,Z){var X=0,V=Z.length,Y=0;for(;X<V;X++){if(Z[X]==="0"){Y++;}else{if(Z[X]==="#"){if(Y<W){Y++;}}else{continue;}}}return Y;}mstrmojo.num=mstrmojo.provide("mstrmojo.num",{isInt:function E(V){var Y=this.getThousand(),X=new RegExp("^(-)?[0-9]{1,3}(\\"+Y+"[0-9]{3})*$"),W=new RegExp("^(-)?[0-9]+$");return(String(V).indexOf(Y)&&X.test(V))||W.test(V);},isNumeric:function P(a,b){var Z=this.getDecimal(),c=this.getThousand(),Y=b?"%?":"",X=new RegExp("^(-)?[0-9]{1,3}(\\"+c+"[0-9]{3})*(\\"+Z+"[0-9]+)?"+Y+"$"),W=new RegExp("^(-)?[0-9]*(\\"+Z+")?[0-9]+"+Y+"$"),V=new RegExp("^(-)?[0-9]{1}(\\"+Z+")[1-9]+[eE]{1}[-]{0,1}[0-9]+"+Y+"$");return(String(a).indexOf(c)&&X.test(a))||W.test(a)||V.test(a);},isBigDecimal:function(W){if(!W){return false;}var V=String(W).match(/^#([^#]+)#$/);if(!V||V.length<=1){return false;}var X=V[1];return this.isNumeric(X);},parseInteger:function M(V,W){if(!this.isInt(V)){return Number.NaN;}return parseInt(this.toString(V,true),W);},parseNumeric:function C(V){if(!this.isNumeric(V)){return Number.NaN;}return parseFloat(this.toString(V,true));},parseEnhNumeric:function A(V){if(!this.isNumeric(V,true)){return Number.NaN;}if(V.indexOf("%")!==-1){return parseFloat(this.toString(V.replace("%",""),true))/100;}return parseFloat(this.toString(V,true));},parseBigDecimal:function(V){return String(V).match(/^#(.+)#$/)[1];},inNumericRange:function R(W,X,V){W=this.parseNumeric(W);V=(V!=null)?this.parseNumeric(this.toLocaleString(V)):Number.NaN;X=(X!=null)?this.parseNumeric(this.toLocaleString(X)):Number.NaN;if(V!=Number.NaN&&(W>V||isNaN(W))){return 1;}if(X!=Number.NaN&&(W<X||isNaN(W))){return -1;}return 0;},convertToUSUnits:function(Y,X,W){var V=Y;X=X||D;switch(parseInt(X,10)){case S.CM:V=parseFloat(this.toString(Y))/2.54+"";break;case S.MM:V=parseFloat(this.toString(Y))/25.4+"";break;case S.PT:V=parseFloat(this.toString(Y))/72+"";break;case S.PC:V=parseFloat(this.toString(Y))/6+"";break;case S.PX:V=parseFloat(this.toString(Y))/H+"";break;}return W?V:this.toLocaleString(V);},convertToLocalUnits:function(Y,X,W){var V;X=X||D;switch(parseInt(X,10)){case S.CM:V=(parseFloat(this.toString(Y))*2.54).toFixed(4)+"";break;case S.MM:V=(parseFloat(this.toString(Y))*25.4).toFixed(4)+"";break;case S.PT:V=(parseFloat(this.toString(Y))*72).toFixed(4)+"";break;case S.PC:V=(parseFloat(this.toString(Y))*6).toFixed(4)+"";break;case S.PX:V=(parseFloat(this.toString(Y))*H)+"";break;default:V=parseFloat(this.toString(Y)).toFixed(4)+"";}return W?V:this.toLocaleString(V);},convertUnits:function(W,X,V){return this.convertToLocalUnits(this.convertToUSUnits(V,W,true),X,true);},toLocaleString:function(V){return(V+"").replace(".",this.getDecimal());},toString:function(X,V){if(V===true){var W=this.getThousandSepRegex();if(W){X=String(X).replace(W,"");}}return String(X).replace(this.getDecimal(),".");},getThousandSepRegex:function(){if(this.thousandSeparatorRegex==null){this.thousandSeparatorRegex=new RegExp(this.getThousand().replace(/(\W){1}/g,"\\$1"),"g");}return this.thousandSeparatorRegex;},addSeparators:function(X,W){var V=W;if(W=="."||W=="*"||W=="\\"){V="\\"+W;}return X.reverse().replace(/(\d{3})/g,"$1"+W).reverse().replace(new RegExp("^(-)?"+V),"$1");},addSeparators2:function(Y,X){var V=Y,W=/(\d+)(\d{3})/;while(W.test(V)){V=V.replace(W,"$1"+X+"$2");}return V;},format:function(Z,Y,c,V){var b="",a=(Y>0)?".":"",W=[];c=(c)?c:"";for(var X=0;X<Y;X++){W.push("0");}W=W.join("");switch(Z){case F.GENERAL:b="0.00";break;case F.PERCENT:b="0"+a+W+"%";break;case F.SCIENTIFIC:b="0"+a+W+"E+00";break;default:b='"'+c+'"#,##0'+a+W;}return this.formatByMask(b,V);},getDecimalLength:function K(X){var V=X.indexOf("."),Y=0;if(V!==-1){var W=X.substr(V+1,X.length).match(/\d+/);if(W&&W.length>0){Y=W[0].length;}}return Y;},formatByMask:function(AH,AZ){var AB,o="",u,Ad=false;if(isNaN(AZ)){AB=new Date(AZ);if(isNaN(AB)||!Date.parse(AZ)){return AZ;}u=true;}if(AH==="General"){if(String(parseFloat(AZ)).indexOf(".")>-1){var AM=String(parseFloat(AZ).toFixed(2));o=AM.split(".");if(o.length===2){return o.join(this.getDecimal());}return AM;}else{return String(parseFloat(AZ));}}var t=String(AH).split(";"),Y=t[0],k="\u00A4",AS=/"[^"]*"/g,n=(AH&&AH.replace(AS,k).replace(/\[.*\]/g,k))||"",AY=["m","y","d","h","s"],AN=false;G.forEach(AY,function(i){AN=AN||n.indexOf(i,0)!==-1;});if(AN){if(window.SSF&&!Ad){o=this.formatBySSF(AH,AZ);Ad=true;}if(o!==""){return o;}else{return I(u?AB:U(AZ),AH,AZ);}}var AL=Y.indexOf("E+"),e=Y.indexOf("%"),y=Y.match(/\".+?\"/g),AE=Y.match(/\[([=<>]*)(-?\d+\.?\d*)\]/),z=Y.indexOf("?/?")>-1,AF=(AL!=-1)?F.SCIENTIFIC:((e!=-1)?F.PERCENT:((y&&!AE)?F.CURR:z?F.FRACTION:F.FIXED)),s="",AU="",p=false,W=new String(AZ),d=parseFloat(AZ)||this.parseNumeric(AZ);if(y){if(Y.match(/\[\$.+?\]/g)){for(var f=0;f<y.length;f++){Y=Y.replace(y[f],y[f].substring(1,y[f].length-1));if(y[f].match(/\[\$.+?\]/g)){y[f]=y[f].replace(/\[\$.+?\]/g,y[f][y[f].indexOf("[$")+2]);}}Y=Y.replace(/\[\$.+?\]/g,'"#"'.replace("#",Y[Y.indexOf("[$")+2]));}s=L(Y,y);s=s.replace(Y.replace(/\".+?\"/g,""),k);}if(d<0){W=W.substring(1,W.length);d=-d;p=true;if(t.length>1){var b=t[1].replace(/\[.*\]/,"");AU=L(b.replace(t[0],k));}}var l=this,c=function(m,i){var j=i&&i.replace(k,m);if(i&&(j===i)&&window.SSF){if(Ad){return m;}else{Ad=true;return l.formatBySSF(i,m);}}return(i)?j:"-"+m;};if(AF===F.FRACTION){var AQ,AP,AX,q=10,AA,x=0,AJ,AT,Z,X=false,AG;if(AH.indexOf("# ")>-1){X=true;}for(AQ=5;AQ>0;AQ--){AG="/";for(AP=0;AP<AQ;AP++){AG+="?";}if(AH.indexOf(AG)>-1){for(AP=1;AP<AQ;AP++){q*=10;}break;}}if(X){x=Math.floor(Number(d));d-=x;}AT=q/2;AX=-1;AJ=d*q;for(AQ=q-1;AQ>=2;AQ--){Z=(AJ*AQ)/q;Z=Z-Math.floor(Z);Z=Z*q;if(Math.abs(Z-q)<Z){Z=Math.abs(Z-q);}Z=Z/AQ;if(Z<AT){AT=Z;AX=AQ;}else{if((Z==AT)&&(Z==0)){AT=Z;AX=AQ;}}}AA=Math.round(AX*AJ/q);for(AQ=AX;AQ>=2;AQ--){if((AA%AQ==0)&&(AX%AQ==0)){AA=AA/AQ;AX=AX/AQ;break;}}if(AX==q){AX=1;AA=0;}if(AA==0){AX=1;}if(AA==AX){if(X){o=""+(x+1);}else{o="1";}}else{if(X&&x>0){if(AA==0){o=x;}else{o=x+" "+AA+"/"+AX;}}else{if(AA==0){o="0";}else{o=AA+"/"+AX;}}}if(p){o=c(o,AU);}}else{if(AF==F.SCIENTIFIC){if(d!=0){var Ab=Math.floor(Math.log(d)/Math.LN10),AO=d/Math.pow(10,Ab),Ac=Y.substring(0,AL),h=Ac.indexOf("."),AI=Y.length-Y.indexOf("E+")-(""+Math.abs(Ab)).length-2,AQ,V=Ab<0;Ab=Math.abs(Ab);for(AQ=0;AQ<AI;AQ++){Ab="0"+Ab;}o+=Number(AO).toFixed((h!=-1)?Ac.length-h-1:0);o=((p)?c(o,AU):o)+"E"+(V?"-":"+")+Ab;}else{o="0";}}else{if(AF==F.PERCENT){Y=Y.substring(0,Y.length-1);W=String(d*100);}var h=Y.indexOf("."),a=0,AW,w=h>=0?Y.substring(0,h):Y,AC=h>=0?Y.substring(h+1,Y.length):"",g=false;if(w.match(/[#0\?],$/)){d/=1000;W=String(d);}else{if(AC.match(/^[#0]*,/)){var AD=0;g=true;while(AD<AC.length){if(AC[AD]==="0"||AC[AD]==="#"){AD++;}else{if(AC[AD]===","){d/=1000;W=String(d);AD++;}else{break;}}}}}AW=this.getDecimalLength(W);if(h!=-1){a=O(AW,Y.substr(h+1,Y.length));}if(W.indexOf("e")===-1||W.indexOf("e-")>-1){o=String((+(Math.round(+(W.indexOf("e")>0?String(parseFloat(W).toFixed(Math.min(a+2,20))):W+"e"+Math.min(a,20)))+"e"+-Math.min(a,20))).toFixed(Math.min(a,20)));}else{o=W;var Aa=o.split("e");Aa[0]=parseFloat(Aa[0]).toFixed(2).toString();o=Aa.join("e");if(AF==F.CURR){o=s.replace(k,o);if(o===s&&window.SSF){o=this.formatBySSF(AH,AZ,o);Ad=true;}}if(AF==F.PERCENT){o+="%";}if(p){o=c(o,AU);}return o;}if(AF===F.FIXED){if(/[\[\]><=A-Za-z]|,{2}/.test(Y)&&window.SSF){var AR=this.formatBySSF(AH,AZ);o=AR!==""?AR:o;Ad=true;}}var AV=o.split(".");var AK=Y.replace(/"[^"]*"/g,"").match(/[#\d]+[^\.\d#]+[#\d]+/);if(AK!==null){if(AF===F.CURR){AV[0]=(this.formatBySSF((g?AK[0]&&AK[0].trim():AK.input&&AK.input.trim()),parseFloat(AV[0]))||"").split(".")[0];Ad=true;}if(AV[0].indexOf(",")>=0){AV[0]=AV[0].replace(/,/g,this.getThousand());}else{if(!(this.getThousand()===","&&AV[0].search(this.getThousand())>0)){AV[0]=this.addSeparators2(AV[0],this.getThousand());}}}o=AV.join(this.getDecimal());if(AF==F.CURR){o=s.replace(k,o);if(o===s&&window.SSF){o=this.formatBySSF(AH,AZ,o);Ad=true;}}if(AF==F.PERCENT){o+="%";}if(p){o=c(o,AU);}}}return o;},formatBySSF:function(X,W,Y){var V=(Y!==undefined&&Y!==null)?Y:"";if(typeof W==="string"){W=parseFloat(W);}try{V=window.SSF.format(X,W);}catch(Z){if(window.mstr_profile){window.mstr_profile.log(Z);}V=(Y||W).toString();}return V;},validateFormat:function(V){var W=true,X=String(V).split(";");if(X[1]&&X[1].indexOf(X[0])<0){W=false;}return W;},generateUniqueID:function(V){var X="0123456789ABCDEF".split(""),Y=[];for(var W=0;W<V;W++){Y[W]=X[0|Math.random()*16];}return Y.join("");},countOfDecimals:function(W,X){var V=String(W);return V.length-(V.indexOf(X!==undefined?X:this.getDecimal())+1);},getThousand:function(){return mstrmojo.locales.number.THOUSANDSEPARATOR;},getDecimal:function(){return mstrmojo.locales.number.DECIMALSEPARATOR;}});mstrmojo.num.UNIT=S;mstrmojo.num.UNIT_SYMBOL=B;})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.locales");var d=mstrmojo.array,P=mstrmojo.meta.TP,G=mstrmojo.meta.STP,O=mstrmojo.hash,F={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1,RLS:15},B={};var X;for(X in F){B[F[X]]=true;}var b={};b[F.AQ]="a";b[F.AL]="a";b[F.AC]="a";b[F.AE]="a";b[F.MQ]="m";b[F.MC]="m";b[F.F]="f";b[F.R]="r";b[F.XML]="p";b[F.ANDOR]="nds";var K={};K[F.MQ]=["not","m","fn","fnt","cs","dmy","idcsi"];K[F.MC]=["not","m","fn","fnt","m2","m3","p","dmy","idcsi"];K[F.AE]=["not","a","fn","es","a2","fm2","p"];K[F.AQ]=["not","a","fm","fn","cs"];K[F.AL]=["not","a","fm","fn","cs"];K[F.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];K[F.R]=["not","r"];K[F.F]=["not","f"];K[F.XML]=["not","n","p"];K[F.ANDOR]=["not","node","nds","fn"];var M={};M[F.MQ]="METRIC_FNS";M[F.MC]="METRIC_FNS";M[F.AQ]="FORM_FNS";M[F.AL]="FORM_FNS";M[F.AC]="FORM_FNS";M[F.AE]="ELEM_FNS";var N={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43,CONS:47},c={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776,REPORT_EMMACUBE:779,CONS:12032,NDE:12033},U={a:N.ATTR,a2:N.ATTR,m:N.METRIC,m2:N.METRIC,r:N.REPORT,f:N.FILTER,p:N.PROMPT},V={f:c.FILTER};var W={};W[F.MQ]=N.METRIC;W[F.MC]=N.METRIC;W[F.AQ]=N.ATTR;W[F.AL]=N.ATTR;W[F.AC]=N.ATTR;W[F.AE]=N.ATTR;W[F.F]=N.FILTER;W[F.R]=N.REPORT;var J=function(e){var H=e.length,h={},g;for(g=0;g<H;g++){var j=e[g];h[j.did]=j.n;}return h;},E=function(f){var H=f.length,g;for(g=0;g<H;g++){var e=f[g];if("tp" in e){e.t=e.tp;}}return f;},Y=function(f,h){var H=f.length,g;for(g=0;g<H;g++){var e=f[g];if("tp" in e){if(h){e.t=h;}else{delete e.t;}}}return f;},a=function(e,g){if(!g){g=[];}g.length=0;var f,H;for(f=0,H=e.length;f<H;f++){g[f]=e[f];}return g;},L={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};var R={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:F,ETs:B,ET2TGT:b,ET2COND:K,ET2TP:W,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21,SEARCH:158,DESCENDANT:187},FN_MRP:{BETWEEN:3,EXCLUDE_TOP:4,EXCLUDE_BOTTOM:5,BETWEEN_DESCENDING:13},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:N,STP:c,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30,NUMERICALLOWSPERCENTAGE:49},BFTP:{RESERVED:0,HIDDEN:-1,DATETIME:1,NUMBER:2,TEXT:3,PICTURE:4,URL:5,EMAIL:6,TAG:7,DATE:8,TIME:9,SYMBOL:10,BIGDECIMAL:11,PHONENUMBER:12},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":c.PROMPT,1:c.PROMPT_LONG,2:c.PROMPT_LONG,3:c.PROMPT_LONG,4:c.PROMPT_DOUBLE,5:c.PROMPT_DOUBLE,6:c.PROMPT_DOUBLE,7:c.PROMPT_DOUBLE,8:c.PROMPT_STRING,9:c.PROMPT_STRING,10:c.PROMPT_STRING,14:c.PROMPT_DATE,15:c.PROMPT_DATE,16:c.PROMPT_DATE,21:c.PROMPT_LONG,22:c.PROMPT_LONG,23:c.PROMPT_STRING,24:c.PROMPT_BOOLEAN,30:c.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0,34:0},fnCstCount:function A(g,e){var h=this.FN,i=this.FN_MRP,H=this.FNT;if(e===H.DEF||e===undefined){switch(g){case h.BETWEEN:case h.NOT_BETWEEN:return 2;case h.IS_NULL:case h.IS_NOT_NULL:return 0;}}else{if(e===H.PER||e===H.RANK){switch(g){case i.BETWEEN:case i.BETWEEN_DESCENDING:return 2;}}}return 1;},fn_List:function S(e,H){var g=this.FN;return e==g.IN_LIST||e==g.NOT_IN_LIST;},fn_AC_MC:function Z(e,H){var g=this.FN;return(e==g.EQUAL)||(e==g.NOT_EQUAL)||(e==g.GREATER)||(e==g.LESS)||(e==g.GREATER_EQUAL)||(e==g.LESS_EQUAL);},fnName:function Q(j,h,e,g){var H=this[M[j]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[g]]||H["*"];}if(j===F.MQ){H=H.concat(mstrmojo.locales.expression.MetricRP);}var f=d.find(H,"did",(e||1)+this.FN_SEP+h);if(f>-1){return H[f].n;}return"";},findTargets:function I(o,g,q){if(!q){q={};}if(o){var n;for(n in U){var AA=o[n];if(AA){if(!AA[P]){AA[P]=U[n];}if(!AA[G]&&V[n]){AA[G]=V[n];}q[AA[g]]=AA;}}if(o.dmy){var l=this.TP.ATTR,s=this.DMY_TP.ATTR,f=o.dmy.uts,z,e;for(z=0,e=(f&&f.length)||0;z<e;z++){var m=f[z];if(m&&m.utp===s){var j=m.utgt;if(!j.t){j.t=l;}q[j[g]]=j;}}}var H=o.nds,p,x;for(p=0,x=(H&&H.length)||0;p<x;p++){this.findTargets(H[p],g,q);}var w=o.cs,y=w&&w.length;if(y){for(p=0;p<y;p++){this.findTargets(w[p],g,q);}}}return q;},onLocaleUpdated:function(){var e=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=O.copy(J(e.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=a(Y(e.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":Y(d.filter(e.Metric.concat(e.MetricRP),function(f){return f.did&&(d.find(R["0"],"did",f.did)<0);}))};H.FORM_FNS={0:Y(d.filter(e.Attribute,function(f){return f.did&&(d.find(L["0"],"did",f.did)<0);})),1:Y(d.filter(e.Attribute,function(f){return f.did&&(d.find(L["1"],"did",f.did)<0);})),2:Y(d.filter(e.Attribute,function(f){return f.did&&(d.find(L["0"],"did",f.did)<0)&&(d.find(L["1"],"did",f.did)<0);}))};H.DIMTYLEVELS=a(Y(e.DimtyLevels),H.DIMTYLEVELS);},getSortedObjectsByTypeGroup:function D(h){var f=-1,H=0,e=1,g=2;function i(j){switch(j.t){case N.METRIC:return e;case N.ATTR:case N.DIM:case N.CONS:return H;case N.FILTER:return j.st===c.CUSTOMGROUP?H:g;case -1:return f;default:return g;}}h=d.map(h||[],function(j){return O.copy(j,{});});return h.sort(function(n,m){var o=i(n)-i(m);if(o){return o;}var l=n.n.toUpperCase(),k=m.n.toUpperCase(),j=l.localeCompare(k);if(j){return j;}return n.n.localeCompare(m.n);});},mapBaseFormTypeToDataType:function C(f){f=parseInt(f);if(f===NaN){return -1;}var e=this.BFTP,H=this.DTP;switch(f){case e.DATETIME:return H.TIMESTAMP;case e.DATE:return H.DATE;case e.TIME:return H.TIME;case e.NUMBER:return H.REAL;case e.TEXT:return H.CHAR;case e.BIGDECIMAL:return H.BIGDECIMAL;default:return H.CHAR;}}});mstrmojo.expr.onLocaleUpdated();}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var D=mstrmojo.registry,K=mstrmojo.array,I=mstrmojo.publisher;function G(Q,R){if(R){R.parent=Q;var P=D.ref(R);if(R!==P){delete R.parent;}return P;}return null;}function L(Q,R){var P=R.alias;if(P!==null&&P!==""){Q[P]=R;}}function N(Q,R){var P=R.alias;if(R.parent===Q){delete R.parent;}if((P!==null&&P!=="")&&(Q[P]===R)){delete Q[P];}}function A(U,Q){var P=Q&&Q.length,S,R;if(P){S=[];for(R=0;R<P;R++){var V=G(U,Q[R]);if(!V){continue;}S.push(V);L(U,V);}}return S;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,children:null,postCreateChildren:mstrmojo.emptyFn,onaddChild:null,onremoveChild:null,initChildren:function F(){var P="children",Q=this[P];if(!Q){return ;}this[P]=null;this._set_children(P,Q,true);this.postCreateChildren();},_set_children:function E(S,Q,P){var R=this.children;if(Q!==R){if(R){this.removeChildren(null,P);}this.addChildren(Q,0,P);}return false;},destroyChildren:function C(S){var R=this.children,P=(R&&R.length)||0,Q;if(P){for(Q=P-1;Q>-1;Q--){var U=R[Q];if(U&&U.destroy){U.destroy(S);if(!S){N(this,U);}}}if(!S){R.length=0;}}},invalidateChildren:function B(){mstrmojo.array.forEach(this.children,function(P){P.invalidate();});},invalidate:function H(){this.invalidateChildren();},addChildren:function O(V,Q,R){if(!V){return V;}var U=V.constructor===Array,P=A(this,U?V:[V]);if(P&&P.length){var S=this.children||[];if(Q===null||Q===undefined){Q=S.length;}this.children=K.insert(S,Q,P);if(!R&&(this.onaddChild||I.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:P,index:Q});}}return U?P:(P&&P[0]);},removeChildren:function J(W,R){var U=this.children,V=W?[W]:(this.children||[]).concat(),Q=V.length,P=-1,S;if(Q){for(S=Q-1;S>-1;S--){N(this,V[S]);}if(W){P=K.removeItem(U,W);}else{if(U){U.length=0;P=0;}}if(!R&&(this.onremoveChild||I.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:V,index:P});}}return P;},removeAndDestroyChild:function M(R,P,Q){if(R){if(R.parent!==this){throw"Unable to remove an object that is not in the children collection.";}this.removeChildren(R,P);R.destroy(Q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var A=false,D="mstrmojo.Binding",I="bindings",H=mstrmojo.registry;function B(K){var L;for(L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function C(K,M){if(!A){mstrmojo.requiresCls(D);A=true;}var N;for(N in K){var J=K[N];if(J===null||J===undefined){continue;}var L=typeof J;if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=H.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function E(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[I]);if(K){delete this[I];this._set_bindings(I,K);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children,J=(M&&M.length)||0;if(J){var L;for(L=0;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function G(){var J=this.bindings;if(J){B(J);delete this.bindings;}},_set_bindings:function F(L,J){var K=this[I];if(J!==K){if(K){B(K);}this[I]=J;if(J){C(J,this);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base");mstrmojo.chart.common.DSSTimeUtil=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSTimeUtil",DaysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],DaysBeforeMonth:[0,31,59,90,120,151,181,212,243,273,304,334],DateAbove1970:[1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981]});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.array");var H=mstrmojo,F=H.array,A="00000000000000000000000000000000",E=-1;function J(K){return K&&K.t===4&&K.id!==A;}function G(L){var K,M=(L&&L.length)||0;if(M===0){return false;}for(K=0;K<M;K++){if(!J(L[K])){return false;}}return true;}mstrmojo.VisProps=null;mstrmojo.vi.viz.DropZoneHelper=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.viz.DropZoneHelper",getXml:function B(){return"";},setData:function I(K){},isMetric:function(K){return J(K);},isMetricZone:function(K){return G(K);},getMetricCountInZone:function D(L){var K=0;F.forEach(L,function(M){if(J(M)){K++;}});return K;}});mstrmojo.vi.viz.DropZoneHelper.METRIC_NAMES_ID=A;mstrmojo.vi.viz.DropZoneHelper.isMetricNames=function C(K){return(parseInt(K.did,10)===E)||(K.id===A)||(K.did===A);};}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.gm.GMEnums");var A=mstrmojo.gm.EnumIdentityType;mstrmojo.gm.GMIdentities=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GMIdentities"});mstrmojo.gm.HeaderCellIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.HeaderCellIdentity",eid:undefined,v:undefined,tid:undefined,n:undefined,tui:undefined,fid:undefined,o:undefined,isRowAttribute:undefined,at:undefined,dei:undefined,dpt:undefined});mstrmojo.gm.GeneralIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GeneralIdentity",objType:undefined});mstrmojo.gm.TitleCellIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.TitleCellIdentity",tid:undefined,fid:undefined,n:undefined,tui:undefined,isRowAttribute:undefined,otp:undefined,init:function(B){this.fid=B.fid;this.tid=B.id;this.isRowAttribute=B.isRowAttribute;if(B.isRowAttribute){this.objType=A.ROW_TITLE;}else{this.objType=A.COL_TITLE;}this.n=B.n;this.otp=B.otp;this.ost=B.ost;this.tui=B.tui;}});mstrmojo.gm.MetricAxisTitleIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.MetricAxisTitleIdentity",init:function(B){this._super(B);}});mstrmojo.gm.AttributeAxisTitleIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.AttributeAxiTitleIdentity",init:function(B){this._super(B);}});mstrmojo.gm.AxisIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.AxisIdentity",isNumericAxis:undefined,metricIdxArr:undefined,attrIdArr:undefined});mstrmojo.gm.ColorSquareIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.ColorSquareIdentity",init:function(B){this._super(B);this.comb=this.getElementsCombination();},getElementsCombination:function(){var B,F=this.token,C,H,G,E,I,D;if(F){D=[];C=F.levels;H=F.elements;G=F.types;B=C.length;for(E=0;E<B;E++){I={eid:H[E],tid:C[E]};if(G){I.tp=G[E];}D.push(I);}return D;}return undefined;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom;mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function B(F,I,E){if(A.isPrimaryMouseBtn(E.e)){var D=E.hWin,H=E.e,G=A.eventTarget(D,H),C=F.listMapper.findIndex(F,I,G);if(C>-1){F.toggleSelect(C);}}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var C=mstrmojo.dom,B=C.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function A(E,I,D){var G=(E&&E.tree)||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}return true;}},mstrmojo.hash.copy(mstrmojo.ListSelector)));}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var E=mstrmojo.dom;function B(I){return E.contains(this.getMovingHandle(),I.src.node,true,document.body);}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function G(){return this.domNode;},getMovingTarget:function H(){return this.domNode;},isDragValid:function A(I){return B.call(this,I)||(this._super&&this._super(I))||false;},ondragstart:function C(J){if(B.call(this,J)){var K=this.getMovingHandle(),I=this.getMovingTarget().style;this._leftPos=parseInt(I.left,10);this._topPos=parseInt(I.top,10);this._hWidth=K.clientWidth;this._hHeight=K.clientHeight;}if(this._super){this._super();}},ondragmove:function F(L){if(B.call(this,L)){var M=L.tgt.pos,J=L.src.pos,K=this.getMovingTarget().style,I=E.windowDim();K.left=this.left=Math.min(Math.max(this._leftPos+M.x-J.x,-this._hWidth+40),I.w-40)+"px";K.top=this.top=Math.min(Math.max(this._topPos+M.y-J.y,-this._hHeight+20),I.h-20)+"px";}if(this._super){this._super();}},ondragend:function D(I){if(B.call(this,I)){delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dnd");var w=mstrmojo.array,Y=mstrmojo.hash,t=w.fnReduceNumber;mstrmojo.vi.ui.BoxLayoutType=null;var m="c";var x="b";var a="h";var AV="v";var j={left:10,top:5,width:30,height:30},AI=5,AO=10;var Z="|";var AF=false;function M(AW){mstrmojo.all[this.hostId].buildBoxLayout(AW);}function Q(AW){var AX=this.hostId&&mstrmojo.all[this.hostId];if(AX&&AX.toggleFloatChild){AX.toggleFloatChild(AW);}}function c(AX){AX=AX||"";var AW=AX.split(Z);return{target:parseInt(AW.pop(),10),parentPathArray:AW,parentPath:AW.join(Z)};}function D(AZ,AX){if(!AZ){return undefined;}AX=AX||this.box;var AY=c(AZ),AW=AX;AY.parentPathArray.forEach(function(Ab){AW=AW.children[Ab];});var Aa=function(Ac,Ag,Ae){var Ai=Ag.children,Ab=Ai[Ac],Ah=function(Am,Ak,Al){if(Am.t===m){return mstrmojo.all[Am.id].getMinBoxSize(Ag.o)+(Al?this.padding:0);}var Aj=Am.children.map(function(An){return Ah(An,Ak,Al);});if(Am.o===Ak){return Aj.reduce(t);}return Math.max.apply(null,Aj);}.bind(this),Af=function(Ak,Am,Aj,Al){return Ak.map(function(Ao,An){return Aa(An+Am,Aj||Ag,(Al===0||Al==="0")?0:(Al||Ae));});},Ad=function(Ak){var Aj=[0,Ac];if(Ak){Aj=[Ac+1];}return Af(Array.prototype.slice.apply(Ai,Aj),Ak?Ac+1:0);};return{idx:Ac,path:(Ae||parseInt(Ae)===0)?(Ae+Z+Ac):Ac,parent:Ag,parentPath:Ae,siblings:Ai,box:Ab,getBoxLength:function(){return Ab[Ag.o==="v"?"h":"w"];},getSiblings:function(){return Af(Ai,0);},getPreviousSiblings:function(){return Ad();},getNextSiblings:function(){return Ad(true);},getMinimumBoxSize:function(Aj,Ak){return Ah(Ab,Aj,Ak);},getChildren:function(){return Af(Ab.children||[],0,Ab,this.path);}};}.bind(this);if(AW&&AW.children){return Aa(AY.target,AW,AY.parentPath);}else{return undefined;}}function X(AY,AX){var AW=mstrmojo.all[AY].getBoxConfiguration().f;return AW&&AW[AX];}function F(AW){return AW.filter(function(AX){return !AX.f;});}function i(AW){return !AW.some(function(AX){return !AX.f;});}function y(Ab,AW,Aa){if(Ab.length){var AY=Aa?0:AW,AZ=Aa?AW:0,AX=Ab[0];Ab.forEach(function(Ad){var Ac=Math.round((Ad.l/(100-AY))*AW);Ad.l+=Aa?-Ac:Ac;AZ+=Ad.l;AX=Ad;});AX.l+=100-AZ;}}function AC(AY,AX){var AW=F(AY);AX=AX||Math.round(100/(AW.length+1));y(AW,AX,true);return AX;}function G(AX,AW){y(F(AX),AW);}function I(AW){return !AW.children.some(function(AX){if(AX.t===m){return !mstrmojo.all[AX.id].getBoxConfiguration().f;}return !I(AX);});}function AH(Ab,AY){var AZ=Ab.children,AX=AZ.reduce(function(Ac,Ad){return Ad.l+Ac;},0);AZ.forEach(function(Ac){delete Ac.f;Ac.l=Math.round((Ac.l/AX)*100);});if(Ab!==this.box){Ab.f=true;Ab.l=Ab[Ab.o==="h"?"h":"w"];if(AY){var AW=D.call(this,AY),Aa=AW.box;if(i(Aa.children)){AH.call(this,Aa,AW.parentPath);}}}}function z(Ab,AX){var Ae=Ab.children,AW=0;Ae.filter(function(Af){return Af.t===m;}).forEach(function(Af){AW+=Af.l;Af.f=true;Af.l=X(Af.id,Ab.o);});F(Ae).forEach(function(Af){Af.l=Math.round(Af.l*(100/(AW||100)));});var Ac=this.box;if(Ab!==Ac){var Aa=AX&&D.call(this,AX),AZ=(Aa&&Aa.box)||Ac;if(I(AZ)){z.call(this,AZ,Aa&&Aa.parentPath);return ;}var AY=AZ.children,Ad=AY.indexOf(Ab);delete Ab.f;AY.splice(Ad,1);Ab.l=AC(AY);AY.splice(Ad,0,Ab);}}function AS(AW){if(typeof AW!=="string"){return undefined;}return parseInt(AW,10);}function AA(AW,AZ){var AX=false;var AY=AS(AW);if(AY!==undefined){AW=AY;AX=true;}return{f:AX,l:AW===undefined?100:AW,r:!!AZ};}function S(AW){return function(AX,AY){if(!!AW){AX.push(AY);}else{AX.splice(0,0,AY);}return AX;};}function o(AW){if(AF){console.log(JSON.stringify({t:AW,cfg:this.box}));}}function V(Ae,Ad,Ab,Ac){var AW=this.getNewRootBox(Ae===AV),AZ=this.box,Aa=AZ.children,AY=this.box.floatChildren,AX=Aa.length>1?Object.keys(AZ).reduce(function(Af,Ag){if(Ag!=="floatChildren"){Af[Ag]=AZ[Ag];}return Af;},{}):Aa[0];Ad.l=Ac||100/((AX?1:0)+1);if(AX){AX.l=Ac?100:50;}AW.children=Ab([AX].filter(function(Af){return Af;}),Ad);AW.floatChildren=AY;this.box=AW;}function J(AW,Ad,AZ,Aa){var Ac=this.identifier,AX=this.box,AY=AX.children,Ae={t:m,f:false,l:100,id:AW.id},Ab=S(Aa);Ae[Ac]=AW[Ac];if(I(AX)){if(Ad){Ad=0;}else{z.call(this,AX);}}Ae.f=!!Ad;if(AZ){if(AZ===AX.o){Ae.l=Ad||AC(AY);Ab(AY,Ae);}else{V.call(this,AZ,Ae,Ab,Ad);}}else{Ae.l=Ad||AC(AY);Ab(AY,Ae);}o.call(this,"addRootChild");}mstrmojo.vi.ui.BoxLayoutConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.ui.BoxLayoutConfig",identifier:"k",padding:4,hostId:"",box:null,boxTree:[],boxPaths:null,creationIndex:0,init:function AL(AW){Y.copy(AW,this);},validateBoxLayout:function E(AW,AX){AX=AX||this.box;var Aa=this.identifier,AY=function(Ad){var Ac=Ad.children,Ae=Ac.filter(function(Af){return Af.t===x;});var Ab=Ac.length;if(Ab===Ae.length&&Ab===1){return false;}return Ae.map(AY).reduce(function(Af,Ag){return Af&&Ag;},true);},AZ=function(){var Ac=AW.map(function(Ae){return Ae[Aa];}),Ad=function(Af){var Ae=[];Af.children.forEach(function(Ag){if(Ag.t===x){Ae=Ae.concat(Ad(Ag));}else{Ae.push(Ag[Aa]);}});(Af.floatChildren||[]).forEach(function(Ag){if(Ag.t==="flc"){Ae.push(Ag[Aa]);}});return Ae;},Ab=Ad(AX);return(Ab.length!==0||Ac.length===0)&&Ab.every(function(Ae){return Ac.indexOf(Ae)>-1;});}.bind(this);return AY(AX)&&AZ();},useDefaultBox:function(AZ,Ac){var AY=this.identifier,AX=Math.round(100/AZ.length),Aa=this.getNewRootBox(this.box&&this.box.o===AV),AW=0,Ab=null;Aa.children=AZ.map(function(Aj,Ag){var Ae={t:m},Af=AX,Ah=false;if(Ac){Af=Ac[Ag];var Ai=AS(Af);if(Ai!==undefined){Af=Ai;Ah=true;}}if(!Ah){AW+=Af;Ab=Ae;}Ae.l=Af;Ae.f=Ah;Ae[AY]=Aj[AY];return Ae;});if(Ab){var Ad=100-AW;if(Ad){Ab.l+=Ad;}}this.box=Aa;return Aa;},getNewRootBox:function f(AW){return{t:x,o:AW?AV:a,children:[],floatChildren:[]};},getDefaultFloatLayout:function AQ(AW){var AX=(this.creationIndex%AO)*AI;this.creationIndex++;return{width:j.width+"|200",height:j.height+"|200",left:j.left+AX+"|0px",fixed:0,top:j.top+AX+"|0px",k:AW.k,rk:AW.parent&&AW.parent.k,zIndex:(this.box.floatChildren.length+2),t:"flc"};},buildBoxTree:function e(AW){var AX={},AZ={},AY=this.boxTree=[],Aa=this.box.floatChildren;if(!Aa){return ;}Aa.forEach(function(Ab){(AX[Ab.rk]=AX[Ab.rk]||[]).push(Ab.k);AZ[Ab.rk]=(AZ[Ab.rk]||0);AZ[Ab.k]=(AZ[Ab.k]||0)+1;});Object.keys(AZ).forEach(function(Ab){if(!AZ[Ab]){var Ac=this.getBoxTreeRoots(AW,Ab);Ac.k=Ab;Ac.children=[];AY.push(Ac);}},this);this.buildHelper(AY,AX,Aa);},buildHelper:function R(AW,AX,AY){AW.forEach(function(AZ){(AX[AZ.k]||[]).forEach(function(Aa){var Ab=Y.copy(AY[w.find(AY,"k",Aa)]);Ab.children=[];AZ.children.push(Ab);});this.buildHelper(AZ.children,AX,AY);},this);},getBoxTreeRoots:function P(AW,AX){var AY=AX===AW.k?AW.domNode.style:AW.getUnitByKey(AX).domNode.style,AZ=["left","top","width","height"].reduce(function(Ab,Ac,Aa){Ab[Ac]=Aa&2?parseFloat(AY[Ac])-(AW.panelPadding*2||0):AY[Ac];return Ab;},{});if(AX===AW.k){Y.copy({left:0,top:0},AZ);}return AZ;},newObjInBoxTree:function W(AY){var AX=AY.domNode.style,AW=this.boxTree;return AW[AW.push({left:AX.left,top:AX.top,width:parseFloat(AX.width),height:parseFloat(AX.height),k:AY.k,children:[]})-1];},findTargetNodeInBoxTree:function AM(AZ,AW){var AY;for(var AX=0;AX<AW.length;++AX){if(AW[AX].k===AZ.k){return AW[AX];}AY=this.findTargetNodeInBoxTree(AZ,AW[AX].children);if(AY){return AY;}}},findTargetParentInBoxTree:function O(AZ,AW){var AY;for(var AX=0;AX<AW.length;++AX){if(AW[AX].children.length&&AW[AX].children.find(function(Aa){return Aa.k===AZ.k;})){return AW[AX];}AY=this.findTargetParentInBoxTree(AZ,AW[AX].children);if(AY){return AY;}}},moveBoxToRelative:function d(AZ,AW){var AY=this.boxTree,AX=this.findTargetParentInBoxTree(AZ,AY),Aa=AX.children.splice(w.find(AX.children,"k",AZ.k),1)[0];(this.findTargetNodeInBoxTree(AW,AY)||this.newObjInBoxTree(AW)).children.push(Aa);this.updateAttrInFloatChildren(AZ,AW,Aa);},updateAttrInFloatChildren:function u(Aa,AX,Ac){if(this.findFloatKey(Aa)){var Ab=this.box.floatChildren,AW=Ab[w.find(Ab,"k",Aa.k)],AY=AX.domNode.style,AZ=Aa.domNode.style;[AW,Ac].forEach(function(Ad){Y.copy(["left","top","width","height"].reduce(function(Ag,Ai,Af){var Ah=parseFloat(AZ[Ai]),Ae=parseFloat(AY[Ai])||0;Ag[Ai]=Af&2?Ah/Ae*100+"|"+Ah:(Ah-Ae)/(Af?parseFloat(AY.height):parseFloat(AY.width))*100+"|"+(Ah-Ae)+"px";return Ag;},{}),Ad);});AW.rk=AX.k;}},addFloat:function AN(AW){(this.box.floatChildren=this.box.floatChildren||[]).push(this.getDefaultFloatLayout(AW));},updateNodeInBoxTree:function AP(AY){var AX=this.findTargetNodeInBoxTree(AY,this.boxTree),AZ=this.box.floatChildren,AW=AZ[w.find(AZ,"k",AY.k)];if(AX){Y.copy(AW,AX);}else{throw new Error("cannot find box in box tree");}},updateFloatLayout:function AD(Ac,Ab,AX){var Ad=this.box.floatChildren,AW=w.find(Ad,this.identifier,Ab.k);if(AW!==-1){var AZ=Ad[AW],AX=AX||this.getBoxTreeRoots(Ab.model.getPanel(),AZ.rk),AY=parseFloat(AX.height),Aa=parseFloat(AX.width);["left","top","width","height"].forEach(function(Ag,Ai){var Af=Ac&&Ac[Ag],Ah=parseFloat(Ab.domNode.style[Ag]),Ae=parseFloat(AX[Ag]),Aj=Af?parseFloat(Af):Ah;if(Ai&2){AZ[Ag]=Aj/Ae*100+"|"+Aj;}else{AZ[Ag]=(Aj-Ae)/(Ai?AY:Aa)*100+"|"+(Aj-Ae)+"px";}});AZ.fixed=Ab.fixed;this.updateNodeInBoxTree(Ab);}},addNewChild:function g(AY,AX,Aa,AZ){var AW=AA(AX,AZ);AW.t=m;AW[this.identifier]=Aa;AY.children.push(AW);},getBoxState:function q(){return JSON.parse(JSON.stringify(this.box));},getResizeBoundaries:function AT(Aa,AY){var AX={min:0,max:0},AW=function(Ac,Ab){if(!Ab){return ;}Ab.getPreviousSiblings().forEach(function(Ad){AX.min+=Ad.getMinimumBoxSize(AY,true);});Ab.getNextSiblings().forEach(function(Ad){AX.max+=Ad.getMinimumBoxSize(AY,true);});Ac.pop();Ac.pop();AW(Ac,D.call(this,Ac.join(Z)));}.bind(this);var AZ=D.call(this,Aa);AX.min+=AZ.getMinimumBoxSize(AY,true)-this.padding;AW(Aa.split(Z),AZ);return AX;},resizeBox:function AK(Aa,Ab){var AW=0,Ac=1,AZ=2,AY=function(Af,An,Al,Aj){var Ah=Math.abs(Al),Ag,Ak,Ai;Ai=Al=-Ah;Ag=Af.map(function(Ao){return Ao.box.l;}).reduce(t,0);if(Ag===0){Ag=100;}Af.forEach(function(Ar){var Aq=Ar.box,As=Ar.getBoxLength(),Ao=0;if(Al){Ak=!Aq.f?(Ai*Aq.l/Ag):Ai/Af.length;var Ap=Math.max(As+Ak,Ar.getMinimumBoxSize(Ar.parent.o,false));Ao=As-Ap;Al+=Ao;As=Ap;}Aj.push({idx:Ar.idx,l:As,f:Ar.box.f,d:-Ao});});var Am={};Ag=An.map(function(Ao){return Ao.box.l;}).reduce(t,0);if(Ag===0){Ag=100;}An.forEach(function(Aq,Ao){var Ap=Aq.getMinimumBoxSize(),Ar=Aq.getBoxLength();if(Ar<Ap&&Ah>0){Am[Ao]=Math.min(Ap-Ar,Ah);Ah-=Am[Ao];}});An.forEach(function(Ar,Ap){var Aq=Ar.box,Ao=0,As=Ar.getBoxLength();if(Am[Ap]){As+=Am[Ap];}Ak=!Aq.f?(Ah*Aq.l/Ag):Ah/An.length;Ao=Ak;As+=Ao;Aj.push({idx:Ar.idx,l:As,f:Ar.box.f,d:Ao});});return Al;},AX=function(Ag,Af,Ah){var Aj=D.call(this,Ag),Ak=Aj.getPreviousSiblings().concat(Aj),Ai=Ak,Al=Aj.getNextSiblings();Ak.reverse();if(Af>=0){Ai=Al;Al=Ak;}return AY(Ai,Al,Af,Ah);},Ad=function(Ag,Af){return function(Ai,Ah,Aj){var Al=D.call(this,Ai),Am=Al.getSiblings(),Ak=Am,An=[];if(Ag){Am.reverse();}if(Af){Ak=[];An=Am;}return AY(Ak,An,Ah,Aj);};},Ae=function(Aj,Am,Al,Af){var Ai=D.call(this,Aj);if(!Ai){return ;}var Au=Ai.idx,Ap=Ai.getSiblings(),Ak=[],As=Al.call(this,Aj,Am,Ak),Aq=0,Ar=0,Ao=0,Ah=false;var Ag=Ak.filter(function(Av){return !Av.f;}),An=Ag.map(function(Av){return Av.l;}).reduce(t,0);Ag.forEach(function(Av){Av.l=(Av.l/An)*100;Aq=Av.d;Ar=Aq?(Aq<0?-1:1):0;if(!Ah&&!Ao){Ah=true;Ao=Ar;}if(Ao!==Ar){Ah=false;}});Ak.forEach(function(Ax){var Az=Ax.idx,Aw=Ap[Az],Av=Ax.d;if(Av!==0&&(Af!==AZ||Az!==Au)){var Ay=Ad(Az<Au,Av>0);Aw.getChildren().forEach(function(A0){if(A0.box.t===x){Ae(A0.path+Z+"0",Av,Ay,Ac);}});}if(!Ah||Ax.f){Aw.box.l=Ax.l;}});if(Af!==Ac&&As){var At=Aj.split(Z);At.pop();At.pop();if(At.length){Ae(At.join(Z),Am<0?As:-As,AX,AZ);}}}.bind(this);Ae(Aa,Ab,AX,AW);},insertNewRootChild:function AU(Aa,AZ,AY){var AW=Aa.getBoxConfiguration();if(!this.box.children.length){delete AW.f;}var AX=AW.o,Ab=AW.addToEnd;if(AZ){AX=AZ==="Left"||AZ==="Right"?"h":"v";Ab=AZ==="Right"||AZ==="Bottom";}if(AY||!this.box.floatChildren||!this.box.floatChildren.length){J.call(this,Aa,(AW.f&&AW.f[AX])||0,AX,Ab);}else{this.addFloat(Aa);}},insertExistingRootChild:function b(Aa,Ab){var AX=Aa.src.widget,AZ=Aa.box.oldPathInfo,AW=AX.getBoxConfiguration(),AY=Ab==="Left"||Ab==="Right"?"h":"v",Ac=(AW.f&&AW.f[AY])||0;if(Ac&&AZ.parent.o===AY){Ac=AZ.box.l;}J.call(this,AX,Ac,AY,Ab==="Right"||Ab==="Bottom");Aa.dropSuccessful=true;},getBoxOrientation:function U(AX){var AW=D.call(this,AX);return AW&&AW.parent&&AW.parent.o;},getBoxPath:function AE(AW){return this.boxPaths[AW[this.identifier]];},deleteBox:function l(AW,Ar,At){var Aq=D.call(this,this.getBoxPath(AW));if(!Aq){var AY=this.box.floatChildren,Ap=w.find(AY,this.identifier,AW.k);if(Ap!==-1){w.removeItem(AY,AY[Ap]);this.changeIndex(Ap,false);if(!Ar){M.call(this,true);}}return ;}if(!At){var Al=this.boxTree,Ad=this.findTargetNodeInBoxTree(AW,Al);if(Ad){var Ag=AW.parent;Ad.children.forEach(function(Ay){var Ax=Ag.getUnitByKey(Ay.k);this.moveBoxToRelative(Ax,Ag);},this);var AZ=this.findTargetParentInBoxTree(AW,Al);if(AZ){AZ.children.splice(w.find(AZ.children,"k",AW.k),1);}}}var Ak=Aq.box,Au=Aq.idx,Aa=Aq.parent,Ae=Aq.parentPath,Ai=D.call(this,Ae),Af=Aq.siblings;Af.splice(Au,1);if(Af.length>1){if(i(Af)){AH.call(this,Aa,Ae);}else{if(!Ak.f){G(Af,Ak.l);}}}else{var Av=Af[0],Ac=Av&&(Av.t===x),Aw=Av&&Av.f;if(Ai){var Ah=Ai.parent,Ao=I(Ah),Aj=[];if(Ac){Aj=Av.children;if(Ao){z.call(this,Ah,c(Ah.parentPath).parentPath);}if(Aw){var Am=Av.ps,As;Aj.forEach(function(Ax){Ax.f=true;if(Am){As=Math.round((Ax.l/100)*Am);}else{As=Ax[Av.o==="v"?"h":"w"];}Ax.l=As;});}else{F(Aj).forEach(function(Ax){Ax.l=Math.round((Ax.l/100)*Aa.l);});}}else{Aj.push(Av);var AX=X(Av.id,Ah.o);if(!Ao&&AX){Aw=Av.f=true;}if(Aw){Av.l=AX;}else{Av.l=Aa.l;}}var An=Ah.children;An.splice.apply(An,[Ai.idx,1].concat(Aj));}else{var Ab=this.box;if(Ac){Ab.children=Av.children;Ab.o=Av.o;if(Aw){AH.call(this,Ab);}}else{if(Av){delete Av.f;Av.l=100;}}}}o.call(this,"delete");if(!Ar){M.call(this,true);}else{mstrmojo.all[this.hostId].updateBoxPaths();}},changeIndex:function s(AW,AX){w.forEach(this.box.floatChildren,function(AZ,AY){if(!AX&&AY>=AW){AZ.zIndex--;}else{if(AX&&AY<AW){AZ.zIndex++;}}});},findFloatKey:function k(AX){var AW=AX.k||AX;return mstrmojo.array.find(this.box.floatChildren,this.identifier,AW)!==-1;},findIdx:function C(AX){if(!this.findFloatKey(AX)){return NaN;}var AY=this.box.floatChildren,AW=mstrmojo.array.find(AY,this.identifier,AX.k);return{index:AW,maxIndex:AY.length-1};},refreshToolbar:function B(AX){var AW=AX.parent;var AY=AW.boxLayoutConfig.box.floatChildren;AY.forEach(function(AZ){AW.getUnitByKey(AZ.k).generateToolbar();});},bringToFront:function n(AY){if(!this.findFloatKey(AY)){return ;}var AZ=this.box.floatChildren,AX=mstrmojo.array.find(AZ,this.identifier,AY.k),AW=Y.copy(AZ[AX]);this.changeIndex(w.removeItem(AZ,AZ[AX]),false);AW.zIndex=AZ.length+2;AZ.push(AW);this.refreshToolbar(AY);return(AX!==AZ.length-1);},bringForward:function AR(AW){if(!this.findFloatKey(AW)){return ;}return this.swapBoxPosition(AW,true);},updateZ:function N(){this.box.floatChildren.forEach(function(AX,AW){AX.zIndex=AW+2;});},swapBoxPosition:function AB(AZ,AX){var Aa=this.box.floatChildren,AW=mstrmojo.array.find(Aa,this.identifier,AZ.k),AY=AX?AW+1:AW-1;if((AX&&AY===Aa.length)||(!AX&&AY<0)){return false;}Aa[AW]=Aa.splice(AY,1,Aa[AW])[0];this.updateZ();this.refreshToolbar(AZ);return true;},sendToBack:function L(AY){if(!this.findFloatKey(AY)){return ;}var AZ=this.box.floatChildren,AX=w.find(AZ,this.identifier,AY.k),AW=Y.copy(AZ[AX]);this.changeIndex(w.removeItem(AZ,AZ[AX]),true);AW.zIndex=2;AZ.unshift(AW);this.refreshToolbar(AY);return(AX!==0);},sendBackward:function H(AW){if(!this.findFloatKey(AW)){return ;}return this.swapBoxPosition(AW,false);},beginBoxMove:function h(AX,AZ,Ad){if(this.findFloatKey(AZ)){AZ.parent.turnMask();var Ae=AZ.parent.parentRect||AZ.domNode.parentNode.getBoundingClientRect();AX.box={initState:this.getBoxState(),boxId:AZ.id,startX:AX.last.x,startY:AX.last.y,originX:parseFloat(AZ.domNode.style.left),originY:parseFloat(AZ.domNode.style.top),minX:Ae.left,maxX:Ae.right,minY:Ae.top,maxY:Ae.bottom,parentRect:Ae};AZ.preBoxOp();var Aa=document.createElement("div");for(var AY=0;AY<6;++AY){var AW=document.createElement("div");AW.style.position="fixed";["left","top","width","height"].forEach(function(Af){AW.style[Af]=AY>2?Af!=="height"?Ae[Af]+"px":"1px":Af!=="width"?Ae[Af]+"px":"1px";});Aa.appendChild(AW);}Aa.style.zIndex="3";Aa.style.position="absolute";AZ.toggleGuidesDiv(Aa,true);AX.highLight=Aa;AX.delay=1;AX.floatIndex=AZ.domNode.style.zIndex;}else{var Ac=D.call(this,this.getBoxPath(AZ)),Ab;if(Ac){Ab=Ac.box;}Q.call(this,false);AX.box={initState:this.getBoxState(),oldPathInfo:Ac,boxId:AZ.id,parentPath:Ac.parentPath,length:Ab.l,orientation:Ac.parent.o};if(!Ad){this.deleteBox(AZ,null,true);}}},addDropBox:function A(Ag,Af,Ac){var Ae=(Af==="Right"||Af==="Bottom"),Ai=(Af==="Top"||Af==="Bottom")?AV:a,Aw=this.identifier,Ab=D.call(this,this.getBoxPath(Ag)),Aj=Ab.idx,Am=Ab.parent,Ap=Ab.siblings,As=Ab.parentPath,At=I(Am),Al=Am.f,AY=Ac.box,AZ=AY.boxId,Au=mstrmojo.all[AZ],Ao=Au.getBoxConfiguration(),Av=Ao.f&&Ao.f[Ai],Aa=Au.getMinBoxSize(Ai),An=X(Ag.id,Ai),Aq=Ag.getMinBoxSize(Ai),AW=AY.length,AX={t:m,f:!!Av,l:Av,id:AZ,r:!!Ao.r};AX[Aw]=Au[Aw];if(Av&&AY.orientation===Ai){Av=AW;}if(!Av&&At){z.call(this,Am,c(As).parentPath);Al=false;}if(Ai===Am.o){if(Av){if(At){delete AX.f;Av=undefined;}}if(As!==AY.parentPath){AW=undefined;}AX.l=Av||AC(Ap,AW);Ap.splice(Ae?Aj+1:Aj,0,AX);}else{if(Am===this.box&&Ap.length===1){V.call(this,Ai,AX,S(Ae),Av);}else{var Ar=Ab.box,Ah=Ar.f;var Ak={l:Ar.l,f:Ah,o:Ai,t:x};var Ad=Ak.children=[AX,Ar];Ap.splice(Aj,1);if(Ae){Ad.reverse();}if(Al){if(Av){if(An){Am.l=Math.max(Am.l,Av+An);AX.l=Ar.l=50;delete AX.f;delete Ar.f;}else{Am.l=Math.max(Am.l,Av+Aq);AX.l=Av;Ar.l=100;}}else{if(An){AX.l=100;Ar.l=An;Am.l=Math.max(Am.l,Aa+An);}else{Am.l=Math.max(Am.l,Aa+Aq);AX.l=Ar.l=50;}}}else{if(Av&&Ah){Ak.h=Ar.h;Ak.w=Ar.w;AX.l=Av;Ar.l=An;AH.call(this,Ak,As);}else{if(Av){AX.l=Av;Ar.l=100;}else{if(An){Ar.l=An;AX.l=100;if(!Ak.f){Ak.l=AC(Ap,null);}}else{Ar.f=false;Ar.l=100;AX.l=AC([Ar]);}}}}Ap.splice(Aj,0,Ak);}}Au.postDropBox();o.call(this,"drop");Q.call(this,true);M.call(this);Ac.dropSuccessful=true;},cancelBoxMove:function p(AW){if(mstrmojo.array.find(this.box.floatChildren,this.identifier,(AW.src.widget||[]).k)!==-1){AW.src.widget.parent.turnMask();if(AW.highLight){var AX=AW.src.widget;AX.toggleGuidesDiv(AW.highLight,false);delete AW.highLight;AX.parent.snapGuide.boxIntervalOperations(AX,"insert");}}Q.call(this,true);this.revertBoxState(AW.box.initState);},revertBoxState:function AG(AW){this.box=Y.copy(AW);M.call(this);},getBoxChildClass:function K(AW){var AY=AW.id,AX=AY&&mstrmojo.all[AY];if(AX){return AX.scriptClass;}return"";},replaceLayoutXmlKeys:function AJ(AY){var AX=false;var AW=function(Af){if(!Af){return ;}var AZ=Af.children,Ac=AZ&&AZ.length,Ab;for(Ab=0;Ac&&Ab<Ac;Ab++){var Ad=AZ[Ab];switch(Ad.t){case x:AW(Ad);break;case m:var Ah=Ad.k,Ag=AY[Ah]||AY["default"],Ai=mstrApp?mstrApp.primaryScdpMap:null,Aa=(Ai&&Ai[Ag])||[];var Ae=w.indexOf(Aa,Ah)!==-1;if(Ag&&!Ae){Ad.k=Ag;AX=true;}break;}}};AW(this.box);return AX;}});mstrmojo.vi.ui.BoxLayoutConfig.getMinimumChildSizes=function(AY,AZ,Aa){var AX=Aa.getBoxChildClass(AY);if(!AX){throw"BoxLayoutConfig::getMinimumChildSizes - unable to obtain script class for box.";}var AW=mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums(AX);if(AY.f){AW[AZ]=AY.l;}return AW;};mstrmojo.vi.ui.BoxLayoutConfig.BoxInfoType=null;mstrmojo.vi.ui.BoxLayoutConfig.BoxAddContextType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.vi.enums.EnumFilterClearActionType","mstrmojo.vi.enums.EnumVisFilterType");var D=mstrmojo.array,M=mstrmojo.string,H=mstrmojo.vi.enums.EnumFilterClearActionType,J=mstrmojo.vi.enums.EnumVisFilterType;mstrmojo.vi.ui.rw._SupportViewFilterInVizBox=mstrmojo.provide("mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",{_mixinName:"mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",getSelectorObjectsFromTemplateLimit:function N(){return this.getSelObjsFromTemlateLimitHandler();},getSelectorObjectsFromViewFilter:function B(){return this.getSelObjsFromVFHandler();},getSelObjsFromVFHandler:function F(){var R=this,P=R.model,Q=R.node.data,S=Q&&Q.vfexpr;return P&&P.getSelectorDataFromViewFilter(S);},getSelObjsFromTemlateLimitHandler:function K(){var R=this,P=R.model,Q=R.node.data,S=Q&&Q.tpl;return P&&P.getSelectorDataFromTemplateLimit(S);},makeBold:function C(P){return"<span style='font-weight:bold;'>"+P+"</span>";},getSelectorExpr:function I(U,S){var V=[],W="",R=true,Q=U.keepOnly?"##":mstrmojo.desc(13232,"Not ##"),P,X=mstrmojo.desc(5283,"OR");if(S){X=this.makeBold(X);}U.data.every(function(Y){[].concat(Y).every(function(Z){if(W===""){W=Z.tn;}return(R=(W===Z.tn));});return R;});U.data.forEach(function(a,Y){if(Y>0){V.push(X);}var Z=[];[].concat(a).forEach(function(d){var c=S?M.encodeHtmlString(d.v):d.v,b=S?M.encodeHtmlString(d.tn):d.tn;Z.push((R?"":(b+" = "))+(c||mstrmojo.desc(14323,"NULL")));});V.push(Z.join(" "));});if(V.length>0){P=Q.replace("##",(R?(S?M.encodeHtmlString(W):W)+" = ":"")+V.join(" "));}return P;},getLinkingSelectorExpr:function O(S,R){var U=[],V="",Q=true,W=mstrmojo.desc(5283,"OR"),P=S.keepOnly?"##":mstrmojo.desc(13232,"Not ##");if(R){W=this.makeBold(W);}S.data.every(function(X){[].concat(X).every(function(Y){if(V===""){V=Y.tn;}return(Q=(V===Y.tn));});return Q;});S.data.forEach(function(Z,X){var Y=[];if(Q){if(X>0){Y.push(W);}else{Y.push(P.replace("##",V+" = "));}}[].concat(Z).forEach(function(c){var b=R?M.encodeHtmlString(c.v):c.v,a=R?M.encodeHtmlString(c.tn):c.tn;Y.push((Q?"":(a+" = "))+(b||mstrmojo.desc(14323,"NULL")));});U.push(Y.join(" "));});return U.join(" ");},getFilterMenuPairs:function G(P){var R=this,S=[],Q=mstrmojo.desc(2827,"Clear");if(P instanceof Array){P.forEach(function(X,W){var V=R.getSelectorExpr(X),U=R.getSelectorExpr(X,true);S.push({menuString:Q+' "'+V+'"',menuTtpString:Q+' "'+U+'"',ctxt:W,isBranch:X.isBranch});});}return S;},filterMenuHandler:function L(P,S){var R=this,Q=R.controller;switch(P.type){case H.CLEAR_KEEP_ONLY:P=P.idx;Q.applyKeepOnly(R,S,undefined,P,false);break;case H.CLEAR_ALL:Q.clearFiltersForVis(R,[J.KEEP_ONLY,J.LINKING,J.DRILLING],S);break;case H.CLEAR_ADV_QUALIFICATION:Q.clearFiltersForVis(R,[J.ADV_QUALIFICATION],S);break;case H.CLEAR_KEEP_ONLY_AND_LINKING:Q.clearFiltersForVis(R,[J.KEEP_ONLY,J.LINKING],S);break;case H.CLEAR_LINKING:Q.clearLinkingFilter(P,S);break;case H.CLEAR_DRILLING:Q.clearFiltersForVis(R,[J.DRILLING],S);break;default:break;}},hasKeepOnly:function E(P){return P===null||P.length>0;},getSelectorDataForKeepOnly:function A(Q,V){var S=this,R=S.model,U=S.model.data||S.node.data,P=U.tpl,W;if(V===-1){W=[];}else{W=[].concat(R.getSelectorDataFromTemplateLimit(P));if(V===-2){W=D.filter(W,function(X){return !X.keepOnly;});}else{if(V>=0){W.splice(V,1);}}}if(Q){W=W.concat(Q);}return W;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var X=mstrmojo.dom,L=mstrmojo.string,b=mstrmojo.array;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:X.isNSIE?"block":"table",DISPLAY_CELL:X.isNSIE?"block":"table-cell",MINHEIGHT:X.isIE6?"height":"minHeight",addClass:function M(j,h){if(j){if(h.constructor!==Array){h=[h];}var e=j.className||"",l=" "+e+" ",f=false,d=h.length,g;for(g=0;g<d;g++){var k=h[g];if(!l.match(new RegExp("\\s"+k+"\\s"))){e+=" "+k;f=true;}}if(f){j.className=L.trim(e);}}return j;},removeClass:function O(g,f){if(!g){return ;}if(f.constructor!==Array){f=[f];}var d=" "+(g.className||"")+" ",c=f.length,e;for(e=0;e<c;e++){d=d.replace(new RegExp("\\s"+f[e]+"\\s","g")," ");}g.className=L.trim(d);},addWidgetCssClass:function N(h,f){var d=h.cssClass,g=(d&&d.split(" "))||[],e;f=[].concat(f);for(e=0;e<f.length;e++){var c=f[e];if(b.indexOf(g,c)===-1){g.push(c);}}h.cssClass=g.join(" ");},removeWidgetCssClass:function G(j,g){var d=j.cssClass,h=(d&&d.split(" "))||[],f;g=[].concat(g);for(f=0;f<g.length;f++){var c=g[f];var e=b.indexOf(h,c);if(e!==-1){h.splice(e,1);}}j.cssClass=h.join(" ");},toggleClass:function W(e,d,c){if(c){this.addClass(e,d);}else{this.removeClass(e,d);}},hasClass:function A(e,f){if(e){var d=" "+(e.className||"")+" ";return !!d.match(new RegExp("\\s"+f+"\\s"));}return false;},applyShadow:function H(g,h,f,e,c){var d=g.style;if(X.isDXIE){d.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+h+"px, OffY="+f+"px, Color='"+c+"')";}else{if(X.isFF||X.isWK||X.isIE10){d[X.CSS3_BOXSHADOW]=h+"px "+f+"px "+e+"px "+c;}}},removeShadow:function C(d){var c=d.style;if(X.isFF||X.isWK||X.isIE10){c[X.CSS3_BOXSHADOW]="";}},setOpacity:function Y(d,f){if(X.isDXIE&&!X.isIE9){var g=d.currentStyle.filter;var c=null;if(g.length>0){c=d.filters["DXImageTransform.Microsoft.Alpha"];}if(c){c.opacity=f;c.enabled=(f!==100);}else{if(f<100){var e="progid:DXImageTransform.Microsoft.Alpha(Opacity="+f+")";d.style.filter=(g||"")+" "+e;}}}else{d.style.opacity=f/100-(X.isIE9?0.00001:0);}},buildGradient:function P(d,f,c){if(X.supports(X.cssFeatures.GRADIENTS)){var e={};if(X.isDXIE){e.n="filter";e.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+d+",StartColorStr='"+f+"',EndColorStr='"+c+"')";}else{if(X.isFF){e.n="background-image";e.v="-moz-linear-gradient("+((d===0)?"top":"left")+","+f+","+c+")";}else{if(X.isIE10||X.isIEW3C||X.isIE11||X.isEdge||X.isWK){e.n="background";e.v="linear-gradient("+((d===0)?"to bottom":"to right")+","+f+","+c+")";}}}return e;}return null;},buildRoundCorners:function R(h,g){if(X.supports(X.cssFeatures.ROUND_CORNERS)){var d=h+"px";var k=d+(g?" "+d+" 0 0":"")+";";if(X.isFF||X.isWinPhone||X.isIE10){return"border-radius:"+k;}if(X.isWK){if(!g){return"-webkit-border-radius:"+d+";";}var j=["left","right"],f=[],c=-1,e;for(e=0;e<2;e++){f[++c]="-webkit-border-top-"+j[e]+"-radius:"+d;f[++c]="-webkit-border-bottom-"+j[e]+"-radius:0";}return f.join(";");}}return"";},getBorderWidthsOrPaddings:function E(d,g){var h={t:0,r:0,b:0,l:0,h:0,w:0};if(!d){return h;}var e=d.split(" "),c=e.length,f;for(f=0;f<c;f++){e[f]=Math.round(g*parseFloat(e[f])/72);}if(c<4){if(c===1){e[1]=e[2]=e[3]=e[0];}else{e[3]=e[1];if(c===2){e[2]=e[0];}}}h.t=e[0];h.r=e[1];h.b=e[2];h.l=e[3];h.h=h.t+h.b;h.w=h.l+h.r;return h;},getBorderWidths:function I(d,c){return this.getBorderWidthsOrPaddings(d,c);},getPaddings:function D(d,c){return this.getBorderWidthsOrPaddings(d,c);},parkAfterFade:function B(c){var d=c.target.style;if(d.opacity===0){d.left="-10000px";window.setTimeout(function(){d.opacity=0.99;},0);return true;}return false;},getStyleValue:function J(c,g){var e=(g==="float"),f;if(c.currentStyle){g=e?"styleFloat":g;f=c.currentStyle[g];}else{if(document.defaultView&&document.defaultView.getComputedStyle){g=e?"cssFloat":g;var d=document.defaultView.getComputedStyle(c,null);f=d?d[g]:null;}}return f;},getComputedStyle:function V(c,e){var d=(window.getComputedStyle)?function(f,g){return window.getComputedStyle(f,g||null);}:function(f){return f.currentStyle||{};};mstrmojo.css.getComputedStyle=d;return d(c,e);},getCssTextFromObj:function F(e){var d="",c;for(c in e){d+=c+":"+e[c]+";";}return d;},onTransitionEnd:function a(e,c){var d="transition",f=window.Modernizr;if(f.testProp(d)){X.attachOneTimeEvent(e,X.transEndEvtNames[f.prefixed(d)],c);}else{window.setTimeout(c,0);}},onAnimationEnd:function U(e,c){var d="animation",f=window.Modernizr;if(f.testProp(d)){X.attachEvent(e,X.animationEndEvtNames[f.prefixed(d)],c);}else{window.setTimeout(c,0);}},flashClass:function Q(d,c,f){this.toggleClass(d,c,true);var e=this;window.setTimeout(function(){e.toggleClass(d,c,false);},f);},convertCssToCamelCase:function K(c){return c.replace(/\-([a-z])/gi,function(d,e){return e.toUpperCase();});},printCSSInfo:function Z(g){var m=document.styleSheets,p=m.length,h,k;for(k=0;k<p;k++){var l=m[k],n=l.cssRules,e=n?n.length:0,o=0;for(h=0;h<e;h++){var c=n[h].selectorText;if(c){try{o+=c.split(",").length;}catch(f){}}}var d=l.href;if(!g||(d&&d.indexOf(g)>-1)){console.log("Stylesheet: "+d||"Inline CSS Block");console.log("Total rules: "+e);console.log("Total selectors: "+o);}}},cssEscape:function S(i){if(arguments.length===0){throw new TypeError("`CSS.escape` requires an argument.");}var f=String(i),h=f.length,e=-1,g,c="",d=f.charCodeAt(0);while(++e<h){g=f.charCodeAt(e);if(g==0){c+="\uFFFD";continue;}if((g>=1&&g<=31)||g==127||(e==0&&g>=48&&g<=57)||(e==1&&g>=48&&g<=57&&d==45)){c+="\\"+g.toString(16)+" ";continue;}if(e==0&&h==1&&g==45){c+="\\"+f.charAt(e);continue;}if(g>=128||g==45||g==95||g>=48&&g<=57||g>=65&&g<=90||g>=97&&g<=122){c+=f.charAt(e);continue;}c+="\\"+f.charAt(e);}return c;}});}());(function(){mstrmojo.requiresCls("mstrmojo.base64","mstrmojo.func","mstrmojo.hash","mstrmojo.string","mstrmojo.dom");mstrmojo.XhrCallbackType=null;function decodeHeader(value){var rEncoded=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(value&&value.indexOf("=?UTF-8?B?")===0){var decMsg="",result;while((result=rEncoded.exec(value))!==null){decMsg+=mstrmojo.base64.decode(result[1]);}return decMsg;}return value;}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){url[++x]=p+"="+encodeURIComponent(params[p]);}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function sendXhr(xhr,method,baseUrl,params){method=method.toUpperCase();var app=mstrApp,m=window.microstrategy;if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);params.taskContentType=params.taskContentType||"json";params.taskEnv=params.taskEnv||"xhr";params.xts=new Date().getTime();params[mstrApp.name]=mstrApp.servletState||mstrConfig.servletState||"";baseUrl=baseUrl||mstrConfig.taskURL;}var ptp=app.persistTaskParams||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}xhr.open(method,appendUrlParams(method,baseUrl,params),this.async);var headers=params.xhrHeaders;if(headers){for(var hdr in headers){xhr.setRequestHeader(hdr,headers[hdr]);}delete params.xhrHeaders;}if(method!=="POST"){xhr.send(null);}else{xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(encodeParams(params));}if(this.async===false){xhr.onreadystatechange();}}function createXhr(){var methods=[function(){var res=new XMLHttpRequest();var foo=res.open;res.open=function(){foo.apply(res,arguments);};return res;},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}],cnt=methods.length,i;for(i=0;i<cnt;i++){var xhr;try{xhr=methods[i]();}catch(e){continue;}createXhr=methods[i];return xhr;}throw new Error("mstrmojo.SimpleXHR: Could not create an XHR object.");}function evalResponse(rt){var rtn=null;try{try{rtn=JSON.parse(rt);}catch(ex){rtn=eval("("+rt+")");}}catch(ex){rtn=rt&&mstrmojo.string.trim(rt);}return rtn;}var MSI_SERVER_NAME_NOT_INITIALIZED=2147760371,MSI_INVALID_SESSION_ID=2147760372,E_MSI_USERMGR_USER_NOTFOUND=2147758245,E_MSI_CONNECT_FAILED=2147759877;function isSessionExpiredError(res){if(res.status===401){return true;}var c=res&&res.getResponseHeader("X-MSTR-TaskErrorCode");c=(c<0)?(4294967296+parseInt(c,10)):c;switch(c){case MSI_SERVER_NAME_NOT_INITIALIZED:case MSI_INVALID_SESSION_ID:case E_MSI_USERMGR_USER_NOTFOUND:case E_MSI_CONNECT_FAILED:return true;}return false;}function xhrSupportsProgress(xhr){return !mstrmojo.dom.isSafari&&!!(xhr&&xhr.upload&&xhr.upload.onprogress);}mstrmojo.SimpleXHR=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.SimpleXHR",isTask:true,async:true,init:function init(props){mstrmojo.hash.copy(props,this);},onreadystatechange:function onreadystatechange(xhr,callback,prevRequest){if(xhr.readyState!==4){return ;}if(typeof callback!=="object"){return ;}try{if((xhr.status===200)||(xhr.status===304)){this.response=callback.textResponse?xhr.responseText:evalResponse(xhr.responseText);if(typeof callback.success==="function"){callback.success(this.response,xhr);}}else{if(xhr.status!==0||(!xhr.isAborted&&prevRequest.params.displayNoResErr)){var app=mstrApp,sessionExp=app&&app.onSessionExpired;if(sessionExp&&isSessionExpiredError(xhr)){sessionExp.call(app,prevRequest);}else{var orig=xhr.getResponseHeader;xhr.getResponseHeader=function(name){return decodeHeader(orig.apply?orig.apply(xhr,[name]):orig(name));};if(typeof callback.failure==="function"){callback.failure(xhr);}}}}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(typeof callback.complete==="function"){callback.complete();}if(!isSessionExpiredError(xhr)&&!prevRequest.params.notRestartSessionManager){var sm=mstrApp.sessionManager;if(sm&&sm.restart){sm.restart();}}}},cancel:function(){var didCancel=false;var xhr=this.xhr;if(xhr){delete xhr.onreadystatechange;xhr.isAborted=true;if(xhr.readyState<4){xhr.abort();didCancel=true;}this.xhr=null;}return didCancel;},request:function request(method,baseUrl,callback,params,webSvrUrl,useResFeed,webSrvParams){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{var xhr=createXhr();xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}this.xhr=xhr;sendXhr.call(this,xhr,method,baseUrl,params);}}});mstrmojo.QueuedXHR=mstrmojo.declare(mstrmojo.SimpleXHR,null,{scriptClass:"mstrmojo.QueuedXHR",queue:null,requestCount:0,retryDelay:1,lookup:null,cancel:function cancel(){var didCancel=this._super();while(this.queue.length){var x=this.queue.pop();var cb=x.callback;if(cb&&cb.complete){cb.complete();}}this.queue=[];this.requestCount--;return didCancel;},init:function init(){this.queue=[];this.lookup=[];},request:function request(method,baseUrl,callback,params,override,webSvrUrl,useResFeed,webSrvParams,useCache){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue();};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}sendXhr.call(this,xhr,method,baseUrl,params);}}}},upload:function upload(method,baseUrl,callback,params,data,config,override,webSrvParams,useCache){if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);}if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params,data:data,config:config});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();var self=this;callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue.call(ths);};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});var handleProgress=function(event){callback.progress(event,config);};var url=baseUrl;var async=!!(config&&config.async);xhr.open("POST",url,async);if(config&&config.authToken){xhr.setRequestHeader("X-MSTR-AuthToken",config.authToken);if("projectId" in params){xhr.setRequestHeader("X-MSTR-ProjectId",params.projectId);}}var formData=new FormData();var a;for(a in params){formData.append(a,params[a]);}if(data){if(params.fileName){formData.append(params.fileFieldName?params.fileFieldName:"myFile",data,params.fileName);}else{formData.append(params.fileFieldName?params.fileFieldName:"myFile",data);}}if(xhrSupportsProgress(xhr)&&callback.progress){xhr.upload.onprogress=handleProgress;}xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(self,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));xhr.send(formData);}}},advanceQueue:function advanceQueue(){this.requestCount--;if(this.queue.length===0){this.requestCount=0;return ;}var req=this.queue.shift();if(req.params.taskId==="importFile"||req.params.taskId==="arch.sparkFileUpload"){this.upload(req.method,req.baseUrl,req.callback,req.params,req.data,req.config);}else{this.request(req.method,req.baseUrl,req.callback,req.params,true);}},_searchForCacheRequest:function _searchForCacheRequest(params){var i;for(i in this.lookup){if(mstrmojo.hash.equals(params,this.lookup[i].params)){return this.lookup[i];}}return null;},hasRequests:function hasRequests(){return this.requestCount>0||mstrmojo.jsonp.hasRequests();}});mstrmojo.xhr=new mstrmojo.QueuedXHR();mstrmojo.jsonp={jsc:new Date().getTime(),timeToWait:20000,requestCount:0,request:function(url,params,callback){var head=document.getElementsByTagName("head")[0]||document.documentElement,jsonp="jsonp"+(this.jsc++),script=document.createElement("script");params.jsonp=jsonp+"(@R@);";params.taskContentType="jsonp";params.taskEnv="jsonp";params.xts=new Date().getTime();window[jsonp]=function(response){mstrmojo.jsonp.requestCount--;if(!response){if(callback.timeout){callback.timeout();}}else{if(response.status===200){callback.success(response.content);}else{var res={status:response.status,getResponseHeader:function(name){switch(name){case"X-MSTR-TaskFailureMsg":return response.errorMsg;case"X-MSTR-TaskErrorCode":return response.errorCode;}}};if(mstrApp.onSessionExpired&&isSessionExpiredError(res)){if(callback.onSessionExpired){callback.onSessionExpired();}else{mstrApp.onSessionExpired();}}else{callback.failure(res);}}}if(window[jsonp]){if(callback.complete){callback.complete();}window[jsonp]=undefined;try{delete window[jsonp];}catch(e){}head.removeChild(script);}};head.insertBefore(script,head.firstChild);this.requestCount++;script.src=appendUrlParams("GET",url,params);setTimeout(function(){var fn=window[jsonp];if(fn){fn();}},this.timeToWait);},hasRequests:function(){return this.requestCount>0;}};}());(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.hash");var M=mstrmojo.string,L=mstrmojo.hash,E=mstrmojo.dom;var R=mstrmojo.usesFrames?null:document.createElement("span");var J=/mstrAttach:([\w,]+)/g;var Q;function V(b,c){if(Q===undefined){Q=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return b.replace(J,function a(j,l){var f=l.split(","),g=[],d=f.length,h;for(h=0;h<d;h++){var k=f[h];if(k){if(Q){if(k.indexOf("mouse")>-1){continue;}else{if(k==="click"){k="touchend";}}}g.push("on"+k+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+k+"', self, event)\"");}}return g.join(" ");});}var N="preBuildRendering",C="buildRendering",B="postBuildRendering";function Y(c){var b=c.markupString;if(b.match(/mstrAttach:/)){b=V(b,c);if(c.markupString===c.constructor.prototype.markupString){c.constructor.prototype.markupString=b;}}var a=M.apply(b,c);if(a){if(a.indexOf("oncontextmenu")>-1){c.hasContextMenuEvent=true;}if(mstrmojo.usesFrames){var e=(c.domNode&&c.domNode.ownerDocument)||window.document;if(!R||R.ownerDocument!==e){R=e.createElement("span");}}R.innerHTML=a;var f=R.removeChild(R.firstChild);f.mstrmojoId=c.id;return f;}return null;}function A(c){var b=c.markupSlots,a,d;if(b){a={};for(d in b){a[d]=b[d].call(c);}}return a;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{markupString:null,markupMethods:null,markupSlots:null,onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function Z(){if((this[N]&&this[N]()===false)||(this[C]()===false)||(this[B]&&this[B]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var a="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,a)){this.raiseEvent({name:a});}return true;},buildDom:function U(){return Y(this);},postBuildDom:null,preBuildRendering:mstrmojo.emptyFn,buildRendering:function F(){var a=this.domNode,b=this.buildDom();this.domNode=b;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(A(this));this.paint();if(b){var e=a;if(!e){e=this.placeholder;if(e){if(typeof e==="string"){e=document.getElementById(e);}delete this.placeholder;}}if(e){E.replace(e,b);}}var c="onchildRenderingChange",d=this.parent;if(d&&d[c]){d[c](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function S(c){if(this.hasRendered){if(!c){try{var a=this.domNode;if(a.parentNode){a.parentNode.removeChild(a);}}catch(b){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function K(){var b=this.markupMethods;if(!b){return ;}var e=this,f=function(j){var i=b[j];if(i){try{i.apply(e,[true]);}catch(h){throw new Error(["Error in markup method.","Script class: "+e.scriptClass,"Widget id: "+e.id,"Method name: "+j,"Err: "+h.message].join("\n\n"));}}};var d=b.sequence,a,c,g;if(d){a=d.length||0;for(c=0;c<a;c++){f(d[c]);}}else{for(g in b){f(g);}}},redraw:function P(){return false;},refresh:function D(a){if(this.hasRendered){if(this.redraw()!==true){var b=this.domNode;this.unrender(true);this.placeholder=b;if(a){a();}this.render();}}},set:function I(d,a){this._super(d,a);if(this.domNode){var b=this.markupMethods,c=b&&b["on"+d+"Change"];if(c){c.apply(this);}}return this;},slotNames:null,addSlots:function G(b){var a=this.slotNames,c;if(!a){a={};this.slotNames=a;}for(c in b){this[c]=b[c];a[c]=true;}},removeSlots:function H(a){if(a){var b=this.slotNames,c;for(c in a){delete this[c];if(b){delete b[c];}}}},captureDomEvent:function X(c,a,d,b){if(this.enabled!==false){this.raiseEvent(mstrmojo._HasMarkup.newDomEvent(c,a,d||a.event,b));}},playEffect:function W(b){var a=this[b];if(a&&a.constructor===Object){a=mstrmojo.insert(mstrmojo.hash.clone(a));a.widget=this;this[b]=a;}if(a){a.play();}}});mstrmojo._HasMarkup.addMarkupMethods=function O(b,a){b.prototype.markupMethods=L.copy(a,L.copy(b.prototype.markupMethods));};mstrmojo._HasMarkup.MSTRDomEventType=null;mstrmojo._HasMarkup.newDomEvent=function(d,a,c,b){return{name:d,hWin:a,e:c,config:b,ctrlKey:E.ctrlKey(a,c),shiftKey:E.shiftKey(a,c),metaKey:E.isMetaKey(a,c),cancel:function(){E.stopPropogation(a,c);},preventDefault:function(){E.preventDefault(a,c);},getTarget:function(){return E.eventTarget(a,c);}};};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.string","mstrmojo.StringBuffer");mstrmojo._XMLNode=mstrmojo.declare(null,null,{nodeName:null,init:function N(O){mstrmojo.hash.copy(O,this);},addChild:function F(P){var O=new mstrmojo._XMLNode({nodeName:P});return this.appendNode(O);},appendNode:function J(O){if(O){if(!this.children){this.children=[];}this.children.push(O);O.parent=this;}return O;},addAttribute:function L(O,P){if(O!=null){if(!this.attributes){this.attributes={};}this.attributes[O]=P;}return this;},addText:function M(O){this._addToStringMember("text",O);return this;},addRawXML:function K(O){this._addToStringMember("rawXML",O);return this;},getXMLString:function I(){var O=new mstrmojo.StringBuffer();this.buildXMLString(O);return O.toString();},buildXMLString:function E(O){O=O||new mstrmojo.StringBuffer();O.append("<").append(this.nodeName).append(" ");this._buildAttributesXMLString(O).append(">").append(((this.text!=null)?this._escapeString(this.text):"")).append(((this.rawXML!=null)?this.rawXML:""));this._buildChildrenXMLString(O).append("</").append(this.nodeName).append(">");return O;},_buildAttributesXMLString:function D(O){var Q=this.attributes;if(Q){var R;for(R in Q){if(Q[R]!=null){var P=String(Q[R]);switch(R){case"et":case"nt":case"dmt":case"ddt":case"fnt":case"tp":case"stp":break;default:P=this._escapeString(P);}O.append(R+'="'+P+'" ');}}}return O;},_escapeString:function C(O){return mstrmojo.string.escape4HTMLText(O);},_buildChildrenXMLString:function H(P){var R=this.children;var O=R&&R.length;if(O){var Q;for(Q=0;Q<O;Q++){if(R[Q]&&R[Q].buildXMLString){R[Q].buildXMLString(P);}}}return P;},_addToStringMember:function A(O,Q){var P=this[O];if(P==null){this[O]=Q;}else{this[O]=P+Q;}}});mstrmojo.XMLBuilder=mstrmojo.declare(null,null,{root:null,curNode:null,addChild:function F(O){if(!this.root){this.currentNode=this.root=new mstrmojo._XMLNode({nodeName:O});}else{this.currentNode=this.currentNode.addChild(O);}return this;},appendNode:function J(O){if(!this.root){this.currentNode=this.root=O;}else{this.currentNode=this.currentNode.appendNode(O);}return this;},addAttribute:function L(O,P){if(this.currentNode){this.currentNode.addAttribute(O,P);}else{alert("no root node");}return this;},addText:function M(O){if(this.currentNode){this.currentNode.addText(O);}else{alert("no root node");}return this;},addRawXML:function K(O){if(this.currentNode){this.currentNode.addRawXML(O);}else{alert("no root node");}return this;},closeElement:function G(){this.currentNode=this.currentNode.parent;return this;},toString:function B(){if(this.root){return this.root.getXMLString();}return"";}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.vi.enums.EnumFeatures");var K=mstrmojo.string,F=mstrmojo.dom,G=mstrmojo.vi.enums.EnumFeatures;mstrmojo.CustomVisUtility=mstrmojo.provide("mstrmojo.CustomVisUtility",{encodeHtmlString:function(N){return K.encodeHtmlString(N);},decodeHtmlString:function(N){return K.decodeHtmlString(N);},isInPauseMode:function(){return(mstrConfig&&mstrConfig.resolveOnly)||(mstrApp&&mstrApp.isAppStatePause&&mstrApp.isAppStatePause());},isRWDExpressMode:function B(){return !!(mstrApp&&mstrApp.isExpress);},isVI:function E(){return mstrApp&&mstrApp.isVI;},isVIPresentationMode:function L(){return this.isVI()&&mstrApp.isAppStatePresentation();},isDesktop:function D(){return !!(mstrApp&&mstrApp.isSingleTier);},isWorkstation:function M(){return !!(mstrApp&&mstrApp.isWorkstation);},isWSLiveMode:function I(){if(mstrApp&&typeof mstrApp.supportFeature==="function"){return mstrApp.supportFeature(G.SUPPORT_LIVEMODE)&&(typeof mstrApp.getWSLiveMode==="function")&&mstrApp.getWSLiveMode();}return false;},isWSLocalMode:function C(){return this.isDesktop()&&!this.isWSLiveMode();},isLibrary:function A(){return !!(mstrApp&&mstrApp.isDossier);},isMobile:function H(){return F.isMobile;},parseBoolean:function J(N){return N===true||N==="true";},log:function(){Function.prototype.apply.call(console.log,console,arguments);},warn:function(){Function.prototype.apply.call(console.warn,console,arguments);},error:function(){Function.prototype.apply.call(console.error,console,arguments);}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;this.preHandleEvent(H);var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){this.postHandleEvent(H);C.publish(this.id,M,H);}return H;},preHandleEvent:mstrmojo.emptyFn,postHandleEvent:mstrmojo.emptyFn,attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var B=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(mstrmojo.Base,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",id:"",init:function I(J){this.disposables=[];this._super(J);B.add(this);if(this.postCreate){this.postCreate();}},addDisposable:function G(M){var K=this.disposables,L,J;if(M.constructor===Array){for(L=0,J=M.length;L<J;L++){K.push(M[L]);}}else{K.push(M);}return M;},destroyDisposables:function D(J){F.forEach(this.disposables,function(K){if(K.destroy){K.destroy(J);}else{if(K.clear){K.clear();}}});this.disposables=[];},throwAbstractMethodError:function A(J){throw new Error(this.scriptClass+" must implement "+J+".");},destroy:function H(J){if(this.destroyed){return ;}this._super(J);this.destroyDisposables(J);B.remove(this);delete this.parent;this.destroyed=true;}});var C=mstrmojo.Obj;C.free=function E(J){if(J instanceof C){J.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.CustomVisUtility","mstrmojo.customviz.GraphicModel");mstrmojo.GRAPHIC_SELECTION_TYPES={ATTR:1,METRIC:2,EMPTY:0,MIXED:4};var P=mstrmojo.array,W=mstrmojo.hash,E=mstrmojo.GRAPHIC_SELECTION_TYPES,U=mstrmojo.CustomVisUtility,c=U.log;var d=function(l){var j=W.keyarray(l).sort(),k=[],m;P.forEach(j,function(n){m=[];P.forEach(l[n],function(o){m.push(this.model.getNormalizedFormElementId(o.id));},this);k.push(n+"-"+m.sort().join("@"));},this);return k.join("#");},R=function(k,j,m){var l={};l[k]=[{id:j,n:m}];return l;},i=function(l,j){if(l&&j){var k=d.call(this,l);if(!this._customVizSelExtraInfo[k]){this._customVizSelExtraInfo[k]=j;}}},B=function(l,j){if(l&&j){var k=d.call(this,l);if(!this._customVizContextMenuSelExtraInfo[k]){this._customVizContextMenuSelExtraInfo[k]=j;}}},J=function(l){var k=d.call(this,l),j=this._customVizSelExtraInfo[k];if(j){delete this._customVizSelExtraInfo[k];}return j;},Z=function(l){var k=d.call(this,l),j=this._customVizContextMenuSelExtraInfo[k];if(j){delete this._customVizContextMenuSelExtraInfo[k];}return j;};mstrmojo._HasExtraSelectionInfo=mstrmojo.provide("mstrmojo._HasExtraSelectionInfo",{_mixinName:"mstrmojo._HasExtraSelectionInfo",_customVizSelExtraInfo:{},_customVizContextMenuSelExtraInfo:{},misMatchWithVisSelection:false,graphicSelectionType:null,init:function b(j){this._super(j);this._customVizSelExtraInfo={};this._customVizContextMenuSelExtraInfo={};this.misMatchWithVisSelection=false;this.graphicSelectionType=E.EMPTY;},isSelectionEmpty:function H(){var j;for(j in this._customVizSelExtraInfo){return false;}return true;},getSelExtraInfo:function N(){return W.valarray(this._customVizSelExtraInfo);},getContextMenuSelExtraInfo:function M(){return W.valarray(this._customVizContextMenuSelExtraInfo);},clearCxtMnuSelection:function K(j){if(!j){this._super();}this._customVizContextMenuSelExtraInfo={};},clearSelections:function G(j){if(!j){this._super();}else{this.misMatchWithVisSelection=true;}this._customVizSelExtraInfo={};this.graphicSelectionType=E.EMPTY;},addMetricValueSelection:function Q(k,l,j){if(!j){this._super(k);}else{this.misMatchWithVisSelection=true;}switch(this.graphicSelectionType){case E.METRIC:break;case E.ATTR:if(j){this.graphicSelectionType=E.MIXED;}else{this.clearSelections(true);this.graphicSelectionType=E.METRIC;}break;case E.EMPTY:this.graphicSelectionType=E.METRIC;break;default:break;}i.call(this,k,l);},removeMetricValueSelection:function a(k,l,j){if(!j){this._super(k);}else{this.misMatchWithVisSelection=true;}J.call(this,k);if(this.isSelectionEmpty()){this.graphicSelectionType=E.EMPTY;}},addContextMenuMetricValueSelection:function D(k,l,j){if(!j){this._super(k);}B.call(this,k,l);},removeContextMenuMetricValueSelection:function h(k,l,j){if(!j){this._super(k);}Z.call(this,k);},addAttributeSelection:function X(l,k,o,n,j){var q=R.call(this,l,k,o),m;if(!j){m=this._super(l,k,o);}else{this.misMatchWithVisSelection=true;}switch(this.graphicSelectionType){case E.ATTR:break;case E.METRIC:if(j){this.graphicSelectionType=E.MIXED;}else{this.clearSelections(true);this.graphicSelectionType=E.ATTR;}break;case E.EMPTY:this.graphicSelectionType=E.ATTR;break;default:break;}i.call(this,q,n);return m;},removeAttributeSelection:function g(l,k,o,n,j){var m;if(!j){m=this._super(l,k,o);}else{this.misMatchWithVisSelection=true;}J.call(this,R.call(this,l,k));if(this.isSelectionEmpty()){this.graphicSelectionType=E.EMPTY;}return m;},addContextMenuAttributeSelection:function I(l,k,o,n,j){var q=R.call(this,l,k,o),m;if(!j){m=this._super(l,k,o);}B.call(this,q,n);return m;},removeContextMenuAttributeSelection:function V(l,k,o,n,j){var m;if(!j){m=this._super(l,k,o);}Z.call(this,R.call(this,l,k));return m;},getGraphicModelsBySelector:function f(){},isSelectorsEqual:function Y(k,j){if(k.isSelectAttr===j.isSelectAttr){return this.getSelectorHash(k)===this.getSelectorHash(j);}return false;},getSelectorHash:function C(j){if(j.isSelectAttr){return d.call(this,R.call(this,j.tid,j.eid,j.n));}else{return d.call(this,j);}},copyToContextMenuSelection:function S(){this._super();W.copy(this._customVizSelExtraInfo,this._customVizContextMenuSelExtraInfo);},synchronizeContextMenuSelection:function A(){this.clearCxtMnuSelection();this.copyToContextMenuSelection();},needHighlight:function F(k,j){if(k){return !!this._customVizSelExtraInfo[d.call(this,R.call(this,j.tid,j.eid,j.n))];}else{return !!this._customVizSelExtraInfo[d.call(this,j)];}},needContextMenuHighlight:function O(k,j){if(k){return !!this._customVizContextMenuSelExtraInfo[d.call(this,R.call(this,j.tid,j.eid,j.n))];}else{return !!this._customVizContextMenuSelExtraInfo[d.call(this,j)];}},synchronizeToVisSelection:function L(){var l=this.getSelExtraInfo(),k=this,m=this.graphicSelectionType,j;this.clearSelections();this.misMatchWithVisSelection=false;if(m===E.ATTR){P.forEach(l,function(n){j=n.getSelector();k.addAttributeSelection(j.tid,j.eid,j.n,n);});}else{if(m===E.METRIC){P.forEach(l,function(n){k.addMetricValueSelection(n.getSelector(),n);});}}},addSelectionBySingleSelector:function e(t,s,l,n,u){var q=this,m,k,o,j,p={xTotal:0,yTotal:0,count:0};m=q.getGraphicModelsBySelector(t,s);m=P.ensureArray(m);if(m.length>0){P.forEach(m,function(w){k=w.isAttributeSelector();o=w.getSelector();if(k){n?q.addContextMenuAttributeSelection(o.tid,o.eid,o.n,w,l):q.addAttributeSelection(o.tid,o.eid,o.n,w,l);}else{n?q.addContextMenuMetricValueSelection(w.getSelector(),w,l):q.addMetricValueSelection(w.getSelector(),w,l);}if(u){j=w.getGraphicCenter();if(j){p.xTotal+=j.x;p.yTotal+=j.y;}++p.count;}});}else{c('We did not get any graphic model by the selector given what may lead to the functionality of selection and highlight not work, please check the function "getGraphicModelBySelector()" you have implemented.');}return p;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.gmaps.MapEnums","mstrmojo.gm.GMEnums","mstrmojo.VisEnum");var i=mstrmojo,j=i.array,k=i.vi.viz.EnumDSSDropZones,U=i.hash,P=i.gmaps,p=mstrmojo.VisEnum,y=p.LegendPropertyTag,n=p.MAPS_PROPERTIES,K=P.EnumPropertyType,b=P.EnumZoomBehavior,m=P.EnumGraphicType,a=P.EnumClusterMode,o=P.EnumGeographicRole,F=P.EnumBaseMapType,Z=P.EnumLanguageType,D=P.EnumDefaultShapeFormatStyle,M=p.EnumLegendMode,E=mstrmojo.gm.EnumLegendSlot,t=p.EnumSingleLegendMode,c=new RegExp(".{32}","g"),w,I=P.CustomShapeId;mstrmojo.vi.viz.MapHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.MapHelper",widget:null,data:null,vp:null,geoAttribute:null,latitude:null,longitude:null,geometry:null,slice:[],angle:null,colorBy:null,sizeBy:null,tooltip:null,markerType:null,useAttributeForm:null,supportAreaMap:true,defaultView:null,init:function u(AB){this._super(AB);this.tooltip=[];this.data=this.data||{};this.vp=this.data.vp||{};},setWidget:function R(AB){if(!AB){return ;}var AE=AB.fnGetWidget(),AD=AB.k,AC=AB.node&&AB.node.data&&AB.node.data.vp;this.widget=AB;this.geoAttribute=N(AB,k.GeoAttribute);this.latitude=N(AB,k.Latitude);this.longitude=N(AB,k.Longitude);this.geometry=N(AB,k.Geometry);this.angle=N(AB,k.Angle);this.colorBy=N(AB,k.ColorBy);this.sizeBy=N(AB,k.SizeBy);this.tooltip=AE.getDropZoneItems(k.AdditionalMetrics,AD).map(function(AF){return AF.id;});this.slice=AE.getDropZoneItems(k.SliceBy,AD).map(function(AF){return AF.id;});if(AC){this.markerType=AC.mtp;this.useAttributeForm=AC[K.useAttributeForm];this.defaultView=AC.dv;}},getGeoUnit:function H(){return q(this.widget,k.GeoAttribute);},getLatitudeUnit:function J(){return q(this.widget,k.Latitude);},getLongitudeUnit:function g(){return q(this.widget,k.Longitude);},getGeometryUnit:function W(){return q(this.widget,k.Geometry);},getAngleUnit:function A(){return q(this.widget,k.Angle);},getColorByUnit:function S(){return q(this.widget,k.ColorBy);},getSizeByUnit:function l(){return q(this.widget,k.SizeBy);},getSliceByUnits:function C(){var AB=this.widget.fnGetWidget();return AB.getDropZoneItems(k.SliceBy,this.widget.k);},getTooltipUnits:function e(){var AB=this.widget.fnGetWidget();return AB.getDropZoneItems(k.AdditionalMetrics,this.widget.k);},setMapType:function(AB){this.vp.gtp=AB;},setBorderStyle:function(AB){this.vp.shapeLineStyle=AB;this.vp.shapeLineClr=D.BORDER_COLOR;},getMapType:function(){return this.vp.gtp;},getLayerName:function(){return this.vp.ln;},setShapeFile:function(AB){this.vp.lid=AB;},setUseAttributeForm:function d(AB){this.useAttributeForm=AB?w.USE_ATTRIBUTE_FORM:w.USE_ATTRIBUTE;},getXml:function O(){var AB=this.vp,AD=this.tooltip,AC=this.useAttributeForm;AB[y.LEGEND_MODE]=AB[y.LEGEND_MODE]||M.RESTORED.toString();AB[y.LEGEND_POSITION]=AB[y.LEGEND_POSITION]||E.RIGHT_MIDDLE.toString();AB[n.SHOW_LEGEND]=AB[n.SHOW_LEGEND]||"false";AB[K.collapseLegend]=AB[K.collapseLegend]||t.RESTORE.toString();AB[K.legendSwitch]=AB[K.legendSwitch]||"false";AB[K.baseMapType]=AB[K.baseMapType]||F.Reserved;AB[K.layerIdx]=AB[K.layerIdx]||0;AB[K.layerName]=AB[K.layerName]||mstrmojo.desc(14750,"Layer")+" 1";AB[K.isHidden]=AB[K.isHidden]||"0";AB[K.zoomSetting]=AB[K.zoomSetting]||b.Automatic;AB[K.clusterRadius]=50;AB[K.clusterMaxZoom]=22;AB[K.languageType]=Z.English;AB[K.tooltipSwitch]=AB[K.tooltipSwitch]||"true";AB.ga=this.geoAttribute||"";AB.gmt=this.geometry||"";AB.lat=this.latitude||"";AB.lng=this.longitude||"";AB.cmt=this.colorBy||"";AB.smt=this.sizeBy||"";if(AC){AB[K.useAttributeForm]=AC;}AB.tooltip="";if(AD){AD.forEach(function(AE){AB.tooltip+=AE;});}return w.getXmlFromJson(this.vp);},showColorByZone:function(AB){return w.canShowColorByZone(AB);},showSizeByZone:function(AB){return !!AB&&AB[K.graphicType]===m.Bubble;},showSliceZone:function(AB){return !!AB&&AB[K.graphicType]===m.Bubble;},showAngleZone:function(AB){return !!AB&&AB[K.graphicType]===m.Bubble||((AB[K.graphicType]===m.Marker)&&AB[K.clusterMode]===a.PIE);}});w=mstrmojo.vi.viz.MapHelper;w.zonesCfg=[{n:mstrmojo.desc(11661,"Geo Attribute"),id:k.GeoAttribute,prm:true,allowSingle:true,show:function(){return true;},v:function(AB){return B(AB,K.geoAttribute);},onDel:function(AB){if(!!AB){AB[K.geoAttribute]="";if(AB[K.shapeFile]!==I){AB[K.shapeFile]="";}}},onAdd:function(AB,AC){if(!!AB){AB[K.geoAttribute]=AC.item.did;AB[K.useAttributeForm]=w.USE_ATTRIBUTE_FORM;if(AB[K.shapeFile]!==I){AB[K.shapeFile]="";}else{AB[K.useAttributeForm]=w.USE_ATTRIBUTE;}}}},{n:mstrmojo.desc(7696,"Latitude"),id:k.Latitude,prm:true,allowSingle:true,show:function(AB){if(!!AB){return(AB[K.graphicType]!==m.Area);}},v:function(AB){return B(AB,K.latitude);},onDel:function(AB){if(!!AB){AB[K.latitude]="";}},onAdd:function(AB,AC){var AD=AC.item;if(!!AB){AB[K.latitude]=AD.did;AB[K.useAttributeForm]=AD.t===21?w.USE_ATTRIBUTE_FORM:w.USE_ATTRIBUTE;}}},{n:mstrmojo.desc(7697,"Longitude"),id:k.Longitude,prm:true,allowSingle:true,show:function(AB){if(!!AB){return(AB[K.graphicType]!==m.Area);}},v:function(AB){return B(AB,K.longitute);},onDel:function(AB){if(!!AB){AB[K.longitute]="";}},onAdd:function(AB,AC){var AD=AC.item;if(!!AB&&!!AD){AB[K.longitute]=AD.did;AB[K.useAttributeForm]=AD.t===21?w.USE_ATTRIBUTE_FORM:w.USE_ATTRIBUTE;}}},{n:mstrmojo.desc(16630,"Geometry"),id:k.Geometry,prm:true,allowSingle:true,show:function(AB){if(!!AB){return(AB[K.graphicType]===m.Area&&AB[K.shapeFile]===I);}return false;},v:function(AB){return B(AB,K.geometry);},onDel:function(AB){if(!!AB){AB[K.geometry]="";}},onAdd:function(AB,AC){var AD=AC.item;if(!!AB){AB[K.geometry]=AD.did;AB[K.useAttributeForm]=AD.t===21?w.USE_ATTRIBUTE_FORM:w.USE_ATTRIBUTE;}}},{n:mstrmojo.desc(6188,"Slice"),id:k.SliceBy,prm:true,allowSingle:false,show:function(AB){if(!!AB){return w.showSliceZone(AB);}},v:function(AB){if(!!AB){var AC=AB[K.slice];return AC&&AC.match(c);}},onDel:function(AB,AC){var AD=AC&&AC.item;if(!!AB&&AD&&AD.id&&AB[K.slice]){AB[K.slice]=AB[K.slice].replace(AD.did,"");}},onAdd:function(AB,AC){var AF=K.slice,AE=AC&&AC.item;if(!!AB&&AE){var AD=AB[AF]?AB[AF].match(c):[];AD.splice(AC.idx,0,AE.did);AB[AF]=AD.join("");}}},{n:mstrmojo.desc(14294,"Angle"),id:k.Angle,prm:true,allowSingle:true,show:function(AB){if(!!AB){return w.showAngleZone(AB);}},v:function(AB){return B(AB,K.angle);},onDel:function(AB){if(!!AB){AB[K.angle]="";}},onAdd:function(AB,AC){G(AB,AC,K.angle);}},{n:mstrmojo.desc(11662,"Color By"),id:k.ColorBy,prm:true,allowSingle:true,show:function(AB){return w.canShowColorByZone(AB);},v:function(AB){return B(AB,K.colorby);},onDel:function(AB){if(!!AB){AB[K.colorby]="";}},onAdd:function(AB,AC){G(AB,AC,K.colorby);}},{n:mstrmojo.desc(11663,"Size By"),id:k.SizeBy,prm:true,allowSingle:true,show:function(AB){if(!!AB){return w.canShowSizeByZone(AB);}},v:function(AB){return B(AB,K.sizeby);},onDel:function(AB){if(!!AB){AB[K.sizeby]="";}},onAdd:function(AB,AC){G(AB,AC,K.sizeby);}},{n:mstrmojo.desc(2962,"Tooltip"),id:k.AdditionalMetrics,prm:false,allowSingle:false,show:function(){return true;},v:function(AB){if(!!AB){var AC=AB[K.tooltip];return AC&&AC.match(c);}},onDel:function(AB,AC){if(AB&&AB[K.tooltip]){AB[K.tooltip]=AB[K.tooltip].replace(AC.item.did,"");}},onAdd:function(AB,AC){var AE=K.tooltip;if(!!AB){var AD=AB[AE]?AB[AE].match(c):[];AD.splice(AC.idx,0,AC.item.did);AB[AE]=AD.join("");}}}];w.USE_ATTRIBUTE="0";w.USE_ATTRIBUTE_FORM="1";w.canShowColorByZone=function(AB){return !!AB&&(AB[K.graphicType]!==undefined)&&AB[K.graphicType]!==m.Density;};w.canShowSizeByZone=function(AB){return !!AB&&AB[K.graphicType]===m.Bubble;};w.showAngleZone=function(AB){if(!AB){return false;}return AB[K.graphicType]===m.Bubble||((AB[K.graphicType]===m.Marker)&&AB[K.clusterMode]===a.PIE);};w.showSliceZone=function(AB){return !!AB&&AB[K.graphicType]===m.Bubble;};w.supportImageThreshold=function(AB){return !!AB&&AB[K.graphicType]===m.Marker;};w.isLatitude=function Y(AC,AB){return AB===5||(AC&&AC.toLowerCase().indexOf("latitude")>-1);};w.isLongitude=function s(AC,AB){return AB===6||(AC&&AC.toLowerCase().indexOf("longitude")>-1);};w.isGeometry=function h(AB){return AB===11;};w.isAxisAttribute=function AA(AC){var AB=AC&&AC.fs,AD;if(AB&&AB.length===1){AD=AB[0];return !!AD&&(AD.fgr===5||AD.fgr===6||AD.fgr===11);}return false;};w.getXmlFromJson=function V(AB){var AC=new mstrmojo.XMLBuilder();AC.addChild("widgetProps");AC.addChild("fmt");U.forEach(AB,function(AD,AE){AC.addChild(AE);AC.addAttribute("value",AD);AC.closeElement();});AC.closeElement();AC.closeElement();return AC.toString();};w.isGeoRoleSupportArea=function L(AB){AB=AB&&AB.toString();return AB===o.EnumGeographicRoleCity||AB===o.EnumGeographicRoleState||AB===o.EnumGeographicRoleCountry||AB===o.EnumGeographicRoleOther||AB===o.EnumGeographicRoleZipCode||AB===o.EnumGeographicRoleCounty;};w.getGeoForm=function x(AE,AC){var AB=AE&&AE.fs,AD=null;if(!AC){AC=function(){return true;};}if((AE.otp===12||AE.t===12)&&AB){j.forEach(AB,function(AF){if(AC(AF)){AD=AF;return false;}});}return AD;};w.getLatitudeForm=function z(AB){return w.getGeoForm(AB,function(AC){return w.isLatitude(AC.fnm,AC.fgr)&&AC.obf;});};w.getLongitudeForm=function X(AB){return w.getGeoForm(AB,function(AC){return w.isLongitude(AC.fnm,AC.fgr)&&AC.obf;});};w.getGeometryForm=function Q(AB){return w.getGeoForm(AB,function(AC){return w.isGeometry(AC.fgr)&&AC.obf;});};w.zonesNeedSyncToTooltipZone=[k.GeoAttribute,k.SliceBy,k.Angle,k.SizeBy,k.ColorBy];w.shouldSyncItemToTooltipZone=function f(AD,AB,AC){AC=j.ensureArray(AC);return w.zonesNeedSyncToTooltipZone.indexOf(AB)>-1&&AC.indexOf(AD)<0;};function q(AC,AB){var AF=AC.fnGetWidget(),AE=AC.k,AD=AF.getDropZoneItems(AB,AE);return AD[0];}function N(AC,AB,AD){var AE=q(AC,AB,AD);return AE?AE.id:"";}function B(AC,AB){if(!!AC){return AC[AB]?[AC[AB]]:[];}}function G(AC,AD,AB){var AE=AD.item;if(!!AC||!!AE){AC[AB]=AE.did;}return AC;}}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.XMLBuilder","mstrmojo.gm.GMEnums");var L=mstrmojo,F=L.hash,I=L.array,P=L.vi.viz,B=P.EnumDSSDropZones,A=1,H=0,D=P.DropZoneHelper.METRIC_NAMES_ID,O,E=mstrmojo.gm.DualAxisSubAxisBit,G=E.PRIMARY;mstrmojo.vi.viz.GraphMatrixHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.GraphMatrixHelper",handled:false,rowObjects:null,columnObjects:null,xAxisObjects:null,yAxisObjects:null,angleObjects:null,sliceObjects:null,breakByObjects:null,colorByObjects:null,currentXML:"",sizeByObjects:null,tooltipMetrics:null,data:null,metricsDropZone:"",secondaryMetricsDropZone:"",shape:"",subtype:"",metricShapes:null,visType:-1,init:function N(Q){this._super(Q);this.rowObjects=[];this.columnObjects=[];this.xAxisObjects=[];this.yAxisObjects=[];this.angleObjects=[];this.sliceObjects=[];this.breakByObjects=[];this.colorByObjects=[];this.sizeByObjects=[];this.tooltipMetrics=[];this.currentXML="";this.metricsDropZone="";this.secondaryMetricsDropZone="";this.shape="";this.subtype="";this.metricShapes="{}";},clone:function J(R){var Q=this;Q.rowObjects=R.rowObjects.concat();Q.columnObjects=R.columnObjects.concat();Q.xAxisObjects=R.xAxisObjects.concat();Q.yAxisObjects=R.yAxisObjects.concat();Q.angleObjects=R.angleObjects.concat();Q.sliceObjects=R.sliceObjects.concat();Q.breakByObjects=R.breakByObjects.concat();Q.colorByObjects=R.colorByObjects.concat();Q.sizeByObjects=R.sizeByObjects.concat();Q.tooltipMetrics=R.tooltipMetrics.concat();Q.currentXML=R.currentXML;Q.metricsDropZone=R.metricsDropZone;Q.secondaryMetricsDropZone=R.secondaryMetricsDropZone;Q.shape=R.shape;Q.subtype=R.subtype;Q.metricShapes=R.metricShapes;},exists:function(S,Q){var U=this[Q],R=false;I.forEach(U,function(V){R=(V.did===S.did);if(R){return false;}});return R;},removeAngleMetricFromOthers:function(Q){["xAxisObjects","yAxisObjects","tooltipMetrics"].every(function(U){var S=this[U],R=I.find(S,"did",Q.did);if(R>-1){S.splice(R,1);return false;}});},getXml:function C(){var Q=this.data.dz,R=Q?F.copy(Q.visProp&&Q.visProp.fmt,{}):{},S=new mstrmojo.XMLBuilder();if(this.data.visName===mstrmojo.vi.viz.EnumVizStyles.MAPBOX){delete R.cr;}if(this.visStyle){R.visStyle=this.visStyle;}if(this.shape){R.Shape=this.shape;}if(this.subtype){R.Subtype=this.subtype;}if(this.metricShapes){R.metricShapes=this.metricShapes;}R.visType=this.visType;S.addChild("props");S.addChild("widgetProps");S.addChild("fmt");F.forEach(R,function(U,V){S.addChild(V);S.addAttribute("value",U);S.closeElement();});S.closeElement();S.closeElement();S.closeElement();return S.toString();},setData:function K(U){if(!U){return ;}var R=this,S=function(W,X){if(W){var V=(W.TemplateUnit||[]).concat(W.TemplateMetric||[]);if(V){V.forEach(function(Y){var Z=F.copy(Y);if(!Z.did){Z.did=Z.id;}X.push(Z);});}}};S(U[O.PROP_ROWS],this.rowObjects);S(U[O.PROP_COLUMNS],this.columnObjects);S(U[O.PROP_XAXIS],this.xAxisObjects);S(U[O.PROP_YAXIS],this.yAxisObjects);S(U[O.PROP_BREAKBY],this.breakByObjects);S(U[O.PROP_COLORBY],this.colorByObjects);S(U[O.PROP_SIZEBY],this.sizeByObjects);S(U[O.PROP_SLICE],this.sliceObjects);S(U[O.PROP_ANGLE],this.angleObjects);S(U[O.PROP_TOOLTIPMETRICS],this.tooltipMetrics);var Q=U.visProp.fmt;this.shape=Q[O.PROP_SHAPE];this.subtype=Q[O.PROP_SUBTYPE];},setMetricsDropZone:function M(Q){if(!Q){return ;}var R=this;[O.PROP_ROWS,O.PROP_COLUMNS,O.PROP_XAXIS,O.PROP_YAXIS,O.PROP_BREAKBY,O.PROP_SLICE,O.PROP_COLORBY].forEach(function(S){if(Q[S]&&Q[S].hasOwnProperty("MetricNames")){if(R.metricsDropZone){R.secondaryMetricsDropZone=S;}else{R.metricsDropZone=S;}}});},getAddDropZonesAction:function(){var V=this,R=this.metricsDropZone,Q=this.secondaryMetricsDropZone,S={act:"updateTemplate",keyContext:this.data.k,actions:[]},U=function(W){S.actions.push({act:"addDropZoneUnit",zoneId:B[W],unitId:D,unitType:H});};[{p:"rowObjects",v:"Rows"},{p:"columnObjects",v:"Columns"},{p:"xAxisObjects",v:"XAxis"},{p:"yAxisObjects",v:"YAxis"},{p:"breakByObjects",v:"BreakBy"},{p:"colorByObjects",v:"ColorBy"},{p:"sizeByObjects",v:"SizeBy"},{p:"angleObjects",v:"Angle"},{p:"sliceObjects",v:"SliceBy"},{p:"tooltipMetrics",v:"AdditionalMetrics"}].forEach(function(Y){var W=V[Y.p],Z=B[Y.v];W.forEach(function(a){if(a){S.actions.push({act:"addDropZoneUnit",zoneId:Z,unitId:a.did,unitType:a.t,ax:a.ax||G});}});if(R===Y.v){var X=function(a){return(a&&(a.length>A)&&V.isMetricZone(a));};if(X(V.xAxisObjects)||X(V.yAxisObjects)||X(V.angleObjects)){U(R);}}});if(Q==="ColorBy"){U(Q);}return S;}});O=mstrmojo.vi.viz.GraphMatrixHelper;O.PROP_ROWS="Rows";O.PROP_COLUMNS="Columns";O.PROP_HORIZONTAL_AXIS="HorizontalAxis";O.PROP_VERTICAL_AXIS="VerticalAxis";O.PROP_XAXIS="XAxis";O.PROP_YAXIS="YAxis";O.PROP_SLICE="SliceBy";O.PROP_ANGLE="AngleBy";O.PROP_BREAKBY="BreakBy";O.PROP_COLORBY="ColorBy";O.PROP_SIZEBY="SizeBy";O.PROP_TOOLTIPMETRICS="AdditionalMetrics";O.PROP_SHAPE="Shape";O.PROP_SUBTYPE="Subtype";O.PROP_METRICSHAPES="metricShapes";O.PROP_SHAPE_AREA="Area";O.PROP_SHAPE_LINE="Line";O.PROP_SHAPE_BAR="Bar";O.PROP_SHAPE_CIRCLE="Circle";O.PROP_SHAPE_SQUARE="Square";O.PROP_SHAPE_PIE="Pie";O.PROP_SHAPE_RING="Ring";O.PROP_SHAPE_TICK="Tick";O.PROP_SUBTYPE_CLUSTERED="Clustered";O.PROP_SUBTYPE_AUTOMATIC="Automatic";O.PROP_SUBTYPE_STACKED="Stacked";O.PROP_SUBTYPE_ABSOLUTE="Absolute";O.PROP_SUBTYPE_PERCENT="Percent";}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._HasMarkup");var J=mstrmojo.dom,D=mstrmojo._HasMarkup,P,Q=mstrmojo.global.document,K,A="touchstart",C="touchmove",I="touchend",N="contextmenu";function O(S){var R=J.findWidget(S);while(R){if(R.hasContextMenuEvent){return R;}R=R.parent;}return null;}function M(R){var U=R.src,S=O(U&&U.node);if(!S){return null;}return S;}H:function H(R){if(R&&R.touches.length===1){P.startTapHoldCheck(self,R);}}B:function B(){var R=++P.ctxt.moveCount;if(R>P.minMoves){P.stopTapHoldCheck();if(K){window.clearTimeout(K);}}}L:function L(){P.stopTapHoldCheck();if(K){window.clearTimeout(K);}}mstrmojo.taphold=mstrmojo.taphold||mstrmojo.provide("mstrmojo.taphold",{timeThreshold:750,minMoves:3,startTapHoldCheck:function G(R,S){delete this.ctxt;var U=J.captureEventInfo({hWin:R,e:S});this.ctxt={src:U,moveCount:0};J.attachEvent(Q,C,B);J.attachEvent(Q,I,L);S.name=N;K=window.setTimeout(function(){P.stopTapHoldCheck();var V=D.newDomEvent(N,window,S),W;for(W in S){if(!V[W]){V[W]=S[W];}}V.type=N;P.triggerContextMenu(V);},this.timeThreshold);},triggerContextMenu:function F(R){var S=this.ctxt,U=M(S);if(!U){return ;}if(U.raiseEvent){U.raiseEvent(R);}},stopTapHoldCheck:function E(){J.detachEvent(Q,C,B);J.detachEvent(Q,I,L);},enable:function(){if(J.isIOSTouch){J.attachEvent(Q,A,H);}},disable:function(){J.detachEvent(Q,A,H);}});P=mstrmojo.taphold;P.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var H=mstrmojo.hash,E=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=H.clone(I);O.data=M;O.parent=N;return E.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length),N,I;for(N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,U){if(U){var N=P.itemWidgets,L,O,I,R;for(O=0,I=U.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}var M,Q,K;for(M=0,Q=U.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},H.copy(mstrmojo.ListBuilder)));}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.xhr");var F=mstrmojo.hash;function J(K,L){return function(){if(K[L]){K[L]();}};}var B=[];function H(L){var K;switch(L.cacheLevel){case mstrmojo.AjaxCall.CACHELEVEL_LOCAL:if(L._cache==null){L._cache=[];}K=L._cache;break;default:if(B==null){B=[];}K=B;break;}return K;}function E(N){var M=H(N);var P={cache:M,idx:-1},O=N.params;if("xts" in O){delete O.xts;}for(var L=0,K=M.length;L<K;L++){var Q=M[L];if(Q&&F.equals(Q.url,N.url)&&F.equals(Q.params,O)){P.idx=L;break;}}return P;}function C(L){var K=H(L),M=F.copy(L.params);delete M.xts;K.push({url:L.url,params:M,res:F.copy(L.response)});}function D(K){var L=E(K);if(L&&L.idx>=0){K.response=L.cache[L.idx].res;return true;}return false;}mstrmojo.AjaxCall=mstrmojo.declare(mstrmojo.QueuedXHR,null,{scriptClass:"mstrmojo.AjaxCall",method:"POST",url:"",params:null,onsuccess:null,onerr:null,oncomplete:null,oncancel:null,readCache:false,writeCache:false,cacheLevel:"",_cache:null,useQueue:false,init:function I(K){this._super(K);F.copy(K,this);},send:function A(){var K=this;if(this.readCache&&D(this)){this.onsuccess();return ;}this.request(this.method,this.url,{success:function(L){K.response=L;if(K.writeCache){C(K);}if(K&&K.onsuccess){K.onsuccess();}},failure:J(K,"onerr"),complete:J(K,"oncomplete")},this.params,!this.useQueue);},cancel:function G(){this._super();if(this.oncancel){this.oncancel();}}});mstrmojo.AjaxCall.CACHELEVEL_GLOBAL="global";mstrmojo.AjaxCall.CACHELEVEL_LOCAL="local";})();(function(){var D={};var B="XHRServerTransport";mstrmojo.XHRServerTransport={serverRequest:function A(I,G,F){var E=mstrmojo.all[I],H=D[G]=new mstrmojo.SimpleXHR();$MAPF(true,B,"transportRequest");if(F.params&&!F.params.sessionState&&mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){F.params.sessionState=mstrApp.sessionState;}H.request(F.config.method||"POST",F.taskURL||mstrConfig.taskURL,{success:function(J){if(typeof J==="string"&&J[0]==="{"){try{J=JSON.parse(J);}catch(K){}}if(J.mstrerr){J.code=J.mstrerr.code;J.message=J.mstrerr.message;}E&&E.response(G,true,J);},failure:function(L){var M=L.status,K=L.getResponseHeader("X-MSTR-TaskErrorCode"),J;if(M===0){M=K||M;J=mstrmojo.desc(15666,"The connection to the MicroStrategy Web Server failed. Please wait a few minutes and then attempt to reload the page. If the condition persists, please contact your administrator.");}else{M=K||M||"-999";J=L.getResponseHeader("X-MSTR-TaskFailureMsg")||L.responseText||"Unexpected error, please contact your administrator";}E&&E.response(G,false,{code:M,message:J});},complete:function(){delete D[G];},textResponse:F.callback.textResponse},F.params);},cancelRequest:function C(F){var G=D[F],E=false;if(G){E=G.cancel();delete D[F];}$MAPF(false,B,"transportRequest");return E;}};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom");var D=mstrmojo.dom,H=D.position,I=Math;function F(V,P,N){var O=this._ellTestNodes||{},K=O[V],M=mstrmojo.css.getComputedStyle(P),J=["width","height"];if(N){J.reverse();}var S=J[0],Q=J[1];if(!K||!D.contains(this.domNode,K.n,true,document.body)){var L=P.cloneNode(true);L.removeAttribute("id");L.removeAttribute("onclick");var U=L.style;U.position="absolute";U.top="-10000px";U.maxHeight=U.maxWidth="none";U[S]="auto";P.parentNode.appendChild(L);var R=parseInt(M["max-"+S],10);if(isNaN(R)){R=parseInt(M[S],10);}K=O[V]={n:L,m:R,d:S.substr(0,1)};if(K.m>0){this._ellTestNodes=O;}}else{K.n.innerHTML=P.innerHTML;}K.n.style[Q]=M[Q];return K;}function B(K,L){var M=this.ellipsisText;switch(this.ellipsisPosition){case"middle":var J=I.floor(L/2);return K.slice(0,J).join("")+M+K.slice(-J).join("");case"end":return K.slice(0,L).join("")+M;default:return K.join("");}}var G=4;mstrmojo._SupportsEllipsisText=mstrmojo.provide("mstrmojo._SupportsEllipsisText",{_mixinName:"mstrmojo._SupportsEllipsisText",ellipsisText:"\u2026",ellipsisPosition:"end",ellipsize:function A(V,P,O){var W=P.innerHTML;if(!W){return false;}var K=F.call(this,V,P,O),M=function(){var X=H(K.n)[K.d];return(X<=K.m);};if(M()){return false;}var L=K.n,J=W.split(""),R=0,N=J.length,Q,S;while(R<N){var U=I.floor((R+N)/2);W=L.innerHTML=B.call(this,J,U);if(M()){R=U+1;}else{N=U-1;}if(N-R<G){for(S=R-1;S<N+1;S++){W=L.innerHTML=B.call(this,J,S);if(!M()){break;}Q=W;}}if(Q){P.innerHTML=Q;break;}}return true;},ellipsizeElements:function C(U,O,N){var L=F.apply(this,arguments),M=function(){var V=H(L.n)[L.d];return(V<=L.m);};if(M()){return false;}var Q=this.ellipsisText;var P=this;var K=document.createElement("span");K.innerHTML=Q;var J=function(Z,Y){var V=Z.slice(0,Y).concat([K]);var X=document.createElement("div");for(var W=0;W<V.length;W++){X.appendChild(V[W]);}return X.innerHTML;};var S=function(W,a,Z,V){var c=0,X=a.length,b,f,d;var Y=function(g){while(g.hasChildNodes()){g.removeChild(g.lastChild);}};while(c<X){var e=I.floor((c+X)/2);if(V){f=Z.call(P,a,e);W.nodeValue=f;}else{Y(W);f=Z.call(P,a,e);W.innerHTML=f;}if(M()){c=e+1;}else{X=e-1;}if(X-c<G){d=c==0?0:c-1;for(;d<X+1;d++){if(V){f=Z.call(P,a,d);W.nodeValue=f;}else{Y(W);f=Z.call(P,a,d+1);W.innerHTML=f;}if(!M()){if(!V){W.removeChild(W.lastChild);b=f=W.innerHTML;}break;}if(!V){W.removeChild(W.lastChild);f=W.innerHTML;}b=f;}}if(b){if(V){W.nodeValue=b;}else{W.innerHTML=b;}break;}}};var R=function(Y){if(Y.nodeType==3){var Z=Y.nodeValue;if(!Z){return false;}S(Y,Z.split(""),B,true);return true;}else{var W=Y.childNodes;if(!W||W.length===0){return false;}var X=[];for(var V=0;V<W.length;V++){X[V]=W[V];}if(X.length!=1||X[0].nodeType!=3){S(Y,X,J,false);}return R(Y.lastChild);}};O.style.visibility="visible";L.n.style.visibility="hidden";R(L.n);O.style.visibility="hidden";L.n.style.visibility="visible";return true;},unrender:function E(J){delete this._ellTestNodes;this._super(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.css");var G=mstrmojo.array,F=mstrmojo.expr,H=mstrmojo.css;mstrmojo._IsExprNode=mstrmojo.provide("mstrmojo._IsExprNode",{ind:function B(){var L=this.parent;if(L&&L.indent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.indent(K);}}},out:function D(){var L=this.parent;if(L&&L.outdent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.outdent(K);}}},andOrTxt:function A(){var M=this.parent,K=M&&M.data,L="",N=this.data;if(K&&(K.et===F.ET.ANDOR)&&K.fn){L=K.fn+(N&&N.not?"_"+F.FN.NOT:"");L=F.BRANCH_FNS[L];}return'<span class="mstrmojo-text mstrmojo-andor">'+L+"</span>";},getPrefixAndOrToolsMarkup:function(){return('<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5896,"Ungroup Conditions")+"</span>");},premousedown:function J(K){var L=mstrmojo.dom.eventTarget(K.hWin,K.e);if(this.prefixHoverNode&&mstrmojo.dom.contains(this.prefixHoverNode,L,false)){mstrmojo.dom.stopPropogation(K.hWin,K.e);return ;}if(this._super){this._super(K);}},isSelectableArea:function E(K){return true;},childIndex:function I(){var M=this.parent,K=M&&M.data,L=K&&K.nds,N=this.data;if(L&&N){return G.indexOf(L,N);}return -1;},toggleGroupBorder:function C(K){H.toggleClass(this.parent.itemsContainerNode.childNodes[this.childIndex()-1].firstChild,"upgroup",K);H.toggleClass(this.domNode,"downgroup",K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.string","mstrmojo.css");var K=mstrmojo.css,N=mstrmojo.string,H=mstrmojo.dom,L=13,C=27;function I(U){if(this._editComplete){return ;}var Y,R=false,X=this.text,V=false;if(U===C){Y=X;V=true;R=true;}if((!U&&U!==0)||(!this.allowNewLine&&U===L)){var S=this[this.editableSlot],W=S.innerText||S.textContent||"";if(!this.allowNewLine){Y=W.replace(/\n/g,"");}else{Y=W;}R=true;if(!this.allowEmptyText&&Y.length===0){Y=X;V=true;}}if(R){this._editComplete=true;Y=Y.replace(/\u00A0/g,"\u0020");this.text=Y;this.set("isEditing",false);this.onTextEditComplete(Y!==X,X);delete this._editComplete;}if(V){this.refresh();}}function E(R){var S={dblclick:"editOnDoubleClick",click:"editOnClick"};if(this[S[R.name]]||(R.name==="click"&&this.editOnTwoClicks)&&R.getTarget()===this[this.editableSlot]){this.set("isEditing",true);}}function F(U,S,R){if(typeof S["on"+R]!=="function"){H.attachMarkupEvent(U,S,R);}}mstrmojo._HasEditableText=mstrmojo.provide("mstrmojo._HasEditableText",{_mixinName:"mstrmojo._HasEditableText",editableSlot:"domNode",editButtonSlot:null,isEditing:false,editOnClick:true,editOnTwoClicks:false,firstClickTime:undefined,allowEmptyText:false,allowTrimming:true,allowNewLine:false,editOnDoubleClick:false,onTextEditBegin:mstrmojo.emptyFn,onTextEditComplete:mstrmojo.emptyFn,postBuildRendering:function A(){this._super();var U=this.editableSlot,R=this[U],V=this[this.editButtonSlot||U];K.addClass(R,"hasEditableText");this.text=this.text||R.innerText||R.textContent||"";R.innerHTML=this.getEditableTextInnerHTML();var S=this.id;if(this.editOnClick||this.editOnTwoClicks){F(S,V,"click");}F(S,V,"dblclick");F(S,R,"blur");F(S,R,"keyup");F(S,R,"keydown");},getEditableTextInnerHTML:function Q(){return this.allowHTML?this.text:N.encodeHtmlString(this.text,true).replace(/ (?= )/g,"&nbsp;");},onclick:function P(R){if(this.editOnClick){E.call(this,R);}if(this._super){this._super(R);}},onTwoClicks:function(R){if(this.editOnTwoClicks){E.call(this,R);}if(this._super){this._super(R);}},ondblclick:function G(R){E.call(this,R);},onblur:function M(){I.call(this);},onkeyup:function B(S){var R=window.event||S.e;I.call(this,R.keyCode);},onkeydown:function J(S){var R=window.event||S.e;if(R.keyCode===L){I.call(this,R.keyCode);S.cancel();}},_set_text:function D(U,R){var S=this.text;this.text=R;if(this.hasRendered){this[this.editableSlot].innerHTML=N.encodeHtmlString(R||"",true);}return(S!==R);},onisEditingChange:function O(){if(this.hasRendered){var R=this[this.editableSlot],S=!!this.isEditing;R.contentEditable=S;R.spellcheck=false;K.toggleClass(R,"editable",S);if(S){R.focus();H.setElementSelection(R);this.onTextEditBegin();}else{R.blur();R.scrollLeft=0;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css");var A=mstrmojo.css;mstrmojo.ui._HasUITheme=mstrmojo.provide("mstrmojo.ui._HasUITheme",{_mixinName:"mstrmojo.ui._HasUITheme",themeClassName:"",postBuildRendering:function B(){var D=this.themeClassName;if(D){this.onthemeClassNameChange({value:D});}return this._super();},onthemeClassNameChange:function C(D){var F=this.domNode;if(F){var G=D.value,E=D.valueWas;if(G){A.addClass(F,D.value);}if(E){A.removeClass(F,D.valueWas);}}}});mstrmojo.ui._HasUITheme.EnumThemeNames={LIGHT_THEME:"mojo-theme-light",DARK_THEME:"mojo-theme-dark"};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var F=mstrmojo.dom,I=mstrmojo.css,C="active";var A=false;mstrmojo.util.ui.SplitterParamsType=null;function H(N,Q){var P=Q.info,O=P&&P.min,M=P&&P.max,L=Q.start+(F.getMousePosition(N,window)[Q.mouseProp]-Q.mousePosition)*(P&&!!P.isReverseMove?-1:1);if(O!==undefined){L=Math.max(L,O);}if(M!==undefined){L=Math.min(L,M);}return L;}function G(M,L,N){return function(O){M.call(mstrmojo.all[L],O,N);};}function B(L,M){M.target.style[M.styleProp]=H(L,M)+"px";}function K(L,N){if(!A){return ;}var M=window.document;F.detachEvent(M,"mousemove",N.fnMove);F.detachEvent(M,"mouseup",N.fnUp);delete N.fnMove;delete N.fnUp;A=false;mstrApp.setInteractive(true);I.removeClass(N.target,C);this.splitterMoved(H(L,N)-N.start,N.info);(this.children||[]).forEach(function(O){O.domNode.style.pointerEvents="inherit";});this.splitterMouseUp();}function J(W){if(A){return ;}mstrApp.setInteractive(false);var L=this.id,M,N,Q=F.eventTarget(window,W),S=(Q.className.indexOf("v")===-1),R=S?"y":"x",P={};P.target=Q;P.info=this.getSplitterInfo(Q);N=P.info&&!!P.info.isReverseMove;M=S?"Top":N?"Right":"Left";P.start=N?parseInt(Q.style.right):Q["offset"+M];P.mouseProp=R;P.mousePosition=F.getMousePosition(W,window)[R];P.styleProp=M.toLowerCase();(this.children||[]).forEach(function(X){X.domNode.style.pointerEvents="none";});this.splitterMouseDown(P);I.addClass(Q,C);var O=G(B,L,P),V=G(K,L,P);var U=window.document;F.attachEvent(U,"mousemove",O);F.attachEvent(U,"mouseup",V);P.fnMove=O;P.fnUp=V;A=true;}mstrmojo.util.ui._HostsSplitter=mstrmojo.provide("mstrmojo.util.ui._HostsSplitter",{_mixinName:"mstrmojo.util.ui._HostsSplitter",registerSplitter:function E(L){this.splitterEvtMouseDownHandler=G(J,this.id);F.attachEvent(L,"mousedown",this.splitterEvtMouseDownHandler);},unRegisterSplitter:function D(L){if(this.splitterEvtMouseDownHandler){F.detachEvent(L,"mousedown",this.splitterEvtMouseDownHandler);}},getSplitterInfo:mstrmojo.emptyFn,splitterMoved:mstrmojo.emptyFn,splitterMouseDown:mstrmojo.emptyFn,splitterMouseUp:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J=mstrmojo.dom,A=false,M=3.5,N=5,I=1,O=2;function D(b,Q){var W={},U=Q.info&&Q.info.min,a=Q.info&&Q.info.max,Y=Q.target,Z=Y&&Y.getAttribute("pos"),c=Z&&parseInt(Z,10),S=Y&&!Y.isSide;W.x=Math.min(Math.max(U.x,J.getMousePosition(b,window).x),a.x);W.y=Math.min(Math.max(U.y,J.getMousePosition(b,window).y),a.y);var V=Q.targetContainer,X=V.parent.snapGuide;var P=X.findIntersect(W.y,"y"),R=X.findIntersect(W.x,"x");W.y=P?P.mid:W.y;W.x=R?R.mid:W.x;W.shouldYSnap=P!==null;W.shouldXSnap=!!R&&((c===O)||(S&&c===I));return W;}function B(Y,Q){var U=Q.targetContainer,V=U.parent.snapGuide,R=Y.x,Z=Y.width,P=R+Z,a=Y.y,S=Y.height,X=a+S,W=[R,P,a,X].reduce(function(c,d,b){var e=V.findIntersect(d,b&2?"y":"x");c.push(e);return c;},[]);W.forEach(function(b,c){if(b!==null){Q.highLight.children[c].style.background="#EF3921";Q.highLight.children[c].style[c&2?"top":"left"]=W[c].mid+"px";}else{Q.highLight.children[c].style.background="";}});[].forEach.call(Q.boxOverlay.children,function(c,b){mstrmojo.hash.copy({left:((b%2?Y.x:b?Y.x+Y.width:Y.x))+"px",top:((b%2?b&2?Y.y+Y.height:Y.y:Y.y))+"px",width:(b%2?Y.width:3)+"px",height:(b%2?3:Y.height)+"px"},c.style);});}function K(R,P,Q){return function(S){R.call(mstrmojo.all[P],S,Q);};}function C(P,Q){var R={};if(Q.isSide){if(Q.isV){R.x=P.x>Q.info.axis.x?Q.info.axis.x:P.x;R.y=Q.info.axis.y;R.width=Math.abs(P.x-Q.info.axis.x)+(P.shouldXSnap?0:M);R.height=Q.boxRect.height;}else{R.x=Q.info.axis.x;R.y=P.y>Q.info.axis.y?Q.info.axis.y:P.y;R.width=Q.boxRect.width;R.height=Math.abs(P.y-Q.info.axis.y);}}else{R.x=P.x>Q.info.axis.x?Q.info.axis.x:P.x;R.y=P.y>Q.info.axis.y?Q.info.axis.y:P.y;R.width=Math.abs(P.x-Q.info.axis.x)+(P.shouldXSnap?0:N);R.height=Math.abs(P.y-Q.info.axis.y);}return R;}function L(P,Q){var R=D(P,Q);B(C(R,Q),Q);}function H(P,Q){if(!A){return ;}J.detachEvent(window.document,"mousemove",Q.fnMove);J.detachEvent(window.document,"mouseup",Q.fnUp);A=false;mstrApp.setInteractive(true);(this.children||[]).forEach(function(U){U.domNode.style.pointerEvents="inherit";});var S=D(P,Q);this.resizerMouseUp(C(S,Q),Q);var R=Q.highLight;if(R){this.toggleGuidesDiv(R,false);delete Q.highLight;}delete Q.fnMove;delete Q.fnUp;delete Q.boxOverlay;}function G(Y){if(A){return ;}mstrApp.setInteractive(false);var Q={},W=J.eventTarget(window,Y);Q.boxRect=this.domNode.getBoundingClientRect();Q.info=this.getResizerInfo(W.getAttribute("pos")^2,W.isSide);Q.startPos=J.getMousePosition(Y,window);Q.target=W;if(W.isSide){Q.isSide=W.isSide;}Q.isV=W.isV;(this.children||[]).forEach(function(a){a.domNode.style.pointerEvents="none";});var Z=this.parent.parentRect||this.domNode.parentNode.getBoundingClientRect();var V=document.createElement("div");for(var U=0;U<4;++U){var P=document.createElement("div");P.style.position="fixed";["left","top","width","height"].forEach(function(a){P.style[a]=U&2?a!=="height"?Z[a]+"px":"1px":a!=="width"?Z[a]+"px":"1px";});V.appendChild(P);}V.style.zIndex=this.zIndex||"1";V.style.position="absolute";this.toggleGuidesDiv(V,true);Q.highLight=V;Q.boxOverlay=document.createElement("div");Q.targetContainer=this;for(var U=0;U<4;++U){var R=document.createElement("div");R.setAttribute("pos",U);R.style.position="fixed";R.style.background="#4286f4";Q.boxOverlay.appendChild(R);}this.resizerMouseDown(Q);var S=K(L,this.id,Q),X=K(H,this.id,Q);J.attachEvent(window.document,"mousemove",S);J.attachEvent(window.document,"mouseup",X);Q.fnMove=S;Q.fnUp=X;A=true;}mstrmojo.vi.ui.rw._boxCornerResizer=mstrmojo.provide("mstrmojo.vi.ui.rw._boxCornerResizer",{_mixinName:"mstrmojo.vi.ui.rw._boxCornerResizer",registerResizerHandler:function E(P){this.resizerEvtMouseDownHandler=K(G,this.id);J.attachEvent(P,"mousedown",this.resizerEvtMouseDownHandler);},unregisterResizerHandler:function F(P){if(this.resizerEvtMouseDownHandler){J.detachEvent(P,"mousedown",this.resizerEvtMouseDownHandler);}},getResizerInfo:mstrmojo.emptyFn,resizerMouseUp:mstrmojo.emptyFn,resizerMouseDown:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.css");function B(){var D=this.maskNode,E=this.isMasked;D.style.display=E?"block":"none";mstrmojo.css.toggleClass(D,"masked",E);}mstrmojo.vi.ui._HasMask=mstrmojo.provide("mstrmojo.vi.ui._HasMask",{_mixinName:"mstrmojo.vi.ui._HasMask",isMasked:false,postBuildRendering:function C(){if(this._super){this._super();}B.call(this);},onisMaskedChange:function A(){if(!this.hasRendered){return ;}B.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.color","mstrmojo.css","mstrmojo.hash");var A=mstrmojo.color,E=mstrmojo.css,B=mstrmojo.hash;function G(J){J=D(J);if(isNaN(J)){J=0;}J%=16777216;return{b:J%(1<<8),g:(J%(1<<16))>>8,r:(J%(1<<24))>>16};}function F(N,O,M){N=D(N);M=B.copy(M,{retainGradientObject:false});if(C(N)){var L=F(N.c1,O),J=F(N.c2,O);if(M.retainGradientObject){return{c1:L,c2:J,or:N.or};}return E.buildGradient(N.or,L,J).v;}if(typeof O==="number"){var K=G(N);if(isNaN(N)){O=0;}return"rgba("+K.r+" ,"+K.g+" ,"+K.b+" ,"+O+" )";}else{if(isNaN(N)){N=0;}return"#"+(16777216+N%16777216).toString(16).substring(1,7);}}function D(L){var K=L.c1,J=L.c2;if(C(L)){return{c1:D(K),c2:D(J),or:L.or};}if(typeof L==="number"){return L;}if(typeof L!=="string"){return NaN;}if(L[0]!=="#"){return parseInt(L,10);}if(L.length===4){L=L[0]+L[1]+L[1]+L[2]+L[2]+L[3]+L[3];}return parseInt(L.substring(1,7),16);}function I(L,J){var O=L.value,Q=L.opacity;if(C(O)){return["c1","c2"].reduce(function(W,X,V){var Y=I({value:O[X],opacity:Q},J);W.value[X]=Y.value;if(V===0){W.opacity=Y.opacity;}return W;},{value:{or:O.or}});}if(O==="transparent"){L.value=J.value;}var N=A.hex2rgb(F(L.value)),M=A.hex2rgb(F(J.value)),U=L.opacity,S=J.opacity,R=1-U,P,K;K=U+S*R;P=N.map(function(V,W){return(V*U+M[W]*S*R)/K;});return{value:"#"+A.rgb2hex.apply(undefined,P),opacity:K};}function C(J){return J&&["c1","c2","or"].every(function(K){return J.hasOwnProperty(K);});}mstrmojo.util.color=mstrmojo.provide("mstrmojo.util.color",{getCSSColorString:F,getColorValue:D,mix:I,isGradientColor:C,getRGB:G,isBrightColor:function H(N){var L=N>>16,K=(N&65280)>>8,J=(N&255),M=(L*299+K*587+J*114)/1000;return M>150;},createCanvasFillPattern:function(L,R,K,Q,J,P){var M=L.value,O=L.opacity,N;if(C(M)){N=R.createLinearGradient(K,Q,J,P);N.addColorStop(0,F(M.c1,O));N.addColorStop(1,F(M.c2,O));}else{N=F(M,O);}return N;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var C=mstrmojo.dom,G=100,L=700;var B="mojo-safari-hide-nativeTooltip",H=mstrmojo.css;function M(O,N){return function(Q){var P=mstrmojo.all[O];if(P.customTooltipHandler){P.customTooltipHandler(Q);}P[(N?"move":"show")+"Tooltip"](Q,self);};}function A(){var O=this.tooltipNode||this.domNode,Q=this.id,N,P="_ontooltip"+(this.isDynamicTooltip?"move":"over");if(!this._ontooltipout){this._ontooltipout=function(R){mstrmojo.all[Q].hideTooltip(R,self);};}if(!this[P]){this[P]=M(Q,this.isDynamicTooltip);}O=[].concat(O);for(N=0;N<O.length;N++){O[N].removeAttribute("title");C.attachEvent(O[N],(this.isDynamicTooltip?"mousemove":"mouseover"),this[P]);C.attachEvent(O[N],"mouseout",this._ontooltipout);}}function I(){var Q=this.tooltipNode||this.domNode,P;if(Q&&Q.constructor!==Array){Q=[Q];}if(Q){var R=this._ontooltipover,O=this._ontooltipout,N=this._ontooltipmove;for(P=0;P<Q.length;P++){if(R){C.detachEvent(Q[P],"mouseover",R);}if(O){C.detachEvent(Q[P],"mouseout",O);}if(N){C.detachEvent(Q[P],"mousemove",N);}}}}mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,isDynamicTooltip:false,tooltipNode:null,tooltipOpenDelay:700,isIgnoreTooltipCloseDelay:false,hasWidgetContent:false,tooltipCloseDelay:G,hasOpenTooltip:false,postBuildRendering:function(){var N=this._super();if(this.useRichTooltip){A.call(this);}return N;},onuseRichTooltipChange:function K(){if(this.hasRendered){if(this.useRichTooltip){A.call(this);}else{I.call(this);this.hideTooltip();}}},showTooltip:function J(Q,P){var O=this;if(!O.hasOpenTooltip&&(!mstrApp.isInteractive||mstrApp.isInteractive&&mstrApp.isInteractive())){mstrmojo.requiresCls("mstrmojo.tooltip");if(this.updateTooltipConfig){this.updateTooltipConfig(Q);}window.clearTimeout(this._tooltipTimeOut);if(mstrmojo.dom.isIE){var S={};for(var N in Q){S[N]=Q[N];}Q=S;}var U=this.richTooltip?this.richTooltip.areaId:undefined;if(C.isSafari&&Q){var R=Q.srcElement;if(window.getComputedStyle(R)["text-overflow"]==="ellipsis"){this.baseElement=R;H.toggleClass(R,B,true);}}this._tooltipTimeOut=window.setTimeout(function(){var V=O.richTooltip;if(O._closeTooltipTimeout){window.clearTimeout(O._closeTooltipTimeout);delete O._closeTooltipTimeout;}mstrmojo.tooltip.open(O,Q,P);O.tooltip.onmouseover=function(){if(O.richTooltip&&O.richTooltip.enableHover){window.clearTimeout(O._closeTooltipTimeout);window.clearTimeout(O._deactivationTimeout);if(O.tooltip){O.tooltip.onmouseout=function(W){var X=W.e;if((!X.toElement&&!X.relatedTarget)||!C.contains(this.domNode,W.e.toElement||W.e.relatedTarget)){O.hideTooltip();}};}}};O.tooltip.allowOtherTooltips=O.allowOtherTooltips;if(V&&V.onClose){O.tooltip.onClose=V.onClose;}O.hasOpenTooltip=true;O._hasActiveArea=true;O._tooltipAreaId=U;window.clearTimeout(O._deactivationTimeout);delete O._deactivationTimeout;},(this._hasActiveArea&&U&&U===this._tooltipAreaId)?0:this.tooltipOpenDelay);}},moveTooltip:function D(N,P){if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);this._tooltipTimeOut=null;mstrmojo.tooltip.close();}var R=this,O=N,Q=P;this._tooltipTimeOut=setTimeout(function(){mstrmojo.tooltip.open(R,O,Q);},this.tooltipOpenDelay);},hideTooltip:function F(){var N=this;if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);}if(C.isSafari&&this.baseElement){H.toggleClass(this.baseElement,B,false);}if(this._closeTooltipTimeout){window.clearTimeout(this._closeTooltipTimeout);}if(this._hasActiveArea&&!this._deactivationTimeout){this._deactivationTimeout=window.setTimeout(function(){delete N._deactivationTimeout;delete N._hasActiveArea;delete N._tooltipAreaId;},100);}mstrmojo.requiresCls("mstrmojo.tooltip");if((!this.isIgnoreTooltipCloseDelay)&&N.richTooltip&&N.richTooltip.enableHover){this._closeTooltipTimeout=window.setTimeout(function(){mstrmojo.tooltip.close();delete N._closeTooltipTimeout;},N.richTooltip.tooltipCloseDelay||this.tooltipCloseDelay);}else{if(N.tooltip){this.isIgnoreTooltipCloseDelay=false;mstrmojo.tooltip.close();}}this.hasOpenTooltip=false;},unrender:function E(N){I.call(this);this.hideTooltip();this._super(N);}});mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY=L;mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY=G;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.num","mstrmojo.color","mstrmojo.hash","mstrmojo.array");var AK=mstrmojo.color,a=mstrmojo.hash,BW=mstrmojo.array,BR=mstrmojo.css,l=mstrmojo.num;var BU=1,Aw=2,Ay=3,BD=4,Ae=5,Af=6;var Bf="FormattingFont",L="FormattingAppearance",c="FormattingAlignment",Al="FormattingSize",V="FormattingPatterns",I="FormattingBorder",BC="FormattingOrder",H="FormattingView",S="FormattingSelector",A0="Template Formatting",P="FormattingPadding",Au="AnalyticalEngineProperties",A4="RWDocumentProperties",BM="FormattingPage",R="Mobile",Y="VLDB Select",AE="FormattingNumber",AZ="RWDExecution";var At=1;var o="n",Q="h",BX="w",AI="wm",BJ="pw",b="ml",BK="mr",AA="upwalw",x="ff",Ao="fsz",BP="fw",AJ="fit",BQ="fun",u="fst",z="fc",Z="alh",y="alv",Ai="atw",AQ="atd",h="textOverflow",As="bc",E="bgs",K="btc",Ar="brc",Ab="bbc",w="blc",q="bts",BZ="brs",BE="bbs",Ah="bls",AW="borderColor",BA="borderStyle",j="zIndex",AY="showTitleBar",p="title",A8="ctrlStyle",AC="ctrlOrientation",A7="ctrlOrientationBehavior",n="ctrlMultiselect",k="ctrlAutoSearchEnabled",C="ciwm",BL="cmcy",A9="sec",t="easow",AP="layoutXml",M="lockAspectRatio",Aq="ism",m="shw",BB="mg",BY="lhv",e="gridVPadding",An="gridHPadding",Am="ln",AO="sar",B="hnv",Ak="iw",Ag="ih",AS="tsp",Ac="visible",W="rf",Be="jad",Av="jdc",AL="ode",BF="fs",BI="ssc",i="sstyle",AH="hgl",Ax="nct",A6="ncp",f="ncs",BN="ndp",G="nfs",D="nnn",BT="nth",Bd="gi",A2="stfurh",d="stfuch",Bb="stfuva",N="olm",BO="gdc",Bc="gda",AX="layoutstyle",Ba="hideVizBoxShadow";function U(Bg){return Bg;}function AU(Bg){return parseInt(Bg,10);}var AG={name:"encode",_def:U};AG[Ay]=function(Bg){return Bg?1:0;};AG[Aw]=function(Bg){if(Bg==="transparent"){return -1;}if(Bg.length===4){Bg=Bg.replace(/([0-9a-f])/ig,"$1$1");}Bg=AK.rgbStr2hex(Bg);return parseInt(Bg.substring(5)+Bg.substring(3,5)+Bg.substring(1,3),16);};AG[BD]=AU;AG[BU]=function(Bg){if(typeof Bg==="number"){return l.toLocaleString(Bg);}return U(Bg);};AG[Af]=function(Bi){if(Bi==="none"){return 0;}var Bh=Bi.match(/([0-9]+[,\.]?[0-9]*pt)/)[0],Bg=Bi.match(/pt ([\w\W]*)/)[1];if(Bh==="2pt"){return 5;}switch(Bg){case"solid":return 1;case"dashed":return 3;case"dotted":return 4;default:throw new Error("Invalid border style value in FormatModel::encodeValue.");}};var BV={name:"decode",_def:U};BV[Ay]=function(Bg){return parseInt(Bg,10)===1;};BV[Aw]=function(Bg){if(Bg===-1){return"transparent";}if(typeof Bg==="number"){return AK.decodeColor(Bg);}if(Bg.length===4){return Bg.replace(/([0-9a-f])/ig,"$1$1");}return AK.rgbStr2hex(Bg);};BV[BD]=AU;BV[Af]=function(Bi){if(Bi===undefined||Bi===0){return"none";}var Bh="1pt",Bg="solid";if(Bi===5){Bh="2pt";}if(Bi===3){Bg="dashed";}else{if(Bi===4){Bg="dotted";}}return Bh+" "+Bg;};function BG(){return this.pn.toLowerCase();}function AR(Bg,Bi,Bj){var Bh=document.createElement("div");Bh.style[Bj||Bi]=Bg[Bi];return Bh;}function J(Bg){return function(){return AK.rgbStr2hex(Bg.apply(this,arguments));};}function Ap(){var Bg=BG.call(this);return Bg==="underline"?Bg:"line-through";}var A3={name:"extract"},X=A3._def=function(Bg,Bi,Bj){var Bh=AR(Bg,Bi||this.getFormatBlockName(),Bj);return Bh.style[this.getCssName()];};A3[Aw]=J(X);function AB(Bg){return X.call(this,Bg,this.getFormatBlockName())===BG.call(this);}function A(Bg){var Bh=X.call(this,Bg,this.getFormatBlockName(),this.getCssName());return Bh.indexOf(Ap.call(this))>-1;}function A1(Bg){var Bh=this.getFormatBlockName();return AK.rgbStr2hex(X.call(this,Bg,Bh,Bh+this.pn));}var BS={name:"resolve"},g=BS._def=function(Bg,Bj,Bi,Bk){Bi=Bi||this.getFormatBlockName();var Bh=AR(Bg,Bi);Bh.style[Bk||this.getCssName()]=Bj;return Bh.style[BR.convertCssToCamelCase(Bi)];};BS[Aw]=function(Bg,Bi,Bh,Bj){if(Bi.or!==undefined){return Bi;}return AK.rgbStr2hex(g.call(this,Bg,Bi,Bh,Bj));};function Aa(Bg,Bh){return g.call(this,Bg,Bh?BG.call(this):"normal");}function AV(Bh,Bj){var Bi=(Bh[this.getFormatBlockName()]||"").split(" "),Bg=Ap.call(this);if(Bj){if(Bi.indexOf(Bg)===-1){Bi.push(Bg);}}else{Bi=Bi.filter(function(Bk){return Bk!==Bg;});}return g.call(this,Bh,Bi.join(" "));}var Aj={name:"update"},BH=Aj._def=function(Bg,Bh){Bg[this.getFormatBlockName()]=this.resolve(Bg,Bh);return Bg;};var AT={};AT[o]={ps:L,pn:"Name",pt:BU};AT[Q]={ps:Al,pn:"Height",pt:BU};AT[BX]={ps:Al,pn:"Width",pt:BU};AT[AI]={ps:Al,pn:"WidthMode",pt:BD};AT[BJ]={ps:BM,pn:"PageWidth",pt:BU};AT[b]={ps:BM,pn:"MarginLeft",pt:BU,fn:"margin-left"};AT[BK]={ps:BM,pn:"MarginRight",pt:BU,fn:"margin-right"};AT[AA]={ps:BM,pn:"UsePageWidthAsLayoutWidth",pt:Ay};AT[x]={ps:Bf,pn:"Name",pt:BU,fn:"font",cn:"fontFamily",extract:function(){return X.apply(this,arguments).replace(/['"]/g,"");},resolve:function(Bg,Bi){var Bh=AR(Bg,"font");Bh.style.fontFamily="'"+Bi+"'";return Bh.style.font;}};AT[Ao]={ps:Bf,pn:"Size",pt:BD,fn:"font",cn:"fontSize"};AT[BP]={ps:Bf,pn:"Bold",pt:Ay,fn:"font",cn:"fontWeight",extract:AB,resolve:Aa};AT[AJ]={ps:Bf,pn:"Italic",pt:Ay,fn:"font",cn:"fontStyle",extract:AB,resolve:Aa};AT[BQ]={ps:Bf,pn:"Underline",pt:Ay,fn:"text-decoration",extract:A,resolve:AV};AT[u]={ps:Bf,pn:"Strikeout",pt:Ay,fn:"text-decoration",extract:A,resolve:AV};AT[z]={ps:Bf,pn:"Color",pt:Aw};AT[Z]={ps:c,pn:"Horizontal",pt:BD,fn:"text-align"};AT[Ai]={ps:c,pn:"TextWrap",pt:Ay,fn:"white-space"};AT[AQ]={ps:c,pn:"TextDirection",pt:BD};AT[y]={ps:c,pn:"Vertical",pt:BD};AT[h]={ps:Al,pn:"TextOverflow",pt:Ay};AT[As]={ps:V,pn:"FillColor",pt:Aw,x:At,fn:"background-color",update:function(Bg,Bi){var Bh=Bg.fx;if(Bi.or!==undefined){if(!Bh){Bh=Bg.fx={};}var Bj=Bh.gd=Bh.gd||{};Bj.ec=Bi.c2;Bj.sc=Bi.c1;Bj.t=Bi.or;delete Bg[this.getFormatBlockName()];Bg.fx=Bh;}else{if(Bh){delete Bh.gd;}BH.call(this,Bg,Bi);}return Bg;}};AT[E]={ps:V,pn:"FillStyle",pt:BD};AT[BI]={ps:V,pn:"SelectorSelectionColor",pt:Aw};AT[i]={ps:V,pn:"SelectorSelectionFillStyle",pt:BD};AT[K]={ps:I,pn:"TopColor",pt:Aw,fn:"border",extract:A1};AT[Ar]={ps:I,pn:"RightColor",pt:Aw,fn:"border",extract:A1};AT[Ab]={ps:I,pn:"BottomColor",pt:Aw,fn:"border",extract:A1};AT[w]={ps:I,pn:"LeftColor",pt:Aw,fn:"border",extract:A1};AT[AW]={ps:I,pn:["TopColor","RightColor","BottomColor","LeftColor"],pt:Aw,fn:"border",extract:A1,resolve:J(function(Bg,Bi){var Bj=this.getFormatBlockName(),Bh=g.call(this,Bg,Bi,Bj,Bj+"Color"),Bk=Bh.indexOf("rgb");if(Bk>-1){Bh=Bh.slice(0,Bk)+AK.rgbStr2hex(Bh.slice(Bk));}return Bh;})};AT[BA]={ps:I,pn:["TopStyle","RightStyle","BottomStyle","LeftStyle"],pt:Af,fn:"border",extract:A1,resolve:function(Bg,Bj){var Bh=Bj.split(" "),Bk=this.getFormatBlockName();if(!Bg[Bk]){Bg[Bk]="transparent";}Bg[Bk]=g.call(this,Bg,Bh[0],Bk,Bk+"Width");var Bi=g.call(this,Bg,Bh[1]||"none",Bk,Bk+"Style"),Bl=Bi.indexOf("rgb");if(Bl>-1){Bi=Bi.slice(0,Bl)+AK.rgbStr2hex(Bi.slice(Bl));}return Bi;}};AT[q]={ps:I,pn:"TopStyle",pt:Af,fn:"border",extract:A1};AT[BZ]={ps:I,pn:"RightStyle",pt:Af,fn:"border"};AT[BE]={ps:I,pn:"BottomStyle",pt:Af,fn:"border",extract:A1};AT[Ah]={ps:I,pn:"LeftStyle",pt:Af,fn:"border",extract:A1};AT[j]={ps:BC,pn:"ZIndex",pt:BD,fn:"z-index"};AT[AY]={ps:H,pn:"ShowTitleBar",pt:Ay};AT[p]={ps:H,pn:"Title",pt:BU};AT[A8]={ps:S,pn:"Style",pt:BD};AT[AC]={ps:S,pn:"Orientation",pt:BD};AT[A7]={ps:S,pn:"OrientationBehavior",pt:BD};AT[n]={ps:S,pn:"Multiselect",pt:Ay};AT[k]={ps:S,pn:"AutoSearchEnabled",pt:Ay};AT[C]={ps:S,pn:"ItemWidthMode",pt:BD};AT[BL]={ps:S,pn:"MetricConditionType",pt:BD};AT[A9]={ps:S,pn:"ShowElementCount",pt:BD};AT[t]={ps:S,pn:"ExportAsShownOnWeb",pt:BD};AT[AP]={ps:Al,pn:"LayoutXML",pt:Ae};AT[M]={ps:Al,pn:"LockAspectRatio",pt:Ay};AT[Aq]={ps:Al,pn:"ImageSizeMode",pt:BD};AT[Ag]={ps:Al,pn:"ImageHeight",pt:BU};AT[Ak]={ps:Al,pn:"ImageWidth",pt:BU};AT[AS]={ps:A4,pn:"layoutBarPosition",pt:BU};AT[BF]={ps:A4,pn:"ExecutionFullScreenMode",pt:Ay};AT[AX]={ps:A4,pn:"LayoutStyle",pt:BD};AT[Ba]={ps:A4,pn:"hideVizBoxShadow",pt:BD};AT[Ac]={ps:L,pn:"Visible",pt:Ay};AT[Am]={ps:A0,pn:"LongNames",pt:BU};AT[N]={ps:A0,pn:"Indented",pt:BD};AT[AO]={ps:Au,pn:"ShowAllRows",pt:BU};AT[B]={ps:Au,pn:"HideNullZeroValues",pt:BU};AT[An]={ps:P,pn:["LeftPadding","RightPadding"],pt:BU};AT[e]={ps:P,pn:["TopPadding","BottomPadding"],pt:BU};AT.rowsshw={ps:A0,pn:"ShowRowHeaders",pt:BU};AT.rowsmg={ps:A0,pn:"MergeCells",pt:BU};AT.rowslhv={ps:A0,pn:"LockRowHeaders",pt:BU};AT.colsshw={ps:A0,pn:"ShowColumnHeaders",pt:BU};AT.colsmg={ps:A0,pn:"MergeColumnCells",pt:BU};AT.colslhv={ps:A0,pn:"LockColumnHeaders",pt:BU};AT[A2]={ps:A0,pn:"SubtotalFormatUseRowHeaders",pt:BU};AT[d]={ps:A0,pn:"SubtotalFormatUseColumnHeaders",pt:BU};AT[Bb]={ps:A0,pn:"SubtotalFormatUseValues",pt:BU};AT[W]={ps:R,pn:"RefreshFrequency",pt:BD};AT[Be]={ps:Y,pn:"Join Across Datasets",pt:BD};AT[Av]={ps:Y,pn:"MCE Join To Get Data Combination",pt:BD};AT[AL]={ps:AZ,pn:"OnDemandEvaluation",pt:BD};AT[AH]={ps:L,pn:"Highlight",pt:BD};AT[Ax]={ps:AE,pn:"Category",pt:BD};AT[G]={ps:AE,pn:"Format",pt:BU};AT[f]={ps:AE,pn:"CurrencySymbol",pt:BU};AT[BN]={ps:AE,pn:"DecimalPlaces",pt:BD};AT[A6]={ps:AE,pn:"CurrencyPosition",pt:BD};AT[D]={ps:AE,pn:"NegativeNumbers",pt:BD};AT[BT]={ps:AE,pn:"ThousandSeparator",pt:BD};AT[Bd]={ps:L,pn:"GroupInfo",pt:BU};AT[BO]={ps:V,pn:"GradientColor",pt:Aw};AT[Bc]={ps:V,pn:"GradientAngle",pt:BD};BW.forEach(a.keyarray(AT),function(Bg){var Bh=AT[Bg];Bh.getFormatBlockName=function(){var Bj=this.fn;if(!Bj){var Bi=this.pn;Bj=Bi.charAt(0).toLowerCase()+Bi.substr(1);}return Bj;};Bh.getCssName=function(){var Bi=this.getFormatBlockName.call(this),Bj=this.cn;if(!Bj){Bj=BR.convertCssToCamelCase(Bi);}return Bj;};BW.forEach([AG,BV,A3,BS,Aj],function(Bi){var Bj=Bi.name;Bh[Bj]=Bh[Bj]||Bi[Bh.pt]||Bi._def;});});function A5(Bj,Bi,Bg){var Bh=Bg[Bj.ps]=Bg[Bj.ps]||{};Bi=Bj.encode(Bi);BW.forEach([].concat(Bj.pn),function(Bk){Bh[Bk]=Bi;});return Bg;}function AN(Bm,Bl,Bg){var Bk=Bm.x;if(Bk){if((Bk&At)>0){var Bj=!!Bl.c1,Bi=0;if(Bj){A5(Bm,Bl.c1,Bg);var Bh=Bg[V];Bh.GradientColor=Bm.encode(Bl.c2);Bh.GradientAngle=Bl.or?0:90;Bh.GradientXOffset=0;Bh.GradientYOffset=0;Bi=2;}else{if(Bm.encode(Bl)===-1){Bi=1;}else{A5(Bm,Bl,Bg);}}return A5(AT[E],Bi,Bg);}}return null;}mstrmojo.models.FormatModel={getFormatUpdate:function Ad(Bh,Bk,Bg){var Bj=AT[Bh];if(!Bj){throw new Error("Invalid property "+Bh+" in FormatModel::getFormatUpdate.");}Bg=Bg||{};var Bi=AN.call(this,Bj,Bk,Bg);if(Bi){return Bi;}return A5(Bj,Bk,Bg);},getFormatPropertyInfo:function s(Bg){return AT[Bg];},getValueFromUpdate:function O(Bh,Bi){var Bk=AT[Bh],Bg=null;try{Bg=Bi[Bk.ps][Bk.pn];}catch(Bj){}return Bg;},getGradientValues:function AM(Bh){var Bg=Bh.fx&&Bh.fx.gd;if(Bg){var Bj={c1:Bg.sc,c2:Bg.ec,or:Bg.t};return Bj;}if(Bh[E]===2){if(!!Bh.bc.c1){return Bh.bc;}var Bi={c1:Bh.bc,c2:Bh.gdc,or:Bh.gda===90?0:1};return Bi;}return null;},decodeGradientValue:function F(Bg){if(Bg&&Bg.c1){Bg.c1=this.decodeValue(BO,Bg.c1);Bg.c2=this.decodeValue(BO,Bg.c2);return Bg;}return null;},decodeValue:function AF(Bg,Bh){return AT[Bg].decode(Bh);},updateFormatBlock:function Az(Bg,Bh,Bi){return AT[Bh].update(Bg,Bi);},getFormatBlockValue:function AD(Bg,Bh){return AT[Bh].extract(Bg);},GradientType:null,FormatObjectType:null,PROPERTY_INFO_TYPE:null,ENUM_PROPERTY_NAMES:{NAME:o,HEIGHT:Q,WIDTH:BX,WIDTH_MODE:AI,PAGE_WIDTH:BJ,MARGIN_LEFT:b,MARGIN_RIGHT:BK,USE_PAGE_WIDTH_AS_LAYOUT_WIDTH:AA,FONT_FAMILY:x,FONT_SIZE:Ao,FONT_WEIGHT:BP,FONT_STYLE:AJ,UNDERLINE:BQ,LINE_THROUGH:u,COLOR:z,TEXT_ALIGN:Z,VERTICAL_ALIGN:y,TEXT_WRAP:Ai,TEXT_DIRECTION:AQ,TEXT_OVERFLOW:h,BACKGROUND_COLOR:As,FILL_STYLE:E,GRADIENT_COLOR:BO,GRADIENT_ANGLE:Bc,BORDER_TOP_COLOR:K,BORDER_RIGHT_COLOR:Ar,BORDER_BOTTOM_COLOR:Ab,BORDER_LEFT_COLOR:w,BORDER_TOP_STYLE:q,BORDER_RIGHT_STYLE:BZ,BORDER_BOTTOM_STYLE:BE,BORDER_LEFT_STYLE:Ah,BORDER_COLOR:AW,BORDER_STYLE:BA,Z_INDEX:j,SHOW_TITLE_BAR:AY,TITLE:p,CONTROL_STYLE:A8,CONTROL_ORIENTATION:AC,CONTROL_ORIENTATION_BEHAVIOR:A7,CONTROL_MULTISELECT:n,CONTROL_AUTOSEARCH:k,CONTROL_ITEM_WIDTH_MODE:C,CONTROL_METRIC_CONDITION_TYPE:BL,CONTROL_SHOW_ELEMENT_COUNT:A9,CONTROL_EXPORT_AS_SHOWN_ON_WEB:t,LAYOUT_XML:AP,LOCK_ASPECT_RATIO:M,IMAGE_SIZE_MODE:Aq,SHOW_HEADER:m,MERGE_HEADER:BB,LOCK_HEADER:BY,LONG_NAME:Am,SHOW_ALL_ROWS:AO,HIDE_NULL:B,IMAGE_WIDTH:Ak,IMAGE_HEIGHT:Ag,VISIBLE:Ac,LAYOUT_TAB_POSITION:AS,GRID_VERTICAL_PADDING:e,GRID_HORIZONTAL_PADDING:An,REFRESH:W,JOIN_ACROSS_DATASET:Be,MCE_JOIN_TO_GET_DATA_COMBINATION:Av,ON_DEMAND_EVALUATION:AL,FULL_SCREEN_MODE:BF,SELECTOR_SELECTION_COLOR:BI,SELECTOR_SELECTION_FILL_STYLE:i,VIZ_HIGHLIGHTING:AH,GROUP_INFO:Bd,SUBTOTAL_FORMAT_USE_ROWHEADERS:A2,SUBTOTAL_FORMAT_USE_COLUMNHEADERS:d,SUBTOTAL_FORMAT_USE_VALUES:Bb,OUTLINE:N,LAYOUT_STYLE:AX,VIZ_BOX_SHADOW_HIGHLIGHT:Ba},ENUM_PROPERTY_SETS:{FORMATTING_NUMBER:AE},ENUM_NUMBER_FORMAT_KEYS_OBJ:{CATEGORY:Ax,CURRENCY_POSITION:A6,CURRENCY_SYMBOL:f,DECIMAL_PLACES:BN,FORMAT:G,NEGATIVE_NUMBERS:D,THOUSAND_SEPARATOR:BT}};}());(function(){mstrmojo.requiresCls("mstrmojo.css");var F=mstrmojo.css,E="px",J="hasOwnAvatar",I={x:0,y:0};function B(L){var K=this.createAvatar(L.src.node,L);if(K){F.addClass(K,[this.avatarCssClass,J]);this.avatar=L.avatar=document.body.appendChild(K);}}function C(){var K=this.avatar;if(K){K.parentNode.removeChild(K);delete this.avatar;F.removeClass(K,[this.avatarCssClass,J]);}}mstrmojo._HasOwnAvatar=mstrmojo.provide("mstrmojo._HasOwnAvatar",{_mixinName:"mstrmojo._HasOwnAvatar",draggable:true,ownAvatar:true,avatarCssClass:"",restrictedToAxis:undefined,isDragValid:function H(K){if(this._super){return this._super(K);}return false;},ondragstart:function D(K){B.call(this,K);this.positionAvatar(K.src.pos,K);if(this._super){this._super(K);}},ondragmove:function A(K){this.positionAvatar(K.tgt.pos,K);if(this._super){this._super(K);}},ondragend:function A(K){C.call(this);if(this._super){this._super(K);}},createAvatar:mstrmojo.emptyFn,positionAvatar:function G(O,L){if(this.avatar){var N=this.avatar.style,M=this.restrictedToAxis,K=(L&&L.dragOffsets)||I;if(M!=="y"){N.left=O.x+K.x+E;}if(M!=="x"){N.top=O.y+K.y+E;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.fx");var e=mstrmojo.css,J=mstrmojo.dom,R=mstrmojo.array,N={v:{styleDim:"height",styleDir:"top",dimension:"h",position:"y",scroll:"scrollTop",scrollDimension:"scrollHeight",cls:"vertical",hostCls:"hasVertical",scrollNodeCls:"hasVertical"},h:{styleDim:"width",styleDir:"left",dimension:"w",position:"x",scroll:"scrollLeft",scrollDimension:"scrollWidth",cls:"horizontal",hostCls:"hasHorizontal",scrollNodeCls:"hasHorizontal"}},c="scrollingMode",V="scrolling",h=3;var O=J.getOSInfo().name.toLowerCase().indexOf("mac")>=0;function M(){return(this.scrollbarHostNode||(this.scrollNode&&this.scrollNode.parentNode));}function W(m,j){var l=this.scrollNode,i=M.call(this),k={v:m,h:j};R.forEach(["v","h"],function(o){var n=N[o];e.toggleClass(i,n.hostCls,k[o]);e.toggleClass(l,n.scrollNodeCls,k[o]);});}function S(j,i){var o=J.eventTarget(i,j),m=this.scrollNode,l=J.position(m),n=this.scrollTrackNodes,k=this.scrollBarNodes,p=function p(z){var x=o===n[z];if(x){var AA=N[z],q=k[z],AB=J.position(q),t=J.getMousePosition(j,i)[AA.position],u=t-AB[AA.position],s=u>0?1:-1,y=m[AA.scrollDimension],AC=Math.abs(u-(AB.h/2))*(y/l[AA.dimension]),w={};w[AA.scroll]={isStyle:false,start:m[AA.scroll],stop:m[AA.scroll]+(s*Math.min(y/3,500,AC)),ease:mstrmojo.ease.linear};(new mstrmojo.fx.AnimateProp({props:w,duration:200,interval:10,target:m})).play();}};p.call(this,"h");p.call(this,"v");}function C(j,i){var m=this.scrollNode,l=j.type==="mousewheel",k=l?-1:1;mstrmojo.array.forEach(["h","v"],function(u){var s=N[u],o=l?"wheelDelta":"delta",q=j[o+{h:"X",v:"Y"}[u]]*k,p=Math.abs(q),n=q/p,t=p===3&&J.isFF&&!O;m[s.scroll]+=t?n*40:q;});J.stopPropogation(i,j);J.preventDefault(i,j);}function g(n){var m=N[n],l=this.scrollNode,k=J.position(l),j=k[m.dimension],o=l[m.scrollDimension],i=Math.ceil(j)/o;return A(i,j,o);}function A(j,i,k){return(!isNaN(j)&&j<1)&&(Math.abs(i-k)>h);}function D(AI){var AB="px",t=N[AI],m=this.scrollNode,u=M.call(this),AK=J.position(m),w=AK[t.dimension],AD=m[t.scrollDimension],l=Math.ceil(w)/AD,AH=this.scrollBarNodes,q=AH[AI],z=this.scrollTrackNodes,AA=z[AI],AF=A(l,w,AD),n=t.cls;if(!q){AA=z[AI]=document.createElement("div");var o=this,y=function(AM){S.call(o,AM);},s=function(AM){C.call(o,AM);},AE=function(AO,AM,AN){J.attachEvent(AO,AM,AN);o.installedEventListeners.push({e:AO,evt:AM,fn:AN});};AE(AA,"click",y);AA.className="mstrmojo-scrolltrack "+n;q=AH[AI]=document.createElement("div");q.className="mstrmojo-scrollbar "+n;AA.appendChild(q);u.appendChild(AA);var AG=mstrApp.isSingleTier?"mousewheel":"wheel";AE(AA,AG,s);AE(q,AG,s);}var AL=q.style,p=(m[t.scroll]/m[t.scrollDimension]),j=J.delta(m,M.call(this))[t.position],AC=AA.style;if(AF){AC[t.styleDir]=j+AB;AC[t.styleDim]=AK[t.dimension]+AB;var k=l*w,x=35,AJ=w*p,i=w-35;AL[t.styleDim]=(k<x?x:k)+AB;AL[t.styleDir]=(AJ>i?i:AJ)+AB;}return AF;}function I(){return !(mstrApp.isSingleTier&&O);}mstrmojo.ui._HasScroller=mstrmojo.provide("mstrmojo.ui._HasScroller",{_mixinName:"mstrmojo.ui._HasScroller",hasCustomScrollbar:null,draggable:true,ownAvatar:true,scrollNode:undefined,scrollbarHostNode:undefined,scrollBarNodes:undefined,setupScrollNodes:mstrmojo.emptyFn,installedEventListeners:null,init:function Y(i){this._super(i);if(this.hasCustomScrollbar===null){this.hasCustomScrollbar=I();}this.installedEventListeners=[];},onRender:function L(){if(this._super){this._super();}this.updateScrollbars();this.addScrollNodeProperties();},addScrollNodeProperties:function G(){var j=this.scrollNode,k=J.isFF&&!O;if(j){var i=J.attachMarkupEvent(this.id,j,"scroll");this.installedEventListeners.push({e:j,evt:"scroll",fn:i});}if(k){e.addClass(j,"firefox-on-windows");}else{if(J.isEdge){e.addClass(j,"ms-edge");}}if(!this.hasCustomScrollbar){e.addClass(M.call(this),"mstrmojo-sb-host-show-default");e.addClass(j,"mstrmojo-sb-show-default");return ;}if(j){e.addClass(M.call(this),"mstrmojo-scrollbar-host");e.addClass(j,"mstrmojo-scrollNode");}},updateScrollbars:function f(){if(!this.hasRendered){return ;}this.setupScrollNodes();var i,k=false;if(!this.hasCustomScrollbar){if(this.scrollNode){i=this.scrollNode.style;i.overflowY=g.call(this,"v")?"scroll":"hidden";i.overflowX=g.call(this,"h")?"scroll":"hidden";}return ;}if(this.scrollNode){this.scrollBarNodes=this.scrollBarNodes||{};this.scrollTrackNodes=this.scrollTrackNodes||{};W.call(this,k,k);i=this.scrollNode.style;var l=D.call(this,"v"),j=D.call(this,"h");i.overflowY=l?"scroll":"hidden";i.overflowX=j?"scroll":"hidden";W.call(this,l,j);}},onscroll:function b(){var p=this.scrollNode;if(p&&this.hasCustomScrollbar){var m=function m(q){var s=parseInt(q);return s===null||isNaN(s)?0:s;},n=J.position(p),o=n.h-m(e.getStyleValue(p,"padding-bottom")),j=n.w-m(e.getStyleValue(p,"padding-right")),l=this.scrollBarNodes,k=l.v,i=l.h;if(p.scrollHeight-o>0){k.style.top=((o-J.position(k).h)*(p.scrollTop/(p.scrollHeight-o)))+"px";}if(p.scrollWidth-j>0){i.style.left=((j-J.position(i).w)*(p.scrollLeft/(p.scrollWidth-j)))+"px";}}if(this._super){this._super();}if(this.onScrollEnd){this.onScrollEnd();}},getDragData:function F(j){var m=this.scrollNode,l=J.position(m),k=j.src.node,i=this.scrollBarNodes;if(this.isDraggingScrollBar(j)){return{isScrollBar:true,direction:k===i.v?"v":"h",scrollTop:m.scrollTop,scrollLeft:m.scrollLeft,conversionRatio:{y:m.scrollHeight/l.h,x:m.scrollWidth/l.w}};}return(this._super&&this._super(j));},isDragValid:function E(i){return this.isDraggingScrollBar(i)||(this._super&&this._super(i))||false;},isDraggingScrollBar:function X(j){var k=j.src.node,i=this.scrollBarNodes;return !!i&&(k===i.v||k===i.h);},ondragstart:function d(i){if(this.isDraggingScrollBar(i)){e.addClass(i.src.node,V);e.addClass(M.call(this),c);}if(this._super){this._super(i);}},shouldDragBubble:function U(i){var j=i.src.node,k=this.scrollTrackNodes;return !(!!k&&(j===k.v||j===k.h));},ondragmove:function Q(j){if(this.isDraggingScrollBar(j)){var s=j.tgt,i=j.src,t=s.pos,k=i.pos,o=i.node,n=this.scrollNode,q=this.scrollBarNodes,p=i.data,m={y:(t.y-k.y),x:(t.x-k.x)},l=p.conversionRatio;if(o===q.v){n.scrollTop=p.scrollTop+(m.y*l.y);}else{n.scrollLeft=p.scrollLeft+(m.x*l.x);}}if(this._super){this._super(j);}},ondragend:function K(i){if(this.isDraggingScrollBar&&this.isDraggingScrollBar(i)){e.toggleClass(i.src.node,V,false);e.toggleClass(M.call(this),c,false);}if(this._super){this._super(i);}},widgetResized:function P(){if(this._super){this._super();}this.updateScrollbars();},unrender:function Z(i){R.forEach(this.installedEventListeners,function(j){J.detachEvent(j.e,j.evt,j.fn);});this.installedEventListeners=[];delete this.scrollNode;delete this.scrollbarHostNode;delete this.scrollBarNodes;delete this.scrollTrackNodes;this._super(i);},getDefaultScrollBarProps:function a(i){return N[i];},disableScroll:function B(i,l){var k=this.scrollNode,j=M.call(this);R.forEach(["v","h"],function(n){var m=N[n];e.toggleClass(j,m.hostCls,false);e.toggleClass(k,m.scrollNodeCls,false);});if(k){if(l||l===undefined){k.style.overflowY="hidden";}else{if(k.style.overflowY==="hidden"){k.style.overflowY="auto";}}if(i||i===undefined){k.style.overflowX="hidden";}}},enableScroll:function H(){this.updateScrollbars();if(!this.hasCustomScrollbar&&this.scrollNode){this.scrollNode.style.overflowY=g.call(this,"v")?"scroll":"hidden";}},scrollIntoViewIfNeeded:function(l){var q=this.scrollNode,n=l.clientHeight,m=q.clientHeight,j=J.position(l).y,o=J.position(q).y,k=j-o,i=k<0,p=k+n>m;if(i||p){q.scrollTop+=k+n/2-m/2;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var U=mstrmojo.css,E=mstrmojo.dom,J=mstrmojo.array,K=[],F=null,L=function(X){return(X&&X.rw&&X.rw.row&&X.rw.row.tc)||0;},B=function(Y,X){if(X){if(Y===1){return mstrmojo.desc(11944,"1 of 1 Row selected");}return mstrmojo.desc(11945,"# of ## Rows selected").replace("##",Y).replace("#",X);}return Y===1?mstrmojo.desc(11946,"1 Row"):mstrmojo.desc(11947,"## Rows").replace("##",Y);},I=function(){var c="",Z,a,d=K[0]&&K[0].parentNode.firstChild,X=this.hiddenField,b=K.length,Y=L(this.gridData);for(Z=0;d&&Z<d.childNodes.length;Z++){a=d.childNodes[Z].innerText||d.childNodes[Z].textContent;c+=a?(a+"\t"):"";}c+="\n";K.forEach(function(e){for(Z=0;Z<e.childNodes.length;Z++){a=e.childNodes[Z].innerText||e.childNodes[Z].textContent;c+=a?(a+"\t"):"";}c+="\n";});X.value=c;X.focus();X.select();c=B(Y,b);this.viewDataDialog.updateToolbarChildren(c);},N=function N(a,X){var Y=this.controller,Z=Y.cmdMgr;Z.getInterimCmd().submitInterim(a,Y._getXtabCallback(this,X||{}),{preserveUndo:true,hideCancel:true});},H=function H(Y,X){N.call(this,this.controller.dataService().getUpdateTemplateAction(this.k,Y),X);},Q=function(Y,a){var X=J.indexOf(K,Y),Z=X>-1;if(Z||a===false){K.splice(X,1);}if(!Z||a===true){K.push(Y);F=Y;}U.toggleClass(Y,"selected",!Z||a===true);},C=function C(){K.forEach(function(X){U.removeClass(X,"selected");});K=[];};mstrmojo.vi.ui.rw._IsViewDataGrid=mstrmojo.provide("mstrmojo.vi.ui.rw._IsViewDataGrid",{_mixinName:"mstrmojo.vi.ui.rw._IsViewDataGrid",isViewOnly:true,submitUndoRedoActionsWithCallback:function A(X,Y){N.call(this,X,Y);},doSelection:function O(s,X,f){if(f.getAttribute("r")==="0"){var t=this.getCellForNode(f);if(t.at&8&&E.getButton(X,s)!==E.MOUSE_BUTTON.RIGHT){this.sort(t);}return ;}if(f&&~f.className.indexOf("xtab-td")){var g=E.isMetaKey(X,s),p=E.shiftKey(X,s),b=E.findAncestorByName(f,"tr",true,this.domNode),Y=E.findAncestorByName(f,"tbody",true,this.domNode);if(g||(p&&!F)){Q(b);}else{if(p&&Y){var a=E.findAncestorByName(F,"tbody",true,this.domNode),q=this.zone.rowsPerPage,o=function(e){return e.tBodyN*q+e.index;},l=function(e){return this.zone.tableNode.childNodes[e+1].childNodes;}.bind(this),c={row:F,tBodyN:parseInt(a.getAttribute("n")||0),index:J.indexOf(a.childNodes,F),body:a},h={row:b,tBodyN:parseInt(Y.getAttribute("n")||0),index:J.indexOf(Y.childNodes,b),body:Y},k,Z,n,m,d;if(o(c)<o(h)){k=c;Z=h;}else{k=h;Z=c;}Q(k.row,true);if(k.tBodyN===Z.tBodyN){d=k.body.childNodes;for(m=k.index+1;m<Z.index;m++){Q(d[m]);}}else{for(n=k.tBodyN;n<=Z.tBodyN;n++){if(n===k.tBodyN){d=k.body.childNodes;for(m=k.index+1;m<d.length;m++){Q(d[m]);}}else{if(n===Z.tBodyN){d=Z.body.childNodes;for(m=0;m<Z.index;m++){Q(d[m]);}}else{d=l(n);for(m=0;m<d.length;m++){Q(d[m]);}}}}}Q(Z.row,true);}else{C();Q(b,true);}}}else{C();}I.call(this);},onclick:function W(b,X){if(!this.interactiveCellsArray.length){return ;}b=b.e||b;var Y=mstrmojo.dom,a=Y.eventTarget(X,b),Z=a&&Y.findAncestorByName(a,"td",true,this.viewport);if(Z){this.doSelection(b,X,Z);Y.clearBrowserHighlights();}},changeColumnWidth:function M(b,Z,a,Y,X){H.call(this,this._super(b,Z,a,Y,X,true));},preBuildRendering:function D(){this._super();U.addWidgetCssClass(this,"viewData");},postBuildRendering:function P(){this._super();var X=L(this.gridData);this.viewDataDialog.updateToolbarChildren(B(X));},lastSortedCell:[],sort:function R(f,d){var Y=f._ei,c=d===undefined,e=c?true:!!d,X=this.lastSortedCell,Z={success:function(){try{var l=this.tableContainerNode.lastElementChild.firstChild.firstChild.firstChild.lastChild.firstChild.childNodes,h=this.tableContainerNode.childNodes[1].firstChild.firstChild.lastChild.firstChild.childNodes,j;for(j=0;j<l.length;j++){if(Y===Number(l[j].getAttribute("ei"))){U.addClass(l[j],e?"asc":"desc");U.addClass(h[j],e?"asc":"desc");}}}catch(k){}}.bind(this)};if(X){if(X[0]===Y){e=c?!X[1]:d;}}X[0]=Y;X[1]=e;var b=this.controller,g=b.getSorts(this.model.getSortAction(f,e)),a={act:"sort",sorts:g.sorts,nodeKey:this.k,subTotalsPos:g.subTotalsPos};H.call(this,a,Z);},pivot:function G(X,Y){var Z=this.model.getPivotAction(X,Y);H.call(this,Z);},selectAll:function S(){var Y=this.zone,Z=Y.tableNode.childNodes,b,a,c,X,d,e=true;C();for(b=0;b<Z.length;b++){c=Z[b];if(c.tagName.toLowerCase()==="tbody"){X=c.getAttribute("n")||0;if(!Y.pageStatus[X].isOnDemand()){d=c.childNodes;for(a=0;a<d.length;a++){if(!e){Q(d[a],true);}e=false;}}}}I.call(this);},isMultiSelect:false,onHandleDblClick:function V(){var X={act:"changeXtabColWidthScenario",value:2};H.call(this,X);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"],BG:["background-color","fx"],RW:[]};J.RW=["z-index"].concat(J.T.concat(J.D));var D=mstrmojo.dom,O=mstrmojo.css;function N(U,W,S){var V=U[W]||[];V.push(S);U[W]=V;}function L(X,W){var V=((X&&X.fmts)||null);if(W){var Z=X.thresholds,U=Z&&Z[W];if(U){var Y={},a;for(a in V){Y[a]=U[a]||V[a];}for(a in U){var S=U[a];Y[a]=(typeof S==="string")?(S+" !important"):S;}V=Y;}}return V;}mstrmojo._Formattable=mstrmojo.provide("mstrmojo._Formattable",{_mixinName:"mstrmojo._Formattable",formatHandlers:null,thresholdId:null,getCacheKey:function E(){return"css_cache"+(this.thresholdId||"");},update:function G(U){var S=true;this.invisible=!!(U&&U.data&&U.data.invisible);if(this._super){S=this._super(U);}return S;},buildCSSFormatString:function H(V,e){var i=this.formatHandlers[V],k=i.src?e[i.src]:e;if(!k){return null;}var c=i.props||i;if(!c){return null;}var Y=[],h=-1;var W=c.length-1;for(W;W>=0;W--){var j=c[W];var d=J[j]||[j];var b=d.length-1;for(b;b>=0;b--){j=d[b];var U=k[j];if(U!==undefined){if(j==="fx"){var Z=U,S={};var g=Z.gd;if(g){this.formatGradient(g,S);}var X=parseInt(Z.rt,10);if(X){if(X===1||X===3){this.formatTextRotation(Z.rt,S);}}if(Z.ds){this.formatDropShadow(Z,S);}var a;for(a in S){Y[++h]=a+":"+S[a].join(" ");}}else{Y[++h]=j+":"+U;}}}}if(this.invisible){Y.push("visibility:hidden");}return Y.join(";")+";";},applyCSSFormatToNode:function I(W,S){var X=this[W],V=X&&X.style;if(V){var U=this.buildCSSFormatString(W,S)||"";U.split(";").forEach(function(Y){var Z=Y.split(":");V[O.convertCssToCamelCase(Z[0])]=Z[1];});}},clearSlotBackgroundCSS:function F(U){var V=this[U],S=V&&V.style;if(S){S.background="transparent none 0 0 no-repeat";S.filter="none";}},preBuildRendering:function B(){this._super();var W=this.formatHandlers,S=this.getFormats();if(W&&S){var X=this.defn=this.defn||{},Y=this.getCacheKey(),V=X[Y];if(!V){V=X[Y]={};for(var U in W){var a=U+"CssText";this[a]=V[a]=this.buildCSSFormatString(U,S)||"";}}else{var Z;for(Z in V){this[Z]=V[Z];}}}return true;},formatGradient:function P(S,V){var U=O.buildGradient(S.t,S.sc,S.ec);if(U){N(V,U.n,U.v);}},formatDropShadow:function K(X,V){if(D.supports(D.cssFeatures.DROP_SHADOW)){var W=X.ds;if(D.isDXIE){N(V,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+W+",OffY="+W+")");}else{var S=[W,W],U=parseInt(X.rt,10);if(U===1||U===3){S[((U===1)?1:0)]=-W;}N(V,(D.isWK?"-webkit-":"")+"box-shadow",S.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function C(U,S){if(D.supports(D.cssFeatures.TEXT_ROTATION)){if(D.isDXIE){N(S,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+U+")");}else{var V=(U===1)?90:-90;N(S,D.CSS3_PREFIX+"transform-origin","top left");N(S,D.CSS3_PREFIX+"transform","rotate("+V+"deg)");}}},getFormats:function R(){if(!this.fmts){this.fmts=L.call(this,this.defn,this.thresholdId);}return this.fmts;},clearFormats:function A(){this.fmts=undefined;},createEmptyFormats:function(){return(this.fmts=this.fmts||{});},clearCache:function Q(){delete this.defn[this.getCacheKey()];},unrender:function M(S){if(this.thresholdId){this.fmts=null;}this._super(S);}});mstrmojo._Formattable.getBorderWidths=function(X){var W=X.getFormats(),S=(W.border)?W.border.match(/(\d*|\d*\.\d*)pt/)[0]:W["border-width"],V=X.model,U=V.docModel;return O.getBorderWidths(S,(U&&U.dpi)||V.dpi);};}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array");var E=mstrmojo.dom,Q=mstrmojo.css,B=mstrmojo.string,I="selected",L="hidden";function P(W,X,Y,V,a){var Z=a.listHooks[W];if(Z&&Z.call(a,X,Y,V)){return ;}Q.toggleClass(X,I,W==="select");}function G(Y,X,W){var Z=this[Y],V=Z?Z.split(X):[];this[Y]=mstrmojo.array.distinct(V.concat(W.split(X))).join(X);}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},useListModKeys:false,allowHTML:false,init:function N(V){this._super(V);this._shiftStartIndex=-1;},getItemMarkup:function D(W,V){var X=(this.allowHTML?"":"@en");return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{'+X+'@title}">{'+X+"@n}</{@tag}>";},getItemDisplayName:function M(V){return V.n||"";},getItemProps:function R(Z,V){var W=!!this.selectedIndices[V],a={tag:"div",sel:W,cls:"",n:this.getItemDisplayName(Z),style:"",idx:V,addCls:function X(c){G.call(this,"cls"," ",c);},addStyle:function Y(c){G.call(this,"style",";",c);},title:Z.title||""};if(a.n&&B.isEmpty(a.n)){a.n=B.decodeHtmlString("<br/>");}if(W){a.addCls(I);}var b=Z.cls;if(b){a.addCls(b);}if(Z.hid){a.addCls(L);}return a;},itemRenderer:{render:function S(W,V,X){W._renderIdx=V;return mstrmojo.string.apply(X.getItemMarkup(W,V),X.getItemProps(W,V));},select:function K(W,X,V,Y){P("select",W,X,V,Y);},unselect:function H(W,X,V,Y){P("unselect",W,X,V,Y);}},onclick:function U(V){try{var X=this.getItemFromTarget(V.getTarget());if(X){V.cancel();this.doItemSelect(X,V||{});}}catch(W){mstrApp.onerror(W);}},doItemSelect:function C(k,j){var c=j.hWin,d=j.e,h=k._renderIdx,f=k._positionIdx,W=E.isMetaKey(c,d),b=E.shiftKey(c,d),X=this.multiSelect,a=this.useListModKeys,i=this._shiftStartIndex,Y=this.selectedIndices;if(X&&a&&b&&i>-1){var V=[],Z=[];this.processContinuousSelection(V,Z,h);this.addSelect(V);this.removeSelect(Z);}else{if(X&&(!a||W)){var g=(Y[h])?"remove":"add";this[g+"Select"](h,false,f);}else{this.singleSelect(h,false,f);}this._shiftStartIndex=h;}},processContinuousSelection:function J(X,W,V){var c=this._shiftStartIndex,b=this.selectedIndices,a=Math.min(c,V),Z=Math.max(c,V),Y;for(Y=0;Y<this.items.length;Y++){if(a<=Y&&Y<=Z){if(!b[Y]){X.push(Y);}}else{if(b[Y]){W.push(Y);}}}},onclearSelection:function A(){this._shiftStartIndex=-1;},getItemNodeFromTarget:function F(W){var V=E.findAncestorByAttr(W,"idx",true,this.domNode);return(V&&V.node)||null;},getItemFromTarget:function O(X){var W=this.getItemNodeFromTarget(X),V=W&&parseInt(W.getAttribute("idx"),10);if(V!==null&&!isNaN(V)&&this.items){return this.items[V];}return undefined;}});mstrmojo._IsList.SELECTED_CLS=I;mstrmojo._IsList.HIDDEN_CLS=L;}());(function(){mstrmojo.requiresClsP("mstrmojo","hash","css","array","RaErrorHandler","desc");var S=mstrmojo.hash,m=mstrmojo.func,B=mstrmojo.css,K=mstrmojo.RaErrorHandler,g=mstrmojo.array;var E={lv:-1,hcd:false,epd:false,hid:false,dhid:false,children:[],displayChildren:[],parent:null,displayParent:null},k={rootItems:{},items:[],itemMap:{}};var l="hidden",C="expanded",q="collapsed",J="hierarchy",d="hasChildren",p="u;",Y=10,N=7,o=32;mstrmojo.ui._IsHierarchyList=mstrmojo.provide("mstrmojo.ui._IsHierarchyList",{_mixinName:"mstrmojo.ui._IsHierarchyList",itemValueField:"v",init:function n(s){this._super(s);this.clearItems();},getItemProps:function h(u,s){var t=this._super(u,s),w=0;if(u.hcd){t.addCls(d);}if(u.v===p){t.addCls(l);}if(this.isHiearachyDisplay()){t.addCls(J);if(u.hid){t.addCls(l);}w=u.lv>=0?u.lv*Y:0;}t.indent=w;return t;},_getItemNode:function U(s){var t=this.itemsContainerNode;return g.filterOne(t&&t.childNodes,function(u){return parseInt(u.getAttribute("idx"),10)===s;});},_buildItemsMarkup:function j(z,t,u,w,x,y){var s;if(this.isHiearachyDisplay()){s=this._buildDescendantsMarkup();}else{s=this._super(z,t,u,w,x,y);}return s;},_buildDescendantsMarkup:function b(z,x){var AC=[],y=this.itemRenderer&&this.itemRenderer.render,AA=z?(x?[z]:z.displayChildren):(this.raad?this.getDisplayRoots():this.getRootItems()),t=this.blockCount,w=function(AD){if(!AD.hid&&!AD.dhid){AC.push(y(AD,AD.idx,this));}if(AD.epd||AD.hid){g.forEach(AD.displayChildren,function(AF,AE){return AB.call(this,AF,AE);},this);}},AB=function(AE,AD){if(this.raad&&AD>=t){var AF=this.createRenderer(AE.lv,AE.displayParent,AE.parent,this.items.length,AD);this.items.push(AF);if(AF.displayParent){AF.displayParent.displayChildren.push(AF);}if(AF.parent){AF.parent.children.push(AF);}w.call(this,AF);return false;}else{w.call(this,AE);}};if(y&&typeof y==="function"){if(this.raad&&!z){if(AA.length>t){var s=AA.slice(0,t),u=this.createRenderer(AA[t-1].lv,null,null,this.items.length,t);this.items.push(u);AA.push(u);s.push(u);AC=this._buildSiblingsMarkup(s);}else{AC=this._buildSiblingsMarkup(AA);}}else{g.forEach(AA,function(AE,AD){return AB.call(this,AE,AD);},this);}}return AC;},getItems:function V(){return this.items;},getItemByValue:function D(s){return this.itemMap[s];},isRootItem:function(s){return s.lv>=0&&s.v!==p&&!s.pid&&!s.parent;},getRootItems:function e(){return S.valarray(this.rootItems);},getDisplayRoots:function Z(){if(!this.displayRoots){var u=this.displayRoots=[],s=this.getRootItems(),t=function(w){g.forEach(w,function(x){if(!x.hid){u.push(x);}if(x.epd||x.hid){t(x.displayChildren);}});};t(s);}if(!this.initialDisplayRoots){this.initialDisplayRoots=u.slice();}return this.displayRoots;},getInitialDisplayRoots:function A(){if(!this.initialDisplayRoots){this.initialDisplayRoots=(this.getDisplayRoots()||[]).slice();}return this.initialDisplayRoots;},createRenderer:function I(x,t,w,s,u){return{n:mstrmojo.desc(1005,"More..."),lv:x,displayParent:t,parent:w,idx:s,fetcher:true,fake:true,config:{nextSiblingIdx:u}};},getItemAncestorMap:function F(t){var s=this.itemValueField,u={};while(t&&t[s]){u[t[s]]=true;t=t.parent;}return u;},getItemDescendantMap:function a(u){var s=this.itemValueField,w={},t=function(x){w[x[s]]=true;g.forEach(x.children,function(y){t(y);});};t(u);return w;},clearItems:function i(){var s=this.itemsContainerNode;S.copy(S.clone(k),this);if(s){s.innerText="";this.updateScrollbars();}},addItems:function f(y,u){var t=this.items,x=this.itemMap,s=this.rootItems,w=this.itemValueField,AA=[];g.forEach(y,function(AB){var AE=AB[w],AC=this.getItemByValue(AE),AD=S.copy(AB,(AC?AC:S.clone(E)));if(!AC){AD.idx=t.length;t.push(AD);if(AE){x[AE]=AD;}}if(this.isRootItem(AD)){s[AE]=AD;}AA.push(AD);},this);g.forEach(AA,function(AD){var AB=this.getItemByValue(AD.pid),AC=this.getItemByValue(AD.dpid)||AB;if(AB){if(!AD.parent){AD.parent=AB;AB.children.push(AD);}if(!AD.hid&&!AD.dhid&&!AD.displayParent){AC.hcd=true;AD.displayParent=AC;AC.displayChildren.push(AD);}}delete AD.pid;delete AD.dpid;},this);if(!u){if(this.postAddItems){this.postAddItems(AA);}var z=this.itemsContainerNode;if(z){if(this.isHiearachyDisplay()){this.refresh();}else{z.innerHTML+=this._buildSiblingsMarkup(this.getFlatDisplayItems(AA)).join("");this.updateScrollbars();}}}return AA;},addSiblingItems:function G(AA,x){var w=this.getItemByValue(x),t;if(w){g.forEach(AA,function(AC){if(AC.v!==x){AC.pid=AC.pid||x;}});}t=this.addItems(AA,true);if(this.postAddSiblingItems){this.postAddSiblingItems(t,w);}var y=this.itemsContainerNode;if(y&&this.isHiearachyDisplay()){var z=this._buildSiblingsMarkup(t).join("");if(!x){y.innerHTML+=z;}else{if(w){var AB={},u=this._getItemNode(w.idx),s;if(u){AB[w.v]=true;while(u.nextSibling){s=this.getItemFromTarget(u.nextSibling);if(s&&s.displayParent&&AB[s.displayParent.v]){AB[s.v]=true;u=u.nextSibling;}else{break;}}u.outerHTML+=z;}}}this.updateScrollbars();}return t;},addBranchItems:function M(t,x){var s=this.getItemByValue(x),w;if(s){g.forEach(t,function(z){z.pid=z.pid||x;});}w=this.addItems(t,true);if(this.postAddBranchItems){this.postAddBranchItems(w,s);}var u=this.itemsContainerNode;if(u&&this.isHiearachyDisplay()){if(!x){g.forEach(w,function(z){if(this.isRootItem(z)){u.innerHTML+=this._buildDescendantsMarkup(z,true).join("");}},this);}else{if(s){var y=this._getItemNode(s.idx);if(y){y.outerHTML+=this._buildDescendantsMarkup(s).join("");}}}this.updateScrollbars();}return w;},updateItems:function H(s,t){if(t){g.forEach(s,function(z,w,x){var y=t[w],u=x[y.p_index];if(u){z.pid=u.v;}});}this.handleOriginalParent(s,t);this.setDisplayParent(s,t);this.clearItems();this.addItems(s,true);},handleOriginalParent:function Q(s,t){if(t){g.forEach(s,function(AA,w,x){var z=t[w],u=x[z.p_index],y=x[z.original_p_index];if(u&&u.t===N&&AA.lv!==u.lv&&y&&y.pid===u.v){AA.pid=y.v;}});}},setDisplayParent:function L(s,x,w){if(w){this.idMap=this.idMap||{};g.forEach(s,function(z){this.idMap[z.v]=z;},this);}var u=this,t=function(AB,AA){var z;if(!w&&x){var AC=x[AA].p_index;z=s[AC];}else{if(w){z=u.idMap[AB.pid];}}return z;};g.forEach(s,function y(AC,AA,AB){var z=t(AC,AA);if(!z||u.isRootItem(AC)){return AC.v;}if(!AC.dpid){AC.dpid=z.hid?y(z,x&&x[AA]&&x[AA].p_index,AB):z.v;}return AC.dpid;});},fetchItems:function W(w,z){if(this.raad&&this.isHiearachyDisplay()&&(this.items||[]).length>0){return ;}w=w||{};var t=this,s=w.branch,y=w.browseFlags&o,x=parseInt(w.level,10),u=x>=0;this.fetchItemsThroughTaskCall(w,m.wrapMethods(z,{success:function(AA){if(t.raad===undefined&&AA&&t.isHiearachyDisplay()){t.raad=AA.raad;}if(AA&&AA.es){var AB=AA.es;if(x===(s&&s.lv+1||0)||(y&&!t.raad)){t.addSiblingItems(AB,s&&s.v);}else{if(s&&!u){t.addBranchItems(AB,s.v);}else{t.addItems(AB);}}}},failure:function(AA){K.handleRAPopUpError(AA);}}));},updateItemNodesStatus:function X(){var s=this.itemsContainerNode&&this.itemsContainerNode.childNodes;g.forEach(s,function(u){var t=this.getItemFromTarget(u);if(t){B.toggleClass(u,CSS_SELECTED,t.isSelected);}},this);},_buildSiblingsMarkup:function P(u){var s=[],t=this.itemRenderer&&this.itemRenderer.render;if(t&&typeof t==="function"){g.forEach(u,function(w){s.push(t(w,w.idx,this));},this);}return s;},toggleCollapseExpandCss:function R(t,s){B.toggleClass(t,q,!s);B.toggleClass(t,C,s);},doExpandCollapse:function c(s,AB){var AC=!AB.epd;AB.epd=AC;this.toggleCollapseExpandCss(s,AC);if(!this.isHiearachyDisplay()){return ;}var z=this.getItemDescendantMap(AB),u,AA;if(AC){var t=AB.displayChildren&&AB.displayChildren[0];if(t){var x=this.getItemFromTarget(s.nextSibling);if(x&&x.displayParent===AB){var y={},w;u=s.nextSibling;while(u){AA=this.getItemFromTarget(u);w=AA&&AA.displayParent;if(!w||!z[AA.v]){break;}if(y[w.v]){B.addClass(u,l);y[AA.v]=true;}else{B.removeClass(u,l);if(!AA.epd){y[AA.v]=true;}}u=u.nextSibling;}}else{s.outerHTML+=this._buildDescendantsMarkup(AB).join("");}}else{this.fetchItems({branch:AB,level:AB.lv+1});}}else{u=s.nextSibling;while(u){AA=this.getItemFromTarget(u);if(!AA||!z[AA.v]){break;}B.addClass(u,l);u=u.nextSibling;}}this.updateScrollbars();},isHiearachyDisplay:function O(){return true;},fetchItemsThroughTaskCall:mstrmojo.emptyFn,getFlatDisplayItems:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.fx");var S=mstrmojo.css;var Q=10;function C(X,a,Z){X.pauseScrollRendering(true);var Y=X.scrollboxNode,W=X.animate?X.scrollEffect:null;if(W&&W.play){if(W.isPlaying){W.cancel();}W.props={scrollTop:{start:Y.scrollTop,stop:a,isStyle:false}};W.onEnd=function(){X.pauseScrollRendering(false,null,Z);};W.play();}else{Y.scrollTop=a;X.pauseScrollRendering(false,null,Z);}}function K(d,f,W){var X=4;if(!W){W=0;}var g=Math.round(d.renderBlockSize/2);d.fillAt(Math.max(0,f-g),f+g);var c=d.itemsContainerNode,b=c.childNodes[f],a=d.listMapper.itemOffsetTop(d,c,null,b),e=parseInt(d.scrollboxNode.clientHeight/2,10)-b.offsetHeight/2,Y=Math.max(0,d.spacerMargin+a-e);if(Math.abs(d.scrollboxNode.scrollTop-Y)>2){C(d,Y,d.renderOnScroll?function(){if(W<=X){K(d,f,W++);}}:null);}else{var Z=d.animate?d.scrollEffect:null;if(Z&&Z.isPlaying&&Z.cancel){Z.cancel();d.pauseScrollRendering(false);}}}function J(Y){var Z=Y.itemsContainerNode,W=Z.lastChild,X=W?W.offsetTop+W.offsetHeight-Z.firstChild.offsetTop:0;return X;}function V(X){var W=J(X),Y=Math.max(0,parseInt((X.scrollboxNode.clientHeight-W)/2,10));C(X,Math.max(0,X.spacerMargin-Y));}function H(Y){var W=Y.selectedIndex,X=W>-1;Y.set("hasSelection",X);if(!Y.domNode){return ;}if(X){K(Y,W);}else{V(Y);}}function E(X){var Z=X.scrollboxNode,W=J(X),Y=W>Z.clientHeight/2;S.toggleClass(X.upArrowNode,["enabled"],Y);S.toggleClass(X.downArrowNode,["enabled"],Y);}function N(W,X){var Y=W.scrollboxNode;Y.scrollTop=Math.min(Math.max(Y.scrollTop+X,0),Y.scrollHeight-Y.offsetHeight);}function B(X,W){if(!X._scrollInter){var Y=Q*(W?-1:1);X._scrollInter=window.setInterval(function(){N(X,Y);},50);}}function R(W){if(W._scrollInter){window.clearInterval(W._scrollInter);W._scrollInter=null;}}mstrmojo._IsDial=mstrmojo.provide("mstrmojo._IsDial",{markupString:'<div id="{@id}" class="mstrmojo-Dial {@cssClass}" style="position:relative;"><div class="mstrmojo-Dial-uparrow"  onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], true)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], true)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"></div><div class="mstrmojo-Dial-scrollbox {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-Dial-spacer" style="{@spacerCssText}"><div class="mstrmojo-Dial-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div></div></div><div class="mstrmojo-Dial-dnarrow" onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], false)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], false)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.childNodes[1];},spacerNode:function(){return this.domNode.childNodes[1].firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},upArrowNode:function(){return this.domNode.childNodes[0];},downArrowNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){S.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);}},animate:true,itemsEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:500,interval:25,slot:"itemsContainerNode",preStart:function(){var X=this.widget[this.slot],W=(X&&X.offsetWidth)||0;this.props=W?{left:{start:-W,stop:0,suffix:"px",isStyle:true}}:{};},revertOnCancel:false},scrollEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:250,interval:25,slot:"scrollboxNode",revertOnCancel:false},multiSelect:false,holdJumpOnly:true,audibles:{"*":true,hasSelection:false},initSpacer:function I(){var W=(this.cssText||"").match(/height:\s*(\d*)px/);if(W){this.spacerMargin=parseInt(Number(W[1])/2,10);var X=this.spacerMargin+"px";this.spacerCssText="padding-top: "+X+"; padding-bottom: "+X+";";}else{this.spacerMargin=0;delete this.spacerCssText;}},center:function U(){H(this);},preBuildRendering:function(){this.initSpacer();return this._super();},postBuildRendering:function D(){this._super();this.center();E(this);},refreshScroll:function G(){this.center();E(this);},prechange:function O(W){this._super(W);if(this.hasRendered){if(!this.multiSelect||(W&&W.added&&W.added.length)){this.center();}}},onclickarrow:function A(Y,X,W){N(this,Q*(W?-1:1));},onmouseoverarrow:function L(Y,X,W){if(!this.holdJumpOnly){B(this,W);}},onmouseoutarrow:function M(Y,X,W){R(this);},onmousedownarrow:function F(Y,X,W){if(this.holdJumpOnly){B(this,W);}},onmouseuparrow:function P(Y,X,W){R(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.hash","mstrmojo.css");var F=mstrmojo.hash,C=mstrmojo.css;var D="open";function E(G){return G?G.popupConfig.hostElement:null;}mstrmojo.ui.menus._HasMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._HasMenuPopup",F.copy(mstrmojo._HasPopup));mstrmojo.ui.menus._HasMenuPopup.openPopup=function A(I,G){var H=this._lastOpened;if(H){this.closePopup();}mstrmojo._HasPopup.openPopup.call(this,I,G);C.addClass(E(I),D);};mstrmojo.ui.menus._HasMenuPopup.closePopup=function B(){C.removeClass(E(this._lastOpened),D);mstrmojo._HasPopup.closePopup.call(this);};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,K="mstrmojo-itemwrap",J="&nbsp;",I=mstrmojo.array;function B(W){if(!W.pageSize||W.pageSize<=0){var X=W.scrollboxNode;W.pageSize=X&&X.clientHeight||0;}return W.pageSize;}function U(W,X){if(W.usePaging){W.totalPages=1;var Z=W.itemsContainerNode,Y=B(W);if(W.usePaging&&Z&&Y){W.totalPages=Math.ceil((Z.clientHeight-parseInt(Z.style&&Z.style.paddingBottom||0,10))/Y);}if(Z){W.itemsContainerNode.style.paddingBottom=Y+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(W){return'<div class="'+this.getWrapperCss(W)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(W){return W.childNodes;},wrapperParentNode:function D(W){return W;},createWrapperNode:function G(W){var X=W.ownerDocument,Y=X.createElement("div");return Y;},findScrollRange:function N(l,a,k,o,X,d,q,n){if(!a){return{start:0,end:0};}var f=this.wrapperNodes(l),j=parseInt(a/2,10),Z=parseInt(Math.log(a)/Math.log(2),10),Y=0,W=a-1,g=k+o,e=f[0].offsetTop,c;for(var m=1;m<=Z;m++){c=f[j].offsetTop-e+n;if(c<k){Y=j;}else{if(c>g){W=j;}}var b=Math.round(a/Math.pow(2,m+1));j+=(c>k)?-b:b;j=Math.min(Math.max(0,j),a-1);}return{start:Y,end:W};},findWrapper:function L(Y,W){var X=this.wrapperNodes(Y);return X&&X[W];},findIndex:function F(W,Z,Y){var X=this._nd2iw(W,Z,Y);return X?this._iw2idx(W,Z,X):-1;},itemOffsetTop:function V(X,b,W,Z){if(!Z){var Y=this.wrapperNodes(b);Z=Y&&Y[W];if(!Z){return 0;}}var a=b.firstChild;if(!a||(a===Z)){return 0;}else{return Z.offsetTop-a.offsetTop;}},whereDrop:function S(d,W,Y,c,X){var Z=this._nd2iw(d,W,Y),e,b,f;if(Z){b=this._iw2idx(d,W,Z);e=b;f=this.itemOffsetTop(d,W,null,Z);var a=Z.offsetHeight;if(c.y>X.top+f+a/2){e++;f+=a;}}else{return d.dropCuePos;}return{left:0,top:f,idx:e,idxActual:b};},getWrapperCss:function(W){return K;},postBuildRendering:function(a,Z,Y,X,W){U(X,this);},buildItemWrappers:function P(f,c,i,e,b,l){var m=this.itemWrapperPrefix(i),h=this.itemWrapperSuffix,a=m+this.itemWrapperPrefill+h,Z=[this.markupPrefix],X=1,W=i.selectedIndices||{},o=function n(k,j){for(var p=k;p<j;p++){Z[X++]=m;var q=c.build(i,e,f[p],p);if(W[p]){q=q.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Z[X++]=q;Z[X++]=h;}};var d=(f&&f.length)||0;b=b&&c?Math.min(b,d):0;if(b){o(0,b);}l=l&&c?Math.min(l,d-b):0;var g=d-l;for(var Y=b;Y<g;Y++){Z[X++]=a;}if(l){o(g,d);}Z.push(this.markupSuffix);return Z;},fillItemWrappers:function H(Y,h,e,n,g,X,c,m){var f=(h&&h.length)||0,l=this.wrapperNodes(Y),o=g.itemStatus,W=mstrmojo.css,a=n.selectedIndices||{};for(var d=X,j=Math.min(c+1,f),b=0;d<j;d++){if(o[d]!==A){l[d].innerHTML=e.build(n,g,h[d],d);if(a[d]){var Z=l[d].firstChild;if(Z){W.addClass(Z,["selected"]);}}b++;if(b===m){break;}}}return b;},onadd:function O(f,W,a,g){if(W&&g){var b=g.value.length,d=this.wrapperNodes(W),e=d[g.index],Z=this.getWrapperCss(f);for(var Y=0;Y<b;Y++){var X=this.createWrapperNode(W);X.className=Z;X.innerHTML=J;if(e){this.wrapperParentNode(W).insertBefore(X,e);}else{this.wrapperParentNode(W).appendChild(X);}}U(f,this);}},onremove:function Q(Z,d,W,Y){if(d&&Y){var b=this.wrapperNodes(d);if(b){var e=Y.value.length;for(var a=Y.index+e-1,X=Y.index;a>=X;a--){this.wrapperParentNode(d).removeChild(b[a]);}}U(Z,this);}},onchange:function R(h,Y,d,l){if(Y&&l){var e=this.wrapperNodes(Y);if(e){var X=mstrmojo.css,m=d.itemStatus,k;for(var c=0,W=l.removed,g=W&&W.length;c<g;c++){k=W[c];if(m[k]){X.removeClass(e[k].firstChild,["selected"]);}}for(var b=0,f=l.added,Z=f&&f.length;b<Z;b++){k=f[b];if(m[k]){X.addClass(e[k].firstChild,["selected"]);}}}}},_nd2iw:function E(X,a,Z){a=this.wrapperParentNode(a);if(a&&Z&&a!==Z){var W=X.domNode,Y=Z.parentNode;while(Y){if(Y===a){return Z;}if(Y===W){break;}Z=Y;Y=Z.parentNode;}}return null;},_iw2idx:function M(Y,c,b){var X=Y.items&&Y.items.length,Z=this.wrapperNodes(c),W=I.findBin(Z,b,"offsetTop",X);for(var a=W;a<X;a++){if(Z[a].offsetHeight){return a;}}return -1;},toPage:function(W,Y){var X=W.scrollboxNode;if(W.usePaging&&X){X.scrollTop=Y*B(W);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(W){var X=W.scrollboxNode,Y=B(W);return Math.round((X&&Y&&X.scrollTop/Y)||0);},toItem:function(a,b){var Y=a&&a.itemsContainerNode,f=a.scrollboxNode,W=this.itemOffsetTop(a,Y,b),d=this.wrapperNodes(Y)[b].clientHeight,X=f.clientHeight,e=f.scrollTop,Z=e;if(W<e){Z=W;}else{if(e+X-d<W){Z=Math.min(W,W-X+d);}}f.scrollTop=Z;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.chart.common.DSSTimeUtil");var H=24*60*60*1000;var A=60*60*1000;var L=60*1000;var C=1000;var K=24;var D=24*60;var J=24*60*60;var B=new mstrmojo.chart.common.DSSTimeUtil();mstrmojo.chart.common.DSSDateTime=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSDateTime",mnYear:1899,mnMonth:12,mnDay:30,mnHour:0,mnMinute:0,mnSecond:0,mnMillisecond:0,mnWeek:-1,mnDayOfWeek:-1,init:function P(U){if(!U||!U.ifTime){this.mnYear=1899;this.mnMonth=12;this.mnDay=30;this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;this.mnWeek=-1;this.mnDayOfWeek=-1;return ;}var S=0;var W=23242571;var R=-693593;if(U.ifTime>W){this.mnYear=65535;this.mnMonth=12;this.mnDay=30;S=U.ifTime-Math.floor(U.ifTime);}else{if(U.ifTime<R){this.mnYear=1;this.mnMonth=1;this.mnDay=1;S=Math.abs(U.ifTime)+Math.ceil(U.ifTime);}else{if(U.ifTime>0){var X=this.DAYSToYMD(Math.floor(U.ifTime));this.mnYear=X.year;this.mnMonth=X.month;this.mnDay=X.day;S=U.ifTime-Math.floor(U.ifTime);}else{if(U.ifTime<0){var X=this.DAYSToYMD(Math.ceil(U.ifTime));this.mnYear=X.year;this.mnMonth=X.month;this.mnDay=X.day;S=Math.abs(U.ifTime)+Math.ceil(U.ifTime);}}}}S*=H;var V=S+0.5;if(V==H){V--;}if(V>0){this.mnHour=Math.floor(V/A);V-=this.mnHour*A;this.mnMinute=Math.floor(V/L);V-=this.mnMinute*L;this.mnSecond=Math.floor(V/C);V-=this.mnSecond*C;this.mnMillisecond=Math.floor(V);}else{this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;}this.mnWeek=-1;this.mnDayOfWeek=-1;this.Sanitize();},Sanitize:function O(){var R=false;if(this.mnHour==24&&this.mnMinute==0&&this.mnSecond==0){R=true;this.mnHour=0;}if(this.mnMonth<1){this.mnMonth=1;}else{if(this.mnMonth>12){this.mnMonth=12;}}if(this.mnDay<1){this.mnDay=1;}else{if(this.mnDay>B.DaysInMonth[this.mnMonth-1]){this.mnDay=B.DaysInMonth[this.mnMonth-1];if(this.mnMonth==2&&this.IsLeapYear(this.mnYear)){this.mnDay++;}}}if(this.mnHour<0){this.mnHour=0;}else{if(this.mnHour>23){this.mnHour=23;}}if(this.mnMinute<0){this.mnMinute=0;}else{if(this.mnMinute>59){this.mnMinute=59;}}if(this.mnSecond<0){this.mnSecond=0;}else{if(this.mnSecond>59){this.mnSecond=59;}}if(this.mnMillisecond<0){this.mnMillisecond=0;}else{if(this.mnMillisecond>999){this.mnMillisecond=999;}}if(R){var S=this.ToMilliseconds();S=S+H;this.init({ifTime:this.MillisecondsToDATE(S)});}},IsLeapYear:function Q(R){return((R&3)==0)&&((R%100)!=0||(R%400)==0);},ToMilliseconds:function I(){var R=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var S=R*H;S+=this.mnHour*A+this.mnMinute*L+this.mnSecond*C+this.mnMillisecond;return S;},MillisecondsToDATE:function E(S){var R=Math.floor(S/H);var U=(S-R*H)/H;if(U<0){R--;U+=1;}return R>=0?R+U:R-U;},DAYSToYMD:function N(U){var X=0;var Z=0;var S=0;U+=693959;var W=Math.floor(U/365);var V=U-W*365;var Y=Math.floor(W/4)-Math.floor(W/100)+Math.floor(W/400);V=V-Y;if(V<0){W--;V+=365;while(V<=0){W--;V+=365;}}var R=U-(W*365+Math.floor(W/4)+(W%4?1:0)-Math.floor((W-1)/100)+Math.floor((W-1)/400));if(R==365&&!this.IsLeapYear(W)){X=W+1;Z=1;S=1;return{year:X,month:Z,day:S};}if(R==-1){X=W-1;Z=12;S=31;return{year:X,month:Z,day:S};}X=W;Z=12;while(R<B.DaysBeforeMonth[Z-1]){Z--;}S=R-B.DaysBeforeMonth[Z-1]+1;if(Z>2&&this.IsLeapYear(X)){S--;if(S==0){Z--;S=B.DaysInMonth[Z-1];if(Z==2){S++;}}}return{year:X,month:Z,day:S};},YMDToDAYS:function G(V,U,S){if(U<1||U>12){return 0;}var R=V*365+Math.floor(V/4)+(V%4?1:0)-Math.floor((V-1)/100)+Math.floor((V-1)/400);R+=B.DaysBeforeMonth[U-1];if(U>2&&this.IsLeapYear(V)){R++;}R+=S-1;R-=693959;return R;},ToDATE:function F(){var S=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var R=this.mnHour/K+this.mnMinute/D+this.mnSecond/J+this.mnMillisecond/H;if(S>=0){return S+R;}else{return S-R;}},DateTimeOrder:function M(R){if(this.mnYear>R.mnYear){return 1;}else{if(this.mnYear<R.mnYear){return -1;}}if(this.mnMonth>R.mnMonth){return 1;}else{if(this.mnMonth<R.mnMonth){return -1;}}if(this.mnDay>R.mnDay){return 1;}else{if(this.mnDay<R.mnDay){return -1;}}if(this.mnHour>R.mnHour){return 1;}else{if(this.mnHour<R.mnHour){return -1;}}if(this.mnMinute>R.mnMinute){return 1;}else{if(this.mnMinute<R.mnMinute){return -1;}}if(this.mnSecond>R.mnSecond){return 1;}else{if(this.mnSecond<R.mnSecond){return -1;}}if(this.mnMillisecond>R.mnMillisecond){return 1;}else{if(this.mnMillisecond<R.mnMillisecond){return -1;}}return 0;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.elementHelper","mstrmojo.mstr.EnumNodeProperties","mstrmojo.EnumSelectionType");var j=mstrmojo.array,U=mstrmojo.hash,Q=mstrmojo.expr,f=mstrmojo.elementHelper,Z=Q.ET,E=Q.FN,l=Q.DTP,C=mstrmojo.mstr.EnumNodeProperties,c=mstrmojo.EnumSelectionType;var AD=0,F=1,M=2,K=3,d=4,t=5;var m=0,AE="u;",Y="LEVEL_NUMBER",X=false,J=7;function AC(AG){return AG.t===47&&AG.st===12033;}function S(AG,AH){if(AG&&AH&&AH.t===J){return AG.parent===AH&&AG.lv===AH.lv;}return false;}function k(AG){if(AG&&AG.t===J){return j.filter(AG.children,function(AH){return AH.lv===AG.lv;});}return[];}function AB(AG){return !!AG.not||AG.fn===E.NOT_IN_LIST||AG.fn===E.NOT_EQUAL;}function y(AG){return U.copyProps(["did","n","t","st","ndetype"],AG);}function P(AJ,AG){var AI=AC(AG),AK=AI?AJ.v:f.terseLong2OldShort(AJ.v),AH={v:AK.replace(/\\:/g,"*:"),n:AJ.n};if(AI){AH.t=AJ.t;AH.conid=AG.did;}return AH;}function R(AJ,AH){if(parseInt(AJ,10)>=0){var AI=AH.lvfs||[],AG=AI[AJ]&&AI[AJ].lvfn||"";return{v:AG?AJ+";"+AG:AJ,dtp:AG?l.CHAR:l.INTEGER};}return null;}function x(AJ,AL,AI){var AG=f.getIdPresentation(AJ),AH=AC(AI);AJ=AJ.replace(/\*:/g,"\\:");switch(AL){case"old":case"oldLong":switch(AG){case"old":case"oldLong":return AJ;case"terse":case"terseLong":switch(AJ[0]){case"V":return AJ.substring(1).split(";")[0];case"n":return"HF:"+ +f.terseLong2OldShort(AJ)+":47";default:return f.terseLong2OldShort(AJ);}}break;case"terse":case"terseLong":switch(AG){case"old":return AH?("V"+AJ+";"+AI.did):f.oldShort2terseLong(AJ,"h");case"oldLong":switch(AJ.substring(0,2)){case"HF":var AK=AJ.substr(3).split(":");if(AK.length>3){AK.pop();}return f.oldShort2terseLong(AK.join(":"),"n");default:return AJ;}case"terse":case"terseLong":return AJ;}break;default:return AJ;}}function s(AG){if(isNaN(AG)&&typeof AG==="string"){return parseInt(AG.split(";")[0],10);}return parseInt(AG,10);}function n(AG){return !AG||AG.lv>0&&!AG.parent;}function a(AG,AO,AN){var AL=AN.item,AI=AN.ancestorMap,AM=AN.descendantMap,AH=this.getItemByValue(AG.itemValue),AK=this.getItemByValue(AO.itemValue),AJ=function(AP,AQ){if(AL&&AL===AP&&AM){return AM[AQ.v];}if(AL&&AL===AQ&&AI){return AI[AP.v];}while(AQ){if(AP===AQ){return true;}AQ=AQ.parent;}return false;};switch(AG.func){case c.ALL:return AO.func===c.ALL?AD:K;case c.ELEMENT:switch(AO.func){case c.ALL:return M;case c.ELEMENT:return AH===AK?AD:S(AH,AK)?M:S(AK,AH)?K:t;case c.BRANCH:return AJ(AK,AH)?M:S(AK,AH)?d:n(AH)?F:t;case c.LEVEL:return AH.lv===AO.level?M:t;case c.BRANCH_LEVEL:return AH.lv!==AO.level?t:n(AH)?F:AJ(AK,AH)?M:t;}break;case c.BRANCH:switch(AO.func){case c.ALL:return M;case c.ELEMENT:return AJ(AH,AK)?K:S(AH,AK)?d:n(AK)?F:t;case c.BRANCH:return AH===AK?AD:(n(AH)||n(AK))?F:AJ(AK,AH)?M:AJ(AH,AK)?K:t;case c.LEVEL:return AH.lv<=AO.level?d:t;case c.BRANCH_LEVEL:return AH===AK?K:(n(AH)||n(AK))?F:AJ(AH,AK)?K:(AJ(AK,AH)&&AO.level>=AH.lv)?d:t;}break;case c.LEVEL:switch(AO.func){case c.ALL:return M;case c.ELEMENT:return AK.lv===AG.level?K:t;case c.BRANCH:return AK.lv<=AG.level?d:t;case c.LEVEL:return AG.level===AO.level?AD:t;case c.BRANCH_LEVEL:return AG.level===AO.level?K:t;}break;case c.BRANCH_LEVEL:switch(AO.func){case c.ALL:return M;case c.ELEMENT:return AK.lv!==AG.level?t:n(AK)?F:AJ(AH,AK)?K:t;case c.BRANCH:return AH===AK?M:(n(AH)||n(AK))?F:AJ(AK,AH)?M:(AJ(AH,AK)&&AG.level>=AK.lv)?d:t;case c.LEVEL:return AG.level===AO.level?M:t;case c.BRANCH_LEVEL:return AG.level!==AO.level?t:AH===AK?AD:(n(AH)||n(AK))?F:AJ(AK,AH)?M:AJ(AH,AK)?K:t;}break;}return F;}function D(AH,AL,AI,AM,AG){var AK=(AH.fs||[]).filter(function(AN){return(AN.n||AN.fnm)===Y;})[0],AJ=j.ensureArray(AI).map(function(AN){return P(AN,AH);});switch(AL){case c.ELEMENT:if(AJ.length>0){return{et:Z.AE,fn:AG?E.NOT_IN_LIST:E.IN_LIST,a:y(AH),es:AJ};}break;case c.BRANCH:if(AJ.length>0){return{et:Z.AE,fn:E.DESCENDANT,not:AG,a:y(AH),es:AJ};}break;case c.LEVEL:if(AK&&parseInt(AM,10)>=0){return{et:Z.AQ,fn:E.EQUAL,not:AG,a:y(AH),fm:{did:AK.did||AK.fid,n:Y,dtp:Q.mapBaseFormTypeToDataType(AK.bftp)},cs:[R(AM,AH)]};}break;case c.BRANCH_LEVEL:if(AJ.length>0&&parseInt(AM,10)>=0){return{et:Z.AE,fn:E.DESCENDANT,not:AG,a:y(AH),es:AJ,cs:[R(AM,AH),{v:18,dtp:l.INTEGER}]};}break;}return null;}function B(){var AG={};this.selectionList.forEach(function(AI,AH){if(AI.func===c.ELEMENT){AG[AI.itemValue]=AH;var AJ=this.getItemByValue(AI.itemValue);j.forEach(k(AJ),function(AK){AG[AK.v]=AH;});}},this);return AG;}function u(){var AG={};this.selectionList.forEach(function(AI,AH){if(AI.func===c.BRANCH){AG[AI.itemValue]=AH;}});return AG;}function A(){var AG={};this.selectionList.forEach(function(AI,AH){if(AI.func===c.LEVEL){AG[AI.level]=AH;}});return AG;}function i(){var AG={};this.selectionList.forEach(function(AJ,AH){if(AJ.func===c.BRANCH_LEVEL){var AK=AJ.itemValue,AL=AJ.level,AI=AG[AK];if(!AI){AI=AG[AK]={};}AI[AL]=AH;}});return AG;}function W(AI){var AH=u.call(this),AG=m;while(AI&&AI.v){AG=Math.max(AG,AH[AI.v]||m);AI=AI.parent;}return AG;}function p(AI,AK){var AG=i.call(this),AJ=A.call(this),AH=AK?m:W.call(this,AI),AM=AI&&AI.lv||0,AL={};if(!AK){U.forEach(AJ,function(AO,AN){if(AN>=AM&&AO>AH){AL[AN]=AO;}});}while(AI&&AI.v){U.forEach(AG[AI.v],function(AO,AN){if(AN>=AM&&AO>AH){AL[AN]=Math.max(AO,AL[AN]||AH);}});AI=AI.parent;}return AL;}mstrmojo.ui._HierarchyListSelection=mstrmojo.provide("mstrmojo.ui._HierarchyListSelection",{_mixinName:"mstrmojo.ui._HierarchyListSelection",init:function w(AG){this._super(AG);this.clearSelections();},getAllSelection:function I(){return !this.selectionList[m].isNot;},setAllSelection:function g(AG){this.selectionList[m].isNot=!AG;},clearSelections:function h(){this.selectionList=[{func:c.ALL,isNot:!X}];return this.selectionList;},addSelection:function V(AG){var AK=this.selectionList,AI=this.getItemByValue(AG.itemValue),AH={item:AI,ancestorMap:AI&&this.getItemAncestorMap(AI),descendantMap:AI&&this.getItemDescendantMap(AI)},AJ=true;if(!AI&&(AG.func===c.ELEMENT||AG.func===c.BRANCH||AG.func===c.BRANCH_LEVEL)){return ;}AK=this.selectionList=AK.filter(function(AL){var AN=a.call(this,AL,AG,AH),AM=AL.isNot===AG.isNot;if(AN===K||AN===d&&!AM){AJ=!AM;}return !(AN===AD||AN===M);},this);if(AJ){AK.push(AG);}},updateSiblingItemSelection:function o(AH){var AJ=this.selectionList,AG=B.call(this),AI=u.call(this);j.forEach(AH,function(AO){var AL=AO.parent,AK=AL?W.call(this,AL):m,AM=AL?p.call(this,AL):A.call(this),AN=Math.max(AI[AO.v]||m,AK),AP=Math.max(AG[AO.v]||m,AN,AM[AO.lv]||m);AO.isSelected=!AJ[AP].isNot;AO.isBranchSelected=!AJ[AN].isNot;},this);},updateItemSelection:function N(AH){var AP=this.selectionList,AI=B.call(this),AQ=u.call(this),AL=A.call(this),AM=i.call(this),AJ=AH?[AH]:this.getRootItems(),AK=AH?[]:this.getItems().filter(function(AR){return AR&&n(AR);}),AG=AH?W.call(this,AH):m,AO=AH?p.call(this,AH,true):{};(AJ.concat(AK)).forEach(function AN(AV){var AT=AG,AS=U.copy(AO);AG=Math.max(AG,AQ[AV.v]||m);U.forEach(AM[AV.v],function(AY,AX){AO[AX]=Math.max(AY,AO[AX]||m);});var AW=Math.max(AI[AV.v]||m,AL[AV.lv]||m,AG,AO[AV.lv]||m);AV.isSelected=!AP[AW].isNot;AV.isBranchSelected=!AP[AG].isNot;j.forEach(AV.children,function(AX){AN.call(this,AX);},this);var AU=k(AV);if(AU.length>0){var AR=j.find(AU,"isSelected",true)>=0;if(AV.isSelected!==AR){this.addSelection({func:c.ELEMENT,itemValue:AV.v,isNot:!AR});AV.isSelected=AR;}}AG=AT;AO=AS;},this);},updateDescendantsStatus:function AF(){var AL=this.selectionList,AG=this.getMaxLevel(),AJ=u.call(this),AH=i.call(this),AI=m,AM=A.call(this);this.getRootItems().forEach(function AK(AW){var AO=AW.children||[],AS=AW.displayChildren||[],AU=AI,AV=U.copy(AM),AP=false;AI=Math.max(AI,AJ[AW.v]||m);U.forEach(AH[AW.v],function(AY,AX){AM[AX]=Math.max(AY,AM[AX]||m);});AO.forEach(function(AX){if(AK(AX)||!AX.hid&&AX.isSelected){AP=true;}});if(AW.hcd&&AS.length===0){var AQ=!AL[AI].isNot,AT,AN;for(var AR=AW.lv+1;AR<=AG;AR++){AT=AM[AR]||m;AN=AT>AI&&!AL[AT].isNot;if(AN||AQ&&AT<=AI){AP=true;break;}}}AW.hasDsctSelected=AP;AI=AU;AM=AV;return AP;});},getMaxLevel:function b(){var AG=0;this.getItems().forEach(function(AH){var AI=AH.lv;if(AI>AG&&!AH.hid){AG=AI;}});this.selectionList.forEach(function(AH){if(AH.func===c.LEVEL||AH.func===c.BRANCH_LEVEL){AG=Math.max(AG,AH.level);}});return AG;},getLevelSelection:function G(AG){var AK=this.selectionList,AI=AG?p.call(this,AG):A.call(this),AH=AG?AG.isBranchSelected:this.getAllSelection(),AJ={};U.forEach(AI,function(AN,AM){var AL=!AK[AN].isNot;if(AL!==AH){AJ[AM]=AL;}});return U.copy({allLevel:AH,isLevelSelected:function(AL){return this[AL]||this.allLevel&&this[AL]!==false;}},AJ);},buildSelectionExprJSON:function e(AI){var AK=this.getAllSelection(),AH=[],AL=null,AJ={selected:[],unselected:[]},AG=function(AM,AN){if(!U.isEmpty(AN)&&(AM.length>0||AK===AB(AN))){AM.push(AN);}};this.selectionList.forEach(function(AN){var AP=AN.func,AM=AN.isNot,AR=AN.level,AQ=AN.itemValue,AO=AQ?this.getItemByValue(AQ):null;if((AO||{}).fetcher){return ;}if(AN.func===c.ELEMENT&&!n(AO)){AJ[AM?"unselected":"selected"].push(AO);}else{if(AN.func!==c.ALL){AG(AH,D(AI,AP,AO,AR,AM));}}},this);AG(AH,D(AI,c.ELEMENT,AJ.selected));AG(AH,D(AI,c.ELEMENT,AJ.unselected,null,true));if(AH.length>0){AL=AH[0];AH.forEach(function(AP,AM,AO){var AN=AB(AP);if(AM>0){if(AN===AB(AO[AM-1])&&AL.nds){AL.nds.push(AP);}else{AL={et:Z.ANDOR,fn:AN?E.AND:E.OR,nds:[AL,AP]};}}});}if(AL){if(AL.et===Z.ANDOR){AL.node=C.CONDITION;}else{AL={et:Z.ANDOR,fn:E.AND,nds:[AL],node:C.CONDITION};}}return AL;},setSelectionByExprJSON:function q(AI){var AJ=this.clearSelections(),AH=false,AG=this.getItems(),AL=f.getIdPresentation(AG[0]&&AG[0].v),AK=function(AN,AO){if(U.isEmpty(AN)){return ;}if(AN.et===Z.ANDOR){(AN.nds||[]).forEach(function(AP){AK.call(this,AP,AO);},this);}else{var AM=AB(AN);if(!AH){AH=true;this.setAllSelection(AM);}if(AN.et===Z.AQ&&AN.fm&&AN.fm.n===Y){(AN.cs||[]).forEach(function(AQ){var AP=s(AQ.v);if(AP>=0){AO.push({func:c.LEVEL,level:AP,isNot:AM});}});}if(AN.et===Z.AE){(AN.es||[]).forEach(function(AP){var AQ=x(AP.v,AL,AN.a),AR=s(AN.cs&&AN.cs[0].v);if(!this.getItemByValue(AQ)){this.addItems([U.copy({v:AQ,dhid:true},U.clone(AP))],true);}if(AN.fn===E.DESCENDANT){if(AR>=0){AO.push({func:c.BRANCH_LEVEL,itemValue:AQ,level:AR,isNot:AM});}else{AO.push({func:c.BRANCH,itemValue:AQ,isNot:AM});}}else{AO.push({func:c.ELEMENT,itemValue:AQ,isNot:AM});}},this);}}};AK.call(this,AI,AJ);this.updateItemSelection();},setSelectionByList:function L(AH,AG){var AI=[],AJ=false;j.forEach(AH,function(AK){var AL=AK.v;if(AL===AE){AJ=true;return false;}if(!this.getItemByValue(AL)){this.addItems([AK],true);}AI.push({func:c.ELEMENT,itemValue:AL,isNot:!AG});},this);this.clearSelections();if(!AJ){this.setAllSelection(!AG);this.selectionList=this.selectionList.concat(AI);}this.updateItemSelection();},onSelectionChange:function O(AH,AG,AI,AJ){if(AH===c.ALL){this.clearSelections();this.setAllSelection(AG);}else{this.addSelection({func:AH,itemValue:AI&&AI.v,level:AJ,isNot:!AG});}if(this.postSelectionChange){this.postSelectionChange();}},postAddItems:function H(AG){this.updateItemSelection();},postAddSiblingItems:function AA(AH,AG){this.updateSiblingItemSelection(AH);},postAddBranchItems:function z(AH,AG){this.updateItemSelection(AG);}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.expr","mstrmojo.array","mstrmojo.hash");mstrmojo.requiresDescs(308,5923,7930,5282,5283,2793,2787,2788,12298);var D=mstrmojo.string,S=mstrmojo.expr,M=S.ET,L=mstrmojo.array,R=mstrmojo.hash;var V=S.FN,K=S.BRANCH_FNS[V.NOT],Z=mstrmojo.mstr.EnumDSSXMLObjectTypes,H=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,N=mstrmojo.mstr.EnumDSSConsolidationType;function C(a){return D.htmlAngles(a)||"";}var A={betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),andText:mstrmojo.desc(5282,"AND"),orText:mstrmojo.desc(5283,"OR"),boldandText:"<span style='font-weight:bold;'>"+mstrmojo.desc(5282,"AND")+"</span>",boldorText:"<span style='font-weight:bold;'>"+mstrmojo.desc(5283,"OR")+"</span>",whereText:mstrmojo.desc(2793,"Where (##)"),notText:mstrmojo.desc(12298,"NOT")};var Y={"*":function(b,a){return{html:b?('<span class="mstrmojo-unknown">'+(C(b.n||b.xml)||"...")+"</span>"):null,text:b?(C(b.n||b.xml)||"..."):null};}};function W(a){return !!a.not||a.fn===V.NOT_EQUAL||a.fn===V.NOT_IN_LIST||a.fn===V.NOT_BETWEEN||a.fn===V.NOT;}function I(a){if(a&&a.not){return{html:'<span class="mstrmojo-text mstrmojo-not">'+K+"</span>",text:K+" "};}return{html:"",text:""};}function U(c,b){var a=c&&((b?'<span class="mstrmojo-ListIcon t'+b+'"></span>':"")+'<span class="mstrmojo-text mstrmojo-embedobj">'+C(c)+"</span>");return{html:a,text:c&&((b?b+" ":"")+C(c))};}function Q(a,c){var b=c&&c.trim().split(" ")||[];if(a.t===Z.Attribute&&a.st===H.AttributeRecursive){b.push("recursive");}else{if(a.t===Z.Consolidation&&a.st===H.ConsolidationManaged){b.push("derived");if(a.ndetype===N.DssRecursiveDerivedElement){b.push("recursive");}}}return b.join(" ");}function G(b,a){var c=C(b.n);return{html:'<span class="mstrmojo-text mstrmojo-attr '+Q(b,a)+'">'+c+"</span>",text:c};}Y[M.R]=function(b,a){return U(b.r&&b.r.n,b.r&&b.r.t);};Y[M.F]=function(b,a){return U(b.f&&b.f.n,b.f&&b.f.t);};Y[M.XML]=function(b,a){return U(b.n||b.p&&b.p.n||b.xml,b.p&&b.p.t);};Y[M.AE]=function(p,f){var m=[],j=[],c=(f&&f.elemsEmpty)||"("+mstrmojo.desc(2210,"Empty")+")";if(p&&p.a&&p.a.n){var b=G(p.a);m.push(b.html);j.push("{"+b.text+"}");var a=C(S.fnName(p.et,p.fn,p.fnt));m.push('<span class="mstrmojo-text mstrmojo-fn">'+a+"</span>");j.push(" "+a+" ");var q=p.es,g=q&&q.length||0;if(g){m.push('<span class="mstrmojo-elems">');j.push("[");var i=m.length,o="";for(var n=0;n<g;n++){m[i++]='<span class="mstrmojo-text mstrmojo-elem">';o=C(q[n].n);m[i++]=o;j.push(o);if(n<g-1){m[i++]=", ";j.push(", ");}m[i++]="</span>";}m[i++]="</span>";j.push("]");}else{m.push('<span class="mstrmojo-text mstrmojo-emptyelems">'+c+"</span>");j.push(c);}}return{html:m.join(""),text:j.join("")};};Y[M.AQ]=function(x,z){var u=[],j=[];if(x&&x.a&&x.a.n){var e=G(x.a);u.push(e.html);j.push("{"+e.text+"}");if(x.fm&&x.fm.n){var AA=C(x.fm.n);u.push('<span class="mstrmojo-text mstrmojo-form">'+AA+"</span>");j.push("("+AA+")");if(x.fn!=null){var k=C(S.fnName(x.et,x.fn,x.fnt,x.fm.dtp));u.push('<span class="mstrmojo-text mstrmojo-fn">'+k+"</span>");j.push(" "+k+" ");var l=S.fnCstCount(x.fn,x.fnt);if(x.et===M.AC){if(l>=1){if(x.a2&&x.a2.n){var p=C(x.a2.n);u.push('<span class="mstrmojo-text mstrmojo-attr2">'+p+"</span>");j.push("{"+p+"}");if(x.fm2&&x.fm2.n){var w=C(x.fm2.n);u.push('<span class="mstrmojo-text mstrmojo-form2">'+w+"</span>");j.push("("+w+")");}}if(l>1){u.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");j.push(" "+A.betweenText+" ");if(x.a3&&x.a3.n){var b=C(x.a3.n);u.push('<span class="mstrmojo-text mstrmojo-attr3">'+b+"</span>");j.push("{"+b+"}");if(x.fm3&&x.fm3.n){var c=C(x.fm3.n);u.push('<span class="mstrmojo-text mstrmojo-form3">'+c+"</span>");j.push("("+c+")");}}}}}else{if(x.et===M.AL){var a=x.cs||[],f=[];for(var q=0,s=a.length;q<s;q++){f.push(a[q].v);}var n=f.join(mstrConfig.listSep);u.push('<span class="mstrmojo-text mstrmojo-c1">'+n+"</span>");j.push("["+n+"]");}else{if(l>=1){var a=x.cs,o=a&&a[0];var y=C(o&&o.p&&o.p.n||o&&o.v);u.push('<span class="mstrmojo-text mstrmojo-c1">'+y+"</span>");j.push(y);if(l>1){var m=a&&a[1];u.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");j.push(" "+A.betweenText+" ");var g=C(m&&m.p&&m.p.n||m&&m.v);u.push('<span class="mstrmojo-text mstrmojo-c1">'+g+"</span>");j.push(g);}}}}}}}return{html:u.join(""),text:j.join("")};};Y[M.AC]=Y[M.AQ];Y[M.AL]=Y[M.AQ];Y[M.MQ]=function(y,z){var x=[],m=[],q=y&&y.m,AB=q&&q.n;if(AB){var b=y.fnt,g=S.FNT.PER,w=S.FNT.RANK;AB=b===g?mstrmojo.desc(2787,"Percentage of ##").replace("##",AB):b===w?mstrmojo.desc(2788,"Rank of ##").replace("##",AB):AB;x.push('<span class="mstrmojo-text mstrmojo-metric">'+C(AB)+"</span>");m.push(C(AB));if(y.fn!=null){var n=C(S.fnName(y.et,y.fn,b,S.DTP.REAL));x.push('<span class="mstrmojo-text mstrmojo-fn">'+n+"</span>");m.push(" "+n+" ");var o=S.fnCstCount(y.fn,b);if(y.et==S.ET.MC){if(o>=1){var AA=(y.m2&&y.m2.n)||(y.c2&&y.c2.v)||"?";x.push('<span class="mstrmojo-text mstrmojo-m2">'+C(AA)+"</span>");m.push(C(AA));if(o>1){x.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");m.push(" "+A.betweenText+" ");var e=(y.m3&&y.m3.n)||(y.c3&&y.c3.v)||"?";x.push('<span class="mstrmojo-text mstrmojo-m3">'+C(e)+"</span>");m.push(C(e));}}}else{if(o>=1){var c=y.cs,s=c&&c[0];var a=function(h){var d=h.v;if(y.fnt==g){if(d.replace){h.v=d.replace(/%$/,"");}d=h.v+"%";}return d;};var k=C(s&&s.p&&s.p.n||s&&s.v&&a(s));x.push('<span class="mstrmojo-text mstrmojo-c1">'+k+"</span>");m.push(k);if(o>1){var p=c&&c[1],l=C(p&&p.p&&p.p.n||p&&p.v&&a(p));x.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");m.push(" "+A.betweenText+" ");x.push('<span class="mstrmojo-text mstrmojo-c2">'+l+"</span>");m.push(l);}}}var t=y.dmy&&y.dmy.uts,j=t&&t.length;if(j){x.push('<span class="mstrmojo-text mstrmojo-at">'+A.atText+"</span>");m.push(" "+A.atText+" ");x.push('<span class="mstrmojo-dmy">');for(var i=0;i<j;i++){var f=t[i];x.push('<span class="mstrmojo-text mstrmojo-dmyunit">');x.push(C(f.utgt?f.utgt.n:f.n));m.push(C(f.utgt?f.utgt.n:f.n));if(i<j-1){x.push(",");m.push(",");}x.push("</span>");}x.push("</span>");}}}return{html:x.join(""),text:m.join("")};};Y[M.MC]=Y[M.MQ];Y[M.ANDOR]=function(k,c){var i=[],g=[],b=(c&&c.elemsEmpty)||"("+mstrmojo.desc(2210,"Empty")+")",e=R.valarray(S.findTargets(k,"did"))[0],f=true;function l(d){if(!f){i.push('<span class="spliter"></span>');g.push(", ");}f=false;if(d){g.push(mstrmojo.desc(12298,"NOT")+" ");}}if(!e){return{html:'<span class="mstrmojo-text mstrmojo-emptyelems">'+b+"</span>",text:b};}var a=G(e,"andor");i.push(a.html);g.push("{"+a.text+"}");i.push("<span>:</span>");g.push(" : ");i.push('<span class="mstrmojo-elems">');g.push("[");L.forEach(k.nds,function j(m){if(!m){return ;}var d=W(m),t=m.fm,p=m.cs,n,q,h,o;switch(m.et){case M.ANDOR:L.forEach(m.nds,j);break;case M.AE:switch(m.fn){case V.IN_LIST:case V.NOT_IN_LIST:L.forEach(m.es,function(u){l(d);n=d?" not":"";q=C(u.n);i.push('<span class="mstrmojo-text mstrmojo-elem single'+n+'">'+q+"</span>");g.push(q);});break;case V.DESCENDANT:var s=(m.es||[]).slice();if(s.length===0){s.push({n:b});}L.forEach(s,function(w){l(d);n=d?" not":"";q=C(w.n);if(p&&p[0]){var u;o=p[0].v;if(isNaN(o)){h=o.substr(o.indexOf(";")+1);}else{h=mstrmojo.desc(493,"Level")+" "+(parseInt(o,10)+1);}u=h+" "+mstrmojo.desc(12853,"of")+" "+q;i.push('<span class="mstrmojo-text mstrmojo-elem level'+n+'">');i.push(u);g.push(u);}else{i.push('<span class="mstrmojo-text mstrmojo-elem descendant'+n+'">');i.push(C(w.n));g.push(q);}i.push("</span>");});break;}break;case M.AQ:L.forEach(m.cs,function(u){l(d);n=d?" not":"";o=u.v;h=(t&&t.n)?C(t.n+" "+o):"";if(t&&t.n==="LEVEL_NUMBER"){n+=" level";if(isNaN(o)){h=o.substr(o.indexOf(";")+1);}else{h=mstrmojo.desc(493,"Level")+" "+(parseInt(o,10)+1);}}i.push('<span class="mstrmojo-text mstrmojo-elem constant'+n+'">'+h+"</span>");g.push(h);});break;}});i.push("</span>");g.push("]");return{html:i.join(""),text:g.join("")};};function O(f,e){var c=Y[f&&f.et]||Y["*"],b=I(f),d=c&&c(f,e),a=e&&e.emptyText||A.emptyText;return{html:b&&b.html+((d&&d.html)||('<span class="mstrmojo-text empty-cond">'+a+"</span>")),text:b&&b.text+((d&&d.text)||a)};}function F(a){return O(a).text;}function J(f,e,c){if(!f){return null;}var o=f.et,l=f.fn,b=f.nds;if(o===M.ANDOR){var p=c?"bold":"",a=l===V.AND?A[p+"andText"]:(l===V.OR?A[p+"orText"]:"");b=[].concat(b);if(b.length<1){return null;}var k=[],q;L.forEach(b,function(s){q=J(s,false,c);if(q){k.push(q);}});var n,m=k.length;if(m<1){return null;}else{if(m===1){n=k[0];}else{n=k.join(" "+a+" ");}}n=e||f.not?n:"("+n+")";return f.not?A.notText+" "+n:n;}else{if(o===M.RLS){var j=f.dmy&&f.dmy.uts||[],h=[],g;L.forEach(j,function(s){h.push("{"+s.n+"}");});g=h.join(", ");var d=f.nds&&f.nds[0],i=J(d,false,c);if(i){return"("+g+" "+A.whereText.replace(/\(##\)/g,"").replace(/'##'/g,"")+i+")";}return null;}else{return F(f);}}}function B(a){if(mstrmojo.fe.FilterUtils.isExprEmpty(a)){return{et:14,fn:19};}else{((a&&a.nds)||[]).forEach(function(c,b){a.nds[b]=B(c);});return a;}}mstrmojo.fe.FilterUtils=mstrmojo.provide("mstrmojo.fe.FilterUtils",{getExprXml:function(g){var b="<exp>",a="</exp>",e={a:true,a2:true,a3:true,agg:true,cc:true,ce:true,cgp:true,cs:true,conid:true,desc:true,did:true,attId:true,dmt:true,dmy:true,dtp:true,es:true,et:true,expr:true,f:true,flat:true,flt:true,fm:true,fm2:true,fm3:true,fn:true,fnt:true,fres:true,gb:true,isp:true,items:true,m:true,m2:true,m3:true,n:true,nds:true,not:true,pf:true,p:true,r:true,rps:true,st:true,t:true,utgt:true,utp:true,uts:true,v:true,xml:true,relation:true,applySubExpr:true,useSchema:true,guide:true,rsTp:true,joTp:true,paTp:true,erTp:true,exp:true,joAttrs:true,ph:true,idx:true,idc:true,idcsi:true,ucfg:true,node:true},d={getArrItemName:function(h){return h.substr(0,h.length-1);},isSerializable:function(s,p,o){if(s==="xml"){var j=p[o].xml;return{att:'hasXML = "-1"',child:j};}else{if(mstrmojo.array.indexOf(["header_format","grid_format","child_header_format","child_grid_format"],s)>-1){var t=p[o][s];if(!t){return{};}var l="<"+s+">";for(var q in t){l+="<prs n='"+q+"'>";var k=t[q];for(var h in k){var n=k[h];l+="<pr n='"+h+"' v='"+(n==="pru"?"":n)+"'";l+=n==="pru"?' pru="1"':"";l+="/>";}l+="</prs>";}l+="</"+s+">";return{child:l};}else{if(s==="cs"){var i=p[o],m=p[o][s];if(i&&i.fnt&&i.fnt==S.FNT.PER&&m){if(m[0]){m[0].v+="%";}if(m[1]){m[1].v+="%";}}return true;}else{if(s==="c2"||s==="c3"){var i=p[o];if(i&&i.et==S.ET.MC&&(i.fn==S.FN.BETWEEN||i.fn==S.FN.NOT_BETWEEN)){return true;}else{return false;}}}}}return(e[s])?true:false;},skipNull:true},c=B(g);if(!c||c.et!=M.ANDOR||c.fn===V.NOT||c.not){c={et:M.ANDOR,fn:S.FN.AND,nds:c?[c]:[]};}var f=D.json2xml("nd",[{},c],d);return b+f+a;},isExprEmpty:function(a){return(!a||(a.et===M.ANDOR&&(a.nds||[]).length<1));},getExprConditionNodeHtml:function E(a){return O(a).html;},getExprConditionNodeText:function F(a){return O(a).text;},getExprNodeHtmlAndText:function P(b,a){return O(b,a);},getExprText:function X(b,a){return J(b,true,a);}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([\- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')}};var J=mstrmojo.validation,C=J.TRIGGER,f=J.STATUSCODE,B={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,17:3,18:3,21:2,22:2,23:3,24:4,25:3,30:5,34:5,49:7};J.VALIDATOR={DEMO:function Q(i){var h=parseInt(i,10),j=mstrmojo.validation.STATUSCODE;if(h===0||h===1||h>10){return{code:j.VALID};}return{code:j.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function L(h){var i=String(h).replace(/[^\d]/g,"");if(i.length<10){return{code:f.INVALID,msg:mstrmojo.desc(9203,"A telephone number must contain at least 10 digits.")};}if(!J.REGEXP.PHONE_NUMBER.test(h)){return{code:f.INVALID,msg:mstrmojo.desc(9204,"The telephone number contains invalid characters.")};}return{code:f.VALID};},VALIDATE_ZIPCODE:function I(h){var j="",i=this.dtp;if(!J.REGEXP.US_ZIP.test(h)){if(J.isNumeric(i)||J.isInt(i)){j=mstrmojo.desc(9208,"A zip code must be 5 digits or 5+4 digits.");}else{if(J.isString(i)){j=mstrmojo.desc(9206,"The zip code is invalid");}}return{code:f.INVALID,msg:j};}return{code:f.VALID};},VALIDATE_EMAIL:function X(h){var i=h.indexOf("@");if(i===-1){return{code:f.INVALID,msg:mstrmojo.desc(9197,"The email address is missing an at sign (@).")};}if(h.substring(i).indexOf(".")===-1){return{code:f.INVALID,msg:mstrmojo.desc(9198,"The email address is missing a period on the domain.")};}return J.REGEXP.EMAIL_ADDRESS.test(h)?{code:f.VALID}:{code:f.INVALID,msg:mstrmojo.desc(9207,"The email address is invalid.")};},VALIDATE_SSN:function U(h){var j=this.dtp,i;if(J.isNumeric(j)||J.isInt(j)){i=String(h).replace(/[^\d]/g,"");if(i.length!==9){return{code:f.INVALID,msg:mstrmojo.desc(9209,"A Social Security Number must be 9 digits.")};}}if(!J.REGEXP.SOCIAL_SECURITY_NUMBER.test(h)){return{code:f.INVALID,msg:mstrmojo.desc(9210,"The Social Security Number is invalid.")};}return{code:f.VALID};}};J.isInt=function F(h){return B[h]===1;};J.isNumeric=function c(h){return B[h]===2||B[h]===5;};J.isEnhNumeric=function K(h){return B[h]===7;};J.isString=function M(h){return B[h]===3;};J.isDateTime=function A(h){return B[h]===6;};var E=window.mstrConfig,P=E.listSep,W=mstrmojo.expr,O=W.DTP,d=mstrmojo.num,Y=mstrmojo.string,H=mstrmojo.date;function S(p,q){var m=p.dtp,o=p.constraints,t=o.allowedFormatChars||"",k=J.isInt(m),h=J.isNumeric(m),l=J.isEnhNumeric(m),i=J.isDateTime(m),s=mstrmojo.locales.number.THOUSANDSEPARATOR,j=mstrmojo.locales.number.DECIMALSEPARATOR,n;if(k){if(!p._intRegExp){t+="0-9-"+(p.isList?P:"")+s;p._intRegExp=new RegExp("[^"+t+"]");}n=p._intRegExp;}if(h){if(!p._numericRegExp){t+="0-9-#"+(p.isList?P:"")+j+s;p._numericRegExp=new RegExp("[^"+t+"]");}n=p._numericRegExp;}if(l){if(!p._percentageRegExp){t+="0-9-#"+(p.isList?P:"")+j+s+"%";p._percentageRegExp=new RegExp("[^"+t+"]");}n=p._percentageRegExp;}return !!n&&n.test(q);}function g(q,t){var n=q.dtp,p=q.constraints,k=J.isInt(n),h=J.isNumeric(n),l=J.isEnhNumeric(n),i=J.isDateTime(n),j=p.min,s=p.max,o;if(j===undefined&&s===undefined){return false;}if(k||h){if(d.isBigDecimal(t)){return d.inNumericRange(d.parseBigDecimal(t),j,s)!==0;}return d.inNumericRange(t,j,s)!==0;}if(i){return H.inDateTimeRange(t,j,s)!==0;}if(l){var m=d.toLocaleString(d.parseEnhNumeric(t));j=d.parseEnhNumeric(d.toLocaleString(j));s=d.parseEnhNumeric(d.toLocaleString(s));return d.inNumericRange(m,j,s)!==0;}return false;}function N(i,h){return !d.isNumeric(h)&&!d.isBigDecimal(h);}function D(i,h){return !d.isNumeric(h,true);}function V(k,i){var j=(k.dtp===O.DATE),h=(k.dtp===O.TIME);return(j?!H.isDate(i):(h?!H.isTime(i):!H.isDateAndOrTime(i)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:O.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function a(h){this._super(h);if(!this.constraints){this.constraints={};}var i=this.constraints;if(!i.hasOwnProperty("trigger")){i.trigger=C.NONE;}},_set_value:function(m,j){var k=this.value,i=(k!==j);if(i){this.value=j;var l=this.constraints.trigger,h=(l&C.VALUESET)>0;if(h){this.validate(j);}}return i;},validate:function R(){var k=(this.value!==null&&this.value!==undefined)?this.value:"",n=this.isList?k.split(P):[k],m,j,o,h=n.length,l;for(l=0;l<h;l++){m=this.doValidation(n[l]);j=(m.code>f.VALID);if(j){if(h>1){m.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",n[l]||" ");}break;}}o=j?"onInvalid":"onValid";if(!j&&this.autoFormat){this.format();}this.set("validationStatus",m);if(this[o]){this[o](m);}},format:function b(){var n=this.dtp,k=J.isDateTime(n);if(!k){return ;}var p=mstrConfig.listSep,t=this.value||"",j=this.isList?t.split(p):[t],s=n===14,q=[],h,l=mstrmojo.locales.datetime,o=j.length,m;for(m=0;m<o;m++){t=j[m];h=H.parseDateAndOrTime(t);if(h){if(s&&h.date){q.push(H.formatDateInfo(h.date,l.DATEOUTPUTFORMAT));}else{q.push((h.date?H.formatDateInfo(h.date,l.DATEOUTPUTFORMAT):"")+" "+(h.time?H.formatTimeInfo(h.time,l.TIMEOUTPUTFORMAT):""));}}}this.set("value",q.join(p));},isValid:function Z(){var h=this.validationStatus;if(!h){this.validate();}return this.validationStatus.code===f.VALID;},clearValidation:function e(){this.set("validationStatus",{code:f.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function G(w){var s=this.constraints,t=s.regExp,j=s.validator,h={id:this.id,code:f.VALID,msg:""},q=this.dtp,o=J.isInt(q),i=J.isNumeric(q),p=J.isEnhNumeric(q),k=J.isString(q),l=J.isDateTime(q),n=Y.isEmpty(w),u=String(w).length,m="",y=mstrmojo.locales.validation;if(this.required&&n){h.code=f.INVALID_EMPTY;h.msg=y.requiredFieldError;return h;}w=Y.trim(w);if(!n&&S(this,w)){if(o){m=y.integerDataType;}if(i){m=y.numericDataType;}if(l){m=y.dateDataType;}h.code=f.INVALID_CHAR;h.msg=y.invalidCharError.replace("#",m);return h;}if(!n&&l&&V(this,w)){h.code=f.INVALID_BAD_DATESTRING;h.msg=y.invalidDateStringError;return h;}if(!n&&(i||o)&&N(this,w)){h.code=f.INVALID_BAD_NUMERICFORMAT;h.msg=y.invalidNumericFormatError;return h;}if(!n&&p&&D(this,w)){h.code=f.INVALID_BAD_NUMERICFORMAT;h.msg=y.invalidNumericFormatError;return h;}if(!n&&(o||i||l||p)&&g(this,w)){h.code=f.INVALID_OUTOFRANGE;if(s.min!==null&&s.max!==null){m=y.outofRangeError.replace("# ","").replace("##",d.toLocaleString(s.min)).replace("###",d.toLocaleString(s.max));}else{if(s.min!==null){m=y.noLessMinError.replace("##",d.toLocaleString(s.min)).replace("# ","");}else{if(s.max!==null){m=y.noGreaterMaxError.replace("###",d.toLocaleString(s.max)).replace("# ","");}}}h.msg=m;return h;}if(k&&s.minLen!==null&&s.maxLen!==null){if(u<s.minLen||u>s.maxLen){h.code=f.INVALID;h.msg=mstrmojo.desc(9211).replace(/#/,s.minLen).replace(/##/,s.maxLen);return h;}}if(t&&!t.test(w)){h.code=f.INVALID_REGEX;h.msg=mstrmojo.desc(9205);return h;}var x=j&&j.apply(this,[w]);if(x){h.code=x.code;h.msg=x.msg;return h;}return h;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.vi.util.TemplateUtils");var F=mstrmojo.array,E=mstrmojo.expr,D=E.ET,B=mstrmojo.vi.util.TemplateUtils;function C(J,H,L){var I=L&&B.findUnitsById(L,[J.did]),G=I&&!!I.length&&I[0].n,K;if(G&&!!G.length){return G;}else{K=H.findUnitNameInDataSetFromUnit(J.did);return !!K?K:J.n;}}mstrmojo._HasItemAliases=mstrmojo.provide("mstrmojo._HasItemAliases",{_mixinName:"mstrmojo._HasItemAliases",adjustItemName:function A(I,G,J){var H=this;if(!I||!G){return ;}if(I.a&&I.a2){I.a.n=C(I.a,G,J);I.a2.n=C(I.a2,G,J);}else{if(I.a){I.a.n=C(I.a,G,J);}else{if(I.m&&I.m2){I.m.n=C(I.m,G,J);I.m2.n=C(I.m2,G,J);}else{if(I.m){I.m.n=C(I.m,G,J);}else{if(I.et===D.ANDOR){F.forEach(I.nds,function(K){H.adjustItemName(K,G,J);});}else{if(I.n!==undefined&&I.did){I.n=C(I,G,J);}}}}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.num","mstrmojo.locales");var D=mstrmojo.array,A=mstrmojo.num,B=mstrmojo.locales;mstrmojo.vi.util.NumberFormatUtility=mstrmojo.provide("mstrmojo.vi.util.NumberFormatUtility",{applyFormatToNumber:function C(P,Q,G){var H="\u00A4",L=/"[^"]*"/g,F=P.match(L),K=P.replace(L,H),O=["m","y","d","h","s"],N=G||false,E=new Date(),M=E.getFullYear(),J=E.getMonth(),I=E.getDay(),S=B.datetime,R;D.forEach(O,function(U){N=N||K.indexOf(U,0)!==-1;});if(N){K=K.replace(/y{3,}/g,M).replace(/y{1,2}/g,M.toString().slice(2,4));K=K.replace(/m{4,}/g,S.MONTHNAME_FULL[J-1]).replace(/m{3}/g,S.MONTHNAME_SHORT[J-1]).replace(/mm/g,"07").replace(/m/g,"7").replace(/7ber/g,"mber");K=K.replace(/d{4,}/g,S.dayNames[I-1]).replace(/d{3}/g,"Mon").replace(/dd/g,"10").replace(/d/g,"1").replace(/1ay/g,"day");K=K.replace(/hh/g,"08").replace(/h/g,"8");K=K.replace(/ss/g,"04").replace(/s/g,"4");K=K.split(H);R=K[0];D.forEach(F,function(V,U){R+=V+K[U+1];});return R;}if(A.isNumeric(Q)){return A.formatByMask(P,A.parseNumeric(Q));}return Q;}});}());(function(){mstrmojo.requiresCls("mstrmojo.num","mstrmojo.hash","mstrmojo.string","mstrmojo.array","mstrmojo._FormatDefinition");var B=mstrmojo.num,G=mstrmojo.hash,F=mstrmojo.string,C=mstrmojo.array,E=mstrmojo._FormatDefinition.NumberFormatCategory;mstrmojo.MetricSelectorUtility=mstrmojo.provide("mstrmojo.MetricSelectorUtility",{_GENERIC:1,_RANK:2,_PERCENT:3,OP:{_EQUALS:0,_NOT_EQUALS:1,_GREATER:2,_GREATER_EQUAL:3,_LESS:4,_LESS_EQUAL:5,_BETWEEN:6,_NOT_BETWEEN:7,_IN:8,_NOT_IN:9,_IS_NULL:10,_IS_NOT_NULL:11},OP_NAMES:[{n:mstrmojo.desc(2795,"Equals"),v:0},{n:mstrmojo.desc(2796,"Does not equals"),v:1},{n:mstrmojo.desc(521,"Greater than"),v:2},{n:mstrmojo.desc(522,"Greater than or equal to"),v:3},{n:mstrmojo.desc(523,"Less than"),v:4},{n:mstrmojo.desc(524,"Less than or equal to"),v:5},{n:mstrmojo.desc(696,"Between"),v:6},{n:mstrmojo.desc(746,"Not between"),v:7},{n:mstrmojo.desc(587,"In"),v:8},{n:mstrmojo.desc(2204,"Not In"),v:9},{n:mstrmojo.desc(2202,"Is null"),v:10},{n:mstrmojo.desc(2203,"Is not null"),v:11}],RANK_OP_NAMES:[{n:mstrmojo.desc(529,"Highest"),v:1},{n:mstrmojo.desc(530,"Lowest"),v:2},{n:mstrmojo.desc(4407,"Highest %"),v:3},{n:mstrmojo.desc(4406,"Lowest %"),v:4}],Q:{_G:0,_RT:1,_RB:2,_PT:3,_PB:4},MRPFN:{TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23},FN:{EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000},F:[[6,7,8,10,9,11,17,44,22,57,54,55],[15,16,4,18,20,1,13,14,22,24],[7,8,5,17,19,2,3,6,21,23]],EnumNumberCategory:{Default:-2,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7,Special:8,General:9,FromGrid:10},typeHelperCls:{0:"MetricValueSliderHelper",defaultCls:"MetricRankSliderHelper"},ErrorType:{_GENERIC:mstrmojo.desc(11689,"Invalid Number"),_RANK:mstrmojo.desc(11856,"Please enter value between ## and ###.")},ErrorCode:{EmptyValue:"emptyValueVIWarning",InvalidValue:"invalidValueVIWarning",OutOfRange:"outOfRangeVIWarning",NotInteger:"notIntegerVIWarning"},getQuaByFunc:function(L,M){var I=this.F,H=this.Q,K=H._G,J=function(N){return C.indexOf(I[1],N)!==-1;};if(J(L)){K=(M===this._RANK)?H._RT:H._PT;}else{K=(M===this._RANK)?H._RB:H._PB;}return K;},getFuncInfo:function(K,L){var J={},I=this.Q,H=this.F;J[I._G]={ft:this._GENERIC,f:H[0][K]};J[I._RT]={ft:this._RANK,f:H[1][K]};J[I._RB]={ft:this._RANK,f:H[2][K]};J[I._PT]={ft:this._PERCENT,f:H[1][K]};J[I._PB]={ft:this._PERCENT,f:H[2][K]};return J[L]||{};},getOpIdxByfunc:function(J,K){if(!J||!K){return -1;}var H=this.F,I=-1;switch(K){case this._GENERIC:I=C.indexOf(H[0],J);break;case this._RANK:case this._PERCENT:I=C.indexOf(H[1],J);if(I===-1){I=C.indexOf(H[2],J);}break;}return I;},getIncludeByOp:function(I){var H=this.OP;return I===H._EQUALS||I===H._GREATER_EQUAL||I===H._LESS_EQUAL||I===H._BETWEEN||I===H._IN;},formatNumber:function(J,L,I){var M,K=this.Q,N=I.fm,H=I.cat;if(!B.validateFormat(N)){N="#,##0.00;(#,##0.00)";}if(J===K._G){M=(N)?B.formatByMask(N,L):B.format(I.cat,I.dp,I.curr,L);}else{if(J===K._RB||J===K._RT){M=String(parseInt(L,10));}else{if(J===K._PB||J===K._PT){M=parseFloat(L)+"%";}}}if((H===E.Fixed||H===E.Currency||H===E.Percentage)&&L<0&&!F.startsWith(M,"(")&&!F.startsWith(M,"-")){M="-"+M;}return M;},doValidation:function(U,L,P,N){var O=L.qua,R=L.low,K=L.high,M=this.Q,V=O===M._RT||O===M._RB,H=O===M._PT||O===M._PB,S="",J,I=this.ErrorCode;if(F.isEmpty(U)){S=I.EmptyValue;}else{if(!(B.isNumeric(U)||(H&&String(U).match(/^\d+(\.\d+)?%$/))||(N&&!H&&B.isBigDecimal(U)))){S=I.InvalidValue;}else{if((O===M._PT||O===M._PB)&&B.inNumericRange(parseFloat(U),R,K)){S=I.OutOfRange;J=H?["0","100%"]:[R,K];}else{if(V&&(!B.isInt(U)||B.parseInteger(U,10)<0)){S=I.NotInteger;}}}}return G.copy(P,{invalid:!!S,errorCode:S,args:J||[]});},restoreMetricSelectorProps:function D(I,H){if(!I||!H){return ;}G.copyProps(["max","min","cnt","dt","nov"],H,I);},restoreMetricSelectorSelections:function A(I,H){if(!I||!H){return ;}G.copyProps(["f","ft","cs"],H,I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func","mstrmojo._ImageHelper","mstrmojo.fe.FilterUtils","mstrmojo.rw.model.RetrievalKeysConfig","mstrmojo.rw.model.UpdateKeysConfig");var e=mstrmojo.hash,B=e.copy,V=mstrmojo.array,AX=mstrmojo.dom,y=mstrmojo.func,AN=[mstrmojo.desc(8445,"Loading")],AE=mstrmojo.fe.FilterUtils.getExprXml,Ar=mstrmojo.array.ensureArray,P=0;function X(BW){BW=BW||{};BW.preserveUndo=true;return BW;}function Ao(Ba,Bb,BW){if(this.blockRequests){throw ("The data service is currently ignoring all requests to the server.");}var BX=P++,BZ=this.getTxUpdates(BX);BW=BW||{};BW.src=Ao.caller.name;if(!mstrmojo.string.isEmpty(BZ)){Ba.updateChanges=BZ;}Ba.zoomFactor=this.model.getZoomFactor();var BY=this.cmdMgr;if(!BW.preserveUndo&&BY){BY.onSubmitUpdates();}mstrApp.serverRequest(Ba,this.wrapCallback(Bb,BX,BW.preserveStid),BW);}function N(BY,BX,BW){e.copy({unitType:BX.defn&&BX.defn.t,unitKey:BX.k},BY);if(BW.layoutKey){e.copy({toKey:BW.layoutKey,analysisSectionType:BW.analysisSectionType},BY);}else{e.copy({toKey:BW.parentKey},BY);}return BY;}function Au(BX){BX=BX||{};if(mstrApp.optimizeFitToPage){var BW=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(BW){BX.styleName="RWDocumentMobileStyle";BX.availableWidth=BW.w;BX.availableHeight=BW.h;}else{BX.innerWidth=mstrmojo.dom.windowDim().w;BX.innerHeight=mstrmojo.dom.windowDim().h;}}return BX;}function BR(BX){var BW=BX&&BX.style,BY=BW&&BW.params;return BY&&BY.treesToRender;}function C(BW,BX,BY){return{act:"moveUnit",toKey:BW,unitType:BX,srd:BY};}function At(BW){return BW.split("\u001E")[2];}function M(BX,Bb){if(BX!==mstrmojo.DocDataService.UNDO_KEY){return BX;}if(!this.undoSectionKey){var Ba=this.undoSectionKey=this.model.getNextKey(),BY=this.undoFGKey=this.model.getNextKey();Bb.addActions({act:"addUndoSection",cbKey:this.cbKey,nodeKey:Ba,fgKey:BY});var BZ=this;Bb.addCallbacks({failure:function BW(){delete BZ.undoSectionKey;}});}return this.undoSectionKey;}function An(BY,BX){var BW={dsid:BY.dsid,formula:BY.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BY.tokenStreamXML),name:BY.alias,afb:BY.afb,sfb:BY.sfb};if(BX){BW.Ids=["$GUID_135"];}return this.getAddDerivedMetricToDatasetAction(BW);}function L(BX){var BW="USE_DEFAULT_INDICATOR";BX=BX||{};BX.mptso=BX.mptso||{pru:true};BX.mptsim=BX.mptsim||{pru:true};BX.mptfms=BX.mptfms||"";return{MDXPassThrough:{SolveOrder:BX.mptso.pru?BW:BX.mptso.v,ScopeIsolationMode:BX.mptsim.pru?BW:BX.mptsim.v,FormatString:BX.mptfms}};}function AJ(BW,BX){return{act:"formatDerivedMetric",dsid:BW.dsid||"",mid:(BX||!BW.did)?"$GUID_135":BW.did,format:L(BW.mptf),};}function AM(BZ,Bc,BX,Bd,BW,BY){var Ba=[this.getNodeKeyFromKeyContext(Bc)];if(!BY){Ba=Ar(Bd).concat(Ba);}var Bb={act:BZ,keyContext:Bc,tgtKey:BX,partialRetrieval:{nodes:Ba}};if(!BW){Bb.partialUpdate={selectors:[At(Bc)]};}return Bb;}function m(BY){var Ba=false;if(BY===1||BY===2){var BX=this.model,BW=BX.controller,Bb=BW.getRequiredZoomFactor&&BW.getRequiredZoomFactor(BY),BZ=BX.getZoomFactor();if(isNaN(Bb)||parseInt(Math.abs((Bb-BZ)*100),10)<=2){Ba=false;}else{Ba=true;}}return Ba;}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService,mstrmojo._ImageHelper],{scriptClass:"mstrmojo.DocDataService",defaultStyle:{params:{treesToRender:2}},cmdMgr:null,stid:-1,blockRequests:false,clientAuto:false,init:function Ak(BW){this._super(BW);this.cmdMgr=this.model.controller&&this.model.controller.cmdMgr;},wrapCallback:function Ad(Bb,BY,BX){var BZ=this;return y.wrapMethods({success:function Ba(Bc){if(Bc){BZ.model.bs=BZ.rwb=Bc.bs||BZ.rwb;BZ.msgId=Bc.mid||BZ.msgId;BZ.cbKey=Bc.cbKey||BZ.cbKey;if(Bc.stid!==undefined&&!BX){BZ.stid=Bc.stid;}if(Bc.clientAuto!==undefined){BZ.clientAuto=Bc.clientAuto;}if(mstrApp.parseSecondaryDataProviders){mstrApp.parseSecondaryDataProviders(Bc);}}BZ.clearTxUpdates(BY);},failure:function BW(){BZ.resetTxUpdates(BY);}},Bb);},getNodeKeyFromKeyContext:function Z(BW){return BW.split("\u001E")[1];},refresh:function A1(BY,BZ){var BX=!!BY.useRefreshProgress,BW=BX?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:AN;delete BY.useRefreshProgress;BY=Au.call(this,BY);Ao.call(this,B(BY,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false,displayNoResErr:true,compress:1}),BZ,{showProgress:true,hideProgress:true,progressStateText:BW,useRefreshProgress:BX});},saveRW:function A5(BW,BX){Ao.call(this,B(BW,{taskId:"saveRW",msgID:this.msgId}),BX);},saveThresholds:function i(BX,BY,BW){Ao.call(this,B(BX,{taskId:"saveThresholds"}),BY,BW);},getThresholds:function BJ(BX,BY,BW){Ao.call(this,B(BX,{taskId:"getThresholds"}),BY,BW);},browseElements:function AI(BX,BY,BW){Ao.call(this,B(BX,{taskId:"browseElements",styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30}),BY,BW);},removeUnit:function Y(BX,BY){var BW=B(BX,{act:"removeUnit"});this.submitTemplateUpdates(BW.nodeKey,BW,BY);},removeLayout:function AR(BX,BW,BY){this.submitUpdates({act:"removeLayout",unitKey:BX,isCurrent:BW},BY);},moveLayout:function w(BY,BW,BX){this.submitUpdates(this.getMoveNodeAction(BY,BW,BX),mstrmojo.DocDataService.EMPTY_CALLBACK,mstrmojo.DocDataService.SUPPRESS_DATA);},getMacroCopyNodeAction:function Ap(BX,BW,BZ){var BY={act:"macroCopyUnit",newKey:BZ,partialRetrieval:this.newRetrievalKeysConfig().addNode(BZ)};N(BY,BX,BW);return BY;},getMacroMoveNodeAction:function AD(BX,BW){var BY={act:"macroMoveUnit",partialRetrieval:this.newRetrievalKeysConfig().addNode(BX.k)};N(BY,BX,BW);return BY;},getMoveNodeAction:function q(Ba,BW,BX,Bb){var BZ=Ba.defn,BY=BZ?BZ.t:mstrmojo.EnumRWUnitType.LAYOUT;return this.getMoveNodeActionUsingKey(Ba.k,BY,BW,BX,Bb);},getMoveNodeActionUsingKey:function A8(Ba,BY,BW,BX,Bb){var BZ=C(BW,BY,Bb);BZ.unitKey=Ba;if(BX!==undefined){BZ.index=BX;}return BZ;},getMoveControlAction:function d(BZ,BX,BW){var BY=C(BX,mstrmojo.EnumRWUnitType.SELECTOR);BY.keyContext=BZ;if(BW){BY.partialRetrieval={nodes:Ar(BW)};}return BY;},addMoveControlAction:function I(BZ,BY,BX,BW){BZ.addActions(this.getMoveControlAction(BY,M.call(this,BX,BZ),BW));},getSetCtrlSourceAction:function AK(BX,BZ,BW,BY){return{act:"setControlSource",keyContext:BX,unitId:BZ,unitType:BW,removeCGB:BY||[],partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BX)),partialUpdate:{selectors:[At(BX)]}};},getRemoveCtrlTargetAction:function G(BY,BX,BZ,BW){return AM.call(this,"removeControlTarget",BY,BX,BZ,BW);},getClearCtrlTargetAction:function BF(BW){return{act:"clearControlTarget",keyContext:BW};},getAddCtrlTargetAction:function Az(Ba,BX,Bb,Bc,BW,BY){var BZ=AM.call(this,"addControlTarget",Ba,BX,Bb,BW,BY);BZ.isUC=!Bc;return BZ;},getAddCtrlTargetDatasetAction:function BC(BX,BW){return{act:"addControlTargetDataset",keyContext:BX,tgtDid:BW};},getRemoveCtrlTargetDatasetAction:function h(BX,BW){return{act:"removeControlTargetDataset",keyContext:BX,tgtDid:BW};},getClearCtrlTargetDatasetAction:function AQ(BW){return{act:"clearControlTargetDataset",keyContext:BW};},getChangeControlElementSource:function BQ(BX,BW){return{act:"changeControlElementSource",keyContext:BX,ctlElementSrc:BW};},getSetAttributesJoinTypeAction:function Ah(BW,BX){return{act:"setAttributesJoinType",nodeKey:BW,value:BX,partialRetrieval:this.newRetrievalKeysConfig().addNode(BW)};},getSetMetricJoinTypeAction:function AZ(BY,Ba,BW,BX,BZ){return{act:"setMetricJoinType",nodeKey:BY,unitId:Ba,dataType:BW,unitType:BX,value:BZ,partialRetrieval:this.newRetrievalKeysConfig().addNode(BY)};},getTxUpdates:function AW(BX){var BW=this.model;return BW&&BW.getTransactionUpdates&&BW.getTransactionUpdates(BX);},clearTxUpdates:function Al(BX){var BW=this.model;if(BW&&BW.clearTransactionUpdates){BW.clearTransactionUpdates(BX);}},resetTxUpdates:function D(BX){var BW=this.model;if(BW&&BW.resetTransactionUpdates){BW.resetTransactionUpdates(BX);}},loadDocLayout:function K(Ba,Bc,Bb){var BZ={act:"setCurrentLayout",unitKey:Ba.layoutKey,disablePU:true,panelUnitKey:Ba.panelKey},BY={style:{params:{treesToRender:3}}},BW=this.model,BX=!!Bb;if(!Bb){Bb=BW.getDataService().newUpdateWithoutCmd();}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){BW.applyBufferedSelections(Bb);}Bb.add(BZ,Bc,BY);if(!BX){this.submitUpdates(BZ,Bc,BY);}},checkMissingCredentials:function z(BW,BX){Ao.call(this,B(BW,{taskId:"checkMissingCredentials"}),BX);},setCurrentDocLayout:function Aw(BY,Bc,Bb){var Ba={act:"setCurrentLayout",unitKey:BY},BZ={config:{silent:(Bc===null)&&(!!Bb&&Object.keys(Bb.callback||{}).length===0)}},BW=this.model,BX=!!Bb;Bc=Bc||null;if(!Bb){Bb=BW.getDataService().newUpdateWithoutCmd();}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){BW.applyBufferedSelections(Bb);}Bb.add(Ba,Bc,BZ);if(!BX){Bb.submit();}if(window.mstrMobileApp!==undefined){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function BG(BW,BX){Ao.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:BW},BX);},requestPanelChangeDeferred:function BP(Bc,Bb,BW,BX,BZ,Ba){var BY={act:"setCurrentPanel",unitKey:Bb};if(BW){BY.partialRetrieval={nodes:BW.split(",")};}Bc.add(BY,Ba,{config:{showProgress:BZ,hideProgress:BZ,progressStateText:AN},style:{params:{treesToRender:BX?3:0}}});},getGraphSelectionAction:function E(Bb,BW,BY,Bf,Be,BX,Bg,Ba){var Bc=this.model.getCurrentLayoutDef(),Bh=(Bc&&Bc.dzf)||1,Bd=!mstrApp.optimizeFitToPage||mstrApp.optimizeFitToPage===2,BZ={act:"graphSelector",nodeKey:Bb,sliceID:BY,x:Bd?Math.round(Bf/Bh):Bf,y:Bd?Math.round(Be/Bh):Be};if(BX){BZ.usePartialUpdate="0";}else{BZ.partialUpdate={selectors:BW.split("\u001E")};}if(Bg&&Ba){BZ.w=Bg;BZ.h=Ba;}return BZ;},getSelectorElementsAction:function s(BY){var BX={act:"setSelectorElements",keyContext:BY.ck,ctlKey:BY.ctlKey,elemList:mstrmojo.string.decodeHtmlString(BY.eid),isVisualization:!!BY.isDocVis},BW=BY.include;if(BW!==undefined){BX.include=!!BW;}if(BY.tks){BX.tks=BY.tks;}if(BY.disablePU){BX.usePartialUpdate="0";}else{if(BY.ignoreTargetData){BX.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BY.ck));}else{BX.partialUpdate={selectors:BY.ctlKey.split("\u001F")};}}return BX;},getUpdateTransactionAction:function BU(BX){var BW={act:"updateTransaction"};if(BX){if(BX.ctlKey){BW.partialUpdate={selectors:[BX.ctlKey]};}}return BW;},getSelectorFromGMAction:function n(BX){var BW={act:"setSelectorFromGM",keyContext:BX.ck,ctlKey:BX.ctlKey,keepOnly:!!BX.keepOnly,selectorObjects:BX.selectorObjects,isVisualization:!!BX.isDocVis,include:!!BX.include};if(BX.tks){BW.tks=BX.tks;}if(BX.disablePU){BW.usePartialUpdate="0";}else{BW.partialUpdate={selectors:[BX.ctlKey]};}return BW;},getGMViewFilterAction:function AH(BX){var BW={act:"keepOnlyGM",selectorObjects:BX.selectorObjects,isVisualization:!!BX.isDocVis,keepOnly:!!BX.keepOnly};if(BX.tks){BW.tks=BX.tks;}if(BX.disablePU){BW.usePartialUpdate="0";}else{BW.partialUpdate={selectors:[BX.ctlKey]};}return BW;},browseControlElements:function BK(Ba,Bj,BX){var BZ=Ba.searchPattern,Bg=Ba.attributeId,Bc=this.model;if(!BZ||BZ===""){return ;}var Bd={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:Bg,expressionXML:Ba.expressionXML||"",dataSourcesXML:Ba.dataSourcesXML||"",blockBegin:Ba.blockBegin,blockCount:Ba.blockCount,searchPattern:BZ,rawInput:BZ,browseFlags:Ba.browseFlags||0,otp:Ba.objectType};if(Ba.datasetId){B({datasetID:Ba.datasetId,messageID:Bc.mid,ctlKey:Ba.controlKey},Bd);}var Bi=Ba.searchForms;if(Bi){var BY="",Bb="";V.forEach(Bi,function(Bk){BY+=Bb+Bk.did;Bb=";";});Bd.searchForms=BY;if(Bc.isnew||Ba.useClientForm){var BW="",Bf="",Be=V.filterOne(Bc.getDatasetUnits(["att"]),function(Bk){return Bk.did===Bg;}),Bh=Be.fs||[];V.forEach(Bi,function(Bk){var Bl=V.filterOne(Bh,function(Bm){return Bm.fid===Bk.did;});BW+=Bf+Bk.did+":"+(Bl&&Bl.bftp||0);Bf=";";});Bd.clientFormPatterns=BW;}}Ao.call(this,Bd,Bj,BX);},setMultiDocSelectorElements:function AF(BW,BX,BZ){var BY={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:BX,selectorObjects:BW};Ao.call(this,BY,BZ,{showWait:true,hideWait:true,delay:true});},setDocSelectorTexts:function U(Bb,Bd,Bf,Bc,Be,BX,BW,BY,Ba){var BZ={taskId:"setDocSelectorTexts",rwb:this.rwb,unitKeyContext:Bb,ctlTexts:Bd,ctlKey:Bf,zoomFactor:BX};if(AX.isAndroid||BW){BZ.taskId="androidSetDocSelectorElements";}if(Bc!==null&&Bc!==undefined){BZ.include=Bc;}if(BY!==null&&BY!==undefined){BZ.usePartDisplay=BY;}if(Ba!==null&&Ba!==undefined){BZ.treesToRender=Ba;}Ao.call(this,BZ,Be);},getSelectorExpressionAction:function t(BY){var BX={act:"setSelectorExpression",keyContext:BY.ck,ctlType:BY.type,objId:BY.srcid,objType:BY.srct,expFunction:BY.f,expFunctionType:BY.ft,include:!!BY.include,qt:BY.qt,unset:!!BY.unset};if(BY.disablePU){BX.usePartialUpdate="0";}else{BX.partialUpdate={selectors:[BY.ckey]};if(BY.retrieveCtrlKey){BX.partialRetrieval=this.newRetrievalKeysConfig().addNode(BY.ctlKey);}}if(BY.changeQual){BX.changeQual=BY.changeQual;}var BW=BY.cs;if(BW!==null&&BW!==undefined){BX.expConstants=BW;BX.dataType=BY.dtp;}if(BY.fid){BX.fid=BY.fid;}return BX;},getAttributeSelectorExpressionAction:function Ay(BX){var BW={act:"setAttributeSelectorExpression",keyContext:BX.ck,ctlKey:BX.ctlKey,ctlType:BX.type,expr:BX.expr,partialUpdate:{selectors:[BX.ctlKey]}};if(BX.tks){BW.tks=BX.tks;}return BW;},getMultiUnitSelectorAction:function BN(BW){return{act:"multiUnitSelection",keyContext:BW.ck,include:BW.include!==false,sels:BW.selections,isBranch:BW.isBranch,partialUpdate:{selectors:[BW.ctlKey]}};},getRemoveCtrlAction:function Aq(BX,BW){return{act:"removeControl",key:BX,partialUpdate:{selectors:[BX]},partialRetrieval:{nodes:Ar(BW)}};},getAddCtrlAction:function Ag(Bd,Bb,BX,Bc,BY,Be,BW,BZ,Bf){if(isNaN(Bf)){Bf=1;}var Ba={act:"addControl",parentKey:Bd,nodeKey:Bb,ctlKey:BX,isUC:!!BY,unitType:Be||-1,unitId:BW||"",targetKeys:Ar(BZ),ctlType:Bf,gpType:Bf,partialRetrieval:{nodes:Ar(Bc)}};if(!Ba.isUC){Ba.partialUpdate={selectors:[BX]};}return Ba;},getReplaceCtrlAction:function S(BY,Bb,BW,Ba,BX,BZ){return{act:"replaceControl",nodeKey:this.getNodeKeyFromKeyContext(BY),ctlKey:Bb,ctlType:BW,unitId:Ba,unitType:BX,partialUpdate:{selectors:[Bb]},partialRetrieval:{nodes:Ar(BZ)}};},getUseAlternateFilterTechniqueAction:function BL(BY,Ba,BX,BZ,BW){return{act:"useAlternateFilterTechnique",nodeKey:this.getNodeKeyFromKeyContext(BY),ctlKey:Ba,ctlType:BX,pdf:BW?1:0,partialUpdate:{selectors:[Ba]},partialRetrieval:{nodes:Ar(BZ)}};},getSaveGraphPropertiesAction:function l(BW,BX){return{act:"saveGraphProperties",nodeKey:BW,properties:BX};},getSelectorIncludeAction:function A7(BX){var BW=BX.ckey;return{act:"setSelectorInclude",keyContext:BX.ck,ctlKey:BW,ctlType:BX.type,include:BX.include,partialUpdate:{selectors:[BW]}};},getSelectorShowAllAction:function Q(BW){return{act:"setSelectorShowAll",keyContext:BW.ck,ctlKey:BW.ckey,ctlType:BW.type,showAll:BW.showAll,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BW.ck))};},getUnsetSelectorAction:function g(BZ){var BY=BZ.ckey,BW=BZ.ck,BX={act:"unsetSelector",keyContext:BW,ctlKey:BY,ctlType:BZ.type};if(BZ.ignoreTargetData){BX.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BW));}else{BX.partialUpdate={selectors:[BY]};}if(BZ.retrieveCtrlKey){BX.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BW));BX.partialRetrieval=BX.partialRetrieval.addNode(BY);}return BX;},getRASelectorExpandAction:function p(BX){var BW=BX.ckey;return{act:"raSelectorExpandCollapse",keyContext:BX.ck,ctlKey:BW,ctlType:BX.type,elementId:BX.elementId,isExpand:BX.isExpand,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BX.ck))};},getChangeFilteringAction:function A3(BW,BZ,BY,BX){return{act:"changeFiltering",nodeKey:BW,filterMode:BZ,isUC:BY,partialRetrieval:{nodes:(BX?Ar(BX):[])}};},getAddDerivedMetricToDatasetAction:function BB(BW){return{act:"addDerivedMetricToDataset",dsid:BW.dsid,formula:BW.formula,isTokenStream:BW.isTokenStream,name:BW.name,newObjectIds:BW.Ids,afb:BW.afb,sfb:BW.sfb};},getSetMDXPassThroughOptionsForCMAction:function A(BW){var BX={act:"formatDerivedElement",format:L(BW.mptf)};if(BW.cid){BX.cid=BW.cid;}if(BW.ceid){BX.ceid=BW.ceid;}return BX;},getEditDocUnitPropAction:function AC(BW){return{act:"editDocUnitProp",dsid:BW.dsid,formId:BW.formId,unitId:BW.unitId,unitType:BW.unitType,prop:BW.prop,value:BW.value};},getRWGraphImage:function BT(Ba,Be){if(mstrApp.isExpress&&!mstrApp.optimizeFitToPage&&m.call(this,this.model.zt)){return ;}var BZ=mstrApp,BW=this.id,BX={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:Ba.k,sliceID:parseInt(Ba.sid,10),width:parseInt(Ba.w,10),height:parseInt(Ba.h,10)};if(Ba.needCoordinate){BX.needCoordinate=1;}if(BZ.onMobileDevice()&&BZ.useBinaryFormat){window.setTimeout(function(){Ao.call(mstrmojo.all[BW],BX,Be,X());},0);}else{if(Ba.encodeImage){BX.taskContentEncoding="base64";delete BX.taskEnv;Ao.call(this,BX,{success:function Bf(Bg){Be.success(Bg);},failure:function BY(Bg){(Be.failure||BZ.onerror)(Bg);}},X());}else{var Bc=BZ.getConfiguration(),Bb=BZ.getCurrentProjectId(),Bd=new mstrmojo.StringBuffer();BX.__ts__=new Date().getTime();BX.sessionState=BZ.getSessionState(Bb);e.forEach(BX,function(Bg,Bh){Bd.append(Bh+"="+encodeURIComponent(Bg));});Be.success(Bc.getTaskUrlByProject(Bb)+"?"+Bd.toString("&"));}}},getImage:function BS(BX){var BY=mstrApp,BW=BY.getConfiguration();if(BW&&BX&&BX.indexOf("://")===-1){BX=BW.getHostUrlByProject(BY.getCurrentProjectId())+BX;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(BX)):BX;},setGridDisplayMode:function u(BY,BX,BZ,BW){e.copy(mstrmojo.DocDataService.RAPID_EXEC,BW);this.submitUpdates({act:"setGridDisplayMode",unitKey:BY,displayMode:BX},BZ,BW);},setDocZoom:function H(BW,BX){this.submitUpdates(B(BW,{act:"setDocZoom",disablePU:true}),BX,{style:{params:{treesToRender:3}}});},sortGrid:function AO(BW,BX){this.submitTemplateUpdates(BW.nodeKey,B({act:"sort"},BW),BX);},getAdvSortData:function Aj(BW,BX){this.rwExecute(B(BW,{styleName:"RWGridStyle"}),BX);},getFilterExpression:function AT(BY,BX){var BZ=BY&&BY.expr,BW=this.model;if(BZ&&BW&&BW.getVfexprWithUpdatedVf){BZ=BW.getVfexprWithUpdatedVf(BX,BZ);}return AE(BZ);},saveViewFilter:function Ax(Bb,Bc){var Ba=this.msgId,BW=Bb&&Bb.nodeKeys,BZ=this,BY=V.map(BW,function(Bd){return{act:"saveViewFilter",messageID:Ba,nodeKey:Bd,expr:BZ.getFilterExpression(Bb.filterModel,Bd),partialUpdate:{nodes:[Bd]}};}),BX=V.map(BW,function(Bd){return{act:"saveViewFilterLimit",messageID:Ba,nodeKey:Bd,limitExp:Bb.limitExp,limitToRemove:Bb.limitMdxToRemove||[]};});this.submitUpdates(BY.concat(BX),Bc);},getViewFilter:function AP(BX,BY){var BW=this.model;if(BW.getViewFilter){BW.getViewFilter(BX,BY);}else{Ao.call(this,{taskId:BX.taskId,rwb:BX.rwb,msgID:BX.msgID,nodeKey:BX.nodeKey},BY);}},createEmbeddedFilter:function As(BY,Bb){var BW=BY.filterId,BZ=BY.expJson,Ba={act:"createEmbeddedFilter",messageID:this.msgId,expr:BY.expr,filterId:BW,filterName:BY.filterName};var BX=this.model;y.wrapMethods({success:function(){var Bc=BX.defn.efs||[];Bc.push({did:BW,exp:BZ});BX.defn.efs=Bc;}},Bb);this.submitUpdates([Ba],Bb,{style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.NONE}},params:{suppressData:true}});},rwExecute:function BI(BW,BX){Ao.call(this,B(BW,{taskId:"RWExecute",rwb:this.rwb,messageID:this.msgId}),BX);},pivot:function o(BW,BX){this.submitTemplateUpdates(BW.nodeKey,{act:"pivot",unitId:BW.unitId,unitType:BW.unitType,attFormId:BW.attFormId,axis:BW.axis,unitPos:BW.unitPos},BX);},resizeXtabColumn:function BE(BW,BX){this.submitUpdates([this.getUpdateTemplateAction(BW.nodeKey,BW),{act:"format",unitType:52,unitKey:BW.nodeKey,formatType:1,format:{FormattingSize:{WidthMode:2}}}],BX);},showTotals:function W(BW,BX){this.submitTemplateUpdates(BW.nodeKey,{act:"showTotals",unitId:BW.unitId,unitType:BW.unitType,subtotalType:BW.subtotalType,clearSubtotalType:BW.clearSubtotalType},BX);},drillGrid:function AL(BW,BX){this.submitUpdates(this.getDrillGridAction(BW),BX,{config:{showProgress:true,hideProgress:true,progressStateText:AN,delay:true}});},getDrillGridAction:function BM(BX){var BW={act:"gridDrillWithin",messageID:this.msgId,nodeKey:BX.nodeKey,sliceId:BX.sliceId,drillPathIndex:BX.drillPathIndex,drillPathKey:BX.drillPathKey,elementList:BX.drillElements,retainParent:BX.retainParent,partialUpdate:{nodes:Ar(BX.updateNodeKey||BX.nodeKey)}};if(BX.x){BW.x=BX.x;BW.y=BX.y;BW.graphHeight=BX.graphHeight;BW.graphWidth=BX.graphWidth;}return BW;},changeDocGroupBy:function O(BY,BZ,BW){var BX={act:"changeDocGroupBy",disablePU:true};if(BY.flags){BX.flags=BY.flags;}if(BY.groupbyKey){BX.gbKey=BY.groupbyKey;BX.elemId=BY.elementId;}else{BX.gbUnits=BY.gbUnits;}this.submitUpdates(BX,BZ,{config:BW,style:{params:{treesToRender:3}}});},setOutlineExpanding:function A4(BY,BZ,BW){var BX={act:"updateTemplate",keyContext:BY.unitKey,actions:[{act:"setOutlineExpanding",prs:"Template Formatting",pr:"OutlineLevelExpanding",v:BY.outlineLevel}]};this.submitUpdates(BX,BZ,e.copy(mstrmojo.DocDataService.RAPID_EXEC,{config:{silent:true},style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.BOTH}}}));},retrieveServerJson:function f(BY,Bi,BZ){if(mstrApp.isExpress&&!mstrApp.optimizeFitToPage&&m.call(this,this.model.zt)){return ;}var Bb=this.model,Bc=Bb.controller,Bg={},BW,BX,Be;var Bf=BY.nodes;if(Bf){Bg.partialRetrieval=Bf;}var Bh=BY.slices;if(Bh){Bg.slices=Bh;}if(BZ){BW=BZ.style;BX=BZ.config;Be=BZ.params;}if(!BX){BX={showProgress:true,hideProgress:true,progressStateText:AN};}var Bj=BY.style=e.clone(this.defaultStyle),Bd=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();B(BW.params,Bj.params);var Ba={taskId:"getServerJSONResults",styleName:"ServerJsonRWDStyle",compress:1,rwb:this.rwb,messageID:this.msgId,stateID:-1,excludeData:!!(Bd||mstrConfig.resolveOnly),params:JSON.stringify(Bg),treesToRender:Bj.params.treesToRender};B(Be,Ba);BX.preserveUndo=(BZ&&BZ.preserveUndo)||false;Ao.call(this,Ba,Bi,BX);},downloadGridData:function J(BZ,Ba){var BY={act:"gridIncrementalFetch",nodeKey:BZ.nodeKey,rowPosition:BZ.rowPosition,maxRows:BZ.maxRows,colPosition:BZ.colPosition,sliceId:BZ.sliceId,maxColumns:BZ.maxColumns,rowMode:BZ.rowMode||1,partialRetrieval:this.newRetrievalKeysConfig().addNode(BZ.nodeKey)};if(BZ.partialUpdate){BY.partialUpdate=BZ.partialUpdate;}var BX=mstrmojo.all[BZ.xtabId],BW=BX&&BX.isCustomSort;this.submitUpdates(BY,Ba,e.copy(X(),{noUpdate:true,preserveStid:BW,config:{silent:true}}));},txMarkRows:function AV(BW,BX){if(mstrApp&&mstrApp.isNativeAndroid){mstrMobileTransport.applyTransactionMarkRow(BW.nodeKey,BW.sliceId,BW.rowOrdinal,BW.actionType);}else{Ao.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:BW.nodeKey,sliceId:BW.sliceId,rowOrdinal:BW.rowOrdinal,actionType:BW.actionType},BX);}},txChangeData:function x(BW,BX){if(mstrApp&&mstrApp.isNativeAndroid){mstrMobileTransport.applyTransactionDataChange(BW.nodeKey,BW.sliceId,JSON.stringify(BW.cells),BW.autoRefresh);}else{Ao.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:BW.nodeKey,sliceId:BW.sliceId,cells:BW.cells,autoRefresh:BW.autoRefresh},BX);}},sendTransactionActions:function c(BX,BY){var BW={taskId:"DocTransaction",rwb:this.rwb,keyContext:BX.keyContext,actions:BX.actions,messageID:this.msgId};if(BX.txrcd){BW.isPending=BX.txrcd.pending;BW.timestamp=BX.txrcd.timestamp;}Ao.call(this,BW,BY,{silent:!!BY});},newUpdate:function BA(BY,BX){var BW=new mstrmojo.DocDataService.Update(BX);BW.ds=this;BW.cmd=BY;return BW;},newUpdateWithoutCmd:function k(BX){var BW=new mstrmojo.DocDataService.Update(BX);BW.ds=this;return BW;},newRetrievalKeysConfig:function Af(){return new mstrmojo.rw.model.RetrievalKeysConfig();},newUpdateKeysConfig:function R(){return new mstrmojo.rw.model.UpdateKeysConfig();},submitCmd:function BH(BX,BW){this.newUpdate(BX,BW).submit();},submitUpdates:function Ai(Bf,Bl,Bc){Bf=Ar(Bf);this.cleanFormatLayoutXML(Bf);var Bb={actions:Bf},BW,BZ,Bi,BY=false;V.forEach(Bf,function Be(Bn){if(Bn.disablePU){BY=true;delete Bn.disablePU;}V.forEach(Bn.actions,Be);return !BY;});if(!BY){var BX=mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig(Bf),Bk=mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig(Bf);if(!e.isEmpty(BX)){Bb.partialRetrieval=BX;}if(!e.isEmpty(Bk)){Bb.partialUpdate=Bk;}}if(Bc){BW=Bc.style;BZ=Bc.config;Bi=Bc.params;}if(!BZ){BZ={showProgress:true,hideProgress:true,progressStateText:AN};}if(!BW){Bb.style=this.defaultStyle;}else{var Bm=Bb.style=e.clone(this.defaultStyle);B(BW.params,Bm.params);}Bb.style.name=(BW&&BW.name)||mstrApp.styleName;var Bd={taskId:"mojoRWManipulation",rwb:this.rwb,messageID:this.msgId,stateID:-1,params:JSON.stringify(Bb)};Bi=(mstrApp.isExpress&&(this.model.zt==1||this.model.zt==2))?Au.call(this):Bi;B(Bi,Bd);BZ.preserveUndo=(Bc&&Bc.noUpdate)||false;BZ.preserveStid=(Bc&&Bc.preserveStid)||false;var Bh=this,Bj=true,Ba=y.override({success:function(Bn,Bo){if(Bn.status===2){Bj=false;Bh.submitUpdates([],Bl,Bc);}else{Bj=true;return this._super(Bn,Bo);}},complete:function(){if(this._super&&Bj){this._super();}}},B(Bl));if(!(Bc&&Bc.hideCancel)){BZ.waitBoxCfg=e.copy({showCancel:true},BZ.waitBoxCfg);}if(Bc&&Bc.message){BZ.waitBoxCfg=e.copy({message:Bc.message},BZ.waitBoxCfg);}var Bg=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();if(Bc&&Bc.resolveOnly!==undefined){Bd.resolveOnly=Bc.resolveOnly;}else{if(Bg){Bd.resolveOnly=true;}}if(Bc&&Bc.excludeData!==undefined){Bd.excludeData=Bc.excludeData;}else{if(Bg){Bd.excludeData=true;}}if(Bc&&Bc.noDeltaXML!==undefined){Bd.noDeltaXML=Bc.noDeltaXML;}if(Bd.resolveOnly&&Bd.excludeData){mstrApp.enableUpdate=true;}Ao.call(this,Bd,Ba,BZ);},submitTemplateUpdates:function AA(BW,BY,BZ,BX){this.submitUpdates(this.getUpdateTemplateAction(BW,BY),BZ,BX);},getUpdateTemplateAction:function Ac(BW,BY,BX){return{act:"updateTemplate",keyContext:BW,partialRetrieval:this.newRetrievalKeysConfig().addNode(BW,BX),partialUpdate:{selectors:BY.selectors},actions:Ar(BY)};},addUpdateTemplateAction:function BO(BY,BW,BX){BY.addActions(this.getUpdateTemplateAction(BW,BX));},applySegment:function AS(BX,BW,BY){Ao.call(this,{taskId:"applySegment",rwb:this.rwb,segmentID:BX,nodeKey:BW},BY);},getPageByTree:function AU(BW){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},BW);},getUserDICubeInfo:function a(BW,BX){Ao.call(this,{taskId:"getUserDICubeInfo",cubeIds:BW.join(",")},BX);},applySorts:function A9(BX,BY,BW,BZ){Ao.call(this,{taskId:"applySorts",key:BX,sortType:BY,sortList:BW},BZ,mstrmojo.DocDataService.PROGRESS_CONFIG);},getAddNewDerivedMetricToDatasetSubmitFunc:function A6(BX){var BW=this;return function(Ba){var Bb=BW.model,BZ=Bb.controller,BY=e.copy(Ba,BX),Bc=[An.call(BW,BY,true)],Bd=Bb.getDatasetsUpdateCallback();if((BY.mptf||{}).dirty||this.enablePTO){Bc.push(AJ(BY));}BZ.submitUndoRedoUpdates(Bc,null,Bd,{style:{params:{treesToRender:1}}});};},getAddNewDerivedMetricToXtabSubmitFunc:function Av(BX){var BW=this;return function(Bb){var Bc=BW.model,Ba=Bc.controller,BZ=e.copy(Bb,BX),BY=BZ.idx,Be=[],Bf=y.wrapMethods(Bc.getDatasetsUpdateCallback(),Ba._getXtabCallback(BZ.host));Be.push(An.call(BW,BZ,true));if((BZ.mptf||{}).dirty||this.enablePTO){Be.push(AJ(BZ,true));}if(BZ.replace){Be.push(BW.getUpdateTemplateAction(BZ.nodeKey,[BZ.host.model.getRemoveTemplateUnitAction({did:BZ.replace.did,t:BZ.replace.t})]));}else{BY++;}var Bd=BW.getUpdateTemplateAction(BZ.nodeKey,[BZ.host.model.getAddTemplateUnitAction({did:"$GUID_135",t:4},BZ.dsid,BZ.zoneid,BY)]);Be.push(Bd);Ba.submitUndoRedoUpdates(Be,null,Bf);};},getAddNewDerivedMetricToDropzoneSubmitFunc:function AG(BX){var BW=this;return function(Bd){var Be=BW.model,Bf=Be.controller,Bh=e.copy(Bd,BX),Bj=Bh.host.zonesModel,Bk=Bh.idx,Bc=[],BY=[],Bi={id:Bh.zoneid},Bg={did:"$GUID_135",t:4},Bl=y.wrapMethods(Be.getDatasetsUpdateCallback(),Bf._getXtabCallback(Bh.host));Bc.push(An.call(BW,Bh,true));if((Bh.mptf||{}).dirty||this.enablePTO){Bc.push(AJ(Bh));}if(Bh.replace){var Ba={did:Bh.replace.did,t:Bh.replace.t};Array.prototype.push.apply(BY,Bj.getRemoveDropZoneUnitActions(Bi,Ba));}else{Bk++;}BY.push(Bj.getAddDropZoneUnitAction(Bi,Bg,Bk,{datasetId:Bh.dsid}));if(Bh.extraZone){BY.push(Bj.getAddDropZoneUnitAction({id:Bh.extraZone.id},Bg,Bh.extraZone.idx,{datasetId:Bh.dsid}));}if(!Bh.replace){var BZ=(BX.zoneid===4)?1:2,Bb=Bj.getAddMetricNameAction(BX.host,BZ);if(Bb){Bc.push(Bb);}}if(!Bh.replace&&Bj.gmZones){Bb=Bj.gmZones.getUpdateGroupInfoActionForNewMetric(BX.zoneid,Bk,true);if(Bb){Bc.push(Bb);}}Bj.checkAndAddThresholdAction(Bh.zoneid,Bg,BY);Bc.push(BW.getUpdateTemplateAction(Bh.nodeKey,BY));Bf.submitUndoRedoUpdates(Bc,null,Bl);};},getEditDerivedMetricSubmitFunc:function j(BX){var BW=this;return function(Ba){var Bc=BW.model,BZ=Bc.controller,BY=e.copy(Ba,BX),Bb=BX.nodeKey,Bd={act:"editDM",formula:BY.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BY.tokenStreamXML),afb:BX.afb,sfb:BX.sfb,dsid:BY.dsid||"",did:BY.did},Be=[Bc.addUpdateObjects(Bd,{id:BY.did,type:4,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE})],Bf=y.wrapMethods(Bc.getDatasetsUpdateCallback(),BZ.getPartialUpdateCallback());if(mstrApp.isSingleTier&&BX.originTokenStream){Bd.originFormula=BX.originTokenStream;Bd.originAfb=BX.originAfb;Bd.originSfb=BX.originSfb;}if((BY.mptf||{}).dirty){Be.push(AJ(BY));}if(Bb){Be.push(BW.getUpdateTemplateAction(Bb,[{act:"renameUnit",id:BY.did,type:4,name:BY.alias,isDynamicAlias:false}]));}else{Bd.name=BY.alias;}BZ.submitUndoRedoUpdates(Be,null,Bf,{style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.BOTH}}});};},resetSelections:function BD(BX,BW,BY){Ao.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:BX||"",usePartDisplay:BW?"0":"1",treesToRender:BW?3:2},BY);},setPreference:function F(BW,BX){Ao.call(this,{taskId:"setPreference",prefs:BW},BX);},getObjectInfo:function Aa(BW,BX){Ao.call(this,B(BW,{taskId:"getObjectInfo"}),BX,X());},addSuppressData:function A0(BW){if(BR(BW)===mstrmojo.DocDataService.EnumTreesToRender.NONE){e.copy({params:{suppressData:true}},BW);}},uploadImageToServer:function(BY,BZ){var BX={taskId:"importImage",imageFieldName:"imageData",isEdit:1,fieldKey:BY.fieldKey,fieldName:BY.fieldName,imageName:encodeURIComponent(BY.imageName),imageSize:BY.imageSize,nodeKey:BY.nodeKey,sectionKey:BY.sectionKey,msgID:this.msgId||""};if(mstrApp.isSingleTier){var BW=";base64,";BX.rwNodeKey=BY.fieldGroupKey;BX.imageData=BY.base64Str.split(BW)[1]||BY.base64Str;mstrApp.serverRequest(BX,BZ);}else{BX.imageData=BY.imageData;mstrmojo.xhr.upload("POST",mstrConfig.taskURL,BZ,BX);}},cleanFormatLayoutXML:function Am(BW){V.forEach(BW,function(BZ){if(BZ.act==="format"){var BY=e.walk("format.FormattingSize.LayoutXML",BZ),BX=function(Ba){V.forEach(Ba,function(Bb){BX(Bb.children||[]);BX(Bb.floatChildren||[]);delete Bb.id;});return Ba;};BX(BY&&BY.children||[]);BX(BY&&BY.floatChildren||[]);}});}});mstrmojo.DocDataService.Update=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DocDataService.Update",actions:null,callback:null,extras:null,init:function Ak(BW){B(BW,this);this.actions=this.actions||[];this.callback=this.callback||{};this.extras=this.extras||{};},addActions:function Ae(BW){this.actions=this.actions.concat(Ar(BW));},addCallbacks:function A2(BW){this.callback=y.wrapMethods(this.callback,BW);},addExtras:function AY(BX){var BW=BR(BX),BY=BR(this.extras);this.extras=B(BX,this.extras);if(BW!==undefined&&BY!==undefined){this.extras.style.params.treesToRender|=BY;}},addUpdate:function Ab(BW){this.add(BW.actions,BW.callback,BW.extras);},setTreesToRender:function BV(BW){if(BW){this.addExtras({style:{params:{treesToRender:BW}}});}return this.extras.style.params.treesToRender;},add:function b(BX,BY,BW){if(BX){this.addActions(BX);}if(BY){this.addCallbacks(BY);}if(BW){this.addExtras(BW);}},submit:function AB(){var BX=this.actions,BY=this.callback,BW=this.extras;if(this.cmd){this.cmd.submit(BX,BY,BW);}else{this.ds.submitUpdates(BX,BY,BW);}}});mstrmojo.DocDataService.PUInfoType=null;mstrmojo.DocDataService.ExtrasType=null;mstrmojo.DocDataService.PROGRESS_CONFIG={showProgress:true,hideProgress:true,progressStateText:AN,delay:true};mstrmojo.DocDataService.UNDO_KEY="undo";mstrmojo.DocDataService.REQUEST_DEFN_DATA={style:{params:{treesToRender:3}}};mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION={style:{params:{treesToRender:1}}};mstrmojo.DocDataService.REQUEST_ONLY_DATASETS={style:{params:{treesToRender:0}}};mstrmojo.DocDataService.SUPPRESS_DATA={params:{suppressData:true}};mstrmojo.DocDataService.RAPID_EXEC={params:{suppressData:true,rapidExec:true}};mstrmojo.DocDataService.EMPTY_CALLBACK={success:mstrmojo.emptyFn};mstrmojo.DocDataService.CopyMoveDestinationType=null;mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS={FORMAT_CHANGE:1,DATA_CHANGE:2};mstrmojo.DocDataService.EnumTreesToRender={NONE:0,DEFN:1,DATA:2,BOTH:3};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.func","mstrmojo.css","mstrmojo.UUID","mstrmojo.fe.FilterUtils","mstrmojo.desc");var Q=mstrmojo.func,L=mstrmojo.hash,J=mstrmojo.array,N=mstrmojo.expr,U=mstrmojo.css,R=N.DTP,F=mstrmojo.UUID,V=mstrmojo.fe.FilterUtils,U=mstrmojo.css;var H=16,E=32;function O(a,Z,c){var X=L.copyProps(["did","t","st","n"],a),Y=(a.fs||[]).filter(function(d){return d.fnm==="LEVEL_NUMBER"||d.n==="LEVEL_NUMBER";})[0],b;if(Z){b={et:N.ET.AE,fn:N.FN.DESCENDANT,a:X,es:[{v:Z.v,n:Z.n}]};if(parseInt(c,10)>=Z.lv){b.cs=[{v:c-Z.lv,dtp:R.INTEGER},{v:2,dtp:R.INTEGER}];}}else{if(parseInt(c,10)>=0&&Y){b={et:N.ET.AQ,fn:N.FN.EQUAL,a:X,fm:{did:Y.did||Y.fid,n:Y.n||Y.fnm,dtp:R.INTEGER},cs:[{v:c,dtp:R.INTEGER}]};}}return b?V.getExprXml(b):"";}mstrmojo.ui._IsIncFetchHierarchyList=mstrmojo.provide("mstrmojo.ui._IsIncFetchHierarchyList",{_mixinName:"mstrmojo.ui._IsIncFetchHierarchyList",blockCount:500,getDataHelper:mstrmojo.emptyFn,getAttribute:mstrmojo.emptyFn,isHiearachyDisplay:mstrmojo.emptyFn,getItemMarkup:function C(Z,X){var Y;if(Z.fetcher){Y='<{@tag} class="item fetcher {@cls}" idx="{@idx}" style="{@style}"><span class="indent" style="padding-left: {@indent}px;"></span><span class="text">{@en@n}</span></{@tag}>';}else{Y=this._super(Z,X);}return Y;},isFetcher:function K(X){if(X instanceof HTMLElement){X=this.getItemFromTarget(X);}return X&&X.fetcher;},fetchItems:function I(X,Y){this._super(X,Q.wrapMethods(this.getFetchItemsCallback(X),Y));},fetchItemsThroughTaskCall:function P(b,g){var a=this.getDataHelper(),Z=this.getAttribute();if(a&&Z&&!this.isFetching){this.set("isFetching",true);var d=this,e=b.branch,X=parseInt(b.level,10),c=b.blockBegin||1,f=b.blockCount||this.blockCount,Y=b.browseFlags||0;a.set("browseConfig",L.copy({blockBegin:c,blockCount:f,browseFlags:Y,expressionXML:(e||X>=0)?O(Z,e,X):"",otp:Z.t,compress:1},L.copy(a.browseConfig)));a.getItems(c,Q.wrapMethods({success:function(h){if(h){L.copy({bb:c,bc:f},h);J.forEach(h.es,function(i){if(!i.pid&&i.pi>-1){i.pid=h.es[i.pi].v;delete i.pi;}L.copy({lv:i.lv||0,hcd:!!i.hcd,hid:!!i.hid,dhid:!!i.hid,pid:i.pid||""},i);});}}},g,{complete:function(h){d.set("isFetching",false);}}),{hideFailureErr:g.failure});}},getFlatDisplayItems:function B(X){return X.filter(function(Y){var Z=Y.fhid;delete Y.fhid;return !Z;});},getFetchItemsCallback:function M(a){var Z=this,Y=a.branch,b=parseInt(a.level,10),X=this.isHiearachyDisplay();return{success:function(c){if(c&&c.es){var e=c.es,d=c.bb+c.bc-1;if(c.sz>d&&!c.raad){e.push({v:"fetcher"+F.create(),n:mstrmojo.desc(1005,"More..."),fetcher:true,lv:X?(b>=0?b:(Y?Y.lv+1:0)):-1,config:L.copy({blockBegin:d+1},L.copy(a))});}if(!X){e.forEach(function(g){var h=g.hid,f=Z.getItemByValue(g.v);delete g.epd;delete g.hid;if(f){delete g.hcd;}L.copy({fhid:h,dhid:!f||f.dhid},g);});}if(Z.setDisplayParent){Z.setDisplayParent(e,null,true);}}}};},getMaxLevel:function A(){var X=this.getAttribute(),Y=(X&&X.lvfs||[]).length;if(Y>0){return Y-1;}return this._super?this._super():0;},getLevels:function D(){var X=this.getAttribute(),Y=X&&X.lvfs||[];return Y.map(function(a,Z){return{v:Z,n:a.lvfn};});},initElements:function S(c){if(this.isHiearachyDisplay()){delete this.displayRoots;var Z=this.getItems(),Y=Z.length,b,X;if(Y>0){if(this.raad){for(var a=Y-1;a>-1;a--){b=Z[a];if(b.fetcher&&b.fake){b.hid=true;X=J.find(b.parent&&b.parent.children,"idx",b.idx);if(X>-1){b.parent.children.splice(X,1);}X=J.find(b.displayParent&&b.displayParent.displayChildren,"idx",b.idx);if(X>-1){b.displayParent.displayChildren.splice(X,1);}}}}this.refresh();}else{this.fetchItems({browseFlags:E},c);}}else{this.clearItemsNode();this.fetchItems({blockCount:500,browseFlags:H},c);}},clearItemsNode:function G(){var X=this.itemsContainerNode;if(X){X.innerText="";this.updateScrollbars();}},onclick:function W(h){var e=h.getTarget(),Y=this.getItemNodeFromTarget(e),i=this.getItemFromTarget(e);if(i&&i.fetcher){if(U.hasClass(e,"text")){if(i.fake){var d=function(j){if(j.displayParent){if(!j.displayParent.hid){return j.displayParent;}else{return d(j.displayParent);}}},b=d(i),a=b?b.displayChildren:this.getDisplayRoots(),f=this.items,X=i.config.nextSiblingIdx,c=this.blockCount,Z=X+c,g;if(a.length-1>Z){g=a.slice(X,Z);i.config.nextSiblingIdx+=c;i.lv=g[g.length-1].lv;g.push(i);}else{a.pop();if(i.parent){i.parent.children.pop();}f.splice(J.find(f,"idx",i.idx),1);g=a.slice(X,a.length);}Y.outerHTML=this._buildSiblingsMarkup(g).join("");this.updateScrollbars();}else{this.fetchItems(i.config,{success:function(j){i.hid=true;Y.outerHTML="";}});}}h.cancel();}else{this._super(h);}},});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(V,L,S,Y,I,P,Z,X){var Q=this.wrapperNodes(V),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,U=I+P,M=Q[0].offsetLeft,O;for(var W=1;W<=K;W++){O=Q[R].offsetLeft-M+Z;if(O<=I){J=R;}else{if(O>=U){H=R;}}var N=Math.round(L/Math.pow(2,W+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip","mstrmojo.css");mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",slot:"",alias:"",parent:null,init:function A(C){this._super(C);var D=this.parent;if(!D||D.hasInitBindings){this.initBindings();}},destroy:function B(C){if(this.hasRendered){this.unrender(C);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn,widgetResized:mstrmojo.emptyFn});mstrmojo.Widget.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};mstrmojo.Widget.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};mstrmojo.Widget.topMarkupMethod=function(){var C=this.top;if(C){this.domNode.style.top=C;}};mstrmojo.Widget.leftMarkupMethod=function(){var C=this.left;if(C){this.domNode.style.left=C;}};mstrmojo.Widget.heightMarkupMethod=function(){var C=this.height;if(C){this.domNode.style.height=C;}this.widgetResized();};mstrmojo.Widget.widthMarkupMethod=function(){var C=this.width;if(C){this.domNode.style.width=C;}this.widgetResized();};mstrmojo.Widget.enabledMarkupMethod=function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.taphold");var A=false,Q=mstrmojo.dom,V=16;mstrmojo._HasContextMenu=mstrmojo.provide("mstrmojo._HasContextMenu",{cm:null,cmPos:null,itemField:"n",itemIdField:"did",itemChildrenField:"items",dynamicUpdate:false,queryChecked:function(W){return false;},queryEnabled:function(W){return true;},queryVisible:function(W){return true;},executeCommand:function P(W){},item2textCss:function E(W){return W.cssClass||W.cmdId||("cmd"+W[this.itemIdField]);},showContextMenu:function J(){if(!A){mstrmojo.requiresCls("mstrmojo.ContextMenu");A=true;}var c=this._subMenu,a=this.getMenuPosition();if(!c){var e=(this.menuZIndex||this.zIndex||10)+1,Y={left:a.x+"px",top:a.y+"px",zIndex:e,visible:false,dynamicUpdate:this.dynamicUpdate,itemField:this.itemField,itemIdField:this.itemIdField,itemChildrenField:this.itemChildrenField,_cmSource:this.getContextMenuSource(),items:this.getContextMenuItems(),cssClass:this.getContextMenuCssClass(),placeholder:document.body.appendChild(document.createElement("div")),parent:this};c=new mstrmojo.ContextMenu(Y);c.render();this._subMenu=c;}else{c.set("left",a.x+"px");c.set("top",a.y+"px");}if(this.dynamicUpdate){var X=c.ctxtBuilder.itemWidgets,Z=X&&X.length,W,b,d=this.getContextMenuSource();for(W=0;W<Z;W++){b=X[W];if(d.queryVisible){b.set("visible",d.queryVisible(b.data));}if(d.queryChecked){b.set("checked",d.queryChecked(b.data));}if(d.queryEnabled){b.set("enabled",d.queryEnabled(b.data));}}}c.set("visible",true);this.callOnContextMenuOpen();this.adjustMenuPosition();this.attachMousedownEvent();},hideContextMenu:function I(){var W=this._subMenu;if(W&&W.visible){this._subMenu.set("visible",false);this.callOnContextMenuClose();}},adjustMenuPosition:function O(){var W=this._subMenu,Z=this._subMenu.domNode,Y=Z.offsetHeight,X=Z.offsetWidth,c=Q.windowDim(),b=Q.position(Z,false),a=Q.position(Z,true);if((b.x+X+V)>c.w){W.set("left",(c.w-X-V+(a.x-b.x))+"px");}if((b.y+Y+V)>c.h){W.set("top",(c.h-Y-V+(a.y-b.y))+"px");}},attachMousedownEvent:function M(){var W=this;if(!this._close_handler){this._close_handler=function(X){W.closeMenuHandler(X);};}Q.attachEvent(document.body,"mousedown",this._close_handler);},closeMenuHandler:function R(W){if(!this.isOnMySubmenu(Q.eventTarget(self,W))){this.closeMenuTree();}},isOnMySubmenu:function N(a){var X=this._subMenu;if(!X){return false;}if(Q.contains(X.domNode,a,true,document.body)){return true;}var b=X.ctxtBuilder.itemWidgets,W=b&&b.length,Z,Y;for(Z=0;Z<W;Z++){Y=b[Z];if(Y.isOnMySubmenu(a)){return true;}}return false;},oncmChange:function K(){delete this._subMenu;},callOnContextMenuOpen:function D(){if(this.onContextMenuOpen){this.onContextMenuOpen();}},callOnContextMenuClose:function C(){if(this.onContextMenuClose){this.onContextMenuClose();}},getContextMenuItems:function U(){return this.cm;},getContextMenuCssClass:function B(){return this.cmCssClass||"";},getContextMenuSource:function H(){return this;},getMenuPosition:function F(){if(this.cmPos){return this.cmPos;}var W=Q.position(this.domNode,true);return{x:Math.round(W.x),y:Math.round(W.y+W.h)};},isSeparatorItem:function G(W){return W[this.itemIdField]===-1||W[this.itemField]==="-";},hasSubmenu:function L(W){return !!W[this.itemChildrenField];},closeMenuTree:function S(Y){var X=this.activeMenuItem,W=this._cmSource||this;if(!X){if(Y){this.activeMenuItem=Y;}else{W.hideContextMenu();}return ;}if(X===Y){return ;}if(Y){this.activeMenuItem=Y;if(Y.parent.parent===X){return ;}if(Y.parent===X.parent){X.hideContextMenu();return ;}}else{Y=W;this.activeMenuItem=null;}X.hideContextMenu();while(X!==W){X=X.parent.parent;if(X!==Y||W===Y){X.hideContextMenu();if(W===Y){Q.detachEvent(document.body,"mousedown",this._close_handler);}}if(X.parent===Y.parent){break;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array");var C=mstrmojo.array;mstrmojo.ObjectBrowserDataProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ObjectBrowserDataProvider",path:mstrConfig.taskURL,serverRequest:function(D,E){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(D,E,{silent:true});}else{mstrmojo.xhr.request("POST",this.path,E,D,undefined,this.XServer,this.baseParams);}},fetchFolderContents:function(D,E,H){var F=D.blockCount,G={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockCount:F,includeAncestorInfo:"true",includeObjectDesc:D.includeObjectDesc,encodeObjectInfo:false};if(D.folderLinksContextId){G.folderLinksContextId=D.folderLinksContextId;}if(D.sId){G.sessionState=D.sId;}if(E.fid){G.rootFolderID=E.fid;}else{if(E.fty){G.rootFolderType=E.fty;}}if(D.browsableTypes){G.objectType=D.browsableTypes;}if(E.blockBegin){G.blockBegin=E.blockBegin;}if(E.searchPattern){if(D.enableQuickSearch){G.quickSearch=D.enableQuickSearch;}G.searchPattern=E.searchPattern;if(E.recursive){G.recursive=E.recursive;}}this.serverRequest(G,H);},newFolder:function(G,H,F,D){var E={taskId:"createFolder",taskContentType:"json",folderID:G,name:H,description:F};this.serverRequest(E,D);},loadObjects:function B(H,I,D,G){var E=[],F=[];C.forEach(H,function(J){E.push(J.did);F.push(J.t);});if(H.length>0&&G){this.serverRequest({taskId:"getObjectInfo",objectIDs:E.join(","),objectTypes:F.join(","),includeDetails:true},I,D);}else{I.success();}},loadRecentSaveAsFolders:function A(E){var D={taskId:"getRecentSaveAsFolders"};this.serverRequest(D,E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");var D={TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4};var C={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};mstrmojo.ui.PopupConfig=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ui.PopupConfig",ENUM_CORNERS:D,isHostedWithin:true,position:null,hostProxyCssClass:"",hostId:"",hostElement:null,anchorElement:null,popupHandlers:null,alignment:null,alignWithAnchor:false,useTooltip:false,useDarkTheme:false,init:function H(I){this.clear();this._super(I);},setAlignment:function E(I,J){this.alignment={host:I,popup:J};},addPopupHandlers:function F(I,K,J){this.popupHandlers[I]={open:K,close:J};},clear:function B(){this.popupHandlers={};var I=this.ENUM_CORNERS;this.alignment={host:I.BOTTOM_LEFT,popup:I.TOP_LEFT};},destroy:function(I){this.anchorElement=null;this.hostElement=null;if(this._super){this._super(I);}}});mstrmojo.ui.PopupConfig.ENUM_CORNERS=D;mstrmojo.ui.PopupConfig.directionCfg={menuDirection:C.LEFT_TO_RIGHT,isRightToLeft:function G(){return this.menuDirection===C.RIGHT_TO_LEFT;},setDirection:function A(I){this.menuDirection=I?C.RIGHT_TO_LEFT:C.LEFT_TO_RIGHT;}};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.StepperContentProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.StepperContentProvider",item:null,renderer:null,min:null,max:null,interval:1,minField:"min",maxField:"max",maxLengthField:"maxLength",valField:"value",intField:"interval",canLoop:false,next:mstrmojo.emptyFn,prev:mstrmojo.emptyFn,hasPrev:mstrmojo.emptyFn,hasNext:mstrmojo.emptyFn,renderItemAt:mstrmojo.emptyFn,setVal:mstrmojo.emptyFn,getVal:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");var F=mstrmojo.hash;var D={SOLID_COLOR:0,NO_FILL:1,GRADIENT:2};mstrmojo.threshold.PropertyModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.PropertyModel",threshold:undefined,gridValueFormat:undefined,submitChange:function G(){this.raiseEvent({name:"propertyModelChange",threshold:this.threshold});},updateControl:function E(I){var H=this.threshold,J=F.copy(H.fmt,this.gridValueFormat);I.textGroup.setFormatSource(H);I.charGroup.setFormatSource(J);I.containerGroup.setFormatSource(J);},changeFormatProperty:function B(I,J,L){var H=this.threshold,K=I==="threshold"?H:H.fmt;if(!K&&I==="fmt"){K=H.fmt={};}K[J]=L;if(J==="bc"){if(typeof (L)==="string"){K.bgs=D.SOLID_COLOR;delete K.gdc;delete K.gda;}else{if(L===-1){K.bgs=D.NO_FILL;}else{K.bgs=D.GRADIENT;}}}},getReplaceTypeName:function A(){return"rtp";},getReplaceTextName:function C(){return"rtxt";}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo._Fetchable");var A=mstrmojo.hash;mstrmojo.mstr.DocElementDataHelper=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._Fetchable],{scriptClass:"mstrmojo.mstr.DocElementDataHelper",source:null,items:null,browseConfig:null,concat:true,init:function(B){var C=B&&B.browseConfig;this.blockBegin=(C&&C.blockBegin)||1;this.blockCount=(C&&C.blockCount)||mstrApp.elementsBlockCount||30;if(this._super){this._super(B);}},getBrowseConfig:function(){if(!this.browseConfig){this.browseConfig={blockBegin:this.blockBegin,blockCount:this.blockCount};}return this.browseConfig;},_retrieveItems:function(E,C,B){var D=this.getBrowseConfig();D.blockBegin=E;mstrmojo.func.override({success:function(F){if(this._super){this._super(mstrmojo.hash.copy(F,{items:F.es,totalSize:F.sz}));}}},C);this.source.browseElements(D,C,B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Obj","mstrmojo.string","mstrmojo.hash","mstrmojo.expr","mstrmojo.num","mstrmojo.mstr.EnumNodeDimty");var G=mstrmojo.array,S=mstrmojo.expr,L=S.ET,K=S.TP,D=S.DTP,M=mstrmojo.mstr.EnumNodeDimty,P=S.ET2TGT,O=S.ET2COND,C=mstrmojo.meta.TP,B=mstrmojo.num;function Q(W,A){var V=(A&&A.did)?A.did.split(S.FN_SEP):null,E=V&&parseInt(V[0],10),U=V&&parseInt(V[1],10),X=W.et;W.fnt=E;W.fn=U;if(X!=L.AE&&S.fn_List(U,E)){W.et=L.AL;W.a2=null;W.cs=null;}else{if(X==L.AL&&!S.fn_List(U,E)){W.et=L.AQ;W.cs=null;}else{if(X==L.MC&&!S.fn_AC_MC(U,E)){W.et=L.MQ;W.m2=null;}else{if(X==L.AC&&!S.fn_AC_MC(U,E)){W.et=L.AQ;W.a2=null;}}}}switch(U){case S.FN.IS_NULL:case S.FN.IS_NOT_NULL:W.a2=null;W.a3=null;W.fm2=null;W.fm3=null;W.m2=null;W.m3=null;W.cs=null;break;case S.FN.BETWEEN:case S.FN.NOT_BETWEEN:break;default:W.a3=null;W.fm3=null;W.m3=null;while(W.cs&&W.cs.length>1){W.cs.pop();}}}function H(Z,a,b){var E=2+a,X;if((!!Z.a||!!Z.m)&&Z.fnt===3){b.dtp=D.REAL;}else{if(B.isBigDecimal(b.v)){b.dtp=D.BIGDECIMAL;}}switch(b.t){case K.PROMPT:X=Z.cs;var Y;if(!X){X=[];Z.cs=X;}X[a]={};Y=X[a];Y.p=b;Z["a"+E]=null;Z["m"+E]=null;switch(Z.et){case L.AC:Z.et=L.AQ;break;case L.MC:Z.et=L.MQ;break;}break;case K.METRIC:Z["a"+E]=null;Z.cs=null;Z.et=L.MC;Z["m"+E]=b;break;case K.ATTR:Z["m"+E]=null;Z.cs=null;Z.et=L.AC;Z["a"+E]=b;Z["fm"+E]=null;break;default:Z["a"+E]=null;Z["m"+E]=null;X=Z.cs;if(!X){X=[];Z.cs=X;}if("did" in b){Z["a"+E]=null;Z["fm"+E]=null;Z["m"+E]=null;if(X[a]&&X[a].p){X[a].p=null;}}else{if(b&&b.v!=null){X[a]=b;}else{if(X[a]&&Z.et!==L.AL){X=X.splice(a,1);}}}if(!b.skipET){switch(Z.et){case L.MC:if((!Z.c2||!Z.m3)&&(!Z.m2||!Z.c3)){Z.et=L.MQ;}break;case L.AC:Z.et=L.AQ;break;case L.AL:if(!("did" in b)&&b.v){var A,V=b.dtp;X=[];A=b.v.split(mstrConfig.listSep);for(var U=0,W=A.length;U<W;U++){X.push({v:mstrmojo.string.trim(A[U]),dtp:V});}Z.cs=X;}break;}}}}var J={};J[L.AQ]={target:1,fm:1,fn:1,cs:1};J[L.AL]={target:1,fm:1,fn:1,cs:1};J[L.AE]={target:1,fn:1,es:1};J[L.AC]={target:1,a2:1,a3:1,fm:1,fm2:1,fm3:1,fn:1};J[L.MQ]={target:1,fn:1,cs:1,dmy:1};J[L.MC]={target:1,fn:1,m2:1,m3:1,dmy:1};J[L.F]={target:1};J[L.R]=J[L.F];J[L.XML]={target:1};J[L.ANDOR]={target:1};var I=function(A){return A!==null&&A!==undefined;};var N=function(a){if(a.data){return true;}if(!a||!I(a.et)){return false;}var Z=true,A=J[a.et],X=a.cs,W;Z=Z&&(!A.target||a[P[a.et]]);Z=Z&&(!A.fm||a.fm);Z=Z&&(!A.fn||I(a.fn));var V=S.fnCstCount(a.fn,a.fnt);if(Z&&A.cs){for(W=0;W<V;W++){Z=Z&&X&&I(X[W]);}}if(Z){var Y=[P[a.et],"fm"];for(var E=0;E<2;E++){for(W=0;W<V;W++){var b=Y[E]+(2+W);Z=Z&&(!A[b]||a[b]);}}}Z=Z&&(!A.es||a.es&&(a.es.length>0));var U=a.dimtyTypes;Z=Z&&(!A.dmy||U[M.NodeDimtyUnspecified]||U[M.NodeDimtyNone]||(U[M.NodeDimtyOutputLevel]&&a.dmy&&a.dmy.uts&&(a.dmy.uts.length>0)));return Z;};mstrmojo.ConditionModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ConditionModel",data:null,completed:false,defaultETAttr:L.AQ,init:function(A){if(this._super){this._super(A);}this._updateCompleted();},edit:function R(p,f,AA){var W=this[p];if(W===f){return ;}this.etWas=this.et;switch(p){case"not":f=!!(f&&f.did===S.FN.NOT);W=!!this.not;if(f===W){return ;}this.not=!!f||null;break;case"target":var AE=this.et;if(f){switch(f[C]){case K.ATTR:case K.CONS:W=this.a;if(AE!==L.AQ&&AE!==L.AE&&AE!==L.ANDOR){this.et=this.defaultETAttr;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}if(AE!==L.AE){this.fn=null;this.fnt=null;}this.fm=null;this.fm2=null;this.fm3=null;this.cs=null;break;case K.METRIC:W=this.m;if((AE!==L.MQ)&&(AE!==L.MC)){this.et=L.MQ;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.r=null;this.f=null;this.cs=null;this.dmt=M.NodeDimtyUnspecified;}this.m2=null;break;case K.REPORT:W=this.r;if(AE!==L.R){this.et=L.R;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.f=null;}break;case K.FILTER:W=this.f;if(AE!==L.F){this.et=L.F;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;}break;case K.PROMPT:W=this.prms&&this.prms[0];if(AE!==L.XML){this.et=L.XML;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}break;}}this.es=null;this.data=null;this[P[this.et]]=f;break;case"fm":if(f&&f[C]==="fn"){this.et=L.AE;this.fm=null;Q(this,f);}else{this.fm=f;if(f&&(this.et==L.AE)){this.et=L.AQ;}this.fnt=null;this.fn=null;this.cs=null;this.a2=null;this.fm2=null;}break;case"fm2":case"fm3":this[p]=f;break;case"fn":Q(this,f);break;case"es":var AH=this.es;if(f&&f.removed&&AH){G.removeItems(AH,f.itemIdField,f.removed);}if(f&&f.added){if(!AH){AH=f.added.concat();this.es=AH;}else{G.insert(AH,AH.length,f.added);}}break;case"c0":H(this,0,f);break;case"c1":H(this,1,f);break;case"dmy":var AB=this.dmy;if(!AB){AB={cc:true,fres:true,uts:[]};this.dmy=AB;}var x=AB&&AB.uts;if(!x){x=[];AB.uts=x;this.dmt=M.NodeDimtyOutputLevel;}var U={};U[S.TP.ATTR]=true;U[S.TP.DIM]=true;if(f&&f.removed){var k=[],A=false,d=[],V=false;for(var o=0,X=f.removed,E=X.length;o<E;o++){var Z=X[o],AD=Z[C] in U;if(AD){V=true;}else{A=true;}var m=AD?d:k;m.push(Z);}if(A){G.removeItems(x,"did",k);}if(V){var AG={};for(var h=0,g=x&&x.length;h<g;h++){var e=x[h];if(e&&e.utgt){AG[e.utgt.did]=h;}}var Y=[];for(var AC=0,z=d.length;AC<z;AC++){var l=AG[d[AC].did];if(l>-1){Y.push(l);}}Y.sort(G.numSorter);for(var w=Y.length-1;w>-1;w--){x.splice(Y[w],1);}}}if(f&&f.added){var AI=[],q=S.DMY_TP.DIM,t=S.DMY_TP.ATTR;for(var AF=0,y=f.added,j=y.length;AF<j;AF++){var s=y[AF];AI.push((s[C] in U)?{utgt:s,utp:s[C]===K.DIM?q:t,agg:1,flt:2,gb:true,rps:0,n:s.n}:s);}G.insert(x,x.length,AI);}break;case"data":this.data=f;break;}this._updateCompleted();if(!AA){this.raiseEvent({name:"edit",prop:p,value:f,valueWas:W});}},get:function F(){var A=this.data?this.data:this;var E=O[A.et]||[];E.push("et");return mstrmojo.hash.copyProps(E,A);},_updateCompleted:function(){this.set("completed",N(this));}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.color","mstrmojo.hash","mstrmojo.num","mstrmojo.array","mstrmojo.date");mstrmojo.requiresClsP("mstrmojo.mstr");var j=1,h=2,p=3,I=4,a=5,k=6,i=7,A=-1,J=-2,G=mstrmojo.color,M=mstrmojo.hash,d=mstrmojo.array,F=mstrmojo.num,O=mstrmojo.date,K,Z,s=mstrmojo.mstr.EnumDSSXMLObjectTypes;function o(AA,z){return AA.every(function(AB){return z(AB);});}function f(AB,AA,z){return o(AB,function(AC){return AC.ttp===AA||AC.ttp===z;});}function c(AA){var z=AA.toFixed(2);return parseFloat(z);}function n(z){this.raiseEvent(M.copy(z,{name:"modelEdit"}));}function t(z){this.raiseEvent(M.copy(z,{name:"selectedThresholdsChange"}));}function S(){var z=this.basedOnId||this.metricId;return(d.filterOne(this.data.gsi.mx,function(AA){return AA.did===z;})||{});}function l(AC){var z=AC.expr.nds,AA=z.length;if(AA!==1){return false;}var AB=z[0],AL=AB.cs;if(!AB.m||!AL){return false;}var AK=AB.fnt,AF=AB.fn,AJ=AL[0],AH=AL[1],AE=AJ&&AJ.v,AD=AH&&AH.v,AI=F.parseNumeric(AE)||parseFloat(AE),AG=F.parseNumeric(AD)||parseFloat(AD);switch(AK){case 2:case 3:switch(AF){case 1:case 2:AC.flr=AK===2?-Infinity:0;AC.ceil=AI;AC.ttp=AK===2?(AF===1?a:I):(AF===1?h:j);break;case 3:case 4:case 5:case 13:AC.flr=AI;AC.ceil=isNaN(AG)?(AK===2?Infinity:100):AG;AC.ttp=AK===2?(AF===4?a:(AF===5?I:k)):(AF===4?h:(AF===5?j:p));break;default:return false;}break;default:switch(AF){case 11:AC.flr=-Infinity;AC.ceil=AI;AC.ttp=i;break;case 17:case 10:AC.flr=AI;AC.ceil=isNaN(AG)?Infinity:AG;AC.ttp=i;break;default:return false;}}return true;}mstrmojo.threshold.MetricThresholdData=null;mstrmojo.threshold.ThresholdModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.ThresholdModel",data:undefined,thresholds:undefined,orgThresholds:undefined,selectedThresholds:[],metricId:undefined,basedOnId:undefined,basedOnName:undefined,editorMode:0,init:function q(AA){this._super(AA);var z=mstrApp.customization.getCustomThresholds();K=K||z.color;Z=Z||z.image;},ondataChange:function m(){this.thresholds=this.data.gsi.thresholds;this.saveOriginalData();},isMetricAvailable:function(z){return d.find(this.data.gsi.mx,"did",z)!==-1;},thresholdMetricNotAvailable:function(z){if(z){mstrmojo.alert(mstrmojo.desc(16555,'This threshold is based on the metric "#####" which has been removed from the visualization. Please re-add this metric and try again.').replace("#####",z));}else{mstrmojo.alert(mstrmojo.desc(16556,"This threshold is based on a metric which has been removed from the visualization. Please re-add this metric and try again."));}},isAdvanced:function E(AD){var AA=this.thresholds;if(AA){var AG=AA[AD]||[],AW=false,AV,AR,AQ,AN,AT="The expression is not supported by the Simple Threshold Exception Parser.";if(AG.length===0){return false;}if(AG.some(function(Ac){if(Ac.ttp===A){return true;}try{if(!l(Ac)){throw AT;}AQ=Ac.expr.nds[0].m;}catch(Ab){return true;}if(AV&&AV!==AQ.did){return true;}AV=AQ.did;AR=AQ.n;var Aa=Ac.rtp;if(Aa===3||Aa===10){return true;}var AX=Ac.scope;if(AX&&AX!==1){return true;}var AZ=Ac.fmt||{};for(var AY in AZ){if(AY!=="bc"&&AY!=="bgs"){return true;}else{AW=true;}}return false;})){return true;}if(AW&&!o(AG,function(AX){return AX.fmt&&(AX.fmt.bc||AX.fmt.bgs);})){return true;}this.basedOnId=AV;this.basedOnName=AR;var AP=false,AM=this.getSimpleThresholdType(AD),AF=AG.length;if(AF>0&&AM!==J){var AS,AI,AK;for(AS=0;AS<AF-1;AS++){AI=AG[AS];AK=AG[AS+1];if(AI.ceil!==AK.flr&&AI.flr!==AK.ceil){AP=true;break;}}if(!AP){var z=AG[0],AB=AG[AF-1],AJ=z.flr,AO=AB.ceil,AC=z.ceil,AE=AB.flr,AH=this.getMetricsCount(),AL=this.getMetricsMinValue(),AU=this.getMetricsMaxValue();switch(AM){case a:case I:AP=!(((AJ===0||AJ===-Infinity)&&(AO===AH||AO===Infinity))||((AC===AH||AC===Infinity)&&(AE===0||AE===-Infinity)));break;case h:case j:AP=!((parseInt(AJ,10)===0&&parseInt(AO,10)===100)||(parseInt(AC,10)===100&&parseInt(AE,10)===0));break;case i:AP=!(((AJ===AL||AJ===-Infinity)&&(AO===AU||AO===Infinity))||((AC===AU||AC===Infinity)&&(AE===AL||AE===-Infinity)));break;}}return AP;}else{return true;}}return false;},getSimpleThresholdType:function(AA){var AB=this.thresholds&&this.thresholds[AA],z=J;if(AB){if(f(AB,p,h)){z=h;}else{if(f(AB,p,j)){z=j;}else{if(f(AB,k,I)){z=I;}else{if(f(AB,k,a)){z=a;}else{if(f(AB,i)){z=i;}}}}}}return z;},isImageBasedType:function N(z){var AA=this.thresholds&&this.thresholds[z];return AA&&!AA.some(function(AB){return AB.rtp!==4;});},getMetricsMaxValue:function(){var z=S.call(this).max;return(z===undefined)?3000000:z;},getMetricsMinValue:function(){var z=S.call(this).min;return(z===undefined)?-3000000:z;},getMetricsCount:function(){var z=S.call(this).cnt;return z===undefined?100:z;},getServerThresholdValues:function B(){var z=this.basedOnId||this.metricId,AA=this.thresholds&&z in this.thresholds&&this.thresholds[z];if(d.isArray(AA)&&AA.length>0&&AA[0].ttp===i){AA.sort(function(AC,AB){return AC.flr-AB.flr;});return{min:AA[0].ceil,max:AA[AA.length-1].flr};}return{min:undefined,max:undefined};},getFormatString:function(){var AB=this.data.nf,AA=this,z=d.filterOne(AB,function(AC){return AC.id===AA.basedOnId;})||{};return z.nfs||"";},getDefaultColors:function x(){return K;},getDefaultImages:function L(){return Z;},getNormalizedValue:function(AE,AC,AB,AG){var AA=null;if(AC===p||AC===h||AC===j){AA=AE/100;}else{if(AC===k||AC===a||AC===I){AA=AE/(this.getMetricsCount());}else{if(AC===i){var AD=this.globalMinMax(AB,AG),z=AD.min,AF=AD.max;if(AG!==undefined&&AG<AF){AF=Math.max(AG,this.getMetricsMaxValue());}if(AB!==undefined&&AB>z){z=Math.min(AB,this.getMetricsMinValue());}if(AF===z){return 1;}AA=(AE-z)/(AF-z);}}}if(AA<0){AA=0;}if(AA>1){AA=1;}return AA;},getRealValue:function(AD,AB,AA,AF){if(AB===p||AB===h||AB===j){return c(AD*100);}if(AB===k||AB===a||AB===I){return c(AD*this.getMetricsCount());}if(AB===i){var AC=this.globalMinMax(AA,AF),z=AC.min,AE=AC.max;if(AF!==undefined&&AF<AE){AE=Math.max(AF,this.getMetricsMaxValue());}if(AA!==undefined&&AA>z){z=Math.min(AA,this.getMetricsMinValue());}return z+AD*(AE-z);}return null;},globalMinMax:function e(AA,AE){var z=(AA!==undefined&&AA!==-Infinity)?AA:Infinity,AD=(AE!==undefined&&AE!==Infinity)?AE:-Infinity,AB=this.getServerThresholdValues(),AC=AB.min,AF=AB.max;AC=(AC===undefined)?Infinity:AC;AF=(AF===undefined)?-Infinity:AF;return{min:Math.min(z,this.getMetricsMinValue(),AC),max:Math.max(AD,this.getMetricsMaxValue(),AF)};},getColorScheme:function(AA){var z="custom",AB,AC,AD;K.forEach(function(AE){AD=AE.bands;AC=AA.length;if(AC!==AD.length){return ;}for(var AF=0;AF<AC;AF++){AB=mstrmojo.color.fixFullHexValue(AA[AF]);if(AD[AF].bc!==AB&&AD[AC-AF-1].bc!==AB){return ;}}z=AE.id;});return z;},getImageSetName:function Y(AD){var AC=Z[0].id,z,AB=function(AE){return AE===z.bands[0].url;};for(var AA=0;AA<Z.length;AA++){z=Z[AA];if(AD.some(AB)){AC=z.id;break;}}return AC;},getGridValueFormat:function P(){return this.data.gsi.fmts.va;},isMapReversed:function Q(AB,z,AD){var AC=(AD?Z:K).filter(function(AE){return AE.id===AB;})[0],AA=z[0];if(!AD){AA=G.fixFullHexValue(AA);}return AC&&AC.bands[0][AD?"url":"bc"]!==AA;},setConditionData:function U(AC,AA){var AB=AC.data,z=AB.isNew;M.copy(AA,M.clear(AB));delete AB.isNew;AC.paint();AC.tree.onConditionEdit(AC,z);},hasSelectedThresholds:function w(){return this.selectedThresholds.length>0;},isThresholdSelected:function g(z){return this.selectedThresholds.indexOf(z)!==-1;},toggleThresholdSelected:function b(z,AB){var AF=this.selectedThresholds,AE=AF.indexOf(z),AA=AE!==-1,AD=this.thresholds[this.metricId],AC=AD.indexOf(z)!==-1;if(AC){if(AB&&!AA){AF.push(z);}else{if(!AB&&AA){AF.splice(AE,1);}}t.call(this);}},addThresholds:function X(z){var AA=this.thresholds[this.metricId];this.thresholds[this.metricId]=(AA||[]).concat(z);n.call(this);},duplicateThreshold:function u(AA){var AC=this.thresholds[this.metricId],z=AC[AA],AB=M.clone(z);AC.push(AB);if(this.isThresholdSelected(z)){this.toggleThresholdSelected(AB,true);}n.call(this);},deleteThreshold:function y(z){var AB=this.thresholds[this.metricId];var AA=AB.indexOf(z);if(AA!==-1){this.toggleThresholdSelected(z,false);AB.splice(AA,1);}n.call(this);},moveThreshold:function D(AA,AC){var AB=this.thresholds[this.metricId],z=AB.splice(AA,1);this.thresholds[this.metricId]=AB.slice(0,AC).concat(z,AB.slice(AC,AB.length));n.call(this);},cleanUp:function R(){this.selectedThresholds=[];this.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.AUTO;},clearData:function W(){var z=this.thresholds;if(z){z[this.metricId]=undefined;}},saveOriginalData:function V(){this.orgThresholds=M.clone(this.thresholds);},setAttIdToNDE:function C(AB){if(!(AB instanceof Array)){AB=[AB];}var AA,AG,AC,z,AF,AD=function(AH){AH.att.forEach(function(AI){if(AI.did===AF.did){AF.attId=AI.attId;}});},AE=function(AH){AH.conid=AF.did;};for(AA=0;AA<AB.length;AA++){z=AB[AA];for(AG in z){AF=z[AG];if(typeof AF==="function"||!(AF instanceof Object)){continue;}else{if(AG==="a"){if(AF.t===47&&AF.st===12033){M.forEach(this.controller.datasets,AD);AC=z.fn;if(AC===22||AC===57){(z.es||[]).forEach(AE);}}}else{this.setAttIdToNDE(z[AG]);}}}}},showNumberFormat:function H(){var AA=S.call(this),AB=AA&&AA.min,z=AA&&AA.max;return(typeof (AB)==="number"||typeof (z)==="number")||(O.isDate(AB)||O.isDate(z));}});mstrmojo.threshold.ThresholdModel.SLIDER_MODE={COLOR_BASED:0,IMAGE_BASED:1};mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL=[{n:"&#9679;",v:"1"},{n:"&#9632;",v:"2"},{n:"&#9830;",v:"3"},{n:"&#9670;",v:"4"},{n:"&#10070;",v:"5"},{n:"&#9784;",v:"6"},{n:"&#10047;",v:"7"},{n:"&#8984;",v:"8"},{n:"&#8680;",v:"29"},{n:"&#8679;",v:"30"},{n:"&#8681;",v:"31"}];mstrmojo.threshold.ThresholdModel.FEATURES={SHOW_ADVANCED_EDITOR:1,SHOW_BASED_ON:2,SHOW_IMAGE:3,SHOW_VALUE_ITEM:4};mstrmojo.threshold.ThresholdModel.EDITOR_TYPES={AUTO:0,ADVANCED_EDITOR:1,SIMPLE_EDITOR:2};mstrmojo.threshold.ThresholdModel.BASED_ON_TYPES={LOWEST_PERCENT:j,HIGHEST_PERCENT:h,BETWEEN_PERCENT:p,LOWEST:I,HIGHEST:a,BETWEEN:k,VALUE:i,COMPLEX:A,NONE:J};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo._HasChildren","mstrmojo.Binding","mstrmojo._HasBindings");mstrmojo.Model=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasChildren,mstrmojo._HasBindings],{scriptClass:"mstrmojo.Model",init:function A(C){this._super(C);if(this.children){this.initChildren();}if(!this.parent){this.initBindings();}},destroy:function B(C){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj");var M=mstrmojo.DI.DIConstants,H=mstrmojo.array,D=M.dbType,F=M.xdaType,I=M.sourceType,K=M.backendSourceSubtype;mstrmojo.DI.DIDatabaseHelper=mstrmojo.declare(mstrmojo.Obj,null,null);mstrmojo.DI.DIDatabaseHelper.getImportOptionByDBType=function A(N){switch(N){case D.SAP:case D.MSFT_AS:case D.ESSBASE:case D.TM1:case D.PIG:return false;default:return true;}};mstrmojo.DI.DIDatabaseHelper.getSourceTypeByDBType=function E(N){switch(N){case D.SAP:case D.MSFT_AS:case D.ESSBASE:case D.TM1:return F.mdx;case D.PIG:return F.ffsql;default:return -1;}};mstrmojo.DI.DIDatabaseHelper.getDescriptionIdByDBType=function(N){switch(N){case D.MS_ACCESS:return 9149;case D.ORACLE:return 8545;case D.SQL_SERVER:return 8552;case D.INFORMIX:return 12995;case D.SYBASE:return 12998;case D.REDBRICK:return 10059;case D.DB2:return 8516;case D.TERADATA:return 8553;case D.SAP:return 13107;case D.NETEZZA:return 8558;case D.EXCEL:return 3958;case D.MSFT_AS:return 13225;case D.ESSBASE:return 13224;case D.MYSQL:return 8556;case D.POSTGRESQL:return 8541;case D.COMPOSITE:return 12991;case D.ASTER:return 10058;case D.VERTICA:return 10062;case D.PARACCEL:return 10056;case D.TM1:return 13223;case D.XQUERY:return 8560;case D.HIVE:return 8561;case D.SALESFORCE:return 9213;case D.SAPHANA:return 12997;case D.GOOGLE_BIGQUERY:return 12450;default:return 4444;}};mstrmojo.DI.DIDatabaseHelper.getOASTFromBEST=function L(N){switch(N){case K.googleBigQuery:case K.googleBigQueryFFSQLModel:case K.googleBigQuerySingleTable:return I.googleBigQuery;case K.dropbox:return I.dropbox;case K.googleAnalytics:return I.googleAnalytics;case K.googleDrive:return I.googleDrive;case K.facebook:return I.facebook;case K.twitter:return I.twitter;case K.salesforce:return I.salesforce;default:return -1;}};mstrmojo.DI.DIDatabaseHelper.isOAuthSourceType=function C(N){var O=[I.googleBigQuery,I.dropbox,I.googleAnalytics,I.googleDrive,I.facebook,I.twitter,I.salesforce];return H.indexOf(O,N)!==-1;};mstrmojo.DI.DIDatabaseHelper.filterDBById=function B(P,N,O){return H.filter(P,function(S){var R=H.indexOf(N,S.id),Q;if(R>-1){Q=O;}else{Q=!O;}return Q;});};mstrmojo.DI.DIDatabaseHelper.filterDBByDispOption=function B(P,N,O){return H.filter(P,function(R){var Q=false;if((R.disp&N)===N){H.forEach(O,function(S){if(R.id===S){Q=true;return false;}});return !Q;}});};mstrmojo.DI.DIDatabaseHelper.getDBIds=function J(O){var N=[];H.forEach(O,function(P){N=N.concat(P.id);});return N;};mstrmojo.DI.DIDatabaseHelper.getUniqueDBTypes=function G(P){var O=[],N;H.forEach(P,function(Q){N=H.indexOf(O,Q.dbType);if(N<0){O.push(Q.dbType);}});return O;};mstrmojo.DI.DIDatabaseHelper.filterDBByAdminConfig=function(O,N){return H.filter(O,function(R){var P=H.indexOf(N,R.id),Q=true;if(P>=0){Q=false;}return Q;});};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var K=mstrmojo.hash;var P=0;var F=[];var J={};var L=false;function I(U){var V=U.callback;if(V.submission){V.submission(U.id,this.userInteractionRequired(U),U);}this.submitRequest(U);}function G(){if(F.length&&!L){I.call(this,F.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function E(e,b,V,W){if(V){this.cancelRequests();}var Y=this.id,Z=this.transport,U=mstrmojo.now()+b.taskId+P++,X=e.canceled||mstrmojo.emptyFn;e.canceled=function(f){X();e.complete(true);return Z.cancelRequest(f);};e=mstrmojo.func.wrapMethods(e,{complete:function(f){mstrmojo.all[Y]&&mstrmojo.all[Y].deleteRequest(f);}});var a=!K.isEmpty(this._requests),c=this.createRequest(U,e,b,W),d=(L||a)&&!W.doNotHold;if(d){F.push(c);}else{I.call(this,c);}return U;},hasRequests:function O(){return !K.isEmpty(this._requests)||L;},createRequest:function Q(W,Y,X,U){var V=this._requests;if(!V){V=this._requests={};}V[W]={id:W,callback:Y,params:X,config:U};return V[W];},submitRequest:function M(U){this.transport.serverRequest(this.id,U.id,U);},cancelRequests:function S(){var U=false;K.forEach(this._requests,function(V){if(V.gotResponse===undefined){U|=V.callback.canceled(V.id);}});this._requests={};F=[];return U;},cancelRequest:function B(Y){var V=false,X=this._requests[Y],W,U=F.length;for(W=0;W<U;W++){if(F[W]===X){break;}}if(W<U){F.splice(W,1);delete this._requests[Y];V|=X.callback.canceled(X.id);}return V;},response:function A(Y,U,W){$MAPF(false,"AndroidServerTransport","transportRequest");var X=this.getRequest(Y);if(X){X.gotResponse=true;var Z=X.callback,V=(U&&!W.mstrerr)?"success":"failure";try{if(Z[V]){Z[V](W,X);}}finally{Z.complete(Y);}}G.call(this);},deleteRequest:function N(V){var U=this._requests;delete U[V];},getRequest:function H(V){var U=this._requests;return U&&U[V];},userInteractionRequired:function C(U){return false;},addLoadingGraph:function D(U){J[U]=true;L=true;},removeLoadingGraph:function R(U){delete J[U];if(K.isEmpty(J)){L=false;G.call(this);}},_serverRequestParallel:function(V,X,Y,U){var W=U||new mstrmojo.SimpleXHR();W.request("POST",V,{success:function(Z){if(Y.success){Y.success(Z);}},failure:function(Z){if(Y.failure){Y.failure({code:Z.getResponseHeader("X-MSTR-TaskErrorCode"),message:Z.getResponseHeader("X-MSTR-TaskFailureMsg")});}},complete:function(){if(Y.complete){Y.complete();}}},X);},serverRequestParallel:function(V,W,U){this._serverRequestParallel(mstrConfig.taskURL,V,W,U);},upload:function(a,Z,Y,V,X,W,U){mstrmojo.xhr.upload("POST",mstrConfig.taskURL,a,Z,Y,V,X,W,U);}});}());(function(){mstrmojo.requiresCls("mstrmojo.func");var A=mstrmojo.string;mstrmojo.ResSetLink=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ResSetLink",SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,DYNAMIC_OR_SAME_PROMPT:9,toXml:function B(){var N=this,E=function(U,V){return" "+U+'="'+V+'"';},D=function(U,V){return E(U,mstrmojo.string.encodeXMLAttribute(V));},I=new mstrmojo.StringBuffer(),G=function(V,W){var U=mstrmojo.string.multiReplace(W.disp_n,{"&nbsp;":" "});V.append("<e"+D("ei",A.decodeXMLAttribute(W.ei))+D("disp_n",A.decodeXMLAttribute(U))+E("emt",W.emt)+"/>");};var L=this.prms,C=L&&L.length;if(C||N.aopam!=N.DO_NOT_ANSWER){I.append("<hl"+E("mid",N.mid)+E("srct",N.srct)+E("aopam",N.aopam)+">");if(C){I.append("<prms>");for(var H=0;H<C;H++){var S=L[H];I.append("<prm"+E("id",S.id)+E("am",S.am)+E("pt",S.pt));if(S.orid){I.append(E("orid",S.orid)+E("ortp",S.ortp));}I.append(">");switch(S.am){case N.DO_NOT_ANSWER:case N.CLOSE:case N.USE_DEFAULT_ANSWER:case N.SAME_PROMPT:break;case N.STATIC:I.append('<pa ia="1"><es>');var R=S.pa.es,Q=R&&R.length||0;for(var M=Q-1;M>=0;--M){var K=R[M];G(I,K);}I.append("</es></pa>");break;case N.DYNAMIC:case N.CURRENT_UNIT:case N.DYNAMIC_OR_SAME_PROMPT:var P=S.pa;if(P){I.append('<pa ia="1">');var O=P.a;if(O){I.append("<a"+E("id",O.id)+D("n",O.n)+">");}if(S.pt===1){I.append(mstrmojo.string.encodeXMLAttribute(P.v));}else{I.append("<es"+E("dispForms",O&&O.dispForms>=0?O.dispForms:"")+">");var R=P.es;Q=R&&R.length||0;for(var M=Q-1;M>=0;--M){var K=R[M];G(I,K);}I.append("</es>");if(O){I.append("</a>");}}I.append("</pa>");}break;case N.ALL_VALID_UNITS:var P=S.pa;if(P){I.append('<pa ia="1">');var O=P.a,J=(O&&O.length)||0,F;if(J===0&&S.pt===1){I.append(mstrmojo.string.encodeXMLAttribute(P.v));}else{I.append("<attGroups><attGroup>");for(F=0;F<J;F++){I.append("<a"+E("id",O[F].id)+D("n",O[F].n)+">");if(S.pt===1){I.append(mstrmojo.string.encodeXMLAttribute(P.v));}else{I.append("<es"+E("dispForms",O[F].dispForms>=0?O[F].dispForms:"")+">");G(I,P.es[F]);I.append("</es>");}I.append("</a>");}I.append("</attGroup></attGroups>");}I.append("</pa>");}}I.append("</prm>");}I.append("</prms>");}else{I.append("<prms/>");}I.append("</hl>");}return I.toString();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj");function B(J,I){this.raiseEvent({name:"viCompBuilt",type:J,widget:I});}mstrmojo.vi.models.VIComponentMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.VIComponentMap",init:function G(I){this._super(I);this.relativePanels={};this.comps={};},addRelativePanel:function H(I){this.relativePanels[I]=true;},isRelativePanel:function F(I){return !!this.relativePanels[I];},isComponent:function C(J,I){return this.getComponentKey(J)===I;},getComponent:function A(I){return this.comps[I];},getComponentKey:function D(J){var I=this.getComponent(J);return(I&&I.k)||"";},createComponent:function E(L,K,J){B.call(this,L);var I=new K(J);this.comps[L]=I;B.call(this,L,I);return I;}});mstrmojo.vi.models.VIComponentMap.TYPES={FILTER_STACK:1,FILTER_PANEL:2,PAGEBY_STACK:3,PAGEBY_PANEL:4,VIZ_CONTENT:5,MAIN_CONTENT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var j=1,U=2;var E=2,L=4,D=5;var X=1,O=4;var h=mstrmojo.array;function H(k,l){return k[((l===j)?"row":"col")];}function B(k,m){var l=m.lm;return l&&l[k.mix||0];}function d(l,q,y){var w=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:q.target.t||2,aopam:q.daMode});var s=q.ans,x=s&&s.length;if(x){var t=w.prms=[],m=0;for(m=0;m<x;m++){var AC=s[m];var n=AC.pid,p=parseInt(AC.m,10),AB={id:n,am:p,pt:AC.pt};t.push(AB);if(AC.po){AB.orid=AC.po.did;AB.ortp=AC.po.t;}switch(p){case w.DO_NOT_ANSWER:case w.CLOSE:case w.USE_DEFAULT_ANSWER:case w.SAME_PROMPT:break;case w.STATIC:var k=AC.es,AA=(k&&k.length)||0,u;AB.pa={es:[]};for(u=AA-1;u>=0;--u){var o=k[u];AB.pa.es.push({ei:o.id,disp_n:o.n,emt:1});}break;case w.DYNAMIC:case w.ALL_VALID_UNITS:case w.CURRENT_UNIT:case w.DYNAMIC_OR_SAME_PROMPT:if(y.els){A.call(this,AC,y,AB,p,w);}else{K.call(this,AC,y,AB,p,w);}break;}}}return w;}function A(s,l,k,q,p){var o=s.dunits,m=l.els,n=k.pa={};h.forEach(m,function(t){if(h.find(o,"id",t.id)>=0){if(q!==p.DYNAMIC&&q!==p.DYNAMIC_OR_SAME_PROMPT){n.a={id:t.id,n:t.disp_n,dispForms:t.dfi};}if(s.pt===1){n.v=t.v;}else{n.es=[];n.es.push({ei:t.ei,emt:t.emt,disp_n:t.disp_n});}}});}function K(AA,x,z,o,q){var s=AA.dunits,u=AA.dsUnits;if(s&&s.length&&x){var t=z.pa={};var n=x,m=(x.mix!==undefined)&&(x._lp||x._tp);if(m){n=x._lp||x._tp;}var l=parseInt(n.axis,10);while(n){var y=this.getPTitle(n,l);if(y&&h.find(s,"id",y.id)>=0){var p={id:y.id,n:y.n,dispForms:y.dfi};if(o===q.ALL_VALID_UNITS){t.a=(t.a||[]).concat(p);}else{if(o!==q.DYNAMIC&&o!==q.DYNAMIC_OR_SAME_PROMPT){t.a=p;}}if(AA.pt===1){var k=AA.formMap;t.v=k&&k[n.fmi]?k[n.fmi]:n.v;break;}else{var w={ei:n._e.id,emt:1,disp_n:n._e.n};if(o===q.ALL_VALID_UNITS){t.es=(t.es||[]).concat(w);}else{t.es=[].concat(w);}}if(o===q.CURRENT_UNIT){break;}}n=this.getPCellParentNode(n,l);if(m&&!n&&l===j){l=U;n=x._tp;}}}else{if(u&&u.length&&x){z.pa={es:u};}}}function R(m){var l=this.getCellTitleInfo(m[0]),o=[],q=function(s){if(s){if(mstrApp.useBinaryFormat){if(s._e){o.push(s.axis+"A"+(s.ui+1)+"A"+s._e.id);}q(s._p);}else{o.push(s.axis+"A"+(s.ui+1)+"A"+s.o);}}},n,k;if(!l.isSrcTitle){for(n=0,k=m.length;n<k;n++){var p=m[n];if(p.mix!==undefined&&(p._lp||p._tp)){q(p._lp);q(p._tp);}else{q(p);}}}return(mstrApp.useBinaryFormat)?o:o.join(",");}function J(o,n,l){var m=true,k=l.length;while(o<k){if(l[o].id!==n.id){m=false;break;}o++;}return m;}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function S(){return this.data.mid;},getCellTitleInfo:function e(l,o){var m=o?o.gts:this.data.gts;var n=null;if(m){if(l&&l.mix===undefined){n=H(m,l.axis)[l.tui||l.ui];}else{var k=function(s){var p=(s&&s.length)||0,q;for(q=p-1;q>=0;--q){if(parseInt(s[q].otp,10)===-1){return s[q];}}return null;};n=k(m.col)||k(m.row);}}return{isSrcTitle:!!l&&(l.o===undefined)&&!((l.mix!==undefined)&&(l._lp||l._tp)),title:n};},getCellInfo:function I(l){var k=this.getCellTitleInfo(l),m={isTitle:false,isHeader:false,isMetric:false};if(l&&(l.hasOwnProperty("mix")||l.otp===-1)){m.isMetric=true;if(l._e){m.isHeader=true;}}if(k.isSrcTitle){m.isTitle=true;}return m;},getCellLinksInfo:function g(l,m){if(!m){var k=this.getCellTitleInfo(l);m=k&&k.title;}return B(l,m);},getAllDrillPathsForCell:function b(l,n){if(!n){var k=this.getCellTitleInfo(l);n=k&&k.title;}var m=h.filter(n.dp,function(p){var o=p&&p.oid;if(o&&l._e&&l._e.oid){return o===l._e.oid;}return true;});return m;},getCellDrillsInfo:function G(k,m){var l=this.getAllDrillPathsForCell(k,m);return l&&l[k.mix||0];},getLinkDrillAction:function P(k){return this.getActionObject(k);},getAction:function W(k){return this.getActionObject(k);},getActionObject:function M(l){var k=l[0]&&l[0].at,m=null;if(k){if((k&O)>0){m={h:"onLink",a:this.getLinkAction(l[0])};}else{if((k&X)>0){m={h:"onDrill",a:this.getDrillAction(l)};}}}return m;},getSortAction:function F(AA,t){var o=this.getCellTitleInfo(AA),x=o.title,l=[],n=o.isSrcTitle?x.axis:(h.find(this.data.gts.col,"otp",-1)>-1?j:U),z=this.data.gts[((n===j)?"row":"col")+"SubPos"],q,w,u,y,AB;t=(t===null||t===undefined)?!(AA&&AA.so):t;if(o.isSrcTitle){q=E;w=x.id;u=x.otp;y=x.fid;}else{q=L;u=4;AB=x.stt;var s,k;do{s=AA._e;if(s){if(s.oid){w=s.oid;}else{k=s.id.replace(/;/g,"\\;");l.push(k);}}AA=AA._p;}while(AA);}var p={sortType:q,axis:n,isAsc:t,unitID:w,unitType:u,elementList:l.join(";"),subTotalsPos:z};if(w){p.unitID=w;}if(y){p.formId=y;}if(AB){p.sortType=D;p.stt=AB;}var m;if((q===L)||(q===D)){m=["","",p.elementList||"",p.axis];}else{m=[p.formId,"21","",p.axis];}m=[p.unitType,p.unitID].concat(m);p.sortKey=m.join("!");return p;},getSubTotalsPos:function Z(){var k=this.data.gts;if(k){return[k.rowSubPos,k.colSubPos];}return[0,0];},getPivotAction:function N(l,t){var n=false,m=l.hasOwnProperty("mix"),u=m?null:l.axis,q=(m?l.idx:l.ui)+1,AA=(l.otp===-1);if(!isNaN(t)){u=parseInt(t,10);q=1;if(m){m=false;AA=true;}}else{var y=(t==="u"||t==="l"||t==="b");if(!m){var o=H(this.data.gts,u),AC=0,AF={},k=false;mstrmojo.array.forEach(o,function(AG){if(AF[AG.id]){AF[AG.id].frm++;}else{AC++;AF[AG.id]={pos:AC,frm:1};if(AG.id===l.id){k=true;}else{if(k){return false;}}}});q=AF[l.id].pos;var z=l.fix;if(z){if((!y||z>1)&&!this.xtab.isOutlineMode){if(y||z!==AF[l.id].frm){q=z;n=true;}}}}else{var AD=H(this.data.gts,l.axis),x=AD[l.ui].es,s=this.data.gsi.mx;if(x.length!==s.length){var w=x[q+(y?-1:1)-1];if(w){var p=h.find(s,"did",w.oid);if(p!==-1){q=p+(y?1:-1)+1;}}}}if(t==="b"){q=1;}else{q=q+(y?-1:1);}}var AB={act:"pivot",unitPos:q};if(n){AB.attFormId=l.fid;}else{if(!m){AB.axis=u;}}if(!AA){var AE=m?l._e:l;if(!n){AB.unitType=AE.otp;}AB.unitId=m?AE.oid:l.id;}return AB;},isPvtButtonVisible:function f(s,m){var o=s.axis,n=H(this.data.gts,o),q=s.ui,l=s.hasOwnProperty("mix");if(m==="b"&&q===0){return false;}if(!isNaN(m)){if(parseInt(m,10)===o){return false;}if(l){return !!n[s.ui]._hid;}return true;}var p=n[s.ui].es,k=l?p.length:n.length;if(k===1){return false;}if(o===(l?U:j)){if(m==="u"||m==="d"){return false;}}else{if(m==="l"||m==="r"){return false;}}if(l?s._e===p[0]:q===0){if(m==="l"||m==="u"){return false;}}if(l?s._e===p[k-1]:(this.xtab.isOutlineMode&&s.fix)?J(q+1,s,n):q===k-1){if(m==="r"||m==="d"){return false;}}return true;},getDrillAction:function C(k,m){var l=m||this.getCellDrillsInfo(k[0]);return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,isWithin:l.within,drillPathKey:l.k,drillPathIndex:l.dpi,drillElements:R.call(this,k)};},isVis:function c(){if(this.xtab){return this.xtab.isVis&&this.xtab.isVis();}else{var k=this.controller&&this.controller.view;if(k&&k.isVis){return k.isVis();}}return false;},getPTitle:function i(m,l){var k;if(this.isVis()){k=m.titleInfo;}else{k=H(this.data.gts,l)[m.tui];}return k;},getPCellParentNode:function Q(m,l){var k;if(this.isVis()){k=(l===j)?m._lp:m._tp;}else{k=m._p;}return k;},getLinkAction:function V(m,l){var k,n;if(this.isVis()){m=m.node;n=m.titleInfo;}else{k=this.getCellTitleInfo(m,this.xtab.dataBlocks[m._gd]);n=k.title;}return this.getLinkActionImpl(m,n,l);},getLinkActionImpl:function a(y,t,w){var m=B(y,t),u=m&&m.links,z=(m&&m.onw)?"_blank":"";if(w===null||w===undefined){w=(m&&m.di)||0;}var p=u&&u[w];if(!p){return null;}var n={linkInfo:p,linkTarget:z};var k=p.url;if(k){var o="&CurrentElement";if(y&&t&&k.indexOf(o)>-1){k=k.replace(o,y._e.id);}n.url=k;}else{var q=p.target,x,l;switch(parseInt(q&&q.t,10)){case 55:if(parseInt(q.st,10)===14081){if(q.dvm&(8192|2048)&&!((q.dvm&2048&&mstrApp.features["run-vi-flash"]))){x=3140;if(mstrmojo.dom.isIE6||mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(15474,"To work with HTML5 dossiers, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}l="objectID";}else{x=2048001;l="documentID";}}else{x=32001;l="documentID";}break;case 3:x=4001;l="reportID";n.reportViewMode=((parseInt(q.st,10)===769)?2:1);break;default:return null;}n.evt=x;n[l]=q.did;n.srcMsgId=this.getMessageId();var s=d.call(this,m,p,y);if(s){n.link=s;}return n;}},getDownloadAction:function Y(n,l,p,m,o,k,q){return{xtabId:o,rowPosition:n,maxRows:l,colPosition:p,maxColumns:m,rowMode:q,memo:k};}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash","mstrmojo.array","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.mstr.EnumFunction");var l=mstrmojo.array,g=mstrmojo.mstr.EnumFunction;var N={"8107C31BDD9911D3B98100C04F2233EA":"Sum","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C32CDD9911D3B98100C04F2233EA":"Product",B2C0FA4020C711D6AD1400C04F0423DE:"Greatest","8107C330DD9911D3B98100C04F2233EA":"Var","8107C32FDD9911D3B98100C04F2233EA":"Stdev","8107C32DDD9911D3B98100C04F2233EA":"Median",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31CDD9911D3B98100C04F2233EA":"Count","8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",B2C0FA4120C711D6AD1400C04F0423DE:"Least"},Q={"8107C326DD9911D3B98100C04F2233EA":"Rank"},x={D221F90EB35540E3A1204ED6CC9A8267:"Avg",D221F90FB35540E3A1204ED6CC9A8267:"Count",D221F910B35540E3A1204ED6CC9A8267:"Max",D221F911B35540E3A1204ED6CC9A8267:"Min",D221F90DB35540E3A1204ED6CC9A8267:"Sum"},y={"8107C32ADD9911D3B98100C04F2233EA":"Avg","8107C350DD9911D3B98100C04F2233EA":"Count","8107C34BDD9911D3B98100C04F2233EA":"Max","8107C34CDD9911D3B98100C04F2233EA":"Min","8107C32BDD9911D3B98100C04F2233EA":"Sum"},p={"8107C329DD9911D3B98100C04F2233EA":"Avg","8107C354DD9911D3B98100C04F2233EA":"Count","8107C351DD9911D3B98100C04F2233EA":"Max","8107C352DD9911D3B98100C04F2233EA":"Min","8107C328DD9911D3B98100C04F2233EA":"Sum"},X={"8107C337DD9911D3B98100C04F2233EA":"Banding","8107C338DD9911D3B98100C04F2233EA":"BandingC","8107C339DD9911D3B98100C04F2233EA":"BandingP"},H={"8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31CDD9911D3B98100C04F2233EA":"Count",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C32DDD9911D3B98100C04F2233EA":"Median","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode","8107C32CDD9911D3B98100C04F2233EA":"Product","8107C32FDD9911D3B98100C04F2233EA":"Stdev","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31BDD9911D3B98100C04F2233EA":"Sum","8107C330DD9911D3B98100C04F2233EA":"Var",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",A202C23DDD9D11D3B98100C04F2233EA:"Fvschedule",A202C23CDD9D11D3B98100C04F2233EA:"IRR",A202C240DD9D11D3B98100C04F2233EA:"MIRR",A202C23EDD9D11D3B98100C04F2233EA:"NPV","8107C34ADD9911D3B98100C04F2233EA":"Percentile","9C374203DD9F11D3B98100C04F2233EA":"AvgDev","9C374228DD9F11D3B98100C04F2233EA":"ChiSquareTest","9C374225DD9F11D3B98100C04F2233EA":"Correlation","9C374224DD9F11D3B98100C04F2233EA":"Covariance","9C374237DD9F11D3B98100C04F2233EA":"ForecastV","9C37422FDD9F11D3B98100C04F2233EA":"FTest","9C374234DD9F11D3B98100C04F2233EA":"GrowthV","9C37422EDD9F11D3B98100C04F2233EA":"HeteroscedasticTTest","9C37422DDD9F11D3B98100C04F2233EA":"HomoscedasticTTest","9C37422ADD9F11D3B98100C04F2233EA":"Intercept","9C374204DD9F11D3B98100C04F2233EA":"Kurtosis","9C374222DD9F11D3B98100C04F2233EA":"MeanTTest","9C37422CDD9F11D3B98100C04F2233EA":"PairedTTest","9C374226DD9F11D3B98100C04F2233EA":"Pearson","9C374227DD9F11D3B98100C04F2233EA":"RSquare","9C374205DD9F11D3B98100C04F2233EA":"Skew","9C374229DD9F11D3B98100C04F2233EA":"Slope","9C37422BDD9F11D3B98100C04F2233EA":"SteYX","9C374231DD9F11D3B98100C04F2233EA":"TrendV","9C374223DD9F11D3B98100C04F2233EA":"VarTest","4A99DC7BC5254A319F6B8098E7D652C1":"ConcatAgg"},Z={AND283:"And",OR284:"Or",NOT285:"Not",IF305:"If"},n={BEGINSWITH279:"Begins with",ENDSWITH279:"Ends with",IN289:"In",BETWEEN290:"Between",CONTAINS291:"Contains",LIKE291:"Like"};function P(AD){var AB=function(AF,AE){return mstrmojo.array.stringSorter(AF.n,AE.n);},AC,AA;AD=AD.sort(AB);for(AC=0,AA=AD.length;AC<AA;AC++){AD[AC].fns=AD[AC].fns.sort(AB);}return AD;}function Y(AD,AE){var AA=AD.length,AC;for(AC=0;AC<AA;AC++){var AB=AD[AC].fns;if(mstrmojo.array.find(AB,"did",AE)>-1){return AC;}}return -1;}function M(AB){var AA=mstrApp&&mstrApp.useQuickSearch&&mstrApp.useQuickSearch();AB=mstrmojo.hash.copy(AB,{taskId:"searchMetadata",recursive:true,styleName:"MojoFolderStyle",includeObjectDesc:true,includeAncestorInfo:false});if(AA){AB.quickSearch=AA;AB.nameWildcards=16;AB.sortKey=-1;}return AB;}function I(AB,AA){if(mstrApp.serverRequest){mstrApp.serverRequest(AA,AB);}else{window.$MAPF=function(){return false;};this.getServerProxy().request(AB,AA,false,{});}}mstrmojo.ME.MetricDataService=mstrmojo.provide("mstrmojo.ME.MetricDataService",{rootFolderTypes:{ALL:39,FILTERS:4,METRICS:5,FACTS:29,SCHEMA:24,ATTRIBUTES:26,TRANSFORMATIONS:38},blockCount:10,suggestCount:10,suggestDelay:200,noCache:true,functions:null,metricComponents:null,functionsDetails:null,getServerProxy:function F(){if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}return this.serverProxy;},getMetricDefintion:function S(AC,AA){var AB={taskId:"getMetricDefinition",metricId:AC.id,outputFlags:65599};if(AC.msgID){AB.msgID=AC.msgID;}I.call(this,AA,AB);},validateMetric:function e(AC,AA){var AB={taskId:"validateMetric",metricId:AC.metricId,tokenStreamXML:AC.tokenStreamXML,metricXML:AC.metricXML,outputFlags:327695};if(mstrmojo.string.isEmpty(AC.metricId)){AB.isNew=true;}if(AC.msgID){AB.msgID=AC.msgID;}if(AC.formID){AB.frmid=AC.formID;}if(AC.isIDForm){AB.isIDForm=AC.isIDForm;}if(AC.objectType){AB.objectType=AC.objectType;}I.call(this,AA,AB);},getMetricComponents:function B(AE,AB){var AA=this,AC=this.metricComponents;if(!this.noCache&&AC&&AC.items.length==AC.sz){AB.success(AC);return ;}AB.success=mstrmojo.func.composite([AB.success,function(AF){if(AA.metricComponents&&AA.metricComponents.items){AA.metricComponents.items.push(AF.items);}else{AA.metricComponents=AF;}}]);var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||24,objectType:AE.objectType||"12,13,43"});I.call(this,AB,AD);},getAttributes:function R(AC,AA){var AB=M({blockBegin:AC.blockBegin,blockCount:AC.blockCount,searchPattern:AC.pattern,rootFolderType:AC.rootFolderType||26,objectType:12});I.call(this,AA,AB);},getFacts:function L(AC,AA){var AB=M({blockBegin:AC.blockBegin,blockCount:AC.blockCount,searchPattern:AC.pattern,rootFolderType:AC.rootFolderType||29,objectType:13});I.call(this,AA,AB);},getMetrics:function G(AC,AA){var AB=M({blockBegin:AC.blockBegin,blockCount:AC.blockCount,searchPattern:AC.pattern,rootFolderType:AC.rootFolderType||5,objectType:4});if(AC.isVerify){AB.nameWildcards=2;}I.call(this,AA,AB);},getFunctions:function U(AF){var AH=this,AI=window.sessionStorage,AE=this.functions||(AI&&AI.getItem("functions")),AG=AI&&AI.getItem("mstrLocaleId"),AC=mstrApp&&mstrApp.localeId;if(AE&&AG==AC){AE=P(JSON.parse(AE).fncs);AF.success(AE);}else{var AB={failure:AF.failure,textResponse:true},AD={taskId:"getSystemFunctions",includeFunctionDetails:true,functionFlags:2|2147483648,includeFunctionHelpTopic:true};var AA=function(AJ){l.forEach(AJ,function(AL){var AK=AL&&AL.fns;l.forEach(AK,function(AN){var AM=AN.pros;var AO=l.filterOne(AM,function(AP){return AP.n==="UseLookupForAttributes";});if(AO){AO.dfv="0";}});});};AB.success=function(AJ){if(typeof AJ==="string"||!mstrApp.isSingleTier){AJ=AJ.replace(/\\'/g,"'");var AL=JSON.parse(AJ),AK=AL.fncs;AA(AK);AJ=JSON.stringify(AL);if(AI){AI.setItem("functions",AJ);AI.setItem("mstrLocaleId",AC);}AH.functions=AJ;AE=P(JSON.parse(AJ).fncs);}else{AA(AJ.fncs);AE=P(AJ.fncs);AH.functions=JSON.stringify(AJ);}AF.success(AE);};I.call(this,AB,AD);}},getAggFunctions:function C(){if(this._aggFunctions){return this._aggFunctions;}var AA=this.parseFuncStr();AA=mstrmojo.array.filter(AA[this.getBasicCategoryIndex(AA)].fns,function(AC){var AB=AC.did,AD;if(AB!=="B2C0FA4020C711D6AD1400C04F0423DE"&&AB!=="B2C0FA4120C711D6AD1400C04F0423DE"){AD=N[AB];}return AD;});return AA;},getOLAPAggFunctions:function E(AA){var AB=this.parseFuncStr();AB=mstrmojo.array.filter(AB[this.getOLAPCategoryIndex(AB)].fns,function(AC){switch(AA){case"moving":return y[AC.did];case"running":return p[AC.did];case"olap":default:return x[AC.did];}return false;});return AB;},getFunctionCatList:function s(){if(this._functionCatList){return this._functionCatList;}var AA=this.parseFuncStr();AA=mstrmojo.hash.make(AA,mstrmojo.Arr);this._functionCatList=AA;return AA;},getCategoryIndex:function q(AB,AA){return Y(AA||this.getFunctionCatList(),AB);},getBasicCategoryIndex:function J(AB){var AA="B2C0FA4020C711D6AD1400C04F0423DE";return Y(AB||this.getFunctionCatList(),AA);},getDataMiningCatIndex:function j(AA){var AB="F17CD4F3FF134D91B80DDAB9CA73C919";return Y(AA||this.getFunctionCatList(),AB);},getDateTimeCategoryIndex:function w(AB){var AA="C50F2A4F75AE49D6B20E00224967B500";return Y(AB||this.getFunctionCatList(),AA);},getStringCategoryIndex:function h(AB){var AA="6F7DF5FF449111D5BEA300B0D01A55EF";return Y(AB||this.getFunctionCatList(),AA);},getOLAPCategoryIndex:function J(AB){var AA="D221F90EB35540E3A1204ED6CC9A8267";return Y(AB||this.getFunctionCatList(),AA);},getInternalCategoryIndex:function V(AB){var AA="8107C337DD9911D3B98100C04F2233EA";return Y(AB||this.getFunctionCatList(),AA);},getFunctionDetails:function t(AC,AA){var AB={taskId:"getSystemFunctions",functionId:AC.did,includeFunctionDetails:true,includeFunctionHelpTopic:true};I.call(this,AA,AB);},getTransformations:function O(AC,AA){var AB=M({blockBegin:AC.blockBegin,blockCount:AC.blockCount,searchPattern:AC.pattern,rootFolderType:AC.rootFolderType||38,objectType:43});I.call(this,AA,AB);},getFilters:function k(AC,AA){var AB=M({blockBegin:AC.blockBegin,blockCount:AC.blockCount,searchPattern:AC.pattern,rootFolderType:AC.rootFolderType||4,objectType:1});I.call(this,AA,AB);},getAttributeForms:function f(AC,AA){var AB={taskId:"getAttributeForms",attributeID:AC.attributeID,displayedForms:AC.displayedForms,styleName:"WidgetElementListStyle"};I.call(this,AA,AB);},getSubtotalFunctions:function W(AC,AA){var AB=M({objectType:"1025,1026",searchPattern:""});I.call(this,AA,AB);},isBasicAggMap:function m(AA){var AB=!!N[AA];if(AA==="B2C0FA4020C711D6AD1400C04F0423DE"||AA==="B2C0FA4120C711D6AD1400C04F0423DE"){AB=false;}return AB;},isOLAPAgg:function z(AA){return !!x[AA];},isMovingAgg:function a(AA){return !!y[AA];},isRunningAgg:function d(AA){return !!p[AA];},isBanding:function i(AA){return !!X[AA];},isOLAP:function K(AB){var AC=this.getFunctionCatList(),AA=AC[this.getOLAPCategoryIndex(AC)].fns;return mstrmojo.array.find(AA,"did",AB)>-1;},isRank:function D(AA){return !!Q[AA];},isScalar:function c(AA){return(AA||{}).sqt===3;},hasLookupForAttributesProps:function(AA){return !!H[AA];},getFunctionHelpTopic:function o(AA){var AB="<div class='func-details' onclick='mstrmojo.ME.MetricDataService.showFunctionHelpTopic(\"##HELPTOPIC##\")'>"+mstrmojo.desc(5811,"Details...")+"</div>";AB=AB.replace("##HELPTOPIC##",AA);return AB;},showFunctionHelpTopic:function u(AB){var AC=mstrApp.isSingleTier,AA=((mstrApp.helpUrl||"../help/")+"FunctionsRef/");if(AC){AA=AA+"index.htm#cshid="+(AB||"");window.FormWrapper.openPage(AA);}else{if(AB){AA=AA+"Content/"+AB+".htm";}else{AA=AA+"index.htm";}window.open(AA);}return false;},sortFunctions:function A(AB){var AC={},AA=function(AE,AD){return mstrmojo.array.stringSorter(AE.n,AD.n);};mstrmojo.array.forEach(AB,function(AD){mstrmojo.array.forEach(AD&&AD.fns,function(AE){if(AE&&AE.did){AC[AE.did]=AE;}});});return mstrmojo.hash.valarray(AC).sort(AA);},parseFuncStr:function b(){var AA=window.sessionStorage,AB=this.functions||AA&&AA.getItem("functions");if(AB){return P(JSON.parse(AB).fncs);}},isValEqual:function(AD,AC){if(AD===AC){return true;}var AA=[-1,"-1","True",true],AB=[0,"0","False",false];if(AA.indexOf(AD)>-1&&AA.indexOf(AC)>-1){return true;}else{if(AB.indexOf(AD)>-1&&AB.indexOf(AC)>-1){return true;}}return false;},isFuncHasUseLookupForAttributeProp:function(AB){var AA=[g.FunctionSum,g.FunctionCount,g.FunctionAvg,g.FunctionMin,g.FunctionMax,g.FunctionProduct,g.FunctionMedian,g.FunctionMode,g.FunctionStdev,g.FunctionVar,g.FunctionGeomean,g.FunctionPercentile,g.FunctionStdevP,g.FunctionVarP,g.FunctionFirst,g.FunctionLast,g.ConcatAgg];return AA.indexOf(AB)>-1;},isLogicOrCompFunc:function(AB){var AA=AB.v.toUpperCase()+AB.tp;return !!Z[AA]||!!n[AA];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.locales","mstrmojo.date","mstrmojo.DI.DIConstants","mstrmojo.DI.DIDatabaseHelper");mstrmojo.requiresDescs(2052,2170,2265,3434,3544,4530,4699,8002,8984,9614,9919,9920,9921,9922,12491,12492,12493,12494,12495,12509,12771,13031,13131,13132,13980,13981,8536);var V=mstrmojo.DI.DIConstants,P=V.dataTypeMenuItems,M=V.rdcsFlag,D="MSTR.DI",E=mstrmojo.dom,K=mstrmojo.array;mstrmojo.DI.DIHelpers=mstrmojo.declare(mstrmojo.Obj,null,null);mstrmojo.DI.DIHelpers.isIE7=function O(){return mstrmojo.dom.isIE7;};mstrmojo.DI.DIHelpers.isIE=function(){return E.isIE||!!E.userAgent.match(/Trident\/7\.0/);};mstrmojo.DI.DIHelpers.isIEOrEdge=function(){return mstrmojo.dom.isEdge||this.isIE();};mstrmojo.DI.DIHelpers.getURLCaption=function(){var W="";if(mstrApp.diParams&&mstrApp.diParams.EnableURLImport){if(mstrApp.diParams.EnableFileImport){if(mstrApp.isSingleTier){if(window.FormWrapper!==window.client){W+="File://";}}else{W+="File://";}}if(mstrApp.diParams.EnableHttpImport){if(W!==""){W+=", ";}W+="Http://, Https://";}if(mstrApp.diParams.EnableFTPImport){if(W!==""){W+=", ";}W+="Ftp://";}}return W;};mstrmojo.DI.DIHelpers.getUrlTooltip=function C(){var W="";if(!mstrApp.diParams){return W;}if(!mstrApp.diParams.EnableURLImport){W=mstrmojo.desc(12491,"URL file uploads are currently disabled. Please contact your administrator.");}else{W=mstrmojo.desc(12492,"Use one of the following URL formats to upload your file:")+" ";W+=mstrmojo.DI.DIHelpers.getURLCaption();if(mstrApp.enableFileImport){W+="\r\r";W+=mstrmojo.desc(12493,"'File://' format allows you to upload files in your local machine. For example: File://ComputerName/path/FileName.");}if(mstrApp.enableHttpImport||mstrApp.enableHttpsImport){W+="\r\r";if(mstrApp.enableFileImport){W+=mstrmojo.desc(12494,"Some other examples are:");}else{W+=mstrmojo.desc(12495,"Some examples are:");}}if(mstrApp.enableHttpImport){W+="\r";W+="http://host/path/FileName";W+="\r";W+="https://user:password@host/path/FileName";}if(mstrApp.enableFtpImport){W+="\r";W+="ftp://user:password@host/path/FileName";W+="\r";W+="ftp://user:password@host:port/path/FileName";}}return W;};mstrmojo.DI.DIHelpers.createMSTRObjects=function(Y,a){var W,Z,X;if(Y.constructor===Array){W=Y;for(X=0;X<W.length;X++){W[X]=mstrmojo.DI.DIHelpers.createMSTRObjects(Y[X],a);}}else{if(typeof Y==="object"){W=new mstrmojo.Obj(Y);for(Z in Y){if(!a||a.indexOf(Z)===-1){if(Y.hasOwnProperty(Z)){W.set(Z,mstrmojo.DI.DIHelpers.createMSTRObjects(Y[Z],a));}}}}else{W=Y;}}return W;};mstrmojo.DI.DIHelpers.getURLParameters=function(W){var X;var a;var Z=[];if(W){if(W.indexOf("?")>0){W=W.substr(W.indexOf("?")+1);}a=W.split("&");for(X=0;X<a.length;X++){var Y=a[X].split("=");if(Y.length===2){Z[Y[0]]=Y[1];}}}return Z;};mstrmojo.DI.DIHelpers.getBackendSourceType=function(W){var X=V.backendSourceSubtype.localFile;switch(W){case V.sourceSubtype.dropbox:X=V.backendSourceSubtype.dropbox;break;case V.sourceSubtype.bisource:X=V.backendSourceSubtype.bISources;break;case V.sourceSubtype.clipboard:X=V.backendSourceSubtype.clipboard;break;case V.sourceSubtype.facebook:X=V.backendSourceSubtype.facebook;break;case V.sourceSubtype.googleAnalytics:X=V.backendSourceSubtype.googleAnalytics;break;case V.sourceSubtype.googleBigQuery:X=V.backendSourceSubtype.googleBigQuery;break;case V.sourceSubtype.googleBigQueryFFSQL:X=V.backendSourceSubtype.googleBigQueryFFSQLModel;break;case V.sourceSubtype.googleBigQuerySingleTable:X=V.backendSourceSubtype.googleBigQuerySingleTable;break;case V.sourceSubtype.googleDrive:X=V.backendSourceSubtype.googleDrive;break;case V.sourceSubtype.hadoop:X=V.backendSourceSubtype.hadoopFileBrowser;break;case V.sourceSubtype.localFile:X=V.backendSourceSubtype.localFile;break;case V.sourceSubtype.mdx:X=V.backendSourceSubtype.OLAPSources;break;case V.sourceSubtype.salesforce:X=V.backendSourceSubtype.salesforce;break;case V.sourceSubtype.samplefile:X=V.backendSourceSubtype.samplefile;break;case V.sourceSubtype.searchOnSource:X=V.backendSourceSubtype.searchAsASource;break;case V.sourceSubtype.twitter:X=V.backendSourceSubtype.twitter;break;case V.sourceSubtype.url:X=V.backendSourceSubtype.url;break;case V.sourceSubtype.publicData:X=V.backendSourceSubtype.publicData;break;case V.sourceSubtype.cloudElement:X=V.backendSourceSubtype.cloudElement;break;}return X;};mstrmojo.DI.DIHelpers.getStateParameters=function(X){var W;var a;var Y=[];if(X.indexOf(":")>=0){a=X.split(":");}else{a=X.split("%3A");}for(W=0;W<a.length;W++){var Z=a[W];if(Z.substr(2,1)==="_"){Y[Z.substr(0,2)]=Z.substr(3);}}return Y;};mstrmojo.DI.DIHelpers.getExtensionType=function(Y){var X=Y.toLowerCase(),W;if(X===".xls"||X===".xlsx"||X===".xlsm"){W=V.xdaType.excel;}else{if(X===".txt"||X===".csv"||X===".tsv"||X===".prn"){W=V.xdaType.text;}else{W=0;}}return W;};mstrmojo.DI.DIHelpers.setTablesrc=function(W,Y,X){if(Y){if(!W.tablesSrc[Y]){W.tablesSrc[Y]=[];}W.tablesSrc[Y].push(X);}};function U(W){var Y={0:2,1:2,2:2,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:2,12:2,13:2,14:8,15:9,16:1,17:3,18:3,21:2,22:2,23:3,30:11,31:2,33:3,34:2},b={1:V.columnDataTypes.integer,2:V.columnDataTypes.integer,6:V.columnDataTypes.dtdouble,7:V.columnDataTypes.dtfloat,21:V.columnDataTypes.integer,22:V.columnDataTypes.nlong,30:V.columnDataTypes.bigDecimal,34:V.columnDataTypes.int64},X=Y[W],a=b[W],Z="";switch(X.toString()){case V.dataTypeMenuItems.NUMBER:switch(a){case V.columnDataTypes.integer:Z=mstrmojo.desc(9614,"Integer");break;case V.columnDataTypes.nlong:Z=mstrmojo.desc(13131,"Long");break;case V.columnDataTypes.int64:Z=mstrmojo.desc(13132,"Big Integer");break;case V.columnDataTypes.dtfloat:Z=mstrmojo.desc(8002,"Float");break;case V.columnDataTypes.dtdouble:Z=mstrmojo.desc(2265,"Double");break;case V.columnDataTypes.bigDecimal:Z=mstrmojo.desc(9920,"Big Decimal");break;default:Z=mstrmojo.desc(3434,"Number");break;}break;case V.dataTypeMenuItems.DATE:Z=mstrmojo.desc(2052,"Date");break;case V.dataTypeMenuItems.DATE_TIME:Z=mstrmojo.desc(9919,"DateTime");break;case V.dataTypeMenuItems.TIME:Z=mstrmojo.desc(2170,"Time");break;case V.dataTypeMenuItems.TEXT:Z=mstrmojo.desc(3544,"Text");break;case V.dataTypeMenuItems.HTML_TAG:Z=mstrmojo.desc(9921,"HTML Tag");break;case V.dataTypeMenuItems.PHONE_NUMBER:Z=mstrmojo.desc(8984,"Phone Number");break;case V.dataTypeMenuItems.SYMBOL:Z=mstrmojo.desc(4530,"Symbol");break;case V.dataTypeMenuItems.URL:Z=mstrmojo.desc(9922,"URL");break;case V.dataTypeMenuItems.EMAIL:Z=mstrmojo.desc(4699,"Email");break;}return Z;}mstrmojo.DI.DIHelpers.getDataTypeString=U;mstrmojo.DI.DIHelpers.parseAlternateSourceValidationResults=function N(e){var c=[],a,b,d,f,W,Y,Z,X;K.forEach(e,function(g){a=b=d=f="";Y=(g.vt===3)?1:0;switch(g.vt){case 0:case 1:case 2:case 3:a=g.n;b=U(g.ddt);W=g.src;d=W.n;f=U(W.ddt);break;case 4:a=g.n;b=U(g.ddt);break;case 8:W=g.src;d=W.n;f=U(W.ddt);break;}Z=b?a+"("+b+")":a;X=f?d+"("+f+")":d;c.push([Z,Y,X]);});return c;};mstrmojo.DI.DIHelpers.getURLFileName=function(X){var W=X.lastIndexOf("/");return W>=0&&W+1!==X.length?X.substr(W+1):X;};mstrmojo.DI.DIHelpers.isOperationMode=function(W){return W!==undefined&&W!==null;};mstrmojo.DI.DIHelpers.isCtrlKey=function(W,Y){var X=Y||(W||window).event;return X.ctrlKey||X.metaKey;};mstrmojo.DI.DIHelpers.isRefreshable=function(X){var W,Y=0;for(W in X.importSources){var Z=X.importSources[W];if(Z.type===V.sourceType.file&&(Z.subtype===V.sourceSubtype.url||Z.subtype===V.sourceSubtype.publicData)){if(!Z.sourceInfo||Z.sourceInfo.url.indexOf("http://mirror.microstrategy.com/datahub/samples")!==0){Y++;}}}if(X.getAllTableID().length===Y&&!mstrApp.diParams.EnableHttpImport&&!mstrApp.diParams.EnableFTPImport&&!mstrApp.diParams.EnableFileImport&&!mstrApp.diParams.EnableURLImport){return false;}return true;};mstrmojo.DI.DIHelpers.strStartsWith=function(X,W){return X.indexOf(W)===0;};mstrmojo.DI.DIHelpers.adjustDataIdx=function(Z,Y){var W=[],X;if(!Z||Z.length===0){return ;}K.forEach(Z,function(a){X=a.subColumns;if(X&&X.length>1){W=W.concat(X);}else{W.push(a);}});W.sort(function(d,c){return d[Y]-c[Y];});};mstrmojo.DI.DIHelpers.setDataIdx=function(Y,X,W){if(!X||X.length===0){return ;}if(X[0].hasOwnProperty("clix")){K.forEach(Y,function(a){var Z=a.ix;a[W]=K.find(X,"clix",Z);if(a.isMultiForm){K.forEach(a.subColumns,function(b){b[W]=K.find(X,"clix",b.ix);});}});}if(X[0].hasOwnProperty("did")){K.forEach(Y,function(b){var a=b.did;var Z=K.find(X,"did",a);if(Z!==-1){b[W]=Z;}if(b.isMultiForm){K.forEach(b.subColumns,function(c){Z=K.find(X,"did",c.did);if(Z!==-1){c[W]=Z;}});}});}};mstrmojo.DI.DIHelpers.encodeData=function(W){var X="";if(W!==undefined){if(typeof W==="number"){X=W;}else{X=mstrmojo.string.encodeHtmlString(W,false,true);}}return X;};var F={0:"Bytes",1:"KB",2:"MB",3:"GB",4:"TB",5:"PB"};function Q(W){return F[W]||"unknown";}mstrmojo.DI.DIHelpers.getRoundSize=function J(X){var W;for(W=0;(X/1024)>1;W++){X=X/1024;}X=X.toPrecision(3);return X+Q(W);};mstrmojo.DI.DIHelpers.findNewElements=function(Y,Z){var X=[],W;if(Y&&Y.length){K.forEach(Z,function(a){W=K.indexOf(Y,a);if(W===-1){X.push(a);}});}else{if(Z&&Z.length){X=[].concat(Z);}}return X;};mstrmojo.DI.DIHelpers.generateCubeName=function(X){var W,Y,Z=50;W=X.join(" ");if(W.length>Z){W=W.slice(0,Z)+"...";}Y=X.length;if(Y>1){W+=" ("+Y+" tables)";}return W;};mstrmojo.DI.DIHelpers.parseValidateSourceResults=function(X){var W={isValidate:true,hasError:false,tbids:[],tableValidate:[],missingColumnTbids:[],mismatchedDatatypeTbids:[],missingTableTbids:[],errorTableTbids:[],missingColumns:{},mismatchedDatatypeColumns:{},missingTablesColumns:{},errorTableErrCode:{},errorTableErrMsg:{}},Y=X&&X.vts;K.forEach(Y,function(g){var Z=g.tbid,h=g.vt,b=g.emsg,e=g.cols||[],a=true,f=false,d,i=[],c=[];if(h===1){a=true;}else{switch(h){case V.backendError.switchingFileType:case V.backendError.noExternalSession:case V.backendError.databaseCredentialsNotAvailable:case V.backendError.CECredentialNotAvailable:case V.backendError.AuthenticationError:case V.backendError.shouldBeIgnored:f=true;break;}K.forEach(e,function(j){var k=j.vt;switch(k){case 1:c.push(j);break;case 4:i.push(j);break;}});}if(f){W.errorTableTbids.push(Z);W.errorTableErrCode[Z]=h;W.errorTableErrMsg[Z]=b;W.isValidate=false;W.hasError=true;}d=i.length>0&&i.length===e.length;if(i.length>0||c.length>0){a=false;}else{a=true;}if(a===false){W.isValidate=false;}W.tbids.push(Z);W.tableValidate.push(a);if(i.length>0){if(d){W.missingTableTbids.push(Z);W.missingTablesColumns[Z]=i;}else{W.missingColumnTbids.push(Z);W.missingColumns[Z]=i;}}if(c.length>0){W.mismatchedDatatypeTbids.push(Z);W.mismatchedDatatypeColumns[Z]=c;}});return W;};mstrmojo.DI.DIHelpers.truncate=function(Y,a,W){if(Y&&Y.length>a){var c=3,X=a-c,b=Math.ceil(X/2),Z=Math.floor(X/2);if(W){return Y.substr(0,X)+"...";}else{return Y.substr(0,b)+"..."+Y.substr(Y.length-Z);}}else{return Y;}};mstrmojo.DI.DIHelpers.getAbsoluteFileName=function(W){var X,Y=W.lastIndexOf("\\");if(Y===-1){Y=W.lastIndexOf("/");}X=W.substring(Y+1,W.length);return X;};mstrmojo.DI.DIHelpers.reevaluatePopupPosition=function(W){if(W){var X=W.style,a=X.display,Z=X.left,Y=X.top;X.display="block";if(parseInt(Z.substring(0,Z.length-2))<0){X.left="0px";}if(parseInt(Y.substring(0,Y.length-2))<0){X.top="0px";}X.display=a;}};mstrmojo.DI.DIHelpers.expandNode=function(X){var W=X.visible;X.set("visible",!W);return !W;};mstrmojo.DI.DIHelpers.normalizeTimestamp=function(Y){var X=Y.replace(/-/g,"/");var W=X.indexOf(".");if(W>0){X=X.substring(0,W);}return X;};mstrmojo.DI.DIHelpers.getBackendErrorStr=function(X,W){var Y="";switch(X){case V.backendError.switchingFileType:Y=mstrmojo.desc(12509,"Switching the file type is not allowed during republishing or editing the cube.");break;case V.backendError.noExternalSession:case V.backendError.databaseCredentialsNotAvailable:case V.backendError.CECredentialNotAvailable:case V.backendError.AuthenticationError:Y=mstrmojo.desc(14392,"We do not have the credentials needed to get the data for this table. Please provide the credentials to proceed publishing this table.");break;}return Y;};mstrmojo.DI.DIHelpers.getCommonElements=function(Z,b,a){var X=[],Y,W;for(Y=0;Z&&Y<Z.length;Y++){for(W=0;b&&W<b.length;W++){if(a(Z[Y],b[W])){X.push(Z[Y]);break;}}}return X;};mstrmojo.DI.DIHelpers.formatDateAndTime=function(e,Z){var d=mstrmojo.date;var X=mstrmojo.locales;var Y,f,c,b,W,a;Y=d.parseDateAndOrTime(e);f=Y.date;c=Y.time;if(Z){a=new Date(Date.UTC(f.year,f.month-1,f.day,c.hour,c.min,c.sec));Y=d.getDateJson(a);f=Y;c=Y;}b=d.formatDateInfo(f,X.datetime.DATEDISPLAYFORMAT);W=d.formatTimeInfo(c,X.datetime.TIMEDISPLAYFORMAT);return b+" "+W;};mstrmojo.DI.DIHelpers.isServerBasedWS=function(){return !!mstrApp.isWorkstation&&!mstrApp.isSingleTier;};mstrmojo.DI.DIHelpers.isLocalWS=function(){return !!mstrApp.isWorkstation&&!!mstrApp.isSingleTier;};mstrmojo.DI.DIHelpers.isDIinVI=function(){return !!mstrApp.isWorkstation&&!!mstrApp.isSingleTier&&!!mstrApp.isPopup;};mstrmojo.DI.DIHelpers.extractFileNameFromHadoopURL=function(X){if(!X){return"";}var W,Y;W=X.lastIndexOf("/")+1;Y=X.substring(W);return Y;};mstrmojo.DI.DIHelpers.extractFileExtensionFromHadoopURL=function(X){if(!X){return"";}var W,Y;W=X.lastIndexOf("/")+1;Y=X.substring(W);return Y.substring(Y.lastIndexOf(".")+1);};mstrmojo.DI.DIHelpers.isWS=function(){return !!mstrApp.isWorkstation;};mstrmojo.DI.DIHelpers.getEnvObj=function(){var Z=(navigator.platform.indexOf("Win")!==-1?"Win":"Mac"),W=!!mstrApp.isWorkstation?"WS":"Web",X=[];X.push(W,Z);return{ENV:X.join("-"),isWSClient:function(){if(!window.FormWrapper||!window.FormWrapper.isDesktop){return false;}return !window.FormWrapper.isDesktop();},isDesktopClient:function(){if(!window.FormWrapper||!window.FormWrapper.isDesktop){return false;}return window.FormWrapper.isDesktop();},isWeb:function(){return W==="Web";},isWS:function(){return W==="WS";},isWin:function(){return Z==="Win";},isMac:function(){return Z==="Mac";},isDataSet:function(){return mstrApp.placeholder==="DIApp"||mstrApp.placeholder==="mainDIApp"||mstrApp.placeholder==="QBApp";},isDIinVI:function(){return !!mstrApp.isFromVI;},isInDI:function(){return mstrApp.placeholder==="DIApp"||mstrApp.placeholder==="mainDIApp";},isInQB:function(){return mstrApp.placeholder==="QBApp";},isAppSchema:function(){return !!window.mstrAppSchema;},isAppSchemaWS:function(){return this.isAppSchema()&&this.isWS();},isWebWin:function(){return this.isWeb()&&this.isWin();},isWebMac:function(){return this.isWeb()&&this.isMac();},isWebDataSet:function(){return this.isWeb()&&this.isDataSet();},isWebDossier:function(){return this.isWeb()&&this.isDIinVI();},isWSWin:function(){return this.isWS()&&this.isWin();},isWSMac:function(){return this.isWS()&&this.isMac();},isWSDataSet:function(){return this.isWS()&&this.isDataSet();},isServerBasedWS:mstrmojo.DI.DIHelpers.isServerBasedWS,isWSDossier:function(){return this.isWS()&&this.isDIinVI();},isWSLiveMode:function Y(){return this.isWS()&&window.FormWrapper&&window.FormWrapper.isWSLiveMode&&parseInt(window.FormWrapper.isWSLiveMode(),10)===1;},isWSDossierLocalMode:function(){return this.isWSDossier()&&!this.isWSLiveMode();},isWebWinDataSet:function(){return this.isWeb()&&this.isWin()&&this.isDataSet();},isWebMacDataSet:function(){return this.isWeb()&&this.isMac()&&this.isDataSet();},isWebWinDossier:function(){return this.isWeb()&&this.isWin()&&this.isDIinVI();},isWebMacDossier:function(){return this.isWeb()&&this.isMac()&&this.isDIinVI();},isWSWinDataSet:function(){return this.isWS()&&this.isWin()&&this.isDataSet();},isWSMacDataSet:function(){return this.isWS()&&this.isMac()&&this.isDataSet();},isWSWinDossier:function(){return this.isWS()&&this.isWin()&&this.isDIinVI();},isWSMacDossier:function(){return this.isWS()&&this.isMac()&&this.isDIinVI();},isStandaloneDataSet:function(){return !this.isDIinVI()&&this.isDataSet();}};};mstrmojo.DI.DIHelpers.isOnetier=function(){return !!mstrApp.isSingleTier;};mstrmojo.DI.DIHelpers.getHierarchyMappingXML=function(b,c){var Y="";var X=0,Z=1,a=12;if(c&&c[M.ID]){Y+="<mpcs>";Y+="<mpc ";Y+='did="'+c[M.ID].did+'" drvflg="'+X+(c[M.ID].n?('" n="'+c[M.ID].n+'" ot="'):"")+a+'" recurisve="'+Z+'" ';if(!!b&&b!==""){Y+='oid="'+b+'" ';}Y+=">";if(c[M.JOIN_ID]){Y+="<rdcs>";}for(var W=M.JOIN_ID;W<=M.DISTANCE;W++){if(c[W]!==undefined){Y+='<rdc did="'+c[W].did+'" fg="'+W+'"/>';}}if(c[M.JOIN_ID]){Y+="</rdcs>";}Y+="</mpc>";Y+="</mpcs>";}return Y;};mstrmojo.DI.DIHelpers.getOperationMode=function(){return mstrApp.getRootController().getModel().operationMode;};mstrmojo.DI.DIHelpers.standardizeDBRolesFormat=function R(e){var Y=["att","dbRole","tableMap"],f,h,b,W=[],Z,X,c,a,g,i,d=(function(){var j="list",l="number",k="text";function m(n,t,s,q,p,o){if(n&&s){if(o){n.push({field:t,fieldV:s,IDS:q,options:o,tp:p});}else{n.push({field:t,fieldV:s,IDS:q,tp:p});}}}return{authenticationmethod:function(n,o){m(n,"auth",o,7776,j,[{IDS:13980,n:mstrmojo.desc(13980),v:"1"},{IDS:13981,n:mstrmojo.desc(13981),v:"4"}]);},databasename:function(n,o){m(n,"db",o,8519,k);},hostname:function(n,o){m(n,"host",o,8533,k);},port:function(n,o){m(n,"port",o,8534,l);},server:function(n,o){m(n,"svr",o,8536,k);}};}());e=Object.keys(e).map(function(j){return mstrmojo.DI.DIHelpers.createMSTRObjects(e[j],Y);});K.forEach(e,function(j){K.forEach(j.tables,function(k){k.dbRole=(k.dbRole&&k.dbRole.oi)||k.dbRole;k.dbmsObj=k.dbmsObj&&k.dbmsObj.oi;h=k.dbRole;if(h){h.dbmsObj=k.dbmsObj;b=h.dbmsObj;if(!h.dbms){h.dbms=h.def&&h.def.dbms&&h.def.dbms.did;}}if(!b||b.DBInfo){return ;}b.DBInfo={};f=b.DBInfo;if(h.efd&&h.efd.length>0){W=h.efd;}else{if(h.def&&h.def.ddbc){W.push(h.def.ddbc);}else{if(h.def&&h.def.ddbcc){W=h.def.ddbcc;}else{return ;}}}W.forEach(function(l){Z=l.oi&&l.oi.def;if(!Z){return ;}i=Z.dbtp;if(i){h.db_type=i;f.dbTypes={dbt:{v:i,n:mstrmojo.desc(mstrmojo.DI.DIDatabaseHelper.getDescriptionIdByDBType(i))}};}X=Z.cnsr;if(!X){return ;}g=[];a=null;h.connstr=X;X.split(";").forEach(function(m){c=m.split("=");c[0]=c[0].toLowerCase().trim();if(c[0]==="driver"){f.driverInstalled=true;}else{if(c[0]==="authenticationmethod"){a=c;}else{if(d[c[0]]){d[c[0]](g,c[1]);}}}});if(a){d[a[0]](g,a[1]);}});});});return e;};mstrmojo.DI.DIHelpers.filterDisableSources=function A(W){return K.indexOf(mstrApp.diParams.disabledSources,W)<0;};mstrmojo.DI.DIHelpers.getPopupWindowOptions=function S(){var a={};var Y=window.screenX||window.screenLeft||0,X=window.screenY||window.screenTop||0,Z=800,W=600,b;if(document.body&&document.body.offsetWidth){Z=document.body.offsetWidth;W=document.body.offsetHeight;}if(document.compatMode==="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){Z=document.documentElement.offsetWidth;W=document.documentElement.offsetHeight;}if(window.innerWidth&&window.innerHeight){Z=window.innerWidth;W=window.innerHeight;}if(window.outerWidth){Z=window.outerWidth;}if(window.outerHeight){W=window.outerHeight;}a.height=W*0.5;a.width=Z*0.8;if(a.height<600||isNaN(a.height)){a.height=600;}if(a.width<800||isNaN(a.width)){a.width=800;}a.left=Y+(Z-a.width)/2;a.top=X+(W-a.height)/8;if(this.getEnvObj().isWSWin()&&this.getEnvObj().isDIinVI()){a.left=(window.screen.width-a.width)/2;a.top=(window.screen.height-a.height)/2;}b="width="+a.width+",height="+a.height;b+=",toolbar=0,scrollbars=1,status=1,resizable=1,location=1,menuBar=0";b+=",left="+a.left+",top="+a.top;return b;};mstrmojo.DI.DIHelpers.createPopupWindow=function H(X,W){var Y,Z;Z=this.getPopupWindowOptions();if(!X){X="";}Y=window.open(X,W,Z);return{wnd:Y};};mstrmojo.DI.DIHelpers.openPopupWindow=function I(Z,X,W){var Y;if(Z&&!Z.closed){Z.location=W;Z.focus();}else{Y=this.createPopupWindow(W);Z=Y.wnd;if(Z){Z.focus();}}return Z;};mstrmojo.DI.DIHelpers.sendResponse2Window=function B(X,W,a){var Z;if(a){Z=a;}else{Z=window.opener;}if(Z){if(W===undefined){W=window.location.origin;if(!W){W=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");}}try{if(this.isIE()&&Z.postMessagePassthrough){Z.postMessagePassthrough(X,W);try{window.open("","_self","");window.close();}catch(b){window.close();}}else{Z.postMessage(X,W);}}catch(Y){console.log("postMessage error: "+Y);}}};mstrmojo.DI.DIHelpers.convertDataSourceType2SourceType=function G(W){switch(W){case V.dataSourceType.DROPBOX:return V.sourceType.dropbox;case V.dataSourceType.GOOGLE_DRIVE:return V.sourceType.googleDrive;case V.dataSourceType.GOOGLE_ANALYTICS:return V.sourceType.googleAnalytics;case V.dataSourceType.SALESFORCE:return V.sourceType.salesforce;case V.dataSourceType.GOOGLE_BIGQUERY:return V.sourceType.googleBigQuery;default:return -1;}};mstrmojo.DI.DIHelpers.highlightKeyWords=function L(e,f,W){var Y="\\*.?+$^[](){}|/",g=e,c,Z;if(e===""){return f;}for(Z in Y){if(Y.hasOwnProperty(Z)){c=Y[Z];g=g.replace(new RegExp("\\"+c,"g"),"\\"+c);}}var d=new RegExp("("+g+")","ig");var X="\u001E",b=mstrmojo.string.encodeHtmlString,a;if(d.test(f)){f=f.replace(d,function(h){return X+h+X;});a=K.map((f||"").split(X),function(i,h){return(h%2===0)?b(i):('<span class="'+W+'">'+b(i)+"</span>");});return a.join("");}};mstrmojo.DI.DIHelpers.detectCustomImg=function(Z,Y){if(!Z||!(Y.nodeType&&Y.nodeType===window.Node.ELEMENT_NODE)){return ;}var W=Z.replace?Z.replace(/\s+/g,""):"";var a=document.getElementsByTagName("head")[0];var X=document.createElement("img");X.src="../javascript/mojo/css/images/DI/connectors/"+W+".png";X.onload=function(){Y.style.background="url(../javascript/mojo/css/images/DI/connectors/"+W+".png) no-repeat";a.removeChild(X);};X.onerror=function(){Y.style.background="url(../javascript/mojo/css/images/DI/connectors/default.png) no-repeat";a.removeChild(X);};a.appendChild(X);};mstrmojo.DI.DIHelpers.spliceUrlBySeparator=function(X){var W=X.split("#");return W.slice(W.length/2+1).join("#");};mstrmojo.DI.DIHelpers.isOriginalConnector=function(X){var W=V.originalConnector;if(W.elastic===X||W.tapClicks===X){return true;}return false;};mstrmojo.DI.DIHelpers.acceptEventFromAncestor=function(W){if(!W){return true;}if(!this.domNode||typeof W.contains!=="function"||!this.hasRendered){return false;}return W.contains(this.domNode);};mstrmojo.DI.DIHelpers.isdbRoleWritable=function(W){if(mstrmojo.DI.DIHelpers.isOnetier()){return true;}else{return W.writable==="1"&&mstrApp.rootController.hasPrivilege(V.DssXmlPrivileges.DssXmlPrivilegesUseDatabaseInstanceManager);}};mstrmojo.DI.DIHelpers.isdbRoleUsable=function(W){return mstrmojo.DI.DIHelpers.isOnetier()?true:W.usable==="1";};mstrmojo.DI.DIHelpers.applyDriverSuffix=function(Y){if(!Y||!Y.Preferences){return ;}var W=JSON.stringify(Y),X=Y.Preferences.driverNameSuffix,a=this.getEnvObj();var Z="Platform";if(a.isDesktopClient()){Z=a.isMac()?"DesktopMac":"DesktopWin";}else{if(a.isWSClient()){Z=a.isMac()?"WorkstationMac":"WorkstationWin";}}var b=X[K.find(X,"n",Z)];return JSON.parse(W.replace(/!#DRIVERSUFFIX#!/g,b?b.value:""));};mstrmojo.DI.DIHelpers.isGeo=function(W){return W.georole&&W.georole>0;};mstrmojo.DI.DIHelpers.isTime=function(W){return W.dtp===parseInt(P.DATE,10)||W.dtp===parseInt(P.DATE_TIME,10)||W.dtp===parseInt(P.TIME,10);};mstrmojo.DI.DIHelpers.formatDIMessageData=function(W){return{type:D,payload:W};};mstrmojo.DI.DIHelpers.parseDIMessageData=function(W){return W&&W.payload;};mstrmojo.DI.DIHelpers.isDIMessageEvent=function(W){if(!W||!W.data){return false;}return W.data.type===D;};mstrmojo.DI.DIHelpers.setClassToCols=function(c,e,g,b,f,X){var d=true,W,a,Z,Y;for(Z=0;Z<g.length;Z++){c[0].cells[g[Z]].className=X;}if(f){for(Z=0;Z<f.length;Z++){W=X?(X+(d?" L":" R")):X;c[1].cells[f[Z]].className=W;if(d&&(f[Z+1]-f[Z]>1)){W=X?(X+" M"):X;for(Y=f[Z]+1;Y<f[Z+1];Y++){c[1].cells[Y].className=W;}}d=!d;}}for(a=0;a<e.length;a++){for(Z=0;Z<b.length;Z++){e[a].cells[b[Z]].className=X;}}};}());(function(){mstrmojo.requiresCls("mstrmojo.threshold.ThresholdModel","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.FormatModel");var K=mstrmojo,F=mstrmojo.chart.model.enums.EnumDSSObjectType,E=mstrmojo.vi.viz.EnumVisualizationTemplates,H=1,D=["#ec7b75","#f6db7f","#84c87b"],I=[0.35,0.65],B=K.models.FormatModel,J=B.ENUM_PROPERTY_NAMES;function C(N,M,O,P){M.reverse().forEach(function(Q){P.push(N.getClearThresholdAction(O.did,O.t||F.DssTypeMetric,Q.tid));});}mstrmojo.vi.util.ThresholdUtils=mstrmojo.provide("mstrmojo.vi.util.ThresholdUtils",{addClearAllThresholdsActions:function L(M,O,S){var R=O.data.gsi,N=R.mx,P=R.thresholds,Q;if(P){N.forEach(function(U){Q=P[U.did];if(Q){C(M,Q,U,S);}});R.thresholds={};}},addThresholds:function A(V,a,P,U,R,M,N,Q){var S,X=[],W=new mstrmojo.threshold.ThresholdModel({data:P.data}),Y=W.data.gsi.thresholds,O=Y&&Y[U.did];R=R||[];if(!O||Q){M=M||D;N=N||I;for(S=0;S<M.length;S++){var Z={};Z.fmt=B.getFormatUpdate(J.BACKGROUND_COLOR,M[S]);B.getFormatUpdate(J.FILL_STYLE,0,Z.fmt);if(S>0){Z.flr=W.getRealValue(N[S-1],H);}if(S<N.length){Z.ceil=W.getRealValue(N[S],H);}X.push(Z);}if(O){C(V,O,U,R);}R.push(V.getCreateSimpleThresholdAction(X,a.k,U.did,H,null,4));}W.destroy();return R;},getDefaultGMThreshold:function G(O){var N,M;switch(O){case E.GRAPHMATRIXHORIZONTALBARCLUSTERED:case E.GRAPHMATRIXHORIZONTALBARSTACKED:case E.GRAPHMATRIXHORIZONTALBARPERCENT:case E.GRAPHMATRIXVERTICALBARCLUSTERED:case E.GRAPHMATRIXVERTICALBARSTACKED:case E.GRAPHMATRIXVERTICALBARPERCENT:case E.GRAPHMATRIXVERTICALBARAUTOMATIC:case E.GRAPHMATRIXPIE:N=["#d2e0e8","#a4cbe6","#80add9","#558dcc","#2e78bb"];M=[0.2,0.4,0.6,0.8];break;case E.GRAPHMATRIXVERTICALLINECLUSTERED:case E.GRAPHMATRIXVERTICALLINESTACKED:case E.GRAPHMATRIXVERTICALLINEPERCENT:case E.GRAPHMATRIXVERTICALLINEAUTOMATIC:case E.GRAPHMATRIXHORIZONTALLINECLUSTERED:case E.GRAPHMATRIXHORIZONTALLINESTACKED:case E.GRAPHMATRIXHORIZONTALLINEPERCENT:case E.GRAPHMATRIXHORIZONTALLINEAUTOMATIC:case E.GRAPHMATRIXVERTICALAREACLUSTERED:case E.GRAPHMATRIXVERTICALAREASTACKED:case E.GRAPHMATRIXVERTICALAREAPERCENT:case E.GRAPHMATRIXVERTICALAREAAUTOMATIC:case E.GRAPHMATRIXHORIZONTALAREACLUSTERED:case E.GRAPHMATRIXHORIZONTALAREASTACKED:case E.GRAPHMATRIXHORIZONTALAREAPERCENT:case E.GRAPHMATRIXHORIZONTALAREAAUTOMATIC:N=["#ec7b75","#f6db7f","#84c87b"];M=[0.35,0.65];break;case E.GRAPHMATRIXBUBBLECIRCLEMM:case E.GRAPHMATRIXBUBBLEGRIDCIRCLEAA:case E.GRAPHMATRIXBUBBLEGRIDSQUAREAA:case E.GRAPHMATRIXBUBBLESQUAREAM:case E.GRAPHMATRIXBUBBLESQUAREMM:N=["#abcffa","#7ca8de","#4570af","#224b8f","#0e3270"];M=[0.2,0.4,0.6,0.8];break;default:break;}return{colors:N,ranges:M};}});}());(function(){mstrmojo.requiresCls("mstrmojo.StepperContentProvider","mstrmojo.num");var A=mstrmojo.num;function B(G,F){var H=F?G.max:G.min,D=F?G.min:G.max,E=G.getVal(F?1:-1);return(H===null||(F?(E<=H):(E>=H))||(D!==null&&G.canLoop));}function C(H,G){var F=H.min,D=H.max,E=H.getVal(G?1:-1);if((G&&D!==null&&E>D)||(!G&&F!==null&&(E<F))){if(H.canLoop){E=((E-F)%(D-F+1))+F;E=(E>=F)?E:E+(D-F+1);}else{return ;}}H.item[H.valField]=H.curVal=E;H.onTraverse();}mstrmojo.NumStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.NumStepperContentProvider",curVal:null,init:function(E){this._super(E);var F=this.item,D=function(I){var H=I&&F[I];return(H===null||H===undefined);},G=function(I,K,H){var J=H&&D.call(this,K)?null:F[K];if(J!==null&&J!==undefined){this[I]=J;}};G.call(this,"min",this.minField,true);G.call(this,"max",this.maxField,true);G.call(this,"maxLength",this.maxLengthField,true);G.call(this,"interval",this.intField);this._initCurrent();},_initCurrent:function(){var E=this.item,F=this.curVal=E[this.valField];if(F===null||F===undefined){var D=this.min;this.curVal=D!==null?D:0;}},next:function(){C(this,true);},prev:function(){C(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},renderItemAt:function(F){var E=this.getVal(F),D=this.renderer;return D?D.render(E,this):E;},getVal:function(D){return this.curVal+(this.interval*(D||0));},setVal:function(F){var G=this.min,D=this.max,E=this.getVal();if(typeof F!=="number"||isNaN(F)||F===E||A.inNumericRange(F,G,D)!==0){return ;}this.item[this.valField]=this.curVal=F;this.onTraverse();},onTraverse:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.ui._HasUITheme","mstrmojo.vi.ui.theme","mstrmojo.dom");function g(h,j){if(!mstrmojo.DocInfoWindow){return ;}var i=h;while(i){if(i instanceof mstrmojo.DocInfoWindow){i[j?"registerScrollLock":"releaseScrollLock"](this);break;}i=i.parent;}}var N=mstrmojo.array,D=mstrmojo.dom,S=mstrmojo.hash,e=mstrmojo.css,G="px",K=mstrmojo.ui._HasUITheme.EnumThemeNames;var C=false;function M(h,j){if(!mstrmojo.DocInfoWindow){return ;}var i=h;while(i){if(i instanceof mstrmojo.DocInfoWindow){i[j?"registerLock":"releaseLock"](this);this.lockIW=j?i:null;break;}i=i.parent;}}var W=mstrmojo.ui.PopupConfig,O=W.directionCfg,B=W.ENUM_CORNERS,Z=B.TOP_LEFT,V=B.TOP_RIGHT,I=B.BOTTOM_RIGHT,H=B.BOTTOM_LEFT;function J(h){return(h===H||h===Z);}function d(h){return(h===V||h===I);}function Q(h){return(h===I||h===H);}function U(h){return(h===V||h===Z);}function a(p,j,z,AF){var AI=z.x,AH=z.y,AE=z.w||0,t=z.h||0,i=AF.w,AA=AF.h,AD=p.alignment,n=AD.popup,l=AD.host,AG=d(l),AJ=Q(l),AC=false,x=false,k=false,y=false,m=false,u=false,AB=D.isMobile,q=mstrmojo.ui.PopupConfig.directionCfg;if(J(n)){var o=AI+i+(AG?AE:0);AC=j.w<o;m=AB&&(AC||q.isRightToLeft());}if(U(n)){var w=AH+AA+(AJ?t:0);x=j.h<w;u=AB&&x;}if(d(n)||m){var s=AI-i+((AG&&!m)?AE:0);k=s<0;}if(Q(n)||u){var h=AH-AA+((AJ&&!u)?t:0);y=h<0;}return{top:y,bottom:x,left:k,right:AC};}function F(i){var h=this.popupConfig;if(h){S.forEach(h.popupHandlers,function(k,l){var j=k[i?"open":"close"];if(j){j.call(mstrmojo.all[l]||j,!!i);}});}}function L(i){var h=this.popupConfig;if(h&&!h.isHostedWithin){var j=this.hostProxy;if(j){j.style.display=i?"":"none";}}}function f(h){return h!==undefined&&h!==null&&!isNaN(h);}mstrmojo._IsPopup={visible:false,lockIWForScroll:false,disposable:true,opener:null,onOpen:mstrmojo.emptyFn,onClose:mstrmojo.emptyFn,popupConfig:null,hostProxy:undefined,open:function P(j,h){F.call(this,true);if(this.updatePopupConfig){this.updatePopupConfig(h,j);}else{S.forEach(h,function(m,l){this.set(l,m);},this);}var i="popup-mid-render";this.set("opener",j);if(!this.hasRendered){var k=this.visible;this.visible=false;this.render();e.addClass(this.domNode,i);this.set("visible",k);}if(this.nudge){this.domNode.style.top="-10000px";}L.call(this,true);this.set("visible",true);if(this.lockIWForScroll){g.call(this,this.opener,true);}if(h&&h.lockIW){M.call(this,h.lockIW,true);}if(this.nudge){this.nudge();}if(this.adjustSize){this.adjustSize();}this.adjustCornersForPopupOverflow();this.onOpen();e.removeClass(this.domNode,i);},adjustCornersForPopupOverflow:function b(){var s=this.popupConfig;if(!s){return false;}var AY=(s.includeScroll!==undefined)?s.includeScroll:true;var m=s.anchorElement||s.hostElement,k=s.position||D.position(m,AY),AD=m&&m.style&&m.style.zIndex;if(!k.x&&!k.y){var AZ=event.target;var AZ=event.srcElement;var AP=AZ.getBoundingClientRect();k.x=AP.left+AP.width/2;k.y=AP.top+AP.height/2;}if(!s.isHostedWithin){var Ah=this.hostProxy,AX=this.hostProxy=document.createElement("div");document.body.appendChild(AX);AX.appendChild(this.domNode);if(Ah){Ah.parentNode.removeChild(Ah);}var AN=AX.style,AO={x:"left",y:"top",w:"width"};AX.className=s.hostProxyCssClass;AN.position="absolute";AN.background="none";e.addClass(AX,"mstrmojo-popup-widget-hosted");AN.height="0";N.forEach(["x","y","w"],function(Aq){var Ap=k[Aq];if(f(Ap)){AN[AO[Aq]]=Ap+G;}});}var AC=s.ENUM_CORNERS,An=AC.BOTTOM_LEFT,AQ=AC.BOTTOM_RIGHT,i=AC.TOP_RIGHT,AI=AC.TOP_LEFT;var p=D.position(document.body),AS=D.position(this.domNode),Ac=a(s,p,k,AS),o=Ac.right,AB=Ac.bottom,Ao=Ac.left,AW=Ac.top,AE=s.alignment,AM=AE.popup,j=AE.host,w=AM,AA=j,AR=D.isMobile,z=m&&m.classList&&m.classList.contains("mstrmojo-ui-Menu-item"),AT=this.id,x=m&&m.parentNode,AU=x&&x.parentElement,AL=m||this.domNode,AJ,Ai=this.domNode.style;if(AU&&AU.classList.contains("mstrmojo-ui-Menu")){AL=AU;}AJ=D.position(AL);if(z&&((Ao&&o)||(AW&&AB))){if(AU){Ai.top=AJ.y+"px";Ai.left=AJ.x+"px";var Ag=document.getElementsByClassName("mstrmojo-ui-Menu");N.forEach(Ag,function(Ap){if(AT!==Ap.id){Ap.style.visibility="hidden";}});}s.anchorElement=AL;s.position={h:0,w:0,x:(AJ.x+AS.w)>p.w?Math.min(AJ.x,5):AJ.x,y:(AJ.y+AS.h)>p.h?Math.min(AJ.y,90):AJ.y};this.adjustCornersForPopupOverflow();return ;}if(O.isRightToLeft()&&(!AR||AS.w>0)){if(!AR||!Ao){o=true;}else{if(!AR||!o){O.setDirection(false);this.resetDirection=true;if(AR){AA=(AA===i)?AI:An;}}}}else{if(o){O.setDirection(true);this.resetDirection=true;}}if(o||Ao){if(J(AA)){AA=U(AA)?i:AQ;}else{if(d(AA)){AA=U(AA)?AI:An;}}if(o&&J(w)){w=U(w)?i:AQ;}else{if(Ao&&d(w)){w=U(w)?AI:An;}}}if(AB||AW){if(J(AA)){AA=U(AA)?An:AI;}else{if(d(AA)){AA=U(AA)?AQ:i;}}if(AB&&U(w)){w=J(w)?An:AQ;}else{if(AW&&Q(w)){w=J(w)?AI:i;}}}if(AW||o||AB||Ao){if(C){console.log("Overflow directions: "+JSON.stringify(Ac));}this._orgalgn={host:j,popup:AM};s.setAlignment(AA,w);}if(!s.isHostedWithin){if(f(k.y)&&f(k.h)){this.hostProxy.style.top=(k.y+(Q(w)?(s.alignWithAnchor===true?k.h:0):(s.alignWithAnchor===true?0:k.h)))+G;this.hostProxy.style.zIndex=(f(AD)&&(AD>100))?AD+1:101;}}var AV,Ak={};if(s.isHostedWithin&&!!this.opener){AV=e.getComputedStyle(this.opener.domNode);}N.forEach(["left","right","top","bottom"],function(Ap){Ak[Ap]=AV?parseInt(AV["border-"+Ap+"-width"]||0,10):0;});var Ae=Q(AA),Af=d(AA),u=Q(w),n=d(w),Aa=function(Aq,Ap){return"calc(100% + "+(Ap?Ak[Aq]:0)+"px)";},y=function(Aq,Ap){return(Ap?-Ak[Aq]:0)+"px";};var q,Ab,h,l;q=Ab=h=l="auto";if(u){h=Ae?y("top"):Aa("top");}else{q=Ae?Aa("bottom"):y("bottom");}if(n){Ab=Af?y("left"):Aa("left");}else{l=Af?Aa("right"):y("right");}Ai.top=q;Ai.right=Ab;Ai.bottom=h;Ai.left=l;var t=D.position(this.domNode),AK=5;if(AB||AW){var Al=t.y,AF=D.getMaxScrollHeight()+"px",Aj=this.scrollNode,AG=Aj&&Aj.style.maxHeight;if(Al<0||(Al+t.h>p.h)){if(Aj&&AF!==AG){Aj.style.maxHeight=AF;this.updateScrollbars();}var Ad=(-k.y+AK)+G;if(!s.isHostedWithin){if(this.hostProxy){this.hostProxy.style.top=0;}Ad=AK+G;}Ai.top=Ad;Ai.bottom="auto";}}if(Ao||o){var Am=t.x;if(Am<0||(Am+t.w>p.w)){var AH=(-k.x+AK)+G;if(!s.isHostedWithin){if(this.hostProxy){this.hostProxy.style.left=0;}AH=AK+G;}Ai.left=AH;Ai.right="auto";}}return true;},close:function R(i){if(this.keepOpen){return ;}if(this.onClose){this.onClose(i);}L.call(this,false);if(this.lockIWForScroll){g.call(this,this.opener,false);}this.set("visible",false);this.set("opener",null);if(this.lockIW){M.call(this,this.lockIW,false);}F.call(this,false);var h=this._orgalgn;if(h){this.popupConfig.setAlignment(h.host,h.popup);}if(this.resetDirection){this.resetDirection=false;O.setDirection(false);}},preBuildRendering:function A(i){this._super(i);var l=this.popupConfig;if(l&&!l.isHostedWithin){var h=l.hostProxyCssClass.split(" "),k=false;N.forEach(S.keyarray(K),function(m){if(h.indexOf(K[m])>=0){k=true;return false;}});if(!(k||l.noInheritTheme)){var j=mstrmojo.vi.ui.theme.getThemeClass.call(this);if(j){h.push(j);}}l.hostProxyCssClass=h.join(" ");}},buildRendering:function E(){var h=this._super();if(h){if(!this.parent&&!this.domNode.parentElement){document.body.appendChild(this.domNode);}}return h;},postBuildRendering:function Y(){var h=this,i=this.popupConfig;if(i&&!this._ListenerProc){this._ListenerProc=function(){h.monitorWindow();};D.attachEvent(window,"resize",this._ListenerProc);}this._super();},monitorWindow:function(){var i=D.getMaxScrollHeight();if(this.updateScrollbars&&this.scrollNode){this.scrollNode.style.maxHeight=(this.scrollNodeMaxHeight||i)+"px";this.updateScrollbars();}if(this.visible){var h=this,j=null;window.clearTimeout(j);j=window.setTimeout(function(){h.scrollNode.style.maxHeight=(h.scrollNodeMaxHeight||i)+G;h.adjustCornersForPopupOverflow();},175);}},destroy:function c(h){if(this._ListenerProc){D.detachEvent(window,"resize",this._ListenerProc);delete this._ListenerProc;}this._super(h);},unrender:function X(h){if(this.popupConfig&&!this.popupConfig.isHostedWithin&&this.hostProxy){document.body.removeChild(this.hostProxy);delete this.hostProxy;}this._super(h);}};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css,G=mstrmojo.array;function F(H,J){var I={searchMetadata:{taskId:"searchMetadata",styleName:this.searchStyleName,rootFolderID:this.rootID,searchPattern:this.searchPattern+"*",nameWildcards:(this.qse?16:1),quickSearch:this.qse,sortKey:(this.qse?-1:6),blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",includeObjectDesc:this.includeObjectDesc,searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseFolder:{taskId:"searchMetadata",rootFolderID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,recursive:this.hierarchical?0:(this.searchXML?"":1),folderBrowserStyle:this.hierarchical?1:0,includeAncestorInfo:String(!!this.hierarchical),searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseElements:{taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,filterXML:this.filterXML||"",searchPattern:this.searchPattern||"",matchCase:!!this.matchCase,dataSourcesXML:this.dataSourcesXML||"",includeFormNames:!!this.collectForms,includeFormValues:!!this.bIncludeFormValues,displayedForms:this.displayedForms||1,dimensionID:this.dimensionId||""}}[H]||{};if(typeof J==="object"){mstrmojo.hash.copy(J,I);}return I;}var B="##searchPattern";mstrmojo.SearchBox2=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchBox2",taskId:"searchMetadata",rootID:null,searchStyleName:"MojoFolderStyle",objectTypes:"3,14,256,257,1024,1027,2048,3072,10",token:{searchMetadata:/\//,browseElements:/(^-)|(,)|( OR )|( AND)|([<>]=?)|(&)|( )|(["\[\]\/])/},blockCount:50,blockBegin:1,minSearchLength:2,matchCase:false,enableMatchCase:true,supportIncFetch:true,quickSearch:false,searchAfterSearchPatternRestored:false,includeObjectDesc:true,forceResetCache:false,onUpdateSearchParams:mstrmojo.emptyFn,markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td><td><div class="mstrmojo-SearchBox-options" style="{@cssTextShowMC}"><input id="{@id}sbMatchCase" type="checkbox" mstrAttach:click /><label for="{@id}sbMatchCase">'+mstrmojo.desc(4326,"Case Sensitive")+"</label></div></td></tr></table>",markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},searchNode:function(){return this.domNode.rows[0].cells[1].firstChild.firstChild;},optionNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},preBuildRendering:function(){this.cssTextShowMC=this.enableMatchCase?"":"display: none";},postBuildRendering:function(){if(this._super){this._super();}this.matchCase=this.optionNode.checked;},onkeyup:function E(H){var J=this;var I=J.searchTimer;if(I){window.clearTimeout(I);}J.searchTimer=window.setTimeout(function(){J.onkeyupDelayed(H);delete J._searchTimer;},parseInt(H.e.keyCode||H.e.charCode,10)===13?0:J.searchDelay);},onkeyupDelayed:function A(I){var H=I.hWin,K=I.e||H.event;var J=mstrmojo.string.trim(this.inputNode.value);if(this.searchNode){C.toggleClass(this.searchNode,["clear"],J.length>0);}this.showTaskError=false;this.click2Search=false;if(J.length==0||this.autoSubmit||this.onEnter&&K.keyCode===13){this._onsearch();}},onEnter:function(){this._onsearch();},onclick:function(I){var H=I.hWin,K=I.e||H.event,M=K.target||K.srcElement,L=M&&M.id;switch(L.replace(this.id,"")){case"sbDown":if(this.enableMatchCase){var J=this.optionNode.parentNode.style;J.display=J.display=="block"?"none":"block";}break;case"sbSearch":if(this.inputNode.value.length>0){this.clearSearch();}break;case"sbMatchCase":this.set("matchCase",this.optionNode.checked);break;case"sbSpinner":break;}},clearSearch:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);var I=this.searchCache,H=this.rootID;if(I&&I[H]){I[H][B]="";}this._onsearch(true);},onmatchCaseChange:function(){this.matchCaseChanged=true;this._onsearch();},onrootIDChange:function(){this.rootChanged=true;this._setupCache(this.forceResetCache);var I=this.searchCache[this.rootID];if(I){var H=I[B]||"";this.inputNode.value=H;if(H.length>0){if(H.length>=this.minSearchLength&&this.searchAfterSearchPatternRestored){this._onsearch();}}}},getRootID:function(){},contentWidget:null,_notifyContentWidget:function(I){var H=this.contentWidget||this;H.set("items",I[0]);if(this.supportIncFetch){var J=I[1],L=I[2],K=this.blockCount;H.set("ifs",{np:Math.floor(J/K)+((J%K>0)?1:0),cp:Math.floor(L/K)+((L%K>0)?1:0)});}},_onsearch:function(H){this.getRootID();this._setupCache();var K=mstrmojo.string.trim(this.inputNode.value);if(K.length===0){H=true;}var L=this.token[this.taskId];if(L.test(K)){}if(this.searchPattern==K&&!this.rootChanged&&!this.matchCaseChanged&&!this.click2Search){return ;}var M=this.rootID,J=this.searchCache[M];if((K.length<this.minSearchLength&&!this.click2Search)&&!H){if(this.searchPattern&&this.searchPattern.length>=this.minSearchLength){this._notifyContentWidget(J[M]);this.searchPattern=K;}}else{this.searchPattern=K;J[B]=this.searchPattern;var I=this.filterCache(K,J,H);if((this.click2Search||I===null)&&!H){this.blockBegin=1;this.fetch();return ;}else{this._notifyContentWidget(I);}}J[B]=K;},_setupCache:function(J){var K=this.searchCache,I=this.rootID;if(K&&(J||!K[I])){K[I]=K[I]||{};var H=this.contentWidget&&this.contentWidget.items||this.rootCacheItems||[];K[I][I]=[H,this.totalSize||0,this.blockBegin||1].concat();}},taskCallId:0,path:mstrConfig.taskURL,method:"POST",serverRequest:function D(H,I){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(H,I);}else{mstrmojo.xhr.request("POST",this.path,I,H,undefined,this.XServer,this.baseParams);}},fetch:function(){this.rootChanged=false;this.matchCaseChanged=false;if(this.spinnerNode){this.spinnerNode.style.display="block";}if(this.preFetch){this.preFetch();}var H=this,I=F.apply(this,[this.taskId]);I.searchPattern=this.searchPattern;this.onUpdateSearchParams(I);var J={success:function(K){var L=K.items||K.es||[];L=[L,K.totalSize||K.sz||0,K.blockBegin||K.bb];mstrmojo.all[H.id].searchCache[H.rootID][(I.searchPattern.length==0?H.rootID:H.buildIndex(I.searchPattern))]=L;H._notifyContentWidget(L);},failure:function(K){if(H.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+K.getResponseHeader("X-MSTR-TaskFailureMsg"));}},complete:function(){if(H.spinnerNode){H.spinnerNode.style.display="none";}if(H.postFetch){H.postFetch();}}};this.serverRequest(I,J);},fetchPage:function(H){this.blockBegin=H*this.blockCount+1;this.fetch();},filterCache:function(J,M,I){var H=M&&M[I?this.rootID:this.buildIndex(J)];if(H){return H;}var K=this.token[this.taskId];if(K.test(J)||this.totalSize>this.blockCount){return null;}var O=J.replace(/.$/,"");H=M&&M[this.buildIndex(O)];while(H===undefined&&(O=O.replace(/.$/,"")).length>0){H=M&&M[this.buildIndex(O)];}if(H!==undefined){if(H[1]>this.blockCount){return null;}var L=H[0],N=[];G.forEach(L,function(P){if(P.n.search(new RegExp(J,this.matchCase?"":"i"))>-1){N.push(P);}});this.totalSize=N.length;return(M[this.buildIndex(J)]=[N,N.length,this.blockBegin].concat());}return null;},buildIndex:function(H){if(H.replace(/^\s|\s$/g,"").length===0){return"";}return !this.matchCase?H.toUpperCase():H+"::0";},init:function(H){if(this._super){this._super(H);}this.qse=mstrApp.useQuickSearch&&mstrApp.useQuickSearch()||0;this.autoSubmit=this.quickSearch&&(mstrApp.searchAutoComplete&&mstrApp.searchAutoComplete()||false);this.searchDelay=mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay()||0;this.xhr=new mstrmojo.SimpleXHR();this.searchCache=this.searchCache||{};},clear:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var B="mstrmojo-Image";mstrmojo.Image=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Image",markupString:'<div id="{@id}" class="'+B+' {@cssClass}" style="{@cssText}" mstrAttach:click><image class="{@imgCssClass}" src="{@src}" mstrAttach:load /></div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onsrcChange:function(){var C=this.imgNode;if(C){C.src=this.src||"../javascript/mojo/css/images/1ptrans.gif";}},oncssClassChange:function(){var C=this.domNode;if(C){C.className=this.cssClass||B;}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},src:"",getImageSize:function A(){var C=this.imgNode;return{w:C.clientWidth,h:C.clientHeight};}});mstrmojo.Image.baseCssClass=B;}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.array","mstrmojo._HasChildren");var G=mstrmojo.array;function E(P){if(!this.shouldPropagateEnabled){return ;}var O=this._disabledChildren;G.forEach(P,function(Q){if(Q.enabled){O.push(Q.id);Q.set("enabled",false);}});}function J(){G.forEach(this._disabledChildren,function(O){var P=mstrmojo.all[O];if(P&&P.parent===this){P.set("enabled",true);}},this);this._disabledChildren=[];}mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",containerNode:null,preserveChildDomOrder:true,shouldPropagateEnabled:false,init:function M(P){this._super(P);this._disabledChildren=[];this.attachEventListener("addChild",this.id,function(Q){if(this.shouldPropagateEnabled&&!this.enabled){E.call(this,Q.value);}});if(this.children){this.initChildren();}var O=this.parent;if(!O||O.hasInitBindings){this.initBindings();}},destroy:function H(O){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(O);},unrender:function I(Q){var R=this.children,O=(R&&R.length)||0,P;for(P=O-1;P>-1;P--){R[P].unrender(true);}this._super(Q);},postBuildRendering:function A(){if(this._super()!==false){this.renderChildren();return true;}return false;},renderChildren:function L(){var Q=this.children,O=(Q&&Q.length)||0,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}}},childRenderCheck:function D(P){if(P&&!P.hasRendered){var O=P.slot||this.defaultChildSlot;return !!this[O];}return false;},addChildren:function N(R,P,Q){var O=this._super(R,P,Q);if(O){this.childRenderOnAddCheck(O);}return O;},removeChildren:function F(W,R){var V=W?[W]:(this.children||[]),O=V.length,S;for(S=O-1;S>-1;S--){var Q=V[S],P=Q&&Q.domNode;if(P){var U=this[(Q.slot||this.defaultChildSlot)];if(P.parentNode===U){U.removeChild(P);}}}return this._super(W,R);},childRenderOnAddCheck:function B(Q){if(this.hasRendered&&Q){var O=Q.length,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}else{if(R&&R.hasRendered){this.onchildRenderingChange(R);}}}}},onchildRenderingChange:function K(O){var X=O&&O.domNode;if(!X){return ;}var P=this.defaultChildSlot,W=O.slot||P,Z=this[W],Q=this.children;if(!Z){if(X.parentNode){X.parentNode.removeChild(X);}}else{if(X.parentNode===Z){return ;}if(!this.preserveChildDomOrder){Z.appendChild(X);}else{var R,V;for(V=Q.length-1;V>=0;V--){var Y=Q[V];if(Y===O){break;}if(W===(Y.slot||P)){var a=Y.domNode;if(a&&a.parentNode===Z){R=a;}}}if(R){Z.insertBefore(X,R);}else{Z.appendChild(X);}}}if(mstrmojo.publisher.hasSubs(this.id,"childrenRendered")){var S=Q.length,U;for(U=0;U<S;U++){if(!Q[U].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}},propagateChildProps:function C(S){var R=this[S],Q=this.children||[],O=Q.length,P;for(P=0;P<O;P++){Q[P].set(S,R);}}});mstrmojo.Container.enabledMarkupMethod=function(){mstrmojo.Widget.enabledMarkupMethod.apply(this,arguments);if(this.shouldPropagateEnabled){if(this.enabled){J.call(this);}else{E.call(this,this.children);}}};}());mstrmojo.ToolSeparator=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ToolSeparator",markupString:'<div class="mstrmojo-ToolSeparator {@cssClass}" style="{@cssText}"></div>',markupSlots:{},markupMethods:{}});(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.desc","mstrmojo.Widget");var A=mstrmojo.css,B=mstrmojo.dom;mstrmojo.vi.ui.TargetMask=mstrmojo.declare(mstrmojo.Widget,[],{scriptClass:"mstrmojo.vi.ui.TargetMask",markupString:'<div class="mstrmojo-hasTgt" mstrAttach:contextmenu><div class="tgt"><div></div>'+mstrmojo.desc(4787,"Target")+'</div><div class="src"><div></div>'+mstrmojo.desc(4283,"Source")+"</div></div>",useRichTooltip:true,isDynamicTooltip:true,tooltipContent:mstrmojo.desc(15275,"This container cannot be selected as target"),allowFilters:false,init:function D(E){if(this._super){this._super(E);}},setMaskClass:function(H){var F=this.parent,G=F instanceof mstrmojo.vi.ui.rw.VizBox,E=F instanceof mstrmojo.vi.ui.rw.FilterBox;if(this.domNode){if(F.id===H){A.addClass(this.domNode,"sourced");}else{if(!G&&!(E&&this.allowFilters)){A.addClass(this.domNode,"disabled");}else{A.addClass(F.domNode,"targeted");}}this.domNode.style.display="block";return true;}return false;},clearMaskClass:function(){var E=this.parent;A.removeClass(this.domNode,"sourced");A.removeClass(this.domNode,"disabled");A.removeClass(E.domNode,"targeted");this.domNode.style.display="none";},moveTooltip:function C(E,F){this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A tgt-tt",content:this.tooltipContent,top:E.clientY+15,left:E.clientX-15};this._super(E,F);},oncontextmenu:function(F,E){B.preventDefault(E,F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.dom");var L=mstrmojo.color,H=mstrmojo.dom;var I=68.5,M=77.5,D=83;function B(O,N){return{x:O.clientX-N.x-M,y:O.clientY-N.y-M};}function K(){var N=this._hsl[1],P=this._hsl[2];var O=this.slHandleNode.style;O.left=Math.round(D*(0.5-N)+M)+"px";O.top=Math.round(D*(0.5-P)+M)+"px";}function F(){var N=this._hsl[0],P=N*2*Math.PI;var O=this.hueHandleNode.style;O.left=Math.round(Math.sin(P)*I+M)+"px";O.top=Math.round(-Math.cos(P)*I+M)+"px";this.slNode.style.backgroundColor=L.hsl2hex(N,1,0.5);}function C(){this._hsl=L.hex2hsl(this.color);if(this.slHandleNode&&this.hueHandleNode){K.call(this);F.call(this);}}mstrmojo.ui.editors.controls.ColorWheel=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",markupString:'<div id="{@id}" class="mstrmojo-ui-ColorWheel {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="cwHue"></div><div class="cwColorField"></div><div class="cwHandle"><div></div></div><div class="cwHandle"><div></div></div></div>',markupSlots:{slNode:function(){return this.domNode.childNodes[1];},hueHandleNode:function(){return this.domNode.childNodes[2];},slHandleNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},slNode:null,hueHandleNode:null,slHandleNode:null,color:"#ffffff",onColorPicked:function G(N){},postBuildRendering:function A(){C.call(this);},oncolorChange:function J(){C.call(this);},onmousedown:function E(Q){var S=this,N=H.position(this.domNode),U=this._hsl,P=Q.e,R=B(P,N),V=Math.max(Math.abs(R.x),Math.abs(R.y))*2>D,O=function(Y){var b=B(Y,N),X=U[0],Z=U[1],a=U[2];if(V){X=Math.atan2(b.x,-b.y)/(2*Math.PI);if(X<0){X+=1;}S._hsl=[X,Z,a];F.call(S);}else{Z=Math.max(0,Math.min(1,-(b.x/D)+0.5));a=Math.max(0,Math.min(1,-(b.y/D)+0.5));S._hsl=[X,Z,a];K.call(S);}var W=L.hsl2hex(X,Z,a);S.color=W;S.onColorPicked(W);H.stopPropogation(window,Y);return false;};H.attachMouseMoveEvents(O);O(P);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash");function A(H,E,G,F){var D=mstrmojo.hash.copy(F,{props:{left:{isStyle:true,start:H,stop:E,suffix:"px",ease:mstrmojo.ease.linear}},duration:G});(new mstrmojo.fx.AnimateProp(D)).play();}function B(K,N,G,L){var I=K.domNode,M=I.offsetWidth,D=K.scrollableIncFetch;var E=K.hasAnimation&&(!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||Number(RegExp.$1)>3.5),J=L?1:-1,F=parseInt(M,10)*J,H=E?500:0;A(0,-F,H,{target:G,duration:H,preStart:function(){this.target.style.overflowY="hidden";},onEnd:function(){this.target.style.display="none";}});A(F,0,H,{target:N,preStart:function(){this.target.style.display="block";this.target.style.overflowY=(D?"visible":"auto");}});if(K.waiting){A(0,-F,H,{widget:K,slot:"loaderNode",onEnd:function(){this.widget.waiting=false;}});}}var C=function(D){var E=D.currentPage;if(E===D.p1Node){E=D.p2Node;}else{E=D.p1Node;}D.currentPage=E;};mstrmojo.Booklet=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Booklet",pageClass:"mstrmojo-BookletPage",markupString:'<div id="{@id}" class="mstrmojo-Booklet {@cssClass}" style="{@cssText}"><div id="{@id}_p1" class="mstrmojo-BookletPage" ></div><div id="{@id}_p2" class="mstrmojo-BookletPage" style="left:-100%;"></div><div id="{@id}_ldr" class="mstrmojo-BookletLoader" ></div></div>',markupSlots:{containerNode:function(){return this.domNode;},p1Node:function(){return this.domNode.firstChild;},p2Node:function(){return this.domNode.childNodes[1];},loaderNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onnextChange:function(){var G=this.next;if(!G){return ;}var D=this.currentPage,F=this.p1Node,E=this.currentPage=(D==F)?this.p2Node:F;if(!(G instanceof mstrmojo.Obj)){G=this.next=mstrmojo.insert(G);}if(!G.hasRendered){G.placeholder=E.appendChild(document.createElement("span"));G.render();}else{if(E.firstChild){E.replaceChild(G.domNode,E.firstChild);}else{E.appendChild(G.domNode);}}this.set("waiting",false);if(E&&D){B(this,E,D,this.turnDirFwd);}else{if(this.scrollableIncFetch){E.style.overflowY="visible";}}},onwaitingChange:function(D){this.loaderNode.style.left=(this.waiting)?0:"-100%";},onheightChange:function(D){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(D){if(this.width){this.domNode.style.width=this.width;}}},enabled:true,waiting:false,next:null,currentPage:null,turnDirFwd:true,hasAnimation:true,scrollableIncFetch:false,FORWARD:true,REVERSE:false,turnFwd:function(D){this.turn(D,this.FORWARD);},turnBack:function(D){this.turn(D,this.REVERSE);},turn:function(D,E){this.set("turnDirFwd",E);this.set("next",D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasEditableText","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var C=mstrmojo.css,A=mstrmojo.dom,F=mstrmojo.string,E=function(H){this._super&&this._super(H);A.stopPropogation(H.hWin,H.e);},G=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.DynamicNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasEditableText],{scriptClass:"mstrmojo.fe.DynamicNode",markupString:'<div id="{@id}" class="mstrmojo-dynamic {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-dynamic-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-dynamic-prefix-text"  mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">'+G+'<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-onhoverparent mstrmojo-dynamicNode" title="'+mstrmojo.desc(13229,"Add this condition to the target list of a selector.")+'"><span class="mstrmojo-dynamicNode-info"><span class="mstrmojo-textset"></span></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" ></img></span><span class="mstrmojo-textset mstrmojo-rename-text" mstrAttach:click >'+mstrmojo.desc(1388,"Rename")+"</span>"+G+"</div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},dynamicNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.lastChild.firstChild.lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},createSetNode:function(){return this.domNode.lastChild.lastChild;},renameNode:function(){return this.domNode.lastChild.childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){C.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){C.toggleClass(this.dynamicNode,["selected"],this.selected);},onisEditingChange:function(){C.toggleClass(this.domNode,["renaming"],this.isEditing);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=this.data.ph.n;},onglowChange:function(){var H=this;C.toggleClass(H.dynamicNode,["glow"],this.glow);if(this.glow){setTimeout(function(){C.toggleClass(H.dynamicNode,["glow"],false);H.glow=false;},1000);}},onnoRelationOperatorChange:function(){C.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){C.toggleClass(this.dynamicNode,["noRelation"],this.noRelation);}},editableSlot:"textNode",editButtonSlot:"renameNode",init:function(H){var J=H.data;if(J){var I=H.tree.nameFactory;if(J.ph.n){I.setName(J.ph.n,this);}else{J.ph.n=I.getNewName(this,mstrmojo.desc(12033,"Dynamic Condition")+" ");}}this._super(H);},_set_data:function(K,H){var I=this.data,J=(I!==H);if(J){this.data=H;this.text=H.ph.n;}return J;},preclick:function D(H){var J=null,I=A.eventTarget(H.hWin,H.e);if(A.contains(this.prefixNode,I,true)){J="andor";}else{if(A.contains(this.createSetOptNode,I,true)&&!this.noRelationOperator&&!this.noRelation){J="createSetOpt";}else{if(A.contains(this.createSetNode,I,true)&&!this.noRelation){J="createSet";}else{if(A.contains(this.renameNode,I,true)){this.set("isEditing",true);}}}}H.part=J;},isEmpty:function(){var I=this.data,H=I&&I.ph;return !(H&&H.n);},del:function B(){var I=this.parent,H=this.tree.nameFactory;if(I&&I.remove&&this.data){I.remove(this.data);H.removeName(this.data.ph.n);}},onkeyup:E,onkeydown:E,onTextEditComplete:function(){var J=this.tree,K=J.nameFactory,H=F.trim(this.text||""),I=this.data.ph.n;if(H&&H!==I){if(K.isNameExist(H)){K.names[H].set("glow",true);this.set("isEditing",true);}else{K.changeName(I,H,this);this.data.ph.n=H;}}},isSelectableArea:function(H){return mstrmojo.dom.contains(this.dynamicNode,H,true);},avatarCssCls:"mstrmojo-FE mstrmojo-dynamicNode",getAvatarNode:function(){return this.dynamicNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string");var B=mstrmojo.string;mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",allowHTML:false,text:"",title:"",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" title="{@title} "mstrAttach:click></div>',markupMethods:{ontitleChange:function(){this.domNode.title=this.title;},ontextChange:function(){var C=this.text;C=B.isEmpty(C)?"":C.toString();this.domNode.innerHTML=this.allowHTML?C:B.encodeHtmlString(B.decodeHtmlString(C),true);},oncssTextChange:mstrmojo.Widget.cssTextMarkupMethod,onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Widget.enabledMarkupMethod},autoHide:false,_set_text:function A(E,C){if(this.autoHide){this.set("visible",(C!==null)&&(C!=="")&&(C!==undefined));}var D=this.text;this.text=C;return(D!==C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.Widget","mstrmojo._ListSelections");var E=mstrmojo.dom;mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" tstid="{@tstid}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function G(){return this.domNode.firstChild;},scrollboxNode:function A(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},autoHide:false,itemsContainerNode:null,_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,init:function J(K){this._super(K);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},buildRendering:function D(){this.itemsHtml="";var K=(this.renderOnScroll?this.items&&((this.renderIndex+1)*this.renderBlockSize):this.items&&this.items.length);if(K){this.itemsHtml=this._buildItemsMarkup(0,K-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_buildItemsMarkup:function B(K,N,V,L,W,M){var X=[],Q=0;X[Q++]=V||"";var P=this.itemRenderer,U=P&&P.render;if(U&&typeof U==="function"){var R=this.items,S=Math.min(N+1,((R&&R.length)||0)),O,Y;for(O=K;O<S;O++){Y=R[O];if(Y.skip){continue;}X[Q++]=W||"";X[Q++]=U(Y,O,this);X[Q++]=M||"";}}X[Q+1]=L||"";return X;},onselectionChange:function H(X){if(!X){return ;}var S=this.itemRenderer;if(!S){return ;}var V=this.items;if(X.added&&X.added.length>0&&V.length>0&&!mstrmojo.array.some(X.added,function(a){return !V[a]||!V[a].dsbld;})){return ;}var O=S.unselect,R=this.items||[],Y=X.removed,N,M,L,P,Z;if(O&&Y){for(P=0,Z=Y.length;P<Z;P++){N=Y[P];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){O(L,R[N],M,this);}}}var K=S.select,W=X.added,Q,U;if(K&&W){for(Q=0,U=W.length;Q<U;Q++){N=W[Q];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){K(L,R[N],M,this);}}}if(this.onchange){this.onchange({added:X.added,removed:X.removed});}},_set_items:function C(N,K){this.renderIndex=0;if(this.autoHide){this.set("visible",!!(K&&K.length));}var M=this.items;this.items=K;if(M!==K){var L=this.hasRendered;if(L){this.unrender(false);}this.clearSelect();if(L){this.render();}return true;}return false;},onItemContextMenu:mstrmojo.emptyFn,oncontextmenu:function F(K){E.preventDefault(window,K.e);var M=K.getTarget(),L=this.getItemFromTarget&&this.getItemFromTarget(M);if(L){if(this.onItemContextMenu(L,K)){K.cancel();}}},_getItemNode:function I(K){var L=this.itemsContainerNode;return(L&&L.childNodes[K])||null;},renderOnScroll:false});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.css","mstrmojo._IsExprNode","mstrmojo._HasPopup","mstrmojo.Widget","mstrmojo.fe.FilterUtils");var I=mstrmojo.dom,A=mstrmojo.css,E=mstrmojo.fe.FilterUtils,D=E.getExprConditionNodeHtml,B=E.getExprNodeHtmlAndText;function C(J){var K=J.data;return D(K);}mstrmojo.ConditionNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},oneditableChange:function(){A.toggleClass(this.textNode,["editable"],this.editable);},onselectedChange:function(){A.toggleClass(this.condNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();var J=B(this.data);this.textNode.innerHTML=J.html;this.textNode.title=J.text;this.textPostfixNode.innerHTML=this.getConditionTextPostfix();}},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),init:function H(J){this._super(J);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());},getConditionTextPostfix:function(){return"";},del:function G(){var J=this.parent;if(J&&J.remove&&this.data){J.remove(this.data);}},isEmpty:function(){var K=this.data,J=K&&K.et,L=J&&mstrmojo.expr.ET2TGT[J];return !(L&&K[L]);},isSelectableArea:function(J){return I.contains(this.condNode,J,true);},preclick:function F(J){var L=null,K=I.eventTarget(J.hWin,J.e);if(I.contains(this.prefixNode,K,true)){L="andor";}else{if(I.contains(this.textNode,K,true)){L="condition";}else{if(I.contains(this.textPostfixNode,K,true)){I.stopPropogation(J.hWin,J.e);return false;}}}J.part=L;}});mstrmojo.ConditionNode.getFunctionNode=C;})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.string");function C(H,D,E){var K=[];var G=H.optionRenderer,I=G&&G.render;if(I&&typeof I==="function"){var L=H.options,J=Math.min(E,((L&&L.length)||0)),F;for(F=D;F<J;F++){K.push(I(L[F],F,H));}}return K.join("");}mstrmojo.DropDownList=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DropDownList",title:"",selectCssClass:"",tooltip:"",cssDisplay:"inline",value:"",unset:false,options:null,optionValueField:"v",optionNameField:"n",idx:-1,renderedOptions:"",markupString:'<span id="{@id}"  class="mstrmojo-DropDownList {@cssClass}">{@en@title}<select id="{@id}_select" class="mstrmojo-DropDownList-select {@selectCssClass}"  style="{@cssText}" title="{@tooltip}"onchange="mstrmojo.all[\'{@id}\'].set(\'selected\', this.options[this.selectedIndex].value);">{@renderedOptions}</select><div class = "strikeoutContainer"></div></span>',markupSlots:{selectNode:function(){return this.domNode.getElementsByTagName("select")[0];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onidxChange:function(){var D=this.domNode.getElementsByTagName("select");if(D&&D.length){D[0].selectedIndex=this.idx;}},onvalueChange:function(){var I=this.selectNode,G=I.options,F=this.value,E,H;for(H=0;H<G.length;H++){var D=G[H].value.toString()===F;if(D){E=H;if(F!==""){mstrmojo.css.toggleClass(G[H],"selected",D);}break;}}if(I.length>0&&E>0&&this.unset){if(this.options[0].v==="-1"){I.remove(0);E--;}this.unset=false;}this.set("idx",E);},onwidthChange:function(){var D=this.width;if(D>=0){this.selectNode.style.width=D+"px";}}},_set_selected:function(G,D){var E=this.selectNode,F=this[G]!==D;this[G]=D;if(E){this.set("value",D);}return F;},preBuildRendering:function A(){var F=this;if(F.unset){F.idx=0;}var E=F.options,D=(E&&E.length)||0;if(D){F.renderedOptions=C(F,0,D);}return this._super();},optionRenderer:{render:function(E,D,F){return mstrmojo.string.apply(F.getOptionMarkup(E),F.getOptionProps(E,D));}},getOptionMarkup:function(D){return'<option value="{@en@v}" class="{@cls}" style="{@style}" {@sel}>{@en@n}</option>';},getOptionProps:function B(F,D){var G=this,H=F[G.optionValueField],E=D===parseInt(G.idx,10);G.selected=G.value=E?H.toString():G.value;return{cls:E?"selected":"",v:H===undefined?"":H,n:F[G.optionNameField]||"",style:"",sel:E?"selected":""};}});}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var b=mstrmojo.hash,g=mstrmojo.array,f=mstrmojo.boxmodel,d=mstrmojo.dom;function A(j,l,i){var k=j.listSelector;if(k){k[l](j,j.itemsContainerNode,i);}}function L(j,i){var k=j.lastPagePos;if(!k||k.dragId!==i){k=f.offset(j.itemsContainerNode);k.dragId=i;j.lastPagePos=k;var l=j.scrollboxNode;j.lastScrollPos={left:l.scrollLeft,top:l.scrollTop,width:l.clientWidth,height:l.clientHeight};}}function O(l,o,j){var k=o&&o.node;if(k===l.dropCueNode||k===l.dropCueNode.firstChild){return l.dropCuePos;}var m=l.listMapper;var i=m&&m.whereDrop(l,l.itemsContainerNode,k,o.pos,{left:l.lastPagePos.left-l.lastScrollPos.left,top:l.lastPagePos.top-l.lastScrollPos.top,width:l.lastScrollPos.width,height:l.lastScrollPos.height});var n=l.dropCuePos;return((j!==false)&&n&&i&&(n.idx===i.idx)&&(n.left===i.left)&&(n.top===i.top))?n:i;}var h="attachEventListener";function D(j,i){if(j.makeObservable){i=i||[];if(!i[h]){mstrmojo.hash.make(i,j.itemsScriptClass||mstrmojo.Arr);}}return i;}function H(j,i){if(i&&i[h]){j._sub_its=i;j._sub_add=i[h]("add",j.id,"preadd");j._sub_rmv=i[h]("remove",j.id,"preremove");}}function G(i){if(i._sub_its){var j=mstrmojo.publisher;j.unsubscribe(i._sub_add);j.unsubscribe(i._sub_rmv);delete i._sub_add;delete i._sub_rmv;delete i._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var j=this.dropCueNode,i=j&&j.style;if(!i){return ;}var l=this.dropCuePos,k=!!l;if(k){i.left=l.left+"px";i.top=l.top+"px";}i.display=k?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}},onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function a(m){this._super(m);this.items=this.initItems(this.items);var l=this.selectedIndices,j=this.selectedIndicesList,k=this.selectedIndex,n=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(l||j||(k>-1)||n){this.initSelections(l,j,k,n);}if(this.postInitItems){this.postInitItems();}},initItems:function I(i){return D(this,i);},preBuildRendering:function X(){var m=this.listBuilder,p=m.newContext(this);this.ctxtBuilder=p;var j=this.markupSlots,l=!!(this.renderOnScroll&&this.renderBlockSize&&j&&j.scrollboxNode),k=this.items,i=(k&&k.length)||0,n=l?this.firstRenderBlockSize:i,o=l?this.firstRenderBlockSize:0;this._eros=l;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(k,m,this,p,n,o).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function E(){delete this.itemsHtml;var o=this.listMapper;if(o&&o.postBuildRendering){o.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}H(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var q=this.id;this._cb_scroll=function(){var i=mstrmojo.all[q];i.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var l=0,k=["itemsEffect","scrollEffect"],j=k.length;l<j;l++){var p=k[l],m=this[p];if(m&&m.constructor===Object){m=mstrmojo.insert(mstrmojo.hash.clone(m));m.widget=this;this[p]=m;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function Y(m){G(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var k=0,l=["itemsEffect","scrollEffect"],j=l.length;k<j;k++){var n=this[l[k]];if(n&&n.isPlaying){n.cancel();}}this._super(m);},pauseScrollRendering:function P(k,i,j){if(k!==false){k=true;}if(this.paused===!!k){return ;}this.paused=!!k;if(k){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(i,j);}},onscroll:function K(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var i=this;this._fillTmr=self.setTimeout(function(){i.fill();i=null;},50);}}if(this._super){this._super();}},fill:function c(i,m){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var n=(this.items&&this.items.length)||0;if(!n){if(m){m();}}else{var k=this.scrollboxNode,o=this.itemsContainerNode,l=mstrmojo.boxmodel.offset(o,k),q=this.listMapper,p=q.findScrollRange(o,n,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||k.scrollTop,k.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||k.scrollLeft,k.clientWidth,l.left,l.top);if(this.fillAt(p.start,p.end)){if(i){i();}var j=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[j].fill(i,m);},100);}else{if(m){m();}}}},fillAt:function M(k,j){var i=this.listMapper;if(i){return i.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,k,j,this.renderBlockSize);}else{return false;}},add:function R(j,i){if(!j||!j.length){return -1;}var k=this.items;if(i==null){i=b.min(this.selectedIndices,false,true);if(i!==null&&i!==undefined){i++;}}if(i==null||i===-1){i=(k&&k.length)||0;}if(k&&k.add){k.add(j,i);}else{this.set("items",k?g.insert(k.concat(),i,j):j);}return i;},preadd:function B(l){if(this.hasRendered){var o=this.listMapper;if(o){o.onadd(this,this.itemsContainerNode,this.ctxtBuilder,l);}var n=this.listBuilder;if(n){n.onadd(this,this.ctxtBuilder,l);}var k=this.listSelector;if(k){k.onadd(this,l);}if(this._eros){this.onscroll();}else{var m=l.index,j=l.value.length;this.fillAt(m,m+j-1);}}if(this.onadd){this.onadd(l);}if(this._super){this._super(l);}},remove:function V(j){if(j==null){return -1;}if(j.constructor!==Array){return this._remove(j);}var l=this.items;if(l){var k;if(l.remove){for(k=j.length-1;k>-1;k--){l.remove(j[k],1);}}else{l=l.concat();for(k=j.length-1;k>-1;k--){l.splice(j[k],1);}this.set("items",l);}return j[0];}return -1;},_remove:function V(k){var j=this.items;if(!j||(k==null)){return -1;}var i;if(!isNaN(k)){i=k;}else{i=this.itemIndex(k);}if(i>-1){if(j.remove){j.remove(i,1);}else{j=j.concat();j.splice(i,1);this.set("items",j);}}return i;},duplicate:function Z(n,j,k){var l=this.items,i=-1;if(!l||(n==null)){return -1;}if(!isNaN(n)){if(j===null||j===undefined){j=n+1;}n=l[n];}else{if(j===null||j===undefined){j=this.itemIndex(n)+1;}}if(n){var m;m=b.copy(k,b.clone(n));i=this.add([m],j);}return i;},preremove:function N(j){if(this.hasRendered){var l=this.listMapper;if(l){l.onremove(this,this.itemsContainerNode,this.ctxtBuilder,j);}var k=this.listBuilder;if(k){k.onremove(this,this.ctxtBuilder,j);}var i=this.listSelector;if(i){i.onremove(this,j);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(j);}if(this._super){this._super(j);}},move:function S(m,s){function p(t,i){return s>=t&&s<=t+i;}var q=(this.items&&this.items.length)||0;if(s===-1||s==null||isNaN(s)){s=q;}else{s=Math.min(s,q);}var l,j,o,n;if(m.constructor===Array){j=m;o=m;n=(j&&j.length)||0;if(p(m[0],m.length)){return false;}l=g.get(this.items,m);}else{if(typeof (m)==="object"){l=[m];n=1;j=this.itemIndex(l[0]);o=[j];if(p(j,1)){return false;}}else{j=m;o=[m];n=1;if(p(j,1)){return false;}l=[this.items[j]];}}for(var k=0;k<n;k++){if(o[k]<=s){s--;}}if(l[0]!=null){this.remove(j);this.add(l,s);}return true;},itemIndex:function F(i){if(i==null){return -1;}var j=this.itemIdField;return j?g.find(this.items,j,i[j]):g.indexOf(this.items,i);},prechange:function U(l){if(this.hasRendered){var k=[this.listBuilder,this.listMapper];for(var m=0,j=k.length;m<j;m++){var n=k[m];if(n&&n.onchange){n.onchange(this,this.itemsContainerNode,this.ctxtBuilder,l);}}}},makeObservable:false,_set_items:function J(o,i){var m=this.items;i=this.initItems(i);this.items=i;if(m!==i){var l=this,k=function(){if(l.autoHide){l.set("visible",!!(i&&i.length));}l=null;},j=this.hasRendered;if(j){this.refresh(k);}else{k();}}return m!==i;},premousedown:function e(i){A(this,"premousedown",i);},premouseup:function Q(i){A(this,"premouseup",i);},scrollTo:function W(j){var i,k=this.listMapper;if(k&&k.toItem){if(!isNaN(j)){i=j;}else{i=this.itemIndex(j);}if(i>=0){k.toItem(this,i);}}},draggable:false,getDragData:function(m){L(this,m.id);var k=O(this,m.src),j=k&&k.idxActual;if((j>-1)&&this.selectedIndices[j]){var l=this.sortSelectedIndices(),i=g.get(this.items,l)||[];switch(i.length){case 1:return b.copy({html:i[0][this.itemDisplayField],index:l[0]},b.copy(i[0]));case 0:return null;default:return b.copy({html:i.length+" selections",indices:l},i);}}},dropZone:false,ondragenter:function(i){L(this,i.id);this.set("dropCuePos",O(this,i.tgt));},ondragover:function(i){this.set("dropCuePos",O(this,i.tgt));},ondragleave:function(i){this.set("dropCuePos",null);},isDragValid:function C(i){return i&&i.src&&i.src.data;},ondragstart:function(i){if(!(i&&i.src&&i.src.data)){return false;}},allowCopy:false,ondragend:function(l){var j=l&&l.tgt,i=j&&j.widget;if(i===this){}else{if(this.tree&&i&&i.tree===this.tree){if(!this.allowCopy||!d.ctrlKey(j.hWin,j.e)){var k=l.src&&l.src.data;if(k&&(k.indices||(k.index!==null))){this.remove(k.indices||k.index);}}}}},ondrop:function(t){var x=t&&t.src,q=x&&x.data;if(q){var l=O(this,t.tgt,false),u=l&&l.idx,m=(q&&q.constructor===Array),k=this.sortSelectedIndices();var o=this.items;u=Math.min(u,o&&o.length)||0;var w=true;if(x.widget===this){w=this.move(k,u);g.forEach(k,function(i){if(i<=u){u--;}});}else{this.add(m?q:[q],u);}if(w){var p=m?q.length:1,j={};for(var n=0;n<p;n++){j[u+n]=true;}this.set("selectedIndices",j);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");var E=mstrmojo.Widget;mstrmojo.ui._IsPulldown=mstrmojo.provide("mstrmojo.ui._IsPulldown",{scriptClass:"mstrmojo.ui._IsPulldown",markupString:'<div id="{@id}" style="{@cssText}" class="mstrmojo-ui-Pulldown {@cssClass}" mstrAttach:mousedown,click><div class="mstrmojo-ui-Pulldown-text {@cssTextClass}" title="{@title}" style="{@labelCssText}">{@value}</div><div class="container"></div></div>',markupSlots:{selectedNode:function D(){return this.domNode.firstChild;},containerNode:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:E.visibleMarkupMethod,onheightChange:E.heightMarkupMethod,onwidthChange:E.widthMarkupMethod,onvalueChange:function F(){this.selectedNode.innerHTML=this.value||"";},onenabledChange:mstrmojo.Widget.enabledMarkupMethod},getPopupList:mstrmojo.emptyFn,anchorSlot:"selectedNode",postBuildRendering:function B(){this._super();this.getPopupList().set("items",this.items);var G=this.selectedIndex,H=this.selectedIndices;if(G!==undefined){this.set("selectedIndex",G);}if(H!==undefined){this.set("selectedIndices",mstrmojo.hash.copy(H||{}));}},onitemsChange:function C(){var G=this.getPopupList();if(G){G.set("items",this.items);}},onPopupWidgetOpened:function(){var G=this.getPopupList();if(G&&(!G.items||G.items.length===0)){G.close();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.boxmodel","mstrmojo.Widget");var Y=mstrmojo.hash,g=mstrmojo.css,L=mstrmojo.dom,d="animate",P="px";function b(h){return Y.copy(((!!mstrApp.isWSStyling)?Y.walk(h,window).boxConfigurationWS:undefined)||Y.walk(h,window).boxConfiguration||mstrmojo.vi.ui._IsBoxLayoutChild.boxConfiguration);}function H(j){var i=j.boxCache,k=i&&i[this.id],h=false;if(!k){h=this.domNode.className.indexOf(d)>-1;this.cacheCtxtBoxPosition(j);}j.boxAnimating=h;}mstrmojo.vi.ui._IsBoxLayoutChild=mstrmojo.provide("mstrmojo.vi.ui._IsBoxLayoutChild",{_mixinName:"mstrmojo.vi.ui._IsBoxLayoutChild",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onzIndexChange:function(){this.domNode.style.zIndex=this.zIndex||1;}},id:null,left:"0px",top:"0px",zIndex:1,draggable:false,dropZone:false,getBoxConfiguration:function C(){return b(this.scriptClass);},getBoxBorderWidth:function I(){return 0;},getMinBoxSize:function A(h){return mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums(this.scriptClass)[h];},getIdentifier:function Q(){return this.id;},updateLayout:function O(j,h){if(Y.equals(j,this._currentLayout)){return ;}var i=this.domNode,l=window.Modernizr,k=this.getBoxBorderWidth();if(i&&h&&l.testProp("transition")){g.addClass(i,d);g.onTransitionEnd(i,function(){g.removeClass(i,d);});}this._currentLayout=Y.copy(j);this.applyBoxSize(Math.max(this.unDocked?parseFloat(j.height):(parseInt(j.height,10)-k),0)+P,Math.max(this.unDocked?parseFloat(j.width):(parseInt(j.width,10)-k),0)+P,j.top,j.left);if(this.hasRendered&&this.doLayout){this.doLayout();}this.postUpdateLayout();},postUpdateLayout:function D(){},applyBoxSize:function Z(h,k,m,l){this.height=h;this.width=k;this.top=m;this.left=l;var j=this.domNode;if(j){var i=this.domNode.style;i.top=m;i.left=l;i.height=h;i.width=k;if(parseInt(h,10)<=0||parseInt(k,10)<=0){i.borderWidth="0";}}},createAvatar:function W(){return this.offsetAvatar(this.domNode);},offsetAvatar:function S(h){h.style.margin="20px 0 0 20px";return h;},setMaskVisibility:function U(h){var i=this.maskNode.style;i.display=h?"block":"none";if(!h){this.resetMask();}},isDragValid:function F(h){return true;},initializeDrag:function G(h){},ondragstart:function f(h){this.initializeDrag(h);delete this._currentLayout;this.parent.beginBoxMove(h,this);if(!this.unDocked){this._super(h);}},ondragend:function N(h){if(!this.unDocked){this._super(h);}this.parent.endBoxMove(h,this);if(!h.dropSuccessful){this.parent.cancelBoxMove(h);}var i=this.domNode;i.style.margin="0";},allowDrop:function K(h){var j=h.src,i=j&&j.widget;return(i&&i.parent===this.parent);},wasDropped:function M(h){},cancelBoxMove:function J(h){return false;},ondragenter:function V(h){this.setMaskVisibility(true);},ondragover:function X(h){H.call(this,h);this.highlightMask(this.parent.getPanelTargetEdge(h)||this.getTargetDropZone(h),h);if(h.boxAnimating){delete h.boxCache[this.id];}},cacheCtxtBoxPosition:function E(i){var h=i.boxCache=i.boxCache||{};h[this.id]=L.position(this.domNode);},ondrop:function c(h){H.call(this,h);var j=h.src.widget;if(j.wasDropped){j.wasDropped(h);}var i=this.parent;if(j.parent===i){i.dropBox(h,this,this.maskNode.zone,true);}this.setMaskVisibility(false);},ondragleave:function B(){this.setMaskVisibility(false);},highlightMask:function e(k,j){var h=this.maskNode,i=j.boxAnimating;if(k!==h.zone||i||h.isAnimating!==i){h.zone=k;h.isAnimating=i;this.parent.updateDropCue(k,j,j.boxCache[this.id]);}},getTargetDropZone:function R(h){return mstrmojo.boxmodel.getEdgeQuadrantByPoint(h.boxCache[this.id],h.tgt.pos);},resetMask:function a(){this.parent.updateDropCue("");var h=this.maskNode;delete h.zone;delete h.isAnimating;},getBoxDimension:mstrmojo.emptyFn,postDropBox:mstrmojo.emptyFn});mstrmojo.vi.ui._IsBoxLayoutChild.boxConfiguration={addToEnd:true};mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums=function(h){var i=b(h);return Y.copy(i.minSize||i.f||{h:75,v:75});};mstrmojo.vi.ui._IsBoxLayoutChild.BoxConfigurationType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.Widget;mstrmojo.ui.Checkbox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.Checkbox",markupString:'<div id="{@id}" class="mstrmojo-ui-Checkbox {@cssClass}" mstrAttach:click></div>',markupMethods:{onvisibleChange:C.visibleMarkupMethod,oncheckedChange:function B(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},onenabledChange:C.enabledMarkupMethod},checked:false,onclick:function A(){this.set("checked",!this.checked);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.css","mstrmojo.string");function A(C,B){return mstrmojo.hash.copy(B,{label:"",tabIndex:"",cssDisplay:"inline",name:null,markupString:'<span id="{@id}" class="'+C+' {@cssClass}" style="{@cssText}" title="{@tooltip}"><input id="{@id}_input"  type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click tstid="{@tstid}"/><label for="{@id}_input">{@label}</label></span>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,"disabled");},onlabelChange:function(){this.labelNode.innerHTML=mstrmojo.string.encodeHtmlString(this.label);},oncheckedChange:function(){this.inputNode.checked=this.checked;}},checked:false,preclick:function(){this.set("checked",this.inputNode.checked);},isChecked:function(){return this.inputNode.checked;}});}mstrmojo.CheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox",{scriptClass:"mstrmojo.CheckBox",type:"checkbox"}));mstrmojo.ImageCheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox mstrmojo-ImageCheckBox",{scriptClass:"mstrmojo.CheckBox",type:"image",cssDisplay:"block",preclick:function(){this.set("checked",!this.checked);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncheckedChange=function(){mstrmojo.css.toggleClass(this.inputNode,["checked"],this.checked);};},postBuildRendering:function(){this.inputNode.src=this.src||"../images/1ptrans.gif";if(this._super){return this._super();}return true;}}));mstrmojo.RadioButton=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-RadioButton",{scriptClass:"mstrmojo.RadioButton",type:"radio",postBuildRendering:function(){if(mstrmojo.dom.isIE){this.inputNode.checked=this.checked;}}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var C=mstrmojo.dom,B=mstrmojo.hash,E=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:function(){E.toggleClass(this.domNode,"disabled",!this.enabled);},onselectedChange:function(){E.toggleClass(this.domNode,"selected",this.selected);},ontextChange:function(){this.textNode.innerHTML=this.text;},ontitleChange:function(){this.domNode.title=this.title;},onwidthChange:mstrmojo.Widget.widthMarkupMethod},oniconClassChange:function D(J){var K=this.domNode;if(this.hasRendered&&K){K.className=K.className.replace(J.valueWas,"")+" "+J.value;}},onclick:mstrmojo.emptyFn,ontouchend:function I(J){this.onclick(J);}});mstrmojo.Button.newIconButton=function H(L,O,M,J,N){var K={scriptClass:"mstrmojo.Button",title:L,cssClass:O,text:"",onclick:M};if(J){K.bindings=J;}B.copy(N,K);return K;};function F(M,N,J,P){var L=[];if(J){L.push(J);}var O=P&&P.cssClass;if(O){L.push(O);delete P.cssClass;}var K={scriptClass:"mstrmojo.Button",cssClass:L.join(" "),text:M};if(N){K.onclick=N;}return B.copy(P,K);}mstrmojo.Button.newInteractiveButton=function G(M,N,P,O){var L={glowClass:"glow"};if(P&&(C.isFF||C.isWK)){B.copy({onmousedown:function J(){E.applyShadow(this.domNode,0,0,10,P);},onmouseup:function K(){E.removeShadow(this.domNode);}},L);}return F(M,N,"mstrmojo-InteractiveButton",B.copy(O,L));};mstrmojo.Button.newWebButton=function A(K,J,M,L){return F(K,J,"mstrmojo-WebButton"+(M?" hot":""),L);};mstrmojo.Button.newActionButton=function(K,L,M){var J=mstrmojo.Button.newWebButton(K,L,false,M);J.cssClass=J.cssClass+" action-button";return J;};}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.DocDataService","mstrmojo.mstr.EnumWebAPIErrorCodes");var G=mstrmojo.hash.copy,S=mstrmojo.func,X=S.wrapMethods,Y=mstrmojo.mstr.EnumWebAPIErrorCodes;var K=1,E=2,A=3;var P={FIRST:1,MIDDLE:2,LAST:3};var O={BUSY:1,INTERIM:2,DONE:3,SILENT:4,CANCELED:5};var F=G(mstrmojo.DocDataService.SUPPRESS_DATA,{preserveUndo:true,config:{silent:true}});function B(Z,b,a){if(b.stid==="undefined"){a.submission=function(f,c,d){var g=d.params,e=JSON.parse(g.params);e.actions[0].stid=Z.action===K?Z.undoStateId:Z.redoStateId;g.params=JSON.stringify(e);};}return a;}function H(a,e){var b=a.mgr;e.disablePU=true;var d=B(a,e,{success:function c(){a.state=O.DONE;},failure:function Z(){b.onFailure();}});a.state=O.SILENT;b.dataService.submitUpdates(e,d,F);b.onSuccess(a);}function W(j,e){var i=j.urInfo,h=i.puKeys,o=i.puObjs,f=i.puFilters,k=j.mgr,g=k.model,l=k.dataService;if(h||o){if(h){e.partialRetrieval={nodes:h,filters:f};}if(o){g.addUpdateObjects(e,o);}}else{e.disablePU=true;}var c=B(j,e,{success:function n(){j.state=O.DONE;k.onSuccess(j);g.restoreUIState(j.action===K?j.undoUIState:j.redoUIState);},failure:function b(){k.onFailure();},complete:function a(){k.resetState();}}),Z=i.callback||g.getRebuildCallback(),m=X(Z,c),d=G(i.extras);if(e.act==="undo"&&d!==undefined){d.hideCancel=true;if(e.killJob){d.message=mstrmojo.desc(14586,"Canceling...");}}j.state=O.BUSY;l.submitUpdates(e,m,d);}function M(c){var Z=c.urInfo,a=c.mgr.model;if(!Z.extras){var b=(Z.treesToRender!==undefined)?Z.treesToRender:c._treesFromRes;if(!Z.disablePU&&!c._hasFullUpdate&&(!Z.puKeys||!Z.puKeys.length)){b=0;Z.callback=X(a.getDatasetsUpdateCallback(),Z.callback);}Z.extras={style:{params:{treesToRender:b}}};}}mstrmojo.vi.controllers.UICmd=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmd",mgr:null,redoStateId:null,undoStateId:null,execute:mstrmojo.getMissingFn(),discard:mstrmojo.emptyFn,isUntracked:false,action:null,state:O.INTERIM,urInfo:null,getStateValue:function V(a,Z){return this.action===K?Z:a;},init:function Q(Z){G(Z,this);this._treesFromRes=0;this.urInfo=this.urInfo||{};this.submitCount=0;},undoRedo:function I(f){var b=this,d,a=this.urInfo,Z=a.silent,g,c=this.mgr,e=c.dataService;if(b.action===A){d={act:"redo",stid:b.redoStateId};g=a.redo;}else{if(b.action===K){d={act:"undo",stid:b.undoStateId,killJob:f};g=a.undo;}else{c.handleError();}}if(g){e.blockRequests=true;try{Z=!!g.call(b)||Z;}finally{e.blockRequests=false;}}if(Z){H(b,d);}else{W(b,d);}},submitUpdate:function J(a,Z){this.submit(a.actions,a.callback,a.extras,Z);},submit:function L(d,n,c,l){var i=this,j=i.mgr,f=j.model,k=j.dataService,h=mstrmojo.array.ensureArray(d);n=n?G(n):f.getRebuildCallback();i.state=O.BUSY;function e(o,p){return !(o&&o[p]&&o[p].length);}if(i._hasFullUpdate||h.some(function(o){return o.disablePU;})||h.every(function(p){var q=p.partialRetrieval,o=p.partialUpdate;return e(q,"nodes")&&e(o,"nodes")&&e(o,"selectors")&&e(o,"objects");})){i._hasFullUpdate=true;}S.override({submission:function b(){if(i.submitCount===0){i.undoStateId=k.stid;}i.submitCount++;},success:function m(t,u){if(i.action!==E){j.handleError();}i.redoStateId=t.stid;var s=!l||l===P.LAST;if(s){i.state=O.DONE;}else{i.state=O.INTERIM;}var q=i.urInfo;if(!q.disablePU){var o=q.puKeys||[],w=t.pukeys&&t.pukeys.split("\u001E");if(w&&w.length){o=o.concat(w);var p=q.extraPuKeys;if(p){o=o.concat(p);delete q.extraPuKeys;}}if(o.length){q.puKeys=o;}}i._treesFromRes|=(t.defn?1:0)|(t.data?2:0);if(this._super){this._super(t,u);}if(s){i.completeSubmit();}},failure:function a(o,s){var q=(c&&c.skipUICmdMgrOnFailure)||[],p=parseInt(o.code||(o.getResponseHeader&&o.getResponseHeader("X-MSTR-TaskErrorCode")||Y.UICMD_DEFAULT_ERROR),10);if(q.indexOf(p)===-1&&q.indexOf(mstrmojo.mstr.EnumWebAPIErrorCodes.E_UNUSED)===-1){j.onFailure();}if(this._super){this._super(o,s);}},canceled:function g(o){if(this._super){this._super(o);}window.setTimeout(function(){i.cancel(true);},0);},complete:function Z(){if(!l||l===P.LAST){j.resetState();}if(this._super){this._super();}}},n);k.submitUpdates(d,n,c);},submitInterim:function R(a,b,Z){this.submit(a,b,Z,P.MIDDLE);},resetCmdMgrOnComplete:function C(){this._resetMgr=true;},completeSubmit:function N(){var a=this,b=a.mgr,Z=b.model;if(!a.completed){a.completed=true;a.state=O.DONE;b.onSuccess(a);M(a);a.redoUIState=Z.getUIState();if(a.isUntracked){b.untrackLastCmd();}else{if(a._resetMgr){b.reset();}}}},cancel:function D(Z){this.state=O.CANCELED;if(this._hasFullUpdate){this._treesFromRes=3;}M(this);this.mgr.onCancel(this,Z);},submitSilent:function U(b){var d=this,e=d.mgr,c=e.model,f=e.dataService;d.state=O.SILENT;e.onSuccess(d);d.redoUIState=c.getUIState();var g={submission:function a(){d.undoStateId=f.stid;d.submitCount++;},success:function h(i){d.state=O.DONE;d.redoStateId=i.stid;},failure:function Z(){e.onFailure();}};f.submitUpdates(b,g,F);}});mstrmojo.vi.controllers.UICmd.CMD_PHASE=P;mstrmojo.vi.controllers.UICmd.CMD_STATE=O;mstrmojo.vi.controllers.UICmd.CMD_ACT_TYPE={UNDO:K,EXEC:E,REDO:A};}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.DocDataService");mstrmojo.vi.models.PanelFormatSaver=mstrmojo.provide("mstrmojo.vi.models.PanelFormatSaver",{getPanelSaver:function A(C,B,D){return{saveProperty:function E(G,H){var J=B[G];if(J){if(J.convert){H=mstrmojo.boxmodel.px2Inches(C.getZoomProps(),H);}var I={},F=I[J.set]={};F[J.name]=H;C.updateUnitFormat(D||C.getRootNode(),1,I,undefined,mstrmojo.DocDataService.RAPID_EXEC);}}};}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.DocDataService","mstrmojo.mstr.EnumFunction","mstrmojo.warehouse.EnumDatabaseType","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(5421,5422,13355);var P=mstrmojo.hash,L=mstrmojo.array,F=mstrmojo.desc,G=mstrmojo.DocDataService,C=mstrmojo.string,a=mstrmojo.mstr.EnumFunction,b=mstrmojo.mstr.EnumDSSXMLObjectTypes;var c=1;function K(n,d,t,x){var g=n.model,p=n.cmSelCells,u=[],AE=g.getCellTitleInfo(d).title,AG,y,j=function(e){var i=n.getCellForNode(e);u.push(n.getCellUnitIndex(i));AG=i.dpt;},o,AB=d.lv>=0,AH;if(typeof x==="string"&&x.indexOf(";")>0){y=parseInt(x.substring(x.indexOf(";")+1),10);x=parseInt(x.substring(0,x.indexOf(";")),10);}if(y===1&&!t){p.reverse().forEach(j);}else{if(y===1){o=1;p.forEach(j);}else{p.forEach(j);}}AH={oId:AE.id,oTp:AE.otp,depth:AG,ordinals:u.join(","),sliceId:n.sid,viewKey:n.k,funcVal:x,switchOrder:o,art:g.getObjectInfoFromDataset(AE.id).art,isRA:AB};if(AB&&x===a.FunctionApplySimple){var s=g.docModel.datasets[g.data.datasetId];if(s&&s.tables&&s.tables.length>=0&&s.tables[0].dbt===mstrmojo.warehouse.EnumDatabaseType.EssBase){AH.peName=AE.v||AE.n;}else{var k=n.getCellForNode(p[0]),AF=k._e.id;AH.peId=AF;AH.peName=k._e.ori_n||k._e.n;try{if(AE.fix>=0){var h=g.docModel.findUnitInDataSet(AE.id).fs,m=L.filterOne(h,function(e){return e.fnm==="DESC";}).fid;if(m){var AC=n.dataBlocks&&n.dataBlocks[k._gd]||g.data,AA=AC.gts[(AE.axis===c)?"row":"col"],l=L.filterOne(AA,function(e){return e.id===AE.id&&e.fid===m;}),AD=l.es[k.idx];AH.peName=AD&&(AD.ori_n||AD.n)||AH.peName;}}else{var q;L.forEach(AE.fs,function(w,e){if(w.n==="DESC"){q=e;return false;}});if(q!==undefined){var f=[];if(AE.axis===c){var z;for(z=k.idx;z>-1;z--){if(AE.es[z].id===AF){f=[AE.es[z].ori_n||AE.es[z].n].concat(f);}else{break;}}for(z=k.idx+1;z<AE.es.length;z++){if(AE.es[z].id===AF){f.push(AE.es[z].ori_n||AE.es[z].n);}else{break;}}}else{f=L.map(L.filter(AE.es,function(i){return i.id===AF;}),function(i){return i.ori_n||i.n;});}AH.peName=f[q]||AH.peName;}}}catch(AD){}}}return AH;}function D(f,e,h){var k=f.getDEInfo(e),j=k&&k.deObject&&k.deObject.des,i=1,g=h===-1?F(5187,"Group"):(h===a.FunctionApplySimple?F(13355,"Calculated Member"):F(5188,"Calculation")),d=function(l){return l.n===g+" "+i;};while(true&&j){if(j.some(d)){i++;}else{break;}}f.controller.onAddQuickDE(f,P.copy(K(f,e,false,h),{act:"addQuickDE",deName:g+" "+i}));}function Z(d,f){var e;for(e in d){if(L.find(d[e].att,"did",f)>-1){return e;}}return undefined;}function X(d){var f=d.split(";"),e;if(f.length>1&&f[f.length-2].slice(-1)!=="//"){f.splice(-1,1);}e=f.join(";");return e.replace(/\\:/g,"*:").replace(/\\;/g,";").replace(/\\\\/g,"\\").substring(1);}function A(p,e,l,h,d){var k=l.es,f=l.id,j;d.forEach(function(q){j=q[0];if(j.eid.indexOf(f)<0){k.push({n:C.decodeHtmlString(j.v,true),t:mstrmojo.vi.enums.EnumDerivedElementType.LIST,v:X(j.eid)});}});var g=p.controller,o=p.model&&p.model.docModel,n=g._getXtabCallback(p),i={act:"applyDEChanges",deId:e.did,attId:e.attId,attName:e.attName,dsId:e.dsId,k:p&&p.k,actions:[V(l,h)]};o.addUpdateObjects(i,{id:i.deId||i.attId,type:47,flag:G.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});n=mstrmojo.func.wrapMethods(n,o.getDatasetsUpdateCallback(),o.getUpdateHiddenLayoutsCallback(),{success:function(){o.callOnNDECreated([l]);}});var m=function(q){return function(){if(i&&q){i.partialRetrieval={nodes:Y(p,o,e)};}var s=q?o.wrapUnsetVisualizationFilterAction(i):i;g.submitUndoRedoUpdates(s,{},n,G.REQUEST_DEFN_DATA);};};o.checkAndNotifyVFChangeOnGroupUpdate({actions:i},m(true),m(false));}function V(e,d){return{act:"update",position:d+1,item:e};}function E(f,e,i,h,g){var d=f.model.getCellTitleInfo(e).title;f.controller.onSetDEHierachyOptions(f,{act:"setDEHierarchyOptions",oId:d.id,eId:i.id,splice:h,expand:g});}function O(h,e){var d=[],g=e.t,f=e.did;h.getDropZones().zones.forEach(function(i){((i&&i.items)||[]).forEach(function(k){var l=k.t,j=k.did;if(l!==21&&j!=="-1"&&j!=="00000000000000000000000000000000"&&((l===4&&g===4)||(l!==4&&g!==4))&&j!==f&&L.find(d,"did",j)===-1){d.push(k);}});});h.docModel.getDatasetUnits(g===4?["mx"]:["att"]).forEach(function(i){if(L.find(d,"did",i.did)===-1&&i.did!==f&&!i.hide){d.push(i);}});return mstrmojo.vi.ui.DatasetUnitMenuUtils.getSortedDatasetUnits(d);}function Y(g,d,f){var e=d.getSourceFilterKeys(g.zonesModel.getHost().k);L.forEach(g.parent.parent.children,function(j){var h=j.boxContent.gridInfo;if(h){var k=(h.rows.concat(h.cols)).some(function(l){return l.did===f.did;}),i=e.some(function(l){return l===j.k;});if(k&&!i){e.push(j.k);}}});return e;}mstrmojo.vi.ui.rw._XtabDE=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabDE",{scriptClass:"mstrmojo.vi.ui.rw._XtabDE",derivedElementGroup:function M(d){D(this,d,-1);},addElementsToGroup:function N(f,g,e,d){A(this,f,g,e,d);},derivedElementCalculation:function B(e,d){D(this,e,d);},separateOthers:function Q(d,e){E(this,d,e,1,1);},renameDEList:function I(d){this.controller.onEditQuickDEList(this,P.copy(K(this,d,true,-1),{act:"editQuickDEList",deName:d.v}));},editQuickDECalculationNumberFormat:function J(e,f){var d=K(this,e);d.deId=f.de.id;d.act="editQuickDECalculationNumberFormat";this.controller.editQuickDECalculationNumberFormat(this,P.copy(d,this.model.docModel.createNumberFormatParams(f)));},editDECalculation:function H(e,d){if(d!==undefined&&d!==null){this.controller.editQuickDECalculation(this,P.copy(K(this,e,true,d),{act:"editQuickDECalculation"}));}else{this.controller.onEditQuickDECalculation(this,P.copy(K(this,e,true),{act:"editQuickDECalculation",deName:e.v}));}},createDEParam:function K(d,f,e){return K(this,d,f,e);},removeQuickDE:function S(k,o){var h=o&&o.deObject,i=(h&&h.des)||[],p=this,q=2,n=L.filter(i,function(t){return !t.ido;},{max:q+1});if(h&&(i.length<=q||n.length<=q)){var j=[],m=this.zonesModel.getZoneForObject(h.did),f=O(this.zonesModel,h),e=L.find(f,"did",h.attId),d=e>=0?f[e]:null,l={};if(d&&m){j.push(P.copy({isUngroup:1,deId:h.did},this.model.getAddTemplateUnitAction(d,h.dsId,m.id,L.find(m.items,"did",h.did))));j=[this.zonesModel.getUpdateTemplateAction(j)];l=this.controller._getXtabCallback(this);}j.push({act:"removeNDEFromDS",dsid:h.dsId,oid:h.did,disablePU:true});l=mstrmojo.func.wrapMethods(this.controller.model.getDatasetsUpdateCallback(),this.controller.model.getReloadLayoutModelCallback(),l,this.controller.getReloadLayoutViewCallback());var s=p.model&&p.model.docModel;var g=function(t){return function(){var u=(t&&s)?s.wrapUnsetVisualizationFilterAction(j):j;p.controller.submitUndoRedoUpdates(u,null,l,G.REQUEST_DEFN_DATA);};};s&&s.checkAndNotifyVFChangeOnGroupUpdate({actions:j,zm:s},g(true),g(false));}else{this.controller.removeQuickDE(this,P.copy(K(this,k),{act:"removeQuickDE"}));}},derivedElementsEdit:function U(l,g){if(!g){g=this.getDEInfo(l);}var h=this.model,e=h.getCellTitleInfo(l).title,f=g&&g.deObject,k=g&&g.de,d,j,i;if(!f){d=this.gridData.datasetId||Z(h.docModel.datasets,e.id);j=e.id;i=e.n?C.decodeHtmlString(e.n):undefined;}this.controller.openDEEditor(this,{dsId:d,attId:j,attName:i,deObj:f,elemId:k&&k.id,dispName:l.n?C.decodeHtmlString(l.n):i});},getDEInfo:function W(l){var g=this.model,i=g.getCellTitleInfo(l),j=i.isSrcTitle,e=i.title,d=l.dei,f,k;if((e&&e.ost!==12033)||(j&&l.otp!==b.Consolidation)){return null;}var h=(e&&e.id)||(j&&l.otp===b.Consolidation&&l.id);f=g.docModel.getDEObject(h);if(f&&d!==undefined){k=f.des[d];}return{deObject:f,de:k,ttl:e};},getOthersDEInfo:function R(e){var d;L.forEach(e.des,function(f){if(f.t===4){d=f;return false;}});return d;}});}());(function(){mstrmojo.requiresCls("mstrmojo.util.ui._HostsSplitter","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.dom","mstrmojo.array","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.hash","mstrmojo.css");var h=mstrmojo.array,W=mstrmojo.hash,D=mstrmojo.css,S=mstrmojo.dom,n=mstrmojo.models.FormatModel,q=n.getFormatUpdate,i=n.ENUM_PROPERTY_NAMES,K={h:{dimension:{shared:"width",full:"height"},position:{shared:"left",full:"top"}},v:{dimension:{shared:"height",full:"width"},position:{shared:"top",full:"left"}}},O=mstrmojo.DocDataService.SUPPRESS_DATA,L=mstrmojo.DocDataService.RAPID_EXEC;mstrmojo.vi.ui.BoxLayoutDimensionsType=null;function J(AA){var z=W.copy(AA);var y="px";z.left=Math.max(z.left,0)+y;z.top=Math.max(z.top,0)+y;z.height=Math.max(z.height,0)+y;z.width=Math.max(z.width,0)+y;return z;}function u(AA,AD,AC,z){var AE=K[AA].dimension,y=K[AA].position,AB={};AB[AE.shared]=AD;AB[AE.full]=AC[AE.full];AB[y.shared]=z;AB[y.full]=AC[y.full];return AB;}function P(y,AE,AC,AD){var AB=y==="v"?"h":"v",AA=[],z=function(AF){if(AF===y){return AA.reduce(function(AG,AH){return AG+AH[y];},0);}return Math.max.apply(null,AA.map(function(AG){return AG[AB];}));};AE.forEach(function(AF,AG){var AH={};if(AF.t===this.componentType||AF.t===this.floatType){AH=mstrmojo.vi.ui.BoxLayoutConfig.getMinimumChildSizes(AF,y,AD);}else{AH=P.call(this,AF.o,AF.children,AC,AD);}if(AG!==AE.length-1){AH[y]+=AC;}AA.push(AH);},this);return{sizes:AA.map(function(AF){return AF[y];}),v:z("v"),h:z("h")};}function k(z,AO,AD,AH,AQ){var y=P.call(this,z,AO,AH,AQ),AS=K[z].dimension.shared,AM=AD[AS],AL=AM,AF=AO.length-1,AC=0,AT=false,AE=function(AV,AU){return AU===AF?AV:AV+AH;},AA=0,AB={},AR={},AJ=false,AG=function(AV){var AU=this.getUnitByKey&&this.getUnitByKey(AV);return AU&&AU.height&&parseInt(AU.height,10)||0;};AO.forEach(function(AW,AU){var AV=parseFloat(AW.l);if(AW.f){AM-=AE(AV,AU);AT=true;}else{AC+=AV;}});var AK=!AT&&AC===0;if(AK){AC=100*AO.length;}if(AC>100){AJ=true;}AO.forEach(function(AV,AU){var AX=AK?100:AV.l;if(AV.f){AB[AU]=AE(AX,AU);return ;}var AW=AJ&&AV.type===this.componentType?AG.call(this,AV.k):Math.round(AM*(AX/AC)),AY=y.sizes[AU];if(AY>AW){AB[AU]=AY;AA+=AY-AW;return ;}AR[AU]={c:AW,m:AY};}.bind(this));if(AA){var AI=function(){var AW=Object.keys(AR),AV=Math.floor(AA/AW.length),AU=true;AW.forEach(function(AX){var AY=AR[AX];if(AY.m>AY.c-AV){AB[AX]=AY.m;AA-=AY.c-AY.m;AU=false;delete AR[AX];}});if(AU){AW.forEach(function(AX){AB[AX]=AR[AX].c-AV;});AR={};return ;}AI();};AI();}Object.keys(AR).forEach(function(AU){AB[AU]=AR[AU].c;});var AN=Object.keys(AB).map(function(AV,AU){return AB[AV]-(AU<AF?AH:0);}),AP=AL-AN.reduce(h.fnReduceNumber,0)-(AF*AH);if(AP!==0){if(AN[AF]+AP<=0){AD[AS]-=AP;}else{AN[AF]+=AP;}}return AN;}var M=document.createElement("div");M.setAttribute("unselectable","on");M.className="splitter";mstrmojo.vi.ui._HasBoxLayout=mstrmojo.provide("mstrmojo.vi.ui._HasBoxLayout",{_mixinName:"mstrmojo.vi.ui._HasBoxLayout",boxType:"b",componentType:"c",floatType:"flc",boxLayoutConfig:null,firstBoxId:null,firstVizBoxId:null,splitterCache:null,splittersInfo:null,isInteractive:true,allowPanelEdgeTargeting:false,postBuildBoxLayout:mstrmojo.emptyFn,postCalculateBoxLayout:null,getBoxLayoutSaveAction:function X(y,z){return this.model.getUnitFormatAction(this,1,q(i.LAYOUT_XML,y),z);},getBoxLayoutSaveCallback:function l(){return null;},getChildPositionActions:function G(y){return[];},saveBoxLayout:function f(y,AG,AI,AC,AD,z){var AF=this.boxLayoutConfig,AE=this.model,AH=AE.getDataService(),AB=[].concat(this.getBoxLayoutSaveAction(AF.getBoxState(),AD)).concat(this.getChildPositionActions(AD)),AA=W.copy(z,W.copy(L,{preserveUndo:true}));AI=AI||{success:mstrmojo.emptyFn};if(!AC){if(y){y.submit(AB,AI,AA,AG);}else{AH.submitUpdates(AB,AI,AA);}}else{AC.add(AB,AI);}},buildBoxLayout:function N(AB,AE){var AC=this.boxLayoutConfig;if(!AC||(this.height===undefined&&this.width===undefined)){return ;}if(AE){AC.box=AE;}var AA={height:parseInt(this.height,10),width:parseInt(this.width,10),top:0,left:0},AH=this.calculateBoxLayout(AC,AA),AN=AH.box,AI=AC.identifier,AD=this.children,AG=AC.boxPaths={};this.firstVizBoxId=null;var AM=Infinity,z=Infinity,AL=-1,AF=-1;Object.keys(AN).forEach(function(AO){var AP=AD[h.find(AD,AI,AO)];if(AP&&AP.scriptClass==="mstrmojo.vi.ui.rw.VizBox"){AL=parseInt(AP.top,10);AF=parseInt(AP.left,10);if(z>AL){z=AL;AM=AF;this.firstVizBoxId=AP.id;}else{if(z===AL){if(AM>AF){AM=AF;this.firstVizBoxId=AP.id;}}}}},this);this.firstBoxId=null;Object.keys(AN).forEach(function(AP){var AQ=AD[h.find(AD,AI,AP)];if(AQ){var AO=AN[AP],AR=AQ.id;if(AO.first){this.firstBoxId=AR;}AO.boxChild.id=AR;AG[AP]=AO.boxLevel;AQ.updateLayout(AO.dim,AB);}},this);if(!this.firstBoxId&&(AC.box.floatChildren||[]).length){this.firstBoxId=AD[h.find(AD,AI,AC.box.floatChildren.slice(-1).pop().k)].id;}var AJ=this.getSplitterHost();this.splittersInfo=AH.splitter;this.updateSplitters();if(AJ){var AK=AJ.style,y=AH.size;AK.height=y.height+"px";AK.width=y.width+"px";}if(this.updateScrollbars&&(!mstrApp.isAppStatePresentation()||mstrApp.isDossier)&&!this.model.isFreeFormPanel()){this.updateScrollbars();}this.postBuildBoxLayout();delete AC.dirty;},postBuildRendering:function Y(){var y=this._super();this.updateSplitters();return y;},updateSplitters:function g(){if(!this.splittersInfo){return ;}var z=this.splitterCache=this.splitterCache||[],y=this.splittersInfo,AA=this.getSplitterHost();if(AA){y.forEach(function(AF,AD){var AB=AF.dim;var AE=z[AD];if(!AE){AE=z[AD]=M.cloneNode(false);this.registerSplitter(AE);}AE.path=AF.boxLevel;AE.orientation=AF.orientation;var AC=AE.style;W.copy(J(AB),AC);AC.display="block";D.toggleClass(AE,"v",AF.orientation==="h");if(!AE.parentNode){AA.appendChild(AE);}},this);z.slice(y.length).forEach(function(AB){AB.style.display="none";});this.splittersInfo=null;}},calculateBoxLayout:function R(z,AE){var AD=z.padding||0,AC=[],AG={},y=[];var AB=function(AR,AH,AI){var AJ=AR.o,AN=K[AJ].dimension,AP=K[AJ].position,AK=AN.shared,AL=AP.shared,AT=AH[AL],AQ=AR.floatChildren,AS=AQ&&AQ.length?AR.floatChildren:AR.children,AO=AS.length-1,AM=k.call(this,AJ,AS,AH,AD,z);if(AC.length===AI){AC[AI]=-1;}AS.forEach(function(AV,AX){var AZ=AV.t,Aa=AM[AX],AY=u.call(this,AJ,Aa,AH,AT);if(AV.height!==undefined&&AV.width!==undefined){AV.height=AV.height.split("|")[0]+"|"+AY.height;AV.width=AV.width.split("|")[0]+"|"+AY.width;}else{AV.h=AY.height;AV.w=AY.width;}AC[AI]=AC[AI]+1;var AW=AC.join("|");if(AZ===this.componentType||AZ===this.floatType){AG[AV[z.identifier]]={boxLevel:AW,boxChild:AV,dim:J(AY),first:(AY.top===0&&AY.left===0)};}else{if(AZ===this.boxType){AB.call(this,AV,AY,AI+1);AC.splice(AI+1);}}if(this.isInteractive&&!AV.r&&AX<AO){var AU=(JSON.parse(JSON.stringify(AY)));AU[AL]+=Aa;AU[AK]=AD;y.push({boxLevel:AW,dim:AU,orientation:AJ});}AT+=Aa+AD;},this);};var AA=z.box||z.useDefaultBox(this.children),AF=P.call(this,AA.o,AA.children,AD,z);AE.height=Math.max(AE.height,AF.v);AE.width=Math.max(AE.width,AF.h);if(this.postCalculateBoxLayout){AA=this.postCalculateBoxLayout(AA,AE,AB);if(AA&&z.box){z.box=AA;}}if(AA){AB.call(this,AA,AE,0);}return{box:AG,splitter:y,size:{height:AE.height,width:AE.width}};},calculateBoxLayoutManual:function C(y,AG){var AF=y.padding||0,AE=[],AC=y.box,AA={children:[],floatChildren:[],m:"m",o:AC.o,t:AC.t},AH=2,AD=this;var AB=function(AP,AJ,AK){var AL=AP.o,AO=K[AL].position,AM=AO.shared,AR=AJ[AM],AQ=AP.children,AN=k.call(this,AL,AQ,AJ,AF,y);AQ.forEach(function(AT,AU){var AW=AT.t,AX=AN[AU],AV=u.call(this,AL,AX,AJ,AR);AT.h=AV.height;AT.w=AV.width;if(AW===this.componentType){var AS={};AS.fixed="0";AS.k=AT.k;AS.rk=AD.k;AS.t=AD.floatType;AS.zIndex=""+AH++;AS.top=AV.top/AG.height*100;AS.left=AV.left/AG.width*100;AS.width=AV.width/AG.width*100;AS.height=AV.height/AG.height*100;AS.l=AL==="v"?AS.height:AS.width;AS.top+="|"+AV.top+"px";AS.left+="|"+AV.left+"px";AS.width+="|"+AV.width+"px";AS.height+="|"+AV.height+"px";AA.floatChildren.push(AS);}else{if(AW===this.boxType){AB.call(this,AT,AV,AK+1);AE.splice(AK+1);}}AR+=AX+AF;},this);};var z=y.box||y.useDefaultBox(this.children),AI=P.call(this,z.o,z.children,AF,y);AG.height=Math.max(AG.height,AI.v);AG.width=Math.max(AG.width,AI.h);if(this.postCalculateBoxLayout){z=this.postCalculateBoxLayout(z,AG,AB);if(z&&y.box){y.box=z;}}if(z){AB.call(this,z,AG,0);}return{box:AA,size:{height:AG.height,width:AG.width}};},updateBoxPaths:function w(){var AA=[],z=this.boxLayoutConfig,AB=this.boxLayoutConfig.boxPaths={};var y=function(AC,AD){if(AA.length===AD){AA[AD]=-1;}AC.children.forEach(function(AE){var AG=AE.t;AA[AD]=AA[AD]+1;var AF=AA.join("|");if(AG===this.componentType||AG===this.floatType){AB[AE[z.identifier]]=AF;}else{if(AG===this.boxType){y.call(this,AE,AD+1);AA.splice(AD+1);}}},this);};y.call(this,z.box,0);},getBoxLayoutChild:function a(y){var z=y.id;if(z){return mstrmojo.all[z];}return null;},setDimensions:function o(AA,y){if(this.height!==AA||this.width!==y||(this.parent&&this.parent.forceLayout)){this.height=AA;this.width=y;if(this.hasRendered){var z=this.domNode.style;z.height=AA;z.width=y;}this.buildBoxLayout();}},onAppStateChange:function j(y){this.isInteractive=!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()||mstrApp.isLayoutModePreview());},onLayoutModeChange:function V(y){this.isInteractive=!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()||mstrApp.isLayoutPreview(y.value));},getSplitterInfo:function t(AA){var AC=AA.path,z=AA.orientation,y=this.boxLayoutConfig.getResizeBoundaries(AC,z),AB=parseInt(z==="v"?this.height:this.width,10);return{path:AC,min:y.min,max:AB-y.max};},shouldSaveSplitterMoves:function E(){return !mstrApp.hasRequests();},splitterMoved:function U(y,AE){var AC=this,z=AC.boxLayoutConfig,AB=AC.model,AD=mstrmojo.DocDataService,AA=function(AF){z.resizeBox(AE.path,y);AC.buildBoxLayout();AC.saveBoxLayout(AF);};if(this.shouldSaveSplitterMoves()){AB.execute({execute:function(){AA(this);},urInfo:{callback:AD.EMPTY_CALLBACK,extras:AD.SUPPRESS_DATA}});}else{AA();}},insertNewBox:function F(AB,z,AA,AC){var y=this.boxLayoutConfig;if(AC){AC.oldBoxState=y.getBoxState();}if(z){y.addDropBox(z,AA,{box:{boxId:AB.id}});}else{y.insertNewRootChild(AB,AA);this.buildBoxLayout(true);}},insertNewBoxAndSaveDeferred:function(AD,AA,AB,AC,y,z){this.insertNewBox(AA,y,z);this.saveBoxLayout(undefined,-1,AC,AD);},deleteBoxAndSubmitDeferred:function(AC,z,AB,AA,y){this.deleteBox(z,y);this.saveBoxLayout(undefined,-1,AB,AC,AA);},deleteBox:function b(y,z){this.boxLayoutConfig.deleteBox(y,z);this.removeChildren(y);if(this.isManualMode&&this.isManualMode()){this.buildBoxLayout(false);}},deleteBoxAndSubmit:function s(z,AC,y){var AB=this.model.getDataService(),AA=this;this.model.execute({execute:function(){var AD=this,AE=AB.newUpdate(AD,AC);AA.deleteBoxAndSubmitDeferred(AE,z);AE.addExtras(W.copy(O,y));AE.submit();}});},getBoxOrientation:function Q(y){var z=this.boxLayoutConfig;return z.getBoxOrientation(z.getBoxPath(y));},hasBoxLayoutChild:function m(AA){var y=this.boxLayoutConfig,AC=y.identifier,AB=AA[AC],z=function(AD){if(!AD){return false;}if(AD.t===this.componentType){return AD[AC]===AB;}return(AD.children||[]).some(z);}.bind(this);return AA.parent===this&&z(y.box);},beginBoxMove:function Z(z,y,AA){this.boxLayoutConfig.beginBoxMove(z,y,AA);},dropBox:function e(AB,z,AD,AE){var AA=this.getPanelTargetEdge(AB),y=this,AC=this.boxLayoutConfig;if(AA){AC.insertExistingRootChild(AB,AA.substr(1));}else{AC.addDropBox(z,AD,AB);}y.buildBoxLayout();if(AE){this.saveBoxLayout();}},cancelBoxMove:function d(y){var z=y.src.widget;if(!z.cancelBoxMove(y)){this.boxLayoutConfig.cancelBoxMove(y);}},endBoxMove:mstrmojo.emptyFn,getPanelTargetEdge:function x(AA){if(!this.allowPanelEdgeTargeting){return"";}var AD=AA.panelPos;if(!AD){var y=S.position(this.domNode);AD=AA.panelPos={p:y,q:{Top:y.y,Right:y.x+y.w,Bottom:y.y+y.h,Left:y.x}};}var AC=AA.tgt.pos,AB=mstrmojo.boxmodel.getEdgeQuadrantByPoint(AD.p,AC),z=AB==="Left"||AB==="Right"?AC.x:AC.y;return Math.abs(AD.q[AB]-z)<=12?"p"+AB:"";},updateDropCue:function I(AD,AB,AC){var AA=this._dropCue;if(!AA){AA=this._dropCue=document.body.appendChild(document.createElement("div"));AA.className="mstrmojo-vi-hbl-cue";}var AE=AA.style;if(AD===""){AE.display="none";AE.top="-10000px";return ;}if(AD.charAt(0)==="p"){AD=AD.substr(1);AC=AB.panelPos.p;}var z=AD==="All",y={top:AC.y-3,left:AC.x-3,height:AC.h+6,width:AC.w+6};if(!z){var AF=true;if(AD==="Bottom"){y.top=AC.y+AC.h+mstrApp.getThemeProps(mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE.LAYOUT).cueBottomOffset;}else{if(AD==="Right"){y.left=AC.x+AC.w+1;AF=false;}else{AF=AD==="Top";}}y[AF?"height":"width"]=2;}D.toggleClass(AA,"all",z);AE.cssText=Object.keys(y).map(function(AG){return AG+":"+y[AG]+"px";}).join(";");AE.display="block";},unrender:function B(z){var y=this._dropCue;if(y){y.parentNode.removeChild(y);delete this._dropCue;}this.splitterCache=null;return this._super(z);},getSplitterHost:function A(){throw new Error(this.scriptClass+" must implement getSplitterHost.");},getBoxState:function c(){return this.boxLayoutConfig.getBoxState();},restoreBoxState:function p(y){this.boxLayoutConfig.revertBoxState(y);}});var H=mstrmojo.vi.ui._HasBoxLayout;W.forEach(mstrmojo.util.ui._HostsSplitter,function(z,y){if(!H.hasOwnProperty(y)){H[y]=z;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.PanelFormatSaver");mstrmojo.vi.ui._IsViPanel=mstrmojo.provide("mstrmojo.vi.ui._IsViPanel",{_mixinName:"mstrmojo.vi.ui._IsViPanel",getPanelSaver:function A(){return null;},setOpenStatus:function D(F,E,I,H){if(this.visible!==F){this.set("visible",F);if(!H){this.resetLayout(H);}if(!E){var G=this.getPanelSaver();if(G){G.saveProperty("visible",F);}}mstrApp.rootCtrl.generateToolbar();}},getOpenStatus:function C(){return !!this.visible;},resetLayout:function B(){this.height=this.width="1px";this.parent.doLayout();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.DocDataService","mstrmojo.vi.controllers.UICmd");var I=mstrmojo.hash.copy,V=mstrmojo.array.forEach,G=mstrmojo.vi.controllers.UICmd;var P=2,F=1,O=G.CMD_ACT_TYPE.UNDO,H=G.CMD_ACT_TYPE.EXEC,A=G.CMD_ACT_TYPE.REDO;var W=G.CMD_PHASE;var U=G.CMD_STATE;function B(){V(this._delayRemovedCmds,function(e){e.discard();});this._delayRemovedCmds=null;}function E(){this.cmds=this.cmds.concat(this._delayRemovedCmds);this._delayRemovedCmds=null;}function N(f){var e=this.cmds,g=this.pos;this._delayRemovedCmds=e.splice(g+1);if(g>=this.size-1){e.shift().discard();}e.push(f);this.pos=e.length-1;}mstrmojo.vi.controllers.UICmdMgr=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmdMgr",cmds:null,pos:-1,size:20,_delayRemovedCmds:null,controller:null,dataService:null,model:null,state:F,CMD_PHASE:W,init:function X(e){I(e,this);this.cmds=[];},execute:function K(h){if(this.state===P){this.handleError();}try{h=I(h,{mgr:this,undoUIState:this.model.getUIState(),action:H});var f=this.curCmd=new G(h);N.call(this,f);this.state=P;f.execute();}catch(g){this.reset();throw g;}},getInterimCmd:function S(){if(this.state===P){var e=this.cmds[this.pos];if(e&&e.state===U.INTERIM){return e;}}return null;},combineMultipleCMDs:function D(l,k,m){var j=this.cmds.length,g=k-l;if(g<=0||l<0||k>=j){return false;}var f=this.cmds[l],e=this.cmds[k];e.undoStateId=f.undoStateId;e.undoUIState=f.undoUIState;var h;for(h=l;h<k;h++){this.cmds[h].discard();}this.cmds.splice(l,g);if(this.pos>=k){this.pos-=g;}this.controller.onCmdMgrChanged();if(m){I(m,this.cmds[l]);}},undo:function c(h){if(this.canUndo()){this.state=P;try{var f=this.curCmd=this.cmds[this.pos--];f.action=O;f.redoUIState=this.model.getUIState();f.undoRedo(h);}catch(g){this.reset();throw g;}}},redo:function Q(){if(this.canRedo()){this.state=P;try{var f=this.curCmd=this.cmds[++this.pos];f.action=A;f.undoUIState=this.model.getUIState();f.undoRedo();}catch(g){this.reset();throw g;}}},onSuccess:function J(e){if(this.state===F){this.handleError();}if(e!==this.curCmd){this.handleError("Wrong command");}this.state=F;B.call(this);this.controller.onCmdMgrChanged();},onFailure:function Z(){B.call(this);this.reset();},onCancel:function M(f,g){this.state=F;var e=!!f.submitCount;if(e){this.undo(g);}else{this.pos--;}this.cmds.pop();f.discard();if(e){B.call(this);}else{E.call(this);}this.controller.onCmdMgrChanged();},untrackLastCmd:function b(){var e=this.cmds.pop();e.discard();this.pos--;this.controller.onCmdMgrChanged();},reset:function b(){V(this.cmds,function(e){e.discard();});this.cmds.length=0;this.pos=-1;this.state=F;this.controller.onCmdMgrChanged();},resetState:function Y(){this.state=F;},canUndo:function d(){return this.state===F&&this.pos>=0;},canRedo:function R(){return this.state===F&&this.pos<this.cmds.length-1;},onSubmitUpdates:function a(){if(this.state===F){this.cmds.splice(this.pos+1);this.controller.onCmdMgrChanged();}},isUndoRedo:function C(){var e=this.curCmd||{};return(this.state===P&&(e.action===O||e.action===A));},handleError:function L(e){this.reset();throw new Error(e||"Invalid state.");}});mstrmojo.vi.controllers.UICmdMgr.STATES={BUSY:P,IDLE:F};}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton mstrButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton mstrButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.css","mstrmojo.hash");var H=mstrmojo.css,D=mstrmojo.hash,B="glow";var F=mstrmojo.android.ui.Button=mstrmojo.declare(mstrmojo.Button,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.Button",onclick:mstrmojo.emptyFn,touchBegin:function E(){if(this.enabled){H.addClass(this.domNode,B);}},touchTap:function C(J){if(this.enabled){this.onclick({e:J.evt});}},touchSelectBegin:mstrmojo.emptyFn,touchSelectEnd:function A(J){if(this.enabled){this.onclick({e:J.evt});}},touchEnd:function I(){H.removeClass(this.domNode,B);}});F.prototype.markupString=F.prototype.markupString.replace(new RegExp(" mstrAttach:[a-zA-Z,]*"),"");F.newButton=function G(M,L,K){var J={scriptClass:"mstrmojo.android.ui.Button",text:M};if(L){J.onclick=L;}D.copy(K,J);return J;};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo.Button","mstrmojo.vi._MonitorsAppState");var J=mstrmojo.array;var E=1,B=2,O=4,L=8,H=16,R=32;function K(X,W,U,V,Y,S){return mstrmojo.Button.newWebButton(X,function(Z){this.parent.set("_targetMode",W);Z.cancel();},U,{alias:V,flgVis:Y,flgEnabled:S||undefined});}mstrmojo.vi.ui.TargetSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.TargetSelector",markupString:'<div id="{@id}" class="mstrmojo-TargetSelector {@cssClass}" style="{@cssText}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},init:function N(S){this._super(S);if(!this.hostId){throw new Error("You must pass the hostId when instantiating mstrmojo.vi.ui.TargetSelector.");}if(!this.srcId){this.srcId=this.hostId;}this.hostBox=mstrmojo.all[this.hostId];this.srcBox=mstrmojo.all[this.srcId];this._targetMode=E;},onAppStateChange:function M(S){var V=mstrmojo.vi.VisualInsightApp.APP_STATES,W=V.SELECTOR_TARGETING,U=this.btnSelect;if(S.valueWas&W||S.value&W){U.set("enabled",!mstrApp.isAppStateSelection());}},hostId:null,srcId:null,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onhostIdChange:function(){this.hostBox=mstrmojo.all[this.hostId];},onsrcIdChange:function(){this.srcBox=mstrmojo.all[this.srcId];},on_targetModeChange:function(){var Y=this._targetMode,Z=this.hostBox,S=this.srcBox,U=this.id,c=S.model,V=c.getVizContentPanel(),b=Y===R,W=function(){this.preChangeTargetSelectionMode(false,c);V.exitTargetSelectionMode(b,this.restoreChildren.bind(this));}.bind(this);this.children.forEach(function(d){d.set("visible",(d.flgVis&Y)>0);d.set("enabled",(!d.flgEnabled||(d.flgEnabled&Y)>0));d.refresh();});this.set("visible",Y!==E);if(b||Y===B){W();if(!b){this.set("_targetMode",this._cancelMode);this.cancel(Z);}this.exitTargetSelectionMode(Z);}else{if(Y===L){this.preChangeTargetSelectionMode(true,c);V.enterTargetSelectionMode(function(e,f){var d=f?E:L;if(!f&&Z.isSelectionDirty(e,f)){d=H;}mstrmojo.all[U].set("_targetMode",d);if(f){Z.setTargets(e);}},this.srcId,Z.getTargetKeys(),this.enterTargetSelectionMode.bind(this),W);}}var X=mstrmojo.vi.VisualInsightApp.APP_STATES,a=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();mstrApp.set("appState",Y===L||Y===H?(a?X.SELECTOR_TARGETING|X.PAUSE:X.SELECTOR_TARGETING):(a?X.PAUSE:X.DEFAULT));}},ignoreLayout:true,setSourceByKey:function(V){var X=this.srcBox.model.getVizContentPanel(),U=(X&&X.children)||[],S=J.find(U,"k",V),W=(S>-1)?U[S]:null;if(W){this.set("srcId",W.id);}},preChangeTargetSelectionMode:function Q(W,U){var X=U.getVizContentPanel().parent.selector,V=U.controller.view,S=V.layoutViewer.docLayout.selector;S.set("isMasked",W);X.set("isMasked",W);},enterTargetSelectionMode:function G(V){var U=this.srcId,S=mstrmojo.all[U].defn;V.setMaskClass(U);V.set("enabled",V.validateTarget&&V.validateTarget(S));},exitTargetSelectionMode:function D(S){S.close();},restoreChildren:function I(S){S.set("enabled",true);S.clearMaskClass();},cancel:function C(S){if(S){S.cancel();}},enterPreSelectMode:function F(){this._cancelMode=O;this.set("_targetMode",O);},enterSelectMode:function P(){this._cancelMode=E;this.set("_targetMode",L);},enterOffMode:function A(){this._cancelMode=E;this.set("_targetMode",E);},children:[K(mstrmojo.desc(4799,"Select Target"),L,true,"btnSelect",O),K(mstrmojo.desc(221,"Cancel"),B,false,"btnCancel",L+H),K(mstrmojo.desc(134,"Apply"),R,true,"btnApply",L+H,H)]});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.Button","mstrmojo.dom","mstrmojo.Container");mstrmojo.requiresDescs(1442,2140);var C=mstrmojo.dom;mstrmojo.ui.menus.ToolbarEditor=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._IsMenuPopup,mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.menus.ToolbarEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-ToolbarEditor mstrmojo-ui-MenuEditor {@cssClass}" style="..." mstrAttach:mouseover,mouseout,click><div class="te-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},popupConfig:null,children:null,autoCloses:false,locksHover:true,visible:true,onclick:function B(E){C.stopPropogation(null,E.e);},init:function D(F){this._super(F);var E=this.popupConfig,G=E.contents;if(!G){throw new Error("Cannot open editor without editor content.");}this.cssClass=E.cssClass;this.addChildren(G);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.Checkbox");var A={ROUND:"round",RECT:""};mstrmojo.ui.ToggleButton=mstrmojo.declare(mstrmojo.ui.Checkbox,null,{scriptClass:"mstrmojo.ui.ToggleButton",markupString:'<div id="{@id}" class="mstrmojo-ui-ToggleButton {@cssClass}" mstrAttach:click><div class="container"><div class="slider {@sliderStyle}"></div></div></div>',sliderStyle:A.ROUND});mstrmojo.ui.ToggleButton.EnumStyle=A;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.dom","mstrmojo.css","mstrmojo.expr");mstrmojo.requiresDescs(1994,5893,7931,15671);var A=mstrmojo.dom,B=mstrmojo.css,D=mstrmojo.expr.ET,E=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /><img class="mstrmojo-lock" src="../images/lock_view.svg"/></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span>"+E+"</div></div>",getPrefixAndOrToolsMarkup:function(){return(E+this._super());},markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},createSetNode:function(){return this.domNode.childNodes[1].lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){B.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noRelation);},onnoCreateSetChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noCreateSet);},onlockedChange:function(){B.toggleClass(this.condNode,["locked"],this.locked);}},mstrmojo.hash.copy(mstrmojo.ConditionNode.prototype.markupMethods)),init:function(I){if(this._super){this._super(I);}var K=this.data&&this.data.et;if(K){this.set("noCreateSet",mstrApp.supportAdvFilter?false:(K===D.MQ||K===D.MC));}var G=this.tree.editor;if(G){var F=G.scriptClass==="mstrmojo.fe.FilterEditor";var H=typeof (G.disableElementsBrowsing)==="function"&&G.disableElementsBrowsing();if(F&&H&&K===D.AE){this.set("locked",true);this.set("editable",false);this.set("useRichTooltip",true);var J=this;this.set("updateTooltipConfig",function(){var L=mstrmojo.dom.position(J.domNode);this.richTooltip={content:mstrmojo.desc(15671,"Edit or remove is only available in workstation"),refNode:J.domNode,enableHover:true,cssClass:"vi-regular vi-tooltip-V V-center",posType:mstrmojo.tooltip.POS_BOTTOMCENTER,left:L.w/2,top:-10};});}}},preclick:function C(F){var I=null,H=A.eventTarget(F.hWin,F.e),G=this._super(F);if(A.contains(this.createSetOptNode,H,true)&&!this.noRelationOperator&&!this.noRelation){I="createSetOpt";}else{if(A.contains(this.createSetNode,H,true)&&!this.noRelation){I="createSet";}else{if(A.contains(this.addConditionNode,H,true)){I="addCondition";}}}F.part=I||F.part;return G;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.dom");var B=mstrmojo.dom;mstrmojo.threshold.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,null,{scriptClass:"mstrmojo.threshold.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),cssClass:"adv-threshold",avatarCssCls:"mstrmojo-thresholdRow",markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass} mstrAttach:mousedown"><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span></div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},preclick:function A(C){var F=null,E=B.eventTarget(C.hWin,C.e),D=this._super(C);if(B.contains(this.addConditionNode,E,true)){F="addCondition";}C.part=F||C.part;return D;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.VisMenuList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.VisMenuList",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function C(D){this._super(D);},getItemProps:function A(F,D){var E=this._super(F,D);E.tag="a";E.addCls("mstrmojo-ui-Menu-item");return E;},onselectionChange:function B(D){this._super(D);this.parent.data.set("valid",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.css");var B=mstrmojo.css;var A;var D;mstrmojo.ui.ButtonBar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.ButtonBar",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenabledChange:function G(){B.toggleClass(this.domNode,"disabled",!this.enabled);}},cssDisplay:"table",icnCssText:"display:table-row;",items:null,showIcon:true,hasSpacing:false,init:function F(I){this._super(I);var H=["mstrmojo-ui-ButtonBar"];if(this.hasSpacing){H.push("spacing");}if(!this.showIcon){H.push("btn-text");}B.addWidgetCssClass(this,H);},getItemMarkup:function E(H){if(!D){D=this._super(H);}if(!A){A=D.replace(">{@en@n}<",'title="{@en@n}"><div>&nbsp;</div><');}return this.showIcon&&!H.tx?A:D;},getItemProps:function C(J,H){var I=this._super(J,H);var K=J.css;if(K){I.addCls(K);}I.n=J.n||"";return I;}});mstrmojo.ui.ButtonBar.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.string");mstrmojo.DivItemRenderer={render:function(E,C,F){var D=mstrmojo.string.encodeHtmlString((F.getItemName?F.getItemName(E,C):(F.itemDisplayField&&E[F.itemDisplayField])));return'<div mstridx="'+C+'" class="'+F.itemCssClass+(F.selectedIndices[C]?" "+F.itemSelectedCssClass:"")+(E.cssClass?" "+E.cssClass:"")+'" style="'+F.itemCssText+'">'+D+"</div>";},select:function(C){if(C&&C.className){C.className+=" selected";}},unselect:function(C){if(C&&C.className){C.className=C.className.replace(/selected/g,"");}},rowHeight:21};mstrmojo._RendersItemDivs={tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"mstrmojo-ListBox-cell",cellCssText:"",itemCssClass:"mstrmojo-ListBox-item",itemSelectedCssClass:"selected",itemDisplayField:"n",itemRenderer:mstrmojo.DivItemRenderer,rangeSelected:false,_findMatch:function(C,D){return mstrmojo.dom.findAncestorByAttr(mstrmojo.dom.eventTarget(C,D),"mstridx",true,this.itemsNode);},premousedown:function A(C){if(mstrmojo.dom.shiftKey(C.hWin,C.e)){mstrmojo.dom.preventDefault(C.hWin,C.e);}},preclick:function B(K){var G=K.hWin,H=K.e,F=this._findMatch(G,H);if(F){var J=parseInt(F.value,10),I=mstrmojo.dom,C=I.isMetaKey(G,H),D=I.shiftKey(G,H);if(C||D){I.clearBrowserHighlights(G);}if(this.multiSelect&&(this.selectionPolicy==="toggle"||C)){var E=this.rangeSelected||this.selectedIndex===-1;this.toggleSelect(J);if(E&&J<this.items.length&&this.selectedIndices[J+1]){J++;}this.selectedIndex=J;this.rangeSelected=false;}else{if(this.multiSelect&&D){this.rangeSelected=true;this.rangeSelect(J);}else{this.singleSelect(J);this.rangeSelected=false;}}}}};mstrmojo.requiresCls("mstrmojo.ListBase");mstrmojo.ListBoxBase=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._RendersItemDivs],{scriptClass:"mstrmojo.ListBoxBase",cssClass:"mstrmojo-ListBox",itemCssClass:"mstrmojo-ListBox-item",_markupPrefix:function(){var C=this.itemRenderer;return(C&&C.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="0" cellpadding="0"><tbody>');},_markupSuffix:function(){var C=this.itemRenderer;return(C&&C.markupSuffix)||"</tbody></table>";},_itemPrefix:function(){var C=this.itemRenderer;return(C&&C.itemPrefix)||('<tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'"><td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var C=this.itemRenderer;return(C&&C.itemSuffix)||"</td></tr>";},_getItemNode:function(C){var H=this.itemsNode,G=this.renderAllItems,F=H&&H.tBodies,E=G?0:Math.floor(C/100),D=G?C:C%100,I=F&&F[E]&&F[E].rows&&F[E].rows[D];return I&&I.cells[0].firstChild;}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.vi.ui.CalculationWidget=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.vi.ui.CalculationWidget",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-calculation");},_set_selectedItems:function(G,E){var D=(E||[]).map(function(H){return H.t;}),F=this.prevSelection={};D.forEach(function(H){F[H]=true;});this.setSelectedItems(this.items.filter(function(H){return D.indexOf(H.v)>-1;}));},getCalculationTypes:function A(){var F=this.items,G=this.selectedIndices,I=this.prevSelection,E=F.filter(function(K,J){return G[J]&&!I[K.v];}),H=F.filter(function(K,J){return !G[J]&&I[K.v];}),D=function(J){return J.v;};return[E.map(D),H.map(D)];},onselectionChange:function B(D){this._super(D);this.parent.applyCalculation(this.selectedItem.v);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase");mstrmojo.SelectBox=mstrmojo.declare(mstrmojo.ListBase,null,{scriptClass:"mstrmojo.SelectBox",size:10,cssDisplay:"inline",markupString:'<select id="{@id}" class="mstrmojo-SelectBox {@cssClass}" style="{@cssText}" size="{@size}" {@multipleHtml} mstrAttach:keyup,change tstid="{@tstid}">{@itemsHtml}</select>',markupSlots:{itemsContainerNode:function(){return this.domNode;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){this.domNode.disabled=!this.enabled;}},itemCssClass:"mstrmojo-selectbox-item",itemDisplayField:"n",itemIdField:"v",showItemTooltip:false,itemRenderer:{render:function(E,D,F){var G=mstrmojo.string.htmlAngles((F.getItemName)?F.getItemName(E,D):(F.itemDisplayField&&E[F.itemDisplayField]));return'<option class="'+F.itemCssClass+'" value="'+((F.getItemValue)?F.getItemValue(E,D):(F.itemIdField&&E[F.itemIdField]))+'" '+((F.selectedIndices[D])?'selected="true" ':"")+((F.showItemTooltip)?'title="'+mstrmojo.string.encodeXMLAttribute(G)+'"':"")+">"+G+"</option>";},select:function(E,F,D,G){E.selected=true;},unselect:function(E,F,D,G){E.selected=false;}},buildRendering:function C(){this.multipleHtml=this.multiSelect?' multiple="true" ':"";this._super();delete this.multipleHtml;},_getItemNode:function(D){var E=this.scrollboxNode;return E&&E.options[D];},prechange:function A(E){if(this._syncDom){return ;}this._syncDom=true;var H=this.scrollboxNode;if(this.multiSelect){var I=H.options,F=[];for(var G=0,D=I.length;G<D;G++){if(I[G].selected){F.push(G);}}this.select(F);}else{this.singleSelect(H.selectedIndex);}delete this._syncDom;},prekeyup:function(E){var H=this.scrollboxNode,F=false;if(this.multiSelect){var I=H.options;for(var G=0,D=I.length;G<D;G++){if(I[G].selected!==!!this.selectedIndices[G]){F=true;break;}}}else{if(H.selectedIndex!==this.selectedIndex){F=true;}}if(F){var J=E;J.name="change";this.raiseEvent(E);}},onselectionChange:function B(D){if(!this._syncDom){this._super(D);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var D=mstrmojo.dom,E=mstrmojo.hash;var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(G,F){if(!A){var H=this.itemField;A=this._super(G).replace('@title}">{@en@n}<',"@en@"+H+'}">{@en@'+H+"}<");}return A;},getItemProps:function C(H,F){var G=this._super(H,F),I=this.itemField;if(!mstrmojo.string.isEmpty(H[I])){G[I]=H[I];}return G;},onclick:function B(F){if(this.disableClick){return false;}var K=this,H=this.parent,J=H.opener,G=D.isMetaKey(F.hWin,F.e);if(G&&!this.multiSelect){this.multiSelect=J.parent.defn.multi;if(this.multiSelect){D.attachOneTimeEvent(document.documentElement,"keyup",function(){var M=K.selectedIndices;if(J){J.suggestionShown=false;if(M&&!E.isEmpty(M)){var L=[];E.forEach(K.selectedIndices,function(O,N){L.push(K.items[N]);});J.handleSuggestionItemSelect(L);}H.close();}K.multiSelect=false;});}}this._super(F);if(!this.multiSelect){J.suggestionShown=false;var I=this.selectedItem;if(I){J.handleSuggestionItemSelect(I);}H.close();}},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems",disableClick:"this.parent.opener.disableClick"}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasContextMenu","mstrmojo._IsList","mstrmojo.css","mstrmojo.dom","mstrmojo.ListBase");var B=mstrmojo.css,F=mstrmojo.dom;function E(){var I,N,H=this.itemsContainerNode,J,O=this.items,R=[],Q,L,P=this.padding,M,K=0;this.items.pop();if(!this.width){return ;}I=parseInt(this.width,10);N=H.scrollWidth||F.position(H).w;if(N<=I){return ;}Q=H.lastChild;B.removeClass(Q,"hide");L=F.position(Q).w;J=H.children;M=J.length-1;while(K<M){I-=(F.position(H.children[K]).w+P);if(I<L){break;}K++;}while(K<M){H.removeChild(J[J.length-2]);R.push(O[K++]);}this.set("cm",R);Q.textContent=mstrmojo.desc(15124,"## more").replace("##",R.length);}mstrmojo.vi.ui.TruncatedList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.vi.ui.TruncatedList",cssClass:"mstr-truncList",padding:0,overflowCls:"",getAdditionalProperties:mstrmojo.emptyFn,getItemProps:function D(K,H){var J=this._super(K,H),I=K.style;if(I){J.addStyle(I);}this.getAdditionalProperties(J,H);return J;},buildRendering:function G(){this.items.push({alias:"overflowItem",cls:this.overflowCls+" hide",n:mstrmojo.desc(15124,"## more").replace("##",this.items.length)});if(this._super){this._super();}},setWidth:mstrmojo.emptyFn,postBuildRendering:function C(){this.setWidth();E.call(this);if(this._super){this._super();}},onclick:function A(I){var K=this.itemsContainerNode.children,H=K.length,J=H&&K[H-1];if(J&&J===I.getTarget()){this.cmPos=F.getMousePosition(I.e,I.hWin);this.showContextMenu();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.ui.editors.controls.ColorList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.editors.controls.ColorList",init:function D(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ColorList");},getItemMarkup:function C(F,E){if(!A){A=this._super(F,E).replace(">{@en@n}<",">{@en@msg}<");}return A;},getItemProps:function B(G,E){var F=this._super(G,E);if(G.id==="transparent"){F.msg=mstrmojo.desc(5774,"No Fill");F.addCls("noFill");}else{F.msg="";G.title=G.n;F.addStyle("background-color:"+G.id);}return F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");mstrmojo.ui.List=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.List",postselectionChange:function C(D){var G=D.added||[],F=G.length,I=D.removed||[],E=I.length;if(E){this.selectionRemoved({added:G,removed:I,isReselect:false});}if(F){var H=function(J){return[].concat(J).sort().join(",");};this.selectionAdded({added:G,removed:I,isReselect:H(G)===H(I)});}},selectionAdded:function A(D){},selectionRemoved:function B(D){}});mstrmojo.ui.List.SelectionChangeEvtType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._HasEditableText","mstrmojo.css","mstrmojo._CanHandleTwoClicks","mstrmojo.Label","mstrmojo.Widget");var C=mstrmojo.css,A=mstrmojo.Label.prototype.markupMethods;mstrmojo.EditableLabel=mstrmojo.declare(mstrmojo.Label,[mstrmojo._CanHandleTwoClicks,mstrmojo._HasEditableText],{scriptClass:"mstrmojo.EditableLabel",autoApplyDelay:-1,markupString:'<div id="{@id}" class="mstrmojo-EditableLabel {@cssClass}" title="{@title}" contenteditable="{@isEditing}" style="{@cssText}" mstrAttach:click,mousedown,blur,keydown,keyup></div>',markupMethods:mstrmojo.hash.copy({onwidthChange:function(){mstrmojo.Widget.widthMarkupMethod.call(this);},ontextChange:function(){if(A.ontextChange){A.ontextChange.call(this);}this.widgetResized();},onvisibleChange:function(){if(A.onvisibleChange){A.onvisibleChange.call(this);}if(this.visible){this.widgetResized();}}},mstrmojo.hash.copy(A)),onkeyup:function E(F){this._super(F);if(this._autoApplyTimer){window.clearTimeout(this._autoApplyTimer);}if(this.autoApplyDelay!==-1){var G=this;this._autoApplyTimer=window.setTimeout(function(){G.set("isEditing",false);},this.autoApplyDelay);}},postBuildRendering:function D(){if(this._super){this._super();}this.widgetResized();},selectable:true});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.EditableLabel,{onselectableChange:function B(){var G=this[this.editableSlot],F=!!this.selectable;G.selectable=F;G.setAttribute("unselectable",!F?"on":"off");C.toggleClass(G,"unselectable",!F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TargetMask","mstrmojo.css","mstrmojo.desc");var A="targetMask";mstrmojo.vi.ui._HasTargets=mstrmojo.provide("mstrmojo.vi.ui._HasTargets",{_mixinName:"mstrmojo.vi.ui._HasTargets",init:function B(C){if(this._super){this._super(C);}this.addChildren([{scriptClass:"mstrmojo.vi.ui.TargetMask",alias:A,slot:"domNode",tooltipContent:this.maskTooltip,allowFilters:this.allowFilters}]);},setMaskClass:function(C){if(this[A].setMaskClass(C)){this._originalContextMenu=this.shouldShowCustomizeContextMenu;this.shouldShowCustomizeContextMenu=function(){return false;};this._originalIsDraggable=this.draggable;this.draggable=false;}},clearMaskClass:function(){this.shouldShowCustomizeContextMenu=this._originalContextMenu;delete this._originalContextMenu;this.draggable=this._originalIsDraggable;delete this._originalIsDraggable;this[A].clearMaskClass();}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K.slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");function B(K,J,H){var I=J,G;for(;I>0;I--){G=Array(I+1).join("#");K=K.replace(G,H[I-1]);}return K;}var C='<div class="freezing-vis-txt-metric">',A='<div class="freezing-vis-txt-attr">',E="</div>",F="("+mstrmojo.desc(16294,"data retrieval paused")+")";var D=function(J,I){if(J<1&&I<1){return null;}var H=[],G="# ## ### ####";if(J>0){H.push(B(G,4,[A,J,J>1?mstrmojo.desc(3581,"Attributes"):mstrmojo.desc(518,"Attribute"),E]));}if(I>0){H.push(B(G,4,[C,I,I>1?mstrmojo.desc(3582,"Metrics"):mstrmojo.desc(517,"Metric"),E]));}return H.join(",");};mstrmojo.vi.ui.rw.FreezingImageContainer=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.vi.ui.rw.FreezingImageContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-rw-freezingImageContainer mstrmojo-vi-ui-rw-GhostImageContainer {@cssClass}"><div class="mstmojo-freezingImgTableCell"><div class="mstrmojo-freezingImgDiv"><div class="freezing-vis-img ghost-vis-img"></div><div class="freezing-vis-desc"><label class="visName">{@visName}</label><div class="freezing-details">{@freezingDetails}</div></div><div class="vis-dropzone">{@visDropzoneMsg} </div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode;}},visName:"",freezingDetails:F,visDropzoneMsg:""});mstrmojo.vi.ui.rw.FreezingImageContainer.getVisDropzoneMsg=D;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout");var D=' style="display:inline-block;vertical-align:middle;"';mstrmojo.ui.editors.controls.TwoColumnContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-TwoColumnProp {@cssClass}" style="{@cssText}"><div class="vi-col1"'+D+'></div><div class="divider"'+D+'></div><div class="vi-col2"'+D+"></div></div>",markupSlots:{col1Node:function C(){return this.domNode.firstChild;},dividerNode:function B(){return this.domNode.childNodes[1];},col2Node:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},layoutConfig:{w:{col1Node:"40%",dividerNode:"5px",col2Node:"60%"},xt:true},shouldPropagateEnabled:true,col1Width:"40%",dividerWidth:"5px",col2Width:"60%",init:function F(G){this._super(G);var H=this.layoutConfig=JSON.parse(JSON.stringify(this.layoutConfig)),I=H.w;I.col1Node=this.col1Width;I.dividerNode=this.dividerWidth;I.col2Node=this.col2Width;},getControl:function E(G){return(this.children||[]).filter(function(H){return H.slot==="col"+G+"Node";})[0];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Widget","mstrmojo.css","mstrmojo.dom");var Z=mstrmojo.css,F=mstrmojo.dom;var a={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};function A(){var d=this.value,c=this.inputNode,e=c.value,b=(d!==null&&d!==undefined)?String(d):"";if(b!==e&&(!this.keepEmpty||e!==this.emptyText)){c.value=b;}if(c.mstrmojoEmpty){Z.removeClass(c,[this.emptyClass]);c.mstrmojoEmpty=null;}}function Y(){var b=this.inputNode;b.value=this.emptyText||"";Z.addClass(b,[this.emptyClass]);b.mstrmojoEmpty=true;}function N(){var b=this.inputNode;if(b){this.readingDom=true;this.set("value",b.value);this.readingDom=false;}}function V(b){var c=this;if(b===-1){N.call(this);}else{if(this._lastTimeoutId){window.clearTimeout(this._lastTimeoutId);}this._lastTimeoutId=window.setTimeout(function(){delete c._lastTimeoutId;N.call(c);},b||100);}}mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",emptyText:"",keepEmpty:false,emptyClass:"mstrmojo-empty",valueChangeDelay:-1,textValid:true,autoComplete:true,autoCorrect:true,autoCapitalize:true,spellCheck:true,markupString:'<input id="{@id}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click,keydown,mousedown  tstid="{@tstid}"/>',markupSlots:{inputNode:function D(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,oncssClassChange:function S(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function O(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function E(){var b=this.inputNode;b.disabled=!this.enabled;Z.toggleClass(b,"disabled",!this.enabled);},onvalueChange:function P(){var b=this.value,c=(b===undefined)||(b===null)||(b==="");if(c){if(!this.hasFocus){Y.call(this);}else{this.inputNode.value="";}}else{A.call(this);}if(F.isIE9){this.inputNode.type=c?"text":this.type;}},ontooltipChange:function R(){this.domNode.title=this.tooltip;},onreadOnlyChange:function H(){this.inputNode.readOnly=this.readOnly;},ontextValidChange:function B(){Z.toggleClass(this.inputNode,["err"],!this.textValid);}},postBuildRendering:function W(){this._super();var b=this.inputNode;b.setAttribute("autocomplete",this.autoComplete?"on":"off");b.setAttribute("autocorrect",this.autoCorrect?"on":"off");b.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");b.setAttribute("spellcheck",this.spellCheck?"true":"false");},focus:function Q(){if(this.inputNode&&this.inputNode.offsetParent){try{this.inputNode.focus();}catch(b){}}},prefocus:function M(){this.hasFocus=true;A.call(this);},blur:function U(){this.inputNode.blur();},preblur:function X(){window.setTimeout(function(){},200);this.hasFocus=false;N.call(this);var b=this.value;if(((b===null||b==="")&&this.emptyText)||(this.keepEmpty&&b===this.emptyText)){Y.call(this);}},prekeyup:function I(c){var b=c.hWin,d=c.e||b.event;V.call(this,this.valueChangeDelay);var f=a[d.keyCode];if(this["on"+f]){this["on"+f](c);}},preinput:function J(){V.call(this,this.valueChangeDelay);},prepaste:function K(){V.call(this);},precut:function G(){V.call(this);},setInvalidState:function C(b){this.set("textValid",false);if(b){this.domNode.setAttribute("title",b);}},cleanUp:function L(){this.inputNode.value="";this.set("textValid",true);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");mstrmojo.VBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VBox",markupString:'<table id="{@id}" class="mstrmojo-VBox {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo._IsPopup","mstrmojo._CanAutoClose");var C=mstrmojo.dom;mstrmojo.ui.PopupWidget=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.PopupWidget",markupString:'<div id="{@id}" class="mstrmojo-ui-PopupWidget {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="pw-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},autoCloses:true,locksHover:true,closeOnClick:true,visible:true,onclick:function B(D){C.stopPropogation(null,D.e);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.requiresDescs(11668,15187,15188,15189,15190);function B(L,K,I){var J=K,H;for(;J>0;J--){H=Array(J+1).join("#");L=L.replace(H,I[J-1]);}return L;}var C='<div class="ghost-vis-txt-metric">',A='<div class="ghost-vis-txt-attr">',E='<div class="ghost-vis-txt-attr-time">',G="</div>";var D={grid:B(mstrmojo.desc(15187,"Add # or more ##attributes### and/or #### or more #####metrics######"),6,[1,A,G,1,C,G]),heatmap:B(mstrmojo.desc(15187,"Add # or more ##attributes### and/or #### or more #####metrics######"),6,[1,A,G,1,C,G]),barchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),linechart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),areachart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),bubblechart:B(mstrmojo.desc(15190,"Add # or more ##metrics### and #### or more #####attributes######"),6,[2,C,G,1,A,G]),piechart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),combochart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,2,C,G]),network:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),histogram:B(mstrmojo.desc(15667,"Add # or more ##attributes### and ####  #####metric######"),6,[1,A,G,1,C,G]),boxplot:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),waterfall:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),kpicard:B(mstrmojo.desc(15878,"Add # or more ##attributes### and #### #####metric######"),6,[1,A,G,1,C,G])};function F(H){return D[H]?D[H]:mstrmojo.desc(11668,"Drag objects here.");}mstrmojo.vi.ui.rw.GhostImageContainer=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.vi.ui.rw.GhostImageContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-rw-GhostImageContainer {@cssClass}"><div class="mstmojo-ghostImgTableCell"><div class="mstrmojo-ghostImgDiv"><div class="ghost-vis-img"></div><div class="ghost-vis-name">{@visName}</div><div class="ghost-vis-desc">{@visDesc}</div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode;}},visName:"",visDesc:""});mstrmojo.vi.ui.rw.GhostImageContainer.getVisDesc=F;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var M=mstrmojo.Widget,G=mstrmojo.dom,N=mstrmojo.global.document,C=50,B=500;mstrmojo.Stepper=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Stepper",orientation:"vertical",provider:null,title:"",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text">{@itemHtml}</div><div class="prev">-</div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},nextNode:function(){return this.domNode.children[1];},textNode:function(){return this.domNode.children[2];},prevNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:M.visibleMarkupMethod,onheightChange:M.heightMarkupMethod,onwidthChange:M.widthMarkupMethod,onenabledChange:function I(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},preBuildRendering:function J(){this.itemHtml=this.provider.renderItemAt();this._super();},processEvent:function A(O){if(G.contains(this.textNode,O)||O===this.titleNode){return ;}var Q=this.provider,P=((O===this.nextNode)?"Next":"Prev");if(Q["has"+P]()){Q[P.toLowerCase()]();this.updateDisplayText();}},updateDisplayText:function E(){this.textNode.innerHTML=this.provider.renderItemAt();},startStepperInterval:function F(O,P){var Q=this;this._holdTimer=setInterval(function(){Q[P](O);},C);},stopStepperInterval:function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}},onclick:function L(O){this.processEvent(O.e.target);},onmousedown:function D(O){if(!this._holdTimer&&!this._startHoldTimer){var P=this;this._startHoldTimer=setTimeout(function(){delete P._startHoldTimer;P.startStepperInterval(O,"onclick");},B);G.attachOneTimeEvent(N,"mouseup",function(){if(P._startHoldTimer){clearTimeout(P._startHoldTimer);delete P._startHoldTimer;}P.stopStepperInterval();},true);}},onselectstart:function K(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Container","mstrmojo._IsPopup","mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.ui._HasScroller");var L=mstrmojo.boxmodel,I=mstrmojo.dom,M=mstrmojo.css,O="mstrmojo-Tooltip",A="mstrmojo-scrollNode",E=20;function C(S,U,R){var V="connectScrollbox";if(R){V="dis"+V;}var Q=S&&S.parent;while(Q){if(Q[V]){Q[V](U);}Q=Q.parent;}}function G(){if(!this._paintHandle){var R=this.id,Q=function(W){var a=mstrmojo.all[R];if(!a){return ;}delete a._paintHandle;var U=[O],b=a.cssClass;if(b){U.push(b);}var S=mstrApp.getThemeClassName&&mstrApp.getThemeClassName(),Y=a.opener;if(Y&&Y.getTooltipThemeClass){S=Y.getTooltipThemeClass();}U.push(S);a.domNode.className=U.join(" ");var Z=a.content,V=a.contentNode,X=a.arrowNode;V.className=(O+"-content "+A+" "+a.contentNodeCssClass);V.style.cssText=a.contentNodeCssText;if(!a.hasWidgetContent){V.innerHTML=Z;}X.style.cssText="";a.domNode.style.visibility=!!Z?"visible":"hidden";a.updatePosition();if(!W&&a.optimizePos){a.optimizePos();}a.updateScrollbars();a.addScrollNodeProperties();};if(!this._hasPaint){Q(true);this._hasPaint=true;}else{this._paintHandle=window.setTimeout(Q,0);}}}function B(V,d,j,W){var Z=d&&(d.richTooltip||d.tooltip),m=j?I.getMousePosition(j,W||self):null,c=Z&&(typeof Z==="string");var k="",b="",Y="",h=Z,a=null,Q=mstrmojo.tooltip.POS_TOPLEFT,S=null,f=null,R=null,l=false,U=null,X=mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY;var g=false,i=false;if(Z&&!c){b=Z.cssClass||b;k=Z.contentNodeCssClass||k;Y=Z.contentNodeCssText||Y;h=Z.content||"";a=Z.refNode||a;Q=Z.posType||Q;S=Z.left||0;f=Z.top||0;g=Z.keepArrowXPos||g;i=Z.keepArrowYPos||i;R=Z.updatePosition||null;l=Z.hasWidgetContent;U=Z.children;X=Z.tooltipCloseDelay||mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY;}V.set("contentNodeCssClass",k);V.set("cssClass",b);V.set("contentNodeCssText",Y);V.set("content",h);V.set("refNode",a);V.set("posType",Q);V.set("left",c?((m&&m.x)||V.left):S);V.set("top",(c||!Z)?((m&&(m.y+E))||V.top):f);V.set("keepArrowXPos",g);V.set("keepArrowYPos",i);if(R){V.set("updatePosition",R);}else{V.set("updatePosition",mstrmojo.Tooltip.prototype.updatePosition);}V.set("hasWidgetContent",l);V.set("children",U);V.set("tooltipCloseDelay",X);}mstrmojo.Tooltip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.Tooltip",content:null,top:null,left:null,refNode:null,keepArrowXPos:false,keepArrowYPos:false,posType:"TL",allowOtherTooltips:false,markupString:'<div id="{@id}" class="'+O+' {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout><div class="'+O+'-shadow {@shadowNodeCssClass}"></div><div class="'+O+'-contentWrapper"><div class="'+O+"-content "+A+' {@contentNodeCssClass}" style="{@contentNodeCssText}"></div></div><div class="'+O+'-arrow"></div></div>',markupSlots:{containerNode:function(){return this.domNode.children[1];},contentNode:function(){return this.domNode.children[1].firstChild;},shadowNode:function(){return this.domNode.firstChild;},arrowNode:function(){return this.domNode.children[2];}},setupScrollNodes:function D(){this.scrollNode=this.contentNode;this.scrollbarHostNode=this.containerNode;},_previousVisible:false,markupMethods:{onvisibleChange:function(){var R=this.domNode.style,Q=!!this.visible;if(this._previousVisible!==Q){R.visibility="hidden";}R.display=Q?"block":"none";this._previousVisible=Q;if(Q){this.updatePosition();if(this.content){G.call(this);}}},onleftChange:G,ontopChange:G,onrefNodeChange:G,onposTypeChange:G,oncontentNodeCssClassChange:G,oncontentNodeCssTextChange:G,oncontentChange:G,oncssClassChange:G},preBuildRendering:function N(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}return this._super();},updatePosition:function H(W){if(!this.visible&&!W){return ;}var V=this.refNode,U=V?L.offset(V,document.body):{left:I.getHorizontalScroll(),top:I.getVerticalScroll()},m=this.domNode.style,g=this.containerNode,i=g.offsetWidth,a=g.offsetHeight,R=this.posType,d=R.indexOf("R")>-1,X=R.indexOf("B")>-1,c=this.top!==null?parseInt(this.top,10)+U.top-(X?a:0):null,S=this.left!==null?parseInt(this.left,10)+U.left-(d?i:((R.indexOf("C")>-1)?Math.floor(i/2):0)):null,k=false,b=false,e,Y,j=I.windowDim(),h=I.getHorizontalScroll()+j.w,Q=I.getVerticalScroll()+j.h,f=this.arrowNode,l=null;if(S!==null){e=Math.min(Math.max(S,0),h-i);m.left=e+"px";k=S!==e;}if(c!==null){Y=Math.min(Math.max(c,0),Q-a);m.top=Y+"px";b=c!==Y;}if(k||b){var Z,o=this.keepArrowXPos&&k,n=this.keepArrowYPos&&b;if(o||n){l=M.getComputedStyle(f);Z=l.left;}if(Z&&Z.endsWith("%")){Z=parseFloat(Z)/100*i;}if(o){f.style.left=(parseInt(Z,10)+S-e)+"px";}if(n){f.style.top=(parseInt(l.top,10)+c-Y)+"px";}}M.toggleClass(this.domNode,"offset",k||b);},_on_tooltip_change:function(Q){B(this,Q&&Q.src);},_set_opener:function(U,S){var R=this.opener,Q=S!==R;if(Q){if(S){C(S,this);}if(R){C(S,this,true);}if(R&&R.detachEventListener){R.detachEventListener(this._richSubs);R.detachEventListener(this._ttpSubs);}if(S&&S.attachEventListener){this._richSubs=S.attachEventListener("richTooltipChange",this.id,"_on_tooltip_change");this._ttpSubs=S.attachEventListener("tooltipChange",this.id,"_on_tooltip_change");}this.opener=S;}return Q;},updatePopupConfig:function(Q,R){B(this,R,Q&&Q.e,Q&&Q.win);},onscroll:function K(){if(this.visible&&this.nudge){this.nudge();}this._super();},onmouseover:mstrmojo.emptyFn,onmouseout:mstrmojo.emptyFn});var J=null;mstrmojo.tooltip={POS_TOPLEFT:"TL",POS_BOTTOMLEFT:"BL",POS_TOPRIGHT:"TR",POS_BOTTOMRIGHT:"BR",POS_BOTTOMCENTER:"BC",POS_TOPCENTER:"TC",open:function F(R,U,S,Q){if(R&&R.hasWidgetContent&&J){J.destroy();}if(!J||!mstrmojo.all[J.id]){J=new mstrmojo.Tooltip();}Q=Q||{};Q.e=U;Q.win=S;J.open(R,Q);R.tooltip=J;},close:function P(){if(J&&!J.allowOtherTooltips){var Q=J.opener;if(Q){Q.tooltip=null;}J.close();if(Q&&Q.hasWidgetContent){J.destroy();}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var V=H.slot;if(!this[V]){var M=V&&V.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),W=parseInt(M[2],10),Q=this.containerNode,U=this[(B+R)],N=[];if(!U){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}U=N[B+R];}var P=U.cells&&U.cells.length||0;for(var K=P;K<=W;K++){var I=U.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder","mstrmojo._SupportsEllipsisText","mstrmojo._HasEllipsis","mstrmojo.css","mstrmojo.array");var W=mstrmojo.css,V=mstrmojo.array;var R=2;function D(a,Y,Z){var b=a.parent.parent;if(b&&b instanceof mstrmojo.DocPanel){b[Y+"DirtyKey"](Z);}}function O(Z,Y,a){if(Z===Y.k){mstrmojo.array.forEach(Y.children,function(b){if(b.setDirtyChildren){b.setDirtyChildren(a);}});}}function I(Y){return Y._isFP()&&!Y.parent.defn.od;}mstrmojo.DocPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder,mstrmojo._SupportsEllipsisText,mstrmojo._HasEllipsis,mstrmojo.vi.ui._IsDropTarget],{scriptClass:"mstrmojo.DocPanel",visible:false,selected:false,k:"",cssDisplay:"block",subPanelCssText:"height:100%;width:100%;position:absolute;",topStart:R,contentWidth:0,markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="{@containerNodeCssText}{@subPanelCssText}"></div></div>',markupMethods:{onvisibleChange:function(){var Z=this.domNode.style,Y=this.visible;if(I(this)){Z.visibility=(Y?"":"hidden");Z.zIndex=(Y?10:1);}else{Z.display=(Y?this.cssDisplay:"none");if(Y&&this.refreshWhenVisible){this.refresh();this.refreshWhenVisible=false;}}}},markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{containerNode:["background-color","fx","overflow"]},title:"",init:function Q(Y){this._super(Y);if(!this.title){this.title=this.node.defn.ttl||"";}if(this._isSearchBoxPanel()){this.isSbp=true;this.set("canApplySbp",false);}},childRenderCheck:function L(Y){return(this._super(Y)&&(this.selected||I(this)));},postBuildRendering:function U(){if(!this.defn.l&&!this._forceRender){W.addClass(this.domNode,"placeholder");}var Z=this._super();if(this.isSbp){var Y=this.addChildren({scriptClass:"mstrmojo.Button",cssClass:"sbp-apply",title:mstrmojo.desc(134,"Apply"),cssText:"top:"+((parseInt(this.parent.fmts.height,10)||0)-28)/2+"px",bindings:{enabled:"this.parent.canApplySbp&&this.parent.parent.applyEnabled"},onclick:function(){this.parent.parent.applyBufferedSlices();}});Y.render();}if(this._isFSP()){this.set("shouldEllipsize",true);}if(mstrApp.isOIVM&&mstrApp.isOIVM()&&mstrmojo.dom.isChrome){var b=this.containerNode.style.overflow;this.containerNode.style.overflow="hidden";var a=this;window.setTimeout(function(){if(a.containerNode&&a.containerNode.style&&a.containerNode.style.overflow){a.containerNode.style.overflow=b;}},2000);}return Z;},onselectedChange:function M(Y){if(Y.value){this.renderChildren();}this.model&&this.model.raiseEvent({name:"panelSelected",panelId:this.id,panelVisible:!!Y.value});},updateForPU:function S(Y){this.node=Y;this.update(Y);},refreshForPU:function A(){this._isPartial=true;this.refresh();this._isPartial=false;},_isPartial:false,refresh:function E(){if(!this.hasRendered){return ;}this._inRendering=true;var a=[].concat(this.getPanelChildren()||[]),Z=[].concat(this.getChildren(this._isPartial)),Y;V.removeItems(a,"k",Z);V.removeItems(Z,"k",this.getPanelChildren());if(a.length!==0){V.forEach(a,function(b){this.removeChildren(b);b.destroy();},this);}if(Z.length!==0){V.forEach(Z,function(d){var c=d.id&&mstrmojo.all[d.id];var b=c&&c.defn;if(b){b._isDeleted=true;}if(c&&c.destroy){c.destroy();}},this);this.addChildren(this.builder.build(Z,this.model,this.buildConfig));this.builtChildren=true;}if(!this.selected){if(!this.children){this.builtChildren=false;}this._forceRender=true;this._super();delete this._forceRender;}else{a=[].concat(this.getPanelChildren()||[]);for(Y=a.length-1;Y>=0;Y--){a[Y].refresh();}}if(this._isFP()&&this.selected){this.refreshFP();}if(this._isFSP()){this.set("richTooltip",{content:this.containerNode.innerHTML,contentNodeCssClass:"sp-tooltip",left:-20,top:20,refNode:this.domNode});this.ellipsizeElements("div",this.containerNode,true);}this._inRendering=false;},setDirty:function N(Y){this[(Y?"add":"remove")+"DirtyKey"](this.k);},addDirtyKey:function H(Y){var a=this.defn,Z=a.dirtyKeys||{};Z[Y]=true;a.dirtyKeys=Z;if(Y===this.k){mstrmojo.array.forEach(this.children,function(b){if(b.setDirtyChildren){b.setDirtyChildren(true);}});}O(Y,this,true);D(this,"add",Y);},removeDirtyKey:function K(Z){D(this,"remove",Z);O(Z,this,false);if(Z===this.k){mstrmojo.array.forEach(this.children,function(b){if(b.setDirtyChildren){b.setDirtyChildren(false);}});}var a=this.defn,Y=a.dirtyKeys;if(!Y){return ;}delete Y[Z];if(!mstrmojo.hash.isEmpty(Y)){return ;}delete a.dirtyKeys;},getPanelChildren:function G(){return V.filter(this.children||[],function(Y){return Y.scriptClass!=="mstrmojo.Button";});},preBuildRendering:function(){if(this._isFSP()){this.useRichTooltip=true;}if(this._super){this._super();}},renderChildren:function J(){this._inRendering=true;var e=this.children;if(e&&(this._isFP()||this._isFSP())){V.forEach(e,function(h){h.getFormats();});}if(this.isSbp){W.addClass(this.domNode,"mstrmojo-sbp");}if(this._isFP()&&!mstrApp.isVI){W.addClass(this.parent.domNode,"fpgb");if(e){var f=this.domNode.clientWidth-2*R,d,Y;this.topStart=R+1;for(d=0,Y=(e&&e.length)||0;d<Y;d++){var a=this.domNode.clientWidth-2*R;this.contentWidth=(a>0)?a:0;if(a!==f){this.topStart=R+1;var b;for(b=0;b<d;b++){var Z=e[b];Z.refresh();if(Z.getContainerHeight){this.topStart+=Z.getContainerHeight()+R+1;}}}var g=e[d];if(this.childRenderCheck(g)){g.render(null);if(g.getContainerHeight){this.topStart+=g.getContainerHeight()+R+1;}}}}}else{this._super();}if(this._isFSP()){this.set("richTooltip",{content:this.containerNode.innerHTML,contentNodeCssClass:"sp-tooltip",left:-20,top:20,refNode:this.domNode});this.ellipsizeElements("div",this.containerNode,true);}this._inRendering=false;},refreshFP:function F(){if(!this.hasRendered){return ;}var b=this.children,Y=(b&&b.length)||0,a;this.topStart=R+1;var Z=this.domNode.clientWidth-2*R;this.contentWidth=(Z>0)?Z:0;for(a=0;a<Y;a++){var d=b[a];if(!d.hasRendered){continue;}if(d.relocate){d.relocate(this.topStart,this.contentWidth);}if(d.updateContentHeight){d.updateContentHeight();}if(d.getContainerHeight){this.topStart+=d.getContainerHeight()+R+1;}}},getChildren:function C(b){var a=this.model.getChildren(this.node,b);if(this._isFP()||this._isFSP()){var Y=(a&&a.length)||0,Z;for(Z=0;Z<Y;Z++){var d=a[Z];if(this._isFP()&&!d.defn.iifp){d.defn.iifp=true;}if(this._isFSP()&&!d.defn.iifs){d.defn.iifs=true;}}}a=V.filter(a||[],function(c){if(typeof c.defn.ifw==="boolean"){return !c.defn.ifw;}return true;});return a;},onchildRenderingChange:function B(Y){this._super(Y);if(this._isFSP()&&!this._inRendering){this.ellipsizeElements("div",this.containerNode,true);}if(this.parent.selectedKey!==this.k&&Y.gridInfo&&Y.tca===2){this.defn.l=false;}},_isFP:function X(){return !!this.parent.defn.ifp;},_isFSP:function P(){return !!this.parent.defn.ifsp;},_isSearchBoxPanel:function(){return false;},canApplySearchBoxPanel:function(){var Z=this.model.getChildren(this.node,false),Y;for(Y=0;Y<Z.length;Y++){var b=Z[Y],a=mstrmojo.all[b.id];if(a&&a.canApply&&!a.canApply()){return false;}}return true;},doEllipsize:function(){if(this.shouldEllipsize){this.ellipsizeElements("div",this.containerNode,true);}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var E=function(){var G=this.opener;if(G.direction.toLowerCase()==="up"){this.domNode.style.top=-G.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"",text:"",direction:"down",enabled:true,title:"",allowHTML:true,markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.getTextInnerHTML();},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function C(){if(this._super){this._super();}var G=this.popupRef;if(G){if(G.nudge){G.nudge=mstrmojo.func.composite([G.nudge,E]);}else{if(this.direction.toLowerCase()!=="down"){G.nudge=E;}}}},popupRef:null,popupOpenConfig:null,destroy:function D(G){var H=this.popupRef;if(H&&H.hasRendered){H.destroy(false);}if(this._super){this._super(G);}},togglePopup:function F(){var G=this._lastOpened;if(G&&G.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(G){this.togglePopup();},getTextInnerHTML:function B(){return this.allowHTML?this.text:mstrmojo.string.encodeHtmlString(this.text);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");function A(B){return function(){this.domNode.style[B]=this[B]||"";};}mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",titleNodeCssClass:"mstrmojo-popup-title",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",keepOpen:false,markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}"><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-title {@titleNodeCssClass}">{@title}</div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onleftChange:A("left"),ontopChange:A("top"),onzIndexChange:A("zIndex")}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui._HasScroller");var D=mstrmojo.Widget;mstrmojo.ui.ScrollableContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ScrollableContainer {@cssClass}" style="{@cssText}"><div class="ScrollableContainer-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},accessibilityMenuContainer:function(){return this.children[0];},markupMethods:{onvisibleChange:D.visibleMarkupMethod,onheightChange:D.heightMarkupMethod,onwidthChange:D.widthMarkupMethod},setupScrollNodes:function C(){this.scrollNode=this.containerNode;},onOpen:function B(){this.updateScrollbars();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout");var D=' style="display:inline-block;vertical-align:middle;"';mstrmojo.ui.editors.controls.ThreeColumnContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.ThreeColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ThreeColumnProp {@cssClass}" style="{@cssText}"><div class="vi-col1"'+D+'></div><div class="divider1"'+D+'></div><div class="vi-col2"'+D+'></div><div class="divider2"'+D+'></div><div class="vi-col3"'+D+"></div></div>",markupSlots:{col1Node:function C(){return this.domNode.firstChild;},divider1Node:function H(){return this.domNode.childNodes[1];},col2Node:function A(){return this.domNode.childNodes[2];},divider2Node:function B(){return this.domNode.childNodes[3];},col3Node:function E(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},layoutConfig:{w:{col1Node:"30%",divider1Node:"5px",col2Node:"30%",divider2Node:"5px",col3Node:"40%"},xt:true},shouldPropagateEnabled:true,col1Width:"30%",divider1Width:"5px",col2Width:"30%",divider2Width:"5px",col3Width:"40%",init:function G(I){this._super(I);var J=this.layoutConfig=JSON.parse(JSON.stringify(this.layoutConfig)),K=J.w;K.col1Node=this.col1Width;K.divider1Node=this.divider1Width;K.col2Node=this.col2Width;K.divider2Node=this.divider2Width;K.col3Node=this.col3Width;},getControl:function F(I){return(this.children||[]).filter(function(J){return J.slot==="col"+I+"Node";})[0];}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ui._HasUITheme","mstrmojo.Container","mstrmojo._HasPopup","mstrmojo.ui._HasUITheme");var B=mstrmojo.func,D=mstrmojo.dom,C=mstrmojo.ui._HasUITheme.EnumThemeNames,G="mstrmojo-popup-widget-hosted";mstrmojo.ui.PopupButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.ui.PopupButton",onPopupWidgetClosed:mstrmojo.emptyFn,onPopupWidgetOpened:mstrmojo.emptyFn,anchorSlot:"domNode",isHostedWithin:true,hostedCSSClass:"",destroy:function J(N){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);}this._super(N);},getPopupWidget:mstrmojo.emptyFn,postCreateChildren:function E(){var N=this.getPopupWidget();if(!N||N._pbCfg){return ;}var O=function O(Q,P){return function(){Q.apply(P,arguments);};};N.onOpen=B.composite([O(this.onPopupWidgetOpened,this),N.onOpen||mstrmojo.emptyFn]);N.onClose=B.composite([O(this.onPopupWidgetClosed,this),N.onClose||mstrmojo.emptyFn]);N._pbCfg=true;},onclick:function L(N){if(this.isClickingAnchorSlot(N)){var O=this.getPopupWidget();if(!O.visible){this.openPopup(O);}else{this.closePopup();}}},isClickingAnchorSlot:function M(N){var O=N.getTarget();return O===this[this.anchorSlot]||O.parentNode===this[this.anchorSlot];},onPopupAutoClosed:function I(O,N){if(D.contains(this[this.anchorSlot],D.eventTarget(N,O),true)){return false;}},getPopupHostNode:function K(){return this.containerNode;},getPopupConfig:function H(){var O=[G],N=this.hostedCSSClass;if(N){O.push(N);}var P=new mstrmojo.ui.PopupConfig({hostId:this.id,hostElement:this.getPopupHostNode(),anchorElement:this[this.anchorSlot],isHostedWithin:this.isHostedWithin,hostProxyCssClass:O.join(" ")});return this.disposables?this.addDisposable(P):P;},unrender:function F(N){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);delete this._listenerProc;}this._super(N);},postBuildRendering:function A(){var R=this.getPopupWidget();if(R){var U=this.getPopupConfig();if(!U.isHostedWithin){var P=this.parent||this.opener,O=U.hostProxyCssClass.split(" ");O.push(this.domNode.className);while(P){var S=P.themeClassName;if(S){O.push(S);break;}P=P.parent||P.opener;}if(U.useDarkTheme){O.splice(O.indexOf(C.LIGHT_THEME),1);O.push(C.DARK_THEME);}U.hostProxyCssClass=O.join(" ");}mstrmojo.Obj.free(R.popupConfig);R.popupConfig=R.addDisposable(U);}if(!(this.editableSlot&&D.isMobile)){var N=R.id,Q=this._listenerProc=function(){var V=mstrmojo.all[N];if(V&&V.visible&&V.adjustCornersForPopupOverflow){V.adjustCornersForPopupOverflow();}};if(this.isHostedWithin===false){D.attachEvent(window,"resize",Q);}}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasMarkup","mstrmojo.Image");mstrmojo.threshold.ImageBand=mstrmojo.declare(mstrmojo.Image,null,{scriptClass:"mstrmojo.threshold.ImageBand",cssClass:"mstrmojo-Image color-band"});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.threshold.ImageBand,{onwidthChange:mstrmojo.Widget.widthMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.NumStepperContentProvider","mstrmojo.num","mstrmojo.array");var A=mstrmojo.num,E=mstrmojo.array;var C="?";function B(H,G){var J=G?H.max:H.min,F=G?H.min:H.max,I=H.getValGroup(G?1:-1);return(J===null||(G?(I.every(function(K){return K<=J;})):(I.every(function(K){return K>=J;})))||(F!==null&&H.canLoop));}function D(I,H){var G=I.min,F=I.max,J=I.getValGroup(H?1:-1)||[];if((H&&F!==null&&J.some(function(K){return K>F;})||(!H&&G!==null&&J.some(function(K){return K<G;})))){if(I.canLoop){J.forEach(function(L,K){L=((L-G)%(F-G+1))+G;L=(L>=G)?L:L+(F-G+1);J[K]=L;});}else{return ;}}I.item[I.valField]=I.curValGroup=J;I.onTraverse();}mstrmojo.NumGroupStepperContentProvider=mstrmojo.declare(mstrmojo.NumStepperContentProvider,null,{scriptClass:"mstrmojo.NumGroupStepperContentProvider",curValGroup:null,init:function(F){this._super(F);},_initCurrent:function(){var H=this.item,F=this.curValGroup=H[this.valField];if(F===null||F===undefined){var G=this.min;this.curValGroup=G!==null?[G]:0;}this.curValGroup=E.ensureArray(this.curValGroup);},next:function(){D(this,true);},prev:function(){D(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},getValGroup:function(I){var F=this.curValGroup,G=this.interval,H=[];(F||[]).forEach(function(K,J){H[J]=F[J]+(G*(I||0));});return H;},getVal:function(){var F=null;(this.curValGroup||[]).forEach(function(G){if(F===null){F=G;}else{if(F!==C&&G!==F){F=C;}}});return F;},setVal:function(H){var I=this.min,G=this.max,F=this.curValGroup;if(typeof H!=="number"||isNaN(H)||A.inNumericRange(H,I,G)!==0){return ;}(F||[]).forEach(function(K,J){F[J]=H;});this.onTraverse();},_set_curValGroup:function(J,I){var H=this.min,G=this.max,F=this.getValGroup();if(I.some(function(K){return typeof K!=="number";})||I.some(function(K){return isNaN(K);})||I.every(function(L,K){return L===F[K];})||I.every(function(K){return A.inNumericRange(K,H,G)!==0;})){return false;}this.item[this.valField]=this.curValGroup=I;return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.NumStepperContentProvider","mstrmojo.date");var A=mstrmojo.date;mstrmojo.DateStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.DateStepperContentProvider",curVal:null,init:function(F){this._super(F);var G=this.item,E=G[this.intField],I=G[this.valField],H=this.minField,D=this.maxField,C=G[H],B=G[D];this.min=C&&A.getDateFromDateInfo(C);this.max=B&&A.getDateFromDateInfo(B);this.curVal=I?A.getDateFromDateInfo(I):(this.min?new Date(this.min):new Date());this.createChildProviders();},createChildProviders:function(){var B=this;mstrmojo.array.forEach(["year","month","day"],function(C){B[C+"CP"]=new mstrmojo.NumStepperContentProvider({item:{interval:1},canLoop:true,updateConfig:function(E,D,F){this.curVal=E;this.max=D;this.min=F;},onTraverse:function(){B.traverse(C,this.curVal);}});});this.updateChildProviders();},updateChildProviders:function(){var I=this.max,D=this.min,G=this.curVal.getFullYear(),F=this.curVal.getMonth(),H=this.curVal.getDate(),C=I&&(G===I.getFullYear()),E=D&&(G===D.getFullYear()),J=C&&(F===I.getMonth()),B=E&&(F===D.getMonth());this.yearCP.updateConfig(G,I?I.getFullYear():null,D?D.getFullYear():null);this.monthCP.updateConfig(F+1,C?I.getMonth()+1:12,E?D.getMonth()+1:1);this.dayCP.updateConfig(H,J?I.getDate():mstrmojo.date.getDaysOfMonth(G,F+1),B?D.getDate():1);},traverse:function(E,D){var C=this.curVal,G=(E==="year")?D:this.curVal.getFullYear(),B=(E==="month")?D:this.curVal.getMonth()+1,F=(E==="day")?D:this.curVal.getDate();F=Math.min(mstrmojo.date.getDaysOfMonth(G,B),F);C.setFullYear(G,B-1,F);if(this.max){C=Math.min(this.max,C);}if(this.min){C=Math.max(this.min,C);}this.curVal=new Date(C);this.updateChildProviders();if(this.onTraverse){this.onTraverse();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui._HasScroller","mstrmojo.css","mstrmojo.DI.DIHelpers");var F=mstrmojo.css,H=mstrmojo.string,A=mstrmojo.desc(14058,"Show Details"),E=mstrmojo.desc(14059,"Hide Details"),B=mstrmojo.DI.DIHelpers,D=mstrmojo.desc(14060,"We are sorry for the inconvenience. Please {contact} your administrator for help.").replace("{",'<span class="dyn-link">').replace("}","</span>");mstrmojo.ui.editors.ErrorDialogContent=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",markupString:'<div class="mstrmojo-error-content {@cssClass}" mstrAttach:click><div class="scroll-container"><div>{@shortDesc}</div><div class="contact">'+D+'</div><div class="toggle-details-link" >'+A+'</div><div class="error-details">{@longDesc}</div></div></div>',markupSlots:{scrollNode:function(){return this.domNode.firstChild;},contactNode:function(){return this.domNode.firstChild.children[1].getElementsByClassName("dyn-link")[0];},toggleDetailsNode:function(){return this.domNode.firstChild.children[2];},errorDetailsNode:function(){return this.domNode.firstChild.children[3];}},markupMethods:{onshowDetailsChange:function(){var K=this.showDetails;this.toggleDetailsNode.innerHTML=K?E:A;F.toggleClass(this.domNode,"show-details",K);this.updateScrollbars();}},cssClass:undefined,shortDesc:undefined,longDesc:undefined,showDetails:false,showToggle:true,enableContactStr:true,allowHTML:false,init:function I(K){this._super(K);this.shortDesc=this.shortDesc||mstrmojo.desc(14061,"An error has occurred");},onclick:function J(K){var M=K.getTarget(),L,N=this.longDesc;if(M===this.contactNode){L="mailto:?subject="+encodeURI("Issue: "+this.shortDesc)+(N?("&body="+encodeURI("Detail:\r\n"+N)):"");mstrApp.openPage(L,"_self");}else{if(M===this.toggleDetailsNode){this.set("showDetails",!this.showDetails);this.parent.raiseEvent({name:"EditorResized"});this.parent.positionDialog();}}},setupScrollNodes:function C(){this.scrollNode=this.scrollNode;},preBuildRendering:function G(){this._super&&this._super();if(!this.allowHTML){this.longDesc=H.encodeHtmlString(H.decodeHtmlString(this.longDesc),true);}},postBuildRendering:function(){var K=this.domNode.firstChild.children[1];this._super&&this._super();!this.showToggle&&F.addClass(this.toggleDetailsNode,"hide");!this.enableContactStr&&F.addClass(K,"invisible");}});})();(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.elementHelper");var AA="Metrics",H=2,g=mstrmojo.array,L=mstrmojo.hash,a=mstrmojo.elementHelper,A="\u001E";var J=1,n=2,N=0,X=2,B=3;function V(AG){if(!AG){return false;}var AH=this.scm,AI,AL,AK,AJ,AF,AE=false;for(AL in AH){AK=AH[AL];AJ=AK.cgb;for(AI in AJ){AF=AG[AJ[AI]];if(AF){if(!AK.tks){AK.tks=AF;AE=true;}else{if(AK.tks&&(AK.tks.indexOf(AF)<0)){AK.tks+=A+AF;AE=true;}}}}}return AE;}function l(){var AF=this.data,AE=AF.gts;if(!AE){return ;}var AG;g.forEach([AE.row,AE.col],function(AH){g.forEach(AH,function(AI){if(AI.sc){AG=AG||{};AG[AI.id||AA]=AI.sc;if(AI.fid){AG[AI.id+"_"+AI.fid]=AI.sc;}}});});this.scm=AG;V.call(this,this.docModel.getCGBMap());}function AD(AE,AF){var AG=this.getDataService();AG[AE].apply(AG,AF);}function Y(AM,AS,AL){var AO=AS||a.getIdPresentation(AM),AT,AE;switch(AO){case"terse":case"terseLong":AM=AM.replace(/\\;/g,"*ESCAPESEMICOLON*");AT=AM.split(";");return(AT[0]+";"+AT[1]+(AL?";"+AL:"")).replace(/\*ESCAPESEMICOLON\*/g,"\\;");case"old":var AG="",AJ=2;AM=AM.replace(/\*:/g,"*COLON*").replace(/\\/g,"\\\\").replace(/;/g,"\\;");AT=AM.split(":");while(AT[AJ]){AG+=":"+AT[AJ];AJ++;}return("h"+AT[1]+AG+";"+AT[0]+(AL?";"+AL:"")).replace(/\*COLON\*/g,"\\:");case"oldLong":var AF=0,AR,AK,AN=[],AU=[],AQ,AP,AI,AH=function AH(){if(AF<0){return null;}var AY=false,AW=-1,AZ,AX=null;for(AQ=AF;AQ<AM.length;AQ++){AZ=AM.charAt(AQ);if(AZ==="*"&&!AY){AY=true;}else{if(AZ===":"&&!AY){AW=AQ;break;}else{AY=false;}}}if(AW===-1){AX=AM.substring(AF);AF=-1;}else{AX=AM.substring(AF,AW);AF=AW+1;}return AX;};AI=AH();if(AI!=="BB"&&AI!=="BF"){return AM;}AE=AH();if(AI==="BF"){AE=AH();}AR=parseInt(AH(),10);AK=parseInt(AH(),10);for(AP=0;AP<AK;AP++){AU[AP]=parseInt(AH(),10);AH();}for(AP=0;AP<AK;AP++){var AV=AH();if(AU[AP]<AR&&AU[AP]>=0){AN[AU[AP]]=AV.replace(/\\/g,"\\\\").replace(/\*:/g,"\\:").replace(/;/g,"\\;");}}return"h"+AN.join(":")+";"+AE+(AL?";"+AL:"");}return AM;}mstrmojo.DocXtabModel=mstrmojo.declare(mstrmojo.XtabModel,null,{scriptClass:"mstrmojo.DocXtabModel",docModel:null,init:function w(AE){this._super(AE);var AF=this;this.docModel.attachEventListener("CGBMapChange",this.id,function(AG){if(AF.xtab.onCBGMapChange){AF.xtab.onCGBMapChange(AG);}});},ondataChange:function p(){l.call(this);},getMessageId:function I(){return this.docModel.mid;},getDataService:function K(){return this.docModel.getDataService();},getAction:function e(AS,AI,AN){var AQ=AS[0],AF=AQ&&AQ.at;var AH;if(AF){if((AF&H)>0){var AG=this.getCellTitleInfo(AQ),AO=AG&&AG.title,AE=AO&&AO.id,AP=this.scm;this.sti={titleId:AE||AA};var AM=(AE&&AP[AE])||AP[AA],AL=function(){var AT=[];g.forEach(AS,function(AU){if(AU._e&&AU._e.id){AT.push(AU._e.id);}});return AT.join(A);};if(AM){var AR=this.xtab,AJ=(AR.allowToggleSelections&&AM.all&&AN),AK=(AG.isSrcTitle||AJ);this.sti.deselectCurrent=AJ;AH={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:AI,ck:AM.ck,tks:AM.tks,eid:AK?"OA:(All)":AL(),ctlKey:AM.ckey,sliceId:AR.sid,isUConDS:AM.isUConDS,ifw:AM.ifw}};}}}if(!AH){AH=this._super(AS);}if(AH&&AH.a){AH.a.sliceId=this.xtab.sid;}return AH;},getDownloadAction:function u(AG,AK,AI,AH,AL,AF,AJ,AM){var AE=this._super(AG,AK,AI,AH,AL,AJ,AF);AE.sliceId=this.xtab.sid;if(AM&&AM.name==="TransactionUpdates"){if(AE.partialUpdate){if(AE.partialUpdate.selectors){AE.partialUpdate.selectors.push(AM.ctlKey);}else{AE.partialUpdate.selectors=[AM.ctlKey];}}else{AE.partialUpdate={selectors:[AM.ctlKey]};}}return AE;},getDrillAction:function o(AF,AH){var AG=this._super(AF,AH),AE=this.getCellTitleInfo(AF[0]);if(AG&&AG.isWithin){AG.attrObj=AE.title;}AG.srcMsgId=this.docModel.mid;return AG;},sort:function z(AF,AG){var AE=this.xtab;AF.stp=AF.stp||this.getSubTotalsPos();AF.subTotalsPos=AF.stp;AF.nodeKey=AE.k;AF.treeType=AE.treeType||1;if(AE.gridData.ctlTPKeys){AF.selectors=AE.gridData.ctlTPKeys.split(A);}AD.call(this,"sortGrid",[AF,AG]);},getAdvSortData:function W(AE,AF){AD.call(this,"getAdvSortData",[AE,AF]);},pivot:function M(AE,AF){AD.call(this,"pivot",[AE,AF]);},removeUnit:function U(AE,AF){AD.call(this,"removeUnit",[AE,AF]);},getTotalsAction:function O(AE,AH,AF){var AG=this.getPivotAction(AE);AG.act="showTotals";AG.subtotalType=AH;AG.clearSubtotalType=AF;return AG;},getRemoveAxisTotalsAction:function j(AF,AE){return{act:"removeAxisTotals",axis:AE,subtotalType:AF};},showTotals:function E(AE,AF){AD.call(this,"showTotals",[AE,AF]);},drillGrid:function d(AE,AF){AD.call(this,"drillGrid",[AE,AF]);},downloadGridData:function k(AE,AF){AD.call(this,"downloadGridData",[AE,AF]);},loadLayout:function h(AE){this.docModel.loadLayout(AE);},resizeXtabColumn:function Q(AE,AF){AD.call(this,"resizeXtabColumn",[AE,AF]);},submitTemplateActions:function x(AE,AF,AG){AD.call(this,"submitTemplateUpdates",[AE,AF,AG]);},getDerivedMetricAction:function q(AE,AF){return{did:AE._e.oid,um:AE.um,alias:AE._e.n,n:AE._e.n,v:AE.um?AE.formula:AE._e.v,mix:AE.mix,cmd:AF,model:this};},getAddTemplateUnitAction:function D(AI,AK,AG,AE){var AF=AI.t,AJ=this.data.gsi,AH={act:"addUnit",unitId:AI.did,unitType:AF,unitPos:++AE,dsId:AK,isFirst:!AJ||(AJ.cols.length===0&&AJ.rows.length===0)};if(AF!==4||!AJ||!AJ.mx.length){AH.axis=AG;}return AH;},getRemoveTemplateUnitAction:function t(AE){return{act:"removeUnit",unitId:AE.did||AE.id,unitType:AE.t||4,is_disableonly:1};},getRenameTemplateUnitAction:function G(AI,AG,AE,AF){var AH={act:"renameUnit",id:AI,type:AG,name:AE};if(AF){AH.isDynamicAlias=true;}return AH;},doesNameExistOnTemplate:function C(AG,AK,AI,AF){var AJ=AG.node.data.gsi,AE=AI===4,AH=AE?AJ.mx:AJ.rows.concat(AJ.cols);return AH.some(function(AL){return AL.did!==AK&&(AE||AL.t===AI)&&AL.n===AF;});},getPivotUnitAction:function R(AH,AE,AL,AG,AK,AJ){AE++;var AI=parseInt(AK,10),AF=parseInt(AJ,10);return L.copy(isNaN(AI)||isNaN(AF)?{}:{originAxis:AI,originUnitPos:++AF},{act:"pivot",unitId:String(AL||""),unitType:AG||"",axis:AH,unitPos:AE});},getShowTotalsUnitAction:function b(AH,AF,AG,AE){return{act:"showTotals",unitId:String(AH||""),unitType:AF||"",subtotalType:AG,clearSubtotalType:AE};},getMoveSubTotalAction:function i(AG,AH,AI,AL){var AN=(this.xtab.gridInfo&&this.xtab.gridInfo.sorts)||[],AF=AG&&AG.axis,AJ;function AE(AT,AU){var AV=[];if(AU.length>=AT){if(AL){AV=AT===J?AU[n-1]:AU[J-1];}else{AV=AU[AT-1];}}function AP(AW,AX){return AW.indexOf("0!00000000000000000000000000000000!!!!"+AX)>-1;}function AS(AW,AX){return !!(AW&&AW.length&&AW[0].key&&!AP(AW[0].key,AX));}var AR=AS(AV,AT),AQ;if(AR){AQ=L.clone(AU);AQ.forEach(function(AX,AW){if(!AS(AX,AW+1)){AQ[AW]=null;return ;}AQ[AW]=AX=g.filter(AX,function(AY){return !AP(AY.key,AT);});(AX||[]).forEach(function(AZ){var AY=AZ.key;if(AY){AZ.key=AY.replace(/;/g,"\\;").replace(/\u001e/g,";");if(AL){AY=AZ.key;if(AY.indexOf("!!1")>=0){AZ.key=AY.replace(/!!1/g,"!!2");}else{AZ.key=AY.replace(/!!2/g,"!!1");}}}});});if(AL){AQ=AQ.reverse();}}return AR?AQ:[];}function AK(AR,AS){if(!AS||AS.length<AR){return false;}var AP=AS[AR-1];if(!AP||AP.length!==1){return false;}var AT="!5",AQ=AP[0].key;return AQ&&AQ.slice(-2)===AT;}function AM(AS,AP,AR,AQ,AT){return{act:"moveSubTotal",nodeKey:AS,sorts:AP,subTotalsPos:AR,stt:AT||-1,axis:AQ};}function AO(){var AR=this.data,AQ=AR&&AR.gts,AV=AQ&&AQ.rowSubPos||N,AP=AQ&&AQ.colSubPos||N,AU=[AV,AP];if((!AF||AF===J)&&AV===N){var AT=AQ&&AQ.row||[],AS=false;g.forEach(AT,function(AW){if(AW.ast&&AW.ast.length>0){AS=true;return false;}});if(!AS||AR&&AR.gsi&&AR.gsi.hidesb){AU[J-1]=X;AJ=AE(J,AN);return AM(AI,AJ,AU,J);}}return null;}if(!AH){return AO.call(this);}else{AJ=AE(AF,AN);return AM(AI,AJ,AH,AF,AK(AF,AJ)&&AG.hst?AG.hst:-1);}return null;},getSortGridAction:function y(AH,AF,AG,AE){return{sortKey:AF,subTotalsPos:AH,axis:AG,isAsc:AE};},getColumnResizeAction:function S(AH,AE,AF,AG,AI){return{act:"changeXtabColumnWidth",unitId:AH,unitType:AE,width:AF||0,depth:AG||1,ec:AI};},getNormalizedFormElementId:function AC(AF,AE){return Y(AF,null,AE);},compareNormalizedElementsId:function s(AF,AE){if(AF===AE){return true;}else{if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}if(a.isAttributeIdsLinked(a.getAttributeId(AF),a.getAttributeId(AE),this.docModel.als&&this.docModel.als.idLinks||{})){return a.getElementValue(AF)===a.getElementValue(AE);}}return false;},compareElementsId:function Z(AI,AH){if(!this.docModel.als){return this.compareElementsIdInSingleGrid(AI,AH);}var AG=a.getIdPresentation(AI),AF=a.getIdPresentation(AH),AE=Y(AI,AG),AJ=Y(AH,AF);return this.compareNormalizedElementsId(AE,AJ);},compareElementsIdInSingleGrid:function f(AH,AG){var AF=a.getIdPresentation(AH),AE=a.getIdPresentation(AG);if(AF!==AE||AF==="oldLong"||AF==="terseLong"){return Y(AH,AF)===Y(AG,AE);}return AH===AG;},getLinkedAttributes:function m(AE){var AF;if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}AF=this.docModel.als&&this.docModel.als.idLinks||{};return AF[AE];},getCellDataUnion:function c(AG){var AH=this,AF=AG.hasOwnProperty("mix"),AI=[],AJ,AE=function AE(AL){var AK=AH.getCellTitleInfo(AL),AN=AK.title,AM=AN&&AN.id;if(AM){AJ={};if(AL.stt){AJ.isSubtotal=true;}AI.push(L.copy(AJ,{tid:AM,eid:AL._e&&AL._e.id,v:AL.v||AL._e&&AL._e.n}));}};if(AG){if(!AF){AE(AG);}else{g.forEach([AG._lp,AG._tp],function(AK){var AL=AK;while(AL&&AL!==AL._p){AE(AL);AL=AL._p;}});}}return AI;},getObjectInfo:function F(AE){var AF;g.forEach((this.data.gsi.cols||[]).concat(this.data.gsi.rows||[]),function(AG){if(AG.did===AE){AF=AG;}});return AF;},supportsViewFilterActions:function P(AE){if(this.data&&this.data.gsi){var AF=this.getObjectInfo(AE);return AF&&!AF.de&&(AF.t!==1)&&(AF.t!==47||AF.st===12033);}return false;},getSelectorControlMapInfo:function AB(){var AF=[],AH=this.data.gsi,AG=[],AE;if(this.scm){L.forEach(AH,function(AI){if(AI instanceof Array){AG=AG.concat(AI);}});L.forEach(this.scm,function(AJ,AI){AE=g.find(AG,"did",AI);if(AE!==-1){AF.push({did:AI,n:AG[AE].n,sc:AJ});}});}return AF;},getShowDefinedSubtotalsAction:function(){return{act:"showDefinedSubtotals"};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.array","mstrmojo.date","mstrmojo.Stepper","mstrmojo.android.ui.Button","mstrmojo.DateStepperContentProvider","mstrmojo.NumStepperContentProvider");var V=mstrmojo.array,Q=mstrmojo.date,L=mstrmojo.hash,R=mstrmojo.android.ui.Button.newButton,I=mstrmojo.expr.DTP,D={interval:1},G={min:1,max:12,interval:1,value:12},N={min:0,max:23,interval:1,value:0},E={min:0,max:59,interval:1};function C(){var X=this.dtp,a=this.stepperClass,Y=this[this.valueField],M=[],Z,H;if(this._hasDate){M.push({scriptClass:a,slot:"monthNode",alias:"monthStepper",title:mstrmojo.desc(871,"month"),provider:this.dateProvider.monthCP},{scriptClass:a,slot:"dayNode",alias:"dayStepper",title:mstrmojo.desc(872,"day"),provider:this.dateProvider.dayCP},{scriptClass:a,slot:"yearNode",alias:"yearStepper",title:mstrmojo.desc(873,"year"),provider:this.dateProvider.yearCP});}if(this._hasTime){M.push({scriptClass:a,slot:"hourNode",alias:"hourStepper",provider:this.hourProvider},{scriptClass:a,slot:"minNode",alias:"minStepper",provider:this.minProvider});}if(!this.hideSwitchers){if(X!==I.TIME){Z=(Y&&Y.date)?Q.formatDateInfo(Y.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT):mstrmojo.desc(2052,"Date");M.push(R(Z,function(){this.parent.toDateView();},{alias:"dateToggle",slot:"switcherNode",cssClass:"",selected:true}));}if(X!==I.DATE){H=(Y&&Y.time)?Q.formatTimeInfo(Y.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT):mstrmojo.desc(2170,"Time");M.push(R(H,function(){this.parent.toTimeView();},{alias:"timeToggle",slot:"switcherNode",cssClass:"",selected:X==I.TIME}));}}if(this._hasDate){this.viewCssClass="dateView";}else{if(this._hasTime){this.viewCssClass="timeView";}}this.addChildren(M);}function P(){var b=[this.valueField,"min","max"],M=L.copy(D),a=this.is24HourMode?L.copy(N):L.copy(G),Z=L.copy(E),Y=this[this.valueField],H=Y&&Y.time,X=this;V.forEach(b,function(c){M[c]=L.copy(X[c]);});if(this._hasDate){this.dateProvider=new mstrmojo.DateStepperContentProvider({item:M,valField:this.valueField,canLoop:true,onTraverse:function(){X.updateDate();}});}if(this._hasTime){if(this.minuteInterval!==undefined){Z.interval=this.minuteInterval;}delete this.minuteInterval;if(H){if(!this.is24HourMode){a.value=H.hour%12||12;this.set("meridiem",(H.hour<12));}else{a.value=H.hour;}Z.value=H.min;}this.hourProvider=new mstrmojo.NumStepperContentProvider({item:a,valField:"value",canLoop:true,onTraverse:function(){X.updateTime();}});this.minProvider=new mstrmojo.NumStepperContentProvider({item:Z,valField:"value",canLoop:true,renderer:{render:function(c){return String(c).length===1?("0"+c):c;}},onTraverse:function(){X.updateTime();}});}}mstrmojo.DateTimePicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DateTimePicker",value:null,min:null,max:null,meridiem:true,hideSwitchers:false,minuteInterval:null,is24HourMode:false,dtp:mstrmojo.expr.DTP.TIMESTAMP,viewCssClass:"",valueField:"value",stepperClass:"mstrmojo.Stepper",markupString:"<div id='{@id}' class='mstrmojo-DateTimePicker' style='{@cssText}'><div class='switcher'></div><div class='{@viewCssClass}'><span class='stepNode month'></span><span class='stepNode day'></span><span class='stepNode year'></span><span class='stepNode hour'></span><span class='stepNode min'></span><span class='meridiem' mstrAttach:click></div></div></div>",markupSlots:{switcherNode:function(){return this.domNode.firstChild;},viewNode:function(){return this.domNode.children[1];},monthNode:function(){return this.domNode.children[1].children[0];},dayNode:function(){return this.domNode.children[1].children[1];},yearNode:function(){return this.domNode.children[1].children[2];},hourNode:function(){return this.domNode.children[1].children[3];},minNode:function(){return this.domNode.children[1].children[4];},meridiemNode:function(){return this.domNode.children[1].children[5];}},markupMethods:{onmeridiemChange:function(){if(this.is24HourMode){this.meridiemNode.display="none";}else{this.meridiemNode.innerHTML=this.meridiem?mstrmojo.locales.datetime.AM_NAME:mstrmojo.locales.datetime.PM_NAME;}},onviewCssClassChange:function(){this.viewNode.className=this.viewCssClass;}},init:function O(M){this._super(M);var H=this.dtp;this._hasDate=(H===I.DATE||H===I.TIMESTAMP);this._hasTime=(H===I.TIME||H===I.TIMESTAMP);P.call(this);C.call(this);},getDateTime:function B(){return{date:this.getDate(),time:this.getTime()};},getDate:function F(){if(this._hasDate){var H=this.dateProvider.curVal;return{year:H.getFullYear(),month:H.getMonth()+1,day:H.getDate()};}return null;},getTime:function S(){if(this._hasTime){return{hour:!this.is24HourMode?Q.capitalHour(this.hourProvider.curVal,this.meridiem?" AM":" PM"):this.hourProvider.curVal,min:this.minProvider.curVal};}return null;},getDateTimeString:function K(){var H="";if(this._hasDate){H+=Q.formatDateInfo(this.getDate(),mstrmojo.locales.datetime.DATEOUTPUTFORMAT);}if(this._hasDate&&this._hasTime){H+=" ";}if(this._hasTime){H+=Q.formatTimeInfo(this.getTime(),mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}return H;},updateDate:function A(){if(this.hasRendered){var H=this;V.forEach(["year","month","day"],function(M){H[M+"Stepper"].updateDisplayText();});}if(this.dateToggle){this.dateToggle.set("text",Q.formatDateInfo(this.getDate(),mstrmojo.locales.datetime.DATEOUTPUTFORMAT));}},updateTime:function J(){if(this.timeToggle){this.timeToggle.set("text",Q.formatTimeInfo(this.getTime(),mstrmojo.locales.datetime.TIMEOUTPUTFORMAT));}},toDateView:function U(){this.set("viewCssClass","dateView");this.dateToggle.set("selected",true);var H=this.timeToggle;if(H){H.set("selected",false);}},toTimeView:function W(){this.set("viewCssClass","timeView");var H=this.dateToggle;if(H){H.set("selected",false);}this.timeToggle.set("selected",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasLayout");mstrmojo.ui.editors.controls.PreviewButton=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.PreviewButton",markupString:'<div id="{@id}" class="mstrmojo-ui-PreviewButton {@cssClass}" style="{@cssText}"><div class="cf" mstrAttach:click><div class="preview"></div><div class="btn">&nbsp;</div></div><div class="host"></div></div>',markupSlots:{previewNode:function(){return this.domNode.firstChild.firstChild;},btnNode:function(){return this.domNode.firstChild.lastChild;},widgetHostNode:function(){return this.domNode.lastChild;},clickableNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{previewNode:"100%",btnNode:"100%",widgetHostNode:"0px"},w:{previewNode:"100%",btnNode:"20px",widgetHostNode:"all"},xt:true},isHostedWithin:false,getLayoutOffsets:function B(){return{h:2,w:2};},anchorSlot:"clickableNode",updatePreview:function C(){throw new Error(this.scriptClass+" must implement updatePreview.");},getPopupHostNode:function A(){return this.widgetHostNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");var B=mstrmojo.dom;mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",itemTitleField:null,defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,allowHTML:false,_set_items:function(H,F){var G=this.items;this.items=F||[];return G!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var G=this.value,F=this.selectedIndex,I=this.items||[],J,H;if(F===undefined||(G!==null&&(F===-1||(F!==-1&&I[F]&&I[F][this.itemIdField]!==G)))){F=mstrmojo.array.find(I,this.itemIdField,G);F=(F>-1)?F:this.defaultSelection;this.selectedIndex=F;}else{if(G===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=J=I[this.selectedIndex];if(J){H=J[this.itemField];}else{H=this.defaultText||"";}this.set("text",H);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function D(){var G=this.value,F=-1;if(G!==null){F=mstrmojo.array.find(this.items,this.itemIdField,G);}if(F>-1){this.selectedItem=this.items[F];this.selectedIndex=F;}},togglePopup:function E(){if(this.popupToBody){var I=B.position(this.popupNode,true),H=this.popupRef,F={left:Math.round(I.x)+"px",top:Math.round(I.y)+"px"};if(!H.hasRendered){delete H.slot;F.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(F,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var G=this.popupRef.domNode;if(G){if(this.fixWidth){G.style.width=(this.domNode.offsetWidth-2)+"px";}else{G.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(F){if(B.getButton(F.hWin,F.e)===B.MOUSE_BUTTON.LEFT){this.togglePopup();}},unrender:function C(F){var G=this.popupRef;if(this.popupToBody&&G.hasRendered){G.unrender(false);}if(this._super){this._super(F);}},itemName:function(H,F,G){return this.allowHTML?H[G.itemField]:mstrmojo.string.encodeHtmlString(H[G.itemField]);},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,adjustSize:function(){var G=this.opener,F=this.domNode;if(G&&G.fixWidth){mstrmojo.css.addClass(F,["fix-width"]);}if(G&&G.fixHeight){mstrmojo.css.addClass(F,["fix-height"]);}},onOpen:function(){var H=this.opener,G=H&&H.popupZIndex,I=(H&&H.popupCssClass)||"",F=this.domNode;if(G){F.style.zIndex=G;}if(I){mstrmojo.css.addClass(F,[I]);}this.adjustSize();},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(I,F,G){var H=I[G.itemCSS]||G.parent.opener.item2textCss&&G.parent.opener.item2textCss(I)||"",J=G.parent.opener.itemName;return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+H+'" title="'+I[G.itemTitleField||G.itemField]+'">'+(J(I,F,G)||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",itemTitleField:"this.parent.opener.itemTitleField",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var H=this.parent,I=H.visible,F=H.opener,G=this.selectedItem;if(!F||!G||!I){return ;}F.set("value",G[this.itemIdField]);}}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label","mstrmojo.WaitIcon");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div class="mstrmojo-IncFetch-content"></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,U=this.parent.parent;if(R===""){U.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);U.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.SelectBox","mstrmojo._CanValidate","mstrmojo.MetricSelectorUtility");var D=mstrmojo.MetricSelectorUtility,K=mstrmojo.validation,G=mstrmojo.expr,E=mstrmojo.num,N=D.OP,F=[{n:mstrmojo.desc(2795,"Equals"),v:N._EQUALS},{n:mstrmojo.desc(2796,"Does not equals"),v:N._NOT_EQUALS},{n:mstrmojo.desc(521,"Greater than"),v:N._GREATER},{n:mstrmojo.desc(522,"Greater than or equal to"),v:N._GREATER_EQUAL},{n:mstrmojo.desc(523,"Less than"),v:N._LESS},{n:mstrmojo.desc(524,"Less than or equal to"),v:N._LESS_EQUAL},{n:mstrmojo.desc(519,"Between (enter value1;value2)"),v:N._BETWEEN},{n:mstrmojo.desc(614,"Not between (enter value1;value2)"),v:N._NOT_BETWEEN},{n:mstrmojo.desc(898,"In (enter value1;value2; ...;valueN)"),v:N._IN},{n:mstrmojo.desc(2394,"Not In (enter value1;value2; ...;valueN)"),v:N._NOT_IN},{n:mstrmojo.desc(2202,"Is null"),v:N._IS_NULL},{n:mstrmojo.desc(2203,"Is not null"),v:N._IS_NOT_NULL}],L=F.slice(0,10),J="padding:2px 2px 2px 2px",H=F.slice(10,12);var C=function(a,S,U,W,V){var X;if(V===2){return S;}var b=String(a).split(";"),Y=K.STATUSCODE.INVALID_VALIDATOR,R=K.STATUSCODE.VALID;if(W&&b&&b.length>1){S.code=Y;}else{for(X=0;X<b.length;X++){var Z=parseFloat(b[X],10);if(isNaN(Z)||(U&&((b[X].match(/^\d+(\.\d+)?%$/)===null&&b[X].match(/^\d+(\.\d+)?$/)==null)||Z<0||Z>100))||(!U&&b[X].match(/\d+$/)===null)){S.code=Y;}if(S.code!==R){break;}}}if(S.code!==R){S.msg=mstrmojo.desc(6103,"Please fix any invalid data");}return S;};var M=function(R){R=parseFloat(R);return isNaN(R)?"54px":((R*72/16)+"pt;");},Q=function(U){if(U.hasRendered){var S=U.domNode.style;S.font=U.font;S.width=M(S.fontSize);}else{var R=U.font.match(/[^\s]*?pt/)||[];U.cssText=U.cssText+" font:"+U.font+"; width:"+M(R[0]);}},I=function(R){if((R>=8&&R<=16)||(R>=23&&R<=25)){return false;}return true;};mstrmojo.MetricQualification=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.MetricQualification",cssClass:"qs",cssText:"width:100%",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},getClientHeight:function P(){return this.domNode.clientHeight+2;},rows:1,cols:4,layout:[{cells:[{cssText:"width:100%"},{cssText:"width:56px"},{cssText:"width:56px"},{cssText:"width:18px"}]}],init:function(R){if(this._super){this._super(R);}this._init();},_init:function(U){var S;switch(this.qua){case 0:this.low=(this.da&&this.da.low)||0;this.high=(this.da&&this.da.high)||0;break;case 1:case 2:this.low=1;this.high=(this.da&&this.da.cnt)||0;break;case 3:case 4:this.low=0;this.high=100;break;}if(U){this.cs=[];this.f=this.ft=null;}var W=D.getOpIdxByfunc(this.f,this.ft),V=I(this.dt)?N._GREATER_EQUAL:N._IS_NULL;this.set("opId",(W==-1)?V:W);var R=(this.cs&&this.cs.length>0)?E.toLocaleString(this.cs[0].v):"";if(this.opId===N._IN||this.opId===N._NOT_IN){for(S=1;S<this.cs.length;S++){R+=";"+E.toLocaleString(String(this.cs[S].v));}}else{this.set("cs2",(this.cs&&this.cs.length>1)?E.toLocaleString(this.cs[1].v):"");}this.set("cs1",R);this.vldTbL.validate();this.vldTbH.validate();this.changeQual=false;},updateData:function B(R,S){this.da=R;this.updateExpr(S);},updateExpr:function A(R){if(R){this.cs=R.cs;this.f=R.f;this.ft=R.ft;this.qua=R.qua;}this._init();},onquaChange:function O(R){this._init(true);this.func.items=(this.qua!==0)?L:I(this.parent.dt)?F:H;this.func.refresh();this.changeQual=true;this.onchange();},children:[{slot:"0,0",alias:"func",scriptClass:"mstrmojo.SelectBox",cssText:"width:100%",size:1,bindings:{sv:"this.parent.opId",font:"this.parent.font"},onfontChange:function(){if(this.hasRendered){this.domNode.style.font=this.font;}else{this.cssText="width:100%;font:"+this.font;}},onsvChange:function(){if(this.sv!==null&&this.sv!==undefined){this.set("selectedItem",{v:this.sv});}},postCreate:function(){if(mstrmojo.dom.isIE){this.itemDisplayField="n";this.showItemTooltip=true;}this.items=(this.parent.qua!==0)?L:I(this.parent.dt)?F:H;},onchange:function(){var S=this.parent,U=this.selectedItem;if(U&&U.v!==null&&U.v!==undefined){var R=D.getIncludeByOp(U.v);S.include=R;if(S.parent&&R!==S.parent.include){S.changeInclude=true;}else{S.changeInclude=false;}S.set("opId",U.v);}if(mstrApp.isMobile&&(U.v===N._IS_NULL||U.v===N._IS_NOT_NULL)){if(S.onchange){S.onchange();}}}},{slot:"0,1",alias:"vldTbL",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(R){var S={id:this.id,code:K.STATUSCODE.VALID,msg:""},U=this.parent;C(R,S,(U.qua===3||U.qua===4),(U.opId!==8&&U.opId!==9),(U.numFmts&&U.numFmts.cat));return S;}},bindings:{visible:"this.parent.opId!=10&&this.parent.opId!=11",value:"this.parent.cs1",font:"this.parent.font"},onfontChange:function(){Q(this);},onValid:function(){var S=this.parent,R=this.domNode;S.set("cs1",this.value);if(R&&R.value.length>6){R.title=R.value;}else{if(R){R.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs1","");}},onkeyup:function(S){var R=S.hWin,W=S.e||R.event,V=this.parent,U=S.src.domNode;if(W.keyCode===13&&V.apply&&V.apply.enabled){V.apply.onclick();}}},{slot:"0,2",alias:"vldTbH",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(R){var S={id:this.id,code:K.STATUSCODE.VALID,msg:""},U=this.parent;C(R,S,(U.qua===3||U.qua===4),(U.opId!==8&&U.opId!==9),(U.numFmts&&U.numFmts.cat));return S;}},bindings:{visible:"this.parent.opId ==7 ||this.parent.opId ==6",value:"this.parent.cs2",font:"this.parent.font"},onfontChange:function(){Q(this);},onValid:function(){this.parent.set("cs2",this.value);var R=this.domNode;if(R&&R.value.length>6){R.title=R.value;}else{if(R){R.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs2","");}},onkeyup:function(S){var R=S.hWin,V=S.e||R.event,U=this.parent;if(V.keyCode===13&&U.apply&&U.apply.enabled){U.apply.onclick();}}},{slot:"0,3",alias:"apply",title:mstrmojo.desc(2164,"Apply"),scriptClass:"mstrmojo.Button",cssClass:"icn apply",bindings:{enabled:"(!this.parent.vldTbL.visible ||!this.parent.vldTbL.validationStatus.code)&& (!this.parent.vldTbH.visible||!this.parent.vldTbH.validationStatus.code)"},onclick:function(){var U=this.parent,X=(U.qua===D.Q._PT||U.qua===D.Q._PB),R;U.cs=[];var V=function(Y){return Y+((X&&!String(Y).match(/^\d+%$/))?"%":"");};var S=function(Y,Z){return((Y===2||Y===3)&&Z===0)?14:5;};if(U.opId===N._IN||U.opId===N._NOT_IN){var W=String(U.cs1).split(";");for(R=0;R<W.length;R++){if(!mstrmojo.string.isEmpty(W[R])){U.cs.push({dtp:5,v:V(W[R])});}}}else{if(U.vldTbL.visible){U.cs.push({dtp:S((U.numFmts&&U.numFmts.cat),U.qua),v:V(U.cs1)});}if(U.vldTbH.visible){U.cs.push({dtp:S((U.numFmts&&U.numFmts.cat),U.qua),v:V(U.cs2)});}}if(U.onchange){U.onchange();}if(U.makeSelection){U.makeSelection();}}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget","mstrmojo.tooltip","mstrmojo.string","mstrmojo.array");var O=0,I=mstrmojo.array,B=mstrmojo.string;function P(){var V=this.textNode,X=this.imgNode;if(this.eg!=null){X.style.display="none";V.innerHTML=this.eg||"";V.style.display="block";this.domNode.style.display=(this.visible&&this.eg.length>0)?"block":"none";}else{V.style.display="none";this.domNode.style.display=this.visible?"block":"none";X.style.display="block";if(this.tooltip){X.setAttribute("ttl",this.tooltip);}var W=this.getFormats();this.retrieveGraphSrc(W.height,W.width);}}var U={6:"poly",7:"rect",100:"circle"};function H(){var e=this.as,a=e&&e.length;if(!a){return ;}var Z=this.id,d=Z+"_map"+O++,X=[],c=-1,Y;for(Y=0;Y<a;Y++){var W=e[Y];W.id=Z;W.aid=Y;W.tooltip=B.multiReplace(W.tooltip||"",{"&#13":"<br />","&#32":" ",'"':"&quot;"});if(!isNaN(W.shape)){W.shape=this.getAreaShapeName(W.shape);}if(!mstrApp.isDossier&&(W.tks||W.tks===""||W.tty===1)){W.extra=' href="#" ';}X[++c]=B.apply(this.areaMarkup,W);}var b='<map id="'+d+'" name="'+d+'">'+X.join("")+"</map>";if(!this.domNode){this.att='usemap="#'+d+'" ';this.map=b;}else{var V=document.createElement("div");V.innerHTML=b;if(this.mapNode){V=V.firstChild;this.mapNode.innerHTML=V.innerHTML;}else{this.imgNode.setAttribute("usemap","#"+d);this.mapNode=this.domNode.appendChild(V.firstChild);}}}var A=mstrmojo.GraphBase=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.GraphBase",cssClassPrefix:"mstrmojo-GraphBase",markupString:'<div id="{@id}" class="{@cssClassPrefix} {@cssClass}" title="{@tooltip}" style="{@domNodeCssText};"><div class="{@cssClassPrefix}-txt"></div><img {@att}src="../images/1ptrans.gif" class="{@cssClassPrefix} {@cssImageClass}" hidefocus="true" />{@map}</div>',att:"",map:"",cAreaIdx:-1,useRichTooltip:true,markupSlots:{imgNode:function J(){return this.domNode.childNodes[1];},mapNode:function F(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function M(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function K(){this.domNode.style.display=(this.visible)?"block":"none";}},preBuildRendering:function C(){H.call(this);return this._super();},postBuildRendering:function Q(){P.call(this);return this._super();},setModel:function L(V){this.model=V;},updatingTooltipHelper:function R(Z,j,d){var W=Z&&Z.getAttribute("aid"),V=Z&&Z.getAttribute("ttl"),Y=Z.getAttribute("SC"),b={refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,contentNodeCssClass:"gp-tooltip"},h=(this.model.getZoomFactor?this.model.getZoomFactor():(this.model.docModel?this.model.docModel.getZoomFactor():1))+"em";if(W==this.cAreaIdx){return ;}this.cAreaIdx=W;b.content=V||this.defaultTooltip;var X="font-size:"+h+";";if(Y){X+="border-color:#"+Y;}b.contentNodeCssText=X;var e=Z.getAttribute("coords"),g=99999,f=99999;if(!d){if(e&&e.length>0){e=e.split(",");var a=0;while(a+1<e.length){g=Math.min(g,parseInt(e[a++],10));f=Math.min(f,parseInt(e[a++],10));}}}if(g===99999){g=j.x;}if(f===99999){f=j.y;}b.top=f;b.left=g;this.richTooltip=null;this.set("richTooltip",b);},redraw:function N(){if(!this.hasRendered){return false;}P.call(this);var V=this.getFormats();if(this.as&&V.height&&V.width){this.refreshMap();}return true;},refreshMap:function G(){if(this.as){H.call(this);}},getAreaShapeName:function D(V){return U[parseInt(V,10)]||"default";}});var S=A.tooltipCLS="mstrmojo-mobileGraph-Tooltip-content",E=A.canvasCLS="mobile-graph-highlight-canvas";A.hideTooltips=function(){I.forEach(document.getElementsByClassName(S),function(V){V.style.display="none";});I.forEach(document.getElementsByClassName(E),function(V){V.getContext("2d").clearRect(0,0,V.width,V.height);V.width=V.width;});};}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash","mstrmojo.string");mstrmojo.requiresDescs(11038,11935,11936,11937,11856,11938,13138,13230,13260,14633,14636);var C=mstrmojo.hash.copy,P=mstrmojo.css,J=mstrmojo.dom,N=mstrmojo.array,E=mstrmojo.string,Q=function Q(W,U){if(!W){return ;}var S=U&&U.length||0,V;for(V=S;V>0;V--){W=W.replace(new Array(V+2).join("#"),U[V-1]);}return W;},L=function L(U){if(!U){return ;}var a=this,W=J.position(U.refNode||a.refNode),Z=J.position(a.domNode),Y=U.position||R.RIGHT,V=0,b=0,S=9+(U.margin!==undefined?U.margin:0),X=" ";switch(Y){case R.TOP:b=-Z.h-S;X+="t";break;case R.BOTTOM:b=W.h+S;X+="b";break;case R.LEFT:V=-Z.w-S;X+="l";break;case R.RIGHT:V=W.w+S;X+="r";break;}mstrmojo.hash.forEach(C(U,{left:V,top:b,contentNodeCssClass:X,visible:false}),function(c,d){this[d]=c;},this);this.set("visible",U.invalid);},A=function A(S){var X=this,V,W=S.errorCode,Y=S.errorMsg,U=S.args,Z=mstrmojo.vi.ui.rw.selectors.EnumWarningMessages;if(S.invalid){V={content:W!==null?(X.generateContentHTML(Q(Z[W],U))||Z["*"]):Y};}return V;};mstrmojo.vi.ui.rw.selectors.EnumWarningMessages=C(mstrmojo.locales.validation,{"*":mstrmojo.desc(11038,"Invalid"),invalidValueVIWarning:mstrmojo.desc(11935,"Invalid characters"),emptyValueVIWarning:mstrmojo.desc(11936,"Please enter a number"),notIntegerVIWarning:mstrmojo.desc(11937,"Please enter an integer"),outOfRangeVIWarning:mstrmojo.desc(11856,"Please enter value between ## and ###."),noMultiSelectionVIWaring:mstrmojo.desc(11938,"This selector does not support multiple selections."),continuousSelectionVIWaring:mstrmojo.desc(13138,"This selector does not support non-continuous selections."),bigDecimalMetricSliderVIWaring:mstrmojo.desc(13230,"Cannot qualify on big decimal value. Please change qualification type to Rank"),unableDisplaySelectionVIWarning:mstrmojo.desc(13260,"Filter cannot display actual selections."),imageSizeExceedLimitVIWarning:mstrmojo.desc(14633,"Cannot embed an image larger than ##MB. Your image is still ###MB after compression. Enter a URL to the image instead."),imageFileTypeNotSupportedVIWarning:mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."),imageOverSizeNoCompessionVIWarning:mstrmojo.desc(14665,"Cannot embed an image larger than ##MB. Enter a URL to the image instead.")});mstrmojo.vi.ui.rw.selectors.EnumWarningPosition={TOP:1,BOTTOM:2,LEFT:3,RIGHT:4};var R=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition;mstrmojo.vi.ui.rw.selectors._HasWarningMessage=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasWarningMessage",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasWarningMessage",warningSlotName:"warning",showWarning:function G(V){var Z=this,b=Z.warningSlotName,d=Z[b],S=V&&V.lasting||6000,Y=V.refNode||this.domNode,U=V.highlight!==false,c=V.closeOnClick===false?false:true,a;if(!d){d=new mstrmojo.Tooltip({refNode:Y,highlight:U,closeOnClick:c,updatePopupConfig:null,cssClass:"vi-warning vi-tooltip-V"});Z.addDisposable(d);Z[b]=d;a=Z.closeOnClick=Z.getCloseOnClickListener();J.attachEvent(document.body,"click",a);}var X=V.position||R.TOP,W="vi-warning vi-tooltip-";switch(X){case R.TOP:d.cssClass=W+"V";break;case R.BOTTOM:d.cssClass=W+"A";break;case R.LEFT:d.cssClass=W+"D";break;case R.RIGHT:d.cssClass=W+"C";break;}d.open(Z,A.call(Z,V));this.adjustPosition(V);if(U){P.toggleClass(d.refNode,"mstrmojo-Warning",true);}window.clearTimeout(Z._warningTimeOut);Z._warningTimeOut=window.setTimeout(function(){Z.hideWarning();},S);},hideWarning:function H(){var U=this,S=U[U.warningSlotName];if(S&&S.visible&&S.close){if(S.highlight){P.toggleClass(S.refNode,"mstrmojo-Warning",false);}S.close();window.clearTimeout(U._warningTimeOut);delete U._warningTimeOut;}},getCloseOnClickListener:function I(){var S=this;return function(){var U=S[S.warningSlotName];if(U.closeOnClick){S.hideWarning();}};},adjustPosition:function M(S){var U=this;L.call(U[U.warningSlotName],S);},generateContentHTML:function D(S){return E.encodeHtmlString(S,true);},bindWarningHandler:function F(){N.forEach(arguments,function S(V){if(!V||!V.attachEventListener){return ;}var W=V._validationEventListener,U;if(W){V.detachEventListener(W);delete V._validationEventListener;}U=this.getValidationEvtListener();if(U){V._validationEventListener=V.attachEventListener("validationChange",this.id,U);}},this);},getValidationEvtListener:function B(){var U=this;return function S(V){var W=V.value;U[(W&&W.invalid?"show":"hide")+"Warning"](W);};},unrender:function K(S){var U=this[this.warningSlotName];if(U){U.unrender();}this._super(S);},destroy:function O(S){J.detachEvent(document.body,"click",this.closeOnClick);return this._super(S);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._ListSelections","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var Q=mstrmojo.dom,C=mstrmojo.css,R=mstrmojo.hash,K=mstrmojo.all,d=mstrmojo._HasMarkup,e="px";var D={},J=false,a;function c(){var n={mousedown:["touchstart","mousedown"],mouseup:["touchend","mouseup"],mousemove:["touchmove","mousemove"]},m;for(m in n){D[m]=J?n[m][0]:n[m][1];}}function k(n){if(this.dragging){return ;}this._moveCnt++;if(this._moveCnt>this.mousemoveBuffer){var m=document.body;Q.detachEvent(m,"mousemove",this._mousemoveCallback);Q.detachEvent(m,"mouseup",this._cancelCallback);this.initDrag(n);}}function g(n){if(this.dragging){return ;}this._moveCnt++;if(this._moveCnt>this.mousemoveBuffer){var m=document.body;Q.detachEvent(m,"touchmove",this._touchmoveCallback);Q.detachEvent(m,"touchend",this._cancelCallback);if(a){window.clearTimeout(a);}this.initDrag(n);}}function H(p){var m=document.body,o=J?"_touchmoveCallback":"_mousemoveCallback";Q.detachEvent(m,D.mousemove,this[o]);Q.detachEvent(m,D.mouseup,this._cancelCallback);if(a){window.clearTimeout(a);}var n=this.afterDragCancel;if(n){n.call(this.target,p);}}function G(s){J=true;c();Q.preventDefault(window,s);if(this.dragging){return true;}var o=this.target.id,p=document.body,n=s&&s.touches&&s.touches[0]||s;if(!this._touchmoveCallback){this._touchmoveCallback=function(t){g.call(K[o].dnd,t&&t.touches&&t.touches[0]||t);return true;};}this._moveCnt=0;this.startE=R.copy(n);Q.attachEvent(p,"touchmove",this._touchmoveCallback);if(!this._cancelCallback){this._cancelCallback=function(t){H.call(K[o].dnd,n);return true;};}Q.attachEvent(p,"touchend",this._cancelCallback);var q=this,m=n;m.type=m.name="contextmenu";a=window.setTimeout(function(){var w=q.target,x=w&&w.docSelector,u=x&&x.parent;Q.detachEvent(p,"touchmove",this._touchmoveCallback);Q.detachEvent(p,"touchend",this._cancelCallback);if(u){u.raiseEvent(d.newDomEvent("contextmenu",window,m));}},1000);return false;}function f(o){J=false;c();Q.preventDefault(window,o);if(this.dragging){return true;}var m=this.target.id,n=document.body;if(!this._mousemoveCallback){this._mousemoveCallback=function(p){k.call(K[m].dnd,p);return true;};}this._moveCnt=0;this.startE=R.copy(o);Q.attachEvent(n,"mousemove",this._mousemoveCallback);if(!this._cancelCallback){this._cancelCallback=function(p){H.call(K[m].dnd,p);return true;};}Q.attachEvent(n,"mouseup",this._cancelCallback);return false;}function E(n){var m=this.duringDrag;if(m){m.call(this.target,n);}return true;}function N(o){this.dragging=false;var m=document.body;Q.detachEvent(m,D.mousemove,this._dragCallback);Q.detachEvent(m,D.mouseup,this._dragEndCallback);var n=this.afterDragEnd;if(n){n.call(this.target,o);}return true;}function W(){if(this._mousemoveCallback){Q.detachEvent(document.body,"mousemove",this._mousemoveCallback);delete this._mousemoveCallback;}if(this._touchmoveCallback){Q.detachEvent(document.body,"touchmove",this._touchmoveCallback);delete this._touchmoveCallback;}if(this._cancelCallback){Q.detachEvent(document.body,"mouseup",this._cancelCallback);Q.detachEvent(document.body,"touchup",this._cancelCallback);delete this._cancelCallback;}if(this._dragCallback){Q.detachEvent(document.body,"mousemove",this._dragCallback);Q.detachEvent(document.body,"touchmove",this._dragCallback);delete this._dragCallback;}if(this._dragEndCallback){Q.detachEvent(document.body,"mouseup",this._dragEndCallback);Q.detachEvent(document.body,"touchmove",this._dragEndCallback);delete this._dragEndCallback;}}mstrmojo.DnDComponent=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DnDComponent",isDragging:false,initD:null,startE:null,afterDragStart:null,duringDrag:null,afterDragEnd:null,target:null,mousemoveBuffer:1,init:function V(m){R.copy(m,this);},initDrag:function j(q){this.dragging=true;var n=this.target.id,p=document.body;var s=this._dragCallback;if(!s){s=this._dragCallback=function(t){if(J){t=t&&t.touches&&t.touches[0]||t;}return E.call(K[n].dnd,t);};}Q.attachEvent(p,D.mousemove,s);var m=this._dragEndCallback;if(!m){m=this._dragEndCallback=function(t){if(J){t=t&&t.touches&&t.touches[0]||t;}return N.call(K[n].dnd,t);};}Q.attachEvent(p,D.mouseup,m);var o=this.afterDragStart;if(o){o.call(this.target,q);}this._dragCallback(q);}});function Z(m){this.getUnit=function n(){var o=m.items.length;return o>1?m._effLen/(o-1):1;};this.calcMinMax=function(q,o){var s=Math.round((q/m.unit+o/m.unit)/2);return{min:s,max:s};};this.preUpdateThumb=function(){m.start=Math.min(m.min*m.unit,m._effLen)+e;m.sdCssText=m.orCfg.posCssP+":"+m.start+";";};this.updateThumb=function(){m.containerNode.style[m.orCfg.posCssP]=m.start=Math.min(Math.round(m.min*m.unit),m._effLen)+e;};return this;}function i(m){this.getUnit=function(){return m._effLen/m.items.length;};this.calcMinMax=function(p,o){return{min:Math.floor(p/m.unit+0.5),max:Math.floor(o/m.unit-0.5)};};function n(){var o=m.min,q=m.unit;var s=m.start=(o*q)+e;var p=m.length=Math.max(Math.round((m.max-o+1)*q-m.gap),0)+e;return{st:s,len:p};}this.preUpdateThumb=function(){var p=m.orCfg,o=n();m.sdCssText=p.posCssP+":"+o.st+";"+p.lenCssP+":"+o.len+";";};this.updateThumb=function(){var p=m.orCfg,o=n(),q=m.containerNode.style;q[p.posCssP]=o.st;q[p.lenCssP]=o.len;};return this;}var F="<span>{@content}</span>";mstrmojo.Slider=mstrmojo.declare(mstrmojo.Container,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.Slider",markupString:'<div id="{@id}" class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}" mstrAttach:mouseout><div class="sd" style="{@sdCssText}"><div class="t1"></div><div class="t2"></div><div class="t3"></div></div></div></div></div>',sdCssText:"",cssClass:"sc",clsType:"sc2",clsOrientation:"sc-v",orCfg:null,typeHelper:null,_tooltip_pos:"TL",useRichTooltip:true,init:function h(m){this._super(m);if(m.isHoriz){this.orCfg={posCssP:"left",marginCssP:"marginLeft",lenCssP:"width",lenP:"clientWidth",opPosCssP:"top",thickP:"clientHeight",offsetP:"x"};this.clsOrientation=" sc-h";this._tooltip_pos=mstrmojo.tooltip.POS_BOTTOMLEFT;}else{this.orCfg={posCssP:"top",marginCssP:"marginTop",lenCssP:"height",lenP:"clientHeight",opPosCssP:"left",thickP:"clientWidth",offsetP:"y"};this._tooltip_pos=mstrmojo.tooltip.POS_TOPRIGHT;this.titleHeight=(m.docSelector.fmts.ttl&&m.docSelector.fmts.ttl.height)?parseInt(m.docSelector.fmts.ttl.height,10):0;}this._exRoom=this.thumbWidth;if(this.multiSelect){this._exRoom*=2;}if(m.multiSelect){this.typeHelper=new i(this);}else{this.clsType="sc1";this.typeHelper=new Z(this);}},markupSlots:{dndNode:function(){return this.domNode.firstChild;},bgNode:function(){return this.domNode.firstChild.firstChild;},sdcNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.lastChild.firstChild;},frontNode:function(){return this.domNode.firstChild.lastChild.firstChild.firstChild;},thumbNode:function(){return this.domNode.firstChild.lastChild.firstChild.childNodes[1];},endNode:function(){return this.domNode.firstChild.lastChild.firstChild.lastChild;},tooltipNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:function(){this.synchronizeSlider();}},start:"50px",length:"30px",min:0,max:0,gap:1,ghost:null,thumbWidth:11,cssBkBW:1,dndNode:null,synchronizeSlider:function I(){var u=this.orCfg,t=u.lenCssP,o=this[t],m=parseInt(o,10),AA=this.hasRendered,y=this.titleHeight||0;var p=this._effLen=isNaN(m)?0:(m-this._exRoom-y);if(o){var z={};z[t]=Math.max(parseInt(o,10)-(2*this.cssBkBW),0)-y+e;var q={};q[t]=p+e;q[u.posCssP]=Math.round(this._exRoom/2)+e;q[u.opPosCssP]="0"+e;if(AA){R.copy(z,this.bgNode.style);R.copy(q,this.sdcNode.style);}else{this.bkCssText=C.getCssTextFromObj(z);this.sdcCssText=C.getCssTextFromObj(q);}}var AC=this.selectedIndices;if(!R.isEmpty(AC)){var x=this.items.length,s=-1,AB=-1,w;for(w=0;w<x;w++){if(AC[w]){if(s<0){s=w;}AB=w;}else{if(s>-1){break;}}}this.min=s;this.max=AB;}var n=this.typeHelper;this.unit=n.getUnit();if(AA){n.updateThumb();}else{n.preUpdateThumb();}},preBuildRendering:function A(){this.synchronizeSlider();},postBuildRendering:function U(){this._super();if(this.items.length>1){var m=this.dnd=new mstrmojo.DnDComponent({target:this});var n=this.id;this.__mouseDownEvt=function(o){Q.stopPropogation(window,o);f.call(K[n].dnd,o);return true;};Q.attachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);if(Q.supportsTouches){this.__touchstartEvt=function(o){Q.stopPropogation(window,o);G.call(K[n].dnd,o);return true;};Q.attachEvent(this.dndNode,"touchstart",this.__touchstartEvt);}m.afterDragStart=this.initDrag;m.duringDrag=this.ondrag;m.afterDragEnd=this.ondrop;m.afterDragCancel=this.cancelDrag;}},initDrag:function j(s,m){m=m||window;var q=this.configureGhost(true),n=this.orCfg,p=this.dnd,o=p.startE;p.initD={tP:parseInt(this.start,10),sL:this._effLen,contL:q.containerNode[n.lenP],offset:Q.getMousePosition(o,m)[n.offsetP],td:Q.eventTarget(m,o)};},configureGhost:function b(n){var p=this.ghost;if(!p){var s=this.containerNode.cloneNode(true),q=s.childNodes;C.addClass(s,"gh");s.style.display="none";p=this.ghost={containerNode:s,frontNode:q[0],thumbNode:q[1],endNode:q[2]};this.sdcNode.appendChild(s);}var o=this.ghost.containerNode.style,m=this.orCfg;R.copyProps([m.posCssP,m.lenCssP],this.containerNode.style,o);if(n){o.display="block";}return p;},ondrag:function O(w,u){u=u||window;var x=this.dnd.initD,q=this.ghost.containerNode,AB,o,m,t=this.min,y=this.max,s=this.orCfg,n=s.lenCssP,AA=s.posCssP;var z=Q.getMousePosition(w,u)[s.offsetP]-x.offset;switch(x.td){case this.thumbNode:AB=Math.max(Math.min(x.tP+z,x.sL-x.contL),0);o=AB+x.contL;q.style[AA]=AB+e;var p=this.typeHelper.calcMinMax(AB,o);t=p.min;y=p.max;break;case this.frontNode:AB=Math.max(Math.min(x.tP+z,x.tP+x.contL),0);m=Math.max(Math.min(x.contL-z,x.tP+x.contL),0);q.style[AA]=AB+e;q.style[n]=m+e;t=Math.min(Math.floor(AB/this.unit+0.5),this.max);break;case this.endNode:m=Math.max(Math.min(x.contL+z,x.sL-x.tP),0);o=x.tP+m;q.style[n]=m+e;y=Math.max(Math.floor(o/this.unit-0.5),this.min);break;default:return ;}if(t!==this.min||y!==this.max){this.min=t;this.max=y;this.typeHelper.updateThumb();}this._updateTooltip();},ondrop:function Y(){this.typeHelper.updateThumb();var q=this.ghost;if(q){q.containerNode.style.display="none";}this.hideTooltip();var s=this.dnd&&this.dnd.initD;if(this.makeSelection&&s){this.makeSelection({selItem:s.td});}var m=this.items;if(m&&m.length){var o=[],n;for(n=this.min;n<=this.max;n++){var p=m[n];if(p){o.push(n);}}this.select(o);}this.dnd.initD=null;},cancelDrag:function M(n,m){if(this.makeSelection){this.makeSelection({selItem:Q.eventTarget(m||window,this.dnd.startE)});}},showTooltip:function l(n,m){this.configureGhost(false);this._updateTooltip(n,m);this._super(n,m);},hideTooltip:function P(n,m){if(this.dnd&&this.dnd.dragging){return ;}this._super(n,m);},_updateTooltip:function S(){var u=this.orCfg,w={contentNodeCssClass:"sc-tooltip",refNode:this.domNode,posType:this._tooltip_pos},n=(this.ghost)?this.ghost.containerNode:this.containerNode;w[u.opPosCssP]=0;w[u.posCssP]=n.style[u.posCssP];w.content="";var s=this.items,p=s.length;if(s&&p){var m=(s[this.min]||s[0]),o=this.getItemTooltip(m),q=o;if(this.min!==this.max){var t=(s[this.max]||s[p-1]);q=mstrmojo.desc(146,"From:")+" '"+o+"' "+mstrmojo.desc(2665,"To:")+" '"+this.getItemTooltip(t)+"'";}w.content=F.replace(/\{@content\}/g,q);}this.set("richTooltip",w);},getItemTooltip:function X(m){var n=m?m.n:"";return"'"+(n.length>20?n.slice(0,20)+"...":n)+"'";},unrender:function B(n){this.ghost=null;this.hideTooltip();this.min=0;this.max=(this.items&&this.items.length-1)||0;var o=this.dndNode,p=this.__mouseDownEvt,m=this.__touchstartEvt;if(p&&o){Q.detachEvent(o,"mousedown",p);}if(m&&o){Q.detachEvent(o,"touchstart",m);}W.call(this);this._super(n);},onselectionChange:function L(){var m=this.selectedIndices,n=R.isEmpty(m);if(m){this.set("max",n?this.items.length-1:R.max(m,false,true));this.set("min",n?0:R.min(m,false,true));if(this.typeHelper){this.typeHelper.updateThumb();}}if(this.onchange){this.onchange();}}});mstrmojo.Slider.SINGLE_HANDLE_WIDTH=11;mstrmojo.Slider.SCROLLHANDLEWIDTH=11;}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.tooltip");var E=mstrmojo.dom,D=mstrmojo.string,F=mstrmojo.hash,H=mstrmojo.array,C=mstrmojo.tooltip;mstrmojo.ui._HasListTooltip=mstrmojo.provide("mstrmojo.ui._HasListTooltip",{_mixinName:"mstrmojo.ui._HasListTooltip",tooltipOrientation:"horizontal",tooltipOffset:8,tooltipMarkup:'<div class="content" style="{@style}">{@c}</div>',tooltipCss:{},tooltipContrast:false,getTooltipText:function A(I){return I&&(D.encodeHtmlString(I.ttp,true)||D.encodeHtmlString(I.n,true))||"";},showTooltip:function G(a,N){var Q=this;if(!Q.hasOpenTooltip&&!(Q._lastOpened&&Q._lastOpened.visible)){var g=E.eventTarget(N,a),b=Q.getItemFromTarget(g),V=Q.getItemNodeFromTarget(g),i=Q.getTooltipText(b),P=Q.tooltipCss;if(!i||b.ttpDisabled){return ;}if(Q.showTooltipForLargeText){if(V.offsetWidth>=V.scrollWidth){return ;}}var h=E.position(V),Z,R,L,X="",Y=Q.tooltipOffset,O=(b&&b.ctxt)||{};if(this.tooltipOrientation==="vertical"){Z=h.x+h.w/2;L=O.posType||C.POS_TOPCENTER;R=h.y+h.h+Y;var M="mojo-theme-light vi-regular vi-tooltip-A";if(!O.posType){M+=" A-center";}Q.tooltipCss=F.copy({cssClass:M},P);}else{var K=E.windowDim(),W=40,c=h.x+h.w+Y,J=h.x-Y,f=J-W,I=K.w-(c+W),d="vi-regular vi-tooltip-",U;R=h.y;if(I>=f){Z=c;U=I;L=O.posType||C.POS_TOPLEFT;P.cssClass=d+"C "+P.rightCssClass;}else{Z=J;U=f;L=O.posType||C.POS_TOPRIGHT;P.cssClass=d+"D "+P.leftCssClass;}X="max-width: "+U+"px;";}if(Q.tooltipContrast){P.cssClass=P.cssClass+" contrast";}if(P&&P.getItemCssClass){P.cssClass=H.filter([P.cssClass,P.getItemCssClass(b)],function(e){return !!e;}).join(" ");}var S=Q.richTooltip=F.copy(Q.tooltipCss,{content:D.apply(Q.tooltipMarkup,{c:i,style:X}),top:R,left:Z,posType:L});if(Q.itemDisabled){S.cssClass+=" vi-warning";}if(O.hoverable){S.enableHover=true;}if(O.posType==="TL"){S.left=h.x;}S.keepArrowXPos=!!Q.keepArrowXPos;S.keepArrowYPos=!!Q.keepArrowYPos;this._super(a,N);}},onclick:function B(I){var J=this;window.setTimeout(function(){if(J.hasOpenTooltip){J.hideTooltip();}window.clearTimeout(J._tooltipTimeOut);},0);this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupWidget","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.css");mstrmojo.ui.menus.MenuPopup=mstrmojo.declare(mstrmojo.ui.PopupWidget,[mstrmojo.ui.menus._IsMenuPopup],{scriptClass:"mstrmojo.ui.menus.MenuPopup",popupConfig:null,init:function B(E){this._super(E);var C=this.popupConfig;if(!C.contents){throw new Error("Cannot open popup without contents.");}var D=["mstrmojo-ui-MenuPopup"],F=C.cssClass;if(F){D.push(F);}if(C.hasToggleItem){D.push("hasToggleItem");}mstrmojo.css.addWidgetCssClass(this,D);this.addChildren(C.contents);},shouldPropagateLockHover:function A(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.css");var B=mstrmojo.css;mstrmojo.ui.ColumnContainer=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnContainer {@cssClass}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},scrollNode:function(){return this.domNode.firstChild;}},markupMethods:{onnextChange:function A(){B.toggleClass(this.domNode,"hasNext",!!this.next);}},active:false,next:null,idx:undefined,updateColumnContainer:function D(){var E=this.next;if(E){E.updateColumnContainer();}},onactiveChange:function C(){B.toggleClass(this.domNode,"active",this.active);var E=this.next;if(E){E.updateColumnContainer();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var D=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,listenOnRootView:false,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" style="z-index: 1100;" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},editorNode:null,btnHbox:null,markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(L){if(L){return ;}var J=this.visible,K=J?"block":"none";this.editorNode.style.display=K;if(this.modal){this.curtainNode.style.display=K;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function F(){var J;var K=this.buttons;if(K&&!this.btnHbox){for(J in K){K[J].cssClass=(K[J].cssClass||"")+(this.noButtonCls?"":" mstrmojo-Editor-button");}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:K},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function B(){var J=this.placeholder;if(this._super()){if(!this.parent&&!J){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function E(){var J=this.id;return function(){var K=mstrmojo.all[J];K.resizeDialog();K.positionDialog();};},addListener2RootView:function(K){var L=document.querySelector("#rootView");var M=L.style.height;var J=L.style.width;this.observer=new MutationObserver(function(N){N.forEach(function(P){var O=L.style.height;var Q=L.style.width;if(P.attributeName==="style"&&(M!==O||J!==Q)){K();M=O;J=Q;}});});this.observer.observe(L,{attributes:true});},postBuildRendering:function A(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var K=this._resizeHandler=this.getResizeHandler();if(this.listenOnRootView){this.addListener2RootView(K);}else{D.attachEvent(window,"resize",K);}}this.resizeDialog();this.positionDialog();try{this.domNode.focus();}catch(J){}return true;},resizeDialog:function G(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function C(){var K=this,O=K.curtainNode,J=document.body,M=document.documentElement,N=O.style,L=K.curtainPosition;N.width=Math.max(J.clientWidth,M.scrollWidth)+"px";if(L&&L.h){N.height=L.h+"px";}else{N.height=Math.max(J.clientHeight,M.scrollHeight)+"px";}if(L&&L.y){N.top=L.y+"px";}K.raiseEvent({name:"resizeCurtain"});},positionDialog:function H(){var K=this.editorNode,M=this.left,L=this.top;if(!M||!L){D.center(K);var J=K.style;if(this.alignment==="top"){J.top="10px";}if(M){J.left=M;}if(L){J.top=L;}}},destroy:function(K){var J=this._resizeHandler;if(J){if(this.listenOnRootView){this.observer&&this.observer.disconnect();}else{D.detachEvent(window,"resize",J);}}this._super(K);}});mstrmojo.toast=function I(O,M,Q,J){var P="mojoToast9",N,L=M||3000;if(J&&J.id){P=J.id+"-"+P;}try{mstrmojo.all[P].destroy();}catch(K){}mstrmojo.insert({id:P,scriptClass:"mstrmojo.Label",cssClass:(J&&J.cssClass)?J.cssClass:"toastCss",text:O}).render();N=mstrmojo.all[P].domNode;if(J&&J.dom){J.dom.appendChild(N);}else{document.body.appendChild(N);D.bottomCenter(N);}window.setTimeout(function(){if(Q){Q();}try{mstrmojo.all[P].destroy();}catch(R){}},L);};mstrmojo.mask={show:function(){var J=mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});J.render();document.body.appendChild(J.domNode);},hide:function(){mstrmojo.mask.win.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.ui.PopupConfig","mstrmojo.css");mstrmojo.ui.editors.ToolbarPopup=mstrmojo.declare(mstrmojo.Box,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.editors.ToolbarPopup",popupConfig:null,anchorElement:null,autoCloses:false,locksHover:true,init:function B(C){this._super(C);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ToolbarPopup");this.popupConfig=new mstrmojo.ui.PopupConfig({isHostedWithin:false,hostProxyCssClass:(mstrApp&&mstrApp.getThemeClassName())||"",anchorElement:this.anchorElement});},open:function A(D,C){D.closePopup();this._super(D,C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout","mstrmojo.css");var B=mstrmojo.css;mstrmojo.vi.ui.editors.EditorGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.editors.EditorGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},showDivider:true,isNested:false,isContainer:false,init:function D(E){this._super(E);B.addWidgetCssClass(this,["mstrmojo-vi-EditorGroup","ctrl-group"]);},preBuildRendering:function A(){var E=[];if(this.showDivider){E.push("divide");}if(this.isContainer){E.push("container");}if(E.length){B.addWidgetCssClass(this,E);}return this._super();},getLayoutOffsets:function C(){return{h:0,w:this.isNested?0:19};}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Button","Box","vi.ui.CalculationWidget","mstr.EnumFunction");mstrmojo.requiresDescs(221,358,1422,2122,6017,5868,5869);var C=mstrmojo.desc,B=mstrmojo.mstr.EnumFunction,I=4,E=5,H=6,F=7;var D={SINGLE:[{n:C(358,"Absolute"),v:B.FunctionAbs}],PAIR:[{n:C(6017,"Add"),v:B.FunctionAdd},{n:C(2122,"Average"),v:B.FunctionAverage},{n:C(5868,"Least"),v:B.FunctionLeast},{n:C(5869,"Greatest"),v:B.FunctionGreatest},{n:"A-B",v:B.FunctionMinus+";0"},{n:"B-A",v:B.FunctionMinus+";1"},{n:"A/B",v:B.FunctionDivide+";0"},{n:"B/A",v:B.FunctionDivide+";1"}],MORE:[{n:C(6017,"Add"),v:B.FunctionAdd},{n:C(2122,"Average"),v:B.FunctionAverage},{n:C(5868,"Least"),v:B.FunctionLeast},{n:C(5869,"Greatest"),v:B.FunctionGreatest}]};mstrmojo.vi.ui.CalculationMenuEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.CalculationMenuEditor",onSubmenuOpen:function G(){var P=this.parent,O=P.de,Q=O&&O.es,J=(Q&&Q.length)||P.cellsNum,L=(J===1)?"SINGLE":((J===2)?"PAIR":"MORE"),N=D[L],K=(O&&O.func)||P.func,M,R;if(L==="PAIR"){if(O){N[I].n=Q[0].n+" - "+Q[1].n;N[E].n=Q[1].n+" - "+Q[0].n;N[H].n=Q[0].n+" / "+Q[1].n;N[F].n=Q[1].n+" / "+Q[0].n;}else{R=this.xtab.selCells;N[I].n=R[0].innerText+" - "+R[1].innerText;N[E].n=R[1].innerText+" - "+R[0].innerText;N[H].n=R[0].innerText+" / "+R[1].innerText;N[F].n=R[1].innerText+" / "+R[0].innerText;}}this.checkList.set("items",N);for(M in N){if(typeof N[M].v==="string"&&N[M].v.indexOf(K)===0&&N[M].v.indexOf(";0")>0){this.checkList.set("selectedItem",N[M]);break;}if(N[M].v===K){this.checkList.set("selectedItem",N[M]);break;}}},applyCalculation:function A(L){var K=this.xtab,J=this.parent;if((J.de&&J.de.func===L)||(typeof L==="string"&&L.indexOf(J.de.func)===0&&L.indexOf(";0")>0)){return ;}if(this.parent.isEdit===true){K.editDECalculation(J.node,L);}else{K.derivedElementCalculation(J.node,L);}this.onSubmenuClosed();},children:[{scriptClass:"mstrmojo.vi.ui.CalculationWidget",alias:"checkList"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.Box","mstrmojo.css");var A=mstrmojo.css;mstrmojo.vi.ui.rw.VisFilterIndicator=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.rw.VisFilterIndicator",cssClass:"VisFilterIndicator",init:function D(F){var G=F.unitContainer.domNode,E=G.style;if(G){if(F.hasOwnProperty("width")===false){F.width=(E&&E.width)||(G.clientWidth+"px");}if(F.hasOwnProperty("left")===false){F.left=G.offsetLeft+"px";}if(F.hasOwnProperty("top")===false){F.top=(G.offsetTop)+"px";}}this._super(F);this.placeholder=G.appendChild(document.createElement("div"));},children:[{scriptClass:"mstrmojo.Label",slot:"containerNode",alias:"lblTitle",text:mstrmojo.desc(15297,"Items selected in configuration mode will not be applied to visualization filter.")}],postBuildRendering:function(){this._super();var F=this.domNode,E=this;F.style.left=this.left;F.style.top=this.top;if(!this.animationListener){var G=this.animationListener=function(H){if(H.animationName==="indicatorout"){A.addClass(F,"hidden");E.destroy();}};A.onAnimationEnd(F,G);}},updateDimension:function C(){if(this.hasRendered&&!this.destroyed&&this.unitContainer){var E=this.unitContainer.domNode;if(E){this.set("width",(E.style.width||(E.clientWidth+"px")));}}},destroy:function B(){if(this.animationListener){this.animationListener=null;}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasOwnAvatar","mstrmojo.css","mstrmojo.dom");var E=mstrmojo.css,D=mstrmojo.dom;function F(K){var L=K.src.node,M=this.children.filter(function(N){return D.contains(N.domNode,L,true,this.domNode);});return M[0];}function J(K){var N=K.tgt,W=this.children,R=D.getMousePosition(N.e,N.hWin),Q,S,V,M,U,P,L=R.y;for(var O=W.length-1;O>=0;O--){V=W[O];Q=D.position(V.domNode);U=Q.h;M=Q.y;P=M+U/2;if(P<L&&(O===W.length-1||L<=M+U)){S=O;break;}else{if((O===0||M<L)&&L<=P){S=O-1;break;}}}return S;}function I(K){return K===-1?"top":"bottom";}mstrmojo.threshold.ThresholdRowPanel=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.threshold.ThresholdRowPanel",dropZone:true,draggable:true,restrictedToAxis:"y",avatarCssClass:"threshold-drag-avatar",getDragData:function H(K){return{row:F.call(this,K)};},createAvatar:function B(M,L){var K=L.src.data.row.domNode.cloneNode(true);K.style.left=D.position(this.domNode).x+"px";return K;},isDragValid:function G(K){var L=K.getCtxtDragData().row;return !(this.children.length===1||!L||L.draggableNode!==K.src.node)||this._super(K);},ondragstart:function(K){this._super(K);this.removeChildren(K.getCtxtDragData().row);},ondragmove:function A(M){var O=M.getCtxtDragData(),N=this.children,L=J.call(this,M);var K=O.lastRowIdx;if(K!==L){if(K!==undefined){E.removeClass(N[Math.max(K,0)].domNode,I(K));}E.addClass(N[Math.max(L,0)].domNode,I(L));O.lastRowIdx=L;}this._super(M);},ondragend:function C(L){var M=L.src.data,K=M.lastRowIdx;if(K!==undefined){E.removeClass(this.children[Math.max(K,0)].domNode,I(K));}this._super(L);this.parent.parent.model.moveThreshold(L.getCtxtDragData().row.idx,K+1);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui.editors._HostsControls","mstrmojo._HasLayout","mstrmojo.css");mstrmojo.ui.editors.controls.ControlGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.editors._HostsControls,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.ControlGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},shouldPropagateEnabled:true,init:function A(B){this._super(B);mstrmojo.css.addWidgetCssClass(this,"ctrl-group");}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ui.editors.controls.ControlGroup,{onenabledChange:mstrmojo.Container.enabledMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo.hash");var A="mstrmojo-TextBoxWithLabel";mstrmojo.TextBoxWithLabel=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextBoxWithLabel",label:"",rightLabel:"",cssDisplay:"inline",type:"text",markupString:'<div class="'+A+' {@cssClass}" style="{@cssText}"><span class="mstrmojo-TextBox-label">{@label}</span><input id="{@id}" class="mstrmojo-TextBox {@inputNodeCssClass}"  style="{@inputNodeCssText}" title="{@tooltip}" type="{@type}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur/><span class="mstrmojo-TextBox-label-right">{@rightLabel}</span></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild.nextSibling;},lblNode:function(){return this.domNode.firstChild;}}});mstrmojo.TextBoxWithLabel.prototype.markupMethods=mstrmojo.hash.copy({oncssClassChange:function(){var B=this.cssClass;this.domNode.className=A+(B?" "+B:"");},onlabelChange:function(){this.lblNode.innerText=this.label||"";}},mstrmojo.hash.copy(mstrmojo.TextBoxWithLabel.prototype.markupMethods));}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.TextBox");var A=mstrmojo.css,C=mstrmojo.dom;mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur></textarea>',maxLength:256,onkeydown:function B(K){var I=this.inputNode,J=this.value,E=this.maxLength,F=(J&&J.length)||0,M=K.e,L=M.keyCode;this.isDeleteKeys=L===8||L===46;this.isArrowKeys=L===37||L===38||L===39||L===40;if(E!==undefined&&E<=F){var G=I.selectionEnd,H=(G!==undefined)?(G-I.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!H){if(C.isIE7||C.isIE8||C.isIE9){I.blur();window.setTimeout(function(){I.focus();},1);}C.preventDefault(window,M);return false;}}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.TextArea,{oncssClassChange:function D(){A.addClass(this.domNode,this.cssClass||"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller");mstrmojo.ui.ScrollableList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableList",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function C(){return this.domNode.firstChild.firstChild;},scrollboxNode:function D(){return this.domNode.firstChild;},scrollNode:function E(){return this.domNode.firstChild;}},postBuildRendering:function B(){if(this.renderOnScroll){if(!this.onScrollEnd){var G=this.id;this.onScrollEnd=function F(){var H=mstrmojo.all[G];H.doScroll();H.updateScrollbars();};}}if(this._super){this._super();}},renderBlockSize:150,renderIndex:0,onScrollEnd:undefined,doScroll:function A(){if(this.renderOnScroll){var G,H=this.scrollNode,F=(this.renderIndex+1)*this.renderBlockSize;if(F>=this.items.length){return ;}if(mstrmojo.dom.position(H).h===H.scrollHeight){G=this.domNode;}else{G=H;}if((mstrmojo.dom.position(G).h+G.scrollTop)>=G.scrollHeight){this.renderIndex++;var I=this._buildItemsMarkup(this.renderIndex*this.renderBlockSize,((this.renderIndex+1)*this.renderBlockSize)-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");G.innerHTML+=I;this.itemsContainerNode.innerHTML+=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller","mstrmojo.css");var G=mstrmojo.css;var D;mstrmojo.ui.CheckList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.CheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{scrollboxNode:function A(){return this.domNode.firstChild;},itemsContainerNode:function J(){return this.domNode.firstChild.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onorientationChange:function M(){G.toggleClass(this.domNode,"horizontal",this.orientation!=="v");},onmultiSelectChange:function K(){G.toggleClass(this.domNode,"radio",!this.multiSelect);},onenabledChange:function I(){G.toggleClass(this.domNode,"disabled",!this.enabled);},onhideCheckMarkChange:function B(){G.toggleClass(this.domNode,"hideCheckMark",this.hideCheckMark);}},multiSelect:true,hideCheckMark:false,orientation:"v",minimumSelectCnt:0,icnCss:"icn",items:null,getItemMarkup:function L(N){if(!D){D=this._super(N).replace(">{@en@n}<",'title="{@tt}"><span class="text">{@en@n}</span><');}return D;},getItemProps:function H(Q,O){var P=this._super(Q,O),N={"\r\n":" ","\n":" ","\r":" "};var R=Q.css;if(R){P.addCls(R);}P.tt=Q.tt||"";Q.n=mstrmojo.string.multiReplace(Q.n,N);P.n=Q.n||"";return P;},setupScrollNodes:function E(){this.scrollNode=this.scrollboxNode;},preselectionChange:function C(O){var P=this.minimumSelectCnt,N=this.getSelectedItems().length,Q=O.removed;if(Q&&P){if(N<P){this.select(Q,true);return false;}}G.toggleClass(this.itemsContainerNode,"disableSelected",N<=P);return true;},buildRendering:function F(){this._super();G.toggleClass(this.itemsContainerNode,"disableSelected",this.getSelectedItems().length<=this.minimumSelectCnt);}});mstrmojo.ui.CheckList.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var C=function(S,V,U){var R=S.parent.opener,J=R&&R.showDesc,Q=R&&R.showPath,I=V[S.itemField];var P=mstrmojo.string.escape4HTMLText,W="";if(Q){var M=V.anc&&V.anc.items,O=M&&M.length;if(O>0){for(var L=0;L<O-1;L++){W+=M[L].n+" > ";}W+=P(M[O-1].n);}else{if(V.path){W+=P(V.path);}}}if(!U){W+=(W.length===0?"":" > ")+P(I);}if(J){var N=V[S.itemDescField],K=120;if(N){W+="\r\n\r\n<br>"+P(N.substring(0,K)+(N.length>K?"...":""));}}return W;};var A=function(I,J,K){I.path=null;if(!J||!K||K.path){if(K&&K.path){I.set("path",K.path);}return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var L=J.path||J.getAttribute("path");if(L){I.set("path",K.path);return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(M){var N=H(M.toString())||"";K.path=N;I.set("path",N);}},{taskId:"getObjectDetails",objectID:K.did,objectType:K.t},undefined);},200);};var H=function(K){var N;if(window.DOMParser){N=(new DOMParser()).parseFromString(K,"text/xml");}else{N=new ActiveXObject("Microsoft.XMLDOM");N.async="false";N.loadXML(K);}var P=N.getElementsByTagName("path")[0],L=P.childNodes,O="";if(L){for(var J=0,I=L.length;J<I;J++){var M=L[J].childNodes&&L[J].childNodes[0];if(M){O+=mstrmojo.string.escape4HTMLText(M.nodeValue)+(J<I-1?"> ":"");}}}return O;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",useRichTooltip:false,itemDescField:"desc",getItemMarkup:function(K,I){var J=this.parent.opener,L=this.useRichTooltip?"":this.buildTooltip(K);return'<div class="mstrmojo-suggest-text '+((J&&J.item2textCss(K))||"")+'" idx="'+I+'" title="'+L+'">'+J.getHighlightedText(J.getSearchPattern(),mstrmojo.string.escape4HTMLText(K[this.itemField]))+"</div>";},getItemProps:function E(){return{};},onmouseover:function(J){var M=this.parent.opener;if(M&&M.showPath){var K=mstrmojo.dom.eventTarget(J.hWin,J.e),I=K.getAttribute("idx"),L=I!=null?this.items[I]:null;if(L&&L.t>-1){this.targetEl=K;this.targetItem=L;this.requestPath(K,L);}}},requestPath:function D(I,K){var J=this.parent.opener;if(K.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function&&J.showFunctionSyntaxAsPath){this.buildFunctionSyntax(K);}else{A(this,I,K);}},buildFunctionSyntax:function G(J){var K=J.path;if(!K&&J.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){var I=function I(P){if(P.did<0){return P.n;}var O=P.pars,M=[],N,L;M.push(P.n);if(O){M.push("(");for(N=0,L=O.length;N<L;N++){M.push(O[N].n);if(N!==(L-1)){M.push(", ");}}M.push(")");}return M.join("");};J.path=I(J);}this.set("path",{path:J.path,excludeSelf:true});},buildTooltip:function B(I,J){return C(this,I,J);},onpathChange:function F(){var I=this.targetEl;I.path=1;var J=this.buildTooltip(this.targetItem,this.path.excludeSelf);if(this.useRichTooltip){this.useRichTooltip=true;this.hasOpenTooltip=false;if(!I.ttp){I.ttp=J;this.showTooltip();}}else{I.title=J;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._ListSelections");mstrmojo.ListBoxHoriz=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBoxHoriz",cssClass:"mstrmojo-ListBoxHoriz",tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"",cellCssText:"",cellSpacing:0,cellPadding:0,_markupPrefix:function(){var A=this.itemRenderer;return(A&&A.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="'+this.cellSpacing+'" cellpadding="'+this.cellPadding+'"><tbody><tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'">');},_markupSuffix:function(){var A=this.itemRenderer;return(A&&A.markupSuffix)||"</tr></tbody></table>";},_itemPrefix:function(){var A=this.itemRenderer;return(A&&A.itemPrefix)||('<td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var A=this.itemRenderer;return(A&&A.itemSuffix)||"</td>";},_getItemNode:function(A){if(A<0){return null;}var B=this.itemsNode,C=B&&B.rows[0];return C&&C.cells[A].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBoxBase","mstrmojo._HasScrollbox");mstrmojo.ListBox=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._HasScrollbox],{scriptClass:"mstrmojo.ListBox",renderAllItems:false,renderPause:10,numPagesRendered:0,pageStatus:null,_rc:null,_totalPages:null,_rh:null,_rhMin:8,_rowsPerPage:null,_defaultRowsPerPage:100,_minRowsPerPage:100,_pageHeight:null,buildRendering:function K(){if(this.renderAllItems===true){this._super();return true;}this._initPageSettings();var L=this.items;this.items=this._rc?this.items.slice(0,Math.min(this._rowsPerPage,this._rc)):[];this._super();this.items=L;this.postRenderPage(0,true);if(this._rc>this._rowsPerPage){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]=(this._rh*this._rc)+"px";if(!this.connectedScrollbox){this.connectScrollbox(this);this.connectedScrollbox=true;}}else{this.postRenderingCleanup();}},_initPageSettings:function E(){var L=this.items;this._rc=(L&&L.length)||0;var N=this.itemRenderer;this._rh=(N&&N.rowHeight)||this._rhMin||3;var M=this._defaultRowsPerPage;if(!isNaN(this.scrollboxHeight)){M=Math.ceil(this.scrollboxHeight/this._rh);M=Math.max(M,this._minRowsPerPage);}this._rowsPerPage=M;this._totalPages=Math.ceil(this._rc/this._rowsPerPage);this._pageHeight=this._rh*this._rowsPerPage;this._pageStatus=new Array(this._totalPages);this._numPagesRendered=0;},onscroll:function J(){if(!this._renderingRows){this._startPageRenderThread();}},_startPageRenderThread:function F(){this.renderingRows=true;var M=this,L=this._renderTimer=self.setInterval(function(){if(!M){self.clearInterval(L);return ;}var N=M.getPagesToRender();if(N.length>0){M.renderPages(N);}else{M.renderingRows=false;self.clearInterval(M._renderTimer);delete M._renderTimer;if(M.isRenderingComplete()){M.postRenderingCleanup();}M=null;}},this.renderPause);},getPagesToRender:function I(){var P=[],a=this._pageHeight,c=null,X=this._pageStatus,Z=this;function R(d){var e=X[d];if(e&&e.filled){if(!e.height){if(!c){c=Z.itemsNode.tBodies;}e.height=c[d].offsetHeight;}return e.height;}else{return a;}}var b=0,S=null,O=null,M=this.scrollboxTop;for(var W=0,Y=this._totalPages;W<Y;W++){b+=R(W);if(b>=M){S=W;break;}}if(S==null){S=O=Y-1;}else{var L=this.scrollboxBottom;for(var U=S+1;U<Y;U++){if(b>=L){O=U-1;break;}b+=R(U);}}if(O==null){O=Y-1;}for(var N=this._numPagesRendered;N<S;++N){P.push({idx:N,fill:false});}for(var Q=S;Q<=O;++Q){var V=X[Q];if(!V||!V.filled){P.push({idx:Q,fill:true});}}return P;},renderPages:function D(M){for(var N=0,L=M.length;N<L;++N){this.renderPage(M[N].idx,M[N].fill);}},renderPage:function B(R,M){var W=this._pageStatus,P=(this._numPagesRendered>=R+1);if(P){if(!M||(W[R]&&W[R].filled)){return ;}}var V=this._rowsPerPage,L=R*V,N=Math.min(L+V,this._rc)-1;var U=this.tempTableCont;if(!U){U=this.tempTableCont=this.domNode.ownerDocument.createElement("div");}var Q=M?this._buildItemsMarkup(L,N,'<table><tbody idx="'+R+'">',"</tbody></table>",this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join(""):'<table><tbody idx="'+R+'"><tr><td style="height:'+this._pageHeight+'px">&nbsp;</td></tr></tbody></table>';U.innerHTML=Q;var O=U.firstChild.tBodies[0],S=this.itemsNode;if(!P){S.appendChild(O);}else{S.replaceChild(O,S.tBodies[R]);}this.postRenderPage(R,M);},postRenderPage:function G(M,O){if(M+1>this._numPagesRendered){this._numPagesRendered=M+1;}var L=this._pageStatus,N=L[M];if(!N){N=L[M]={};}if(O){N.filled=true;}if(M>0&&M==this._totalPages-1){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]="";}},isRenderingComplete:function C(){if(this._numPagesRendered==this._totalPages){for(var L=this._pageStatus,M=this._totalPages-1;M>-1;M--){if(!L[M]||!L[M].filled){return false;}}return true;}return false;},postRenderingCleanup:function A(){if(this.connectedScrollbox){this.disconnectScrollbox(this);this.connectedScrollbox=false;}},unrender:function(L){this.postRenderingCleanup();this._super(L);},refresh:function H(){if(!this.hasRendered){return ;}var N=this.domNode,L=N&&N.parentNode;if(!this.parent&&L){var M=N.ownerDocument.createElement("span");L.insertBefore(M,N);}this.unrender();if(!this.parent&&L){this.domNode=M;}this.render();if(this.defn&&this.defn.set){this.defn.set("readyState",mstrmojo.EnumReadystate.IDLE);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.ui.ButtonBar");var C={JUSTIFY:6,LEFT:0,RIGHT:1,CENTER:2};mstrmojo.vi.ui.TextAlignButtonBar=mstrmojo.declare(mstrmojo.ui.ButtonBar,null,{scriptClass:"mstrmojo.vi.ui.TextAlignButtonBar",includeJustify:true,init:function B(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"txtAlign");var E=this.itemsValueMap,D=this.items;if(!this.includeJustify){D=D.filter(function(G){return G.id!=="justify";});}this.items=D.map(function(H){var G=mstrmojo.hash.copy(H);G.v=E[G.id];return G;});},onValueChange:mstrmojo.emptyFn,itemsValueMap:{left:0,center:2,right:1,justify:6},items:[{n:mstrmojo.desc(3049,"Left"),id:"left"},{n:mstrmojo.desc(2193,"Center"),id:"center"},{n:mstrmojo.desc(2166,"Right"),id:"right"},{n:mstrmojo.desc(2068,"Justify"),id:"justify"}],getItemProps:function A(F,D){var E=this._super(F,D);E.addCls(F.id);return E;},postselectionChange:function(D){var E=this.items,F=E[D.added[0]],G=E[D.removed&&D.removed[0]];this.onValueChange(F.v,G&&G.v);}});mstrmojo.vi.ui.TextAlignButtonBar.TEXT_ALIGN=C;}());(function(){mstrmojo.requiresCls("mstrmojo.ListSelector","mstrmojo.List","mstrmojo.string");mstrmojo.OBList=mstrmojo.declare(mstrmojo.List,null,{scriptClass:"mstrmojo.OBList",cssClass:"mstrmojo-OBList",itemClass:"mstrmojo-OBListItem",iconClass:"mstrmojo-OBListItemIcon",textClass:"mstrmojo-OBListItemText",iconCssPrefx:"mstrmojo-OBIcon_",itemMarkupFunction:function(C,A,B){return'<div class="'+B.itemClass+(C[B.itemType]?" t_"+C[B.itemType]:"")+(C[B.itemSubType]?" st_"+C[B.itemSubType]:"")+(C[this.itemISC]?" isc":"")+(C[B.itemViewMedia]?" vm_"+C[B.itemViewMedia]:"")+'"><table cellspacing="0" cellpadding="0"><tbody><tr><td>'+B.getIcon(C)+'</td><td><div class="'+B.textClass+'" title="'+B.getTooltip(C)+'">'+mstrmojo.string.htmlAngles(C.n)+"</div></td></tr></tbody></table></div>";},getIcon:function(F){var E=F[this.itemType],D=F[this.itemSubType],B=" t"+E,C=(parseInt(E,10)===1||parseInt(E,10)===3||parseInt(D,10)===14082)?" st"+D:"",G=F[this.itemISC]?'class="mstrmojo-ListIcon isc"':"",A=(F[this.itemViewMedia]===2048||F[this.itemViewMedia]===8192)?" hvi":"";return'<span class="mstrmojo-ListIcon '+B+C+A+'"><span '+G+"></span></span>";},getTooltip:function(C){var D="",F=C.anc&&C.anc.items,A=F&&F.length,B;if(A>0){for(B=0;B<A-1;B++){D+=F[B].n+" > ";}D+=F[A-1].n;}var E=C.desc,G=128;if(E){D+="\r\n\r\n"+mstrmojo.string.encodeHtmlString(E.substring(0,G))+(E.length>G?"...":"");}return D;},listSelector:mstrmojo.ListSelector,selectionPolicy:"reselect",itemType:"t",itemSubType:"st",itemISC:"isc",itemViewMedia:"dvm",useDblSelect:false});}());(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo._IsDial");mstrmojo.Dial=mstrmojo.declare(mstrmojo.List,[mstrmojo._IsDial],{scriptClass:"mstrmojo.Dial",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){mstrmojo.css.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);},hideIfEmpty:function(){this.onadd();}},hideIfEmpty:false,onadd:function(A){if(this._super){this._super(A);}if(this.hideIfEmpty){if(this.domNode){this.domNode.style.display=(!this.items||this.items.length==0)?"none":"block";}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListHoriz","mstrmojo.fx");mstrmojo.FishEye=mstrmojo.declare(mstrmojo.ListHoriz,null,{scriptClass:"mstrmojo.FishEye",width:16,size:10,step:16,speed:2,cssClass:"mstrmojo-FishEye",cssClassItem:"mstrmojo-dot",itemMarkupFunction:function(B,A,C){return'<div class="mstrmojo-fisheye-item '+C.cssClassItem+'" title="'+B.n+'" idx="'+A+'" did="'+B.did+'">&nbsp;</div>';},onchange:function(){this.scroll2();this.parent.set("selectedIndex",this.selectedIndex);},as:new mstrmojo.fx.AnimateProp(),onitemsChange:function(){if(this._super){this._super();}this.last=this.items.length-1;this.first=Math.max(0,this.last-this.size);if(this.items.length>this.size){this.scroll("left",this.width);}},scroll2:function(){var A=this.selectedIndex-this.last;if(this.selectedIndex==this.first&&this.first>0){this.scroll("right",this.width);}else{if(this.selectedIndex==this.last&&this.last<this.items.length-1){this.scroll("left",this.width);}else{if(this.selectedIndex>this.last){A=this.selectedIndex-this.last;this.scroll("left",this.width*A,A);this.last=Math.min(this.items.length-1,this.last+A);}else{if(this.selectedIndex<this.first){A=this.first-this.selectedIndex;this.scroll("right",this.width*A,A);this.first=Math.max(0,this.first-A);}}}}},scroll:function(C,F,E){var B=this.itemsContainerNode,I=B&&B.style;var D=this.as,H=parseInt(mstrmojo.css.getStyleValue(B,{left:"right",right:"left"}[C]),10),H=isNaN(H)?0:H,A=parseInt(I.left,10)||0,G=A+(C=="left"?-1:1)*(F||(Math.min(this.step,(-1)*H)));D.target=B;D.props={left:{start:A,stop:G,duration:100,interval:10,suffix:"px"}};D.play();E=E===undefined?1:E;this.first+=(C=="left"?1:-1)*E;this.last=this.first+this.size-1;this.parent.set("scrollable",this.last<this.items.length-1);this.parent.set("rightScrollable",this.first>0);return G;},srcId:null,postBuildRendering:function(){if(this._super){this._super();}this.hasRendered=!!this.domNode;var E=this.itemsContainerNode,A=E&&E.firstChild,B=A&&A.rows&&A.rows[0],D=B&&B.cells&&B.cells[0];this.first=0;this.last=this.size-1;var C=this.srcId;if(C&&mstrmojo.all[C]&&mstrmojo.all[C].attachEventListener){mstrmojo.all[C].attachEventListener("change",this.id,function(F){if(this.items[this.items.length-1]!=F.src.selectedItem){this.items.add([mstrmojo.hash.copy(F.src.selectedItem)]);this.set("selectedIndex",this.items.length-1);}if(this.items.length>this.size){this.set("rightScrollable",this.items.length>this.size);this.scroll("left",this.width*(this.selectedIndex-this.last),(this.selectedIndex-this.last));}});}this.itemsContainerNode.style.left=Math.min(0,(this.size-this.items.length+1))*this.width+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.ToolbarEditor","mstrmojo.hash");mstrmojo.ui.menus.ToolbarEditorConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.ToolbarEditorConfig",cssClass:"",contents:null,init:function C(D){this._super(D);this.initBindings();},clear:function A(){this._super();this.contents=null;},newInstance:function B(D){return new mstrmojo.ui.menus.ToolbarEditor(mstrmojo.hash.copy({popupConfig:this},D));}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TargetSelector");mstrmojo.vi.ui.LinkTargetSelector=mstrmojo.declare(mstrmojo.vi.ui.TargetSelector,null,{scriptClass:"mstrmojo.vi.ui.LinkTargetSelector",preChangeTargetSelectionMode:function A(D,C){},enterTargetSelectionMode:function B(C){C.setMaskClass(this.srcId);C.set("enabled",C instanceof mstrmojo.vi.ui.rw.VizBox);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.func","mstrmojo.vi.controllers.UICmdMgr");var X=mstrmojo.func,S=mstrmojo.hash,P=mstrmojo.array,M=mstrmojo.vi.controllers.UICmdMgr.STATES,J={SHARED:0,SEPARATE:1},N={AND:19,OR:20},d=function d(h,g){var e={},f=function(k,j){var i=[];if(!j){return k;}P.forEach((j||[]),function(l){i.push(l);});P.forEach((k||[]),function(m){var l=P.find(j,"id",m.id);if(!~l){i.push(m);}});return i;};S.forEach(g,function(i,j){e[j]=i;});S.forEach(h,function(i,j){e[j]=f(i,g[j]);});return e;},D=function D(e){var f=[];S.forEach(e,function(g){f.push({ft:N.AND,d:g});});return f;},K=function(f){var e={},g=function(h){var i=S.keyarray(h)[0];return{id:i,d:h[i][0]};};S.forEach(f,function(k){var j={},h=g(k),i=j[h.id];if(h.id){if(!i){j[h.id]=i=[];}i.push(h.d);}e=d(e,j);},this);return[{ft:N.OR,d:e}];},C=function C(i,n){var j=this.model,m,f=[],g=mstrmojo.vi.ui.rw.SelectionType,k=true,h=false,l=false,e=this;if(!n){n=this.getSelectionType();}if(!S.isEmpty(i)){if(n===g.METRICS){m=D.call(this,i);}else{m=K.call(this,i);}}S.forEach(m,function(o){k=false;var p=[];S.forEach(o.d,function(q,x){if(e.isSupportViewFilterForSelection(x)){h=true;var s=[],u={id:x,elems:s,fm:q[0].fm,v:P.map(q,function(w){return w.n;}).reverse()},t=j.getObjectInfo(x);if(t){u.t=t.t;u.st=t.st;if(e.isVIXtab&&n===g.ATTS&&e.model.isRecursiveAttribute(t.did)){l=true;}if(t.st===12033){u.attId=t.attId;}}P.forEach((q||[]),function(w){s.push(w.id);});p.push(u);}});if(p.length){f.push({ft:o.ft,d:p});}});f.hasElements=h;f.clearSelections=k;f.isRecursiveAttribute=l;return f;},F=function F(g){var e=this.getContextMenuSelectionType(),f=[];f=C.call(this,g,e);return f;},a=function a(l,n,f){var k=this.selectorControl,h,g,m,j=this,i,e;if(k){if(l.clearSelections||l.hasElements){h=this.controller;if(n){g=h.model;e=k.navPage;i=g.getLayoutKeyByUnitKey(e);this.clearSelections();this.setSelectionCache();}k.exp=null;if(h.onGridSelector){m=function(){h.onGridSelector(j,{type:mstrmojo.EnumRWUnitType.GRID,ck:k.ck,tks:k.tks,cgb:S.valarray(k.cgb),ctlKey:k.ckey,sliceId:this.sid,isBranch:f,isUConDS:k.isUConDS,isNavigation:n,layoutKey:i,panelKey:e,ct:k.ct,selections:l});};if(this.multiUnitCtrlInterval){window.clearInterval(this.multiUnitCtrlInterval);this.multiUnitCtrlInterval=null;}if(h.cmdMgr.state===M.BUSY){this.multiUnitCtrlInterval=window.setInterval(function(){if(h.cmdMgr.state!==M.BUSY){window.clearInterval(j.multiUnitCtrlInterval);if(!j.destroyed){j.multiUnitCtrlInterval=null;m();}}},1000);}else{m();}}}}},B=function B(g){var e={type:mstrmojo.vi.ui.rw.SelectionType.ATTS,data:g},f=function(h,i){if(parseInt(h.fn,10)===22&&parseInt(i,10)===19){e.type=mstrmojo.vi.ui.rw.SelectionType.METRICS;}P.forEach((h.nds||[]),function(j){f(j,h.fn);});};f(g,null);return e;},b=function b(){return this.parent.model.getCurrentLayoutDef().cgbMap;},O=function O(){var e=b.call(this),f=[];S.forEach(e,function(h,g){if(this.k===h){f.push(g);}},this);return f;},c=function c(){var e=this.controller&&this.controller.cmdMgr;if(e&&e.isUndoRedo()){return true;}return false;};mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",selectorControl:null,multiUnitCtrlInterval:null,postBuildRendering:function Y(){if(this._super){this._super();}var e=mstrApp.isInVFConfigMode||this.isCustomSort?null:this.findSelectorControl();if(c.call(this)){this.clearSelections();}if(e&&!e.isNavigation&&!S.isEmpty(e.exp)&&this.addSelectionsFromExpression){this.addSelectionsFromExpression(B(e.exp));if(this.highlight){this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}},getSelectorDataFromExpression:B,getSelectionDataTree:C,getContextMenuSelectionDataTree:F,deleteSelectorControl:function E(){if(this._super){return this._super();}this.throwAbstractMethodError("deleteSelectorControl");},findSelectorControl:function W(){if(this._super){return this._super();}this.throwAbstractMethodError("findSelectorControl");},handlesMultiSelection:function H(e){return(this._super&&this._super(e))||!!this.selectorControl;},isSupportViewFilterForSelection:function I(f){var e=this.model;return e.supportsViewFilterActions(f);},isLinkedFilter:function(){var e=this.findSelectorControl&&this.findSelectorControl();return e&&e.isNavigation;},isLinkedFilterEnabled:function(){return this.isLinkedFilter()&&this.getContextMenuSelectionHash&&!S.isEmpty(this.getContextMenuSelectionHash());},handleContextMenuSelectionData:function G(f,e){this.isNavigation=f;this.isBranch=e;this.onContextMenuSelectionChange(this.getContextMenuSelectionHash&&this.getContextMenuSelectionHash());},onSelectionChange:function Q(f){var i=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),h=false,g=this.isNavigation;if(g){delete this.isNavigation;}if(this._super){h=this._super(f);}if(!g&&this.isLinkedFilter()){return true;}if(i.length>0){this.singleUnitSelect();h=true;}else{if(!!this.selectorControl&&!this.isCustomSort){var e=C.call(this,f);a.call(this,e,g,e.isRecursiveAttribute);return true;}}return h;},onContextMenuSelectionChange:function L(g){var j=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),i=false,h=this.isNavigation,e=this.isBranch;if(h){delete this.isNavigation;}if(e){delete this.isBranch;}if(this._super){i=this._super(g);}if(!h&&this.isLinkedFilter()){return true;}if(j.length>0){this.singleUnitSelect();i=true;}else{if(!!this.selectorControl){var f=F.call(this,g);a.call(this,f,h,e);return true;}}return i;},singleUnitSelect:function A(){if(this._super){this._super();}},clearAllSelections:function V(){return this.selectorControl&&this.selectorControl.showall;},onClearBrushing:function Z(e){if(this.selectorControl){return true;}if(this._super){return this._super(e);}return false;},getFilterType:function R(){return this.defn.ins||J.SHARED;},switchFilterType:function U(q){var l=this,p,m=l.getFilterType(),j=l.parent.model,i,h={actions:[]},s,g=b.call(l),e,k=false,n,w,o,u,f;if(m!==q){p=O.call(l);n=j.getCurrentLayoutDef().units;if(p.length&&m===J.SHARED){s=P.filterOne(p,function(x){w=n[x];if(w){o=w.scs||[];return true;}i=j.getSourceControls(l.parent,x);o=i;return i.length;});if(!i||!i.length){i=j.getSourceControls(l.parent,s);i=P.filter(i,function(x){u=x.control.key;return !P.find(o,"ckey",u);});o=o.concat(i);}P.forEach(o,function(x,y){if(y!==0){e=j.getNextKey();g[e]=l.k;h.actions.push(j.redoFilterAssociations(true,x.ckey||x.control.ckey,x.pnk||x.sourceKey,l.k,s,e));k=true;}}.bind(l));}else{f="";P.forEach(p,function(x){w=n[x];if(!w){i=j.getSourceControls(l.parent,x);w=i.length&&i[0];if(!w){return true;}w.pnk=w.sourceKey;w.ckey=w.control.ckey;}if(!f){f=x;}else{delete g[x];o=(w.scs&&w.scs[0])||w;h.actions.push(j.redoFilterAssociations(false,o.ckey,o.pnk,l.k,x,f));k=true;}}.bind(l));}h.actions.push(j.getUnitFormatAction(l,1,{FormattingSelector:{IndependentNodeSelector:q}},true));var t=false;h.callback=({success:function(){l.defn.ins=t?m:q;t=!t;}});if(k){h.callback=X.wrapMethods(h.callback,j.getRebuildCallback());}}h.extras={style:{params:{treesToRender:3}}};return h;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dnd","mstrmojo.ui._HasScroller","mstrmojo.DI.DIConstants");var f=mstrmojo.DI.DIConstants;function a(h){var j=document.createElement("div"),i=j.style,g=h.domNode;j.className="mstrmojo-DataGrid-avatar";i.height=g.clientHeight+"px";g.appendChild(j);h.avatar=j;return j;}function Q(g){var h=mstrmojo.dom.position(g.domNode,true);return h.x;}function O(g){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+g+'"></div>';}function c(i){var h=i.getAttribute("rh"),g=h&&parseInt(h,10);return g;}function Z(h,k,g){var j=g.src,l=j&&j.data,i=l&&l.resizingIdx;if(!(i&&i>0)){return k&&k.apply(h,[g]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function G(j,i){var g=j.colSizeArray;var h=[-g[i-1]+j.minColWidth,(i==g.length-1)?g[i]-j.resizeHandleWidth-j.minColWidth:g[i]-j.minColWidth];return h;},updateSize:function F(j,i,h){var g=j.colSizeArray;g[i-1]=g[i-1]+h;g[i]=g[i]-h;},updateColumnWidth:function U(j,h,k,i){var g=j.colSizeArray;h[i-1].style.width=g[i-1]+"px";k[i-1].style.width=g[i-1]+"px";h[i].style.width=g[i]+"px";k[i].style.width=g[i]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function G(m,l){var n=m.minColWidth+m.resizeHandleWidth,g=m.colSizeArray,j=0;for(var k=l;k<g.length;++k){j+=g[k]-n;}var h=[-g[l-1]+n,j];return h;},updateSize:function F(k,o,h){var n=k.minColWidth+k.resizeHandleWidth,l=k.colSizeArray;l[o-1]=l[o-1]+h;var g=[];for(var j=0;j<l.length-o;++j){g[j]=o+j;}g.sort(function(i,q){return l[i]-l[q];});for(var j=0;j<g.length;++j){var p=h/(g.length-j);var m=l[g[j]];h-=(m>=p+n)?p:m-n;l[g[j]]=(m>=p+n)?m-p:n;}},updateColumnWidth:function U(l,h,m,k){var g=l.colSizeArray;for(var j=k-1;j<g.length;++j){h[j].style.width=g[j]+"px";m[j].style.width=g[j]+"px";}}};mstrmojo.RESIZE_CURRENT_COLUMN_MODE={getRange:function G(m,l){var n=m.minColWidth+m.resizeHandleWidth,g=m.colSizeArray,j=0;for(var k=l;k<g.length;++k){j+=g[k]-n;}var h=[-g[l-1]+n,j];return h;},updateSize:function F(j,i,h){var g=j.colSizeArray;g[i-1]=g[i-1]+h;},updateColumnWidth:function U(j,h,k,i){var g=j.colSizeArray;h[i-1].style.width=g[i-1]+"px";k[i-1].style.width=g[i-1]+"px";j.widgetResized();}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,createColSizeArray:function d(){var h,m,k,j,l,g;m=this.headerContainerNode;k=m&&m.getElementsByTagName("table")[0];j=k.rows[0].cells;h=[];for(l=0,g=j.length;l<g;l++){h.push(j[l].offsetWidth);}return h;},postBuildRendering:function W(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function E(g){var i=g.src,j=i.node,h=c(j);if(h&&h>0){return{resizingIdx:h,startingX:i.pos.x,baseX:Q(this)};}if(this._super){return this.dropZone&&this._super(g);}return null;},allowDrop:function K(g){var i=g.src,j=i&&i.data,h=j&&j.resizingIdx;if(h&&h>0){return true;}return this.dropZone;},ondragenter:function R(g){Z(this,this._super,g);},ondragover:function S(g){Z(this,this._super,g);},ondragleave:function B(g){Z(this,this._super,g);},ondrop:function X(g){Z(this,this._super,g);},isDragValid:function C(g){var i=g.src,j=i&&i.data,h=j&&j.resizingIdx;if(h&&h>0){return true;}if(this._super){return this._super(g);}return false;},ondragstart:function Y(g){var j=g.src,k=j&&j.data,i=k&&k.resizingIdx;if(i&&i>0){var h=this.avatar||a(this);this.ownAvatar=true;h.style.left=(k.startingX-k.baseX)+"px";h.style.display="block";document.body.style.cursor="col-resize";if(!this.colSizeArray){this.colSizeArray=this.createColSizeArray();this._firstTimeResize=true;}k.resizingRange=this.resizeColumnBehavior.getRange(this,i);return ;}if(this._super){this._super(g);}},ondragmove:function P(h){var o=h.src,i=o&&o.data,m=i&&i.resizingIdx;if(m&&m>0){var n=h.tgt,j=this.avatar,l=i.resizingRange,k=n.pos.x-i.startingX,g=Math.min(l[1],Math.max(k,l[0]));i.deltaX=g;if(j){j.style.left=(i.startingX-i.baseX+g)+"px";}}else{if(this._super){this._super(h);}}},ondragend:function L(l){var u=l.src,m=u&&u.data,q=m&&m.resizingIdx;if(q&&q>0){var g=this.titleColGroup,t=g&&g.childNodes,o=this.dataColGroup,p=o&&o.childNodes,k=t.length,n=this.colSizeArray,h=m.deltaX;this.resizeColumnBehavior.updateSize(this,q,h);if(this._firstTimeResize){var j;for(j=0;j<k;j++){t[j].style.width=n[j]+"px";p[j].style.width=n[j]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,t,p,q);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(l);}}}});mstrmojo.requiresCls("mstrmojo.ListMapperTable","mstrmojo.WidgetList");function J(j){var m=document.createElement("colgroup"),g=j.length,h,l;for(l=0;l<g;l++){var k=document.createElement("col");h=j[l];if(h.colWidth){k.style.width=h.colWidth+"px";}k.className=h.colCss||("col"+l);m.appendChild(k);}return m;}function I(h){var j=h._headerWidgets_,g=j&&j.length;if(g>0){var k;for(k=0;k<g;k++){j[k].destroy(true);}}}function A(k,g,j,m,h){var i=[],l=k.headerWidget;j=j?(" "+j):"";m=m||this._headerWidgets;h=h?(" "+h):' w="1"';i.push("<td"+j+">");if(g>0&&this.resizableColumns){i.push(O(g));}i.push('<div class="mstrmojo-DataGrid-headerText');i.push(k.headerCss?" "+k.headerCss:"");if(l){m.push(mstrmojo.hash.copy(l));i.push('"'+h+">");}else{i.push('">');}i.push(k.headerText||"&nbsp");i.push("</div>");i.push("</td>");return i.join("");}function b(g,o){var j,m,n,h,p,l,k=[];g=g||"_headerWidgets";o=o||"1";j=this[g];m=j.length;if(m>0){n=this.headerContainerNode.getElementsByTagName("div");h=mstrmojo.array.filter(n,function(i){return i.getAttribute("w")==o;});for(l=0;l<m;l++){j[l].placeholder=h[l].firstChild;j[l].dataGrid=this;p=mstrmojo.registry.ref(j[l]);p.render();k.push(p);}}this[g+"_"]=k;}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,lockHeader:false,contentWidth:"",renderHook:{},shouldDisableItem:function(){return false;},markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;},headerRows:function(){return this.domNode.firstChild.firstChild.rows;},bodyRows:function(){return this.domNode.lastChild.firstChild.firstChild.rows;}},markupMethods:{oncontentWidthChange:function(){var h=this.contentWidth,i=this.headerContainerNode,g=this.itemsContainerNode;if(h&&i&&g){i.style.width=h;g.style.width=h;}},onlockHeaderChange:function(){mstrmojo.css.toggleClass(this.domNode,"lockHeader",this.lockHeader);},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},setupScrollNodes:function M(){this.scrollNode=this.scrollboxNode;},itemFunction:function(i,g,h){var j=new mstrmojo.DataRow({columns:h.columns,data:i,disable:h.shouldDisableItem(i),idx:g,dataGrid:h,parent:h});return j;},preBuildRendering:function D(){var m=this.renderHook;if(m&&m.pre){m.pre.apply(this,[A]);}else{var h=this.columns,g=h.length,j=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],l;this._headerWidgets=[];var k;for(k=0;k<g;k++){l=A.apply(this,[h[k],k]);j.push(l);}j.push("</tr></table>");this.headerHtml=j.join("");}if(this._super){this._super();}},postBuildRendering:function W(){if(this._super){this._super();}var i=this.renderHook;if(i&&i.post){i.post.apply(this,[J,b]);}else{b.apply(this);this.titleColGroup=J(this.columns);}var g=this.titleColGroup,n=g.cloneNode(true),k=this.headerContainerNode,m=k&&k.getElementsByTagName("table")[0],o=this.itemsContainerNode,l=this.scrollboxNode,j=this.domNode,h=o&&o.getElementsByTagName("table")[0];this.dataColGroup=n;if(m&&h){m.insertBefore(g,m.firstChild);h.insertBefore(n,h.firstChild);}if(this.lockHeader){l.style.height=j.offsetHeight-k.offsetHeight+"px";mstrmojo.dom.attachEvent(l,"scroll",function(p){k.style.left=-l.scrollLeft+"px";});}},refresh:function H(g){I(this);if(this._super){this._super(g);}},destroy:function e(g){I(this);this._super(g);},unrender:function V(l){var j=this._headerWidgets_,h=j&&j.length,g;if(h>0){var k;for(k=0;k<h;k++){g=j[k];if(g&&g.hasRendered){g.unrender(true);}}}this._super(l);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",dataTextCSSClass:"mstrmojo-DataRow-text",columns:null,disable:false,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var n=document.createElement("tr"),s=this.data,x=this.idx,h=this.dataGrid,o=this.cssClass,z=this.columns,g=this.children,k=this.disable,j,t=-1,y,u;n.setAttribute("id",this.id);if(h.banding){o+=(x%2==1)?" odd":" even";}n.className=o+(mstrmojo.string.isEmpty(s[h.itemDisplayField||"n"])?" empty-row":"")+(" "+s[h.itemCSSField||"itemCss"]||"")+(k?" disabled":"");var m,q;for(m=0,q=z.length;m<q;m++){y=z[m];u=(y.dataWidgetBuilder&&y.dataWidgetBuilder(s))||y.dataWidget;j=document.createElement("td");if(y.applyStyle2Cell&&y.colCss){j.setAttribute("class",y.colCss);}n.appendChild(j);if(u){j.setAttribute("w","1");t++;g.push(mstrmojo.hash.copy(u,{slot:"slot"+t,data:s,idx:x,dataGrid:h}));}else{if(y.dataFunction){j.innerHTML=y.dataFunction(s,x,h);}else{var l=mstrmojo.string.htmlAngles(s[y.dataField||"n"])||"&nbsp",p=y.tooltip?' title="'+l+'"':"";j.innerHTML='<div class="'+this.dataTextCSSClass+'" '+p+">"+l+"</div>";}}}this.initChildren();n.mstrmojoId=this.id;return n;},buildRendering:function N(){this._super();var l=this.domNode.childNodes,g=l.length,k={},j=0,m,h;for(h=0;h<g;h++){m=l[h];if(m.getAttribute("w")=="1"){k["slot"+j]=m;j++;}}this.addSlots(k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var B=mstrmojo.dom,A={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseover><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(A[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=B.eventTarget(D.hWin,D.e);if(F===this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo._IsDial");mstrmojo.WidgetDial=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._IsDial],{scriptClass:"mstrmojo.WidgetDial"});})();(function(){mstrmojo.requiresCls("mstrmojo.Arr","mstrmojo.Button","mstrmojo.HBox","mstrmojo.FishEye");var A=function(B){return mstrmojo.hash.copy(B,{scriptClass:"mstrmojo.Button",text:"",enabled:false,dir:"left",cssClass:"mstrmojo-icon left",onclick:function(){var D=this.parent.fishEyeList,C=D&&D.scroll(this.dir,D.step);}});};mstrmojo.FishEyeContainer=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.FishEyeContainer",cssClass:"mstrmojo-FishEyeContainer",selectedIndex:-1,setItems:function(B){this.fishEyeList.set("items",B);},setSelectedIndex:function(B){this.fishEyeList.set("selectedIndex",B);},scrollable:false,rightScrollbale:false,children:[A({bindings:{enabled:"!!this.parent.scrollable"}}),({scriptClass:"mstrmojo.FishEye",alias:"fishEyeList",items:mstrmojo.Arr.makeObservable([]),srcId:"obList"}),A({alias:"feScrollRight",cssClass:"mstrmojo-icon right",dir:"right",bindings:{enabled:"!!this.parent.rightScrollable"}})]});mstrmojo.css=mstrmojo.hash.copy({getStyleValue:function(D,E){var B=null;if(D.currentStyle){E=(E==="float"?"styleFloat":E);B=D.currentStyle[E];}if(document.defaultView&&document.defaultView.getComputedStyle){E=(E==="float"?"cssFloat":E);var C=document.defaultView.getComputedStyle(D,null);B=C?C[E]:null;}return B;},setStyleValue:function(D,F,E){var B=function(G){return !!(G&&(typeof G==="object")&&(typeof G.length==="number"));};if(B(F)&&B(E)){var C;for(C in F){D.style[F[C]]=E[C];}}else{D.style[F]=E;}}},mstrmojo.css);}());(function(){mstrmojo.requiresCls("mstrmojo.OBList","mstrmojo.ui._IsIncFetchList","mstrmojo.ui._HasScroller");var F=mstrmojo.array,A=mstrmojo.chart.model.enums.EnumDSSObjectType;function D(G){return{browseConfig:null,parent:G,next:function(J){var I=this.browseConfig;if(!I){return ;}I.blockBegin+=I.blockCount;var H={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockBegin:I.blockBegin,blockCount:I.blockCount,includeAncestorInfo:true};if(I.folderLinksContextId){H.folderLinksContextId=I.folderLinksContextId;}if(I.includeObjectDesc){H.includeObjectDesc=I.includeObjectDesc;}if(I.rootFolderID){H.rootFolderID=I.rootFolderID;}else{if(I.rootFolderType){H.rootFolderType=I.rootFolderType;}}if(I.browsableTypes){H.objectType=I.browsableTypes;}if(I.searchPattern){H.searchPattern=I.searchPattern;if(I.recursive){H.recursive=I.recursive;}}this.parent.set("waiting",true);if(I.dataProvider){I.dataProvider.serverRequest(H,J);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,J,H);}},hasNext:function(){var H=this.browseConfig;return(H.blockBegin+H.blockCount-1)<H.totalSize;}};}mstrmojo.mstr.ui.IncFetchOBList=mstrmojo.declare(mstrmojo.OBList,[mstrmojo.ui._IsIncFetchList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.mstr.ui.IncFetchOBList",cssClass:"mstrmojo-OBList mstrmojo-IF-OBList",makeObservable:true,renderOnScroll:false,waiting:false,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keypress,mousedown,mouseup,dblclick><div class="scroll-box" style="{@scrollBoxCssText}"><div class="mstrmojo-ListBase2-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onwaitingChange:function(){this.onwaitingChange();}},init:function E(G){if(this._super){this._super(G);}this.ifDataHelper=D(this);if(G.browseConfig){this.ifDataHelper.browseConfig=G.browseConfig;}},onwaitingChange:mstrmojo.emptyFn,addItems:function B(G){var H=this.browseConfig.browsableViewMedias;if(G&&H){var I={};F.forEach(H.split(","),function(J){I[parseInt(J,10)]=true;});G=F.filter(G,function(J){return(J.t!==A.DssTypeDocumentDefinition)||I[J.dvm];});}this.add(G,-1);this.set("waiting",false);if(this._super){this._super(G);}if(this.scrollNode){this.updateScrollbars();}},setupScrollNodes:function C(){this.scrollNode=this.scrollboxNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxHoriz","mstrmojo.string");var B=mstrmojo.string;var A={render:function(G,C,H){var J=(H.htmlName+C),E=H.selectedIndices[C]?"checked ":"",F=E?" selected":"",D=G.v!=="u;"?" nAll":"",I=G[H.itemDisplayField||"n"];return'<div class="'+H.itemCssClass+F+D+'"><input type="'+H.inputType+'" name="'+H.htmlName+'" id="'+J+'" value="'+C+'" '+E+'/><label for="'+J+'" title="'+B.encodeHtmlString(G[H.itemTitleField]||"")+'" style="'+H.labelCssText+'">'+(H.allowHTML?I:B.encodeHtmlString(I))+"</label></div>";},select:function(D){var C=D&&D.firstChild;if(C){if(!C.checked){C.checked=true;}mstrmojo.css.toggleClass(D,"selected",C.checked);}},unselect:function(D){var C=D&&D.firstChild;if(C){if(C.checked){C.checked=false;}mstrmojo.css.toggleClass(D,"selected",C.checked);}},rowHeight:23};mstrmojo._RendersInputItems=mstrmojo.provide("mstrmojo._RendersInputItems",{inputType:null,htmlName:null,itemRenderer:A,init:function(C){this._super(C);if(!this.htmlName){this.htmlName=this.id;}},preclick:function(F){var E=F.hWin,H=F.e,G=mstrmojo.dom.eventTarget(E,H);if(G&&G.nodeName.match(/input/i)){var D=parseInt(G.value,10);if(this.inputType&&this.inputType.match(/radio/i)){this.singleSelect(D);}else{var C=(G.checked)?"add":"remove";this[C+"Select"](D);}}}});mstrmojo._InputList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputList"});mstrmojo._InputListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputListHoriz"});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxBase");mstrmojo.ButtonItemRenderer=mstrmojo.hash.copy(mstrmojo.DivItemRenderer);mstrmojo.ButtonItemRenderer.render=function(D,A,E){var B=D.v!=="u;"?" nAll":"",C=(E.enabled===false);return'<input mstridx="'+A+'" class="'+E.itemCssClass+(E.selectedIndices[A]?" "+E.itemSelectedCssClass:"")+" "+(D.css||"")+B+'" style="'+E.itemCssText+'" type="button"  value="'+D[E.itemDisplayField]+'" '+(C?"disabled ":"")+"/>";};mstrmojo._RendersItemButtons=mstrmojo.hash.copy(mstrmojo._RendersItemDivs);mstrmojo._RendersItemButtons.itemRenderer=mstrmojo.ButtonItemRenderer;mstrmojo.ButtonList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonList",cssClass:"mstrmojo-ButtonList",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.ButtonListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonListHoriz",cssClass:"mstrmojo-ButtonListHoriz",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});}());(function(){mstrmojo.requiresCls("mstrmojo.LegacySuggestionList","mstrmojo.ui._HasScroller");var E=mstrmojo.dom;mstrmojo.ui.ScrollableSuggestionList=mstrmojo.declare(mstrmojo.LegacySuggestionList,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-scrollable-suggestlist {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function B(){return this.domNode.firstChild.firstChild;},scrollboxNode:function D(){return this.domNode.firstChild;},scrollNode:function H(){return this.domNode.firstChild;}},onclick:function A(I){var J=this.getItemFromTarget(I.getTarget());if(J){this._super(I);}},onitemsChange:function C(){var I=this;window.setTimeout(function(){I.hideTooltip();I.updateScrollbars();},0);},updateScrollbars:function F(){this._super();var K=this,M=K.scrollNode,I=M.clientWidth,L=K.itemsContainerNode,J=L.clientWidth;L.style.width="auto";window.setTimeout(function(){if(I>J){L.style.width=J+(I-J)+"px";}},10);},useRichTooltip:true,getItemTooltip:function(L,M){var J=E.position(M),K=M.ttp;var I={areaId:L._renderIdx+"text",cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:K,top:J.y,left:J.x+J.w+6,enableHover:false};return I;},showTooltip:function G(I,L){var K=this.targetEl,J=this.targetItem;if(K&&K.ttp){this.richTooltip=this.getItemTooltip(J,K);if(this.richTooltip){this._super(I,L);}}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.requiresCls("mstrmojo.ui.CheckList");mstrmojo.requiresDescs(2121,2122,2125,2127,2123,2124,2126,2128,2129,2130);var F=mstrmojo.desc,E=mstrmojo.array;function B(I,H){var G=H?I.nextElementSibling:I.previousElementSibling;if(G&&G.classList.contains("separator")){G=B(G,H);}return G;}mstrmojo.express.ui.SubtotalsWidget=mstrmojo.declare(mstrmojo.ui.CheckList,null,{scriptClass:"mstrmojo.express.ui.SubtotalsWidget",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:true,accessibilityMenuContainer:function(){return this;},init:function D(G){this._super(G);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-subtotals");},_set_selectedItems:function(J,H){var G=[],I=this.prevSelection={};E.forEach((H||[]),function(K){G.push(K.t);});E.forEach(G,function(K){I[K]=true;});this.setSelectedItems(E.filter(this.items,function(K){return E.indexOf(G,K.v)>-1;}));},onkeydown:function C(R){var K=R.getTarget(),U=R.e.keyCode,N;var H=function(){var W=window.event,d=W.keyCode,b=mstrmojo.dom.findWidget(this.offsetParent),X=mstrmojo.dom.findWidget(b.containerNode.firstChild),V=X.itemsNode,e=this.parentElement.childNodes[0],a=this.parentElement.childNodes[1],c=null,Z=this.textContent==="OK";switch(d){case 9:if(!W.shiftKey){c=Z?a:V;break;}c=Z?V:((e.classList.contains("disabled"))?V:e);break;case 13:var Y=b.opener&&b.opener.td;this.onclick(W);if(this===a&&Y){Y.focus();}break;default:W.stopPropagation();}if(c){if(c!==V){c.setAttribute("tabindex","-1");c.setAttribute("role","button");mstrmojo.dom.attachEvent(c,"keydown",H);}c.focus();}W.preventDefault();W.stopImmediatePropagation();};switch(U){case 37:case 27:var M=this.parent,P=M.opener,G=P.openerMenuElement;if(G){M.close();G.focus();delete P.openerMenuElement;}break;case 39:break;case 38:case 40:var J=U===40?true:false;N=B(K,J);if(N){N.focus();}break;case 13:var O=K.getAttribute("aria-checked")==="true";K.setAttribute("aria-checked",!O);this.onclick(R);break;case 9:var Q=mstrmojo.dom.findWidget(this.domNode.offsetParent),I=Q.btnNode&&Q.btnNode.hasChildNodes(),L=I&&Q.btnNode.children,S;if(K.classList.contains("item")){if(I&&!L[0].classList.contains("disabled")){S=L[0];}else{if(I){S=L[1];}}}if(S&&S.classList.contains("mstrmojo-WebButton")){mstrmojo.dom.attachEvent(S,"keydown",H);S.setAttribute("role","button");S.setAttribute("tabindex","-1");S.focus();}R.e.preventDefault();break;default:R.e.preventDefault();break;}R.e.stopPropagation();},getSubtotalTypes:function A(){var I=this.items,J=this.selectedIndices,L=this.prevSelection,H=I.filter(function(N,M){return J[M]&&!L[N.v];}),K=I.filter(function(N,M){return !J[M]&&L[N.v];}),G=function(M){return M.v;};return[H.map(G),K.map(G)];},items:[{n:F(2121,"Total"),v:-10},{n:F(2122,"Average"),v:-12},{n:F(2125,"Maximum"),v:-14},{n:F(2127,"Minimum"),v:-13},{n:F(2123,"Count"),v:-11},{n:F(2124,"Geometric Mean"),v:-20},{n:F(2126,"Median"),v:-16},{n:F(2128,"Mode"),v:-17},{n:F(2129,"Product"),v:-15},{n:F(2130,"Standard Deviation"),v:-18},{n:F(2132,"Variance"),v:-19}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.CheckList","mstrmojo.ui._IsHierarchyList","mstrmojo.css","mstrmojo.array","mstrmojo.EnumSelectionType");var S=mstrmojo.css,K=mstrmojo.array,A=mstrmojo.EnumSelectionType;var V="hidden",Q="selected",R="expanded",F="collapsed",I="hierarchy",M="hasChildren";var P="u;",Z=10;mstrmojo.ui.HierarchyCheckList=mstrmojo.declare(mstrmojo.ui.CheckList,[mstrmojo.ui._IsHierarchyList],{scriptClass:"mstrmojo.ui.HierarchyCheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="header"></div><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div><div class="footer"></div></div>',markupSlots:{headerNode:function E(){return this.domNode.firstChild;},footerNode:function C(){return this.domNode.lastChild;},scrollboxNode:function H(){return this.domNode.children[1];},itemsContainerNode:function U(){return this.domNode.children[1].firstChild;}},getItemMarkup:function D(b,a){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@tt}"><span class="indent" style="padding-left: {@indent}px;"></span><span class="triangle"></span><span class="checkbox"></span><span class="text">{@en@n}</span></{@tag}>';},getItemProps:function X(c,a){var b=this._super(c,a);if(c.isSelected){b.addCls(Q);}if(this.isHiearachyDisplay()){if(c.hcd){b.addCls(c.epd?R:F);}}return b;},setupScrollNodes:function J(){this.scrollNode=this.scrollboxNode;var a=this.domNode.clientHeight-this.headerNode.clientHeight-this.footerNode.clientHeight;if(a>0){this.scrollNode.style.height=a+"px";}},onclick:function Y(a){var c=a.getTarget(),d=this.getItemNodeFromTarget(c),b=this.getItemFromTarget(c);if(b){if(S.hasClass(c,"triangle")){if(b.hcd){this.doExpandCollapse(d,b);}}else{if(!S.hasClass(c,"indent")){this.doBranchSelect(d,b,!b.isSelected);}}a.cancel();}},doElementSelect:function W(c,b,a){b.isSelected=a;this.onSelectionChange(A.ELEMENT,a,b);this.updateItemNodesStatus();},doBranchSelect:function O(d,b,a){var c=function(e){e.isSelected=a;e.isBranchSelected=a;(e.children||[]).forEach(function(f){c(f);});};c(b);this.onSelectionChange(A.BRANCH,a,b);this.updateItemNodesStatus();},doLevelSelect:function G(b,a){this.getItems().forEach(function(c){if(c.lv===b){c.isSelected=a;}});this.onSelectionChange(A.LEVEL,a,null,b);this.updateItemNodesStatus();},doBranchLevelSelect:function B(e,b,d,a){var c=function(f){if(f.lv===d){f.isSelected=a;}else{if(f.lv<d){(f.children||[]).forEach(function(g){c(g);});}}};c(b);this.onSelectionChange(A.BRANCH_LEVEL,a,b,d);this.updateItemNodesStatus();},doAllSelect:function L(a){this.getItems().forEach(function(b){b.isSelected=b.isBranchSelected=a;});this.onSelectionChange(A.ALL,a);this.updateItemNodesStatus();},updateItemNodesStatus:function N(){var a=this.itemsContainerNode&&this.itemsContainerNode.childNodes;K.forEach(a,function(c){var b=this.getItemFromTarget(c);if(b){S.toggleClass(c,Q,b.isSelected);}},this);},onSelectionChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.ui._HasListTooltip");mstrmojo.ui.PopupList=mstrmojo.declare(mstrmojo.ui.ScrollableList,[mstrmojo._IsPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.ui.PopupList",autoCloses:true,locksHover:true,closeOnClick:true,scrollNodeMaxHeight:undefined,parentDomNode:undefined,keydownString:null,lastKeydownTime:null,keydownInterval:500,closeAfterSelection:true,markupString:'<div id="{@id}" class="mstrmojo-PopupList {@cssClass}" style="{@cssText}" tabIndex="-1" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu,keydown><div class="mstrmojo-popupList-scrollBar"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function I(){return this.domNode.firstChild.firstChild;},scrollboxNode:function A(){return this.domNode.firstChild;}},setupScrollNodes:function F(){this.scrollNode=this.scrollboxNode;},onOpen:function E(){this._super();this.updateScrollbars();var M=this;setTimeout(function(){M.scrollToSelectedItem();},10);},onclick:function K(M){this.closeAfterSelection=true;this._super(M);},postBuildRendering:function B(){var N=this._super();if(!this.parent){var M=this.parentDomNode=this.parentDomNode||document.body;M.appendChild(this.domNode);}return N;},closePopup:function J(){this.set("visible",false);},onkeydown:function H(O){if(!this.opener||!this.opener.focusOnPopup){return ;}var M=O.hWin,R=O.e||M.event,U=this.keydownString;this.locksHover=false;this.closeAfterSelection=false;if(R.keyCode===mstrmojo.Enum_Keys.DOWN_ARROW){if(this.selectedIndex<this.items.length-1){this.set("selectedIndex",this.selectedIndex+1);this.scrollToSelectedItem();}}else{if(R.keyCode===mstrmojo.Enum_Keys.UP_ARROW){if(this.selectedIndex>0){this.set("selectedIndex",this.selectedIndex-1);this.scrollToSelectedItem();}}else{if(R.keyCode===mstrmojo.Enum_Keys.ENTER||R.keyCode===mstrmojo.Enum_Keys.ESCAPE){this.closeAfterSelection=true;this.singleSelect(this.selectedIndex);}else{var S=new Date(),P=S.getTime(),N=R.key&&R.key.toLowerCase()||String.fromCharCode(R.keyCode).toLowerCase(),Q=this;if(this.lastKeydownTime===null){this.keydownString=N;}else{if(P-this.lastKeydownTime<this.keydownInterval){this.keydownString=this.keydownString+N;}else{this.keydownString=N;}}U=this.keydownString;if(this._holdTimer){clearTimeout(this._holdTimer);}this._holdTimer=setTimeout(function(){Q.changeSelectedItem(O);Q.adjustPosition();},Q.keydownInterval);this.lastKeydownTime=P;}}}},changeSelectedItem:function D(M){var P=this.selectedIndex,O=this.items&&this.items.length;if(O>0){var N;for(N=this.selectedIndex+1;N<this.items.length;N++){if(this.items[N].n.toLowerCase().indexOf(this.keydownString)==0){P=N;break;}}if(P===this.selectedIndex){for(N=0;N<this.selectedIndex;N++){if(this.items[N].n.toLowerCase().indexOf(this.keydownString)==0){P=N;break;}}}if(P!==this.selectedIndex){this.set("selectedIndex",P);}}},focus:function L(){this.domNode.focus();},scrollToSelectedItem:function G(){var P=this.itemsContainerNode.childNodes[this.selectedIndex];if(P){var M=this.scrollNode,O=M.clientHeight,N=P.offsetTop;if(N-M.scrollTop+P.offsetHeight>O){M.scrollTop=P.offsetTop+P.offsetHeight-O;}else{if(N<M.scrollTop){M.scrollTop-=P.offsetHeight;}}}},adjustPosition:function C(){this.adjustCornersForPopupOverflow();this.scrollToSelectedItem();this.focus();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var Q=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],Y=["width","height"],o="p_fmts";var l="px";var j={getContentHeight:function(s,u){var t=u.ttl&&u.ttl.height;if(s&&t&&!this.floatingToolbar){return Math.max(parseInt(s,10)-parseInt(t,10),0)+l;}return"";},getPortletMinHeight:function(s){return s.ttl.height;},adjustTitleCss:function(){return ;}};var g={getContentHeight:function(s){return s;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(s){s.titlebarNodeClass+=" floating";return ;}};function A(w,t){var u=this.parent,s=w+"DirtyKey";if(u[s]){u[s](t);}}function P(){this.toolbarTitleTextNode.innerHTML=this.title+(this.count?" ("+this.count+")":"");}function i(){var t=this.parent,w=t&&t.defn;if(w&&parseInt(w.t,10)===mstrmojo.EnumRWUnitType.PANEL){var s=t.parent,u=s.defn;if(u&&u.ifp){return s;}}return null;}var R=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,n:"",buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" nm="{@n}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;"></div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){P.call(this);},oncountChange:function(){P.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B","fx","background-color"],shadowNode:["RW","B","fx","background-color"],buttonbarNode:{src:"ttl",props:["background-color"]},titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]}},updateServer:true,fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:j,getCacheKey:function F(){return this._super()+"-portlet";},getFormats:function M(){var t=this.content,s=t&&t.getFormats();return s&&s[o];},updateContentHeight:function e(x){var s=this.getFormats(),t=this.content,w=t.dimNode||t.domNode,u=((s.ttl&&parseInt(s.ttl.height,10))||0);if(w){if(!x){u+=((this.fc||this.isInFilterPanel())?w.offsetHeight:(s.height?parseInt(s.height,10):0));}this.containerNode.style.height=u+l;this.shadowNode.style.height=u+l;}},init:function p(s){this._super(s);var t=this.content;this.n=(s&&s.defn&&s.defn.n)||"";if(t&&t.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var t=this._ts=(this.floatingTitle)?g:j;if(this.isInFilterPanel()){var u=R.clone(this.formatHandlers);u.portletContainerNode=["z-index","height","B","backgroud-color"];u.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=u;}this._super();t.adjustTitleCss(this);var s="display:none;";if(!this.leftToolbar){this.leftToolbarNodeCssText+=s;}if(!this.toolbar){this.toolbarNodeCssText+=s;}var w=mstrmojo._Formattable.getBorderWidths(this);if(w.l||w.t||w.r){this.borderCss="has-border";}},postBuildRendering:function Z(){var w=mstrmojo.dom,AD=this.titleNode,AC=this.onclicktitle;if(this.floatingTitle&&this.titleNode){document.body.appendChild(this.titleNode);var x=mstrmojo.css,z=this.contentNode,AA=this;if(!this._onhover){this._onhovertt=function(){x.addClass(AA.titleNode,["visible"]);AA._onflt=true;return true;};this._onhoverofftt=function(){x.removeClass(AA.titleNode,["visible"]);AA._onflt=false;return true;};this._onhover=function(){var AE=AA.titleNode;x.addClass(AE,["visible"]);var AF=w.position(AA.contentNode,true);AE.style.top=(AF.y-AE.clientHeight+2)+l;AE.style.left=AF.x+l;return true;};this._onhoveroff=function(){x.removeClass(AA.titleNode,["visible"]);return true;};}w.attachEvent(z,"mouseover",this._onhover);w.attachEvent(z,"mouseout",this._onhoveroff);w.attachEvent(AD,"mouseover",this._onhovertt);w.attachEvent(AD,"mouseout",this._onhoverofftt);}if(AD&&AC){w.attachEvent(AD,"click",AC);}if(this._super){this._super();}var y=this.getFormats();this.set("fc",y&&!y.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var s=this.portletContainerNode.style,u=this.shadowNode.style,AB=this.parent;s.width=u.width="99%";s.top=u.top=AB.topStart+l;s.left=u.left=G+l;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(y.left,10)+G*this.orgPos+l;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}if(this.buttonbarNode.clientHeight>0){this.buttonbarNode.style.height=this.buttonbarNode.clientHeight*this.model.getZoomFactor()+"px";}},adjustFPHeight2Fit:function(){var u=mstrmojo.dom,s=u.position(this.titleNode),t=u.position(this.contentNode).y-s.y-s.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height,10)-t+"px";},unrender:function E(u){if(this.floatingTitle&&this.titleNode){var x=this.domNode,s=this.titleNode,w=mstrmojo.dom;if(x&&this._onhover){w.detachEvent(x,"mouseover",this._onhover);}if(x&&this._onhoveroff){w.detachEvent(x,"mouseout",this._onhoveroff);}if(s&&this._onhovertt){w.detachEvent(s,"mouseover",this._onhovertt);}if(s&&this._onhoverofftt){w.detachEvent(s,"mouseout",this._onhoverofftt);}if(s){document.body.removeChild(s);}}if(this._super){this._super(u);}},updateStyle:function(t,s){var x=this.shadowNode.style,u=this.containerNode.style;x.height=u.height=t;x.width=u.width=s;},_createFormats:function W(){var y=this.content&&this.content.getFormats(),w;w=y.p_fmts={};var s,x;for(s in Q){x=Q[s];if(y[x]!==undefined){w[x]=y[x];delete y[x];}}for(s in Y){x=Y[s];if(y[x]!==undefined){w[x]=y[x];}}y.height=this._ts.getContentHeight(y.height,w);if(mstrmojo.dom.isIE&&w.fx&&w.fx.ds&&!w["background-color"]){w["background-color"]="#ffffff";}var u=w.ttl,t=u&&u["background-color"];if(t){this.titlebarNodeClass=mstrmojo.color.getContrastingColor(t,"light","dark");}},refresh:function q(){if(!this.hasRendered){return ;}var t=this.children,s;for(s=t.length-1;s>=0;s--){t[s].refresh();}},isInFilterPanel:function L(){return(i.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var s=this.getFilterPanel();return s&&s.defn&&parseInt(s.defn.fds,10)===2;}return false;},getFilterPanel:function H(){return i.call(this);},getContainerHeight:function d(){return this.containerNode.clientHeight;},relocate:function C(s){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=s+l;}},setInfoWindowDimensions:function n(x){var t=this.domNode.style,s=this.shadowNode.style,u=this.portletContainerNode.style,w=mstrmojo._Formattable.getBorderWidths(this);x.h-=w.h;x.w-=w.w;s.height=u.height=t.height=x.h+l;s.width=u.width=t.width=x.w+l;x.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function K(s){A.call(this,"add",s);},removeDirtyKey:function J(s){A.call(this,"remove",s);},setDirtyChildren:function a(){var s=this.content;if(s&&s.setDirtyChildren){s.setDirtyChildren.apply(s,arguments);}}});var X=0,O=1,k=2;function N(s){var t=this.content.defn;if(t){t.set("ds",s);}}function m(s){return{FormattingOrder:{ZIndex:this.getFormats()["z-index"]},FormattingView:{WindowState:s}};}function b(AF,AD,s,AG){var AB=this.content,AE=AB.k,AA=mstrmojo.boxmodel.px2Inches,u=AB.model.docModel||AB.model,AI=u.getZoomProps(),x=this.getFormats(),t=AD!==undefined&&s!==undefined,AH={},y=this,z=m.call(this,AF),AC=!(AB.defn.t===mstrmojo.EnumRWUnitType.GRIDGRAPH||AB.defn.t===mstrmojo.EnumRWUnitType.GRAPH);if(t){z.FormattingSize={OldHeight:AA(AI,AD),OldWidth:AA(AI,s),Height:AA(AI,parseInt(x.height,10)),Width:AA(AI,parseInt(x.width,10))};}AH.success=function(w){var AJ=w&&w.data;if(AJ){u.loadPartialData(AJ,AE);}N.call(y,AF);var AK=y.parent;if(AK.adjustSectionSize&&t){AK.adjustSectionSize();}};u.updateUnitFormat(AB,1,z,AH,{params:{suppressData:AC,rapidExec:AC},config:t?null:{silent:true},preserveUndo:true});if(!t&&!(AG&&AG.all)){if(u.saveRWProps){u.saveRWProps(AE,undefined,1,this.loadDataOnResize,AH,true);}}}function U(){var z=this.content;if(!z){return ;}var x=function(AD){mstrmojo.array.forEach(AD,function(AE){if(AE.ds!==undefined){AE.set("visible",(AE.ds!==z.defn.ds));}});},AA;if(this.isInFilterPanel()){var u=(parseInt(this.defn.ds,10)===X);z.set("visible",u);this.updateContentHeight(!u);AA=this.leftToolbar;x(AA&&AA.children);var w=this.parent;if(w.refreshFP){w.refreshFP();}}else{var s=z.getFormats(),AB=this.getFormats(),t=this.portletContainerNode.style,AC=this.shadowNode.style,y=this.contentNode.firstChild.style;y.height=s.height;y.width=s.width;AC.height=t.height=AB.height;AC.width=t.width=AB.width;AC.top=t.top=AB.top;AC.left=t.left=AB.left;if(AB["z-index"]!==undefined){AC.zIndex=t.zIndex=AB["z-index"];}AA=this.rightToolbar;x(AA&&AA.children);if(z.resize){z.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function W(){this._super();var t=this.getFormats();var s=parseInt(this.defn.ds,10);if(s===X){t.normHeight=t.height;t.normWidth=t.width;if(t["z-index"]!==null&&t["z-index"]!==undefined){t.normZIndex=t["z-index"];}}if(s!==k){t.normTop=t.top;t.normLeft=t.left;}},onmaximize:function f(){var w=this.parent,z=this.content,y=z&&z.getFormats(),u=this.getFormats(),t=u.height,s=u.width,x=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();z.clearCache();u.height=(parseInt(w.getHeight(),10)-x.h)+l;y.height=this._ts.getContentHeight(u.height,u);u.width=y.width=(w.getWidth()-x.w)+l;u.top=u.left=0;u["z-index"]=w.getMaxZIndex()+1;b.call(this,k,t,s);},onminimize:function c(){var y=this.content,t=y.dimNode||y.domNode,x=y&&y.getFormats(),w=this.getFormats(),u=w.height||t.offsetHeight,s=w.width;this.clearCache();y.clearCache();w.width=x.width=w.normWidth;w.top=w.normTop;w.left=w.normLeft;if(w.normZIndex!==null&&w.normZIndex!==undefined){w["z-index"]=w.normZIndex;}x.height=0;w.height=this._ts.getPortletMinHeight(w);b.call(this,O,u,s);},onrestore:function S(){var x=this.content,w=x&&x.getFormats(),u=this.getFormats(),t=u.height,s=u.width;this.clearCache();x.clearCache();u.height=u.normHeight;w.height=this._ts.getContentHeight(u.height,u);u.width=w.width=u.normWidth;u.top=u.normTop;u.left=u.normLeft;if(u.normZIndex!==null&&u.normZIndex!==undefined){u["z-index"]=u.normZIndex;}b.call(this,X,t,s);},changeWindowState:function I(u){N.call(this,u);var t=this.content,x=m.call(t,u),s=t.model.docModel||t.model;return s.getUnitFormatAction(t,1,x);},oncollapse:function V(s){b.call(this,O,undefined,undefined,s);},onexpand:function D(s){b.call(this,X,undefined,undefined,s);},adjustFP:function h(){var t=(parseInt(this.defn.ds,10)===X);this.content.set("visible",t);this.updateContentHeight(!t);var s=this.parent;if(s.refreshFP){s.refreshFP();}},postBuildRendering:function Z(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,U);}this._super();if(this.isInFilterPanel()){var s=(parseInt(this.defn.ds,10)===X);this.updateContentHeight(!s);}}});mstrmojo.DocPortlet.ST_RESTORE=X;mstrmojo.DocPortlet.ST_MAX=k;mstrmojo.DocPortlet.ST_MIN=O;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.VisFilterIndicator");mstrmojo.vi.ui.rw._HasVisFilterIndicator=mstrmojo.provide("mstrmojo.vi.ui.rw._HasVisFilterIndicator",{displayVisFilterIndicator:function B(){if(mstrApp.isInVFConfigMode){var D=this.parent,E=D&&D.isIndicatorDisplayed,C;if(E){return ;}C=new mstrmojo.vi.ui.rw.VisFilterIndicator({unitContainer:this});C.render();this.indicator=C;D.isIndicatorDisplayed=true;}},updateVisFilterIndicator:function A(){var C=this.indicator;if(mstrApp.isInVFConfigMode&&C){C.updateDimension();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo.Label","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable","mstrmojo.ui._HasUITheme","mstrmojo.Button","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.tooltip","mstrmojo.ui.editors.ErrorDialogContent");var j=mstrmojo.func.composite,M=mstrmojo.dom,a=mstrmojo.Button.newWebButton,C=mstrmojo.css,Z=mstrmojo.all,N=mstrmojo.hash,c=mstrmojo.DI.DIHelpers,X=mstrmojo.array;function W(q){if(!this.modal){return ;}var s=window.mstrApp;if(s&&s.modalEditorChange){s.modalEditorChange(this.id,q);}}mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.Editor",title:"",allowHTMLTitle:false,help:"",autoClose:false,showTitle:true,openEffect:null,themeClassName:"mojo-theme-light",useRichTooltip:true,closeEffect:null,onEditorResized:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mouseup,mousedown,click,contextmenu>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div class="mstrmojo-Editor-title-container"><div class="mstrmojo-Editor-title"></div><div class="edt-title-btn mstrmojo-Editor-help" tooltip="'+mstrmojo.desc(1143,"help")+'"></div><div class="edt-title-btn mstrmojo-Editor-close" tooltip="'+mstrmojo.desc(2102,"Close")+'"></div></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function Y(){return this.domNode.firstChild;},titleContainerNode:function k(){return this.domNode.firstChild.firstChild;},titlebarNode:function m(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function R(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},helpNode:function n(){return this.showTitle?this.domNode.firstChild.firstChild.children[1]:null;},closeNode:function E(){return this.showTitle?this.domNode.firstChild.firstChild.lastChild:null;},containerNode:function S(){return this.domNode.firstChild.childNodes[2];},buttonNode:function I(){return this.domNode.firstChild.childNodes[3];},curtainNode:function o(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.allowHTMLTitle?this.title:mstrmojo.string.encodeHtmlString(this.title);}},onzIndexChange:function(){var q=this.zIndex;this.editorNode.style.zIndex=q;this.curtainNode.style.zIndex=q-1;},onvisibleChange:function(u){if(u){return ;}var t=this.visible,s="closeEffect",q="none";if(t){s="openEffect";q="block";}if(this[s]){this.playEffect(s);}else{this.editorNode.style.display=q;if(this.modal){this.curtainNode.style.display=q;}}},onhelpChange:function f(){if(this.showTitle){var s=this.help,q=this.helpNode;if(!s){q.style.display="none";}else{q.style.display="block";}}},onleftChange:function F(){this.editorNode.style.left=this.left||"";},ontopChange:function H(){this.editorNode.style.top=this.top||"";}},open:function Q(s,q){this._super(s,q);W.call(this,true);},close:function h(q){this._super(q);W.call(this,false);},unrender:function B(q){this._super(q);W.call(this,false);},destroy:function i(q){this._super(q);W.call(this,false);},preBuildRendering:function A(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;W.call(this,true);}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function l(){return this.titlebarNode;},getMovingTarget:function V(){return this.editorNode;},onPreClose:function G(){this.hideTooltip();return true;},premousedown:function P(q){var s=q.getTarget();if(s===this.closeNode||s===this.helpNode){C.toggleClass(s,"active",true);}},premouseup:function O(q){var s=q.getTarget();if(s===this.closeNode||s===this.helpNode){C.toggleClass(s,"active",false);}if(q.getTarget()===this.closeNode&&this.onPreClose()){this.close();}},onclick:function e(q){if(q.getTarget()===this.helpNode){if(mstrApp.showHelpTopic){mstrApp.showHelpTopic(this.help);}else{window.open(mstrmojo.helpPath()+(this.help||""),"_blank");return false;}}},_set_visible:function d(x,t){var s=(this[x]!==t);if(s){this[x]=t;var w=this._close_handler;if(t){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var u=this;w=this._close_handler=w||function(y){var z=M.eventTarget(self,y);if(z&&z.parentNode&&!M.contains(u.editorNode,z,true,document.body)){u.close();}};M.attachEvent(document.body,"mousedown",w);}}else{var q=this._curtain_handler;if(q){M.detachEvent(window,"resize",q);}if(w){M.detachEvent(document.body,"mousedown",w);}}}return s;},showTooltip:function p(y,x){var w=this,s=M.findAncestorByAttr(M.eventTarget(x,y),"tooltip",true,this.domNode),u=s&&s.value;if(!w.hasOpenTooltip&&u){var q=M.position(s.node);w.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",content:u,top:Math.max(q.y+40,0),left:Math.max(q.x+4,0),posType:mstrmojo.tooltip.POS_TOPCENTER};this._super(y,x);}}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(q){q=Math.round(q);return["rgb(",q,",",q,",",q,")"].join("");}}},preStart:function(){var s=this.target,q=this.widget;q.editorNode.style.display="block";if(!q.modal){return false;}s.style.display="block";C.setOpacity(s,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var q=this.widget;q.editorNode.style.display="none";return !!q.modal;}};function D(q){return function(){Z[q].destroy();};}function J(s,AA,AB,AC){var q=AA.id||"mojoAlertx9",x,z=AA.buttons;X.forEach(z,function(AE){var AD=AE.onclick;AE.onclick=function(AF){var AG=Z[q];if(AD&&AD.call(AE,AF)===false){return ;}AG.destroy();AG=null;};});try{!!Z[q]&&Z[q].destroy();}catch(y){}var t=AA.cssClass,u=[];if(t){u.push(t);delete AA.cssClass;}if(AC){u.push(AC);}u.push("mstrmojo-alert");x={scriptClass:"mstrmojo.Editor",id:q,width:"475px",zIndex:1000,title:AB||mstrmojo.desc(11812,"Notification"),cssClass:u.join(" "),children:[{scriptClass:"mstrmojo.Box",cssClass:"alert-content",children:[{scriptClass:"mstrmojo.Label",text:s,allowHTML:AA.allowHTML}]}],visible:true};var w=new mstrmojo.Editor(N.copy(AA,x));w.render();return w;}if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.notify=function L(s,z,t){t=t||{};var AA=t.forceClose,y=t.callback||mstrmojo.emptyFn,x=N.copy(z||{},{buttons:AA?[mstrmojo.Button.newActionButton((t.buttonText||mstrmojo.desc(8607,"Dismiss")),y)]:null,showTitle:false,modal:false,top:"42px"}),u=t.duration||6000;var w=J(s,x,"",AA?"ed-notify":"ed-toast"),q=w.id;if(!AA){window.setTimeout(j([y,D(q)]),u);}else{window.setTimeout(function(){if(Z[q]){Z[q].editorNode.style.opacity=0.75;}},6000);}return w;};mstrmojo.confirm=function g(q,y,AA){y=y||{};var t=y.confirmBtn||{},x=y.cancelBtn||{},z=t.hot!==false,s=!!x.hot,w=AA&&AA.title,u=[a(t.t||mstrmojo.desc(219,"Yes"),t.fn,z,t.cfg),a(x.t||mstrmojo.desc(218,"No"),x.fn,s,x.cfg)];return J(q,N.copy(AA||{},{buttons:u,onPreClose:function(){if(x&&x.fn){x.fn();}return true;}}),w,c.getEnvObj().isStandaloneDataSet()?["error-dialogue-in-dataset"]:[]);};mstrmojo.warn=function K(t,q,s){s=s||{};s.cssClass=(s.cssClass||"")+" mstrmojo-warning";return mstrmojo.confirm(t,q,s);};mstrmojo.alert=function b(x,t,w,y,q,u){var s={title:w||mstrmojo.desc(12405,"Alert"),zIndex:y,cssClass:q,buttons:[a(mstrmojo.desc(1442,"OK"),t,true)],onPreClose:function(){if(t){t();}return true;}};N.forEach(s,function(AA,z){if(!AA){delete s[z];}});return J(x,N.copy(u,s),w,c.getEnvObj().isStandaloneDataSet()?["error-dialogue-in-dataset"]:[]);};mstrmojo.error=function U(x,s,w){var t=x||{};var u=mstrmojo.desc(96,"Error");var q=!(c.getEnvObj().isInDI()||c.getEnvObj().isInQB());if(w){u=(w.title)?w.title:mstrmojo.desc(96,"Error");w.title=u;if(w.enableContactStr===false){q=false;}}J("",N.copy(w||{},{buttons:[a(mstrmojo.desc(1442,"OK"),s,true)],children:[{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",shortDesc:t.shortDesc,longDesc:t.longDesc,showToggle:!!(t.longDesc),enableContactStr:q,allowHTML:!!(w&&w.allowHTML===true)}]}),u,c.getEnvObj().isStandaloneDataSet()?["error-dialogue-in-dataset"]:[]);};}mstrmojo.Editor.ButtonConfigType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.Box","mstrmojo.array","mstrmojo._HasLayout","mstrmojo.ui.ColumnContainer");var E=mstrmojo.dom,G=mstrmojo.hash,C=mstrmojo.array;mstrmojo.ui.ColumnWalk=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.ColumnWalk",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnWalk cf {@cssClass}" mstrAttach:click></div>',layoutConfig:{h:{containerNode:"100%"},xt:true},currentColumn:-1,addNextColumn:function B(K){var J=this.children||[],L=J.length,I=J[L-1];var M=this.addChildren([G.copy(K,{scriptClass:"mstrmojo.ui.ColumnContainer",idx:L})])[0];if(I){I.set("next",M);}},onclick:function A(I){var K=I.getTarget();if(K){var J=this.children;C.forEach(J,function(M,L){if(E.contains(M.domNode,K,true,M.domNode)){this.set("currentColumn",L);}},this);}},oncurrentColumnChange:function D(I){var K=this.children,M=K[I.valueWas],J=K[this.currentColumn],L="active";if(M){M.set(L,false);}J.set(L,true);},removeTrailingContainer:function H(K){var J=this,I=this.children;if(!I||K>=I.length-1){return ;}C.forEach(I.slice(K+1),function(L){J.removeAndDestroyChild(L);});if(K>=0){I[K].set("next",null);}},insertAndRemoveTrailing:function F(J,I){this.removeTrailingContainer(J);this.addNextColumn(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuPopup","mstrmojo.Button","mstrmojo.dom","mstrmojo.ui._HasScroller");mstrmojo.requiresDescs(1442,2140);var E=mstrmojo.dom,H=mstrmojo.array;function I(N,P){var M=2140,R="Cancel",Q="this.parent.popupConfig."+(N?"ok":"cancel"),O=P&&P[(N?"ok":"cancel")+"BtnText"];if(N){M=1442;R="Ok";}return mstrmojo.Button.newWebButton(O||mstrmojo.desc(M,R),function(U){var V=this.parent,S=V.popupConfig;V.closeAllMenus();S["fn"+R](S.data,V);E.stopPropogation(U.hWin,U.e);},N,{slot:"btnNode",bindings:{enabled:Q+"Enabled",visible:Q+"Visible"},cssDisplay:"inline-block"});}function B(O,N){var M=N?O.nextElementSibling:O.previousElementSibling;if(M&&M.classList.contains("separator")){M=B(M,N);}return M;}mstrmojo.ui.menus.MenuEditor=mstrmojo.declare(mstrmojo.ui.menus.MenuPopup,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.menus.MenuEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-MenuEditor {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="scroll-container" style="{@scCssText}"><div class="me-content"></div><div class="me-buttons"></div><div class="me-bottom"></div></div></div>',markupSlots:{containerNode:function D(){return this.domNode.firstChild.firstChild;},btnNode:function J(){return this.domNode.firstChild.children[1];},bottomNode:function J(){return this.domNode.firstChild.children[2];},scrollNode:function(){return this.domNode.firstChild;},scrollbarHostNode:function(){return this.domNode;}},popupConfig:null,postBuildRendering:function A(M){this._super(M);if(this.popupConfig&&this.popupConfig.supportsScroll){var N=this;window.setTimeout(function(){N.updateScrollbars();},10);}},onmouseover:function L(N){var M=this.popupConfig;if(M&&!M.isHostedWithin&&this.opener){this.opener.raiseEvent(mstrmojo._HasMarkup.newDomEvent(N.name,N.hWin,N.e,{targetHostElement:M.hostElement}));}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll){var N=this.scrollNode;if(!N){return ;}var M=E.getComputedScrollbarWidth(N);N.style.marginRight=-M+"px";N.style.paddingRight=0;}},monitorWindow:function G(){var N=document.activeElement,M=null;if(N!==null&&N.id!==""){M=this.domNode.querySelector("#"+N.id)?N:null;}this._super();if(M){M.focus();}},init:function K(O){this._super(O);var N=this.popupConfig,M=N.bottomNode;if(N&&N.supportsScroll&&N.maxHeight>0){if(N.cssClass.indexOf("RoleMenu")>-1){N.maxHeight=360;}this.cssText=(this.cssText||"")+";max-height:"+N.maxHeight+"px";this.scCssText=(this.scCssText||"")+";max-height:"+N.maxHeight+"px";}if(!!mstrApp.isWSStyling){this.themeClassName="mojo-theme-light";}this.data=N.data||{};if(N.onOpen){this.onOpen=N.onOpen;}this.addChildren([I(true,N),I(false)]);if(M){M.slot="bottomNode";this.addChildren(M);}},onOpen:function C(){H.forEach(this.children,function(M){if(M.scriptClass==="mstrmojo.ui.ScrollableContainer"&&M.onOpen){M.onOpen();}});if(this.hasAccessibility&&this.enableAccessibility){this.enableAccessibility();}},onkeydown:function F(U){var O=U.getTarget(),V=U.e.keyCode,Q;switch(V){case 37:case 27:var P=this,S=P.opener,M=S.openerMenuElement;if(M){P.close();M.focus();delete S.openerMenuElement;}break;case 39:break;case 38:case 40:var N=V===40?true:false;Q=B(O,N);if(Q){Q.focus();}break;case 13:var R=mstrmojo.dom.findWidget(O.parentElement);R.onclick(U);U.e.preventDefault();U.e.stopImmediatePropagation();break;default:U.e.preventDefault();break;}U.e.stopPropagation();},});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.MenuPopup");mstrmojo.ui.menus.PopupConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.PopupConfig",cssClass:"",hasToggleItem:false,contents:null,clear:function A(){this._super();this.contents=null;},close:function C(){([].concat(this.contents)[0]).parent.closeAllMenus();},newInstance:function B(){return new mstrmojo.ui.menus.MenuPopup({popupConfig:this});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._CanAutoClose","mstrmojo._IsPopup","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.ui.PopupConfig","mstrmojo.ui._HasScroller","mstrmojo.ui._HasUITheme","mstrmojo.dom","mstrmojo.css","mstrmojo.ui._HasListTooltip");var D=mstrmojo.dom,Q=mstrmojo.css,K=mstrmojo.ui.PopupConfig.directionCfg;var R={};var M=false;function F(X,W){var V=W?X.nextElementSibling:X.previousElementSibling;if(V&&V.classList.contains("separator")){V=F(V,W);}return V;}function G(Z,a){if(Z.pop){if(a&&Z.ax){window.clearTimeout(this._popupAxTimeout);Z.actionFn();this.closeAllMenus();}else{var X=Z.fn.call(mstrmojo.all[Z.scope],Z.ctxt);if(this.hasAccessibility){X.hasAccessibility=true;}var Y=X.ENUM_CORNERS,W=X.maxHeight,V=D.getMaxScrollHeight();X.setAlignment(Y.TOP_RIGHT,Y.TOP_LEFT);X.hostId=this.id;X.hostElement=this._getItemNode(Z._renderIdx);X.includeScroll=this.includeScroll;X.supportsScroll=true;X.alignWithAnchor=true;X.isHostedWithin=false;X.maxHeight=W?Math.min(V,W):V;this.openPopup(X.newInstance());}}else{if(Z.dsbld!==true){if(Z.fn(Z,this)!==false){this.closeAllMenus();}}}}mstrmojo.ui.menus.Menu=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo._IsPopup,mstrmojo.ui.menus._IsMenuPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip,mstrmojo.ui._HasScroller,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.ui.menus.Menu",selectionPolicy:"reselect",locksHover:true,closeOnClick:true,themeClassName:"mojo-theme-dark",icnCss:"mstrmojo-ui-Menu-item-container",popupConfig:null,accessibilityMenuContainer:function(){return this;},tooltipCss:{leftCssClass:"menuTooltip",rightCssClass:"menuTooltip"},setupScrollNodes:function(){if(this.popupConfig&&this.popupConfig.supportsScroll){this.scrollNode=this.itemsContainerNode;this.scrollbarHostNode=this.domNode;}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll&&this.hasCustomScrollbar){var W=this.scrollNode;if(!W){return ;}var V=D.getComputedScrollbarWidth(W);W.style.marginRight=-V+"px";W.style.paddingRight=0;}},onscroll:function(){this.closePopup();this._super();},init:function N(X){this._super(X);if(!!mstrApp.isWSStyling){this.themeClassName="mojo-theme-light";}if(X.themeClassName){this.themeClassName=X.themeClassName;}var V=this.popupConfig;this.items=V.getMenuItems();var W=["mstrmojo-ui-Menu","unselectable"],Y=V.menuCssClass;if(Y){W.push(Y);}if(V.hasToggleItem){W.push("hasToggleItem");}Q.addWidgetCssClass(this,W);if(V&&V.supportsScroll&&V.maxHeight>0){this.icnCssText=(this.icnCssText||"")+";max-height:"+V.maxHeight+"px";}this.useRichTooltip=!!V.useTooltip;this.tstid=V.tstid;},markupMethods:{onvisibleChange:function L(){var V=this.visible;if(!M||V){Q.toggleClass(this.domNode,"visible",V);}}},getItemMarkup:function C(a,W){if(a.getItemMarkup){return a.getItemMarkup.apply(this,[a,W]);}var Y=!!a.pop,Z=Y?"submenu":"item",X=R[Z],V='<div class="micn"></div>';if(!X){V+=!!mstrApp.isWSStyling?'<div class="mtxt">{@en@n}</div>':"{@en@n}";if(Y){V+='<div class="arw"></div>';}X=this._super(a,W).replace("{@en@n}",V);R[Z]=X;}if(a.tstid){X=X.replace("{@tag}","{@tag} "+mstrmojo.tstid(a)+" ");}return X;},getItemProps:function S(X,V){var W=this._super(X,V);W.tag="a";W.addCls("mstrmojo-ui-Menu-item");W.addCls(X.cls);return W;},onkeydown:function H(a){var X=a.getTarget(),e=a.e.keyCode,Y;switch(e){case 37:var Z=this.opener,V=Z.openerMenuElement;if(V){this.close();V.focus();delete Z.openerMenuElement;}break;case 39:var f=this.items[X.getAttribute("idx")].pop,c=this.xtab||this.opener.boxContent;if(f){this.openerMenuElement=X;this.onclick(a);}if(c){c.isMenuClicked=true;}break;case 38:case 40:var W=e===40;Y=F(X,W);if(Y){Y.focus();}break;case 13:var f=this.items[X.getAttribute("idx")].pop,c=this.xtab||this.opener.boxContent,d=c&&c.zone&&c.zone.tableNode;if(f){this.openerMenuElement=X;}this.onclick(a);if(this.selectedItem.n==="Copy Rows"&&c){d.focus();}else{if(c){c.isMenuClicked=true;}}break;case 27:var Z=this.opener,c=this.xtab||this.opener.boxContent,b=Z.openerMenuElement||this.td||this.popupConfig.hostElement;if(b){this.close();delete Z.openerMenuElement;b.focus();}if(c){c.isMenuClicked=false;}break;default:a.e.preventDefault();break;}a.e.stopPropagation();},onmouseover:function E(b){var Z=b.config&&b.config.targetHostElement?b.config.targetHostElement:b.getTarget(),d=this.getItemFromTarget(Z),a=this,W=a._lastOpened,V=W&&this.getItemFromTarget(W.popupConfig.hostElement)._renderIdx,X=this.getItemNodeFromTarget(Z),Y=(V!==undefined&&D.contains(this._getItemNode(V),Z,true,this.domNode));if(d){this._lastHoverIx=d._renderIdx;window.clearTimeout(this._popupTimeOut);window.clearTimeout(this._popupAxTimeout);if(this._lastHoverIx!==V&&!Y){this._popupTimeOut=window.setTimeout(function(){if(a._lastOpened&&a._lastOpened.visible){a.closePopup();}if(a.visible&&d.pop){if(d.ax){a._popupAxTimeout=window.setTimeout(function(){Q.removeClass(X,"hlt-ax");G.call(a,d);},0);}else{G.call(a,d);}}},400);if(d.pop&&d.ax){Q.addClass(X,"hlt-ax");}}}var c=this.popupConfig;if(c&&!c.isHostedWithin&&this.opener){this.opener.raiseEvent(mstrmojo._HasMarkup.newDomEvent(b.name,b.hWin,b.e,{targetHostElement:c.hostElement}));}},onclick:function U(V){this._evtTarget=V.getTarget();this._super(V);V.cancel();},postselectionChange:function I(V){var W=V.added;if(W){var X=this.items[W[0]];G.call(this,X,!(X.ax&&this._evtTarget.className==="arw"));delete this._evtTarget;}},oncontextmenu:function O(V){D.preventDefault(window,V.e);return false;},postBuildRendering:function P(V){this._super(V);if(this.popupConfig.supportsScroll){var W=this;window.setTimeout(function(){W.updateScrollbars();},10);}},showTooltip:function B(Z,Y){var X=D.eventTarget(Y,Z),W=this.getItemNodeFromTarget(X),V=this.getItemFromTarget(X);this.itemDisabled=V&&V.dsbld;if(W&&((V&&V.ttp)||(W.scrollWidth>W.clientWidth)||(X.scrollWidth>X.clientWidth))){this._super(Z,Y);}},onCloseMenuCallBack:null,onOpen:function J(){if(this._super){this._super();}if(this.hasAccessibility&&this.enableAccessibility){this.enableAccessibility();}},onClose:function A(V){if(this._super){this._super(V);}this.closePopup();if(this.onCloseMenuCallBack){this.onCloseMenuCallBack();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate","mstrmojo.css","mstrmojo.vi.ui.rw.selectors._HasWarningMessage");var H=mstrmojo.css,E=mstrmojo.validation,G=E.TRIGGER,J=E.STATUSCODE;function F(L){if((this.constraints.trigger&L)>0){this.validate();}}mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate,mstrmojo.vi.ui.rw.selectors._HasWarningMessage],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,getInvalidMsg:function K(L){return(L&&L.msg?L.msg:"");},postBuildRendering:function A(){this._super();this._original_tooltip=this.inputNode.title;},prekeyup:function I(L){this._super(L);var P=(this.constraints.trigger&G.ONKEYUP)>0;if(P){var M=this.validationDelay;if(M){this.clearValDelayTimer();var O=this._validateHandler;if(!O){var N=this;this._validateHandler=O=function(){N.validate();if(N._valDelayTimer){window.clearTimeout(N._valDelayTimer);delete N._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(O,M);}else{this.validate();}}},preinput:function D(L){this._super(L);F.call(this,G.ONKEYUP);},preblur:function B(L){this._super(L);F.call(this,G.ONBLUR);},clearValidation:function C(){this._super();var L=this.inputNode;H.removeClass(L,this.constraints.invalidCssClass||"mstrmojo-TextBox-ErrValidation");L.title=this._original_tooltip;},clearValDelayTimer:function(){var L=this._valDelayTimer;if(L){window.clearTimeout(L);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ValidationTextBox,{onvalidationStatusChange:function(){var P=this.validationStatus;if(!P){return ;}var N=this.inputNode,L=(P.code>J.VALID),M=this.constraints.invalidCssClass;H.toggleClass(N,M||"mstrmojo-TextBox-ErrValidation",L);var O=L?this.getInvalidMsg(P):this._original_tooltip;if(!this.useRichTooltip&&O!==undefined&&O!==null){N.setAttribute("title",O);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Pulldown");var C={ENTER:13,LEFT:37,UP:38,TAB:9,RIGHT:39,DOWN:40,ESC:27};function D(L,M){var G,J,F,H=[],I,N;try{I=new RegExp(L,"i");}catch(K){I=new RegExp(mstrmojo.string.regEscape(L));}for(G=0,J=M.length;G<J;G++){if(I.test(M[G][this.itemField])){H.push(M[G]);}}return H;}function B(F){return !(F<0||F===undefined||F===null);}mstrmojo.SearchablePulldown=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchablePulldown",popupCssClass:"mstrmojo-SearchablePulldown-Popup",searchEnabled:false,allowCustomInput:false,useItemCssOnInput:false,lastSearchPattern:"",isEditing:false,allItems:null,markupString:'<div id="{@id}" class="mstrmojo-SearchablePulldown mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-SearchablePulldown-boxNode mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><input class="mstrmojo-SearchablePulldown-inputNode" value="{@text}" mstrAttach:keyup,blur/><div class="mstrmojo-SearchablePulldown-iconNode mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mouseover,mouseout></div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},inputNode:function(){return this.domNode.firstChild.firstChild;},iconNode:function(){return this.domNode.firstChild.children[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:mstrmojo.hash.copy({ontextChange:function(){if(this.inputNode.value!==this.text){this.inputNode.value=this.text;}},onheightChange:function(){this.domNode.style.height=this.height||"";this.boxNode.style.height=this.height||"";},onsearchEnabledChange:function(){this.inputNode.readOnly=this.searchEnabled?false:true;this.items=this.allItems||this.items;},onallowCustomInputChange:function(){if(this.allowCustomInput){this.set("searchEnabled",true);}},onvalueChange:function E(){if(this.useItemCssOnInput&&this.selectedItem){this.inputNode.className="mstrmojo-SearchablePulldown-inputNode "+(this.selectedItem[this.itemCSS]||"");}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),prevalueChange:function(){this.synchronize();},synchronize:function(){var G=this.value,H=this.items||[],I=H[this.selectedIndex],F=-1;if(I&&G===I[this.itemIdField]){this.selectedItem=I;this.set("text",I[this.itemField]);return ;}F=mstrmojo.array.find(this.items,this.itemIdField,G);if(!B(F)&&this.allowCustomInput){this.selectedItem=undefined;this.selectedIndex=undefined;return ;}this.selectedIndex=B(F)?F:this.defaultSelection;this.selectedItem=I=this.items[this.selectedIndex];this.value=I?I[this.itemIdField]:undefined;this.set("text",I?I[this.itemField]:(this.defaultText||""));},preBuildRendering:function A(){if(this._super){this._super();}this.allItems=this.allItems||this.items;this.synchronize();},premousedown:function(F){if(this.searchEnabled&&F.getTarget()===this.iconNode){this.set("items",this.allItems);}this._super(F);},onkeyup:function(M){var J=mstrmojo.string.trim(this.inputNode.value),I=M.e,N=I.keyCode||I.which,L=B(this.selectedIndex)?this.selectedIndex:-1,F=this.allowCustomInput,H=this.items.length;this.isEditing=true;switch(N){case C.ENTER:if(H>0&&!F){this.set("selectedIndex",L===-1?0:L);this.synchronize();}this.closePopup();break;case C.ESC:this.closePopup();this.synchronize();break;case C.UP:if(this.popupRef.visible&&H>0){this.set("selectedIndex",(L+H-1)%H);this.synchronize();}break;case C.DOWN:if(!this.popupRef.visible&&H>0){this.togglePopup();}this.set("selectedIndex",(L+1)%H);this.synchronize();break;default:if(J===this.lastSearchPattern){return ;}var K=[];if(J&&J.length>0&&J.indexOf(this.lastSearchPattern)>-1){K=D.apply(this,[J,this.items]);}else{K=D.apply(this,[J,this.allItems]);}this.set("items",K);if(K.length===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}this.set("selectedIndex",undefined);if(J&&J.length){var G=mstrmojo.array.find(K,this.itemField,J);if(G!==-1){this.set("selectedIndex",G);}}}if(F&&!B(this.selectedIndex)){this.set("value",this.inputNode.value);}this.lastSearchPattern=J;},onblur:function(F){this.isEditing=false;if(!this.searchEnabled){return ;}if(!this.allowCustomInput){this.items=this.allItems;this.synchronize();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.MetricSelectorUtility","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.array","mstrmojo._FormatDefinition","mstrmojo.hash");mstrmojo.requiresDescs(8153,8154,8155,8156,8157,8158,8159,8160,8161,8162,8163,8164,8165,8166,8167,8168,8169,8170,7839,587,2204,2202,2203,7576,7575,7622);var V=mstrmojo.dom,N=mstrmojo.hash,S=mstrmojo.MetricSelectorUtility,j=mstrmojo._FormatDefinition.NumberFormatCategory,J=mstrmojo.desc,W=mstrmojo.css,Y=mstrmojo.num,B=Math,c=B.max,H=B.min,e=B.floor,X=B.round,a=9;function M(AB,AA,y,x){var z="px",q=AB._length,o=AB.handleSize,n=AB.orCfg,AF=n.posCssP,s=n.lenCssP,t=false;y=c(y,-1);x=H(x+a,q);if(y>x){t=true;}var AC=H(y,x),AD=c(y,x),AE=AD-AC-(t?0:o+a),u=c(q-AD,0);if(AB.hasRendered){AA.handle1Node.style[AF]=y+z;AA.handle2Node.style[AF]=(x-a)+z;var m=AA.lowerRange.style,w=AA.thumbNode.style,p=AA.upperRange.style;m[AF]=0;w[AF]=(AC+(t?0:o))+z;p[AF]=(AD+o-a)+z;m[s]=c(AC,0)+z;w[s]=AE+z;p[s]=u+z;}else{z+=";";AF+=":";s+=":";AB.handle1CssText=AF+y+z;AB.handel2CssText=AF+(x-a)+z;AB.lowerRangeCssText=s+c(AC,0)+z;AB.thumbCssText=AF+(AC+o)+z+s+AE+z;AB.upperRangeCssText=AF+(AD+o-a)+z+s+u+z;}return{handle1:y,handle2:x};}function O(m){this.getUnit=function(){return m._length/c((m.items.length-1),1);};this.calcMinMax=function(p,o){var q=m.unit;return{min:e(p/q+0.5),max:e(o/q+0.5)};};this.calcPxIdx=function(o){return e(o/m.unit+0.5);};this.getStep=function(){var p=m.high-m.low,o=parseInt(m.numFmts.cat,10),q=(o===4)?2:(o===5)?4:0;p=(p===0)?1:p;if(p>1){return(p>(m._length-2))?Number(Number(p/(m._length-2)).toFixed(m.numFmts.dp+q)):1;}return p/(m._length-2);};this.getIdx=function(o){return H(c(X((o-m.low)/m.step),0),m.items.length-1);};this.initialMetricSlider=function n(){var t=function(AG){return AG!==undefined&&AG!==null;},q=function(AG){return(t(AG.da)&&t(AG.da.low)&&t(AG.da.high)&&t(AG.da.cnt)&&t(AG.f)&&t(AG.ft)&&t(AG.qua));},p=function(AG){var AK=true,AJ=true,AH=parseInt(AG.ft,10),AI=parseInt(AG.f,10);if(AH===S._GENERIC){AK=AI!==S.FN.ISNULL&&AI!==S.FN.ISNOTNULL&&AI!==S.FN.NOTIN&&AI!==S.FN.IN;}else{if(AH===S._PERCENT||AH===S._RANK){AJ=AI!==S.MRPFN.INASCENDING&&AI!==S.MRPFN.INDESCENDING&&AI!==S.MRPFN.NOTINDESCENDING&&AI!==S.MRPFN.NOTINASCENDING;}}return !AK||!AJ;},AD=0;m.include=m.parent.include;m.clsType="scm ";m.staticStatus=!(t(m.da)&&t(m.da.low)&&t(m.da.high)&&t(m.da.cnt)&&t(m.qua));if(m.staticStatus){m.da.low=1;m.da.high=7;m.ft=S._GENERIC;m.f=S.FN.BETWEEN;m.qua=S.Q._G;m.cs=[{n:"",v:1},{n:"",v:7}];m.numFmts={cat:9,dp:0,fm:""};}switch(m.qua){case 0:var AC=parseInt(m.numFmts.cat,10);AD=AC===4?2:AC===5?4:0;m.low=Number(Number(m.da.low).toFixed(m.numFmts.dp+AD));m.high=Number(Number(m.da.high).toFixed(m.numFmts.dp+AD));break;case 1:case 2:m.low=1;m.high=m.da.cnt;break;case 3:case 4:m.low=0;m.high=100;break;}var AF=!m.staticStatus&&!m.da.nov;m.set("lowText",AF?m.formatNumber(m.low):"");m.set("highText",AF?m.formatNumber(m.high):"");m.step=(m.qua===1||m.qua===2)?1:this.getStep();m.cs1Vl=m.low;m.cs2Vl=m.high;var s=m.low,z=m.high,AE=[],AB=0;if(t(s)&&t(z)){var w=s,y;for(y=0;w<=z;y++,w+=m.step){AE[y]={n:S.formatNumber(m.qua,w,m.numFmts),v:Number(Number(w).toFixed(m.numFmts.dp+AD))};}AB=AE.length;if(AB>0&&AE[AB-1].v!==z){AE[AB-1]={n:S.formatNumber(m.qua,z,m.numFmts),v:z};}}m.items=AE;var o=S.OP,AA=m.cs,x=(AA&&AA.length>0)?Y.parseNumeric(String(AA[0].v).replace("%","")):s,u=(AA&&AA.length>1)?Y.parseNumeric(String(AA[1].v).replace("%","")):z;if(x<m.low){m.frtUst=true;}if(u>m.high){m.ndUst=true;}m.opId=(m.f!==null&&m.ft!==null)?S.getOpIdxByfunc(m.f,m.ft):o._BETWEEN;switch(m.opId){case o._EQUALS:case o._NOT_EQUALS:m.cs1Vl=m.cs2Vl=x;break;case o._LESS_EQUAL:case o._GREATER:m.cs1Vl=s;m.cs2Vl=x;break;case o._GREATER_EQUAL:case o._LESS:m.cs1Vl=x;m.cs2Vl=z;break;case o._IN:case o._NOT_IN:case o._IS_NULL:case o._IS_NOT_NULL:break;default:m.cs1Vl=x;m.cs2Vl=u;break;}m.cs1Idx=this.getIdx(m.cs1Vl);m.cs2Idx=this.getIdx(m.cs2Vl);m.cs1Nm=t(m.cs1Vl)?S.formatNumber(m.qua,m.cs1Vl,m.numFmts):m.items[m.cs1Idx].n;m.cs2Nm=t(m.cs2Vl)?S.formatNumber(m.qua,m.cs2Vl,m.numFmts):m.items[m.cs2Idx].n;m.unit=this.getUnit();m.set("unSet",(!q(m)||p(m)||(!m.cs||m.cs.length===0))&&!m.staticStatus);};this.updateOpCs=function(){var s=(m.cs1Vl>m.cs2Vl)?m.cs2Vl:m.cs1Vl,y=(m.cs1Vl>m.cs2Vl)?m.cs1Vl:m.cs2Vl,q=m.low,u=m.high,x=m.include,o=S.OP,t=parseInt(m.qua,10),p=(t===S.Q._PT||t===S.Q._PB),z,w=[];if((s>=q&&y<=u)||s<q||y>u){m.opId=x?o._BETWEEN:o._NOT_BETWEEN;}if(s===y){m.opId=x?o._EQUALS:o._NOT_EQUALS;}if(s===q&&y<u){m.opId=x?o._LESS_EQUAL:o._GREATER;}if(s>q&&y===u){m.opId=x?o._GREATER_EQUAL:o._LESS;}z=q==s&&y==u;if(!z){switch(m.opId){case o._BETWEEN:case o._NOT_BETWEEN:w.push({dtp:5,v:Y.toLocaleString(s)+(p?"%":"")});case o._EQUALS:case o._NOT_EQUALS:w.push({dtp:5,v:Y.toLocaleString(y)+(p?"%":"")});break;default:if(s>q){w.push({dtp:5,v:Y.toLocaleString(s)+(p?"%":"")});}if(y<u){w.push({dtp:5,v:Y.toLocaleString(y)+(p?"%":"")});}}}m.cs=w;m.parent.node.data.cs=w;m.set("unSet",z);};this.updateThumb=function(){var o=m.cs1Idx,s=m.cs2Idx;if(o!==undefined&&s!==undefined){var p=m.unit,q=m.gap;N.copy(M(m,m,X(o*p-q),X(s*p-q)),m);}};this.joinConst=function(){var q=m.cs;if(q){var o=[],p;for(p in q){o.push(q[p].v);}return o.join(",");}};}var E="<span {@ttpCssText}>{@content}</span>";function D(){if(this.staticStatus){return null;}var p=this.ghost;if(!p){var t=this.containerNode.cloneNode(true),s=t.childNodes;W.addClass(t,["gh"]);p=this.ghost={containerNode:t,lowerRange:s[0],handle1Node:s[1],thumbNode:s[2],handle2Node:s[3],upperRange:s[4]};this.sdcNode.appendChild(t);}var n=this.orCfg,m=n.posCssP,o=n.lenCssP,q=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(z,u){var y=mstrmojo.all[q],x=y[z].style,w=p[z].style;if(u){w[m]=x[m];}w[o]=x[o];});p.containerNode.style.display="block";return p;}mstrmojo.MetricSlider=mstrmojo.declare(mstrmojo.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricSlider",markupString:'<div><div class="mstrmojo-Slider-summary"></div><div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont" style=""><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="bk left" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseover,mouseout,click></div><div class="t2 bk" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseover,mouseout,click></div><div class="bk right" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label" style="margin-top:9px;float:left;"></div><div class="mstrmojo-Label" style="margin-top:9px;float:right;"></div></div></div></div>',markupSlots:{summaryNode:function(){return this.domNode.childNodes[0];},sliderNode:function(){return this.domNode.childNodes[1];},dndNode:function(){return this.domNode.childNodes[1].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},containerNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0];},lowerRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0];},handle1Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[1];},thumbNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[2];},handle2Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[3];},upperRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[4];},tooltipNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},lowNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},highNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2];},editValueNode:function(){return this.domNode;}},markupMethods:{onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onfontChange:function(){this.lowNode.style.font=this.highNode.style.font=String(this.font);}},init:function g(m){this._super(m);this.handleSize=mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH;this.clsType="scm";this.typeHelper=new O(this);this.useRichTooltip=false;},typeHelper:null,unSet:false,preBuildRendering:function A(){var p=this.orCfg,o=this.isHoriz;p.cPosCssP=o?"right":"bottom";p.cLenCssP=o?"height":"width";var t=p.lenCssP,s=this[t],q=parseInt(s,10),n=this.handleSize;var m=this._length=(isNaN(q))?0:(q-n-a);if(m<=0){m=this._length=mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH-n;}if(s){this.bkCssText=t+":"+c(q-(2*this.cssBkBW),0)+"px;";this.sdcCssText=p.posCssP+":"+a+"px;"+t+":"+m+"px;"+p.opPosCssP+":0px;";}this.typeHelper.initialMetricSlider();this.typeHelper.updateThumb();},postBuildRendering:function R(){this._super();if(!this.staticStatus&&!this.da.nov){var n=this.lowNode,m=parseInt(n.style.fontSize,10);if(isNaN(m)){n.style.fontSize=8*this.parent.model.getZoomFactor()+"pt";}this.updateSummary();}this.lowNode.style.marginLeft=a+"px";this.highNode.style.marginRight=a+"px";this.sliderNode.style.height="0px";},onmouseover:function G(m){this.showTooltip(m.e,self);},onmouseout:function f(m){this.hideTooltip(m.e,self);},summaryLabels:{db:J(8153,"Between ## and ###"),dnb:J(8154,"Not between ## and ###"),din:J(587,"In"),dnin:J(2204,"Not in"),dnull:J(2202,"Is Null"),dnnull:J(2203,"Is not Null"),req:J(8155,"Rank ="),rneq:J(8156,"Rank <>").replace("<>",String.fromCharCode(8800)),rexb:J(8157,"Rank exclude bottom"),rext:J(8158,"Rank exclude top"),rb:J(8159,"Rank bottom"),rt:J(8160,"Rank top"),rbt:J(8161,"Rank between ## and ###"),rnbt:J(8162,"Rank not between ## and ###"),rin:J(8163,"Rank in"),rnin:J(8164,"Rank not in"),peq:J(8165,"Percent ="),pneq:J(8166,"Percent <>").replace("<>",String.fromCharCode(8800)),pexb:J(8167,"Exclude bottom"),pext:J(8168,"Exclude top"),pb:J(7576,"Bottom"),pt:J(7575,"Top"),pbt:J(8153,"Between ## and ###"),pnbt:J(8154,"Not between ## and ###"),pin:J(8169,"Percent in"),pnin:J(8170,"Percent not in")},formatNumber:function h(t){var o=this,y=Math.abs(t),x=o.numFmts.cat,n=1000,z=["K","M","B","T","P","E","Z","Y"],u=z.length,s;if(y>=n&&(x===j.Default||x===j.Fixed||x===j.General||x===j.Currency)){for(s=0;s<u;s++,n*=1000){if(y<n*1000){var m=y/n,p=(m*10).toFixed(0)%10>0?1:0,w=m.toFixed(p)+z[s];return t<0?"("+w+")":w;}}}return S.formatNumber(o.qua,t,o.numFmts);},updateSummary:function L(){if(this.summaryNode&&!this.staticStatus){var AG=this.f,o=this.ft,AF=S,AA=S.FN,n=S.MRPFN,x="",AD=(this.cs1Vl<this.cs2Vl)?this.cs1Vl:this.cs2Vl,AB=(this.cs1Vl>this.cs2Vl)?this.cs1Vl:this.cs2Vl,u=this.formatNumber(AD),t=this.formatNumber(AB),q=this.typeHelper,w=this.summaryLabels,m=parseInt(o,10),p=parseInt(AG,10),AC=(m===AF._GENERIC&&(p===AA.ISNULL||p===AA.ISNOTNULL||p===AA.NOTIN||p===AA.IN))||((m===AF._PERCENT||m===AF._RANK)&&(p===n.INASCENDING||p===n.INDESCENDING||p===n.NOTINDESCENDING||p===n.NOTINASCENDING));if(this.unSet||AD<=this.low&&AB>=this.high&&this.include){x=mstrmojo.desc(2058,"All");}if(!this.unSet||AC){switch(o){case AF._GENERIC:switch(AG){case AA.EQUALS:x="= "+u;break;case AA.NOTEQUALS:x=String.fromCharCode(8800)+" "+u;break;case AA.GREATERTHAN:x="> "+t;break;case AA.GREATERTHANEQUALS:x=String.fromCharCode(8805)+" "+u;break;case AA.LESSTHAN:x="< "+u;break;case AA.LESSTHANEQUALS:x=String.fromCharCode(8804)+" "+t;break;case AA.BETWEEN:x=u+" - "+t;break;case AA.NOTBETWEEN:x=mstrmojo.desc(1099)+" "+u+" - "+t;break;case AA.ISNULL:x=w.dnull;break;case AA.ISNOTNULL:x=w.dnnull;break;case AA.IN:x=w.din+" "+q.joinConst();break;case AA.NOTIN:x=w.dnin+" "+q.joinConst();break;}break;case AF._PERCENT:case AF._RANK:var AE="r";if(parseInt(o,10)===AF._PERCENT){AE="p";}switch(AG){case n.EQUALSDESCENDING:case n.EQUALSASCENDING:x=w[AE+"eq"]+" "+u;break;case n.NOTEQUALSDESCENDING:case n.NOTEQUALSASCENDING:x=w[AE+"neq"]+" "+u;break;case n.GREATERTHANEQUALSASCENDING:x=w[AE+"exb"]+" "+u;break;case n.GREATERTHANASCENDING:x=w[AE+"exb"]+" "+t;break;case n.GREATERTHANEQUALSDESCENDING:x=w[AE+"ext"]+" "+u;break;case n.GREATERTHANDESCENDING:x=w[AE+"ext"]+" "+t;break;case n.LESSTHANASCENDING:x=w[AE+"b"]+" "+u;break;case n.LESSTHANEQUALSASCENDING:x=w[AE+"b"]+" "+t;break;case n.LESSTHANDESCENDING:x=w[AE+"t"]+" "+u;break;case n.LESSTHANEQUALSDESCENDING:x=w[AE+"t"]+" "+t;break;case n.BETWEENDESCENDING:case n.BETWEENASCENDING:x=w[AE+"bt"].replace("##",u).replace("###",t);break;case n.NOTBETWEENASCENDING:case n.NOTBETWEENDESCENDING:x=w[AE+"nbt"].replace("##",u).replace("###",t);break;case n.INASCENDING:case n.INDESCENDING:x=w[AE+"in"]+" "+q.joinConst();break;case n.NOTINDESCENDING:case n.NOTINASCENDING:x="";x=w[AE+"nin"]+" "+q.joinConst();break;}break;}}var y=this.summaryNode,z=(x!=="")?"":0;y.innerHTML=x;y.style.margin=z;}},getClientHeight:function U(){return this.dndNode.clientHeight+this.summaryNode.clientHeight+15;},initDrag:function k(q,m){if(!this.staticStatus&&!this.da.nov){m=m||window;var s=V.eventTarget(m,this.dnd.startE);if(s===this.handle1Node||s===this.handle2Node){var p=D.call(this),n=this.orCfg,o=this.dnd;o.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10)-a,length:this._length,contL:p.containerNode[n.lenP],offset:V.getMousePosition(this.dnd.startE,m)[n.offsetP]};o.initD.td=s;W.removeClass(this.domNode.childNodes[1],["invalid"]);}}},ondrag:function K(t,s){if(!this.staticStatus){s=s||window;var w=this.dnd.initD;if(w){var AC=this.ghost,AD=w.handle1,p=w.handle2,q=this.cs1Idx,o=this.cs2Idx,AA=this.unit,y=this.gap,n=w.length;var z=V.getMousePosition(t,s)[this.orCfg.offsetP]-w.offset;switch(w.td){case this.handle1Node:AD=c(H(c(w.handle1+z,0),n)-y,-1);q=c(e(AD/AA+0.5),0);break;case this.handle2Node:p=c(H(c(w.handle2+z,0),n)-y,-1);o=c(B.ceil(p/AA+0.5),0);break;default:return ;}M(this,AC,AD,p);var u=this.items,m=(u&&u.length)||0;if(m&&q>=0&&q<m&&o>=0&&o<m){var AB=false,x;if(q!==this.cs1Idx){this.cs1Idx=q;x=this.items[q];this.cs1Vl=x.v;this.cs1Nm=x.n;AB=true;}if(o!==this.cs2Idx){this.cs2Idx=o;x=this.items[o];this.cs2Vl=x.v;this.cs2Nm=x.n;AB=true;}if(AB){this.typeHelper.updateThumb();this._updateTooltip(w.td);}}}}},ondrop:function Z(n){if(!this.staticStatus&&!this.da.nov){this.typeHelper.updateThumb();var m=this.ghost;if(m){m.containerNode.style.display="none";}this.hideTooltip(n,self);var o=this.dnd&&this.dnd.initD;if(this.makeSelection&&o){this.makeSelection({selItem:o.td});}if(this.items&&this.items.length&&this.ghost){this[(V.eventTarget(self,n)===this.ghost.handle1Node)?"frtUst":"ndUst"]=false;this.selectRange();}this.dnd.initD=null;}},selectRange:function Q(){var m=this.typeHelper,o=this.cs1Vl,n=this.cs2Vl,s=this.qua,p=this.numFmts;this.cs1Idx=m.getIdx(o);this.cs2Idx=m.getIdx(n);this.cs1Nm=S.formatNumber(s,o,p);this.cs2Nm=S.formatNumber(s,n,p);m.updateOpCs();this.onselectionChange();this.updateSummary();},onincludeChange:function C(){if(!this.staticStatus){this.changeInclude=true;this.selectRange();}},showTooltip:function l(n,m){var o=V.eventTarget(m,n);this._updateTooltip(o);mstrmojo.tooltip.open(this,n,m);},_updateTooltip:function P(q){if(N.walk("handle1Node",this.ghost)===q||N.walk("handle2Node",this.ghost)===q){return ;}var n=this.orCfg,p=n.posCssP,m,o={contentNodeCssClass:"scm-tooltip",refNode:this.domNode.childNodes[1],posType:this._tooltip_pos};o[n.opPosCssP]=-parseInt(this.font,10)/2;o[p]=q.style[p];m=String((q===this.handle1Node)?this.cs1Nm:this.cs2Nm);o.content=E.replace(/\{@content\}/g,m);this.set("richTooltip",o);},onclick:function b(m){if(!this.staticStatus&&!this.da.nov){var n=V.eventTarget(m.hWin||window,m.e);this.hideTooltip(m.e,self);this.dnd.initD={makeMetricSilderSelectionByClick:true,td:((n===this.handle1Node)?this.handle1Node:((n===this.handle2Node)?this.handle2Node:null))};this.openEditValue({isfrt:(n===this.handle1Node),tgt:n});if(this._onThumb){this._onThumb(m);}}},onselectionChange:function I(m){this._super(m);if(this.dnd.initD&&this.dnd.initD.makeMetricSilderSelectionByClick){this.dnd.initD=null;}},onquaChange:function d(m){var o=S.getFuncInfo(this.opId,m.valueWas),p=S.getFuncInfo(this.opId,m.value),n;if(o.ft!==p.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();n=true;}}else{this.f=S.getFuncInfo(this.opId,m.value).f;n=false;}this.unSet=n||this.unSet;this.changeQual=true;this.selectRange();},updateData:function F(m,n){this.da=m;this.updateExpr(n);},updateExpr:function i(m){if(m){this.cs=m.cs;this.f=m.f;this.ft=m.ft;this.qua=m.qua;}this.refresh();},editValueRef:{cssClass:"edvl",slot:"editValueNode",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){if(this.tgt){this.set("left",H(c(parseInt(this.tgt.style.left,10),0),parseInt(this.opener.width,10)-90)+"px");this.set("top",this.tgt.style.top);}var o=this.opener,n=this.children[0];if(o){var m=this.isfrt?o.cs1Vl:o.cs2Vl;n.edt.set("value",Y.toLocaleString(m));}},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,layout:[{cells:[{cssText:"width: 40px; padding: 3px;"},{cssText:"width: 16px;padding: 3px;"}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.ValidationTextBox",alias:"edt",cssText:"color:black",dtp:mstrmojo.expr.DTP.NUMERIC,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:function(){if(this.parent.apply){this.parent.apply.set("enabled",String(this.value).length!==0);}},onInvalid:function(){if(this.parent.apply){this.parent.apply.set("enabled",false);}},onkeyup:function(n){if(this.parent.apply.enabled){var m=n.hWin,o=n.e||m.event;if(o.keyCode===13){this.parent.apply.onclick();}}}},{slot:"0,1",scriptClass:"mstrmojo.Button",cssClass:"icn apply",alias:"apply",onclick:function(){var n=this.parent.parent,o=n.opener,m=this.parent.edt.value;if(n&&o&&String(m).length>0){o[n.isfrt?"cs1Nm":"cs2Nm"]=m;m=Y.parseNumeric(m);o[n.isfrt?"cs1Vl":"cs2Vl"]=m;}o[n.isfrt?"frtUst":"ndUst"]=true;o.selectRange();o.typeHelper.updateThumb();n.close();}}]}]},openEditValue:function(m){this.openPopup("editValueRef",m);}});mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH=14;mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ui.editors.controls.ValidationTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,null,{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",errRevert:true,dtp:null,validationDelay:3000,orignText:null,trigger:mstrmojo.validation.TRIGGER.ONKEYUP,init:function(B){B=B||{};B.constraints=B.constraints||{};B.constraints.trigger=this.trigger;this._super(B);},prekeyup:function(B){if(B.e.keyCode===13){this.blur();return ;}this._super(B);},onfocus:function(){this.orignText=this.value;},onblur:function(){if(this.value!=this.orignText){this.validate();}},validate:function(){this._super();this.orignText=this.value;this.clearValDelayTimer();},preinput:mstrmojo.emptyFn,postinput:function(){var B=this.doValidation(this.value);if(B.code<=mstrmojo.validation.STATUSCODE.VALID){this.clearValidation();if(!this.errRevert){this.hideTooltip();}}},updateTooltipConfig:function(){this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onInvalid:function(){if(!this.errRevert){this.hideTooltip();this.showTooltip();}else{this.clearValidation();this.set("value",this.orignText);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo.ui.menus.Menu","mstrmojo._IsList","mstrmojo.vi.ui._HasMask","mstrmojo.dom","mstrmojo.hash","mstrmojo.string","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui._HasListTooltip");var F=mstrmojo.dom;mstrmojo.vi.ui.toolbars.Toolbar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._HasMask,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",tooltipOrientation:"vertical",init:function G(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIToolbar");},selectionPolicy:"reselect",toolbarCfg:null,toolbarClicked:mstrmojo.emptyFn,tooltipCss:null,_set_toolbarCfg:function(L,I){var J=this.toolbarCfg,K=(J!==I);if(K){if(J){J.destroy();}this.toolbarCfg=I;}return K;},getItemProps:function D(K,I){var J=this._super(K,I);J.addCls(K.cls);J.addStyle("display:inline-block");return J;},postBuildRendering:function C(){var I=document.createElement("div");I.className="mstrmojo-VIDND-mask";this.maskNode=this.domNode.appendChild(I);return this._super();},postselectionChange:function(I){var J=I.added;if(J){var K=this.items[J[0]];if(K.tp==="pb"&&K.isMenuClicked){K.menufn(K,this);}else{K.fn(K,this);}}},ontoolbarCfgChange:function H(I){var K=I.valueWas;if(K){K.destroy();}var J=I.value;if(!J){return ;}this.set("items",J.btns);if(this.hasRendered){this.raiseEvent({name:"renderComplete"});}},openMenu:function E(J,I){J.hostId=this.id;J.hostElement=this._getItemNode(I._renderIdx);this.openPopup(J.newInstance());},onclick:function A(I){var K=I.target||F.eventTarget(I.hWin,I.e),J=this.getItemFromTarget(K);if(J&&J.tp==="pb"){if(K&&K.className){J.isMenuClicked=K.className.indexOf("icn")===-1;}}this.toolbarClicked(I);this._super(I);},destroy:function B(J){var I=this.toolbarCfg;if(I){I.destroy();}delete this.items;this._super(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.Menu","mstrmojo.hash","mstrmojo.array","mstrmojo.DynamicClassFactory","mstrmojo._IsAccessibleMenu");mstrmojo.ui.menus.MenuItemType=null;var B=mstrmojo.array,X="separator";mstrmojo.ui.menus.MenuConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.MenuConfig",menus:null,menuCssClass:"",supportsScroll:false,maxHeight:0,hasToggleItem:false,hasMenuItems:function S(){var Y=B.filter(this.menus||[],function(Z){return Z.cls!==X;});return !!Y.length;},getMenuItems:function F(Y){var a=B.filter(this.menus.slice().reverse(),function(e,d,c){var b=c[d+1];return Y||e.cls!==X||(d&&b&&b.cls!==X);}).reverse();var Z=(a&&a.length)||0;if(!Y&&Z>0&&a[Z-1].cls===X){a.pop();}return a;},getMenuItem:function D(b){var a=this.menus,Y;if(a!==null){for(Y=0;Y<a.length;Y++){var Z=a[Y];if(Z.cls===b){return Z;}}}return null;},absorbMenuItems:function V(Y){this.menus=this.menus.concat(Y.menus);if(!this.hasToggleItem&&Y.hasToggleItem){this.hasToggleItem=true;}},addMenuItem:function K(f,b,d,Z,c){var e,a,Y;if(!f||typeof f==="string"){e=f;}else{e=f.n;a=f.ttp;}Y={n:e,ttp:a,cls:b,fn:d,ctxt:Z};if(isNaN(c)||c>=this.menus.length){this.menus.push(Y);}else{this.menus.splice(c,0,Y);}if(b.indexOf(/\bon\b/)>-1){this.hasToggleItem=true;}return Y;},addCustomMenuItem:function W(d,a,c,Z,Y){var b=this.addMenuItem(d,a,c,Y);b.getItemMarkup=Z;return b;},addDisabledMenuItem:function Q(Z,Y){this.addNonInteractiveMenuItem(Z,Y,true);},addNonInteractiveMenuItem:function O(c,Z,Y){var a=["non-int"];if(Z){a.push(Z);}if(Y){a.push("disabled");}if(c&&typeof c!=="string"&&c.ttp){this.useTooltip=true;}var b=this.addMenuItem(c,a.join(" "),mstrmojo.emptyFn);b.dsbld=true;},addSeparator:function E(){this.addMenuItem("",X,function(){return false;});},addPopupMenuItem:function U(f,a,e,b,Z,c){var d=["pop "];if(b){d.push(b);}var Y=this.addMenuItem(f,d.join(" "),e,Z,c);Y.pop=true;Y.scope=a;return Y;},addActionPopupMenuItem:function N(f,Z,d,e,a,Y,c){var b=this.addPopupMenuItem(f,Z,e,(a||"")+" ax",Y,c);b.actionFn=d;b.ax=true;},addSubMenuItem:function M(c,a,Z,b,Y){this.addPopupMenuItem(c,Z,b,a,Y);},addEditorMenuItem:function R(c,Z,b,Y,a){this.addPopupMenuItem(c,Z,b,"",Y,a);},getToggleItemStates:function G(g,i,Y,e,a,d){var b,c,Z,f;if(typeof g==="string"){b=c=g;Z=f="";}else{b=g.on||"";c=g.off||"";Z=g.ttpOn||"";f=g.ttpOff||"";}var h=[{n:b,ttp:Z,cls:i+" on",fn:e,ctxt:d},{n:c,ttp:f,cls:i,fn:Y,ctxt:d}];if(!a){h.reverse();}return h;},addToggleMenuItem:function L(f,b,d,a,Z,e,Y){var c=this.getToggleItemStates(f,b,d,a,e,Y);this.hasToggleItem=true;return this.addDualStateItem(Z,c[0],c[1]);},addDualStateItem:function I(Z,Y,a){return this.addMenuItem({n:Y.n,ttp:Y.ttp},Y.cls,this.getDualStateHandler(Z,Y,a),Y.ctxt);},getDualStateHandler:function J(Z,Y,a){return function(c,d){var b=[Y,a];if(c.cls===Y.cls){b.reverse();}b[1].fn.call(mstrmojo.all[Z],c,d);c.n=b[0].n;c.ttp=b[0].ttp;c.cls=b[0].cls;};},addRadioMenuGroup:function C(a,f,b,Z,Y,e,d){var c=[];this.hasToggleItem=true;b.forEach(function(j,g){if(j.separator){this.addSeparator();return ;}var l=j.text,k=(Z||"")+" "+(j.cls||"")+(e?"":" radio")+(j.value===a?" on":""),i=function(){if(f.call(this.ctxt,j.value,a,j)===false){return false;}a=j.value;c.forEach(function(m){m.cls=m.cls.replace(/ on$/,"")+(m.radioValue===a?" on":"");});return true;},h=d?this.addCustomMenuItem(l,k,i,d(j,g),Y):this.addMenuItem(l,k,i,Y);h.radioValue=j.value;c.push(h);},this);},clear:function P(){this._super();this.menus=[];},newInstance:function A(Z){var Y=mstrmojo.ui.menus.Menu;if(this.hasAccessibility||(this.xtab&&this.xtab.hasAccessibility)){Y=mstrmojo.DynamicClassFactory.newComponent(Y,[mstrmojo._IsAccessibleMenu]);}return new Y(mstrmojo.hash.copy({popupConfig:this},Z));},addMenuTitle:function H(Y){this.addMenuItem(Y||"","menu-item-title",mstrmojo.emptyFn);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.PopupConfig","mstrmojo.ui.menus.MenuEditor");mstrmojo.ui.menus.EditorConfig=mstrmojo.declare(mstrmojo.ui.menus.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.EditorConfig",data:null,fnOk:null,fnCancel:null,okEnabled:true,cancelEnabled:true,okVisible:true,cancelVisible:true,init:function E(F){this._super(F);if(this.data&&!mstrmojo.all[this.data.id]){mstrmojo.hash.make(this.data,mstrmojo.Obj);}this.initBindings();},clear:function A(){this._super();this.data=null;this.fnOk=this.fnCancel=mstrmojo.emptyFn;},newInstance:function D(){var F=mstrmojo.ui.menus.MenuEditor;if(this.hasAccessibility){F=mstrmojo.DynamicClassFactory.newComponent(F,[mstrmojo._IsAccessibleMenu]);}return new F({popupConfig:this});},onOpen:function B(){if(this._super){this._super();}if(this.popupConfig.hasAccessibility&&this.enableAccessibility){this.enableAccessibility();}},destroy:function C(){if(this.data){this.data.destroy();}this.destroyBindings();this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor");function C(E,F){var D=this;if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(E,F,{silent:true});}else{mstrmojo.xhr.request("POST",D.path,F,E,undefined,D.XServer,D.baseParams);}}function A(H,I,G,D){var E=this,F={taskId:"createFolder",taskContentType:"json",folderID:H,name:I,description:G};C.call(E,F,D);}function B(E,I,F){if(!E){mstrmojo.alert(mstrmojo.desc(3380));return false;}var G=this,H=G.fId,D={success:function(J){G.contPanel.name.set("value","");G.contPanel.desc.set("value","");if(G.okFn){G.okFn(J,F);}},failure:function(J){var K="";if(J.getResponseHeader){K=J.getResponseHeader("X-MSTR-TaskFailureMsg");}else{if(J.message){K=J.message;}}K&&mstrmojo.alert(K);}};if(mstrApp.isSingleTier&&this.dp){this.dp.newFolder(H,E,I,D);}else{A.call(G,H,E,I,D);}}mstrmojo.NewFolderEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.NewFolderEditor",cssClass:"mstrmojo-NewFolderEditor",title:mstrmojo.desc(663,"Create Folder"),help:"Create_a_new_folder.htm",navigateAfter:false,okFn:mstrmojo.emptyFn,path:mstrConfig.taskURL,fId:null,children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"btns",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",alias:"ok",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent,G=E&&E.opener,D=E.contPanel.name.value,F=E.contPanel.desc.value;if(!B.call(E,D,F,E.navigateAfter)){E.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Popup","mstrmojo.Editor","mstrmojo.SuggestionList");function D(b,Y){var a=this.list,W=a.selectedIndex,V=a.items.length,X=b?V-1:0;if(W===X){a.clearSelect();return ;}if(W===null||W<0){W=b?0:V-1;}else{W+=b?1:-1;}if(Y){var Z=a.items[W];while(Z&&Z.type==="dummy"){if(W===X){a.clearSelect();return ;}W+=b?1:-1;Z=a.items[W];}}a.singleSelect(W);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,disableClick:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(V){this.hideSuggestion();},getSearchPattern:function U(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(W){var V=this.getSuggestion(W);if(!this.noCache&&V!==-1){this.updateSuggestion(V);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(V){if(this.suggestionShown){this._lastOpened.nextHighlight(V);}},preHighlight:function H(V){if(this.suggestionShown){this._lastOpened.preHighlight(V);}},getSuggestion:function S(j){var e=this.candidates,b=e&&e.items,Y=e&&e.isComplete,h=this._last_hit;if(!this.noCache&&(e||h)){var g=this.filterCandidates(b,j,this.REQUEST_THRESHOLD),d=g.length,f=this.suggestCount,V=false;if(!Y&&d<f){var W=h&&h.pattern;if(h&&W&&(j.indexOf(W)>-1)){V=true;var l=this.filterCandidates(h.items,j,this.REQUEST_THRESHOLD),Z=l&&l.length,X=mstrmojo.array,k=this.itemField,a;for(a=0;a<Z;a++){if(X.find(g,k,l[a][k])===-1){g.push(l[a]);}}d=g.length;}}if(!Y&&((j.length>2&&d<this.REQUEST_THRESHOLD)||(d<f))){this.requestCandidates(j);return -1;}return(d<f)?g:g.slice(0,f);}this.requestCandidates(j);return -1;},requestCandidates:function A(V){this._request_pattern=V;var Y=this,W=this.getSuggestionTarget(),X={success:function(f){if(!f){return ;}var e=Y.getSuggestionTarget();if(!e||(W!==e)){return ;}var k=e.getSearchPattern(),b=f.items;Y._last_hit={items:b,pattern:V};Y.sz=f.sz;if(!Y.noCache&&b){var g=(Y.candidates&&Y.candidates.items)||[],h=[].concat(b),d=b.length,a;for(a=0;a<d;a++){var Z=h[a];if(mstrmojo.array.indexOf(g,Z)>-1){mstrmojo.array.removeItem(b,Z);}}if(Y.candidates){Y.candidates.items=g.concat(b);}}if((k||k==="")&&k.indexOf(V)>-1){var j=Y.filterCandidates(b,k);Y.updateSuggestion(j);}},failure:function(Z){if(Z.getResponseHeader){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};this.getCandidatesThroughTaskCall({pattern:V,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},X);},filterCandidates:function Q(Y,X,V){V=V||this.suggestCount;X=mstrmojo.string.regEscape(X);var Z=this.itemField,W=mstrmojo.array.filter(Y,function(a){return(new RegExp("\\s"+X+"|^"+X,"i")).test(a[Z]);},{max:V});return W;},getHighlightedText:function P(X,a){if(!this.highlightPattern||mstrmojo.string.isEmpty(X)){return a;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){a=a.replace(new RegExp("(^|\\s)("+X+")","gi"),"$1<b>$2</b>");}else{var Z=X.split(" "),W,V;for(W=0,V=Z.length;W<V;W++){if(Z[W]!==""){a=a.replace(new RegExp("("+Z[W]+")","gi"),"<b>$1</b>");}}}}catch(Y){}return a;},updateSuggestion:function O(Y){var W=Y&&Y.length,V=this.browseItemVisible;if(W||V){if(V){Y=Y||[];Y.push({n:"Browse...",t:-99,cssClass:(W?"br":"bro")});}this.set("suggestionItems",Y);if(this.suggestionShown){var X=this._lastOpened;if(X&&X.nudge){X.nudge();}if(this.autoSelect&&X){X.list.singleSelect(0);}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var V=this.opener;if(V&&V.onBrowserClose){V.onBrowserClose();}},onOpen:function(){var V=this.opener;if(V&&V.onBrowserOpen){V.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(V,W){if(this.browseItemVisible&&V.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var X=this.zIndex;this.openPopup("ob",{zIndex:(X&&(X+10))||110});this.ob.browser.browse(mstrmojo.hash.copy(W,{folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes}));this.browserShown=true;}else{this.onSuggestionItemSelect(V);}},highlightPattern:true,suggestionPopupCssClss:"",suggestionPopup:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-ObjectInputBox-suggest",autoClose:true,locksHover:true,nextHighlight:function(V){D.call(this,true,V);},preHighlight:function(V){D.call(this,false,V);},getSelected:function M(){var V=this.list;return V.items[V.selectedIndex];},onOpen:function I(){var V=this.opener;if(V){mstrmojo.css.addClass(this.domNode,V.suggestionPopupCssClss||"");if(V.autoSelect){this.list.singleSelect(0);}if(V.nudge){V.nudge(this);}}},onClose:function F(){this.list.clearSelect();var V=this.opener;if(V){V.suggestionShown=false;mstrmojo.css.removeClass(this.domNode,V.suggestionPopupCssClss||"");}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.func","mstrmojo.string","mstrmojo.Box","mstrmojo.HBox","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.Label","mstrmojo._HasLayout","mstrmojo.Editor","mstrmojo.ui.CheckList","mstrmojo.ui.ToggleButton","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(10,1763,15120,15801);var L=mstrmojo.array,Z=mstrmojo.css,D=mstrmojo.dom,Q=mstrmojo.expr,U=mstrmojo.func,B=mstrmojo.string,R=mstrmojo.Button.newWebButton,b=mstrmojo.mstr.EnumDSSXMLObjectTypes;var W=mstrmojo.desc(1763,"Clear All");mstrmojo.vi.ui.IncCheckList=mstrmojo.declare(mstrmojo.ui.CheckList,[mstrmojo.ui._IsIncFetchList],{scriptClass:"mstrmojo.vi.ui.IncCheckList",allowUnlistedValues:false,cssClass:"elementsList",initElements:function Y(e){var d=this.ifDataHelper,c=this;if(!d){return ;}e=U.wrapMethods({success:function(f){c.clearSelect(true);c.set("items",[]);c.initScroll();c.addItems(f&&f.es);}},e);d.getItems(1,e,{hideFailureErr:true});},addItems:function N(c){this._super(c||[]);this.postAddItems();this.updateScrollbars();},postAddItems:mstrmojo.emptyFn});function F(c){return !L.filterOne(c.fs,function(d){return d.isbf&&(!!d.dtp?d.dtp:Q.mapBaseFormTypeToDataType(d.bftp))!==Q.DTP.CHAR;});}mstrmojo.vi.ui.ElementsBrowser=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.ElementsBrowser",markupString:'<div id="{@id}" class="mstrmojo-Box mstrmojo-ui-vi-ElementsBrowser {@cssClass}" style="{@cssText}"><div></div><div></div><div></div></div>',markupSlots:{containerNode:function(){return this.domNode;},searchBoxNode:function(){return this.domNode.firstChild;},buttonPanelNode:function(){return this.domNode.childNodes[1];},elementListNode:function(){return this.domNode.childNodes[2];}},layoutConfig:{h:{searchBoxNode:"26px",buttonPanelNode:"36px",elementListNode:"100%"},w:{searchBoxNode:"100%",buttonPanelNode:"100%",elementListNode:"100%"},xt:true},onBrowseElementsFailure:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.HBox",slot:"searchBoxNode",alias:"util",cssClass:"elemsBrowser-utils-bar",children:[{scriptClass:"mstrmojo.Box",cssClass:"eb-box-search",alias:"box",children:[{scriptClass:"mstrmojo.TextBox",alias:"searchBox",hint:mstrmojo.desc(10,"Search"),cssClass:"eb-searchBox",valueChangeDelay:300,onEnter:function I(){var d=this.value,c=this.parent.parent.parent;c.set("searchPattern",d);},onvalueChange:function P(){var d=this.value,c=this.parent.parent.parent;c.set("searchPattern",d);}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-clear",text:"",onclick:function(){var c=this.parent.searchBox;c.set("value","");c.cleanUp();c.focus();},bindings:{visible:"(this.parent.searchBox.value || '').length > 0"}}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15120,"View Selected"),cssClass:"eb-viewSelected",title:mstrmojo.desc(15120,"View Selected")},{scriptClass:"mstrmojo.ui.ToggleButton",alias:"toggleSelected",oncheckedChange:function J(){var c=this.parent.parent;c.onsearchPatternChange();}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonPanelNode",alias:"buttonPanel",cssClass:"elemsBrowser-button-panel",children:[{scriptClass:"mstrmojo.Button",text:W,title:W,alias:"clearAllBtn",cssClass:"eb-clearAll",useRichTooltip:true,updateTooltipConfig:function V(){var c=D.position(this.domNode);this.richTooltip={content:mstrmojo.desc(16192,"This function is currently not supported for non-text elements in the searching result."),cssClass:"vi-info vi-tooltip-C",left:c.x+60,top:c.y+5};},onclick:function(){var d=this.parent.parent,f=d.elementList;f.clearSelect(false);var c=d.getLocalSearchItems(),e=d.itemIdField;d.onItemsSelectionChange({added:[],removed:c,itemIdField:e});L.removeItems(d.selectedItems,e,c);},showTooltip:function C(f,d){var c=this.parent.parent;if(!this.enabled&&!B.isEmpty(c.getSearchBox().value)&&!F(c.attribute)){mstrmojo._HasTooltip.showTooltip.call(this,f,d);}}},]},{scriptClass:"mstrmojo.vi.ui.IncCheckList",alias:"elementList",slot:"elementListNode",itemIdField:null,bindings:{ifDataHelper:"this.parent.ifDataHelper",itemIdField:"this.parent.itemIdField"},postAddItems:function(){var c=this.parent.selectedItems||[];this.setSelectedItems(c);}}],itemIdField:"v",ifDataSource:null,searchPattern:null,ifDataHelper:null,attribute:null,attributeId:null,selectedItems:[],init:function(c){this._super(c);this.set("ifDataHelper",new mstrmojo.mstr.DocElementDataHelper({source:this.ifDataSource}));if(this.ifDataSource&&this.attribute){this.onattributeChange();}this.elementList.attachEventListener("selectionChange",this.id,"onElementsListchange");},updateClearAllBtnState:function O(){this.buttonPanel&&this.buttonPanel.clearAllBtn.set("enabled",(B.isEmpty(this.getSearchBox().value)||F(this.attribute))&&(this.getLocalSearchItems().length>0));},onElementsListchange:function H(i){var h=i&&i.added||[],f=i&&i.removed||[],g=this.elementList.items,c=this.itemIdField;if(!this.selectedItems){this.selectedItems=[];}var e=this.selectedItems,d=[],j=L.get(g,f);L.removeItems(e,c,j);var k;L.forEach(h,function(l){k=g[l];if(k&&L.find(e,c,k[c])<0){e.push(k);d.push(k);}});this.updateClearAllBtnState();if(j.length>0||d.length>0){this.onItemsSelectionChange({added:d,removed:j,itemIdField:c});}},onItemsSelectionChange:mstrmojo.emptyFn,updateBrowseConfig:function K(){var e=this,i=this.attributeId,c=this.attribute,h=this.searchPattern,g=function(k,l){k.set("textValid",!l);k.domNode.title=B.encodeHtmlString(l,true);};if(!i){return ;}this.ifDataHelper.set("items",null);var d={attributeID:i};if(h&&h!==""){d.searchPattern=h;d.matchCase=false;d.otp=c.t||b.Attribute;}this.onUpdateBrowseElementsParams(d);this.ifDataHelper.set("browseConfig",d);var j=e.getSearchBox();this.elementList.initElements({success:function(k){g(j,"");},failure:function(p){var m=parseInt(p.code,10)+4294967296,o=2147762269,k=2147762227,l=2147762262,n=2147894808;if(m===k||m===l){g(j,"");}else{if(m!==o){var q=(m!==n)?e.onBrowseElementsFailure.bind(e):null;var s={shortDesc:mstrmojo.desc(15402,"This object is not available at this time."),longDesc:p.message},t={title:mstrmojo.desc(15403,"Invalid Object"),buttons:[R(mstrmojo.desc(13197,"Got it"),q,false)]};mstrmojo.error(s,undefined,t);g(j,"");}else{g(j,p.message);}}}});var f=this.util&&this.util.toggleSelected;if(f){f.checked=false;Z.toggleClass(f.domNode,"checked",false);}this.updateClearAllBtnState();},isObjSearchable:function E(c){return !(c&&c.t===b.Consolidation);},onattributeChange:function A(){var c=this.attribute;this.attributeId=c&&c.did;this.searchPattern=null;this.selectedItems=[];this.updateBrowseConfig();var e=this.getSearchBox(),d=this.isObjSearchable(c);if(e){e.set("enabled",d);e.set("hint",d?mstrmojo.desc(10,"Search"):mstrmojo.desc(15801,"Not searchable"));}},getSearchBox:function M(){var c=this.util,d=this.util&&this.util.box;return d&&d.searchBox;},onifDataSourceChange:function G(){this.ifDataHelper.set("source",this.ifDataSource);this.ifDataHelper.set("items",null);},onsearchPatternChange:function X(){var d=this.util&&this.util.toggleSelected;if(!d||!d.checked){this.updateBrowseConfig();}else{var c=this.getLocalSearchItems();this.elementList.clearSelect(true);this.elementList.set("items",[]);this.elementList.addItems(c);this.updateClearAllBtnState();}},getLocalSearchItems:function S(){var d=[],c;if(this.searchPattern&&this.searchPattern!==""){var e=this.searchPattern.toLowerCase();L.forEach(this.selectedItems,function(f){c=(f.n||"").toLowerCase();if(c.indexOf(e)>-1){d.push(f);}});}else{d=(this.selectedItems||[]).slice(0);}return d;},_set_selectedItems:function a(g,c){var f=this.selectedItems,e=this.itemIdField;c=c||[];this.selectedItems=c;this.updateClearAllBtnState();if(f.length!==c.length){return true;}var d=L.intersection(f,c,e);return d.length!==f.length;},onselectedItemsChange:function(){this.elementList.setSelectedItems(this.selectedItems);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.Box","mstrmojo.HBox","mstrmojo.Button","mstrmojo.Label","mstrmojo.TextArea","mstrmojo.Editor","mstrmojo.ui._HasScroller","mstrmojo.ui.ScrollableContainer");var D=mstrmojo.dom,C=mstrmojo.Button.newWebButton,E=mstrmojo.array,G=mstrmojo.css,H=mstrmojo.string;mstrmojo.vi.ui.editors.SQLCSIViewer=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.editors.SQLCSIViewer",title:mstrmojo.desc(15619,"Query Details"),cssClass:"mstrmojo-charcoalboxe mstrmojo-SQLV mstrmojo-vi-ui-SQLV",csiText:"",copied:false,onOpen:function A(){this.set("copied",false);this.updateScrollbars();},oncsiTextChange:function F(J){this.content.csiTextLabel.set("text",H.encodeHtmlString(J.value));this.updateScrollbars();},setupScrollNodes:function B(){this.scrollNode=this.content.containerNode;},children:[{scriptClass:"mstrmojo.Box",alias:"content",cssClass:"mstrmojo-SQLV-content-container",cssText:"",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="scroll-container" style="overflow:hidden;"></div><textarea name="csi_text" style="position:absolute;top:0;right:10000px"></textarea></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},csiInputNode:function(){return this.domNode.lastChild;}},slot:"containerNode",csiTextLabel:undefined,children:[{scriptClass:"mstrmojo.Label",alias:"csiTextLabel",allowHTML:false,text:""}]},{alias:"buttonBar",scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",children:[{alias:"successIcon",cssClass:"success-icon",scriptClass:"mstrmojo.Label",bindings:{visible:"this.parent.parent.copied"}},{alias:"successTooltip",cssClass:"notice-toaster-label",scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15620,"Statement Copied to Clipboard"),bindings:{visible:"this.parent.parent.copied"}},C(mstrmojo.desc(14502,"Copy to Clipboard"),function I(){var M=this.parent.parent,L=M.content.csiInputNode;L.innerText=M.csiText;L.select();try{var K=document.execCommand("copy");M.set("copied",K);}catch(J){}},false,{cssClass:"copy-button",alias:"btnCopy"}),C(mstrmojo.desc(2102,"Close"),function I(){this.parent.parent.close();},false,{alias:"btnClose"})]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasTooltip","mstrmojo.ui._IsPulldown","mstrmojo.ui.PopupList","mstrmojo.hash","mstrmojo.dom","mstrmojo.string","mstrmojo.css","mstrmojo.array","mstrmojo._CanAutoClose");var U=mstrmojo.css,L=mstrmojo.array,F=mstrmojo.dom,B=mstrmojo.string;function H(W){this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-C",content:B.encodeHtmlString(W)});}mstrmojo.ui.Pulldown=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.ui._IsPulldown,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.ui.Pulldown",onitemSelected:mstrmojo.emptyFn,onSelectedItemChange:mstrmojo.emptyFn,useRichTooltip:true,allowHTML:false,useDarkTheme:false,init:function P(W){this._super(W);U.addWidgetCssClass(this.getPopupList(),"ctrl-popup-list");},initChildren:function C(){this.children=this.getPopupListConfig();this._super();},postBuildRendering:function Q(){if(this._super){this._super();}var W=this.getSelectedItem();if(W){H.call(this,W.n);}},showTooltip:function D(a,Z){var X=this.selectedNode,Y=this.richTooltip;if(X.offsetWidth>=X.scrollWidth){return ;}if(!Y.top){var W=F.position(this.selectedNode);Y.top=W.y-3;Y.left=W.x+W.w+6;}if(this._super){this._super(a,Z);}},getSelectedItem:function M(){var W=this.items;return W&&W[this.selectedIndex];},selectItemByField:function A(X,W){this.set("selectedIndex",L.find(this.items||[],X,W));},getPopupWidget:function E(){return this.list;},getPopupList:function J(){return this.list;},_set_items:function I(Z,W){var Y=this.items;this.items=W;delete this.selectedIndex;if(Y!==W){var X=this.hasRendered;if(X){this.refresh();}return true;}return false;},onclick:function V(W){this._super(W);var Y=this,X=Y.getPopupWidget();Y.mw=Y.mw||function(Z){if(!F.contains(X.domNode,F.eventTarget(self,Z),true,document.body)){X.close();F.detachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Y.mw);}};F.attachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Y.mw);if(Y.focusOnPopup){X.domNode.focus();}},_set_selectedIndex:function N(d,a,Y){if((a!==0&&!a)||a<0){return false;}var X=this.selectedIndex=a,W=this.getPopupList(),Z=W&&W.items,c=Z&&Z[X],b=this.selectedNode;if(c&&c.dsbld){return false;}if(W){mstrmojo._ListSelections._set_selectedIndex.call(W,"selectedIndex",X,Y);}if(b&&Z&&Z[X]){b.innerHTML=this.getPulldownTextInnerHTML(Z[X]);b.title=Z[X].title||"";}if(Z&&Z[X]){if(this.focusOnPopup&&W&&!W.closeAfterSelection){W.itemsContainerNode.children[X].style.color="";}else{this.onitemSelected(Z[X],X);}}return true;},getPulldownTextInnerHTML:function G(W){return this.allowHTML?W.n:B.encodeHtmlString(W.n,true);},postselectedIndexChange:function O(W){var a=W.value,Y=W.valueWas;if(a!==Y){var X=this.items,Z=X[a];if(Z){H.call(this,Z.n);}this.onSelectedItemChange(Z,X[Y]);}},getPopupConfig:function K(){var W=this._super();W.useDarkTheme=this.useDarkTheme;return W;},_set_allowHTML:function(X,W){if(this.allowHTML===W){return false;}this.allowHTML=W;this.getPopupList().set("allowHTML",W);return true;},getPopupListConfig:function S(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",selectionPolicy:"reselect",locksHover:true,useRichTooltip:true,showTooltipForLargeText:true,scrollNodeMaxHeight:this.scrollNodeMaxHeight,allowHTML:this.allowHTML,listHooks:{select:function W(a,b,Z){this.parent.set("selectedIndex",Z);if(this.visible&&this.closeAfterSelection&&!this.selectedItem.dsbld){this.close();}}},getItemProps:function X(b,Z){var a=mstrmojo._IsList.getItemProps.call(this,b,Z);a.style=this.parent.itemCssText||"";return a;},suppressClose:function Y(Z){return mstrmojo._CanAutoClose.suppressClose.call(this,Z)||F.contains(this.parent.domNode,Z,true,document.body);}};},children:[]});mstrmojo.ui.Pulldown.newPulldown=function R(X,b,W,a,Z){a=a||{};a.items=X;var Y;if(Z===true){Y=mstrmojo.hash.copy({scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:W||0},a);}else{Y=new mstrmojo.ui.Pulldown(a);if(W!==undefined){Y.set("selectedIndex",W);}}Y.onSelectedItemChange=b||mstrmojo.emptyFn;return Y;};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.PopupList","mstrmojo.array","mstrmojo.css");var F=mstrmojo.css,E=mstrmojo.array;mstrmojo.ui.editors.controls.ListPreviewButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ListPreviewButton",init:function G(L){this._super(L);var M=this.getListCfg(),K=this.itemValueField;M.alias="list";M.locksHover=true;M.slot="widgetHostNode";M.listHooks={select:function J(N,O){this.parent.set("selectedValue",O[K]);this.close();}};M.setDimensions=mstrmojo.emptyFn;this.addChildren([M]);F.addWidgetCssClass(this.list,"ctrl-popup-list");},getPopupWidget:function D(){return this.list;},items:null,onitemsChange:function H(){var J=this.items;if(J){this.list.set("items",J);}},selectedValue:"",itemValueField:"n",onselectedValueChange:function C(){var K=this.selectedValue,J=this.itemValueField,L=this.list;L.selectItems(E.filter(L.items||[],function(M){return M[J]===K;}),true);this.updatePreview();},updatePreview:function B(){throw new Error(this.scriptClass+" must implement updatePreview.");},getListCfg:function I(){return{scriptClass:"mstrmojo.ui.PopupList",selectionPolicy:"reselect"};},postBuildRendering:function A(){this.onitemsChange();this.onselectedValueChange();return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.HierarchyCheckList","mstrmojo.ui._HierarchyListSelection","mstrmojo.EnumSelectionType","mstrmojo.hash","mstrmojo.array","mstrmojo._HasTooltip","mstrmojo.dom","mstrmojo.css");var N=mstrmojo.hash,X=mstrmojo.css,J=mstrmojo.array,G=mstrmojo.dom,S=mstrmojo._HasTooltip,A=mstrmojo.EnumSelectionType;var W="dynamic",R="vi-regular vi-tooltip-A hierarchyTooltip",M="hasSelectedDsct";var a=7;function I(e,b,d){var f=[],c={};J.forEach(e,function(h){var g=h.v;if(g>=d){f.push(h);if(b.isLevelSelected(g)){c[f.length-1]=true;}}});return{items:f,selectedIndices:c};}mstrmojo.vi.ui.HierarchyCheckList=mstrmojo.declare(mstrmojo.ui.HierarchyCheckList,[mstrmojo.ui._HierarchyListSelection],{scriptClass:"mstrmojo.vi.ui.HierarchyCheckList",getItemMarkup:function D(c,b){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@tt}"><div class="right"><span class="refresh"></span><span class="branch"></span><span class="level"></span></div><div class="content"><span class="indent" style="padding-left: {@indent}px;"></span><span class="triangle"></span><span class="checkbox"></span><span class="text">{@en@n}</span></div></{@tag}>';},useRichTooltip:true,getItemProps:function Y(d,b){var c=this._super(d,b);if(d.isBranchSelected){c.addCls(W);}if(d.hasDsctSelected){c.addCls(M);}return c;},onclick:function Z(b){var d=b.getTarget(),e=this.getItemNodeFromTarget(d),c=this.getItemFromTarget(d);if(c){if(X.hasClass(d,"triangle")){if(c.hcd){this.doExpandCollapse(e,c);}}else{if(X.hasClass(d,"branch")){this.doElementSelect(e,c,!c.isSelected);}else{if(X.hasClass(d,"level")){this.openLevelPopup(e,c,d);}else{if(!X.hasClass(d,"indent")&&!X.hasClass(d,"refresh")){this.doBranchSelect(e,c,!c.isSelected);}}}}b.cancel();}},showTooltip:function E(b,g){var f=b.target||G.eventTarget(b.hWin,b.e),d=this.getItemFromTarget(f);if(d){var e=G.position(f),c="";this.tooltipOpenDelay=mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY;if(X.hasClass(f,"branch")||X.hasClass(f,"level")||X.hasClass(f,"refresh")){if(X.hasClass(f,"branch")){c=d.isSelected?mstrmojo.desc(15921,"Single Deselect"):mstrmojo.desc(15920,"Single Select");}else{if(X.hasClass(f,"level")){c=mstrmojo.desc(15919,"Level Select");}else{c=mstrmojo.desc(15251,"Dynamic");}}this.richTooltip={cssClass:R,content:c,refNode:f,top:e.h+6,left:-e.w/2};this._super(b,g);return true;}}},onSelectionChange:function K(c,b,d,e){if(c===A.ALL&&b){this.clearSelections();(this.raad?this.getInitialDisplayRoots():this.getRootItems()).forEach(function(f){if(f.v){this.selectionList.push({func:A.BRANCH,itemValue:f.v,isNot:false});}},this);if(this.postSelectionChange){this.postSelectionChange();}}else{this._super(c,b,d,e);}},updateItemNodesStatus:function O(){var b=this.itemsContainerNode&&this.itemsContainerNode.childNodes;this._super();J.forEach(b,function(d){var c=this.getItemFromTarget(d);if(c){X.toggleClass(d,W,c.isBranchSelected);X.toggleClass(d,M,c.hasDsctSelected);}},this);},getSummaryText:function L(){return"";},getLevels:function F(){return[];},getLevelItems:function B(c){var e=this.getLevels(),f=c?[{v:-1,n:mstrmojo.desc(15824,"All Levels")}]:[];if(e.length>0){return f.concat(e);}var b=this.getMaxLevel();for(var d=0;d<=b;d++){f.push({v:d,n:mstrmojo.desc(493,"Level")+" "+(d+1)});}return f;},postBuildRendering:function V(){var d=this.levelPopup,c=this.domNode;if(!d){var b=this.getLevelPopupConfig(),e=N.walk(b.scriptClass,window);delete b.scriptClass;d=this.levelPopup=new e(b);this.addDisposable(d);}d.placeholder=c.insertBefore(document.createElement("div"),c.firstChild);d.render();return this._super();},unrender:function U(b){var c=this.levelPopup;if(c){c.unrender(b);}return this._super(b);},onScrollEnd:function C(){var c=this.levelPopup,b=c&&c.getPopupWidget();if(b&&b.visible){c.closePopup();}this.hideTooltip();},openLevelPopup:function Q(f,d,c){var e=this.levelPopup,b=e.getPopupWidget();if(e&&d.hcd&&this.isHiearachyDisplay()){e.openPopup(b,{branch:d,branchNode:f});if(c){b.domNode.style.left=c.offsetLeft+"px";b.domNode.style.top=c.offsetTop+c.offsetHeight-this.scrollNode.scrollTop+"px";}}},getLevelPopupConfig:function P(b){return N.copy(b,{scriptClass:"mstrmojo.ui.PopupButton",markupString:'<div id="{@id}" class="level-popup-btn" mstrAttach:click></div>',isHostedWithin:false,useRichTooltip:true,parent:this,widget:this,richTooltip:null,children:{scriptClass:"mstrmojo.ui.PopupWidget",alias:"levelPopup",visible:false,children:[{scriptClass:"mstrmojo.ui.CheckList",alias:"checklist",doItemSelect:function f(n,l){var k=this.parent,o=k.opener.widget,m=!this.selectedIndices[n._renderIdx];if(k.branch&&k.branchNode){o.doBranchLevelSelect(k.branchNode,k.branch,n.v,m);}else{o.doLevelSelect(n.v,m);}mstrmojo._IsList.doItemSelect.call(this,n,l);},onclick:function j(k){if(!X.hasClass(k.getTarget(),"refresh")){mstrmojo._IsList.onclick.call(this,k);}},getItemMarkup:function i(k){return mstrmojo.ui.CheckList.prototype.getItemMarkup.call(this,k).replace('<span class="text">{@en@n}</span>','<span class="refresh"></span><span class="text">{@en@n}</span>');}}],onOpen:function c(){var m=this.opener.widget,k=this.branch,l=I(m.getLevelItems(),m.getLevelSelection(k),k&&k.lv+1||0);this.checklist.set("items",l.items);this.checklist.set("selectedIndices",l.selectedIndices);}},getPopupWidget:function d(){return this.levelPopup;},onPopupWidgetOpened:function e(){X.addClass(this.levelPopup.branchNode,"level-popup-open");},onPopupWidgetClosed:function g(){X.removeClass(this.levelPopup.branchNode,"level-popup-open");},showTooltip:function h(k,o){var n=k.target||G.eventTarget(k.hWin,k.e),m=G.position(n),l=mstrmojo.desc(15919,"Level Select");this.tooltipOpenDelay=mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY;this.richTooltip={cssClass:R,content:l,refNode:n,top:m.h,left:-m.w/2};S.showTooltip.call(this,k,o);}});},getAllButtonConfig:function H(c,b){return N.copy(b,c?{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(3474,"Select All"),alias:"selectAllBtn",cssClass:"selectAll",widget:this,onclick:function(){this.widget.doAllSelect(true);}}:{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1763,"Clear All"),alias:"clearAllBtn",cssClass:"clearAll",widget:this,onclick:function(){this.widget.doAllSelect(false);}});}});}());(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo.hash");mstrmojo.CheckList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.CheckList",inputType:"checkbox",cssClass:"mstrmojo-CheckList",itemCssClass:"mstrmojo-CheckList-item"});mstrmojo.CheckListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.CheckListHoriz",inputType:"checkbox",cssClass:"mstrmojo-CheckListHoriz",itemCssClass:"mstrmojo-CheckListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList");mstrmojo.RadioList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.RadioList",inputType:"radio",cssClass:"mstrmojo-RadioList",itemCssClass:"mstrmojo-RadioList-item",onenabledChange:function A(B){for(var C=0;C<this.items.length;C++){this._getItemNode(C).firstChild.disabled=!B.value;}}});mstrmojo.RadioListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.RadioListHoriz",inputType:"radio",cssClass:"mstrmojo-RadioListHoriz",itemCssClass:"mstrmojo-RadioListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.TreeNode","mstrmojo._IsExprNode","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo.expr","mstrmojo._HasOwnAvatar");var F=mstrmojo.array,M=mstrmojo.expr,P=mstrmojo.dom,A=mstrmojo.css;function J(R,Q){var U=R.data,S=U&&U.nds;if(!S){return null;}if(Q){Q.sort(F.numSorter);}else{Q=R.sortSelectedIndices();}if(!Q.length){return null;}return{idxs:Q,nds:F.get(S,Q)};}function N(S){var R=S.ctxtBuilder,V=R&&R.itemWidgets,Q=V&&V[0],U=Q&&Q.data;if(U&&U.not&&(V.length>0)){delete U.not;Q.paint();}}mstrmojo.AndOrNode=mstrmojo.declare(mstrmojo.TreeNode,[mstrmojo._IsExprNode,mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.AndOrNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},itemsContainerPrefix:function(){return this.domNode.childNodes[1];},itemsContainerNode:function(){return this.domNode.childNodes[2].firstChild;},dropCueNode:function(){return this.domNode.childNodes[2].lastChild;},itemsContainerSuffix:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onitemCntChange:function(){A.toggleClass(this.itemsContainerNode,["multi"],this.itemCnt>2);},onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();},ondropCuePosChange:mstrmojo.TreeNode.prototype.markupMethods.ondropCuePosChange},multiSelect:true,itemIdField:null,init:function(Q){this._super(Q);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());var R=this.data;if(R){delete this.data;this._set_data(null,R);}},itemCnt:0,postBuildRendering:function(){var Q;this.set("itemCnt",this.items.length);if(this._super){Q=this._super();}N(this);return Q;},preadd:function L(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},preremove:function O(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},_set_data:function(U,Q){var R=this.data,S=(R!==Q);if(S){this.data=Q;if(Q&&!Q.nds){Q.nds=[];}this.set("items",Q&&Q.nds);}return S;},isDragValid:function K(){return true;},isSelectableArea:function(Q){return false;},getDragData:function(Q){var S=this._super(Q);if(S&&!S.html){var R=S.et&&M.ET2TGT[S.et];S.html=R?S[R]&&S[R].n||"":S.n||"";}return S;},remove:function I(R,S){var Q=this._super(R);if(Q>-1){var U=S||this.suppressConsolidation;if(!U){this.consolidate(false);}}return Q;},move:function(R,Q){this.suppressConsolidation=true;var S;if(this._super){S=this._super(R,Q);}this.suppressConsolidation=false;return S;},consolidate:function E(){var V=this.parent;if(!V||!V.remove){return ;}var S=this.items,R=S&&S.length;if(R<2){var U=R?S[0]:null,Q=this.childIndex();if(U){V.add([U],Q);}V.remove(this.data);}},indent:function G(S,Q){var R=J(this,S);if(!R){return ;}this.remove(R.idxs,true);var X=R.nds,W=Q&&Q.fn||this.data&&this.data.fn,V={et:M.ET.ANDOR,nds:X,fn:W};if(X.length===2&&X[0].not){if(X[1].not){delete X[0].not;delete X[1].not;V.not=true;V.fn=(W===M.FN.AND?M.FN.OR:M.FN.AND);}else{var U=X[0];X[0]=X[1];X[1]=U;}}this.add([V],R.idxs[0]);this.consolidate(false);},outdent:function C(R){var S=this.parent,Q=S&&S.data;if(!Q||Q.et!==M.ET.ANDOR){return ;}var U=J(this,R);if(!U){return ;}this.remove(U.idxs,true);if(this.data.not){U.nds[0].not=true;}S.add(U.nds,this.childIndex());this.consolidate(false);},edit:function D(a,b,S){if(!a){return ;}var Z=this.data,Y=Z&&Z.fn,R=a.data,g=R&&R.not;if(!R){R={};a.data=R;}R.not=!!S;if(Y!==b){var Q=Z.nds;if(Q&&Q.length>2){var f=a.childIndex();if(f>0){this.indent([f-1,f],{fn:b});}}else{Z.fn=b;var W=this.ctxtBuilder,V=W&&W.itemWidgets;for(var U=0,X=(V&&V.length)||0;U<X;U++){var e=V[U];if(e){e.paint();}}}}else{a.paint();}},preclick:function H(Q){var S=null,R=P.eventTarget(Q.hWin,Q.e);if(R===this.prefixNode){}else{if(P.contains(this.prefixNode,R,true)){S="andor";}}Q.part=S;},createAvatar:function B(S){var R=document.createElement("div"),U=P.findWidget(S),Q=U.getAvatarNode&&U.getAvatarNode();if(!Q){Q=U.condNode.cloneNode(true);Q.style.boxSizing="border-box";Q.style.width=U.condNode.offsetWidth+"px";}R.appendChild(Q);A.addClass(R,U.avatarCssCls||"mstrmojo-FE mstrmojo-ConditionNode");R.style.zIndex=20;return R;},_ndsToMove:J});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.fx","mstrmojo.TreeNode");var K=mstrmojo.dom,E={0:"closed",1:"opened",2:"leaf"},I=function(R,Q){var N=R.style,M,P,L,S,O;N.display="block";N.height="auto";M=R.offsetHeight;P=Q?M:0;L=Q?0:M;S=Q?"block":"none";N.overflow="hidden";O=new mstrmojo.fx.AnimateProp({target:R,props:{height:{start:L,stop:P,suffix:"px",fn:Math.round,ease:mstrmojo.ease.linear}},onEnd:function(){N.height="auto";N.display=S;},interval:30,duration:300});O.play();};mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<div id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><div class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</div></div>',markupSlots:mstrmojo.hash.copy({displayNode:function(){return this.domNode.firstChild;},checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),markupMethods:mstrmojo.hash.copy({onstateChange:function(L){this.stateNode.className="mstrmojo-TreeNode-state "+(E[this.state]||"closed");if(this.tree.anim&&this.contentRetrieved&&!L){I(this.itemsContainerNode,this.state===1);}else{this.itemsContainerNode.style.display=(this.state===1)?"block":"none";}}},mstrmojo.TreeNode.prototype.markupMethods),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,_set_items:function(N,M){var L=this._super(N,M);if(L&&this.tree.anim){I(this.itemsContainerNode,true);}return L;},onstateChange:function J(){var L=this.tree;if(!this.contentRetrieved&&(this.state==1)){this.set("items",[L.loadingItemCreaterFunc()]);L.getContent(this,this.blockBegin);}else{if((this.state==1)&&L.onNodeExpand){L.onNodeExpand(this);}if((this.state==0)&&L.onNodeCollapse){L.onNodeCollapse(this);}}},toggleState:function G(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function H(L){K.clearBrowserHighlights(L.hWin);return false;},predblclick:function D(L){K.clearBrowserHighlights(L.hWin);return false;},premousedown:function B(M){var R=mstrmojo.dom,O=mstrmojo.dom.eventTarget(M.hWin,M.e),L=this.tree,N=(this.state==2),Q=R.contains(this.itemsContainerNode,R.eventTarget(M.hWin,M.e),true,this.domNode),P=(L.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if((this.isSpecialNode()||!(O==this.checkBoxNode||((O==this.textNode||O==this.displayNode)&&(N||!P))))&&!this.draggable){R.stopPropogation(M.hWin,M.e);}if((O==this.stateNode)||((O==this.textNode||O==this.displayNode)&&!N&&P)){if(!N){this.toggleState();}}else{if(O==this.checkBoxNode||Q){if(this._super){this._super(M);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var L=this.data&&this.data.st;return(L<0);},handleNodeClicked:function F(){var L=this.tree,M=this.parent,N=this.data;switch(N&&N.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin-L.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin+L.blockCount);break;case"-1":case"-2":break;default:if(L.handleNodeClicked){L.handleNodeClicked(N);}}},init:function(L){this._super(L);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var L=function(M){K.preventDefault(window,M||window.event);return false;};K.attachEvent(this.domNode,"mousedown",L);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",browserNodeClass:mstrmojo.TreeBrowserNode,blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st]||"";},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(J){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",J?Math.min(J,this.blockCount):this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField]||[],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<=N){L.push(J.nextItemCreaterFunc(N-P-O+1));}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;if(J.onNodeExpand){J.onNodeExpand(K);}},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.contentRetrieved=true;K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){var J=this;setTimeout(function(){J.getContent(J);},0);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new J.browserNodeClass({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(U){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(U);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=U.added,P=U.removed,Q=[],L=[],K=U.src,N,M,O,V;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,V=S&&S.length;M<V;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}var J=this.selectionParentNode;return J&&J.getSelectedItems();}});}());(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.expr","mstrmojo.dom","mstrmojo.array","mstrmojo.css");var L=mstrmojo.expr,N=mstrmojo.dom,C=mstrmojo.array,A=mstrmojo.css,F=mstrmojo.fe._IsRelationTreeNode.createSetHtml;var M=function(){var U="noRelationOperator",P=this[U],R=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],S=mstrmojo.array.filter(R,function(V){return V&&V[U]!==P&&V.data.et!==L.ET.RLS;}),O=S.length;for(var Q=0;Q<O;Q++){S[Q].set(U,P);}};mstrmojo.fe.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.AndOrNode",markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',getPrefixAndOrToolsMarkup:function(){return(F+this._super());},markupSlots:mstrmojo.hash.copy({createSetNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupSlots)),markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){A.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupMethods)),removeSet:function G(P){var O=P.childIndex(),Q=P.data,R=[Q];if(O>=0){this.remove(O,true);if(Q.nds&&Q.nds.length>0){R=Q.nds;if(Q.not){R[0].not=true;}}else{delete Q.dmy;delete Q.relation;delete Q.applySubExpr;delete Q.relation;delete Q.useSchema;delete Q.dmt;}this.add(R,O);this.consolidate(false);}},createSet:function E(Q,O){var P=this._ndsToMove(this,Q);if(!P){return ;}this.remove(P.idxs,true);var V=P.nds,U;if(V){if(V.length>1){var S={et:L.ET.ANDOR,nds:V};S.fn=this.data.fn;V=[S];U=S.nds[0].not;}else{var W=V[0];if(W&&W.not&&W.et===L.ET.ANDOR){U=W.not;delete W.not;}}}if(O&&O.rq){var R;if(O.isMetric){R=O.cq;mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],O.rq,R);}else{R=O.rq;R.nds=V;if(U){R.not=U;}}this.add([R],P.idxs[0]);}this.consolidate(false);},preclick:function H(O){var R=null,Q=N.eventTarget(O.hWin,O.e),P=this._super(O);if(N.contains(this.createSetNode,Q,true)&&!this.noRelationOperator){R="createSetOpt";}O.part=R||O.part;return P;},preadd:function I(O){if(this._super){this._super(O);}this.updateRelationOperator();},preremove:function K(O){if(this._super){this._super(O);}this.updateRelationOperator();},consolidate:function B(){this._super();this.updateRelationOperator();},postBuildRendering:function J(){var O=this._super();this.updateRelationOperator();return O;},updateRelationOperator:function D(){var O=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],P=!!C.filterOne(O,function(R){return R&&(R.data.et===L.ET.RLS||(R.data.et===L.ET.ANDOR&&R.noRelationOperator));}),Q=this.parent;this.set("noRelationOperator",P);M.call(this);if(Q&&Q.hasRendered&&Q.updateRelationOperator){Q.updateRelationOperator();}},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode");mstrmojo.threshold.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,null,{scriptClass:"mstrmojo.threshold.AndOrNode",cssClass:"adv-threshold",avatarCssCls:"mstrmojo-thresholdRow",onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);},consolidate:function A(){if(this.parent!==this.tree||this.itemCnt===0){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasItemAliases","mstrmojo.WidgetTree","mstrmojo.hash","mstrmojo.expr","mstrmojo.mstr.EnumNodeProperties","mstrmojo.AndOrNode","mstrmojo.ConditionNode");var C=mstrmojo.hash,G=mstrmojo.expr,A=mstrmojo.mstr.EnumNodeProperties,I=G.ET;function E(J){var L=J&&J.src,M=L&&L.data,K=M&&M.et;return(K in G.ETs);}function H(J){return J&&J.et===I.ANDOR&&!(J.node&A.CONDITION);}mstrmojo.FilterExpr=mstrmojo.declare(mstrmojo.WidgetTree,[mstrmojo._HasItemAliases],{scriptClass:"mstrmojo.FilterExpr",allowDrop:E,renderOnScroll:false,itemIdField:null,nodeClassMap:{14:mstrmojo.AndOrNode,"*":mstrmojo.ConditionNode},onBlankClick:function(J){this.clearTreeSelect();},onnodemousedown:function(K){var L=mstrmojo.dom.eventTarget(K.hWin,K.e),M=K.src,J=M.listMapper.findIndex(M,M.itemsContainerNode,L),N=J>=0?M.ctxtBuilder.itemWidgets[J]:null;if(!N||(N.isSelectableArea&&!N.isSelectableArea(L))){this.onBlankClick(K);}},getItemIdentityProp:function(J){return J.et;},itemFunction:function(O,L,P){var K=P.tree,M=K.getItemConfig(O,L,P),N=K.nodeClassMap,J=N[K.getItemIdentityProp(O)]||N["*"];return J&&(new J(M));},getItemConfig:function(S,P,L){var N=this,J=H(S),U=L.tree||L,M=C.walk("tree.editor",U),R=M&&M.docModel,Q=M&&M.xtab,O=Q&&Q.gridInfo,K={data:S,tree:U,parent:L,bindings:{prefixedAndOrEditable:"this.parent.editable"},itemFunction:(J)?L.itemFunction:null,draggable:J?U.draggable:false,dropZone:J?U.dropZone:false,allowDrop:J&&U.dropZone?U.allowDrop:null,allowCopy:J?U.allowCopy:false,editable:U.isEditable?U.isEditable(S):U.editable,makeObservable:J&&L.makeObservable,onclick:U.onnodeclick,onadd:U.onnodeadd,onremove:U.onnoderemove};N.adjustItemName(S,R,O);return K;},getDragData:function(J){var L=this._super(J);if(L&&!L.html){var K=L.et&&G.ET2TGT[L.et];L.html=K?L[K]&&L[K].n||"":L.n||"";}return L;},newCondition:function D(N){N=N||{et:I.AQ};var M=this.selectionParentNode,J;M=(M&&M.hasRendered)?M:this;if(M!==this){J=M.add([N]);}else{var L=this.addCondition([N],null,true);J=L.index;M=L.widget;}var K={widget:M,index:J,data:N};if(this.onNew){this.onNew(K);}return K;},addCondition:function F(L,N){var O=this.items,K=O&&O.length,Q=L&&L.length;if(!Q){return null;}var M,J;if(K&&H(O[0])){M=this.ctxtBuilder.itemWidgets[0];J=M.add(L,null);}else{if(!K&&(Q===1)){M=this;J=0;this.add(L,0);}else{if(K){var P=O[0];this.remove(P);L.unshift(P);}this.add([{et:I.ANDOR,fn:G.FN.AND,nds:L}],0);M=this.ctxtBuilder.itemWidgets[0];J=K?1:0;}}return{widget:M,index:J};},addSingleCondition:function B(K,J){var L=this.addCondition([K],J);return L.widget.ctxtBuilder.itemWidgets[L.index];},ondrop:function(M){if(this._super){this._super(M);}var K=this.items,J=K&&K.length,L=K.concat();if(J>1){if(K.remove){K.remove(0,K.length);}else{this.set("items",null);}this.add([{et:I.ANDOR,fn:G.FN.AND,nds:L}],0);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.hash","mstrmojo.func","mstrmojo.css","mstrmojo.string","mstrmojo.HBox","mstrmojo.Box","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.WidgetTree","mstrmojo.ObjectBrowserDataProvider","mstrmojo.OBList","mstrmojo.FishEyeContainer","mstrmojo.SearchBox2","mstrmojo.Booklet","mstrmojo.IncFetch","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.mstr.ui.IncFetchOBList","mstrmojo.mstr.EnumWebAPIErrorCodes","mstrmojo.DI.DIConstants");var Q=mstrmojo.hash,Z=mstrmojo.func,A=mstrmojo.string,M=mstrmojo.meta.TP,G="5CECE58CC1D549F890EB61C4DB2156A3",W="E0CCB9CF22104A489CBE78D974AFD19E",S=mstrmojo.chart.model.enums.EnumDSSObjectType,L=mstrmojo.array,E=mstrmojo.dom,P=mstrmojo.DI.DIConstants,b=function(j,k,e){var h=j.scrollableIncFetch,g=h?"mstrmojo.mstr.ui.IncFetchOBList":"mstrmojo.OBList",i={scriptClass:g,items:k.items,multiSelect:e};if(h){i.browseConfig={blockBegin:k.bb,blockCount:k.bc,totalSize:k.sz,folderLinksContextId:j.folderLinksContextId,rootFolderID:k.did,browsableTypes:j.browsableTypes,browsableViewMedias:j.browsableViewMedias,dataProvider:j.dataProvider};i.onwaitingChange=function(){if(j.booklet){j.booklet.set("waiting",this.waiting);}};}var f=mstrmojo.insert(i);f.render();return f;},B=function(g,i,e){var f=mstrmojo.ObjectBrowser.widgetHandler||b;return f(g,i,e);},O={success:function(g){var h=this.ob,f=g.items,i=h.pageCache[h.currentPage],e=i._w;i.items=f;e.set("items",f);this.ob=null;this.item=null;window.clearTimeout(h._btm);h.booklet.set("waiting",false);if(h.scrollableIncFetch&&e.scrollNode){e.initScroll();e.updateScrollbars();}},failure:function(e){window.alert(e.getResponseHeader("X-MSTR-TaskFailureMsg"));this.ob.booklet.set("waiting",false);}},V=function(j,i,g){var h=g?-1:1,f=j.pageCache.length,k;for(k=j.currentPage+h;k<f&&k>=0;k+=h){var e=j.pageCache[k];if(e._k===i.k){return{steps:k-j.currentPage,cache:e};}}return null;},D=function(i,h,g,j){var k=i.currentPage+1,f=i.pageCache.length,e;for(e=k;e<f;e++){i.pageCache[e]._w.destroy();delete i.pageCache[e].items;}i.pageCache=i.pageCache.slice(0,k);j._w=g;j._k=h.k;i.pageCache[k]=j;i.cacheChange();},I=function(f){var e=mstrmojo.hash.walk("anc.items.0.items",f);this.set("canGoUp",!(!f.pf||!e));},J=function(i,h,j,g,f){delete i._btm;var e;if(!g){e=B(i,j,i.multiSelect);e.attachEventListener("change",i.id,"navigate");if(i.useDblSelect||i.useBothSglDblSelect){e.attachEventListener("dblclick",i.id,"dblselect");}}else{e=j._w;}i.obList=e;i.booklet.turn(e,f>0);window.setTimeout(function(){i.onBrowsing=false;},300);if(!g){D(i,h,e,j);}i.set("currentFolder",j);i.set("currentPage",i.currentPage+f);i.updateUpButton(j);if(i.scrollableIncFetch&&e.scrollNode){e.initScroll();e.updateScrollbars();}},R=function(g,f,e){var h=V(g,f,false);h=h||V(g,f,true);if(!h){window.clearTimeout(g._btm);g._btm=window.setTimeout(function(){g.booklet.set("waiting",true);},300);e.ob=g;e.item=f;g.getDataProvider().fetchFolderContents(g,f,e);}else{J(g,f,h.cache,true,h.steps);}},C=function(f,g,h,e){R(f,{fid:f.pageCache[f.currentPage].did,blockBegin:g,searchPattern:h,recursive:e},O);},K={success:function(f){var g=this.ob;if(g){window.clearTimeout(g._btm);if(!f.items){f.items=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}var e=function i(j){var m=j.length,k;for(k=0;k<m;k++){var l=j[k];if(l.did===G||l.did===W){l.n=(l.did===G)?mstrmojo.desc(8112):mstrmojo.desc(9277);}if(l.items){e(l.items);}}};if(f.did===G||f.did===W){f.n=(f.did===G)?mstrmojo.desc(8112):mstrmojo.desc(9277);if(f.anc&&f.anc.items){e(f.anc.items);}}if(f&&f.items&&g.browsableViewMedias){var h={};L.forEach(g.browsableViewMedias.split(","),function(j){h[parseInt(j,10)]=true;});f.items=L.filter(f.items,function(j){return(j.t!==S.DssTypeDocumentDefinition)||h[j.dvm];});}if(f&&f.items&&mstrApp&&mstrApp.isSingleTier){f.items=L.filter(f.items,function(j){return(j.st!==772);});}if(g.isImportFromCube){f.items=L.filter(f.items,function(j){return(j.et!==P.DSSExType.DSSEXDISPARK);});}if(f.did&&this.item.k!==f.did){this.item.k=f.did;}J(g,this.item,f,false,1);this.ob=null;this.item=null;}},failure:function(e){this.ob.booklet.set("waiting",false);if(this.ob.onError){this.ob.onError(e);}else{if(e.getResponseHeader){mstrmojo.alert(e.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{var f=e.message;if(e.code==mstrmojo.mstr.EnumWebAPIErrorCodes.MDSVR_E_NO_ID){f=this.ob.parent.title+": "+f;}mstrmojo.alert(f);}}},complete:function(){if(this.ob){this.ob.onBrowsing=false;}}},d=function(g){var f=g.pageCache.length,e;for(e=0;e<f;e++){g.pageCache[e]._w.destroy();}g.pageCache=[];g.currentPage=-1;g.cacheChange();},N=function(h,g,i){var e=h.onBrowseFolder;if(e){e[0][e[1]](g);}if(g&&parseInt(g.acg,10)===33){return ;}var f={};if(g){f.k=g.did;f.fid=g.did;}else{if(h.rootFolderID){f.k=h.rootFolderID;f.fid=h.rootFolderID;}else{if(h.rootFolderType){f.k=h.rootFolderType;f.fty=h.rootFolderType;}else{if(h.folderLinksContextId){f.k=h.folderLinksContextId;}}}}R(h,f,Z.wrapMethods(i,Q.copy(K)));},Y=function(j,e,g){if(!g){return e;}var h=j.showCompletePath,l=e[0],i,f;while(l){var k;for(k=g.length-1;k>=0;k--){if(l.did===g[k].did){g.splice(k,1);l._isSc=true;}}f=l;l._open=true;l=l.items;l=l&&l[0];if(!l){f.lastLeaf=true;}}if(!h){l=e[0];while(l){if(l._isSc){e[0]=l;break;}l=l.items;l=l&&l[0];}}return e.concat(g);},X=function(f,e,g){f._naviInfo=Y(f,e,g);};mstrmojo.ObjectBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ObjectBrowser",rootFolderType:null,rootFolderID:null,sId:null,closeOnSelect:true,browsableTypes:null,browsableViewMedias:null,includeObjectDesc:false,closeable:true,fishEyeVisible:false,searchVisible:true,upButtonVisible:false,currentFolder:null,pageCache:[],currentPage:-1,blockCount:50,canGoUp:true,folderLinksContextId:null,minSearchLength:2,showCompletePath:true,multiSelect:false,onCloseCB:null,onSelectCB:null,onBrowseFolder:null,scrollableIncFetch:false,useBothSglDblSelect:false,displaySaveLabel:false,useOldSearch:false,getDataProvider:function(){if(!this.dataProvider){this.dataProvider=mstrmojo.insert({scriptClass:"mstrmojo.ObjectBrowserDataProvider"});}return this.dataProvider;},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.HBox",alias:"titleBar",cssClass:"mstrmojo-OB-titleTable",children:[{alias:"saveLabel",scriptClass:"mstrmojo.Label",cssClass:"msrmojo-save-label",text:mstrmojo.desc(3178,"Save in:"),bindings:{visible:"this.parent.parent.displaySaveLabel"}},{alias:"title",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-FormatEditor-DropDownButton",cssText:"margin:0px;",popupRef:{scriptClass:"mstrmojo.Popup",alias:"popup",contentNodeCssClass:"mstrmojo-OBNavigatorPopup",cssText:"position:relative;",slot:"popupNode",locksHover:true,onOpen:function(){var e=this.opener.parent.parent,h=this.tree,g=e._naviInfo,f=this.parent.parent.parent.extraDDItems;if(h.items!==g){h._pup=this;this.ob=e;if(f){L.forEach(f,function(j){j.isExtra=true;});g=g.concat(f);}h.set("items",g);}if(e.getRecents&&!mstrApp.isSingleTier){e.getRecents(this);}},children:[{alias:"tree",scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",itemFunction:function(j,e,f){var h=mstrmojo.WidgetTree.prototype.itemFunction(j,e,f);if(j.isExtra){if(j.cssClass){h.cssClass=j.cssClass;}h.onmousedown=j.onmousedown||mstrmojo.emptyFn;return h;}if(j._open){h.state=1;}h._ll=!!j.lastLeaf;h._pup=f._pup;h.onmousedown=function(i){var k=mstrmojo.dom.eventTarget(i.hWin,i.e),l=this._pup;if(k===this.domNode||k===this.textNode){if(!this._ll){N(l.ob,this.data);}l.close();}};h.markupMethods=Q.copy(h.markupMethods);h.markupMethods.onstateChange=function(){var i=this.data.items?this.state:0;this.stateNode.className="mstrmojo-TreeNode-state "+({0:"closed",1:"opened",2:"leaf"}[i]||"closed");this.itemsContainerNode.style.display=(i===1)?"block":"none";};h.useRichTooltip=true;var g=h.postBuildRendering;h.postBuildRendering=function(){if(g){g.call(h);}if(h.textNode.parentNode.clientWidth){h.textNode.style.width=(h.textNode.parentNode.clientWidth-20)+"px";}};h.premouseover=function(l){if(this.useRichTooltip){var k=this.textNode;if(k.clientWidth<k.scrollWidth){var i=E.position(k);this.richTooltip={areaId:this.id,cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_TOPLEFT,content:A.encodeHtmlString(this.data[this.itemDisplayField]),top:i.y-2,left:i.x+i.w+6};}else{this.richTooltip=null;}mstrmojo.dom.stopPropogation(l.hWin,l.e);}return true;};return h;}}]}},{alias:"upButton",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up",title:mstrmojo.desc(1152,"Up One Level"),onclick:function(){this.parent.parent.goUp();},bindings:{enabled:"this.parent.parent.canGoUp",visible:"this.parent.parent.upButtonVisible"}},{alias:"closebtn",scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-OBCloseButton",title:mstrmojo.desc(2102,"Close"),bindings:{visible:"this.parent.parent.closeable"},onclick:function(){this.parent.parent.close();}}]},{alias:"fishEye",scriptClass:"mstrmojo.FishEyeContainer",cssText:"width:100%",bindings:{visible:"this.parent.fishEyeVisible"}},{alias:"searchUpBar",scriptClass:"mstrmojo.HBox",cssClass:"searchBox",children:[{alias:"obSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-charcoalbox mstrmojo-dxsprite",cssText:"margin: 3px 0; ",contentWidget:mstrmojo.all.obList,taskId:"searchMetadata",searchIncFetch:true,enableMatchCase:false,forceResetCache:true,bindings:{minSearchLength:"this.parent.parent.minSearchLength",quickSearch:"this.parent.parent.quickSearch"},serverRequest:function(e,f){this.parent.parent.getDataProvider().serverRequest(e,f);},preFetch:function(){this.objectTypes=this.parent.parent.browsableTypes||this.objectTypes;this.parent.parent.booklet.set("waiting",true);},postFetch:function(){this.parent.parent.booklet.set("waiting",false);},postBuildRendering:function a(){if(this._super){this._super();}this.inputNode.setAttribute("placeholder"," "+mstrmojo.desc(12666,"Search..."));},onUpdateSearchParams:function H(g){var f=this.parent.parent,e=f.sId;if(e){g.sessionState=e;}if(f.useOldSearch){g.quickSearch=0;g.nameWildcards=1;g.sortKey=6;}}}],bindings:{visible:"this.parent.searchVisible"}},{scriptClass:"mstrmojo.Booklet",cssClass:"mstrmojo-OB-booklet",alias:"booklet",hasAnimation:false,bindings:{scrollableIncFetch:"this.parent.scrollableIncFetch"}},{alias:"obIncFetch",scriptClass:"mstrmojo.IncFetch",height:"17px",cssText:"height:0px;overflow:hidden;",visible:false,np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onvisibleChange:function(f){var i=parseInt(this.height,10),e=this.np>1,g={target:this.domNode,props:{height:{start:(e?0:i),stop:(e?i:0),suffix:"px"}},onEnd:function(){if(e){this.target.style.overflow="visible";}}},j=new mstrmojo.fx.AnimateProp(g);this.domNode.style.overflow="hidden";mstrmojo.css.toggleClass(this.parent.domNode,"show-inc-fetch",this.visible);j.play();},onifsChange:function(e){var f=this.np;mstrmojo.hash.copy(e.value,this);if(this.np>1){this.children=null;this.refresh();}if((f<=1&&this.np>1)||(f>1&&this.np<=1)||(f===0&&this.np>0)){this.set("visible",this.np>1);}this.cssText="";}}],destroy:function c(){d(this);if(this._super){this._super();}},postBuildRendering:function(){if(this._super){this._super();}if(this.fishEye&&this.fishEyeVisible){this.fishEye.attachEventListener("selectedIndexChange",this.id,"onFishEyeChange");}var g=this.searchUpBar;if(g&&g.obSearchBox&&this.searchVisible){this.obSearchBox=this.searchUpBar.obSearchBox;this.obSearchBox.attachEventListener("itemsChange",this.id,"onSearchItemsChange");var e=this.obSearchBox.contentWidget||this.obSearchBox;if(!this.scrollableIncFetch){e.attachEventListener("ifsChange",this.id,function(h){if(!this.scrollableIncFetch){this.obIncFetch.set("ifs",h.value);}});}}if(!this.scrollableIncFetch&&this.obIncFetch){var f=this.obIncFetch;f.attachEventListener("fetch",this.id,function(h){f.cp=h.v;f.children=null;f.refresh();C(this,(h.v-1)*this.blockCount+1,this.searchVisible?this.obSearchBox.inputNode.value:"",1);});}mstrmojo.css.addClass(this.domNode,"mstrmojo-ObjectBrowser");},onSearchItemsChange:function(f){var g=f.value,e=this.pageCache[this.currentPage]._w;if(!g||g.length===0){g=[{did:"empty",n:"("+mstrmojo.desc(2210,"")+")",t:"e"}];}else{if(this.browsableViewMedias){var h={};L.forEach(this.browsableViewMedias.split(","),function(i){h[parseInt(i,10)]=true;});g=L.filter(g,function(i){return(i.t!==S.DssTypeDocumentDefinition)||h[i.dvm];});}}e.set("items",g);},navigate:function(l){var e=l.src,n=e.selectedItem,g=this.multiSelect,j=g&&e.getSelectedItems(),k=this,f=l.added&&l.added.length,i=l.removed&&l.removed.length,h=g?j.length===1&&(!i||f):!!n;if(h&&n.did==="empty"){return ;}if(h&&parseInt(n[M],10)===8){if(!this.onBrowsing){this.onBrowsing=true;N(this,n);}}else{if((n&&(!this.useDblSelect||this.useBothSglDblSelect))||j){this.select(g?j:n);}}},browseFolder:function(e,f){N(this,{did:e,n:f});},onFishEyeChange:function(e){this.goToPage(e.value);},goToPage:function(e){if(e<this.pageCache.length&&e!==this.currentPage){var g=e>this.currentPage,f=this.pageCache[e];this.set("currentPage",e);this.booklet.turn(f._w,g);this.set("currentFolder",f);I.call(this,f);}},oncurrentPageChange:function(e){if(this.fishEye){this.fishEye.setSelectedIndex(e.value);}var f=this.pageCache[this.currentPage];this.titleBar.title.set("text",mstrmojo.string.encodeHtmlString(f.n));if(this.searchVisible&&this.obSearchBox){this.obSearchBox.set("rootCacheItems",f.items||[]);this.obSearchBox.set("totalSize",f.sz);this.obSearchBox.set("rootID",f.did);this.obSearchBox.clearSearch();}if(!this.scrollableIncFetch&&this.obIncFetch){this.obIncFetch.set("ifs",{np:Math.floor(f.sz/f.bc)+((f.sz%f.bc>0)?1:0),cp:Math.floor(f.bb/f.bc)+((f.bb%f.bc>0)?1:0)});}},cacheChange:function(){if(this.fishEye&&this.fishEyeVisible){this.fishEye.setItems(this.pageCache);}},browse:function(f,e){Q.copy(f,this);if(this.searchVisible&&this.obSearchBox){this.obSearchBox.clear();}d(this);N(this,undefined,e);},close:function(){var f=this.ctx||this,e=f.onCloseCB;if(e){e[0][e[1]]();}f.set("visible",false);},select:function(f){var e=this.onSelectCB;if(e){e[0][e[1]](f);}if(this.closeOnSelect){this.close();}},dblselect:function U(f){var g=f&&f.src.selectedItem;if(!g||(g&&g.did==="empty")||g[M]===8){return ;}if(this.useBothSglDblSelect){var e=this.onDblSelectCB;if(e){e[0][e[1]](g);}if(this.closeOnSelect){this.close();}}else{this.select(g);}},goUp:function(){if(this.canGoUp){N(this,{did:this.currentFolder.pf});}},updateUpButton:function F(e){I.call(this,e);},oncurrentFolderChange:function(e){var f=e.value;X(this,f.anc.items,f.sc);},refreshContent:function(e){C(this,e);},onError:null,onheightChange:function(){var e=["titleBar","fishEye","searchUpBar","obIncFetch"],g=0,f;for(f in e){g+=parseInt(this[e[f]].domNode.offsetHeight,10);}this.booklet.set("height",parseInt(this.height,10)-g+"px");}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.vi.ui.HierarchyCheckList","mstrmojo.ui._IsIncFetchHierarchyList");var A=mstrmojo.css;mstrmojo.vi.ui.IncHierarchyCheckList=mstrmojo.declare(mstrmojo.vi.ui.HierarchyCheckList,[mstrmojo.ui._IsIncFetchHierarchyList],{scriptClass:"mstrmojo.vi.ui.IncHierarchyCheckList",cssClass:"elementsList"});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.EditableLabel");var A=mstrmojo.css,E=mstrmojo.validation.STATUSCODE;mstrmojo.ui.editors.controls.ComboBox=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",markupMethods:{onenabledChange:function D(){this.txtLabel.set("enabled",this.enabled);this.txtLabel.set("editOnClick",this.enabled);A.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function B(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ComboBox");},updatePreview:function C(){this.txtLabel.set("value",this.selectedValue||"");},updateSelection:function(){this.set("selectedValue",this.txtLabel.value);},validateTextInput:function(F){return true;},txtLabel:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"txtLabel",slot:"previewNode",constraints:{validator:function(){if(!this.parent.validateTextInput(this.value)){return{id:this.id,code:E.INVALID,msg:""};}}},onValid:function(){this.parent.updateSelection();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.css");var C,D=mstrmojo.css;var J=mstrmojo.declare(mstrmojo.ui.PopupList,null,{getItemMarkup:function G(K){if(!C){C=this._super(K).replace(">{@en@n}<","><div>{@en@n}</div><");}return C;},getItemProps:function F(M,K){var L=this._super(M,K);L.addCls("bst"+K);if(K){L.title=M.n;L.n="";}else{L.tt="";}return L;}});mstrmojo.ui.editors.controls.LineStyleButton=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",itemValueField:"id",showThickOption:true,markupMethods:{onenabledChange:function E(){D.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function H(L){this._super(L);var K=["mstrmojo-ui-LineStyle"];if(!this.showThickOption){K.push("no-thick");}D.addWidgetCssClass(this,K);},getListCfg:function I(){return new J({selectionPolicy:"reselect",items:[{n:mstrmojo.desc(2258,"None"),id:"none"},{n:mstrmojo.desc(2259,"Dashed"),id:"1pt dashed"},{n:mstrmojo.desc(2260,"Dotted"),id:"1pt dotted"},{n:mstrmojo.desc(2262,"Thin"),id:"1pt solid"},{n:mstrmojo.desc(2264,"Thick"),id:"2pt solid"}]});},postBuildRendering:function A(){this.borderStyleNode=this.previewNode.appendChild(document.createElement("div"));return this._super();},updatePreview:function B(){var N=this.borderStyleNode,L=this.selectedValue.split(" "),K=this.selectedValue==="conflict";D.toggleClass(this.previewNode,"conflict",K);if(N&&!K){var M=N.style;if(L.length===1){M.borderTopStyle=L[0];if(L[0]==="none"){M.position="static";N.innerHTML=mstrmojo.desc(2258,"None");N.classList.add("ellipsis");}}else{M.borderTopWidth=L[0];M.borderTopStyle=L[1];M.position="";N.innerHTML="";}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.array","mstrmojo.threshold.ThresholdModel");var G=mstrmojo.array;var I=[{n:mstrmojo.desc(5999,"Replace Text"),v:3},{n:mstrmojo.desc(6000,"Quick Symbol"),v:10},{n:mstrmojo.desc(11898,"Replace With Image"),v:4}];var F=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL;function B(N,O,M){this.parent.raiseFormatValueChange(N,O,M);}function E(O){var N=this.parent.model,M=N.threshold;this.replaceType.set("enabled",O);this.replaceText.set("enabled",O);this.replaceSymbol.set("enabled",O);if(!O){delete M[N.getReplaceTypeName()];delete M[N.getReplaceTextName()];}}mstrmojo.threshold.TextGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.threshold.TextGroup",nameRow:undefined,replaceRow:undefined,replaceType:undefined,replaceText:undefined,replaceSymbol:undefined,preBuildRendering:function K(){this._sync=true;if(this._super){this._super();}},postBuildRendering:function A(){if(this._super){this._super();}this._sync=false;},children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"replaceRow",col1Width:"10%",col2Width:"90%",replaceChk:undefined,children:[{scriptClass:"mstrmojo.ui.Checkbox",slot:"col1Node",alias:"replaceChk",oncheckedChange:function D(){E.call(this.parent.parent,this.checked);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:mstrmojo.desc(11888,"Enable Data Replace")}]},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceType",selectedIndex:0,enabled:false,items:I,onenabledChange:function H(){if(this.enabled){B.call(this,"rtp",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(O){var S=O.value,P=O.valueWas,N=this.parent,M=N.replaceText,R=N.replaceSymbol;if(S!==P){var Q=S===1;M.set("visible",!Q);M.set("hint",S===2?mstrmojo.desc(11889,"Image URL"):"");R.set("visible",Q);B.call(this,"rtp",this.items[S].v);}}},{scriptClass:"mstrmojo.TextBox",alias:"replaceText",enabled:false,onenabledChange:function H(){if(this.enabled){B.call(this,"rtxt",this.value);}},onvalueChange:function J(){B.call(this,"rtxt",this.value);var M=this.parent,N=M.replaceType;if(!M.parent.model.threshold.rtp){B.call(this,"rtp",N.items[N.selectedIndex]);}}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceSymbol",selectedIndex:0,isHostedWithin:false,enabled:false,visible:false,items:F,allowHTML:true,getPopupListConfig:function C(){var M=mstrmojo.ui.Pulldown.prototype.getPopupListConfig();M.getItemMarkup=function N(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@n}</{@tag}>';};return M;},onenabledChange:function H(){if(this.enabled){B.call(this,"rtxt",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(M){var O=M.value,N=M.valueWas;if(O!==N){B.call(this,"rtxt",this.items[O].v);}}}],setFormatSource:function L(M){var N=this,O=N.parent.model;this.syncControls(function(){var P=M[O.getReplaceTextName()],S=M[O.getReplaceTypeName()];N.replaceRow.replaceChk.set("checked",!!P);var Q=G.find(I,"v",S);N.replaceType.set("selectedIndex",Q===-1?0:Q);if(S!==10){N.replaceText.set("value",P||"");N.replaceSymbol.set("selectedIndex",0);}else{var R=Math.max(G.find(F,"v",P),0);N.replaceSymbol.set("selectedIndex",R);N.replaceText.set("value","");}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.util.ui.ColorPicker","mstrmojo.ui.editors.controls.ColorList","mstrmojo.ui.editors.controls.ColorWheel","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.TextBoxWithLabel","mstrmojo.ui.ButtonBar","mstrmojo.Button","mstrmojo.css","mstrmojo.util.color");mstrmojo.requiresDescs(16164);var R=1,a=2,S=mstrmojo,B=S.css,U=S.array,W=mstrmojo.util.ui.ColorPicker,J=S.util.color,P=Math.round,Z=R,N=0,D=1,X=2,c="txtColor",f="automatic",i="#ffffff",A="transparent";var F=[{n:mstrmojo.desc(12071,"Color fill"),id:N},{n:mstrmojo.desc(12072,"No fill"),id:D},{n:mstrmojo.desc(12073,"Gradient"),id:X}];function O(){return this.color!==f?this.color:this.autoPreviewColor;}function V(l){return J.getCSSColorString(l);}function b(n,m,l){return mstrmojo.Button.newWebButton(n,l,m,{slot:"buttonNode",cssDisplay:"inline-block"});}function k(m){var n={},l=O.call(this);if(m&&(typeof l==="string")){l=V(l);var o=l.toLocaleLowerCase();m.forEach(function(q,p){if((o===q.id.toLocaleLowerCase())&&(o!==A)){n[p]=true;}});}return n;}function Q(l){return{scriptClass:"mstrmojo.ui.editors.controls.ColorList",items:l,selectedIndices:k.call(this,l),postselectionChange:function(m){var p=m.added;if(p){var o=this.parent,n=this.items[p[0]].id;o.set("color",n);o.colorChanged(n);}}};}function G(l){return"#"+l.replace("#","");}function E(){var l=this.txtColor1,o=this.txtColor2,m=this.color,n=false,p=this.colorStyle;switch(p.items[p.selectedIndex].id){case N:m=G(l.value);break;case D:m=A;break;case X:m={or:this.gradientOrientation.getSelectedItems()[0].id,c1:G(l.value),c2:G(o.value)};n=true;break;}B.toggleClass(this.containerNode,"grad",n);this.set("color",m);}function L(l){this.set("activeColor",l);var m=this[l];U.forEach([1,2],function(o){var n=this[c+o];B.toggleClass(n.domNode,"on",n===m);},this);this.colorWheel.set("color",G(m.value));}function K(l,m,n,o){if(typeof n==="string"){if(n===A){n=i;}}else{if(!!n&&n.c1){n=n["c"+l];}else{n=i;}}n=V(n);return{scriptClass:"mstrmojo.TextBoxWithLabel",alias:c+l,cssDisplay:"block",label:m,autoCorrect:false,maxLength:6,size:6,value:n.replace("#",""),bindings:o,onfocus:function(){L.call(this.parent,this.alias);},onvalueChange:function(p){if(!/^[0-9a-fA-F]{0,6}$/.test(p.value)){this.value=p.valueWas;}else{if(this.value.length===6){var q=this.parent;q.colorWheel.set("color",G(this.value));E.call(q);}}}};}function H(){var o=O.call(this),n="this.parent.colorStyle.items[ this.parent.colorStyle.selectedIndex ].id",s=n+" === "+X,q=n+" !== "+D,w=(this.showNoFill&&o===A)?1:0,t=F.slice(0,this.showGradient?3:2),l=0,m=this.showGradient,u=!!o&&o.c1;if(!this.showNoFill){t.splice(1,1);}if(u){w=U.find(t,"id",X);l=o.or?0:1;}this.addChildren([{scriptClass:"mstrmojo.ui.Pulldown",alias:"colorStyle",selectedIndex:w,items:t,visible:(t.length!=1||(u&&!m)),onRender:function p(){if(!m&&u){this.selectedNode.innerHTML='<div class="mstrmojo-ui-Pulldown-Gradient" style="color:#C0C0C0">'+mstrmojo.desc(16164,"Gradient (Not supported)")+"</div>";}},onitemSelected:function(){E.call(this.parent);}},{scriptClass:"mstrmojo.ui.ButtonBar",alias:"gradientOrientation",items:[{n:mstrmojo.desc(2066,"Horizontal"),id:1,css:"h"},{n:mstrmojo.desc(2069,"Vertical"),id:0,css:"v"}],selectedIndex:l,bindings:{visible:s},postselectionChange:function(x){if(x.added){E.call(this.parent);}}},{scriptClass:"mstrmojo.Button",cssClass:"simpleButton",text:mstrmojo.desc(11658,"Swap"),bindings:{visible:s},onclick:function(){var z=this.parent,y=z.txtColor1,AA=z.txtColor2,x=y.value;y.set("value",AA.value);AA.set("value",x);E.call(z);}},K(1,mstrmojo.desc(12074,"Color HEX:"),o,{visible:q,label:n+" === "+X+' ? "'+mstrmojo.desc(12075,"Color 1 HEX:")+'" : "'+mstrmojo.desc(12074,"Color HEX:")+'";'}),K(2,mstrmojo.desc(12076,"Color 2 HEX:"),o,{visible:s}),{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",alias:"colorWheel",color:(!!o&&!!o.c1)?o.c1:(o||i),onColorPicked:function(x){var y=this.parent;y[y.activeColor].set("value",x.replace("#",""));},bindings:{visible:q}},b(mstrmojo.desc(1442,"Ok"),true,function(){var y=this.parent,x=y.color;if(!x.c1){W.addCustomColor(x);}y.colorChanged(x);}),b(mstrmojo.desc(2140,"Cancel"),false,function(){this.parent.colorCanceled();})]);L.call(this,c+"1");}function e(n){var p=this.sampleNode,o=p.offsetWidth-p.clientWidth,m=p.clientWidth,q=p.clientHeight,s=Math.sqrt(m*m+q*q)-o,l=Math.atan2(q,m)*(-180)/Math.PI+2;p.style.backgroundColor="#FFFFFF";n.display="block";n.top=p.offsetTop+P(q/2)+"px";n.left=p.offsetLeft+"px";n.width=P(s)+"px";n[mstrmojo.dom.CSS3_TRANSFORM]="rotate("+P(l)+"deg)";}function j(){var n=O.call(this),m=this.sampleNode.style;if(n){if(n.c1){var o=B.buildGradient(n.or,n.c1,n.c2);m[B.convertCssToCamelCase(o.n)]=o.v;}else{m.background=n;if(this.showNoFill&&this.noFillNode&&this.enabled){var l=this.noFillNode.style;if(A===n){e.call(this,l);}else{l.display="none";}}}}m.backgroundOrigin="border-box";}mstrmojo.ui.editors.controls.AdvancedColorPicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPicker",markupString:'<div id="{@id}" class="mstrmojo-ui-AdvColorPicker {@cssClass}" style="{@cssText}" mstrAttach:click><div class="acpToolbar"><div class="acpBtn acpSwatchBtn"></div><div class="acpBtn acpPaletteBtn"></div><div class="acpColor"></div><div class="slash"></div></div><div class="acpContent" ></div><div class="acpButtons" ></div></div>',markupSlots:{swatchBtnNode:function(){return this.domNode.firstChild.firstChild;},paletteBtnNode:function(){return this.domNode.firstChild.childNodes[1];},sampleNode:function(){return this.domNode.firstChild.childNodes[2];},noFillNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.nextSibling;},buttonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onpickerModeChange:function M(){Z=this.pickerMode;this.renderContent();},oncolorChange:function d(){j.call(this);},onautoPreviewColorChange:function h(){j.call(this);}},color:"#000fff",showGradient:false,showNoFill:true,showAutomatic:false,autoPreviewColor:null,activeColor:c+"1",swatchBtnNode:null,paletteBtnNode:null,colorStyle:null,gradientOrientation:null,txtColor1:null,txtColor2:null,colorWheel:null,pickerMode:R,init:function g(l){this._super(l);this.pickerMode=Z;},renderContent:function I(){this.showPickerForCurrentMode();},showPickerForCurrentMode:function C(){var n=this;this.removeChildren();var o=Z===R;if(o){var m=W.getBasicColors();if(!this.showNoFill){m.shift();if(m[0]._renderIdx!==0){U.forEach(m,function(q,p){q._renderIdx=p;});}}if(this.showAutomatic&&this.color!==f){this.addChildren([{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4531,"Automatic"),cssClass:"AutomaticOption",onclick:function l(){n.set("color",f);n.colorChanged(f);}}]);}this.addChildren([mstrmojo.hash.copy({alias:"basicColors"},Q.call(n,m)),Q.call(n,(mstrApp&&mstrApp.getPreferredColors)?U.map(mstrApp.getPreferredColors(),function(p){return{n:p,id:p};}):[]),Q.call(n,W.getCustomColors())]);}else{H.call(this);}B.toggleClass(this.swatchBtnNode,"on",o);B.toggleClass(this.paletteBtnNode,"on",!o);this.buttonNode.style.display=o?"none":"block";},colorChanged:mstrmojo.emptyFn,colorCanceled:mstrmojo.emptyFn,onclick:function Y(l){var m=l.getTarget(),n=this.pickerMode;if(m===this.swatchBtnNode){n=R;this.set("pickerMode",n);}else{if(m===this.paletteBtnNode){n=a;this.set("pickerMode",n);}}}});mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC=f;}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.hash","mstrmojo.array","mstrmojo.Button","mstrmojo.Label","mstrmojo.ToolSeparator","mstrmojo.ui.ScrollableContainer","mstrmojo.ui.Pulldown");mstrmojo.requiresDescs(1442,8689,11952,11953,11954,11955,11956,11957,12136);var D=mstrmojo.hash,K=mstrmojo.array,G=mstrmojo.Button.newWebButton,O=function(Q){if(Q){var P=Q.t;return Math.round(P/10)==52||P==115;}return false;},M={},L,E,I,F,H,B=function(){var e=this,U=e.vis,X=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",allowHTML:true,text:mstrmojo.desc(11952,"Use  <span>#</span> to filter the following targets:").replace("#",U.title),visible:true},{scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"VisContainer",cssClass:"mstrmojo-scrollable-container",children:[]},{scriptClass:"mstrmojo.ToolSeparator"},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-filter-type",cssDisplay:"table-cell",alias:"filterType",selectedIndex:(!!H&&H.length>0)&&!E&&!L?1:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(8689,"Filter"),v:true},{n:mstrmojo.desc(11953,"Highlight"),v:false}],onitemSelected:function(h){M.isFilter=h.v;this.isFilter=h.v;e.csl.set("enabled",Q>0&&this.isFilter);e.forType.set("enabled",this.isFilter);},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-type-label",cssDisplay:"table-cell",text:mstrmojo.desc(11954,"data on selection"),visible:true},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-for-type",cssDisplay:"table-cell",alias:"forType",value:0,visible:false,selectedIndex:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(11955,"for #").replace("#",(I[0]||{}).n),v:false},{n:mstrmojo.desc(11956,"for All Data"),v:true}],onitemSelected:function(h){M.forAllData=h.v;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);}},{scriptClass:"mstrmojo.CheckBox",cssClass:"mstrmojo-clear-check",alias:"csl",checked:(L?L.showall:true),cssDisplay:"block",label:mstrmojo.desc(11957,"Allow users to clear all selections"),enabled:false,oncheckedChange:function(){M.clearAll=this.checked;}}],R=U.parent.children,b,Z={},Q=0,V=function(l){var k=R[l],j=k.boxContent,n=j.isVisMap,o,p,h,m;if(H){o=mstrmojo.array.find(H,"k",k.k)!==-1;}else{if(I.length>0){if(I[0]&&I[0].sc&&I[0].sc.tks){o=I[0].sc.tks.indexOf(k.k)>-1;}}}Q+=o?1:0;if(k!==U&&O(k.defn)){p=k.boxContent.getFilterType();h=k.boxContent.model.getSelectorControlMapInfo();if(n){m=j.getAllLayerKeys(true);K.forEach(m,function(i){Z[i]={c:false,v:o,ft:p,cgbs:h};});}else{Z[k.k]={c:false,v:o,ft:p,cgbs:h};}X[1].children.unshift({scriptClass:"mstrmojo.CheckBox",cssDisplay:"block",label:k.title,checked:o,oncheckedChange:function(){var i=this.checked;if(n){m=j.getAllLayerKeys(true);K.forEach(m,function(q){Z[q]={c:true,v:i,ft:p,cgbs:h};});}else{Z[k.k]={c:true,v:i,ft:p,cgbs:h};}M.targetKeys=Z;Q+=this.checked?1:-1;e.forType.set("enabled",Q>0&&e.filterType.isFilter);e.filterType.set("enabled",Q>0);e.csl.set("enabled",Q>0&&e.filterType.isFilter);}});}};for(b=R.length-1;b>=0;b--){V(b);}var Y=U.boxContent,f=Y&&Y.isVisMap;if(f){var c=mstrmojo.desc(14751,"Use % of <span>#</span> to filter the following targets:"),S=c.split("%"),a=S&&S.length,g,P,W,d=K.map(Y.getGraphicLayerNameArr(),function(h){return{n:h.n,v:h.k};});if(a!==2){return ;}g=S[0].replace("#",U.title);P=S[1].replace("#",U.title);W={scriptClass:"mstrmojo.HBox",cssClass:"",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",allowHTML:true,text:g,visible:true},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"",cssDisplay:"table-cell",alias:"sourceLayer",selectedIndex:K.find(d,"v",Y.getKeyForTemplateSelection()),isHostedWithin:true,enabled:true,items:d,onitemSelected:function(h){M.layerKey=h.v;M.isLayerChanged=h.v!==Y.getKeyForTemplateSelection();}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",allowHTML:true,text:P,visible:true}]};X.splice(0,1,W);}this.addChildren(X);this.targetKeys=Z;};mstrmojo.vi.ui.editors.VisAsFilterDialog=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.VisAsFilterDialog",title:mstrmojo.desc(12136,"Filtering options"),cssClass:"mstrmojo-vis-as-filter",btnAlignment:"right",vis:null,buttons:null,modal:true,visible:false,help:"filtering_options_dialog_box_html5.htm",onOpen:function C(){this.VisContainer.onOpen();},postBuildRendering:function A(){this._super();M={};},toggleFields:function J(){if(I.length!==0){this.forType.set("visible",true);this.filterType.set("enabled",true);}if(H&&H.length>0){this.filterType.set("enabled",true);}if(L){this.csl.set("enabled",true);}},preBuildRendering:function N(){var U=this,P=U.id,W=U.vis,V=W.boxContent,S=V.isVisMap,R=S?V.getWidgetForTemplateSelection().node.defn:W.defn,Q=V.model;I=(Q.getSelectorControlMapInfo?Q.getSelectorControlMapInfo():[]);if(I.length>0){L=I[0].sc;F=I[0].did;E=true;}else{H=R.an;L=V.selectorControl||(V.findSelectorControl&&V.findSelectorControl());E=false;}this.set("buttons",[G(mstrmojo.desc(1442,"OK"),function(){if(!D.isEmpty(M)){M.targetKeys=U.targetKeys;M.singleUnit=E;if(E){M.unitId=F;}M.sc=L;W.model.setVisAsFilter(W,M);}mstrmojo.all[P].destroy();},true),G(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.all[P].destroy();})]);B.call(this);this.toggleFields();this._super();}});mstrmojo.vi.ui.editors.VisAsFilterDialog.open=function(Q){var P=mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.editors.VisAsFilterDialog",vis:Q});P.open();};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.string","mstrmojo._FillsBrowser","mstrmojo.Container","mstrmojo.EnumRWUnitType","mstrmojo.Label","mstrmojo.ui.PopupButton","mstrmojo.ui.Pulldown","mstrmojo.vi.ui.TargetSelector","mstrmojo.vi.ui.TruncatedList");var W=mstrmojo.hash,c=mstrmojo.array,D=mstrmojo.css,P=mstrmojo.dom,j=mstrmojo.string,d=mstrmojo.Button.newWebButton,M=mstrmojo.EnumRWUnitType,f=null,K=function(l){var m=this.vis.model,o=l.panelKey,n=this.currentPanelKey||m.getVizContentPanel().k;if(o===n){return ;}if(this.targetContainer.getTargetChildren().length===0){this.goToPage(l);return ;}this._tocNavWarn(l);},C=function(){var l=mstrApp.rootCtrl,u=l.view,o=l.toggleViewBar,t=l.tocPanel,p=l.galleryPanel,m=l.datasetsPanel,q=this.vis.model,w=[],s,n;s=[o,m,p];this.isCPVisible=n=u.isCPVisible;c.forEach(s,function(x){w.push(x&&x.getOpenStatus());});this.panelsIsOpen=w;this.panels=s;if(this.tocEnabled){if(!n){u.setIsCPVisible(true,true);}this.isTocNav=t.visible;t.set("isMasked",false);this.setNavIcon(true,true);}if(q.attachEventListener){this.layoutSelectedSubscription=q.attachEventListener("targetLayoutSelected",this.id,K.bind(this));}},R=function(){var o=this.vis.model,m=mstrApp.rootCtrl.view,n=this.panelsIsOpen,l=this.isCPVisible;c.forEach(this.panels,function(p,q){p.setOpenStatus(n[q],true,undefined,false);});if(this.tocEnabled){if(!l){m.setIsCPVisible(l,true);}this.setNavIcon(false,true);}if(o.detachEventListener){o.detachEventListener(this.layoutSelectedSubscription);}},Z=function(w){var x=w.length,m=this.targetContainer.getTargetChildren(),p=m.map(function(y){return y.key;}).sort(c.stringSorter),s=p.length,l,n,t,q,u,o=[];if(x>s){l=s;n=w;q=true;}else{l=x;n=p;q=false;}for(t=0;t<l;t++){if(w[t]!==p[t]){this.targetContainer.addAndRemoveKeys([this.targetKeys[n[t]]],q);return ;}}for(t;t<n.length;t++){u=this.targetKeys[n[t]];if(u){o.push(u);}}if(o.length){this.targetContainer.addAndRemoveKeys(o,q);}},I=function(l){var m=l.getVizContentPanel()._tgtSelections;if(m){m.notify();}},F=function(l){if(this.options){this.csl.set("enabled",l);this.options.set("enabled",l);}};function V(){var l=this.vis.model,n=this.vis.k,m;if(!this.targetSelector){this.targetSelector=this._createTargetSelector();}else{this.targetSelector.set("hostId",this.id);if(!mstrmojo.all[this.vis.id]){m=l.getLayoutKeyByUnitKey(n);if(m===l.getCurrentLayoutKey()){this.targetSelector.setSourceByKey(n);}}}this.showControlOverlay([this.targetSelector]);this.targetSelector.enterSelectMode();}function Q(){var n,o=this.sc,l=o&&o.isNavigation&&o.navPage,m=this.options;if(this.vis.model.getVizContentPanel().children){if(m){m.closeDialog();}delete this.children;this.refresh();if(!l||l===this.currentPanelKey){n=W.valarray(this.targetKeys).filter(function(p){return p.v;}).map(function(p){return p.k;}).sort(c.stringSorter);if(n.length){Z.call(this,n);}}}}function E(m){var l=m.boxContent,u=l.isVisMap,s=u?l.getWidgetForTemplateSelection().node.defn:m.defn,n=l.model,o=(this.srcPanelKey===m.model.getVizContentPanel().k),t,q,p;this.cgbs=p=(n&&n.getSelectorControlMapInfo?n.getSelectorControlMapInfo():[]);if(p.length>0){t=p[0].sc;this.unitId=p[0].did;this.singleUnit=true;}else{q=s.an;t=l.selectorControl||(n&&l.findSelectorControl&&l.findSelectorControl());this.singleUnit=false;}this.cachedFiltertypeIndex=(!!q&&q.length>0)&&!this.singleUnit&&!t?1:0;if(f===null){f=o&&(t?t.showall:true);}this.sc=t;this.an=q;}mstrmojo.vi.ui.InlineDialogBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser],{scriptClass:"mstrmojo.vi.ui.InlineDialogBase",cssClass:"mstrmojo-inline-dialog",title:mstrmojo.desc(12136,"Filtering options"),targetKeys:null,vis:null,buttons:null,origTargetKeys:[],changes:{},sc:null,singleUnit:null,cgbs:null,unitId:null,an:null,panelsIsOpen:null,panels:null,isCPVisible:null,srcPanelKey:null,shouldNavigate:true,cachedFiltertypeIndex:0,numBoxesChecked:0,optionsStateForRefresh:{openOnRefresh:false,showAll:false},layoutSelectedSubscription:null,tocEnabled:true,isTocNav:false,isOnTocChange:false,selectFilters:false,targetSelector:null,markupString:'<div id="{@id}" class="mstrmojo-Dialog-Bar {@cssClass}" tabindex="0" mstrAttach:click><div class="win mstrmojo-bar"><div class="mstrmojo-bar-content"></div><div class="mstrmojo-bar-buttons"></div></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[0];},buttonNode:function(){return this.domNode.firstChild.lastChild;}},init:function i(m){if(this._super){this._super(m);}this.srcPanelKey=this.vis.parent.k;var l=this.vis.model;if(l.attachEventListener){l.attachEventListener("buildBoxLayoutComplete",this.id,this.buildBoxLayoutComplete);}},buildBoxLayoutComplete:function k(){var l=this.vis.model;if(this.tocEnabled&&!this.isTocNav){this.setNavIcon(true,true);}Q.call(this);if(this.isOnTocChange){var n=l.getVizContentPanel()._tgtSelections,m=W.valarray(this.targetKeys).filter(function(o){return o.v;}).map(function(o){return o.k;});if(n){c.forEach(m,function(o){l.getUnitInstance(o,1).parent.toggleBoxSelection(true);if(!n.toggleSelection(o)){n.toggleSelection(o);}});this.isOnTocChange=false;}}I(l);},_createTargetSelector:function e(){return new mstrmojo.vi.ui.TargetSelector({alias:"targetSelector",orientation:"h",hostId:this.id,srcId:this.vis.id});},_createOptionsButton:function H(){var o=this,q=o.vis,m=q.model,n=(this.srcPanelKey===(this.currentPanelKey||m.getVizContentPanel().k));return{scriptClass:"mstrmojo.ui.PopupButton",alias:"options",cssDisplay:"inline-block",isHostedWithin:false,anchorSlot:"btnNode",markupString:'<div id="{@id}" class="mstrmojo-ui-OptionsButton {@cssClass}" style="{@cssText}"><div class="opts" mstrAttach:click></div></div>',markupSlots:{btnNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},onRender:function(){if(this._super){this._super();}D.toggleClass(this.domNode,"disabled",!this.enabled);},onenabledChange:function(){D.toggleClass(this.domNode,"disabled",!this.enabled);},getPopupWidget:function p(){return this.optionEditor;},getPopupConfig:function l(){var t=mstrmojo.ui.PopupConfig.ENUM_CORNERS,s=this.constructor.prototype.getPopupConfig.call(this);s.alignment={host:t.BOTTOM_RIGHT,popup:t.TOP_RIGHT};return s;},openDialog:function(){var t=o.optionsStateForRefresh,s=this.optionEditor;if(t.openOnRefresh){t.openOnRefresh=false;s.clrSel.set("checked",t.showAll);s.open();}},closeDialog:function(){var t=o.optionsStateForRefresh,s=this.optionEditor;if(s.visible){t.openOnRefresh=true;t.showAll=s.clrSel.checked;s.close();}},children:[{scriptClass:"mstrmojo.ui.PopupWidget",alias:"optionEditor",visible:false,onClose:function(){this.clrSel.set("checked",f);this.buttons.enableApply(false);},handleSelectionSubmit:function(s){var t=o.changes;if(s){if(t.clearAll!==undefined){delete t.clearAll;}else{t.clearAll=o.csl.checked;}f=o.csl.checked;I(m);}this.close();},children:[{scriptClass:"mstrmojo.CheckBox",cssClass:"mstrmojo-clear-check",cssDisplay:"inline-block",alias:"clrSel",enabled:false,checked:f,label:mstrmojo.desc(11957,"Allow users to clear all selections"),onenabledChange:function(){if(!n){this.enabled=false;this.set("checked",false);}else{if(!o.filterType.isFilter){this.set("checked",true);}else{this.set("checked",f);}}},oncheckedChange:function(){var s=this.parent;if(s){s.buttons.enableApply(this.enabled&&this.checked!==f);}}},{scriptClass:"mstrmojo.Box",alias:"buttons",cssClass:"buttonBox",children:[d(mstrmojo.desc(8473,"Done"),function(){var s=this.parent.parent;s.handleSelectionSubmit(true);},true,{cssDisplay:"inline-block",enabled:false}),d(mstrmojo.desc(221,"Cancel"),function(){var s=this.parent.parent;s.handleSelectionSubmit(false);},false,{cssDisplay:"inline-block"})],enableApply:function(s){this.children[0].set("enabled",s);}}]}]};},validT:function A(m){if(m){var l=m.t;if(this.selectFilters){return Math.round(l/10)===52||l===M.SELECTOR||l===M.MOJOVISUALIZATION;}else{return Math.round(l/10)===52||l===M.MOJOVISUALIZATION;}}return false;},setNavIcon:function G(o,s){var w=this.vis,p=w.model,u=p.getVizContentPanel().parent.selector,t=p.controller.view,m=t.layoutViewer.docLayout.selector,l=mstrApp.rootCtrl,q=l.tocPanel,n=w.k;if(this.isTocNav){q.setTOCIcon(o,s);}else{if(s||!o){m.setLinkIcon(o,s?p.getLayoutKeyByUnitKey(n):null);}u.setLinkIcon(o,s&&w.defn.pnk);}},getTargetKeys:function(){var l=[];W.forEach(this.targetKeys,function(n,m){if(n.v){l.push(m);}});l.sort(c.stringSorter);return this.origTargetKeys=l;},setTargets:function(x){var p=this.targetKeys,m=this.vis,o=m.model,n=this.currentPanelKey||o.getVizContentPanel().k,q=[],w=this.changes,s=this.singleUnit,t=this.srcPanelKey,l=this.filterType;x=o.updateFilterTargetsForSdp(x);c.forEach(this.an,function(y){if(!p[y.k]){p[y.k]={c:false,v:true};}});W.forEach(p,function(z,y){if(c.some(x,function(AA){return AA===y;})){q.push(y);if(!z.v){z.v=true;z.c=true;}}else{if(z.v){z.v=false;z.c=true;}}});w.filterKeys=q;w.targetKeys=p;w.singleUnit=s;if(s){w.unitId=this.unitId;}if(t!==n){w.isNav=true;w.navPage=n;w.srcKey=t;}w.sc=this.sc;w.isFilter=l&&l.isFilter;var u=mstrmojo.vi.VisualInsightApp.APP_STATES;mstrApp.set("appState",mstrApp.isAppStatePause()?(u.PAUSE|u.SELECTOR_TARGETING):u.SELECTOR_TARGETING);this._setTargetsFunc();},_setTargetsFunc:mstrmojo.emptyFn,isSelectionDirty:function O(o){var m=false,l=o.length,p=this.origTargetKeys,n=this.changes;o.sort(c.stringSorter);Z.call(this,o);if(l===p.length){c.forEach(o,function(s,q){if(s!==p[q]){m=true;return false;}});if(m){return m;}if(l>0){if(this.cachedFiltertypeIndex!==this.filterType.selectedIndex){return true;}if(n.isLayerChanged){return true;}if(n.clearAll!==undefined){return true;}}return false;}return true;},goToPage:function L(l){var m=this.vis.model,n=l.layoutKey,o=l.panelKey;m.raiseEvent({name:"layoutSelected",panelKey:o,layoutKey:n});},_tocNavWarn:mstrmojo.emptyFn,onTocPageChange:function(n){var m,l;if(this._super){this._super(n);}if(this.visible){if(this.srcPanelKey===this.currentPanelKey){m=this.vis.model.getVizContentPanel().children;if(m){l=c.find(m,"k",this.vis.k);if(l!==-1){this.vis=m[l];}}else{return ;}}this.setNavIcon();if(!this.isTocNav){this.setNavIcon(true,true);}this.isOnTocChange=true;Q.call(this);}},open:function X(){var l=this.vis;this.shouldNavigate=false;V.call(this);C.call(this);if(l.setSelectTargetsState){l.setSelectTargetsState(false);}},close:function g(){var m=this.vis;mstrApp.rootCtrl.view.closeInlineDialog();R.call(this);this.targetContainer.addAndRemoveKeys(this.targetContainer.getTargetChildren());var l=mstrmojo.vi.VisualInsightApp.APP_STATES;mstrApp.set("appState",mstrApp.isAppStatePause()?l.PAUSE:l.DEFAULT);f=null;if(m.setSelectTargetsState){m.setSelectTargetsState(true);}},cancel:function a(){var l=this.vis.model,n=l.getLayoutKeyByUnitKey(this.vis.k);var m=mstrmojo.vi.VisualInsightApp.APP_STATES;mstrApp.set("appState",mstrApp.isAppStatePause()?(m.PAUSE|m.SELECTOR_TARGETING):m.SELECTOR_TARGETING);l.raiseEvent({name:"layoutSelected",panelKey:this.srcPanelKey,layoutKey:n});},onwidthChange:function(){if(this.editorNode){this.editorNode.style.width=this.width;}},updateViz:function J(l){this.vis=l;this.srcPanelKey=this.vis.parent.k;this.targetSelector.set("srcId",this.vis.id);this.shouldNavigate=true;Q.call(this);this.shouldNavigate=false;},toggleFields:function U(){var m=this.filterType,l=this.cgbs;if(l.length!==0){this.forType.set("visible",true);}if(this.sc){F.call(this,true);}if(this.srcPanelKey===(this.currentPanelKey||this.vis.model.getVizContentPanel().k)&&(W.keyarray(this.targetKeys).length>0||l.length!==0)){m.set("enabled",true);}else{m.set("enabled",false);m.set("selectedIndex",0);}},_createTruncatedList:function N(){var l=this;return{scriptClass:"mstrmojo.vi.ui.TruncatedList",alias:"targetContainer",cssDisplay:"inline-block",items:[{alias:"defaultItem",cls:"tgtDefault",n:this.selectFilters?mstrmojo.desc(16426,"Click on filters or visualizations to select targets"):mstrmojo.desc(15090,"Click on visualizations to select targets"),key:"-1"}],padding:12,overflowCls:"truncMore",cmCssClass:"mstrmojo-bar-overflow",setWidth:function m(){var q=this.parent,o=this.id,s,t=this.padding,p=parseInt(q.width,10);if(!this.width&&P.position(q.buttonNode).w){c.forEach(q.children,function(u){s=u.domNode;if(s&&u.id!==o){p-=Math.ceil(P.position(s).w+(u.scriptClass==="mstrmojo.ui.Pulldown"||u.alias==="ctrlOverlay"?0:t));}});if(P.isMac()&&(P.isSafari||mstrApp.isWorkstation)){p-=t;}this.width=p+"px";}this.domNode.style.width=this.width;},getAdditionalProperties:function n(p,o){if(o===0&&this.items.length>2){p.addCls("hide");}return p;},updateFields:function(){var p,o=l.filterType&&l.filterType.isFilter;l.numBoxesChecked=this.items.length-1;p=l.numBoxesChecked>0;l.forType.set("enabled",p&&o);F.call(l,p&&o);},getTargetChildren:function(){return this.items.slice(1);},addAndRemoveKeys:function(s,p){var o,t=false,q=this.items;if(p){t=true;c.forEach(s,function(u){if(!u.mp||u.mp===u.k){q.push({n:u.t,cls:!!u.ft?"tgtItem viz":"tgtItem filter",cssClass:!!u.ft?"tgtItem viz":"tgtItem filter",key:u.k});}});}else{c.forEach(s,function(u){o=u?c.find(q,"key",u.k||u.key):-1;if(o>-1){t=true;q.splice(o,1);}});}if(t){this.refresh();this.updateFields();l.setNavIcon(q.length!==1);}}};},_addVis:function Y(m,n){var w=this,l=w.vis,o=m.boxContent,x=o.isVisMap,t=w.cgbs||[],u=w.an,z,s,q,p;if(u){z=mstrmojo.array.find(u,"k",m.k)!==-1;}else{if(t.length>0){if(t[0]&&t[0].sc&&t[0].sc.tks){z=t[0].sc.tks.indexOf(m.k)>-1;}}}w.numBoxesChecked+=z?1:0;if(m!==l&&w.validT(m.defn)){var y=m.defn.t===M.SELECTOR;if(!y){s=o.getFilterType();q=o.model.getSelectorControlMapInfo();}if(x){p=o.getAllLayerKeys(true);c.forEach(p,function(AA){n[AA]={c:false,v:z,ft:s,cgbs:q,t:m.title,k:AA,mp:m.k};});}else{n[m.k]={c:false,v:z,ft:s,cgbs:q,t:m.title,k:m.k};}}},_addChildren:function h(){var z=this,n=z.vis,w=n.model,p={scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-filter-type",cssDisplay:"inline-block",alias:"filterType",selectedIndex:z.filterType?z.filterType.selectedIndex:this.cachedFiltertypeIndex,isHostedWithin:true,isFilter:true,enabled:false,items:[{n:mstrmojo.desc(8689,"Filter"),v:true},{n:mstrmojo.desc(11953,"Highlight"),v:false}],onitemSelected:function(AD){this.isFilter=AD.v;F.call(z,z.numBoxesChecked>0&&this.isFilter);z.forType.set("enabled",this.isFilter);if(this.enabled){I(w);}},onenabledChange:function(){D.toggleClass(this.domNode,"disabled",!this.enabled);}},q=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:mstrmojo.desc(15031,"Use visualization <span>#</span> to").replace("#",j.encodeHtmlString(n.title)),visible:true},p,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-type-label",cssDisplay:"inline-block",text:mstrmojo.desc(15032,"data on selection in"),visible:true},z._createTruncatedList(),{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-for-type",cssDisplay:"inline-block",alias:"forType",value:0,visible:false,selectedIndex:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(11955,"for #").replace("#",(this.cgbs[0]||{}).n),v:false},{n:mstrmojo.desc(11956,"for All Data"),v:true}],onitemSelected:function(AD){z.changes.forAllData=AD.v;},onenabledChange:function(){D.toggleClass(this.domNode,"disabled",!this.enabled);}},z._createOptionsButton()],l=w.getPanel(this.currentPanelKey,this.currentLayoutKey).children||[],u,t={};for(u=l.length-1;u>=0;u--){z._addVis(l[u],t);}var s=n.boxContent,AB=s&&s.mapViewer&&s.isVisMap;if(AB){var AA=j.encodeHtmlString(n.title),AC="Use % of <span>#</span> to % the following targets:",x=mstrmojo.desc(15162,AC),m=x.split("%")||[],o,y=c.map(s.getGraphicLayerNameArr(),function(AD){return{n:AD.n,v:AD.k};});if(m.length!==3){m=AC.split("%");}o=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:m[0].replace("#",AA),visible:true},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"",cssDisplay:"inline-block",alias:"sourceLayer",selectedIndex:c.find(y,"v",s.getKeyForTemplateSelection()),isHostedWithin:true,enabled:true,items:y,onitemSelected:function(AE){var AD=z.changes;AD.layerKey=AE.v;AD.isLayerChanged=AE.v!==s.getKeyForTemplateSelection();I(w);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:m[1].replace("#",AA),visible:true},p,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:m[2].replace("#",AA),visible:true}];q.splice(0,3);q=o.concat(q);}this.addChildren(q);this.targetKeys=t;this.csl=this.options.optionEditor.clrSel;},preBuildRendering:function B(){var o=this,p=o.vis,l=p.model,q,n,m,s;E.call(this,p);q=this.sc;n=this.an;if(this.shouldNavigate&&n&&n.length){m=l.getLayoutKeyByUnitKey(n[0].k);s=q&&q.isNavigation&&q.navPage;if(s&&s!==this.currentPanelKey&&m){this.shouldNavigate=false;l.raiseEvent({name:"layoutSelected",panelKey:s,layoutKey:m});}}this._addChildren();this.addChildren([{scriptClass:"mstrmojo.Box",cssClass:"ctrlOverlay",alias:"ctrlOverlay",slot:"buttonNode"}]);this.toggleFields();this._super();},postBuildRendering:function S(){var l=this.targetContainer,m=this.sc;this.editorNode.style.width=this.width;this._super();this.changes={};if(f!==(m?m.showall:true)){this.changes.clearAll=f;I(this.vis.model);}V.call(this);if(l&&!l.width){l.setWidth();}if(this.options){this.options.openDialog();}},showControlOverlay:function b(n,m){var o=this.ctrlOverlay,q=o.domNode;function p(s){var t=s.children;if(t&&t.length){s.removeChildren();t.forEach(function(u){u.destroy();});}}if(q){var l=["ctrlOverlay","or-h"];if(m){l.push(m);}q.className=l.join(" ");}o.set("visible",true);p(o);o.addChildren(n);D.addClass(this.domNode,"overlay");}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo._HasEditableText","mstrmojo.ui.Pulldown");var K=mstrmojo.array,H=mstrmojo.dom,O=mstrmojo.string,D=mstrmojo.hash,A=mstrmojo.Enum_Keys,C=19,M=A.ENTER,E=A.ESCAPE,N=A.DOWN_ARROW,F=A.UP_ARROW;mstrmojo.ui.SearchablePulldown=mstrmojo.declare(mstrmojo.ui.Pulldown,[mstrmojo._HasEditableText],{scriptClass:"mstrmojo.ui.SearchablePulldown",editableSlot:"selectedNode",allowCustomText:false,isSearching:false,editOnClick:false,init:function Q(W){this._super(W);var R=this.getPopupList();R.renderOnScroll=this.renderOnScroll||R.renderOnScroll;R.renderBlockSize=this.renderBlockSize||R.renderBlockSize;var V=[];if((mstrApp.isWorkstation&&H.isMac())||H.isSafari){V=["clip-safari"];}mstrmojo.css.addWidgetCssClass(this,["mstrmojo-ui-SearchablePulldown"].concat(V));var U=R.constructor.prototype,S=R.getItemProps||U.getItemProps,X=R.getItemMarkup||U.getItemMarkup;R.getItemProps=function(c,Z){var a=this._spft||"",e=c.n,b=e?e.toUpperCase().indexOf(a):-1,Y=function(g){var f=[],h;K.forEach(g.split(";"),function(i){h=i.split(":");if(h.length===2&&h[0].toLowerCase()!=="color"){f.push(i);}});return f.join(";");};if(b===-1){a="";}var d=S.call(this,c,Z);if(this.selectedIndices[Z]){d.style=Y(d.style);}if(e){d.before=e.slice(0,b);d.input=e.substring(b,b+a.length);d.after=e.slice(b+a.length,e.length);}return d;};R.getItemMarkup=function(a,Y){var Z=X.call(this,a,Y);if(a.n&&a.v!=="u;"){return Z.replace("{@en@n}","{@en@before}<span class='sp-highlight'>{@en@input}</span>{@en@after}");}return Z;};this._originalFocusOnPopup=this.focusOnPopup;this.focusOnPopup=false;},onclick:function P(R){if(this._originalFocusOnPopup!==undefined){this.focusOnPopup=false;}if(this.isClickingAnchorSlot(R)){var U=R.e.offsetX>=(this.selectedNode.offsetWidth-C),S=this.getPopupWidget().visible;if(!S||(S&&U)){this.set("isEditing",!S);this._super(R);}else{if(!this.isEditing){this.set("isEditing",true);}}}},setDefaultListAndIndex:function(W,X){var V=this.getPopupList(),S=this.text,R=K.find(W,"n",S);if(R===-1&&!this.allowCustomText){var U=V.items[0]||W[0];R=K.find(W,"n",U.n);}V.set("items",W);if(X){this.set("selectedIndex",R);}},onPopupWidgetClosed:function I(R){this.set("isEditing",false);var S=this.getPopupList(),U=S._oldItems;delete S._oldItems;if(U){this.setDefaultListAndIndex(U,R&&R.pressingEnter);}},_set_selectedIndex:function G(U,R){if(this.allowCustomText&&R===-1){this.selectedIndex=-1;this.onitemSelected(null,R);}else{this.isSearching=false;this._super(U,R,true);if(this.hasRendered){var S=this.selectedNode;this.text=S.innerText||S.textContent;}}return true;},onkeydown:function J(U){this._super(U);var S=window.event||U.e,V=S.keyCode,R=this.getPopupWidget();if(V===M){R.close({pressingEnter:true});}else{if(this._originalFocusOnPopup&&(V===N||V===F)){this.focusOnPopup=true;if(R.focus){R.focus();}R.raiseEvent(U);}}},onkeyup:function B(U){var R=window.event||U.e,V=R.keyCode,S=this.getPopupWidget();this._super(U);if(V===E||V===M){S.close();}else{if(V!==N&&V!==F){this.processSearch();}}},processSearch:function L(){this.isSearching=true;this.hideTooltip();var R=[],U=this.getPopupList(),W=this.selectedNode.innerHTML,X=U._oldItems||U.items,S=W.toUpperCase(),V;S=S.replace(/<BR>/,"");if(S.length>0){K.forEach(X,function(Y){V=Y.n;if(V&&V.toUpperCase().indexOf(S)>-1){R.push(D.clone(Y));}},this);}else{R=X;}U._spft=S;if(this.customizeSearchResult){this.customizeSearchResult(R);}U.set("items",R);if(U.adjustCornersForPopupOverflow){U.adjustCornersForPopupOverflow();}delete U._spft;U._oldItems=X;U.set("visible",U.items.length!==0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Obj","mstrmojo.ui.ButtonBar","mstrmojo.ui.Checkbox","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ThreeColumnContainer");var D=mstrmojo.hash;mstrmojo.vi.models.editors.ControlsViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.editors.ControlsViewFactory",getEditorGroup:function B(H,I){return new mstrmojo.vi.ui.editors.EditorGroup(D.copy(I,{children:H}));},getLabelAndControl:function G(J,K,M,O,L,N){var P=new mstrmojo.Label({text:J,setDimensions:function(S,Q){var R=this.domNode;if(R){R.style.width=Q;}}}),I=P,H=K;if(L){I=K;H=P;}I.slot="col1Node";H.slot="col2Node";return new mstrmojo.ui.editors.controls.TwoColumnContainer(D.copy(N,{col1Width:M||"40%",col2Width:O||"60%",children:[I,H],getLabel:function(){return P;},getCtrl:function(){return this.children.filter(function(Q){return Q!==P;})[0];}}));},getLabelAndControlWithMsg:function C(L,M,P,O,S,H,N,Q){var R=new mstrmojo.Label({text:L,setDimensions:function(X,V){var W=this.domNode;if(W){W.style.width=V;}}}),U=new mstrmojo.Label({text:P?mstrmojo.desc(14548,"Changes will be applied after Desktop is restarted."):"",setDimensions:function(X,V){var W=this.domNode;if(W){W.style.width=V;}},setText:function(V){this.text=V;}}),K=R,J=M,I=U;if(N){K=M;J=R;}K.slot="col1Node";J.slot="col2Node";I.slot="col3Node";return new mstrmojo.ui.editors.controls.ThreeColumnContainer(D.copy(Q,{col1Width:O||"30%",col2Width:S||"30%",col3Width:H||"40%",children:[K,J,I],getLabel:function(){return R;},getCtrl:function(){return this.children.filter(function(V){return V!==R;})[0];},getMessage:function(){return U;}}));},getPulldown:function F(I,L,H,K,J){return mstrmojo.ui.Pulldown.newPulldown(I,function(M,N){L.call(this,M.v,N&&N.v);},H,K,J);},getCheckboxAndLabel:function A(N,L,K){var J=new mstrmojo.ui.Checkbox({checked:N,oncheckedChange:function(){var O=this.checked;K.call(this,O,!O);}});var M=this.getLabelAndControl(L,J,"14px","100%",true);M.cssClass="checkLabel";var I=M.getLabel();I.onclick=function H(){J.onclick();};I.cssDisplay="inline-block";return M;},getButtonBar:function E(J,H,L,K){K=K||{};K.items=J;var I=new mstrmojo.ui.ButtonBar(K);I.singleSelect(H);I.postselectionChange=function(M){var N=this.items,O=N[M.removed&&M.removed[0]];L.call(this,N[M.added[0]],O);};return I;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasLayout","mstrmojo._HasSuggestion","mstrmojo.css");var G=mstrmojo.css,D="clear";function E(){this.searchTriggered(this.inputNode.value);}mstrmojo.ui.SearchBox=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.SearchBox",markupString:'<div id={@id} class="mstrmojo-ui-SearchBox cf {@cssClass}" style="{@cssText}"><input class="mstrmojo-ui-sb-input" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" mstrAttach:keyup,blur,focus/><div class="mstrmojo-ui-sb-btn" mstrAttach:click ></div></div>',markupSlots:{inputNode:function I(){return this.domNode.firstChild;},searchNode:function B(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{inputNode:"20px",searchNode:"20px"},w:{inputNode:"100%",searchNode:"22px"},xt:true},getLayoutOffsets:function(){return{w:2,h:0};},searchNode:undefined,inputNode:undefined,searchDelay:-1,init:function M(P){this._super(P);var O=this.searchDelay;if(O===-1||isNaN(O)){this.searchDelay=parseInt(mstrApp.getSearchAutoCompleteDelay(),10);}},onfocus:function N(O){var P=O.getTarget();if(P===this.inputNode){this.inputNode.placeholder="";G.addClass(this.domNode,"onInputFocus");}},onblur:function H(O){var P=O.getTarget();if(P===this.inputNode){this.inputNode.placeholder="Search...";G.removeClass(this.domNode,"onInputFocus");}},onclick:function L(O){var P=O.getTarget();if(P===this.searchNode){if(this._hasText){this.clearSearch();}else{E.call(this);}}},onkeyup:function A(Q){var P=Q.hWin,U=Q.e||P.event;if(U.keyCode===27){this.clearSearch();return ;}var S=this,O=this.text,V=this.text=this.inputNode.value,R=this._hasText=V.length>0;if(O!==V){G.toggleClass(this.searchNode,[D],R);window.clearTimeout(this._searchTimeoutId);this._searchTimeoutId=window.setTimeout(function(){E.call(S);},this.searchDelay);}},unrender:function F(){this.text="";this._super();},clearSearch:function J(O){this.text=this.inputNode.value="";G.removeClass(this.searchNode,[D]);delete this._hasText;if(!O){E.call(this);}this.postClearSearch();},isClear:function C(){return !this.text||this.text.length===0;},postClearSearch:mstrmojo.emptyFn,searchTriggered:function K(O){}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.hash","mstrmojo.express.ui.SubtotalsWidget","mstrmojo.mstr.EnumDSSXMLDrillType","mstrmojo.ui.menus.EditorConfig","mstrmojo.vi.enums.EnumFeatures");var N=mstrmojo.hash,J=mstrmojo.array,H=mstrmojo.mstr.EnumDSSXMLDrillType,P={STATIC:0,DRILLING:1,SELECTOR_CONTROL:2,HYPERLINK:4,SORT:8,PIVOT:16,EDIT:32,GROUP:64,CALCULATION:128,GROUP_EDIT:256,KEEP_ONLY:512,TOTAL_HEADER:1024},D=mstrmojo.vi.enums.EnumFeatures;function G(Y){return mstrmojo.resolveFeature("web-sort")&&!!(Y&&(Y.mix!==undefined&&Y._e&&Y._e.otp===4));}function S(Z){var d=new mstrmojo.ui.menus.MenuConfig(),c=Z.data,Y=Z.cfg,b=[{n:mstrmojo.desc(1893,"Left"),btp:"l"},{n:mstrmojo.desc(1894,"Right"),btp:"r"},{n:mstrmojo.desc(13834,"To Beginning"),btp:"b"}],a=this.delegateActionToXtab;if(!Y.tabularGrid){b.push({n:mstrmojo.desc(152,"Up"),btp:"u"},{n:mstrmojo.desc(153,"Down"),btp:"d"},{n:mstrmojo.desc(1891,"To Columns"),btp:"2"},{n:mstrmojo.desc(1890,"To Rows"),btp:"1"});}J.forEach(b,function(e){if(Z.xtab.model.isPvtButtonVisible(c,e.btp)){d.addMenuItem(e.n,"xt",function(){a(Z,"pivot",[e.btp]);});}});return d;}function C(b,f){if(!b.onDemandDrillDynamicItems){b.onDemandDrillDynamicItems={};}var e="drill"+f,a=b.onDemandDrillItems,Z=b.onDemandDrillDynamicItems[e];if((!b.onDemandDrillItems||b.shouldUpdateDrillMenus)&&!b.loadingDCM&&b.gridData.odd){b.loadingDCM=true;delete b.shouldUpdateDrillMenus;var d=new mstrmojo.SimpleXHR({async:false});d.request("POST",mstrConfig.taskURL,{success:function c(g){J.forEach(g.dynamicMenus,function(h){b.onDemandDrillDynamicItems[h.n]=h.items;if(h.n===e){Z=h.items;}});a=g.menuItems;b.onDemandDrillItems=a;delete b.loadingDCM;}},{taskId:"RWOnDemandDrill",styleName:"OndemandDrillContextMenusStyle",viewMode:1,usePartDisplay:1,docGridKey:b.k,rwb:b.model.docModel.bs});}var Y=[];J.forEach(Z,function(k){var g=k.idx,h=a[g],j=JSON.parse(h.subMenuIndices||"[]");if(j.length>0){var i=[];J.forEach(j,function(l){i.push(a[l]);});h.items=i;}Y.push(h);});return Y;}function U(Z){var Y="";switch(Z){case H.DssXmlDrillToChild:Y="drillDown";break;case H.DssXmlDrillToParent:Y="drillUp";break;case H.DssXmlDrillToTemplate:Y="drillTemplate";break;}return Y;}function L(Z){var Y=J.filter(Z,function(a){return[H.DssXmlDrillToChild,H.DssXmlDrillToParent].indexOf(a.dt)>-1;});return Y.length>0?"drill":"";}function W(Y){return Y&&Y.mix!==undefined&&!!Y._e;}function E(Y){return Y&&Y.otp===12;}mstrmojo.rw.xtab.XtabMenuConfig=mstrmojo.declare(mstrmojo.ui.menus.MenuConfig,null,{scriptClass:"mstrmojo.rw.xtab.XtabMenuConfig",xtab:undefined,data:undefined,isActionAvailable:function K(Z,Y){return((((Z&&Z.at)||0)&Y)>0);},delegateActionToXtab:function M(Y,b,Z){var a=Y.xtab;a[b].apply(a,[Y.data].concat(Z||[]));},buildXtabMenuConfig:function A(d){var i=this.xtab=d.xtab,b=i.id,c=this.selectedData=d.data=d.data||(i&&d.td&&i.getCellForNode(d.td)),f=i.model.getCellTitleInfo(c),e={xtab:i,data:c,cfg:d},h=this.delegateActionToXtab;this.selectedNode=d.td;if(d.onClose){this.addPopupHandlers(b,mstrmojo.emptyFn,d.onClose);}var j=i.model.getCellLinksInfo(c)||{},a=j.links||[],Y=this.isActionAvailable(c,P.HYPERLINK)&&a.length>0&&(c.slm==undefined),Z=this.isActionAvailable(c,P.DRILLING)&&(c.sdm==undefined)&&!!mstrmojo.resolveFeature(D.WEB_DRILL_AND_LINK),g=(c&&c.mix===undefined&&f.isSrcTitle&&c.otp!==-1&&c.avst>0);if(Z){Z=this.addDrillMenuItem(e)?true:false;}if(Y){a.forEach(function(l,k){this.addMenuItem(l.n||l.url||(l.target&&(l.target.n||l.target.did)),"",function(){h(e,"link",[k]);});},this);}if(Z||Y){this.addSeparator();}if(!mstrApp.isDossier){this.addPivotMenuItem(e);}if(this.supportWebSort()){this.addSortMenuItem(e);}if(g){this.addSeparator();this.addShowTotalMenuItem(e);}if(!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode&&(mstrApp.isOIVM&&mstrApp.isOIVM()&&(E(c)||W(c)))){this.addViewFilterEditor(e);}this.addRemoveMenuItem(e);},addPivotMenuItem:function I(Y){if(this.isActionAvailable(Y.data,P.PIVOT)){var Z=S.call(this,Y);if(Z.menus.length){this.addSubMenuItem(mstrmojo.desc(1889,"Move"),"",this.id,function(){return Z;},Y);this.addSeparator();}}},addDrillMenuItem:function Q(c,e){var g=c.xtab,a=c.data,f=this.delegateActionToXtab,Y=function(h){h.onDemandDrillItems=null;h.onDemandDrillDynamicItems=null;};var b=e?[e]:g.model.getAllDrillPathsForCell(a),d=g.model.getCellTitleInfo(this.selectedData),Z=C(g,d.title.id);if(b.length<1&&Z.length<1){return ;}this.addPopupMenuItem(mstrmojo.desc(145,"Drill"),this.id,function(){var h=new mstrmojo.ui.menus.MenuConfig({menuCssClass:L(b),isHostedWithin:false,supportsScroll:true,alignWithAnchor:true,maxHeight:mstrmojo.dom.windowDim().h-50});J.forEach(b,function(i){if(i&&i.k){if(mstrApp.isDossier&&!i.within){return ;}h.addMenuItem(i.n||"",U(i.dt),function(){g.shouldUpdateDrillMenus=true;f(c,"drill",[i]);Y(g);});}});J.forEach(Z,function(j){if(mstrApp.isDossier){var i=J.filter(j.items,function(k){return k.within;});if(i.length===0){return ;}}h.addPopupMenuItem(j.n,"",function(){var k=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:350,isHostedWithin:false,alignWithAnchor:true,menuCssClass:L(j.items)});J.forEach(j.items,function(l){if(mstrApp.isDossier&&!l.within){return ;}k.addMenuItem(l.n,U(l.dt),function(){g.shouldUpdateDrillMenus=true;f(c,"drill",[l]);Y(g);});});return k;});});return h;});},addViewFilterEditor:function X(Y){if(!mstrmojo.resolveFeature("use-view-filter-editor")){return ;}this.addMenuItem(mstrmojo.desc(3938,"edit view filter..."),"xt",this.delegateActionToXtab.bind(this,Y,"showViewFilter"),Y);},addRemoveMenuItem:function O(Z){if(!mstrmojo.resolveFeature("modify-grid-level-in-documents")){return ;}if(Z.data._e){if(Z.data._e.otp!==4){return ;}}if(Z.data.otp===-1){return ;}if(Z.data._tp){var Y=Z.data._tp._e;if(Y){if(Y.otp===4){return ;}}}this.addSeparator();this.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",this.delegateActionToXtab.bind(this,Z,"removeUnit"),Z);},addSortMenuItem:function V(Y){var c=Y.data,a=this.delegateActionToXtab,d=this.isActionAvailable(c,P.SORT),b=Y.xtab.model,Z=b.isRecursiveAttribute&&b.isRecursiveAttribute(c.id),e=Z&&mstrApp.isAppStateDefault&&mstrApp.isAppStateDefault()&&!mstrApp.isDossier;if(mstrApp.isVI){d=d&&mstrmojo.resolveFeature("web-sort");}if(d){this.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",function(){a(Y,"sort",[true]);},Y);this.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",function(){a(Y,"sort",[false]);},Y);if(e){this.addMenuItem(mstrmojo.desc(15676,"Custom Sort..."),"xt",function(){a(Y,"customSort",[c.axis]);},Y);}}if(!Y.cfg.hideAdvancedSort&&(d||G(c))&&!mstrApp.isDossier){this.addMenuItem(mstrmojo.desc(11099,"Advanced Sort..."),"xt",function(){a(Y,"advSort",[c.axis,Y.ndeInfo]);},Y);}},addShowTotalMenuItem:function F(Y){this.addEditorMenuItem(mstrmojo.desc(6193,"Show Totals"),this.id,this.getSubtotalEditorConfig,N.copy(Y,{isTotals:true}));},getSubtotalEditorConfig:function R(Z){var a=Z.data,c=Z.xtab,Y=c.getBasicSubtotalEditorConfig(a.ast);Y.fnOk=function b(){var e=Y.contents.getSubtotalTypes(),d=c.model;c.controller.onShowTotals(c,d.getShowTotalsUnitAction(a.id,a.otp,e[0],e[1]));};return Y;},supportWebSort:function B(){return !(mstrApp.isVI&&!mstrmojo.resolveFeature("web-sort"));}});mstrmojo.rw.xtab.XtabMenuConfig.ACTION_TYPES=P;mstrmojo.rw.xtab.XtabCellMenuItemContextType=null;}());(function(){mstrmojo.requiresClsP("mstrmojo","Widget","css","dom","num");var I=mstrmojo.css,D=mstrmojo.dom,G=mstrmojo.num;mstrmojo.threshold.ColorMarker=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ColorMarker",markupString:'<div class = "marker {@cssClass}" id="{@id}" style="{@cssText}" mstrAttach:contextmenu,mousedown,mouseover,mouseout></div>',markupMethods:{onleftChange:mstrmojo.Widget.leftMarkupMethod},hovered:false,selected:false,index:undefined,position:0,updatePosition:function E(M){this.set("position",M);},compValue:undefined,updateCompValue:function K(M){this.set("compValue",M);},realValue:undefined,updateRealValue:function F(M){this.set("realValue",M);},select:function(){this.set("selected",true);},unselect:function(){this.set("selected",false);},onselectedChange:function C(M){if(M.valueWas===false&&M.value===true){I.toggleClass(this.domNode,"selected",true);this.parent.onMarkerSelected(this.index);}else{I.toggleClass(this.domNode,"selected",false);this.parent.onMarkerUnselected(this.index);}this.parent.onMarkerUnhovered(this.index);},oncontextmenu:function H(N){D.preventDefault(window,N.e);var M=this,O=M.parent.parent;var P=new mstrmojo.ui.menus.MenuConfig({position:D.getMousePosition(N.e,N.hWin),isHostedWithin:false});P.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){O.bands.remove(M.index);O.markers.remove(M.index);O.update();});this.openPopup(P.newInstance());},onmousedown:function B(M){this.set("selected",!this.selected);},onmouseover:function L(){this.set("hovered",true);},onmouseout:function J(){this.set("hovered",false);},onhoveredChange:function A(M){if(!this.selected){if(M.valueWas===false&&M.value===true){I.toggleClass(this.domNode,"selected",true);this.parent.onMarkerHovered(this.index);}else{I.toggleClass(this.domNode,"selected",false);this.parent.onMarkerUnhovered(this.index);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig");var D=mstrmojo.string,A=mstrmojo.dom,E=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function B(){var K=this,J=K.statusList,F=J&&J.length||0,G=K.statusConfig||new mstrmojo.ui.menus.MenuConfig(),L=function(M){return function(N){K.set("status",M);K.onStatusClick(M);};};if(!G.hasMenuItems()&&F){for(var H=0;H<F;H++){var I=J[H];G.addMenuItem(I.n,I.cls||"",L(I),K);}}else{}if(G.hasMenuItems()){G.alignment=K.alignment||{host:E.BOTTOM_LEFT,popup:E.TOP_LEFT};G.hostId=K.id;G.hostElement=K[K.hostElementName]||K.domNode;K.openPopup(G.newInstance());}}function C(){var F=this.statusConfig||this.statusList&&this.statusList.length>1;this.menuButtonNode.style.display=F?"":"none";}mstrmojo.ui.StatusButton=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.ui.StatusButton",markupString:'<div id="{@id}" class="mstrmojo-StatusButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}"><div class="mstrmojo-Button {@innerIconClass}"  mstrAttach:click><span class="mstrmojo-text"></span></div><div class="menuButton" mstrAttach:click></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;},textSpanNode:function(){return this.domNode.firstChild.firstChild;},menuButtonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onstatusChange:function(){this.textSpanNode.innerHTML=D.encodeHtmlString(this.status&&this.status.n||"");},onstatusListChange:function(){C.call(this);},onstatusConfigChange:function(){C.call(this);}},status:null,statusList:null,statusConfig:null,onclick:function(F){var G=A.eventTarget(F.hWin,F.e);if(A.contains(this.menuButtonNode,G,true)){B.call(this);}else{if(A.contains(this.textNode,G,true)){this.onButtonClick(this.status,F);}}},onButtonClick:mstrmojo.emptyFn,onStatusClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsDropTarget","mstrmojo.EditableLabel","mstrmojo.ui.menus.MenuConfig","mstrmojo.css");var A=mstrmojo.css,N=mstrmojo.dom,M="draggedTab",J="stopDragging",l=1,L=2,p=4,G=8,k=16;function m(q){return function(){A.toggleClass(this.tabStripMenuNode,"active",q);};}function h(AC){var x=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:N.getMaxScrollHeight()}),q=this.getMenuActions(),AA=this.index,t=this.id,u=this.total,y=this.parent,s=function(){var AD=y&&y.getTabs();return AD&&AD.length>AA?AD[AA]:mstrmojo.all[t];};if((q&k)>0){this.addNewTabMenuItem(x);}if((q&p)>0){var z=mstrmojo.desc(3397,"Duplicate"),AB=this.parent.scriptClass;if(AB.indexOf("LayoutTabStrip")>=0){z=mstrmojo.desc(15022,"Duplicate Chapter");}else{if(AB.indexOf("PanelTabStrip")>=0){z=mstrmojo.desc(14923,"Duplicate Page");}}x.addMenuItem(z,"dup",function(){s().tabDuplicated();});}if((q&L)>0){if(AA){x.addMenuItem(mstrmojo.desc(5362,"Move Left"),"lft",function(){s().tabMoved(true);});}if(AA<u-1){x.addMenuItem(mstrmojo.desc(5363,"Move Right"),"rgt",function(){s().tabMoved(false);});}}x.addSeparator();if((q&l)>0){x.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){s().lbl.set("isEditing",true);});}if((q&G)>0){if(u>1){x.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){s().tabDeleted();});}}var w=this.getCustomMenu();if(w&&w.hasMenuItems()){x.addSeparator();x.absorbMenuItems(w);}x.addPopupHandlers(this.id,m(true),m(false));this.showTabMenu(this.updateMenuCfg(x),AC);}mstrmojo.vi.ui.tabs.Tab=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode],{scriptClass:"mstrmojo.vi.ui.tabs.Tab",markupString:'<div id="{@id}" class="mstrmojo-VITab unselectable {@cssClass}" style="{@cssText}" unselectable="on" mstrAttach:contextmenu,click><div><div class="mstrmojo-VITab-tab"></div><div class="mstrmojo-VITab-menu"></div></div></div>',markupSlots:{containerNode:function S(){return this.domNode.firstChild.firstChild;},menuBtnNode:function o(){return this.domNode.firstChild.lastChild;}},markupMethods:{ontitleChange:function I(){this.lbl.set("text",this.title);},onisSelectedChange:function i(){mstrmojo.css.toggleClass(this.domNode,"selected",this.isSelected);},onzIndexChange:function j(){this.domNode.style.zIndex=this.zIndex;}},zIndex:1,menuBtnNode:null,lbl:null,title:"",index:-1,total:-1,isSelected:false,isCutoff:false,isHidden:false,isLeftMost:false,isRightMost:false,leftEdgeHiddenWidth:0,rightEdgeHiddenWidth:0,children:[{scriptClass:"mstrmojo.EditableLabel",alias:"lbl",editOnClick:false,onTextEditComplete:function W(s,q){if(s){this.parent.titleEdited(this.text,q);}}}],postBuildRendering:function Q(){var q=this.isValidMode();if(!q||(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview())){this.draggable=false;}this.lbl.set("editOnDoubleClick",q);this._super();},oncontextmenu:function b(q){this.onclick(q);q.preventDefault();},onclick:function e(q){var t=this.domNode;if(A.hasClass(t,J)){A.removeClass(t,J);return ;}var s=function(){if(this.isValidMode()){this.postTabClicked(this,q);}};if(!this.isSelected){this.tabSelected({success:s.bind(this)});}else{s.call(this);}},postTabClicked:function n(u,s){u=this.findSelectedTab(this)||u;var q=u.menuBtnNode,w=s.getTarget().className===q.className,t;if(w){t=N.position(q);}if(s.name==="contextmenu"||(w&&!(t.x||t.y))){t={x:s.e.clientX,y:s.e.clientY};}if(t){h.call(u,t);}},getMenuActions:function d(){return 0;},getCustomMenu:function Y(){return null;},isDragValid:function R(){return this.parent.children.length>1&&!this.lbl.isEditing&&this.isValidMode();},createAvatar:function U(){var q=document.createElement("div");q.appendChild(this.domNode.cloneNode(true));q.style.margin="-5px 0 0 10px";return q;},addTabDnDStyle:function X(){var q=this.lbl.domNode;if(q&&!this.isSelected){A.addClass(q,M);}},clearTabDnDStyle:function F(){var q=this.lbl.domNode;if(q&&!this.isSelected){A.removeClass(q,M);}},allowDrop:function D(q){var s=q.src.widget;return s&&s.parent===this.parent;},dropTab:function K(q){var u=q.src,t=u.data,s=u.widget;s.clearTabDnDStyle();this.parent.moveTab(t.idx,this.index,t.fromIdx);},ondragenter:function H(s){this._super(s);var u=s.src.data,t=s.src.widget,q=this.index;this.parent.moveTab(u.idx,q);u.idx=q;},ondragover:function a(t){var q=t.tgt.node,s=t.tgtData,u=s&&s.node,w=t.src.widget;if(!s||u!==q){t.tgtData={node:q};}if(w&&!w.isSelected){w.addTabDnDStyle();}},ondragleave:function P(q){this._super(q);var s=q.src.widget;if(s&&!s.isSelected){s.addTabDnDStyle();}},ondragend:function C(q){this._super(q);A.addClass(this.domNode,J);this.dropTab(q);},getDragData:function c(){var t=this.id,q=this.index;return{setAvatarClass:function s(u){var y=mstrmojo.all[t],w=y.avatar;if(w){var x=[y.avatarCssClass,"hasOwnAvatar",u];w.className=x.join(" ");}},fromIdx:q,idx:q};},getDropAvatarIcon:function B(){return"pivot";},isValidMode:function E(){return !((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection())||(mstrApp.allowWebDashboardDesign&&!mstrApp.allowWebDashboardDesign()));},cleanUpAfterTarget:function f(q){this.clearTabDnDStyle();this._super(q);},onAppStateChange:function g(s){var u=this.lbl,t=this.isValidMode(),q=mstrApp.isLayoutPreview(s.value);u.set("isEditing",false);u.set("editOnDoubleClick",t);this.draggable=t&&!q;},onLayoutModeChange:function O(s){var t=this.isValidMode(),q=mstrApp.isLayoutPreview(s.value);this.draggable=t&&!q;},addNewTabMenuItem:function V(q){this.throwAbstractMethodError("addNewTabMenuItem");},findSelectedTab:mstrmojo.emptyFn,tabSelected:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,tabMoved:mstrmojo.emptyFn,tabDeleted:mstrmojo.emptyFn,tabDuplicated:mstrmojo.emptyFn,showTabMenu:mstrmojo.emptyFn,updateMenuCfg:function Z(q){return q;}});mstrmojo.vi.ui.tabs.Tab.ACTIONS={NEW_TAB:k,RENAME:l,MOVE:L,DUPLICATE:p,DELETE:G};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.ME.MetricDataService");mstrmojo.requiresDescs(3224);var Z=["(",")","{","}","-","+","*","/","<",">","|","~",","],I={" ":true,"@":true},Y=null,X=mstrmojo.dom,K=mstrmojo.css,H=mstrmojo.mstr.EnumDSSXMLObjectTypes,D=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,a=mstrmojo.ME.MetricDataService;function O(f){if(!Y){Y={};var e,d;for(e=0,d=Z.length;e<d;e++){Y[Z[e]]=true;}}return Y.hasOwnProperty(f);}function b(f){if(!f){return false;}var d=f.length,e,g;for(e=0;e<d;e++){g=f.charAt(e);if(g==="["){return false;}if(O(g)||I[g]){return true;}}return false;}function A(c){return b(c)?"["+c+"]":c;}function M(g){if(!g){return null;}var c=g.length,f=g.split("["),e=f.length,i,h;if(e===1){return g.split("@");}else{if(e===3){i=f[1];i="["+i.substring(0,i.length-1);h="["+f[2];}else{if(f[0].length===0){var j=f[1],d=j.indexOf("]");i="["+j.substring(0,d+1);if(d===j.length-1){return[i];}else{h=j.substring(d+2);}}else{var j=f[0];i=j.substring(0,j.length-1);h="["+f[1];}}}return[i,h];}var R={8:true,9:true,10:true};var C=function(d,c){return R[d]&&!/^\".*\"$/.test(c)?'"'+c+'"':c;};var F=function(d,c,e){var f=typeof e==="undefined"?true:R[e];if(c.length===2&&c==='""'){return c;}return d.tp===261&&c.length>=2&&f?(/^\s+$/.test(c.substr(1,c.length-2))?c:c.substr(1,c.length-2)):c;};mstrmojo.ME.MetricToken=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}" mstrAttach:contextmenu></span>',active:false,markupMethods:{ondataChange:function(){var f=this.data,e=f.tp||this.dataType,g=this.isEmbeddedFilter(),c=g?"&nbsp;":mstrmojo.string.encodeHtmlString(String(f.v));if(f.v===","){this.domNode.innerHTML=c+"&nbsp;";}else{if(e===259&&f.v==="Desc"){this.domNode.innerHTML="&nbsp;"+c;}else{if(a.isLogicOrCompFunc({v:f.v.trim(),tp:e})){this.domNode.innerHTML="&nbsp;"+c+"&nbsp;";}else{this.domNode.innerHTML=c;}}}K.toggleClass(this.domNode,["mstr"],this.isMstrO());K.toggleClass(this.domNode,["nfn"],!this.isFunction());K.toggleClass(this.domNode,["invalid"],f.sta===-1);K.toggleClass(this.domNode,["embeddedFilter"],g);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);}},oncontextmenu:function V(c){this.closePopup();if(this.isEmbeddedFilter()){var e=new mstrmojo.ui.menus.MenuConfig({position:X.getMousePosition(c.e,c.hWin),isHostedWithin:false,alignWithAnchor:true});var d=this;e.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){var f=d.parent;if(f&&f.editEmbeddedFilterToken){f.editEmbeddedFilterToken(d);}});this.openPopup(e.newInstance());}},isMstrO:function W(){return !!this.data.oi||!!this.data.rfd;},isFunction:function B(){return this.isMstrO()&&(this.data.oi&&this.data.oi.t===H.Function);},isEmbeddedFilter:function J(){var e=this.data.oi,d=e&&e.t,c=e&&e.st;return this.isMstrO()&&d===H.Filter&&c===D.Filter&&e.isEmbedded;},brackets:A,length:function E(){return this.isEmbeddedFilter()?1:this.data.v.toString().length;},isDelimiter:function U(){return this.data.isDelimiter||(this.length()===1&&O(this.data.v));},split2Tokens:function L(g){var f=this.data,e=f&&f.v.toString(),h=e.substring(0,g),c=e.substring(g);return[{v:h,isNew:true},{v:c,isNew:true}];},mergeTo:function N(e){var g=this.data,f=g&&g.v.toString(),c=e.data.v.toString();return{v:f+c,isNew:true};},brackets:A,setItemInfo:function S(c){var e=this.data;e.v=this.brackets(c.n);e.oi=c;e.sta=1;e.isNew=true;this.set("data",e);this.paint();},spliceContent:function P(j,h,e){var i=this.data,g=i&&i.v.toString(),k=g.substring(0,j);h=(h===null||h===undefined)?(g.length-j):h;var c=g.substring(j+h),f=k+(e||"")+c;i.v=f;i.isNew=true;i.sta=1;i.ift=(this.isAttributeToken()||i.at)&&(i.v.indexOf("@")>=0);if(i.ift){i.at=i.oi||i.at;}else{delete i.at;}if(i.tp){this.dataType=i.tp;}delete i.oi;delete i.exv;delete i.extp;delete i.tp;this.set("data",i);this.paint();},isAttributeToken:function G(){return this.data&&this.data.oi&&this.data.oi.t===H.Attribute;},setFormInfo:function Q(e){var f=this.data,c=f.oi||f.at;f.v=this.brackets(c.n)+"@"+this.brackets(e.n);f.exv=e.did;f.extp=8;f.sta=1;f.isNew=true;f.oi=f.at;delete f.at;this.set("data",f);this.paint();}});mstrmojo.ME.MetricToken.isDelimiter=O;mstrmojo.ME.MetricToken.brackets=A;mstrmojo.ME.MetricToken.splitAttrAndAttrForm=M;mstrmojo.ME.MetricToken.quotes=C;mstrmojo.ME.MetricToken.unquotes=F;mstrmojo.ME.MetricToken.QUOTABLE_DATATYPES=R;mstrmojo.ME.MetricToken.argDelimiter={".":",",",":";"}[mstrConfig&&mstrConfig.decimalSep]||",";})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ui.menus.MenuConfig");var A=mstrmojo.func,J=mstrmojo.desc(2177,"Close");function G(L){return function(N,M){M.openMenu(L,N);};}mstrmojo.ui.menus.ToolbarConfig=mstrmojo.declare(mstrmojo.ui.menus.MenuConfig,null,{scriptClass:"mstrmojo.ui.menus.ToolbarConfig",btns:null,hasCloseButton:false,closeButtonText:J,showContextMenu:true,addCloseButton:function E(L){this.hasCloseButton=true;if(L){this.closeButtonText=L;}},preShowMenu:mstrmojo.emptyFn,addToolbarBtn:function I(R,M,P,L,N,Q){var O={n:R,cls:M,fn:P,ctxt:L,ttp:Q};if(isNaN(N)||N>=this.btns.length){this.btns.push(O);}else{this.btns.splice(N,0,O);}return O;},addDisabledToolbarBtn:function I(O,M,L){var N=this.addToolbarBtn(O,(M||"")+" disabled",mstrmojo.emptyFn,L);N.dsbld=true;},addToolbarPickerBtn:function B(R,M,P,Q,L,N){var O={n:R,cls:M,fn:P,ctxt:L,tp:"pb",menufn:G(Q||this)};if(isNaN(N)||N>=this.btns.length){this.btns.push(O);}else{this.btns.splice(N,0,O);}},addMenuToolbarBtn:function H(P,L,O,M,N){if(!O&&!this.hasMenuItems()){return ;}this.addToolbarBtn(P,L,A.composite([this.preShowMenu,G(O||this),(N||mstrmojo.emptyFn)]),null,M);},addToggleToolbarButton:function D(S,O,Q,N,M,R,L){var P=this.getToggleItemStates(S,O,Q,N,R,L);this.addDualStateItem(M,P[0],P[1],true);},addDualStateItem:function K(M,L,N,O){this["add"+(O?"ToolbarBtn":"MenuItem")](L.n,L.cls,this.getDualStateHandler(M,L,N),L.ctxt,undefined,L.ttp);},getDualStateHandler:function C(M,L,N){var O=this._super(M,L,N);return function(P,Q){O.call(this,P,Q);Q.refresh();};},clear:function F(){this.btns=[];this.hasCloseButton=false;this.closeButtonText=J;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.ScrollableContainer","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.Button");var H=mstrmojo.Button.newWebButton,E=mstrmojo.hash,L=mstrmojo.css,J=mstrmojo.dom;var B="grouping",C="highlight",I="disabled";function F(O,Q){J.preventDefault(window,O);J.stopPropogation(window,O);if(this.groupingOverlay.domNode.className.indexOf(C)===-1&&this.domNode.className.indexOf("selected")===-1){return ;}Q=E.copy(Q,{supportsScroll:true,isHostedWithin:false,maxHeight:J.getMaxScrollHeight()});var P=this.parent.getGroupContextMenuConfig(new mstrmojo.ui.menus.MenuConfig(Q),this.k);if(P.hasMenuItems()){this.openPopup(P.newInstance());}}mstrmojo.vi.ui._CanGroup=mstrmojo.provide("mstrmojo.vi.ui._CanGroup",{_mixinName:"mstrmojo.vi.ui._CanGroup",startGrouping:function G(O){L.addClass(this.domNode,B);var Q=this.groupingOverlay;if(!Q){var P=this,S=this.id;this.addChildren({scriptClass:"mstrmojo.ui.ScrollableContainer",cssClass:"groupingOverlay",alias:"groupingOverlay",cssDisplay:"",slot:"domNode",children:[H(mstrmojo.desc(1911,"Group"),function(U){U.cancel();P.groupSelection();},true,{cssClass:"btnGroup",cssDisplay:""}),H("",function(U){var V=mstrmojo.ui.PopupConfig.prototype.ENUM_CORNERS;F.call(mstrmojo.all[S],U.e,{hostId:S,hostElement:this.domNode,alignment:{host:V.BOTTOM_LEFT,popup:V.TOP_LEFT}});},false,{cssClass:"btnMenu",cssDisplay:""})]});this.groupingOverlay.render();var R=this.groupingOverlay.domNode;J.attachEvent(R,"contextmenu",function(U){F.call(P,U,{position:J.getMousePosition(U,window)});});J.attachEvent(R,"click",function(U){var V=U.target;if(V.className.indexOf("mstrmojo-scrollbar")!==-1){J.stopPropogation(window,U);}});}this.setGroupingStatus(O?"":I);this._menuBtnInfo=this.menuBtnInfo;this.menuBtnInfo=null;this._originalContextMenu=this.shouldShowCustomizeContextMenu;this.shouldShowCustomizeContextMenu=function(){return false;};},setGroupingStatus:function K(O){var Q=this,P=[I,C];P.forEach(function(R){L.toggleClass(Q.groupingOverlay.domNode,R,O===R);});},endGrouping:function N(){L.removeClass(this.domNode,B);this.setGroupingStatus("");this.menuBtnInfo=this._menuBtnInfo;delete this._menuBtnInfo;this.shouldShowCustomizeContextMenu=this._originalContextMenu;delete this._originalContextMenu;},initializeDrag:function A(){return this.domNode.className.indexOf(B)===-1;},groupSelection:function D(){this.parent.groupSelection();},widgetResized:function M(){if(this._super){this._super();}var O=this.groupingOverlay;if(O){this.groupingOverlay.updateScrollbars();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.toolbars.Toolbar","mstrmojo.css");var D=mstrmojo.css;var B;mstrmojo.vi.ui.toolbars.TitleToolbar=mstrmojo.declare(mstrmojo.vi.ui.toolbars.Toolbar,null,{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",init:function F(H){this._super(H);D.addWidgetCssClass(this,"mstrmojo-VITitleToolbar");},markupMethods:{onvisibleChange:function A(){var H=this.visible,I=this.domNode;D.toggleClass(I,"visible",H);if(!H){D.onTransitionEnd(I,function(){D.addClass(I,"hidden");});}else{D.removeClass(I,"hidden");}}},getItemMarkup:function E(H){if(!B){B=this._super(H).replace("{@en@n}",'<div class="icn"></div>');}return B;},ontoolbarCfgChange:function G(H){var I=H.value;if(I){if(I.showContextMenu){I.addMenuToolbarBtn("","mnu");}if(I.hasCloseButton){I.addToolbarBtn(I.closeButtonText,"cls",function(K,J){J.parent.close();});}}this._super(H);},onItemContextMenu:function C(H){this.closePopup();if(H.fn){H.fn(H,this);return true;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Stepper","mstrmojo._HasLayout","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.expr","mstrmojo.css");var C=mstrmojo.expr.DTP,B=mstrmojo.css,A="mstrmojo-Stepper-ErrValidation";mstrmojo.ui.editors.controls.Stepper=mstrmojo.declare(mstrmojo.Stepper,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.Stepper",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,mouseup,mousemove,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text"></div><div class="prev">-</div></div>',layoutConfig:{w:{textNode:"100%"},xt:true},textInput:null,init:function E(F){var G=F.provider;if(!!mstrApp.isWSStyling){this.layoutConfig=null;}this.children=[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"textInput",slot:"textNode",dtp:G.dtp||C.INTEGER,maxLength:G.maxLength,constraints:{validator:G.validator,max:G.max,min:G.min},onValid:function(){var H=this.parent;B.removeClass(H.domNode,A);G.setVal(parseInt(this.value,10)||0);H.updateDisplayText();}}];this._super(F);this.addDisposable(G);B.addWidgetCssClass(this,"mstrmojo-ui-ctrl-Stepper");},postBuildRendering:function(){this.updateDisplayText();this._super();},updateDisplayText:function D(){this.textInput.set("value",this.provider.getVal());}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.fx","mstrmojo.locales","mstrmojo.expr","mstrmojo.Button","mstrmojo.date","mstrmojo.ui.editors.controls.Stepper","mstrmojo.css");mstrmojo.requiresDescs(950,1035);var AF=function(){return mstrmojo.locales.datetime;},k=mstrmojo.dom,j=mstrmojo.expr,AC=j.DTP,b=mstrmojo.date,J=mstrmojo.publisher,g=mstrmojo.hash,m=mstrmojo.array,O=m.removeIndices,l=mstrmojo.css;var AE=0,C=3,M=4,p=5,R=6;var N=1,w=2;var AG="month",e="day",X="year",Z="hour",AJ="minute",z="second";var G='<table border="0" cellpadding="0" cellspacing="0">',y="</table>";function P(AK){return'<table border="0" cellpadding="0" cellspacing="0" style="'+AK+'">';}function H(AN,AK,AL){var AM=b.getFirstDateOfMonth(AN,AK);return(AM.getDay()-AL+8)%7;}function n(AN){var AM=b.parseDateAndOrTime(AN),AO,AK,AL;if(AM){AL={};AO=AM.date;AK=AM.time;if(AO){g.copy(AO,AL);}if(AK){g.copy(AK,AL);}}return AL;}function F(AL,AO,AN,AM,AK){var AP=b.formatDateInfo({day:AL,month:AO,year:AN},AF().DATEOUTPUTFORMAT);return b.inDateTimeRange(AP,AM,AK)===0;}function V(AO,AN,AM){var AL=AO.decreaseButton,AK=AO.increaseButton,AP="mstrmojo-Calendar";AL.className=(AP+"-decrease");AK.className=(AP+"-increase");}function Y(AO,AL,AQ,AN){var AM=0,AK=AO.length,AP;for(AM=0;AM<AK;AM++){AP=AO[AM];if(AP&&AP.day===AL&&AP.month===AQ&&AP.year===AN){return AM;}}return -1;}function q(AK,AM,AL){var AN=new Date();return(AN.getFullYear()===AL)&&((AN.getMonth()+1)===AM)&&(AN.getDate()===AK);}function x(AR,AS){var AW=AR.dayView.getElementsByTagName("div"),AU=AR.selectedDates,AM=AU[AS],AV=AR.browseYear,AL=AR.browseMonth,AO=b.getDaysOfMonth(AV,AL),AN=b.getPreMonth(AV,AL),AQ=b.getDaysOfMonth(AN.y,AN.m),AK=H(AV,AL,AR.firstDayOfWeek),AP=((AM.month===AL)?AM.day+AK-1:(AM.month>AL?AM.day+AK+AO-1:AK-AQ+AM.day-1)),AT=AW[AP];if(AT){d(AT,AR,false);}O(AU,AS,1);}function B(AK){var AL=AK.selectedDates;while(AL.length){x(AK,0);}}function AI(AM,AK){var AL=K(AM,AK),AN=AM.selectedDates;AN.push({day:AL.d,month:AL.m,year:AL.y});d(AK,AM,true);}function o(AM,AN){if(!AN||!AN.length){return null;}var AP=AM.selectedDates;for(var AL=0,AK=AN.length;AL<AK;AL++){var AO=AN[AL],AQ=s(AM,AO);AP.push({day:AO.d,month:AO.m,year:AO.y});if(AQ){d(AQ,AM,true);}}}function s(AS,AU){var AW=AS.dayView.getElementsByTagName("div"),AN=AW.length,AV=AS.browseYear,AL=AS.browseMonth,AO=b.getPreMonth(AV,AL),AP=b.getDaysOfMonth(AO.y,AO.m),Aa=b.getNextMonth(AV,AL),AM=b.getDaysOfMonth(AV,AL),AK=H(AV,AL,AS.firstDayOfWeek);var AQ=AK>0?{y:AO.y,m:AO.m,d:AW[0].innerHTML}:{y:AV,m:AL,d:AW[0].innerHTML},AY=(AW.length-AM-AK)>0?{y:Aa.y,m:Aa.m,d:AW[AN-1].innerHTML}:{y:AV,m:AL,d:AW[AN-1].innerHTML},AZ=U(AQ,AU),AR=U(AU,AY),AT=null;if(AZ>=0&&AR>=0){var AX=0;if(AZ<AK){AX=-1;}if(AR<(AW.length-AK-AM)){AX=1;}AT=((AX===0)?AU.d+AK-1:(AX===1?AU.d+AK+AM-1:AK-AP+AU.d-1));return AW[AT];}else{return null;}}function h(AS,AK){var AU=AS.selectedDates,AM=AU.length;if(!AM){return null;}var AL=AU[AM-1],AN=K(AS,AK),AX=U({y:AL.year,m:AL.month,d:AL.day},AN),AY=[],AP=AX>0,AV=Math.abs(AX);for(var AR=0;AR<=AV;AR++){var AQ=new Date(AN.y,AN.m-1,AN.d);AQ.setDate(AQ.getDate()+(AP?-AR:AR));var AW=AQ.getFullYear(),AO=AQ.getMonth()+1,AT=AQ.getDate();if(AS.isDateDisabled(AT,AO,AW,AS.min,AS.max)&&!AS.canSelectDisabledDate){continue;}AY.push({y:AW,m:AO,d:AT});}return AY;}function U(AN,AM){var AK=new Date(AN.y,AN.m-1,AN.d),AL=new Date(AM.y,AM.m-1,AM.d);return(AL-AK)/1000/3600/24;}function K(AM,AK){var AN=AM.browseYear,AP=AM.browseMonth,AO=parseInt(AK.innerHTML,10),AQ=parseInt(AK.getAttribute("m"),10),AL=null;AL=(AQ===0)?{y:AN,m:AP}:(AQ===1?b.getNextMonth(AN,AP):b.getPreMonth(AN,AP));AL.d=AO;return AL;}function i(AK){var AM=AK.selectedDates,AL=AM.length;return(AL===0)?null:AM[AL-1];}function d(AL,AM,AK){var AN=AM.selectedColor;l.toggleClass(AL,["selected",AM.selectedCssStyle],AK);AL.parentNode.style.backgroundColor=AK?AN:"";AL.style.backgroundColor=AK?AN:"";}function AB(AK){return AK.selectedColor?('style="background-color:'+AK.selectedColor+';"'):"";}function Q(AK){return(AK.tagName.toLowerCase()==="td")?AK.firstChild:AK;}function S(AL,AM){var AN=b.getDateJson(AL),AK=b.formatDateInfo(AN,mstrmojo.locales.datetime.DATEOUTPUTFORMAT);if(AM===AC.TIMESTAMP){AK+=" "+b.formatTimeInfo(this.timeVal,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}return AK;}function t(AP,AM){var AK=this.advancedValues,AL=null;AK.set(AP,AM);switch(AK.baseDate){case C:AL=new Date();break;case M:break;case p:break;case R:break;default:return ;}var AN=AK.monthsToAdjust;if(AN>0){AL.setMonth(AL.getMonth()+(AK.toAddMonths?AN:-AN));}var AO=AK.daysToAdjust;if(AO>0){AL.setDate(AL.getDate()+(AK.toAddDays?AO:-AO));}this.set("value",S.call(this,AL,this.dtp));}function W(){var AK=this.advancedValues,AL=["isDyn"];if(AK.baseDate===AE){return null;}AL.push(AK.baseDate);AL.push(AK.toAddDays?AK.daysToAdjust:-AK.daysToAdjust);AL.push(AK.toAddMonths?AK.monthsToAdjust:-AK.monthsToAdjust);AL.push(0);AL.push(0);AL.push(0);AL.push(0);AL.push(this.value);AL.push(this.timeVal.hour);AL.push(this.timeVal.min);AL.push(this.timeVal.sec);return AL.join("::");}function AH(AK){if(AK.value!==undefined&&this.hasRendered){this.updateSelectedDate();}}function I(AM,AL){var AN=this,AK=function(AO){return AO[0].toUpperCase()+AO.substring(1);};return{scriptClass:"mstrmojo.HBox",cssClass:"dateAdjustBox",alias:AM+"AdjustBox",children:[{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:AL>0?0:1,onitemSelected:function(AP,AO){t.call(AN,"toAdd"+AK(AM),AO===0);},items:[{did:0,n:mstrmojo.desc(9424,"plus")},{did:1,n:mstrmojo.desc(9425,"minus")}]},{scriptClass:"mstrmojo.ui.editors.controls.Stepper",width:null,height:null,provider:new mstrmojo.NumStepperContentProvider({item:{interval:1,min:0,value:Math.abs(AL)},onTraverse:function(){t.call(AN,AM+"ToAdjust",this.curVal);}})},{scriptClass:"mstrmojo.Label",text:AM==="days"?mstrmojo.desc(707,"Days"):mstrmojo.desc(710,"Months")}]};}function a(){this.buttonsNode.style.display=(this.wasAdvanced||this.changeValueOnOK||(this.showAdvanced&&this.isAdvanced)?"block":"none");this.advancedNode.style.display=this.showAdvanced?"block":"none";}mstrmojo.Calendar=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Calendar",cssPrefix:"",browseMonth:null,browseYear:null,yearRangStart:null,selectedDates:null,selectedColor:"",isMultiSelect:false,hilightToday:false,yearViewSize:5,cssTextDay:"",cssTextMonth:"",cssTextYear:"",cssTextWeekDay:"",cssTextHeader:"",cssTextMonthYearLabel:"",forceNonEmptySelection:false,showCurMonthDatesOnly:false,currentView:e,duration:600,timeDelimiter:":",dtp:AC.DATE,value:"",firstDayOfWeek:1,changeValueOnOK:false,wasAdvanced:false,showAdvanced:false,isAdvanced:false,dynDateValue:null,canSelectDisabledDate:false,monthNames:function(AK){return AF().MONTHNAME_SHORT[AK];},dayNames:function(AK){return AF().dayShortNames[AK];},min:null,max:null,supportedViews:{day:true,month:true,year:true,hour:true,minute:true,second:true},sDirMatrix:{day:{month:"down",year:"down",hour:"up",minute:"up",second:"up"},month:{day:"up",year:"left",hour:"up",minute:"up",second:"up"},year:{day:"up",month:"right",hour:"up",minute:"up",second:"up"},hour:{day:"down",month:"down",year:"down",minute:"left",second:"left"},minute:{day:"down",month:"down",year:"down",hour:"right",second:"left"},second:{day:"down",month:"down",year:"down",hour:"right",minute:"right"}},markupString:'<div id="{@id}" class="{@cssPrefix} mstrmojo-Calendar {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,mouseover,mouseout><div class="mstrmojo-Calendar-header" style="{@cssTextHeader}"><div class="mstrmojo-Calendar-decrease"></div><div class="mstrmojo-Calendar-increase"></div><div class="mstrmojo-Calendar-title"><span class="mstrmojo-Calendar-monthLabel" style="{@cssTextMonthYearLabel}">{@browseMonth}</span><span class="mstrmojo-Calendar-yearLabel" style="{@cssTextMonthYearLabel}">{@browseYear}</span></div></div><div class="mstrmojo-Calendar-body" style="{@cssTextBody}"><div class="mstrmojo-Calendar-dayView"></div></div><div class="mstrmojo-Calendar-timePart"><span class="mstrmojo-Calendar-hourLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-minuteLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-secondLabel">00</span><span class="mstrmojo-Calendar-AMPMLabel">AM</span></div><div class="mstrmojo-Calendar-advanced"></div><div class="mstrmojo-Calendar-buttons cf"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onbrowseMonthChange:function(){this.monthLabel.innerHTML=this.monthNames(this.browseMonth-1);},onbrowseYearChange:function(){this.yearLabel.innerHTML=this.browseYear;},ondtpChange:function(){this.timePart.style.display=(this.dtp===AC.TIMESTAMP||this.dtp===AC.TIME)?"block":"none";this.advancedNode.style.display=this.showAdvanced?"block":"none";},onvalueChange:function(){if(this.lastValue===undefined||this.value!==this.lastValue){this.updateSelectedDate();}},onchangeValueOnOKChange:a,onisAdvancedChange:a},markupSlots:{monthLabel:function(){return this.domNode.firstChild.lastChild.firstChild;},yearLabel:function(){return this.domNode.firstChild.lastChild.lastChild;},decreaseButton:function(){return this.domNode.firstChild.firstChild;},increaseButton:function(){return this.domNode.firstChild.childNodes[1];},bodyContainer:function(){return this.domNode.childNodes[1];},dayView:function(){return this.domNode.childNodes[1].firstChild;},monthView:function(){return this.domNode.childNodes[1].firstChild;},yearView:function(){return this.domNode.childNodes[1].firstChild;},hourView:function(){return this.domNode.childNodes[1].firstChild;},minuteView:function(){return this.domNode.childNodes[1].firstChild;},secondView:function(){return this.domNode.childNodes[1].firstChild;},timePart:function(){return this.domNode.childNodes[2];},hourLabel:function(){return this.domNode.childNodes[2].firstChild;},minuteLabel:function(){return this.domNode.childNodes[2].childNodes[2];},secondLabel:function(){return this.domNode.childNodes[2].childNodes[4];},AMPMLabel:function(){return this.domNode.childNodes[2].childNodes[5];},advancedNode:function(){return this.domNode.childNodes[3];},buttonsNode:function(){return this.domNode.childNodes[4];}},init:function AD(AK){if(this._super){this._super(AK);}if(this.duration<1){this.duration=1;}if(!this.selectedDates){this.selectedDates=[];}this.timeVal={hour:0,min:0,sec:0};var AL=mstrmojo.locales.location.LOCALE_TO_LANG;switch(AL[mstrApp.localeId]){case mstrmojo.desc(950,"English (US)"):case mstrmojo.desc(1035,"Portugese (Brasil)"):this.firstDayOfWeek=N;break;default:this.firstDayOfWeek=w;}},ondynDateValueChange:function u(AK){if(AK.value!==undefined&&this.hasRendered){this.updateSelectedDate();this.buildChildren();}},onminChange:AH,onmaxChange:AH,buildChildren:function c(){var AQ=this;if(this.showAdvanced){var AN=this.dynDateValue,AM=this.advancedValues||this.addDisposable(new mstrmojo.Model({})),AT=AN&&AN.split("::")||[],AP=AT[1]||AE,AL=AT[2]||0,AU=AT[3]||0,AR=function AR(){if(AQ.isAdvanced){AQ.wasAdvanced=true;AQ.changeValueOnOK=true;}AQ.set("isAdvanced",!AQ.isAdvanced);mstrmojo.css.toggleClass(AQ.markupSlots.dayView.call(AQ),["ddSelected"],AQ.isAdvanced);t.call(AQ,"baseDate",AQ.isAdvanced?3:0);if(AQ.parent&&AQ.parent.nudge&&AQ.isAdvanced){AQ.parent.nudge();}};this.advancedValues=AM;AM.baseDate=parseInt(AP);AM.toAddDays=AL>=0;AM.daysToAdjust=Math.abs(AL);AM.toAddMonths=AU>=0;AM.monthsToAdjust=Math.abs(AU);this.isAdvanced=!!this.dynDateValue;if(this.domNode){mstrmojo.css.toggleClass(this.markupSlots.dayView.call(this),["ddSelected"],this.isAdvanced);}if(this.isAdvanced&&this.value){var AK=n(this.value),AO=this.timeVal;if(AK&&AK.hour!==undefined){AO.hour=AK.hour;AO.min=AK.min;AO.sec=AK.sec;}}t.call(AQ,"baseDate",this.isAdvanced?3:0);this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.HBox",alias:"checkLabel",slot:"advancedNode",children:[{scriptClass:"mstrmojo.ui.Checkbox",alias:"checkbox",checked:!!AQ.isAdvanced,oncheckedChange:AR},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13844,"Dynamic Date"),onclick:function AS(){this.parent.checkbox.onclick();}}]},{scriptClass:"mstrmojo.Box",alias:"advancedPanel",slot:"advancedNode",bindings:{visible:"this.parent.isAdvanced"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9423,"Today"),cssClass:"tdLabel"},I.call(this,"days",AL),I.call(this,"months",AU)]},]);}else{this.destroyChildren(false);}this.addChildren([mstrmojo.Button.newWebButton(mstrmojo.desc(2140,"Cancel"),function(){AQ.parent.close();},false,{slot:"buttonsNode"}),mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){if(AQ.changeValueOnOK||AQ.isAdvanced||AQ.wasAdvanced){AQ.updateValue(true);}},true,{slot:"buttonsNode"})]);},preBuildRendering:function A(){this.buildChildren();return this._super();},getSelectedDatesAsString:function E(AL){var AK=[];m.forEach(this.selectedDates,function(AM){AK.push(b.formatDateInfo(AM,AL||AF().DATEOUTPUTFORMAT));});return AK;},updateSelectedDate:function L(AP){var AK=this.value,AM=this.timeVal,AO=this.selectedDates,AN,AQ=function(AS,AR){AS.set("browseYear",AR.year);AS.set("browseMonth",AR.month);AS.updateTimePart();AS.updateView(AS.currentView);if(!AS.changeValueOnOK&&AS.hasRendered&&AS.closeOnValueChange!=true){AS.updateValue();}};if(this.wasAdvanced){this.wasAdvanced=false;this.changeValueOnOK=false;}if(AK){AN=n(AK);if(AN&&AN.hour!==undefined){AM.hour=AN.hour;AM.min=AN.min;AM.sec=AN.sec;if(this.dtp===AC.TIME&&(AN.year===undefined||AN.month===undefined||AN.day===undefined)){var AL=b.getDateJson(new Date());AN.year=AL.year;AN.month=AL.month;AN.day=AL.day;}}}if((AN&&!this.isMultiSelect)||AP){B(this);}if(AO.length===0){if(!AN){if(this.parent.opener&&this.parent.opener.defaultDate){AN=n(this.parent.opener.defaultDate);}else{AN=b.getDateJson(new Date());}}if(!this.canSelectDisabledDate&&this.isDateDisabled(AN.day,AN.month,AN.year,this.min,this.max)){if(this.min&&b.compareDate(AN,this.min)<0){AN=n(this.min);}else{if(this.max&&b.compareDate(AN,this.max)>0){AN=n(this.max);}}}AO.push(AN);AQ(this,AN);}else{AN=AO[0];if(this.value!==null){AQ(this,AN);}}},updateValue:function f(AK){var AM=i(this),AL="";if(AM){AL=b.formatDateInfo(AM,AF().DATEOUTPUTFORMAT);if(this.dtp!==AC.DATE){var AN=b.formatTimeInfo(this.timeVal,AF().TIMEOUTPUTFORMAT);if(this.dtp===AC.TIME){AL=AN;}else{AL+=" "+AN;}}}this.lastValue=AL;this.set("value",AL);if(this.showAdvanced){this.set("dynDateValue",AK?W.call(this):null);}if(this.onValueUpdate){this.onValueUpdate();}},updateTimePart:function AA(){var AL=this.timeVal,AK=AL.hour||0,AM=(AK%12===0)?12:(AK%12);this.hourLabel.innerHTML=AM;this.minuteLabel.innerHTML=b.formatInteger(AL.min||0,2);this.secondLabel.innerHTML=b.formatInteger(AL.sec||0,2);this.AMPMLabel.innerHTML=AK<12?" "+AF().AM_NAME:" "+AF().PM_NAME;},premousedown:function(AK){var AM=AK.e,AL=k.eventTarget(AK.hWin,AM);if(AL===this.decreaseButton||AL===this.increaseButton){if(k.isFF){k.stopPropogation(window,AM);}return true;}else{return this.processEvent(AL,AM);}},premouseup:function(AK){var AM=AK.e;if(AM.ctrlKey||AM.shiftKey){k.clearBrowserHighlights();}var AL=k.eventTarget(AK.hWin,AM);if(AL===this.decreaseButton&&!AL.disabled){this.decrease();return true;}if(AL===this.increaseButton&&!AL.disabled){this.increase();return true;}},processEvent:function(AV,Ac){var AN=this.currentView,AO=this.selectedDates,AS,AX,Ad,AK,AU;if(AV===this.monthLabel){if(AN!==AG){this.switchViewTo(AG);}return true;}if(AV===this.yearLabel){if(AN!==X){this.adjustYearStart();this.switchViewTo(X);return true;}}if(AV===this.hourLabel){if(AN!==Z){this.switchViewTo(Z);}return true;}if(AV===this.minuteLabel){if(AN!==AJ){this.switchViewTo(AJ);}return true;}if(AV===this.secondLabel){if(AN!==z){this.switchViewTo(z);}return true;}if(AV===this.AMPMLabel){if(AN!==Z){this.switchViewTo(Z);}return true;}if(AN===Z){var AQ=AV.getAttribute("h");AU=parseInt(AV.innerHTML,10);if(!isNaN(AQ)&&!isNaN(AU)){AQ=parseInt(AQ,10);this.timeVal.hour=AU%12+AQ*12;this.updateTimePart();this.switchViewTo(e);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AN===AJ){AU=parseInt(AV.innerHTML,10);if(!isNaN(AU)){this.timeVal.min=AU;this.updateTimePart();this.switchViewTo(e);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AN===z){AU=parseInt(AV.innerHTML,10);if(!isNaN(AU)){this.timeVal.sec=AU;this.updateTimePart();this.switchViewTo(e);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AN===e){var Ab=this.browseYear,AL=this.browseMonth,AM;AV=Q(AV);Ad=parseInt(AV.innerHTML,10);AK=parseInt(AV.getAttribute("m"),10);if(!isNaN(Ad)&&!isNaN(AK)){AM=(AK===0)?{y:Ab,m:AL}:(AK===1?b.getNextMonth(Ab,AL):b.getPreMonth(Ab,AL));if((!this.canSelectDisabledDate&&this.isDateDisabled(Ad,AM.m,AM.y,this.min,this.max))||Ac.button===2){return true;}if(this.isAdvanced){return true;}var AY=Y(AO,Ad,AL,Ab),AW=AO.length>1,AT=this.forceNonEmptySelection,AZ=this.isMultiSelect,AR=AZ&&Ac.ctrlKey,Aa=AZ&&Ac.shiftKey,AP=null;if(Aa){AP=h(this,AV);B(this);o(this,AP);}else{if(AR){if(AY===-1){AI(this,AV);}else{if(!AT||AW){x(this,AY);}}}else{B(this);if(AW||AY===-1||AT){AI(this,AV);}}}if(this.onselect||J.hasSubs(this.id,"select")){this.raiseEvent({name:"select",value:this.selectedDates});}if(AK===1){this.increase();}else{if(AK===-1){this.decrease();}}if(!this.changeValueOnOK){this.updateValue();}else{if(this.showAdvanced){this.checkLabel.checkbox.set("checked",false);t.call(this,"baseDate",0);}}}return true;}if(AN===AG){AV=Q(AV);AX=parseInt(AV.getAttribute("m"),10);if(!isNaN(AX)){this.set("browseMonth",AX+1);this.switchViewTo(e);}return true;}if(AN===X){AV=Q(AV);AS=parseInt(AV.innerHTML,10);if(!isNaN(AS)){this.set("browseYear",AS);this.switchViewTo(e);}return true;}return true;},decrease:function(){var AM=this.currentView,AP=AM,AO=this.browseYear,AK=this.browseMonth,AL=this.yearRangStart,AN;switch(AM){case e:AN=b.getPreMonth(AO,AK);this.set("browseMonth",AN.m);this.set("browseYear",AN.y);break;case AG:this.set("browseYear",AO-1);break;case X:this.yearRangStart=AL-this.yearViewSize*this.yearViewSize;break;case Z:AP=z;break;case AJ:AP=Z;break;case z:AP=AJ;break;}this.switchViewTo(AP,"right");},increase:function(){var AM=this.currentView,AP=AM,AO=this.browseYear,AK=this.browseMonth,AL=this.yearRangStart,AN;switch(AM){case e:AN=b.getNextMonth(AO,AK);this.set("browseMonth",AN.m);this.set("browseYear",AN.y);break;case AG:this.set("browseYear",AO+1);break;case X:this.yearRangStart=AL+this.yearViewSize*this.yearViewSize;break;case Z:AP=AJ;break;case AJ:AP=z;break;case z:AP=Z;break;}this.switchViewTo(AP,"left");},updateView:function(AK){var AL=this[AK+"ViewHTML"]();this[AK+"View"].innerHTML=AL;},adjustYearStart:function(){this.yearRangStart=this.browseYear-10-this.browseYear%5;},switchViewTo:function(AL,AN){var AR="mstrmojo-Calendar-"+AL+"View",AQ=document.createElement("div"),AK=this[this.currentView+"View"],AO=AL+"ViewHTML",AP=this[this.currentView+"Label"],AM=this[AL+"Label"];if(!this.supportedViews[AL]){return ;}if(!AN){AN=this.sDirMatrix[this.currentView][AL];}AQ.className=AR;AQ.innerHTML=this[AO]();this.currentView=AL;this[AL+"View"]=AQ;mstrmojo.css.toggleClass(AQ,["ddSelected"],this.isAdvanced);this._slideIntoView(AK,AQ,AN);},_slideIntoView:function(AO,AS,AM){var AK=this.bodyContainer,AQ=(AM==="left"||AM==="right")?AO.offsetWidth:AO.offsetHeight,AL=(AM==="left"||AM==="right")?"left":"top",AR=(AM==="left"||AM==="up")?AQ:-AQ,AP=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AO,onEnd:function(){AK.removeChild(AO);}}),AN=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AS});AS.style[AL]=AR+"px";AK.appendChild(AS);AP.props[AL]={start:0,stop:-AR,suffix:"px"};AN.props[AL]={start:AR,stop:0,suffix:"px"};AP.play();AN.play();},dayViewHTML:function(){var AP=this.browseYear,AS=this.browseMonth,AX=b.getDaysOfMonth(AP,AS),Ab=b.getPreMonth(AP,AS),AM=b.getDaysOfMonth(Ab.y,Ab.m),AL=b.getNextMonth(AP,AS),AT=H(AP,AS,this.firstDayOfWeek),AQ=[],AN=AB(this),Ad=0,AK=this.selectedDates,AV=this.min,AZ=this.max,Ae,AW,Aa,AY,Ac=this.showCurMonthDatesOnly?'style="visibility:hidden;"':"";V(this,{d:AM,m:Ab.m,y:Ab.y},{d:1,m:AL.m,y:AL.y});AQ.push(P(this.cssTextDay));AQ.push(this._dayViewTHead());AQ.push("<tr>");for(Aa=0;Aa<AT;Aa++){Ae=AM-AT+Aa+1;AW=this.isDateDisabled(Ae,Ab.m,Ab.y,AV,AZ)?"disabled":"";AQ.push("<td "+Ac+'><div class="mstrmojo-Calendar-day-pre '+AW+'" m="-1">');AQ.push(Ae);AQ.push("</div></td>");Ad++;}for(Aa=0;Aa<AX;Aa++){Ae=Aa+1;AW=this.isDateDisabled(Ae,AS,AP,AV,AZ)?" disabled":"";var AO=q(Ae,AS,AP),AR=AO?" today":"",AU=Y(AK,Ae,AS,AP)!==-1;AR=(this.hilightToday&&AO)?" hilightToday":AR;AQ.push("<td "+(AO?('class="'+AR+'" '):" ")+(AU?AN:"")+'><div class="mstrmojo-Calendar-day-cur'+(AU?(" selected "):"")+AW+'" m="0"'+(AU?AN:"")+">");AQ.push(Aa+1);AQ.push("</div></td>");if((++Ad)%7===0){AQ.push("</tr><tr>");}}for(AY=Ad;AY<42;AY++){Ae=Ad-AX-AT+1;AW=this.isDateDisabled(Ae,AL.m,AL.y,AV,AZ)?"disabled":"";AQ.push("<td "+Ac+'><div class="mstrmojo-Calendar-day-next '+AW+'" m="1">');AQ.push(Ae);AQ.push("</div></td>");if((++Ad)%7===0&&Ad!==42){AQ.push("</tr><tr>");}}AQ.push("</tr>");AQ.push(y);return AQ.join("");},_dayViewTHead:function(){var AN=[],AO='<thead><tr class="mstrmojo-Calendar-thead" style="'+this.cssTextWeekDay+';">',AM="</tr></thead>",AL=this.firstDayOfWeek-1,AP=this.dayNames,AK;AN.push(AO);for(AK=AL;AK<AL+7;AK++){AN.push("<td>");AN.push(AP(AK%7));AN.push("</td>");}AN.push(AM);return AN.join("");},monthViewHTML:function(){var AL=[],AN=this.browseMonth-1,AM=this.browseYear,AK;V(this,{d:31,m:12,y:AM-1},{d:1,m:1,y:AM+1});AL.push(P(this.cssTextMonth));AL.push("<tr>");for(AK=0;AK<12;AK++){AL.push("<td "+((AK===AN)?AB(this):"")+'><div class="mstrmojo-Calendar-month'+((AK===AN)?" selected":"")+'" m="');AL.push(String(AK));AL.push('">');AL.push(this.monthNames(AK));AL.push("</div></td>");if(AK%3===2){AL.push("</tr><tr>");}}AL.pop();AL.push("</tr>");AL.push(y);return AL.join("");},yearViewHTML:function(){var AP=this.yearRangStart,AL=[],AN=this.browseYear,AO,AK,AM=this.yearViewSize;V(this,{d:31,m:12,y:AP-1},{d:1,m:1,y:AP+AM*AM});AL.push(P(this.cssTextYear));AL.push("<tr>");for(AK=0;AK<AM*AM;AK++){AO=AP+AK;AL.push("<td "+((AN===AO)?AB(this):"")+'><div class="mstrmojo-Calendar-year'+((AN===AO)?" selected":"")+'">');AL.push(AO);AL.push("</div></td>");if(AK%AM===(AM-1)){AL.push("</tr><tr>");}}AL.pop();AL.push("</tr>");AL.push(y);return AL.join("");},hourViewHTML:function(){var AM=[],AL=this.timeVal.hour,AK;AM.push(G);AM.push('<tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AM.push(AF().AM_NAME);AM.push("</div></td></tr>");for(AK=0;AK<12;AK++){AM.push('<td><div class="mstrmojo-Calendar-hour'+((AK===AL)?" selected":"")+'" h="0">');AM.push((AK===0)?12:AK);AM.push("</div></td>");if(AK===5){AM.push("</tr><tr>");}}AM.push('</tr><tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AM.push(AF().PM_NAME);AM.push("</div></td></tr>");for(AK=0;AK<12;AK++){AM.push('<td><div class="mstrmojo-Calendar-hour'+(((12+AK)===AL)?" selected":"")+'" h="1">');AM.push((AK===0)?12:AK);AM.push("</div></td>");if(AK===5){AM.push("</tr><tr>");}}AM.push("</tr>");AM.push(y);return AM.join("");},minuteViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.min,"mstrmojo-Calendar-minute");},secondViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.sec,"mstrmojo-Calendar-second");},_minuteSecondViewHTML:function(AM,AN){var AL=[],AK;AL.push(G);AL.push("<tr>");for(AK=0;AK<60;AK++){AL.push('<td><div class="');AL.push(AN);AL.push((AK===AM)?' selected">':'">');AL.push(AK);AL.push("</div></td>");if(AK%10===9){AL.push("</tr><tr>");}}AL.pop();AL.push("</tr>");AL.push(y);return AL.join("");},isDateDisabled:function(AK,AM,AL){return !F(AK,AM,AL,this.min,this.max);},unrender:function D(AK){delete this.lastValue;this._super(AK);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi._MonitorsAppState","mstrmojo.EditableLabel","mstrmojo.vi.ui.toolbars.TitleToolbar");var J=mstrmojo.dom;mstrmojo.vi.ui.TitleBar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.TitleBar",markupString:'<div id="{@id}" class="mstrmojo-VITitleBar {@cssClass}" style="{@cssText}" mstrAttach:contextmenu,click><div class="left-toolbar"></div><div class="title-text"></div><div class="right-toolbar"></div></div>',markupSlots:{leftToolNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.childNodes[1];},rightToolNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode;}},markupMethods:{onhasContextMenuButtonChange:function(){var P=this.hasContextMenuButton;this.tbToolbar.set("visible",P);this.tbToolbar.set("enabled",P);},ontitleChange:function(){this.lblTitle.set("text",this.title||" ");},ontoolbarCfgChange:function(){var P=this.toolbarCfg;if(!P){return ;}this.tbToolbar.set("toolbarCfg",P);this.doLayout();},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},h:{leftToolNode:"100%",textNode:"100%",rightToolNode:"100%"},xt:true},lblTitle:null,tbToolbar:null,hasContextMenuButton:true,editTitleOnClick:false,editTitleOnDoubleClick:true,editTitleOnTwoClicks:false,title:"",close:mstrmojo.emptyFn,toolbarCfg:null,beganEditingTitlebar:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,useRichTooltip:true,init:function O(P){this._super(P);this.addChildren([].concat(this.getLeftToolbarChildren()).concat(this.getTitleChildren()).concat(this.getRightToolbarChildren()));},shouldShowTooltip:function K(P,R){var Q=P.target||J.eventTarget(P.hWin,P.e);return Q===this.textNode.firstChild&&(Q.scrollWidth>Q.clientWidth);},getTooltipContent:function L(P){var R=P.target||J.eventTarget(P.hWin,P.e),Q=R.innerHTML;return Q;},showTooltip:function M(P,Q){if(this.shouldShowTooltip(P,Q)){this._super(P,Q);}},updateTooltipConfig:function I(R){var W=R.target||J.eventTarget(R.hWin,R.e),P=J.position(W);var S=this.getTooltipContent(R),V=P.y+P.h+3,U=P.x+4,Q="vi-regular vi-tooltip-A";if(W.className==="right-toolbar customShapeWarn"){S=mstrmojo.desc(16684,"Add an attribute to enable data labels and enhance the performance of filtering");U=U+24;V=V-30;Q="vi-warning vi-tooltip-C";}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:S,top:V,left:U,cssClass:Q};},getLabelNode:function C(){return this.lblTitle.domNode;},getMenuConfig:function B(){var P=this.toolbarCfg;if(P){if(P.hasMenuItems()){return P;}}return null;},setToolbarVisibility:function D(P){this.tbToolbar.set("visible",P);},editTitle:function N(){this.lblTitle.set("isEditing",true);},onAppStateChange:function F(P){var Q=this.lblTitle,R=mstrApp.isAppStatePresentation(),S=!!(P.valueWas&mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION);if(R&&this._confgTitleEditable===undefined){this._confgTitleEditable=this.editTitleOnClick||this.editTitleOnDoubleClick||this.editTitleOnTwoClicks;}Q.set("isEditing",false);if(R||S){Q.set("editOnDoubleClick",!R&&this._confgTitleEditable);}},getLeftToolbarChildren:function A(){},getTitleChildrenLayoutOffsets:function H(){return{h:2,w:2};},getTitleChildren:function G(){return[{scriptClass:"mstrmojo.EditableLabel",slot:"textNode",alias:"lblTitle",bindings:{editOnClick:"this.parent.editTitleOnClick",editOnDoubleClick:"this.parent.editTitleOnDoubleClick",selectable:"this.isEditing",editOnTwoClicks:"this.parent.editTitleOnTwoClicks"},onTextEditBegin:function(){this.parent.beganEditingTitlebar();},onTextEditComplete:function(R,Q){this.parent.titleEdited(this.text,R,Q);},getLayoutOffsets:function P(){return this.parent.getTitleChildrenLayoutOffsets();}}];},getRightToolbarChildren:function E(){return[{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:"rightToolNode",alias:"tbToolbar",visible:true,useRichTooltip:true,bindings:{hasContextMenuButton:"this.parent.hasContextMenuButton",}}];}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.ToolbarConfig");mstrmojo.vi.ui.toolbars._HasToolbar=mstrmojo.provide("mstrmojo.vi.ui.toolbars._HasToolbar",{_mixinName:"mstrmojo.vi.ui.toolbars._HasToolbar",preBuildRendering:function A(){this.generateToolbar();return this._super();},generateToolbar:function B(){this.passToolbarCfg(this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));},updateToolbar:function D(E){if(this._super){E=this._super(E);}return E;},passToolbarCfg:function C(E){var F=this.toolbar.toolbarCfg;if(F){F.destroy();}this.toolbar.set("toolbarCfg",E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.array","mstrmojo.UUID","mstrmojo.ui.menus.ToolbarConfig");var J=mstrmojo.hash,G=mstrmojo.array,M=mstrmojo.css,D=mstrmojo.UUID;function Q(){var U=this.children,S=this.groupInfo,V=(S&&S._isDeleted)?S:{};delete V._isDeleted;U.forEach(function(X){var W=X.defn.gi;if(W&&W!==""){var Y=V[W];if(!Y){Y=V[W]=[];}Y.push(X.k);}});return V;}mstrmojo.vi.ui._HasGroup=mstrmojo.provide("mstrmojo.vi.ui._HasGroup",{_mixinName:"mstrmojo.vi.ui._HasGroup",clearGroupSelection:function O(){var V=this._tgtSelections;if(V){var U=this,S=V.getSelections();(S||[]).forEach(function(W){U.getUnitByKey(W).toggleBoxSelection(false);U.setLastSelectionClass(null,W);V.remove(W);});}},getGroupInfo:function I(){var S=this.groupInfo;if(!S||S._isDeleted){S=this.groupInfo=Q.call(this);J.forEach(S,function(V,U){if(V.length<2){delete S[U];}});}return S;},findGroupByKey:function R(U){var S=null;J.forEach(this.getGroupInfo(),function(W,V){G.forEach(W,function(X){if(U===X){S=V;return false;}});if(S){return false;}});return S;},getGroupContextMenuConfig:function N(b,c){var V=this._tgtSelections;if(V){var U=this.id,S=this.groupInfo,W,Y=1,Z=this.findGroupByKey(c);var a=function(d){return function(){S[d].push(c);V.notify(true,{selectedGroupId:d});};},X=function(e,d){return function(){var g=S[e],f=function(h){var i=mstrmojo.all[U].getUnitByKey(h);i.toggleBoxSelection(false);i.setGroupingStatus("");};g.splice(g.indexOf(c),1);if(g.length===1){f(g[0]);delete S[e];}if(d){S[d].push(c);}else{f(c);}V.notify(true,{selectedGroupId:d||e});};};for(W in S){if(W===Z){b.addMenuItem(mstrmojo.desc(15197,"Remove from Group ##").replace("##",Y),"",X(W,null),null,0);}else{if(Z){b.addMenuItem(mstrmojo.desc(15198,"Move to Group ##").replace("##",Y),"",X(Z,W));}else{b.addMenuItem(mstrmojo.desc(15199,"Add to Group ##").replace("##",Y),"",a(W));}}Y++;}if(Z){b.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"",function(){V.notify(true,{deleteGroupId:Z});});}return b;}},groupSelection:function E(){var S=this._tgtSelections;if(S){S.notify(true);}},addGroup:function F(S){var U=D.create();this.groupInfo[U]=S;return U;},selectGroup:function K(U){var S=this;var V=this._tgtSelections;if(V){U.forEach(function(W){V.toggleSelection(W);var X=S.getUnitByKey(W);X.toggleBoxSelection(true);X.setGroupingStatus("");});}},highlightGroup:function L(S){var V=this,U=this.getGroupInfo()[S];(U||[]).forEach(function(W){var X=V.getUnitByKey(W);X.setGroupingStatus("highlight");});},disableGroup:function H(S){var V=this,U=this.getGroupInfo()[S];var W=this._tgtSelections;if(W){(U||[]).forEach(function(X){var Y=V.getUnitByKey(X);Y.setGroupingStatus("disabled");Y.toggleBoxSelection(false);W.remove(X);});}},deleteGroup:function P(U){var W=this,S=this.getGroupInfo(),V=S[U];(V||[]).forEach(function(X){var Y=W.getUnitByKey(X);Y.setGroupingStatus("");});delete S[U];},clearGroupInfo:function A(){this.clearGroupSelection();var S=this.groupInfo;if(S){J.forEach(S,function(V,U){S[U]=[];});S._isDeleted=true;}},toggleHasGroupCSS:function B(S){M.toggleClass(this.domNode,"hasGroup",S);},submitGroupInfo:function C(){var W=this.getGroupInfo(),S=Q.call(this),V={},U={};J.forEach(W,function(Y,X){Y.forEach(function(a){var Z=S[X],b=Z?Z.indexOf(a):-1;if(b===-1){V[a]=X;U[a]="";}else{Z.splice(b,1);}});});J.forEach(S,function(Y,X){Y.forEach(function(Z){if(!V[Z]){V[Z]="";}U[Z]=X;});});if(Object.keys(V).length>0){this.model.saveGroupInfo(V,U,this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.Widget","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.ME.MetricToken","mstrmojo.ME.MetricDataService","mstrmojo.ui.ScrollableSuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var R=mstrmojo.dom,U=mstrmojo.css,AI=mstrmojo.Enum_Keys,H=mstrmojo.range,k=H.EDGE,AA=mstrmojo.ME.MetricToken.isDelimiter,Q=mstrmojo.expr,s=mstrmojo.array,K=mstrmojo.hash;var M=R.isIE||R.isIEW3C;function AQ(E){return E.ctrlKey||R.isMetaKey(window,E)||(E.charCode||E.keyCode)===AI.CTRL;}mstrmojo.ME.SpanListMapper=mstrmojo.provide("mstrmojo.ME.SpanListMapper",mstrmojo.mixin({itemWrapperPrefix:function(E){return'<span class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"&nbsp;",itemWrapperSuffix:"</span>",createWrapperNode:function S(E){var AR=E.ownerDocument,AS=AR.createElement("span");return AS;},_iw2idx:function V(AR,AU,AT){var AS=this.wrapperNodes(AU),E=mstrmojo.array.indexOf(AS,AT);return E===-1?AS.length:E;},itemOffsetLeft:function i(AR,AV,E,AT){if(!AT){var AS=this.wrapperNodes(AV);AT=AS&&AS[E];if(!AT){return 0;}}var AU=AV.firstChild;if(!AU||(AU===AT)){return 0;}return AT.offsetLeft-AU.offsetLeft;},whereDrop:function AP(AZ,E,AT,AY,AR){var AV=this._nd2iw(AZ,E,AT),Aa,AX,AU,AW,AS;if(AV){AX=this._iw2idx(AZ,E,AV);Aa=AX;AU=this.itemOffsetLeft(AZ,E,null,AV);AW=AV.offsetTop;AS=AV.offsetWidth;if(AY.x>AR.left+AU+AS/2){Aa++;AU+=AS;}}else{return AZ.dropCuePos;}return{left:AU,top:AW,idx:Aa,idxActual:AX};}},mstrmojo.hash.copy(mstrmojo.WidgetListMapper)));mstrmojo.ME.TokenInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.ME.TokenInputBox",containerResizable:false,dropZone:true,suggestionPopupCssClss:"mstrmojo-ME-TokenInputBox-suggest",allowDrop:function G(E){var AR=E.src.data;return !!AR;},createToken:function A(E){return{v:mstrmojo.ME.MetricToken.brackets(E.n),oi:K.copyProps(["did","n","t"],E),isNew:true};},ondrop:function(AR){AR.src.data=this.createToken(AR.src.data.item);if(this.prepareDropItem){this.prepareDropItem(AR);}var E=this.insertTokens([AR.src.data]);this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");return E;},ondragenter:function I(E){this.dragdata=E.src.data;this._super(E);this.set("dropCuePos",{left:0,top:0});mstrmojo.css.addClass(this.domNode,"unselectable");},ondragleave:function W(){this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");},ondropCuePosChange:function Y(AR){var AS=AR.value,E=this.dragdata;if(E&&E.setAvatarClass){if(AS){E.setAvatarClass("add");}else{E.setInvalidAvatarClass();}}},makeObservable:true,showDesc:true,showPath:true,showFunctionSyntaxAsPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,markupString:'<div id={@id} class="mstrmojo-TokenInputBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-TokenInputBox-edit" contenteditable="true" tabindex="1" spellcheck="false"ondragstart = "return false;" oncontextmenu = "return false;" onkeydown = "return mstrmojo.all.{@id}.handlekeydown(event);" onkeypress = "return mstrmojo.all.{@id}.handlekeypress(event);" onkeyup = "return mstrmojo.all.{@id}.handlekeyup(event);" onmouseup = "return mstrmojo.all.{@id}.handlemouseup(event);" onpaste = "return mstrmojo.all.{@id}.handlepasteDirect(event);" onblur = "return mstrmojo.all.{@id}.handleblur(event);" >{@itemsHtml}</div><textarea class = "mstrmojo-TokenInputBox-clipboard" onkeyup = "return mstrmojo.all.{@id}.handlepaste(event);"></textarea><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild;},clipboardNode:function(){return this.domNode.childNodes[1];},scrollboxNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},suggestionListClass:"mstrmojo.ui.ScrollableSuggestionList",items:null,itemFunction:function J(AS,E,AR){return new mstrmojo.ME.MetricToken({data:AS,parent:AR});},listMapper:mstrmojo.ME.SpanListMapper,_set_items:function X(AR,E){if(this._super){this._super(AR,E);}if(this.oi){this.oi.tks.items=this.items;}if(!this.tokensCacheInitilized){this.pretokensModify();this.tokensCacheInitilized=true;}},tokensCache:[],tokensCachePointer:0,isDelimiter:AA,postBuildRendering:function e(){if(this._super){this._super();}this._eros=false;if(R.isFF){document.body.spellCheck=false;}mstrmojo.dom.attachEvent(this.editNode,"compositionstart",function(){this.saveStateForIME();this.composing=true;this.toggleIMEStatusBar(true);}.bind(this));mstrmojo.dom.attachEvent(this.editNode,"compositionupdate",function AR(AS){if(R.isIEW3C){this.lastImeChar=AS.data||(M&&this.lastImeChar);}else{this.lastImeChar=AS.data||this.lastImeChar;}}.bind(this));mstrmojo.dom.attachEvent(this.editNode,"compositionend",function E(AU){this.composing=false;if(R.isIE9||R.isIE10){var AT=H.getRangeInfo();this.imeBuffer=AT.startContainer.data.slice(this.prev_rInfo.startOffset,AT.startOffset).split("");}else{if(R.isIEW3C){var AT=H.getRangeInfo();this.imeBuffer=AT.startContainer.data.slice((this.prev_rInfo.startOffset-1)<0?0:this.prev_rInfo.startOffset,AT.startOffset).split("");}else{if(R.isEdge){var AS=AU.data||"";this.imeBuffer=(this.imeBuffer||[]).concat(AS.split(""));}else{var AS=AU.data||this.lastImeChar||"";this.imeBuffer=(this.imeBuffer||[]).concat(AS.split(""));}}}}.bind(this));},fnContextMenu:function N(E){if(E){E.cancelBubble=true;E.returnValue=false;}return false;},saveStateForIME:function h(){if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=H.getRangeInfo();this.prev_items=this.items;}},handleblur:function L(){if(this.doubleByte){this.doubleByte=false;this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;}},processDeleteKeyDown:function D(AR){if(!this.doubleByte){try{this.widgetHandleDelete(AR);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});}catch(E){}return true;}},processBackspaceKeyDown:function AO(AR){if(!this.doubleByte){try{this.widgetHandleBackspace(AR);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();this.editNode.focus();}catch(E){}return true;}},handlekeydown:function b(AT){AT=AT||window.event;var E=AT.keyCode||AT.charCode,AR=false,AS=H.getRangeInfo();if((E===AI.LEFT_ARROW||E===AI.RIGHT_ARROW||E===AI.BACKSPACE)&&this.doubleByte){if(this.composing){return ;}this.doubleByte=false;if(E===AI.BACKSPACE){this.imeBuffer.pop();}this.widgetHandleImeInput(this.prev_rInfo);mstrmojo.dom.stopPropogation(window,AT);mstrmojo.dom.preventDefault(window,AT);return false;}switch(E){case AI.DELETE:AR=this.processDeleteKeyDown(AS);break;case AI.BACKSPACE:AR=this.processBackspaceKeyDown(AS);break;case AI.ENTER:if(this.breakOnEnterKeyDown&&this.breakOnEnterKeyDown()){break;}case AI.TAB:this._startDebug=true;if(this.suggestionShown){this.handleSuggestionItemSelect(this.getSelected());}else{this.startTokenSuggestion();}AR=true;break;case AI.ESCAPE:this.endTokenSuggestion();AR=true;break;case 86:if(AQ(AT)){this.handlePasteTriggeredDeletion();AR=false;}break;case 89:if(AQ(AT)){this.widgetHandleUndoRedo("redo");AR=true;}break;case 90:if(AQ(AT)){this.widgetHandleUndoRedo("undo");AR=true;}break;case 229:this.saveStateForIME();break;default:}if(AR){R.stopPropogation(window,AT);R.preventDefault(window,AT);return false;}return true;},handlePasteTriggeredDeletion:function F(){this.set("_saveRangeInfo",H.getRangeInfo());if(!this._saveRangeInfo.collapsed){this.widgetHandleDelete(this._saveRangeInfo);this.set("_saveRangeInfo",H.getRangeInfo());}this.clipboardNode.focus();},getCharacter:function AK(AR){var E=(R.isIE&&!R.isIE9)?AR.keyCode:AR.charCode;return(E>0)?String.fromCharCode(E):null;},handleCharacter:function AB(AT){var AU=this.getCharacter(AT),AR=false;if(AU&&!((AU==="c"||AU==="a")&&AQ(AT))){try{this.widgetHandleInput(H.getRangeInfo(),AU);this.raiseChangeEvent({type:"input",character:AU});if(!this.isDelimiter(AU)){if(this.useKeyDelay){var AS=this;window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){AS.startTokenSuggestion();},mstrmojo.ME.MetricDataService.suggestDelay);}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion(true);}}catch(E){}AR=true;}return AR;},handlekeypress:function B(E){E=E||window.event;if(this.doubleByte){this.toggleIMEStatusBar(false);this.doubleByte=false;this.widgetHandleImeInput(this.prev_rInfo);window.setTimeout(function(){this.handleCharacter(E);}.bind(this),10);return false;}if(this.handleCharacter(E)){R.stopPropogation(window,E);R.preventDefault(window,E);return false;}return true;},handlekeyup:function g(AS){var E=AS.keyCode||AS.charCode,AR;if(E===AI.LEFT_ARROW||E===AI.RIGHT_ARROW){AR=this.findObjectToken();if(AR&&AR===this._saveActiveToken){this.startTokenSuggestion(AR);}else{this.endTokenSuggestion();}}else{if(E===AI.UP_ARROW){this.preHighlight();}else{if(E===AI.DOWN_ARROW){this.nextHighlight();}else{if(E===AI.BACKSPACE&&this.doubleByte){if(E===AI.BACKSPACE&&!this.composing&&!R.isIE9){this.doubleByte=false;this.imeBuffer.pop();this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;}}}}}this.set("_saveRangeInfo",H.getRangeInfo());},handlemouseup:function p(AT){if(this.dropCuePos){return false;}var AR=this.findObjectToken();if(AR&&AR===this._saveActiveToken){this.startTokenSuggestion(AR);}else{this.endTokenSuggestion();}var AS=H.getRangeInfo();if(this.doubleByte){this.doubleByte=false;var E=this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;AR=R.findWidget(AS.startContainer);if(AR){this._delaySetTextCaretPos(AR.domNode,AS.startOffset);}else{this._delaySetTextCaretPos(E.domNode,AS.startOffset-1);}this.prev_rInfo=AS;}this.set("_saveRangeInfo",AS);},handlepasteDirect:function AF(E){this.clipboardNode.value=E.clipboardData.getData("Text");this.handlepaste(E);R.stopPropogation(window,E);R.preventDefault(window,E);this.handlePasteTriggeredDeletion();return false;},handlepaste:function n(AV){var AR=this.clipboardNode.value;this.clipboardNode.value="";var AU=[],E=AR&&AR.length,AT,AS="",AW;if(E>0){for(AT=0;AT<E;AT++){AW=AR.charAt(AT);if(this.isDelimiter(AW)){if(!mstrmojo.string.isEmpty(AS)){AU.push({v:AS,isNew:true});AS="";}AU.push({v:AW,isDelimiter:true,isNew:true});}else{AS=AS+AW;}}if(!mstrmojo.string.isEmpty(AS)){AU.push({v:AS,isNew:true});AS="";}this.insertTokens(AU);}},raiseChangeEvent:function(E){E.name="tokensModify";this.raiseEvent(E);},getTokensAsString:function AN(){var AR=[],AT=this.items,AS,E;for(AS=0,E=AT.length;AS<E;AS++){AR[AS]=AT[AS].v;}return AR.join("| ");},replaceErrorToken:function q(AT){var AS=this.items||[],AU=mstrmojo.array.find(AS,"sta",-1),AR,AV=function(Ab,AZ,Ac){var AY=(Ab&&Ab.items)||[],AX=s.find(AY,"did",AZ),AW,Aa;if(AX>-1){AW=AY[AX].fs;Aa=s.filterOne(AW,function(Ad){return Ad.fnm&&Ad.fnm.toUpperCase()===Ac.toUpperCase();});}return Aa;},E=function(Ab,AZ,Aa){var AW={v:AZ.n,oi:AZ,isNew:true},AY=Ab.v&&Ab.v.split("@"),AX;if(AY&&AY.length>1){AX=AV(Aa,AZ.did,AY[1]);if(AX){AW.exv=AX.fmdid||AX.fid;AW.extp=8;AW.v=mstrmojo.ME.MetricToken.brackets(AZ.n)+"@"+AX.fnm;}}return AW;};if(AU>-1){AR=E(AS[AU],AT,this.candidates);this.remove(AU);this.add([AR],AU);}},widgetHandleDelete:function f(AU){if(AU.collapsed){var AT,AS,E,AV=AU.startOffset,AR=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AU.startContainer,false,document.body)){H.collapseOnNode(this.editNode,false);return ;}AT=H.getEdgeInfo(AU.startContainer,AU.startOffset);AS=R.findWidget(AU.startContainer);E=this.itemIndex(AS.data);if(AT===k.EDGE_END){E++;AS=AR[E];AV=0;}if(!AS){H.collapseOnNode(this.editNode,false);return ;}if(AS.length()===1){this.remove(E);AS=AR[E];if(AS){H.collapseOnNode(AS.domNode,true);}else{H.collapseOnNode(this.editNode,false);}this.checkMergeTwoTokens(E-1,E);}else{AS.spliceContent(AV,1);H.collapseOnTextNode(AS.domNode,AV);}}else{this.widgetDeleteTokens(AU);}},widgetHandleBackspace:function z(AU){if(AU.collapsed){var AT,AS,E,AV=AU.startOffset,AR=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AU.startContainer,false,document.body)){if(AU.startOffset>0&&R.isFF){AS=AR[this.items.length-1];H.collapseOnNode(AS.domNode,false);AU=H.getRangeInfo();AT=H.getEdgeInfo(AU.startContainer,AU.startOffset);}else{H.collapseOnNode(this.editNode,true);return ;}}AT=H.getEdgeInfo(AU.startContainer,AU.startOffset);AS=R.findWidget(AU.startContainer);E=this.itemIndex(AS.data);if(AT===k.EDGE_BEGIN){E--;AS=AR[E];AV=AS.length();}if(!AS){H.collapseOnNode(this.editNode,true);return ;}if(AS.length()===1){this.remove(E);AS=AR[E-1];if(AS){H.collapseOnNode(AS.domNode,false);this.checkMergeTwoTokens(E-1,E);AS=AR[E-1];}else{H.collapseOnNode(this.editNode,true);}}else{AS.spliceContent(AV-1,1);H.collapseOnTextNode(AS.domNode,AV-1);}}else{this.widgetDeleteTokens(AU);}},widgetHandleInput:function AC(AV,AW){if(!AV.collapsed){this.widgetDeleteTokens(AV);AV=H.getRangeInfo();}var AS,AX,AY,AZ,E,AR,AT=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AV.startContainer,false,document.body)){this.add([{v:AW,isDelimiter:this.isDelimiter(AW),isNew:true}],0);AX=AT[0];H.collapseOnTextNode(AX.domNode,1);return ;}AS=H.getEdgeInfo(AV.startContainer,AV.startOffset);AX=R.findWidget(AV.startContainer);AY=this.itemIndex(AX.data);if(this.isDelimiter(AW)){AZ={v:AW,isDelimiter:true,isNew:true};if(AS===k.EDGE_MIDDLE){var AU=AX.split2Tokens(AV.startOffset);this.remove(AY);this.add([AU[0],AZ,AU[1]],AY);AY=AY+1;}else{AY=(AS===k.EDGE_BEGIN)?AY:AY+1;this.add([AZ],AY);}AX=AT[AY];H.collapseOnTextNode(AX.domNode,(AX.domNode.innerText||AX.domNode.textContent).length);}else{AR=AV.startOffset;if(AX.isDelimiter()){E=AT[(AS===k.EDGE_BEGIN)?AY-1:AY+1];if(E&&!E.isDelimiter()){AX=E;AR=(AS===k.EDGE_BEGIN)?AX.length():0;}}if(!AX.isDelimiter()){AX.spliceContent(AR,0,AW);H.collapseOnTextNode(AX.domNode,AR+1);}else{this.add([{v:AW,isNew:true}],(AS===k.EDGE_BEGIN)?AY:AY+1);AX=AT[(AS===k.EDGE_BEGIN)?AY:AY+1];H.collapseOnNode(AX.domNode,false);}}},widgetHandleImeInput:function AC(AU,AV){AV=AV||this.imeBuffer.join("");this.imeBuffer=[];this.lastImeChar=null;if(!AV){return ;}if(!AU.collapsed){this.widgetDeleteTokens(AU);AU=H.getRangeInfo();}var AS,AW,AX,AY,E,AR,AT=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AU.startContainer,false,document.body)||this.items.length==0){this.clearTokens();this.add([{v:AV,isDelimiter:this.isDelimiter(AV),isNew:true}],0);AT=this.ctxtBuilder.itemWidgets;AW=AT[0];H.collapseOnTextNode(AW.domNode,1);this._delaySetCaretPos(AW.domNode,false);return ;}AS=H.getEdgeInfo(AU.startContainer,AU.startOffset);AW=R.findWidget(AU.startContainer);AX=this.itemIndex(AW.data);AR=AU.startOffset;if(AW.isDelimiter()){this.clearTokens();this.add(this.prev_items);AT=this.ctxtBuilder.itemWidgets;E=AT[(AS===k.EDGE_BEGIN)?AX-1:AX+1];if(E&&!E.isDelimiter()){AW=E;AR=(AS===k.EDGE_BEGIN)?AW.length():0;}}if(!AW.isDelimiter()){AW.spliceContent(AR,0,AV);this._delaySetTextCaretPos(AW.domNode,AR+AV.length);}else{this.add([{v:AV,isNew:true}],(AS===k.EDGE_BEGIN)?AX:AX+1);AW=AT[(AS===k.EDGE_BEGIN)?AX:AX+1];this._delaySetCaretPos(AW.domNode,false);}this.startTokenSuggestion();return AW;},findObjectToken:function C(){var AU=H.getRangeInfo(),AS=R.findWidget(AU.startContainer);if(!R.contains(this.editNode,AU.startContainer,false,document.body)){return null;}if(!AS||AS===this||!AS.isDelimiter){return null;}if(AS&&!AS.isDelimiter()){return AS;}var AT=H.getEdgeInfo(AU.startContainer,AU.startOffset),AR=this.ctxtBuilder.itemWidgets,E=this.itemIndex(AS.data);AS=AR[(AT===k.EDGE_BEGIN)?E-1:E+1];if(AS&&!AS.isDelimiter()){return AS;}return null;},checkMergeTwoTokens:function x(AU,AS){var AT=this.ctxtBuilder.itemWidgets,AR=AT[AU],E=AT[AS];if((AR&&!AR.isDelimiter())&&(E&&!E.isDelimiter())){this.remove([AU,AS]);this.add([AR.mergeTo(E)],AU);H.collapseOnTextNode(AT[AU].domNode,AR.length());}},insertTokens:function AE(AV){var AY=0,AX=this.editNode;var AS=this._saveRangeInfo||H.getRangeInfo();if(!AS||!R.contains(AX,AS.startContainer,false,document.body)){this.add(AV);AY=this.items.length-1;if(AY===0){this._delaySetTextCaretPos(AX,(AX.innerText||AX.textContent).length);}else{var E=this.ctxtBuilder.itemWidgets[AY].domNode;this._delaySetTextCaretPos(E,(E.innerText||E.textContent).length);}}else{var AR=H.getEdgeInfo(AS.startContainer,AS.startOffset),AW=R.findWidget(AS.startContainer);AY=this.itemIndex(AW.data);if(AR===k.EDGE_MIDDLE){var AT=AW.split2Tokens(AS.startOffset);this.remove(AY);AV.unshift(AT[0]);AV.push(AT[1]);this.add(AV,AY);}else{AY=(AR===k.EDGE_BEGIN?AY:AY+1);this.add(AV,AY);}AY=AY+AV.length-1;AW=this.ctxtBuilder.itemWidgets[AY];this._delaySetCaretPos(AW.domNode,false);}this.raiseChangeEvent({type:"insert"});var AU=this;window.setTimeout(function(){AU.set("_saveRangeInfo",H.getRangeInfo());},50);return AY;},insertParenthesisTokens:function AH(AR){var E=this;window.setTimeout(function(){var AS=E.insertTokens([{v:"(",isDelimiter:true,isNew:true},{v:")",isDelimiter:true,isNew:true}]);E._delaySetTextCaretPos(E.itemsContainerNode.childNodes[AS-1],1);},AR||50);},clearTokens:function w(E){this.set("items",E||[]);this.set("_saveRangeInfo",null);this._delaySetCaretPos(this.editNode,false);},focus:function AD(){var AR=this.ctxtBuilder.itemWidgets,E=AR.length;this._delaySetCaretPos(E>0?AR[E-1].domNode:this.editNode,false);},startTokenSuggestion:function AJ(E){this.endTokenSuggestion();if(!E){E=this.findObjectToken();}if(E&&!E.isDelimiter()){E.set("active",true);this._saveActiveToken=E;this.showSuggestion(this.getSearchPattern());}if(!E||this.getSearchPattern().length===0){this.hideSuggestion();}},browseItemVisible:true,folderLinksContextId:25,browsableTypes:[Q.TP.FOLDER,Q.TP.FACT,Q.TP.ATTR,Q.TP.FUNCTION,Q.TP.FILTER,Q.STP.PROMPT_OBJECTS,Q.TP.ATTR,Q.TP.DIM,Q.TP.METRIC,Q.TP.ROLE].join(","),getSearchPattern:function a(){var AR=this._saveActiveToken,AT=AR&&AR.data.v,E=AT&&AT.length;if(E>2){if(AT.charAt(0)==="["){AT=AT.substring(1);}if(AT.charAt(AT.length-1)==="]"){AT=AT.substring(0,AT.length-1);}}if(AR&&AR.data.ift){var AS=AR.data.v,AU=AS&&AS.indexOf("@");if(AU>=0){AT=AS.substring(AU);}}return AT||"";},getSuggestionPos:function j(){var E=this._saveActiveToken,AR=null,AT,AS;if(E){AT=E.data&&E.data.ift;AS=mstrmojo.dom.position(E.domNode,true);AR={left:Math.round(AS.x+(AT?AS.w:0))+"px",top:Math.round(AS.y+AS.h)+"px",zIndex:100};}return AR;},item2textCss:function O(AR){var E=(this._super&&this._super(AR))||{4:"m",11:"fx",12:"a",13:"fc",43:"tr",21:"afm","-99":"br"}[AR.t]||"";E+=AR.da?" da":"";E+=(AR.dm||AR.um)?" dm":"";E+=AR.de?" de":"";E+=AR.fs&&AR.fs.length&&AR.fs.some(function(AS){return AS.fgr>0;})?" g":"";return E;},onBrowserOpen:function y(){this.editNode.blur();},onSuggestionItemSelect:function AG(AR){var E=this._saveActiveToken;this.endTokenSuggestion();if(E){if(E.data.ift&&AR.t===21){E.setFormInfo(AR);}else{E.setItemInfo(AR);if(AR.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){this.insertParenthesisTokens();}}this._delaySetCaretPos(E.domNode,false);}this.closePopup();},_delaySetCaretPos:function AL(E,AS){var AR=this.editNode,AT=this,AU=function(){AR.focus();AR.focus();H.collapseOnNode(E,AS);AT.set("_saveRangeInfo",H.getRangeInfo());};window.setTimeout(AU,0);},_delaySetTextCaretPos:function AL(E,AU){var AR=this.editNode,AS=this,AT=function(){AR.focus();AR.focus();H.collapseOnTextNode(E,AU);AS.set("_saveRangeInfo",H.getRangeInfo());};window.setTimeout(AT,0);},getCandidatesThroughTaskCall:function d(AR,E){AR.objectType="11,12,13,43,4";AR.rootFolderType=39;AR.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(AR,E);},filterCandidates:function u(AU,AT,E){var AR=this._saveActiveToken,AV=AR&&(AR.data.oi||AR.data.at),AS;if(AV&&AR.data.ift){E=E||this.suggestCount;AT=mstrmojo.string.regEscape(AT);AS=s.filter(AU,function(AW){return AW.t===21&&AW.attid===AV.did&&(new RegExp("^"+AT,"i")).test("@"+AW.n);},{max:E});}else{AS=s.filter(AU,function(AW){return AW.t!==21;});AS=this._super(AS,AT,E);}return AS;},endTokenSuggestion:function AM(AR){var E=this._saveActiveToken;if(E){if(AR){this.hideSuggestion();}E.set("active",false);this._saveActiveToken=null;}},widgetDeleteTokens:function o(AZ){var AR=AZ.startOffset,E=AZ.endOffset,Ac=R.findWidget(AZ.startContainer),Aa=R.findWidget(AZ.endContainer),AV=this.itemIndex(Ac.data),AT=this.itemIndex(Aa.data),AW=[],AX=H.getEdgeInfo(AZ.startContainer,AR),Ab=H.getEdgeInfo(AZ.endContainer,E),AY=(AX===k.EDGE_BEGIN?AV:AV+1),AS=(Ab===k.EDGE_END?AT:AT-1),AU;if(Ac===Aa){if((AX===k.EDGE_BEGIN)&&(Ab===k.EDGE_END)){this.remove(AV);Aa=this.ctxtBuilder.itemWidgets[AV===0?AV:AV-1];if(Aa){H.collapseOnNode(Aa.domNode,AV===0);}else{H.collapseOnNode(this.editNode,true);}}else{Ac.spliceContent(AR,E-AR);H.collapseOnTextNode(Aa.domNode,AR);}}else{for(AU=AY;AU<=AS;AU++){AW.push(AU);}this.remove(AW);if(AX===k.EDGE_MIDDLE){Ac.spliceContent(AR);}if(Ab===k.EDGE_MIDDLE){Aa.spliceContent(0,E);}if(AX===k.EDGE_BEGIN){Ac=this.ctxtBuilder.itemWidgets[AV===0?AV:AV-1];}if(Ac){H.collapseOnNode(Ac.domNode,AV===0);}else{H.collapseOnNode(this.editNode,false);}AV=(AX===k.EDGE_BEGIN)?AV-1:AV;this.checkMergeTwoTokens(AV,AV+1);}this.editNode.focus();},oncandidatesChange:function t(){var AR=this.candidates,E=(AR&&AR.items)||[];if(!this.noCache&&AR&&AR.isComplete){this.suggestCount=this.REQUEST_THRESHOLD=E.length;}else{this.suggestCount=mstrmojo.ME.MetricDataService.suggestCount;this.REQUEST_THRESHOLD=20;}},nudge:function(E){var AR=this.getSuggestionPos();if(AR){E.set("left",AR.left);E.set("top",AR.top);}},pretokensModify:function P(){this.tokensCache=this.tokensCache.slice(0,this.tokensCachePointer);var E=this.findObjectToken();this.tokensCache.push({items:K.clone(this.items),rInfo:H.getRangeInfo(),idx:E!==null?this.itemIndex(E.data):-1});this.tokensCachePointer=this.tokensCache.length;},widgetHandleUndoRedo:function m(AS){var AT,E,AR=function(AV){if(!AV){return ;}AV=AV||{};this.set("items",K.clone(AV.items));var AY=this.ctxtBuilder.itemWidgets,AU=AY[AV.idx],AX=AU&&AU.domNode||this.editNode,AW=AV.rInfo;this._delaySetTextCaretPos(AX,AW&&AW.startOffset||0);};switch(AS){case"undo":AT=--this.tokensCachePointer;if(AT>-1){E=this.tokensCache[AT-1];AR.call(this,E);}else{this.tokensCachePointer=1;}break;case"redo":AT=this.tokensCachePointer++;if(AT>-1&&AT<this.tokensCache.length){E=this.tokensCache[AT];AR.call(this,E);}else{this.tokensCachePointer=Math.min(Math.max(this.tokensCachePointer,1),this.tokensCache.length);}break;}},resetTokensCache:function Z(){this.tokensCache=[];this.tokensCachePointer=-1;this.tokensCacheInitilized=false;},toggleIMEStatusBar:function c(E){if((R.isIE9||R.isIE10||R.isIEW3C||R.isEdge)&&this.detectKoreanLocale()){if(E){if(!this.elStatus||!this.elStatus.offsetParent){var AR=this.elStatus=document.createElement("div");AR.innerText=mstrmojo.desc(15003,"Please enter space key to finish IME typing");AR.className="mstrmojo-TokenInputBox-status";this.domNode.appendChild(AR);}}else{this.domNode.removeChild(this.elStatus);delete this.elStatus;}}},detectKoreanLocale:function l(){var E=window.navigator;if(window.mstrConfig&&(window.mstrConfig.browserLang||[]).indexOf("ko")>=0){return true;}else{if(E.userLanguage=="ko"||E.userLanguage=="ko-KR"||E.browserLanguage=="ko"||E.browserLanguage=="ko-KR"){return true;}}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.tabs.Tab","mstrmojo.dom","mstrmojo.css");var N=mstrmojo.dom,b=mstrmojo.array,B=mstrmojo.css,h="animate",i="90px",n="70px",F="52px",w=200,Q=700,A=750;function D(){var AE=window.Modernizr,AD="transition";if(AE&&AE.testProp(AD)){return N.transEndEvtNames[AE.prefixed(AD)];}return null;}function y(AD){return function(){this.menuNode.style.display=AD?"block":"none";};}function P(AD){return Math.min(AD.offsetWidth-AD.firstChild.offsetWidth,0);}function x(AD){return AD.isAlignRight?"right":"left";}function AB(AD,AE){return parseInt(AD.style[x(AE)],10)||0;}function L(){var AH=this.tabContainerNode,AG=false,AF=false,AI=false,AJ=this.leftBtnNode,AD=this.rightBtnNode,AE=this.isValidMode();window.setTimeout(function(){if(P(AH)<0){var AL=N.position(AH),AK=N.position(AH.firstChild);AG=(AK.x<AL.x);AF=(AK.x+AK.w>AL.x+AL.w+1);}AI=AG||AF;B.toggleClass(this.btnBarNode,"highlightBar",AI);AJ.style.display=AD.style.display=AI?"block":"none";AJ.disabled=!AG;AD.disabled=!AF;B.toggleClass(AJ,"disable",!AG);B.toggleClass(AD,"disable",!AF);if(this.domNode){this.addBtnNode.style.display=this.tabStripMenuNode.style.display=AE?"block":"none";this.bufferNode.style.display=AE?"none":"block";this.floaterNode.style.display=this.hasFloater&&AG?"block":"none";}this.widgetResized();}.bind(this),w);}function U(AD,AE){AD=(AD||[]);if(!AD.filter){return b.filter(AD,AE);}return AD.filter(AE);}function X(AD,AE){AD=(AD||[]);if(!AD.map){return b.map(AD,AE);}return AD.map(AE);}function s(AT,AF,AG){var AR=this.tabContainerNode,AK=this.domNode;if(this.isStatic||!AR||!AK||AK.style.display==="none"){return ;}var AM=AR.firstChild,AS=P(AR),AJ=AB(AM,this),AD=Math.max(AJ,AS),AQ=U(this.children,function(AU){return AU.isSelected;})[0],AO=AG&&AG.domNode||AQ&&AQ.domNode;if(AT&&AO){if(AS<0){var AL=N.position(AO),AH=N.position(AR),AN=Math.floor(AL.x-AH.x),AP=Math.floor(AL.x+AL.w-(AH.x+AH.w));if(AG){var AE=Math.ceil(AO.offsetWidth);AN=AN===0?Math.max(AS,-AE):AN;AP=AP===0?Math.min(-AS,AE):AP;}var AI=AN<0?AN:(AP>0?AP:0);AD=this.isAlignRight?AD+AI:AD-AI;}}if(AD!==AJ){if(AF){this.setAnimation(AM);}AM.style[x(this)]=Math.max(AS,Math.min(AD,0))+"px";}L.call(this);}function C(AD){return AD.hasOwnProperty("index");}function J(){var AE=this.tabContainerNode,AF=N.position(AE),AD=this.isAlignRight;b.forEach(this.children||[],function(AH){var AN=AH.domNode,AO=N.position(AN),AK=Math.floor(AO.x-AF.x),AL=Math.floor(AO.x+AO.w-(AF.x+AF.w)),AG=AH.isSelected,AM=Math.ceil(AN.offsetWidth),AI=0;AH.isCutoff=AH.isHidden=AH.isLeftMost=AH.isRightMost=false;AH.leftEdgeHiddenWidth=AH.rightEdgeHiddenWidth=0;if(AK<0){var AJ=Math.abs(AK);AI=AM-AJ;AH.isLeftMost=AI>=0;AH.isCutoff=AH.isLeftMost&&AJ>0&&AI>0;AH.isHidden=AI<=0;AH.leftEdgeHiddenWidth=AJ;}else{if(AL>0){AI=AM-AL;AH.isRightMost=AI>=0;AH.isCutoff=AH.isRightMost&&AL>0&&AI>0;AH.isHidden=AI<=0;AH.rightEdgeHiddenWidth=AL;}}});}function Z(){var AD=this.children,AE=0;(AD||[]).every(function(AG,AF){if(!C(AG)){return false;}AE++;AG.index=AF;return true;});(AD||[]).every(function(AF){if(!C(AF)){return false;}AF.total=AE;return true;});}function g(AJ,AF){var AI=AJ.ENUM_CORNERS,AK=[AI.TOP_LEFT,AI.BOTTOM_LEFT],AE=this.parent;if(AE.position!=="bottom"){AK.reverse();}AJ.setAlignment(AK[0],AK[1]);var AD=N.position(AE.domNode),AH=AE.menuNode;var AG=AH.style;AG.top=(AF.y-AD.y)+"px";AG.left=(AF.x-AD.x)+"px";AJ.addPopupHandlers(AE.id,y(true),y(false));AJ.hostId=AE.id;AJ.hostElement=AH;AJ.isHostedWithin=false;AE.openPopup(AJ.newInstance());}function j(AD){AD.raiseEvent({name:"TabsChange"});}mstrmojo.vi.ui.tabs.TabStrip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-VITabStrip {@cssClass}" style="{@cssText}" ><div class="mstrmojo-VITabStrip-menu" mstrAttach:click><div id="tabCommonIcon" class="mstrmojo-VITabStrip-menuIcon"></div><div id="tabCommonButton" class="mstrmojo-VITabStrip-menuButton"></div><div id="tabCommonMenuHost" class="mstrmojo-VITabStrip-menuButtonHost"></div></div><div class="mstrmojo-VITabStrip-tabs"><div style="display:table"><div style="display:table-row"></div></div></div><div class="mstrmojo-VITabStrip-buffer"></div><div class="mstrmojo-VITabStrip-btnBar"><div class="mstrmojo-VITabStrip-addBtn" mstrAttach:click><div class="mstrmojo-VITabStrip-addBtn-Img"></div><div class="mstrmojo-VITabStrip-addBtn-Text"></div></div><div class="mstrmojo-VITabStrip-navBtns"><div id="tabRightButton" class="mstrmojo-VITabStrip-rightBtn" mstrAttach:click,mousedown,mouseup,mouseover,mouseout><div class="navBtnIcon"></div></div><div id="tabLeftButton" class="mstrmojo-VITabStrip-leftBtn" mstrAttach:click,mousedown,mouseup,mouseover,mouseout><div class="navBtnIcon"></div></div></div></div><div class="mstrmojo-VITabStrip-floater"></div><div class="mstrmojo-VITabStrip-menuHost"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{tabStripMenuNode:function(){return this.domNode.firstChild;},menuImgNode:function(){return this.domNode.firstChild.firstChild;},menuBtnNode:function(){return this.domNode.firstChild.childNodes[1];},menuBtnHostNode:function(){return this.domNode.firstChild.lastChild;},tabContainerNode:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},bufferNode:function(){return this.domNode.childNodes[2];},btnBarNode:function(){return this.domNode.childNodes[3];},addBtnNode:function(){return this.domNode.childNodes[3].firstChild;},addBtnImgNode:function(){return this.domNode.childNodes[3].firstChild.firstChild;},addBtnTxtNode:function(){return this.domNode.childNodes[3].firstChild.lastChild;},navBtnsNode:function(){return this.domNode.childNodes[3].lastChild;},rightBtnNode:function(){return this.domNode.childNodes[3].lastChild.firstChild;},leftBtnNode:function(){return this.domNode.childNodes[3].lastChild.lastChild;},floaterNode:function(){return this.domNode.childNodes[4];},menuNode:function(){return this.domNode.childNodes[5];},maskNode:function(){return this.domNode.lastChild;}},isStatic:false,isAlignRight:true,tabStripMenuNode:null,menuImgNode:null,menuBtnNode:null,menuBtnHostNode:null,tabContainerNode:null,addBtnNode:null,bufferNode:null,navBtnsNode:null,leftBtnNode:null,rightBtnNode:null,menuNode:null,position:"bottom",selectMovedTab:false,hasFloater:false,tabObjects:null,layoutConfig:{w:{tabContainerNode:"100%",bufferNode:"6px",addBtnNode:i,navBtnsNode:F,tabStripMenuNode:n},xt:true},onAppStateChange:function p(AK){var AI=mstrmojo.vi.VisualInsightApp.APP_STATES,AJ=AI.PRESENTATION,AD=AI.SELECTOR_TARGETING,AE=AK.value,AL=AK.valueWas,AH=this.isValidMode();if(AE&AJ||AL&AJ||AE&AD||AL&AD){var AF=this.addBtnNode,AG=this.tabStripMenuNode;if(AF&&AG){AF.style.display=AG.style.display=AH?"block":"none";this.bufferNode.style.display=AH?"none":"block";this.doLayout();}}},setStatic:function R(AD,AE){this.isStatic=AD;if(!AD){s.call(this,true,AE);}},setTabs:function o(AF,AD){this.removeChildren();this.tabObjects=AF;var AG=this,AE=(AF&&AF.length)||0;this.addChildren(X(AF,function(AJ,AH){var AI=AJ.k;return AG.getTabCfg(AF,AJ,{scriptClass:"mstrmojo.vi.ui.tabs.Tab",index:AH,total:AE,draggable:!!AE,dropZone:!!AE,k:AI,isSelected:AI===AD,showTabMenu:g,tabMoved:function(AL){var AK=this.index;AG.moveTab(AK,AK+(AL?-1:1),AK);}});}));s.call(this,true);j(this);},getTabs:function k(){return U(this.children,C);},getTabCfg:function AC(AE,AF,AD){return AD;},deleteTab:function I(AD){var AJ=this.id,AI=this.children[AD],AH=D(),AG=function(){var AK=mstrmojo.all[AJ];AK.removeChildren(AI);AI.destroy();Z.call(AK);L.call(AK);j(AK);};if(AH){var AF=AI.domNode.firstChild,AE=AF.style;AE.width=AF.offsetWidth+"px";window.setTimeout(function(){B.addClass(AF,h);N.attachOneTimeEvent(AF,AH,AG);AE.width=0;},0);}else{AG();}},buildRendering:function c(){this._super();B.toggleClass(this.domNode,"alignLeft",!this.isAlignRight);},postBuildRendering:function V(){var AD=this._super();s.call(this,true);return AD;},doLayout:function K(){this._super();s.call(this,true);},isValidMode:function E(){return !((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection())||(mstrApp.allowWebDashboardDesign&&!mstrApp.allowWebDashboardDesign()));},setSelectedTab:function S(AD){b.forEach(this.children||[],function(AE){AE.set("isSelected",AE.k===AD);});j(this);},getSelectedTab:function f(){var AF=null,AE=this.children||[],AD;for(AD=0;AD<AE.length;AD++){if(AE[AD].isSelected){AF=AE[AD];break;}}return AF;},onclick:function m(AD){if(!this.isValidMode()){return ;}if(AD.getTarget()===this.addBtnImgNode||AD.getTarget()===this.addBtnTxtNode){this.addTab();}},addTab:mstrmojo.emptyFn,clearBtnTooltips:function O(AF){var AD=(AF===this.leftBtnNode),AE=(AF===this.rightBtnNode);if(AD||AE){this.clearTooltips();return true;}return false;},showBtnTooltips:function G(AD){var AF=AD.getTarget().parentNode,AE=this.clearBtnTooltips(AF);if(AE){this.toggleTooltip(AF);}},onmouseout:function t(AD){var AE=AD.getTarget().parentNode;this.clearBtnTooltips(AE);},onmouseover:function H(AD){this.showBtnTooltips(AD);},onmouseup:function a(AD){window.setTimeout(function(){this.showBtnTooltips(AD);}.bind(this),w);},onmousedown:function e(AM){var AI=AM.getTarget().parentNode,AN=(AI===this.leftBtnNode),AG=(AI===this.rightBtnNode);if(AN||AG){var AL=this.tabContainerNode,AH=AL.firstChild,AD=this.id,AJ=this,AF;if(mstrApp.setInteractive){mstrApp.setInteractive(false);}B.addClass(AI,"active");var AK=function(){window.clearInterval(AF);B.removeClass(AI,"active");L.call(mstrmojo.all[AD]);if(mstrApp.setInteractive){mstrApp.setInteractive(true);}};N.attachOneTimeEvent(document.body,"mouseup",AK);var AE=function(){var AQ=P(AL),AT=AB(AH,AJ),AU=AT-AQ,AS=0-AT;J.call(AJ);AJ.setAnimation(AH);var AO=AJ.getCornerTabs()||[],AR=U(AO,function(AV){if(AN&&AV.isLeftMost||AG&&AV.isRightMost){return AV;}})[0],AP=0;if(AR){AP=AR.isCutoff?(AN?AR.leftEdgeHiddenWidth:AR.rightEdgeHiddenWidth):Math.ceil(AR.domNode.offsetWidth);AP=Math.min(AP,AN?AS:AU);AP=AJ.isAlignRight?(AN?-AP:AP):(AN?AP:-AP);}AH.style[x(AJ)]=parseInt(AH.style[x(AJ)]||0)+AP+"px";};AE();AF=window.setInterval(function(){AE();},A);}},getCornerTabs:function d(){return U(this.children,function(AD){return AD.isLeftMost||AD.isRightMost;});},setAnimation:function Y(AD){var AE=D();if(AE){B.addClass(AD,h);N.attachOneTimeEvent(AD,AE,function(){B.removeClass(AD,h);});}},createTooltip:function z(AE){var AG=document.createElement("div");AG.className="navBtnTooltip";AG.appendChild(document.createTextNode(AE.getAttribute("tooltip")||""));var AJ=document.body.firstChild;AJ.parentNode.insertBefore(AG,AJ);var AH=5,AK=AG.offsetWidth-25,AF=AE.getBoundingClientRect(),AI=AG.getBoundingClientRect(),AD=AF.top-(AI.height+AH);AG.style.top=AD+"px";AG.style.left=(AF.left-AK)+"px";return AG;},clearTooltips:function l(){window.clearTimeout(this._tooltipTimeOut);var AD=document.querySelectorAll(".navBtnTooltip");b.forEach(AD||[],function(AE){AE.parentNode.removeChild(AE);});},toggleTooltip:function AA(AD){window.clearTimeout(this._tooltipTimeOut);if(AD.disabled){this._tooltipTimeOut=window.setTimeout(function(){this.createTooltip(AD);}.bind(this),Q);}},moveTab:function M(AD,AL,AJ,AI){var AE=this.children,AM=AE.splice(AD,1)[0];AE.splice(AL,0,AM);Z.call(this);this.setAnimation(this.tabContainerNode.firstChild);var AF=this.containerNode,AG=AF.childNodes,AK=AF.removeChild(AG[AD]),AH=AG[AL];if(AH){AF.insertBefore(AK,AH);}else{AF.appendChild(AK);}if(this.selectMovedTab||AM.isSelected){s.call(this,true,true,AM);}if(!AI&&AJ!==undefined&&AJ!==AL){this.commitTabMove(AJ,AL);j(this);}},commitTabMove:function u(AD,AE){throw new Error(this.scriptClass+" must implement commitTabMove.");},updateTabTable:function q(){if(!this.isStatic){s.call(this,true);}},setLinkIcon:function W(AD,AG){var AF,AE;if(AD){if(AG){AE="src";b.some(this.getTabs(),function(AH){if(AH.k===AG){AF=AH;}return AF;});if(!AF){return ;}}else{AE="tgt";AF=this.getSelectedTab();}B.addClass(AF.domNode,AE);}else{AE=AG?["src","tgt"]:"tgt";b.forEach(this.children,function(AH){B.removeClass(AH.domNode,AE);});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.color","mstrmojo.dom","mstrmojo.css","mstrmojo._HasOwnAvatar","mstrmojo.Container","mstrmojo.threshold.ThresholdModel","mstrmojo.threshold.ColorMarker");var P=mstrmojo.color,D=mstrmojo.dom,Q=mstrmojo.css;function B(W){var V=this.parent,U=V.width,X=Math.min(Math.max(W.last.x-D.position(this.domNode).x,0),U-1);return X/U;}mstrmojo.threshold.MarkersNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.threshold.MarkersNode",cssClass:"markers",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"  mstrAttach:click,mousedown,mouseover,mouseout></div>',markupSlots:{containerNode:function N(){return this.domNode;}},dropZone:true,draggable:true,avatarCssClass:"marker-drag-avatar",addMarker:function O(b){this.parent.parent.switchToCustomScheme();var U=this.parent,e=U.parent.model,d=D.position(this.containerNode).w,V=U.getPalette(),Z=b/d,X=U.addMarkerToMap(Z),a=V.length,Y=new mstrmojo.threshold.ColorMarker();Y.updateCompValue(Z);Y.updateRealValue(e.getRealValue(Z,U.selectedOption,U.minValue(),U.maxValue()));Y.set("index",X);this.addChildren([Y]);if(a===(X+1)){X--;}if(this.selectedIndex!==undefined&&this.selectedIndex>-1&&this.selectedIndex<this.children.length){this.children[this.selectedIndex].unselect();}this.selectedIndex=Y.index;var W=V[X+1],c=X===-1?W:V[X];V.splice(X+1,0,P.findMidColorHex(c,W));U.update();this.children[this.selectedIndex].select();},remove:function L(U){if(U<0||U>=this.children.length){return ;}this.children[U].unselect();this.children.splice(U,1);this.domNode.removeChild(this.domNode.children[U]);},onclick:function S(V){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED&&V.getTarget()===this.domNode){var W=D.position(this.containerNode),U=V.e.clientX-W.x;this.addMarker(U);}},createAvatar:function K(X,W){var V;for(V=0;V<this.children.length;V++){if(this.children[V].id===X.id){W.tgtNode=this.children[V];W.i=V;}}var U=X.cloneNode(true),Y=document.createElement("div");Q.addClass(Y,"bar");U.appendChild(Y);return U;},positionAvatar:function I(a){var U=this.avatar,W=U.style,Y=this.restrictedToAxis,V=D.position(this.domNode),X=V.y;if(U){if(Y!=="y"){var Z=a.x;if(Z<V.x){Z=V.x;}if(Z>V.x+V.w){Z=V.x+V.w-1;}W.left=Z-2+"px";}if(Y!=="x"){W.top=X+"px";}}},getMarkerComps:function H(U){if(!this.children){return undefined;}var V=this.children.map(function(W){return W.compValue;});return !!U?V.sort(U):V;},getMarkerRealValues:function M(U){if(!this.children){return undefined;}var V=this.children.map(function(W){return W.realValue;});return !!U?V.sort(U):V;},setMarkerRealValues:function E(V,X,U,W){if(!this.children){return ;}this.children.forEach(function(Z,Y){Z.updateRealValue(V(Z.compValue,X,U,W));});},isDragValid:function A(U){return U.src.node!==this.domNode;},ondragstart:function R(V){this._super(V);var U=this.parent.getComp();this.selectedIndex=V.i;U.splice(V.i,1);},ondragmove:function J(W){this._super(W);var V=this.parent,Z=V.parent.model,Y=B.call(this,W),b=this.children[W.i],U=W.tgt.pos.x-W.src.pos.x,X=U<0,a=U>0;if((b.compValue===0&&X)||(b.compValue===1&&a)){return ;}b.updateCompValue(Y);b.updateRealValue(Z.getRealValue(Y,V.selectedOption,V.minValue(),V.maxValue()));V.editableBubble.showBubble(Y,b.realValue);},ondragend:function F(Z){var Y=this.parent,V=Y.getComp(),b=this.children[Z.i],X=b.index,W=this.children.filter(function(c){return(c.index>b.index&&c.compValue<b.compValue)||(c.index<b.index&&c.compValue>b.compValue);}).map(function(d){return d.index;});if(W.length>0){var U=W[0],a=W[W.length-1];X=(b.index>U)?U:a;}V.splice(X,0,b.compValue);this.remove(b.index);Y.update();this.children[X].select();this._super(Z);},onmouseover:function G(V){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED&&!this._cursorAvatar){var Y=document,X=this.domNode,W=this._cursorAvatar=Y.createElement("div"),U=this._mouseMoveHandler=function(c){var b=D.eventTarget(self,c),a=D.getMousePosition(c,self),Z=W.style;Z.top=a.y+12+"px";Z.left=a.x+12+"px";Z.display=(b===X&&mstrApp.isInteractive())?"block":"none";};Y.body.appendChild(W);Q.addClass(W,"mstrmojo-SimpleThresholdEditor add-cursor");D.attachEvent(X,"mousemove",U);}if(this._super){return this._super(V);}},onmouseout:function C(U){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED){D.detachEvent(this.domNode,"mousemove",this._mouseMoveHandler);var V=this._cursorAvatar;V.parentNode.removeChild(V);delete this._cursorAvatar;delete this._mouseMoveHandler;}if(this._super){return this._super(U);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.array","mstrmojo.string","mstrmojo.Button","mstrmojo.css","mstrmojo.hash","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.func");mstrmojo.requiresDescs(221,1442,2751,2891,11949,11950,11951,11942,13397,13398,14640,14648);var S=mstrmojo.array,W=mstrmojo.css,O=mstrmojo.hash,P=mstrmojo.func,D=mstrmojo.string,N=mstrmojo.Button.newWebButton,Q=mstrmojo.dom,V="mstrmojo-link-validation",R="mstrmojo-link-vt",G=function G(X){if(X.old){this.removedLinks.push(X);}this.links.removeChildren(X);},U=function U(){var w=this.dsMap,s=this.docModel,b=s.datasets,z=function z(i,k,a){var j={n:a||"",did:k||null,parent:i||null,lv:(i?i.lv+1:-1),children:[]};if(i){i.children.push(j);}return j;},g=z(),Z,Y,X,l,c,t,n,y,u,q,p,o,e,d,f,m,h;O.forEach(b,function(a){if(s.isMDXDataset(a)){c=a.tables;for(q=0,d=c.length;q<d;q++){t=c[q];Z=z(g,t.did,t.n);Z.isMDX=true;for(p=0,f=t.dimensions.length;p<f;p++){n=t.dimensions[p];Y=z(Z,n.did,n.n);for(o=0,m=n.hierarchies.length;o<m;o++){y=n.hierarchies[o];X=z(Y,y.did,y.n);for(e=0,h=y.att.length;e<h;e++){u=y.att[e];l=z(X,u.did,u.n);l.att=u;w[t.did+":"+u.did]=l;}}}}}else{Z=z(g,a.did,a.name);Z.isMDX=false;S.forEach(a.att,function(i){l=z(Z,i.did,i.n);l.att=i;w[a.did+":"+i.did]=l;});}});return g;},B=function B(d,e){d=S.ensureArray(d);var c=this,b=this.attribute.did,f=this.docModel,Z=this.datasetId,Y="\u001F",X={success:function(h){var j=h.als,g=(f.als&&f.als.links)||{},i=c.dsTree;S.forEach(d,function(s,m){var t={},k={},l=[],n={},q=b+" "+s,o=S.filter(j[m].ats,function(u){return !f.isInDataset(Z,u.at,["att"]);}),p=function p(u,w){if(!n[u]){n[u]={};}if(!n[u][w]){n[u][w]=true;}};S.forEach(o,function(x){var u=x.at,w=x.fms;t[u]=true;if(w){S.forEach(w,function(y){p(u,y.fm);});}});O.keyarray(g).forEach(function(u){if(u===q){S.forEach(g[u],function(w){w=w.split(" ");t[w[0]]=true;p(w[0],w[1]);});}});if(O.keyarray(t).length>0){S.forEach(i.children,function(w){var u=function(x){var y;if(!x.att){return ;}x=x.att;if(t[x.did]){if(!k[x.n]){k[x.n]={};}if(!k[x.n][x.did]){k[x.n][x.did]=[];}k[x.n][x.did].push(w.n);y=O.copy(x,y);y.dsId=w.did;l.push(y);}};if(w.isMDX){S.forEach(w.children,function(x){S.forEach(x.children,function(y){S.forEach(y.children,u);});});}else{S.forEach(w.children,u);}});}c.tgtAttrs[s]=l;c.tgtForms[s]=n;c.namesHash[s]=k;});}},a={taskId:"validateDocumentLinks",msgID:f.mid,action:1,attributeList:b,attributeFormList:d.join(Y)};mstrApp.serverRequest(a,P.wrapMethods(X,e));},F=function(a,c,Y,b){a.richTooltip=null;if(!a.isSearching){var Z=c&&c.scrollWidth>c.clientWidth;Y=Z?mstrmojo.desc(14648,"## from ###").replace("##",Y):"";if(b){if(!Z){Y=mstrmojo.desc(14640,"From ###");}Y=Y.replace("###",b);}var X=mstrmojo.dom.position(c);a.richTooltip={cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:Y,top:X.y-6,left:X.x};}},E=function E(e){var f=this,h=function(o){var m=o.fs,p=o.de,n=[];(m||[]).forEach(function(q){if(q.obf&&(!p||q.idf)){n.push({n:q.fnm,v:q.fid,idf:q.idf});}});return n;},i=h(this.attribute),b=function(p,n){var m=h(p);var q=(f.tgtForms[n]&&f.tgtForms[n][p.did])||{};var o=[];S.forEach(m,function(s){if(q[s.v]){o.push(s);}});return o;},d=function d(n){var m=[];S.forEach(f.tgtAttrs[n],function(o){if(b(o,n||f.idFormId).length>0){var q=f.namesHash[n],p=o.n;if(q[o.n]&&O.keyarray(q[o.n]).length>1){p=p+" ("+q[o.n][o.did].join(",")+")";}m.push({n:o.n,v:o,tt:p});}});if(m.length===0){m.push({n:mstrmojo.desc(13398,"No valid object"),v:{did:null},cls:"nvo",t:1});}return m;},j=d((e&&e.srcFormId)||this.idFormId),k=function(m,n){return S.find(m.fs,n?"fid":"idf",n||true);},l=function(n){var m=-1;j.forEach(function(p,o){if(p.v.did===n){m=o;}});return m;},Y=function(n){var m=j[n];if(!m){return mstrmojo.desc(13397,"Select an attribute");}else{return m.n;}},Z=function(n){var o=n.items,m=n.selectedIndex;if(m>=0){if(o[m].idf){return ;}}o.forEach(function(q,p){if(q.idf){n.set("selectedIndex",p);}});};this.links.addChildren({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linkRow",slot:"containerNode",old:!!e,oldMeta:e,getMeta:function(){var m=this.linkFromForm,o=this.linkToAtt,n=this.linkToForm;return{srcAttrId:f.attribute.did,srcFormId:m.items[m.selectedIndex].v,tgtAttrId:o.items[o.selectedIndex]&&o.items[o.selectedIndex].v.did,tgtFormId:n.items[n.selectedIndex]&&n.items[n.selectedIndex].v};},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-attName",text:f.attribute.n,useRichTooltip:true,updateTooltipConfig:function(q){var p=q.target,m=D.encodeHtmlString(this.text),n=f.datasetId,o=n?f.docModel.datasets[n].name:"";F(this,p,m,o);}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormFromPD",alias:"linkFromForm",value:"ID",isHostedWithin:true,items:i,selectedIndex:k(f.attribute,e&&e.srcFormId),onitemSelected:function(n){var m=this,o=function(){var q=m.parent.linkToAtt;j=d(n.v);q.set("items",j);q.set("selectedIndex",-1);q.set("text",mstrmojo.desc(13397,"Select an attribute"));W.addClass(q.selectedNode,"nvo");},p={success:o};if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!n.idf){Z(this.parent.linkToForm);if(!f.tgtForms[n.v]){B.call(f,n.v,p);return ;}}o();}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-linksToLabel",text:mstrmojo.desc(11949,"links to")},{scriptClass:"mstrmojo.ui.SearchablePulldown",cssClass:"mstrmojo-linkToAtt",alias:"linkToAtt",useRichTooltip:true,isHostedWithin:false,items:j,text:Y(l(e&&e.tgtAttrId)),selectedIndex:l(e&&e.tgtAttrId),allowCustomText:true,allowEmptyText:true,allowHTML:false,updateTooltipConfig:function(s){var q=s.target,m=q.getAttribute("tt"),o=this.getSelectedItem(),n=o?o.v.dsId:null,p=n?f.docModel.datasets[n].name:"";if(this.selectedNode===q&&o){m=o.tt;}F(this,q,D.encodeHtmlString(m),p);},onitemSelected:function(q){if(!q||q.v.did===null){return ;}var p=this.parent.linkToForm,o=this.parent.linkFromForm,n=b(q.v,o.items[o.selectedIndex].v),s=function s(t,w){var u=S.find(t,w?"v":"idf",w||true);if(u===-1&&t.length>0){u=0;}return u;},m;S.forEach(n,function(t){if(t.idf){m=false;return false;}});if(m){L.call(f,true);}p.set("items",n);p.set("selectedIndex",s(n,!this.hasRendered&&e&&e.tgtFormId));if(this.hasRendered&&this.parent.old){this.parent.oldUpdated=true;}K.call(f);},onPopupWidgetOpened:function c(){if(this.selectedIndex===-1){this.set("text","");}W.removeClass(this.selectedNode,"nvo");},onPopupWidgetClosed:function g(){mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this);if(this.selectedIndex===-1&&this.text===""){this.set("text",mstrmojo.desc(13397,"Select an attribute"));W.addClass(this.selectedNode,"nvo");}else{W.removeClass(this.selectedNode,"nvo");}this.hideTooltip();S.forEach(f.collapseTargets,function(m){m.className="arrow-b";W.removeClass(m.parentNode.parentNode,"collapse");});S.forEach(f.collapseTreeNodes,function(m){delete m.collapse;});S.forEach((this.list.itemsContainerNode||{}).childNodes,function(m){m.style.display="";});},postBuildRendering:function X(){mstrmojo.ui.SearchablePulldown.prototype.postBuildRendering.call(this);if(this.selectedIndex===-1){W.addClass(this.selectedNode,"nvo");}this.list.popupConfig.clear();},getPopupListConfig:function a(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",width:"170px",tooltipOrientation:"vertical",selectionPolicy:"reselect",useRichTooltip:true,allowHTML:false,locksHover:true,listHooks:{select:function m(t,u,s){this.parent.set("selectedIndex",s);this.close();}},onclick:function n(AB){try{var t=AB.getTarget(),AC=this.getItemFromTarget(t),y=Q.findAncestorByAttr(t,"idx",true,this.domNode),x=this.items;if(x){this.parent.set("items",x);}if(AC){AB.cancel();if(t.className==="arrow-b"||t.className==="arrow-r"){var s=this.itemsContainerNode.childNodes,w=function w(AE){var AD;while(AE){AD=AE.className||"";if(AD.indexOf("lv")===0){return window.parseInt(AD.substring(2),10);}AE=AE.firstChild;}return null;},AA=function AA(AD,AG){var AF=f.dsMap,AE=AF[AD.dsId+":"+AD.did];while(AE){if(AE.lv===AG){return AE;}AE=AE.parent;}return null;},z=function z(){var AM=(t.className==="arrow-b"),AG=t.parentNode.parentNode,AD=w(AG),AH=AC._renderIdx,AE=AA(AC.v,AD),AK=x.length,AJ,AF,AI,AL,AO,AN;t.className=AM?"arrow-r":"arrow-b";if(!f.collapseTargets){f.collapseTargets=[];}f.collapseTargets.push(t);W.toggleClass(AG,"collapse",AM);AE.collapse=AM;if(!f.collapseTreeNodes){f.collapseTreeNodes=[];}f.collapseTreeNodes.push(AE);for(AJ=AH+1;AJ<AK;AJ++){AF=s[AJ];AI=w(AF);if(AI<=AD){break;}AL=AA(x[AJ].v,AI);AO=AL.parent;AN=true;while(AO){if(AO.collapse){AN=false;break;}AO=AO.parent;}AF.style.display=(AN?"":"none");}};z();}else{if(y&&y.node.className.indexOf("item")!==-1){this.doItemSelect(AC,AB||{});}}}}catch(u){mstrApp.onerror(u);}},getItemProps:function o(u,s){var t=mstrmojo._IsList.getItemProps.call(this,u,s);var w=u.cls;if(w){t.addCls(w);}return t;},getItemMarkup:function q(AD,AC){if(AD.v.did===null){return'<{@tag} class="item {@cls}" did="'+AD.v.did+'" idx="{@idx}" style="{@style}">{@n}</{@tag}>';}var AE=[],AA=AD.v.did,u=AD.v.dsId,w=u?f.docModel.datasets[u]:null,t=w?D.encodeHtmlString(w.name):"",AB=AC>0&&this.items[AC-1].v,y=f.dsMap,x=y[AD.v.dsId+":"+AA],s=y[(AB&&(AB.dsId+":"+AB.did))];AE.push("</div>");while(x){if(x.lv===-1){break;}if(x.att){var z=x.att.da?"derived-attr":"attr";AE.push('<div class="lv'+x.lv+' dim item {@cls}" tt="'+AD.tt+'" did="'+AA+'" dsName="'+t+'" idx="{@idx}" style="{@style}"><div><div class="'+z+'"></div></div>{@en@n}</div>');}else{if(x!==s){AE.push('<div class="lv'+x.lv+' dim" dtt="'+x.n+'" idx="{@idx}"><div><div class="arrow-b"></div></div>'+x.n+"</div>");}else{break;}}x=x.parent;s=(s&&s.parent)||null;}AE.push("<div>");return AE.reverse().join("");},updateTooltipConfig:function p(y){var x=y.target,u=x.getAttribute("tt"),t=x.getAttribute("dtt"),w=x.getAttribute("dsName"),s=u||t;if(s){F(this,x,D.encodeHtmlString(s),w);}}};}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormToPD",alias:"linkToForm",value:"ID",isHostedWithin:true,items:[],onitemSelected:function(m){if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!m.idf){Z(this.parent.linkFromForm);}}}},N("",function(){G.call(f,this.parent);},false,{cssClass:"mstrmojo-removeLink"})]});this.links.renderChildren();},L=function(X){W.toggleClass(this.editorNode,"mstrmojo-advanced",X);},M=function(a){var Y=this,b=V,X;try{mstrmojo.all[b].destroy();}catch(Z){}X={scriptClass:"mstrmojo.Editor",id:b,title:mstrmojo.desc(2751,"Message"),cssClass:"mstrmojo-alert",buttons:[N(mstrmojo.desc(1442,"Ok"),function(){mstrmojo.all[b].destroy();I.call(Y);},true)],children:[{scriptClass:"mstrmojo.Label",text:a}],visible:true,zIndex:1000};mstrmojo.insert(X).render();},I=function(){var Z=this,Y=this.illLinks,X=this.links.children,a=R;S.forEach(Y,function(b){b=b.al;S.forEach(X||[],function(d){var f=d.getMeta(),g=d.linkToAtt,c,e;if(f.srcAttrId===b.alaid1&&f.tgtAttrId===b.alaid2){if(!mstrmojo.all[a]){e=new mstrmojo.Tooltip({id:a,cssClass:Z.themeClassName+" vi-warning vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,updatePopupConfig:null});Q.attachEvent(Z.editorNode,"click",function(){e.close();W.toggleClass(g.selectedNode,"mstrmojo-Warning",false);});}else{e=mstrmojo.all[a];}e.close();c=mstrmojo.dom.position(g.selectedNode);e.set("top",c.y-6);e.set("left",c.x);e.set("content",b.alstmsg);W.toggleClass(g.selectedNode,"mstrmojo-Warning",true);e.open();return false;}});});},A=function(){var X=mstrmojo.all[R];if(X){X.close();}},K=function K(){this.buttons[0].enabled=true;if(this.btnHbox){this.btnHbox.children[0].set("enabled",true);}},H=function H(){var X=this,Y=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-toolBox",alias:"tools",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-addLink",text:mstrmojo.desc(11950,"Add A Link"),title:mstrmojo.desc(11950,"Add A Link"),onclick:function(){E.call(X);A.call(X);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-showForms",text:mstrmojo.desc(2891,"Show Attribute Forms"),title:mstrmojo.desc(2891,"Show Attribute Forms"),onclick:function(){L.call(X,true);A.call(X);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-hideForms",text:mstrmojo.desc(11951,"Hide Attribute Forms"),title:mstrmojo.desc(11951,"Hide Attribute Forms"),onclick:function(){L.call(X,false);A.call(X);}}],slot:"containerNode"},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linksBox mstrmojo-advanced",alias:"links",slot:"containerNode"}];this.addChildren(Y);};mstrmojo.vi.ui.editors.AttributeLinkEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",title:mstrmojo.desc(11942,"Link Attributes"),cssClass:"mstrmojo-att-link",btnAlignment:"right",buttons:null,modal:true,visible:false,help:"link_attributes_editor.htm",attribute:null,tgtAttrs:null,tgtForms:null,docModel:null,datasetId:null,namesHash:null,removedLinks:null,preBuildRendering:function C(){var a=this,Y=this.docModel,Z=function(){var b=(Y.als&&Y.als.links)||{},c=[];O.keyarray(b).forEach(function(d){if(d.indexOf(a.attribute.did+" ")===0){b[d].forEach(function(e){c.push({srcAttrId:d.split(" ")[0],srcFormId:d.split(" ")[1],tgtAttrId:e.split(" ")[0],tgtFormId:e.split(" ")[1]});});}});return c;},X;this.set("buttons",[N(mstrmojo.desc(1442,"OK"),function(){var i=[],c=a.links.children,b=function(){var j=Y.controller,k=Y.controller.getRefreshCallback();if(i.length>0){j.cmdMgr.execute({execute:function(){this.submit(i,k,{style:{params:{treesToRender:3}}});},urInfo:{callback:k}});}a.close();},h=false,e,f;a.removedLinks.forEach(function(j){e=O.copy(j.oldMeta,{act:"applyAttributeLinking",unlink:true});i.push(e);});(c||[]).forEach(function(j){if(j.old&&j.oldUpdated){e=O.copy(j.oldMeta,{act:"applyAttributeLinking",unlink:true});i.push(e);}if(!j.old||(j.old&&j.oldUpdated)){f=j.getMeta();if(!f.tgtAttrId){return ;}e=O.copy(f,{act:"applyAttributeLinking",unlink:false});i.push(e);}});S.forEach(i,function(j){if(!j.unlink){h=true;return false;}});if(!h){b();return ;}var g={taskId:"validateDocumentLinks",msgID:Y.mid,action:2,manipulationList:'{"ml":'+JSON.stringify(i)+"}"},d={success:function(j){if(j.als&&j.als.length>0){var k="";S.forEach(j.als,function(l){k+=l.al.alstmsg+"\n";});a.illLinks=j.als;M.call(a,k);return ;}b();}};mstrApp.serverRequest(g,d);},true,{enabled:false}),N(mstrmojo.desc(221,"Cancel"),function(){a.close();})]);H.call(this);X=Z(this.attribute.did);if(X.length>0){X.forEach(function(b){E.call(a,b);});K.call(this);}else{E.call(this);}this._super();},close:function J(){A.call(this);this.destroy();}});mstrmojo.vi.ui.editors.AttributeLinkEditor.open=function(d){var Y=mstrmojo.insert(O.copy(d,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",tgtAttrs:{},tgtForms:{},namesHash:{},removedLinks:[]})),b=Y.attribute,e=b.did,X=Y.docModel,a=(X.als&&X.als.links)||{},Z=[],c={success:function(){Y.set("visible",true);Y.render();}};S.forEach(b.fs,function(g){if(g.idf){Y.idFormId=g.fid;return false;}});O.keyarray(a).forEach(function(g){var f=g.split(" ");if(f[0]===e){Z.push(f[1]);}});if(S.indexOf(Z,Y.idFormId)===-1){Z.push(Y.idFormId);}Y.dsMap={};Y.dsTree=U.call(Y);B.call(Y,Z,c);};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui._MonitorsTocPage","mstrmojo.vi.ui.LinkTargetSelector","mstrmojo.vi.ui.InlineDialogBase");mstrmojo.vi.ui.VisAsFilterInlineDialog=mstrmojo.declare(mstrmojo.vi.ui.InlineDialogBase,[mstrmojo.vi.ui._MonitorsTocPage],{scriptClass:"mstrmojo.vi.ui.VisAsFilterInlineDialog",_createTargetSelector:function C(){return new mstrmojo.vi.ui.LinkTargetSelector({alias:"targetSelector",orientation:"h",hostId:this.id,srcId:this.vis.id});},_setTargetsFunc:function B(){var E=this.vis,D=E.model;D.setVisAsFilter(E,this.changes);},_tocNavWarn:function A(D){var F=this,E=F.vis.model;mstrmojo.warn(mstrmojo.desc(15094,"Selecting targets on another page will discard all the selected targets on the current page."),{confirmBtn:{t:mstrmojo.desc(212,"Continue"),fn:function(){var G=E.getVizContentPanel()._tgtSelections;G&&G.clear();F.goToPage(D);},hot:true},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}},{title:mstrmojo.desc(15093,"Do you want to target visualizations on another page?")});}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.string","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.vi.ui.InlineDialogBase");mstrmojo.requiresDescs(16166,11955,11956);var A=mstrmojo.css,D=mstrmojo.string;mstrmojo.vi.ui.FilterBoxInlineDialog=mstrmojo.declare(mstrmojo.vi.ui.InlineDialogBase,null,{scriptClass:"mstrmojo.vi.ui.FilterBoxInlineDialog",tocEnabled:false,selectFilters:true,init:function F(G){this._super(G);A.addWidgetCssClass(this,"filter-box-dialog");},_setTargetsFunc:function E(){this.vis.setTargets(this.changes.filterKeys);},toggleFields:function B(){if(this.cgbs.length!==0){this.forType.set("visible",true);}},_addChildren:function C(){var J=this,L=J.vis,H=L.model,M=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:mstrmojo.desc(16166,"Use <span>#</span> to filter data in").replace("#",D.encodeHtmlString(L.title)),visible:true},J._createTruncatedList(),{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-for-type",cssDisplay:"inline-block",alias:"forType",value:0,visible:false,selectedIndex:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(11955,"for #").replace("#",(J.cgbs[0]||{}).n),v:false},{n:mstrmojo.desc(11956,"for All Data"),v:true}],onitemSelected:function(N){J.changes.forAllData=N.v;},onenabledChange:function(){A.toggleClass(this.domNode,"disabled",!this.enabled);}}],G=H.getPanel(this.currentPanelKey,this.currentLayoutKey).children||[],I,K={};for(I=G.length-1;I>=0;I--){J._addVis(G[I],K);}this.addChildren(M);this.targetKeys=K;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.hash","mstrmojo.css");var A=mstrmojo.hash.copy;mstrmojo.ui.editors.controls.AdvancedColorPickerPopup=mstrmojo.declare(mstrmojo.ui.editors.controls.AdvancedColorPicker,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",locksHover:true,init:function E(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-AdvColorPickerPopup");},showPickerForCurrentMode:function D(){this._super();var G=this,F=function F(){if(G.visible){G.adjustCornersForPopupOverflow();}};if(this.pickerMode===2){this.colorStyle.markupMethods=A({onselectedIndexChange:F},A(this.colorStyle.markupMethods));}F();},onOpen:function C(){var F=this.parent;this.set("color",F?F.selectedValue:this.color);this.renderContent();this._super();},colorCanceled:function B(){this.close();}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.num","mstrmojo.dom","mstrmojo.date","mstrmojo.Container","mstrmojo.VBox","mstrmojo.Button","mstrmojo.locales","mstrmojo._FormatDefinition","mstrmojo.mstr.EnumFunction","mstrmojo.ui.editors.controls.ComboBox","mstrmojo.vi.util.NumberFormatUtility");var M=mstrmojo.hash,c=mstrmojo.array,G=mstrmojo.num,J=mstrmojo._FormatDefinition,B=mstrmojo.css,a=mstrmojo.mstr.EnumFunction,L=mstrmojo.locales,H=mstrmojo.Button.newIconButton,O=mstrmojo.date,I=mstrmojo.vi.util.NumberFormatUtility,s="1234.12",E=J.NumberFormatCategory,p=J.FixedNegative,F=J.CurrencyNegative,f=J.PercentNegative,K=J.DefaultFormat.FormattingNumber,n="nf-MiddleRow ",X="nf-MiddleRow nf-HasWidget ",Z,U,e=function e(u,t){return{cls:this.value===u.v?"selected":"",v:u.v||"",n:u.n||"",style:u.r?"color:red;":"color:#fff;",sel:parseInt(this.idx,10)===t?"selected":""};},o={RIGHT:1,LEFT_WITH_SPACE:2,RIGHT_WITH_SPACE:3};var S=[{n:mstrmojo.desc(4531,"Automatic"),v:-3}].concat(J.Category.slice(2)),d=[{n:"$"},{n:"£"},{n:"€"},{n:"¥"},{n:"fr."}];function D(w,u){var t=c.find(w,"v",u);return t===-1?"":w[t].f;}function N(t){var w=this.parent.parent.parent.myData,u=t.v;w.set("format",D(this.items,u));w.set("negativeNumbers",u);B.toggleClass(this.selectedNode,"red",t.r);}function Y(w,x,t){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:w,onitemSelected:function u(y){var z=this.parent;while(z&&(!z.data||typeof z.data[x]==="undefined")){z=z.parent;}if(z){z.data.set(x,y.v);if(t){z.children[0].preview.preview_label.set("text",y.n);}}}};}function i(AE,z,y,AH,AD){var AG=M.clone(AE),u=z>0?L.number.DECIMALSEPARATOR:"",w=z>0?".":"",x=J.DefaultFormat.FormattingNumber,AF=new RegExp("\\"+L.number.THOUSANDSEPARATOR,"g"),t=new RegExp("\\"+L.number.DECIMALSEPARATOR+"\\d{2}","g"),AB;for(AB=0;AB<z;AB++){u+=AB%9;w+="0";}for(AB=0;AB<AG.length;AB++){var AC=AG[AB];AC.n=AC.n.replace(/,/g,"@");AC.n=AC.n.replace(/\./g,L.number.DECIMALSEPARATOR);AC.n=AC.n.replace(/@/g,L.number.THOUSANDSEPARATOR);if(y){AC.n=AC.n.replace(AF,"");AC.f=AC.f.replace(/,/g,"");}if(AH&&AH!==x.CurrencyPosition){switch(AH){case o.RIGHT:AC.n=AC.n.replace(/\$/g,"").replace(t,L.number.DECIMALSEPARATOR+"12$");AC.f=AC.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00"$"');break;case o.LEFT_WITH_SPACE:AC.n=AC.n.replace(/\$/g,"$ ");AC.f=AC.f.replace(/\$/g,"$ ");break;case o.RIGHT_WITH_SPACE:AC.n=AC.n.replace(/\$/g,"").replace(t,L.number.DECIMALSEPARATOR+"12 $");AC.f=AC.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00" $"');break;default:}}AC.n=AC.n.replace(t,u);AC.f=AC.f.replace(/\.\d{2}/g,w);if(AD&&AD!==x.CurrencySymbol){var AA=AD.replace(/\$/g,"$$$$");AC.n=AC.n.replace(/\$/g,AA);AC.f=AC.f.replace(/\$/g,AA);}AC.cls=AC.r?"red":null;}return AG;}function V(w){var t="1"+(w>0?".":"").toString(),x="0"+(w>0?".":"").toString(),u;for(u=0;u<w;u++){t+=u%10;x+="0";}return[t+"E+03",x+"E+0#"];}function R(AH,AJ){var AB="\u00A4",AF=/"[^"]*"/g,w=AH.match(AF),AK="\u0091",AG=/\[[^\]]*\]/g,t=AH.match(AG),AE,AI;AE=AH.replace(AF,AB);AE=AE.replace(AG,AK);var y=AH.indexOf("."),AD=G.getDecimalLength(AH),AA=Math.max(0,AD+AJ),x=AH.match(/\d(?!((\d)|(,\d)))/g),u=y!==-1?AH.charAt(y-1):x&&x[0],AC=(u||"0")+(AA>0?".":"").toString();for(var z=0;z<AA;z++){AC+="0";}AE=AE.replace(AD===0?/\d(?!((\d)|(,\d)))/g:/\d\.\d+/g,AC);AE=AE.split(AB);AI=AE[0];c.forEach(w,function(AM,AL){AI+=AM+AE[AL+1];});AE=AI.split(AK);AI=AE[0];c.forEach(t,function(AM,AL){AI+=AM+AE[AL+1];});return AI;}function P(AB,t,AA,z,w,u){var y=AB.parent.parent.parent,x=i(t,AA.decimalPlaces,z,w,u);AA.set("format",D(x,AA.negativeNumbers.toString()));AB.set("items",x);AB.set("selectedIndex",c.find(x,"v",AA.negativeNumbers.toString()));y.preview.preview_label.set("text",I.applyFormatToNumber(y.myData.format,s.replace(/\./g,L.number.DECIMALSEPARATOR)));}function l(){var AC=this.parent.parent,AG=AC.myData,x=AC.formatterContainer,u=S[AC.categoryPicker.selectedIndex].v,AJ=this.funcType===a.FunctionLeftStr?1:-1,z=null,AB=null,y=false,AI=0,AD=null,w=false,AF;switch(u){case E.Fixed:z=x.fixed_hBox.negativeDDL;AB=p;y=!AG.thousandSeparator;break;case E.Currency:z=x.currency_hBox2.negativeDDL;AB=F;AI=AG.currencyPosition;AD=AG.currencySymbol;break;case E.Percentage:z=x.percentage_hBox.negativeDDL;AB=f;break;case E.Scientific:w=true;break;case E.Custom:AF=true;break;default:return ;}if(AF){var AH=R(AG.format,AJ);AC.preview.preview_label.set("text",I.applyFormatToNumber(AH,s.replace(".",L.number.DECIMALSEPARATOR)));AC.formatterContainer.custom_text.set("value",AH);return ;}var AA=AG.decimalPlaces,t=AA+AJ;t=Math.max(0,t);t=Math.min(J.MaxNegativeDidigts,t);AG.set("decimalPlaces",t);if(w){var AE=V(t);AG.set("format",AE[1]);AC.preview.preview_label.set("text",AE[0]);}else{P(z,AB,AG,y,AI,AD);}}function q(t,u){return Math.max(c.find(t,"v",u),0);}function C(w){var u=this.parent.parent.categoryPicker,t=S.map(function(x){return x.v;}).indexOf(w);u.set("selectedIndex",t);}function m(t,u,x,w){return H(undefined,t,u,undefined,M.copy(w,{useRichTooltip:true,updateTooltipConfig:function(){this.richTooltip={cssClass:"vi-regular vi-tooltip-A A-center",content:x,refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPCENTER,left:15,top:33};}}));}function b(){var w=mstrApp.isSingleTier&&!mstrmojo.dom.isMac();if(w||mstrApp.isVI){var x=this.formatterContainer,AC=L.datetime,AA={day:7,month:4,year:1998},z={hour:9,min:41,sec:46},u=AC&&AC.DATEINPUTFORMATS,y=AC&&AC.TIMEINPUTFORMATS,AB={};Z=[];U=[];u.forEach(function(AD){AB[AD.toLowerCase()]=1;Z.push({v:AD,n:O.formatDateInfo(AA,AD)});});y.forEach(function(AD){U.push({v:AD,n:O.formatTimeInfo(z,AD)});});if(w){x.date_ddl.set("items",Z);x.time_ddl.set("items",U);}else{U=J.Time;var t=J.Date.filter(function(AD){return !AB[AD.v&&AD.v.toLowerCase()];});x.date_ddl.set("items",Z.concat(t));x.time_ddl.set("items",U);}}else{Z=J.Date;U=J.Time;}}mstrmojo.vi.ui.NumberFormatter=mstrmojo.declare(mstrmojo.VBox,null,{scriptClass:"mstrmojo.vi.ui.NumberFormatter",cssClass:"NumberFormatter-content",formatValue:null,myData:null,oldData:null,categoryPicker:null,formatterContainer:null,preview:null,shortcutRow:null,adjustAfterCategoryChange:mstrmojo.emptyFn,preBuildRendering:function(){if(this._super){this._super();}b.call(this);var t=this.formatterContainer;if(this.formatValue){t.currency_hBox1.currency_symbol.selectedValue=this.formatValue.currencySymbol;t.fixed_btn.checked=!!this.formatValue.thousandSeparator;B.addWidgetCssClass(t.fraction_ddl,f[c.find(f,"v",this.formatValue.negativeNumbers)].r?" red":"");}},postBuildRendering:function Q(){if(this._super){this._super();}if(this.formatValue){this.categoryPicker.set("selectedIndex",q(this.categoryPicker.items,this.formatValue.category.toString()));}},children:[M.copy({alias:"categoryPicker",cssClass:"nf-category",onitemSelected:function k(AH){if(!this.hasRendered){return ;}var AC=this,AF=AC.parent,x=AF.formatterContainer,t=AF.shortcutRow,AG=AF.preview.preview_label,AE=AH.v,z=AE===E.Automatic,w=AE===E.Scientific,u=[],AB=AF.myData;c.forEach(x.children,function(AI){AI.set("visible",false);});AF.border.set("visible",!z);AF.preview.set("visible",!z);AF.borderBottom.set("visible",!(!mstrApp.isWSStyling||z||w));["border","moveLeftBtn","moveRightBtn"].forEach(function(AI){t[AI].set("visible",!z);});AB.set("category",AE);AB.set("thousandSeparator",AE?K.ThousandSeparator:AF.formatValue.thousandSeparator);switch(AE){case E.Currency:P(x.currency_hBox2.negativeDDL,F,AB,false,AB.currencyPosition,AB.currencySymbol);x.currency_hBox1.currency_position.set("selectedIndex",q(J.CurrencyPosition,AB.currencyPosition.toString()));u=["currency_hBox1","currency_hBox2"];break;case E.Date:x.date_ddl.set("selectedIndex",q(Z,AB.format));u=["date_ddl"];break;case E.Time:x.time_ddl.set("selectedIndex",q(U,AB.format));u=["time_ddl"];break;case E.Percentage:P(x.percentage_hBox.negativeDDL,f,AB,false,0,null);u=["percentage_hBox"];break;case E.Fraction:x.fraction_ddl.set("selectedIndex",q(J.Fraction,AB.format));u=["fraction_ddl"];break;case E.Scientific:var AA=V(AB.decimalPlaces||0);AB.set("format",AA[1]);AG.set("text",AA[0]);break;case E.Custom:var y=AB.customText||AB.format,AD=x.custom_text;AB.set("format",y);AD.value=y;AD.refresh();AG.set("text",I.applyFormatToNumber(y,s.replace(".",L.number.DECIMALSEPARATOR)));u=["custom_condense","custom_text"];break;case E.Fixed:P(x.fixed_hBox.negativeDDL,p,AB,!AB.thousandSeparator,0,null);u=["fixed_hBox","fixed_btn"];break;}c.forEach(u,function(AI){x[AI].set("visible",true);});AF.adjustAfterCategoryChange();}},Y(S,"category")),{scriptClass:"mstrmojo.Box",cssClass:n+"nf-shortcut",alias:"shortcutRow",border:null,moveLeftBtn:null,moveRightBtn:null,children:[m("nf-shortcut-currency",function h(){C.call(this,E.Currency);},mstrmojo.desc(2051,"Currency"),undefined),m("nf-shortcut-percentage",function h(){C.call(this,E.Percentage);},mstrmojo.desc(2053,"Percentage"),undefined),m("nf-shortcut-fixed",function h(){C.call(this,E.Fixed);this.parent.parent.formatterContainer.fixed_btn.set("checked",true);},mstrmojo.desc(2050,"Fixed"),undefined),{scriptClass:"mstrmojo.Label",cssClass:"shortcut-border",alias:"border"},m("nf-MoveDecimalPoint left",function h(){l.call(this);},mstrmojo.desc(2189,"Increase Decimal"),{funcType:a.FunctionLeftStr,alias:"moveLeftBtn"}),m("nf-MoveDecimalPoint right",function h(){l.call(this);},mstrmojo.desc(2188,"Decrease Decimal"),{funcType:a.FunctionRightStr,alias:"moveRightBtn"})]},{scriptClass:"mstrmojo.Label",alias:"border",cssClass:"nf-border"},{scriptClass:"mstrmojo.Container",alias:"formatterContainer",cssClass:"nf-buttons",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',fixed_hBox:null,fixed_btn:null,currency_hBox1:null,currency_hBox2:null,date_ddl:null,time_ddl:null,percentage_hBox:null,fraction_ddl:null,custom_condense:null,custom_text:null,markupSlots:{containerNode:function W(){return this.domNode;}},children:[{scriptClass:"mstrmojo.HBox",alias:"fixed_hBox",cssClass:X,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:e,onitemSelected:function k(t){N.call(this,t);}},Y([],"format"))]},{scriptClass:"mstrmojo.CheckBox",alias:"fixed_btn",cssClass:n,label:"",onclick:function h(){var t=this.parent.parent;t.myData.set("thousandSeparator",this.checked?-1:0);P(this.parent.fixed_hBox.negativeDDL,p,t.myData,!this.checked,0,null);},preBuildRendering:function A(){this.set("label",mstrmojo.desc(13898,"Use 1000 Separator(#)").replace("#",L.number.THOUSANDSEPARATOR));}},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox1",cssClass:X,visible:true,currency_symbol:null,currency_position:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",alias:"currency_symbol",cssClass:"nf-CurrencySymbol",selectedValue:"$",items:d,postselectedValueChange:function j(t){var y=this,x=y.parent.parent.parent,w=t.value,u=x.myData;u.set("currencySymbol",w);P(this.parent.parent.currency_hBox2.negativeDDL,F,u,false,parseInt(u.currencyPosition,10),w);}},M.copy({cssClass:"nf-CurrencyPosition align-right",alias:"currency_position",onitemSelected:function k(t){var x=this,w=x.parent.parent.parent,u=t.v;w.myData.set("currencyPosition",parseInt(u,10));P(this.parent.parent.currency_hBox2.negativeDDL,F,w.myData,false,parseInt(u,10),w.myData.currencySymbol);}},Y(J.CurrencyPosition,"currencyPosition"))]},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox2",cssClass:X,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:e,onitemSelected:function k(t){N.call(this,t);}},Y([],"format"))]},M.copy({alias:"date_ddl",cssClass:X},Y(J.Date,"format",true)),M.copy({alias:"time_ddl",cssClass:X},Y(J.Time,"format",true)),{scriptClass:"mstrmojo.HBox",alias:"percentage_hBox",cssClass:X,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:e,onitemSelected:function k(t){N.call(this,t);}},Y([],"format"))]},M.copy({alias:"fraction_ddl",cssClass:X},Y(J.Fraction,"format",true)),mstrmojo.Button.newWebButton(mstrmojo.desc(13893,"Condense (e.g.10M)"),function(){this.parent.custom_text.set("value",'[>=1000000]#,##0,,"M";[>=1000]#,##0,"K";0;[<=-1000000]#,##0,,"M";[<=-1000]#,##0,"K"');},false,{cssClass:"nf-condense",alias:"custom_condense"}),{scriptClass:"mstrmojo.TextBox",alias:"custom_text",cssClass:"nf-custom",onvalueChange:function g(){var w=this,u=w.parent.parent,t=w.value;u.myData.set("format",t);u.myData.set("customText",t);w.parent.parent.preview.preview_label.set("text",I.applyFormatToNumber(t,s.replace(".",L.number.DECIMALSEPARATOR)).replace(/\s/g,"&nbsp;"));}}]},{scriptClass:"mstrmojo.Label",alias:"borderBottom",cssClass:"nf-border"},{scriptClass:"mstrmojo.HBox",alias:"preview",cssClass:n+"nf-PreviewRow",preview_label:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"preview_lable",text:mstrmojo.desc(13892,"Preview:")},{scriptClass:"mstrmojo.Label",cssClass:"align-right preview-info-label",alias:"preview_label"}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.HBox","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.css","mstrmojo.vi.ui.ElementsBrowser","mstrmojo.vi.ui.IncHierarchyCheckList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var G=mstrmojo.css,A=mstrmojo.mstr.EnumDSSXMLObjectTypes;var E="36px";mstrmojo.vi.ui.HierarchyElementsCheckListBrowser=mstrmojo.declare(mstrmojo.vi.ui.ElementsBrowser,null,{scriptClass:"mstrmojo.vi.ui.HierarchyElementsCheckListBrowser",children:[{scriptClass:"mstrmojo.HBox",slot:"searchBoxNode",alias:"util",cssClass:"elemsBrowser-utils-bar",children:[{scriptClass:"mstrmojo.Box",cssClass:"eb-box-search",alias:"box",children:[{scriptClass:"mstrmojo.TextBox",alias:"searchBox",hint:"Search",cssClass:"eb-searchBox",onEnter:function B(){var O=this.value,M=this.parent.parent.parent,N=!M.searchPattern&&!O;if(!N){M.set("searchPattern",O);}this.blur();}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-clear",text:"",onclick:function(){var M=this.parent.searchBox;M.set("value","");M.cleanUp();M.focus();M.onEnter();},bindings:{visible:"(this.parent.searchBox.value || '').length > 0"}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-search",text:"",onclick:function(){var M=this.parent.searchBox;M.focus();M.onEnter();}}]}]},{scriptClass:"mstrmojo.HBox",slot:"buttonPanelNode",alias:"buttonPanel",cssClass:"elemsBrowser-button-panel"},{scriptClass:"mstrmojo.vi.ui.IncHierarchyCheckList",alias:"elementList",slot:"elementListNode",allowUnlistedValues:false,bindings:{disableLevel:"this.parent.disableLevel"},getDataHelper:function(){return this.parent.ifDataHelper;},getAttribute:function(){return this.parent.attribute;},isHiearachyDisplay:function F(){var M=this.parent;return !M.searchPattern||M.searchPattern==="";},setSelectedItems:function J(M){if(typeof M==="object"){this.setSelectionByExprJSON(M);}},postSelectionChange:function I(){var M=this.getAttribute();if(M){this.parent.onItemsSelectionChange(this.buildSelectionExprJSON(M));}}}],init:function L(M){this._super(M);G.addWidgetCssClass(this,"hierarchy");if(this.disableLevel){G.addWidgetCssClass(this,"disable-level");}},postCreateChildren:function D(){var M=this.elementList;this.util.addChildren(M.getLevelPopupConfig());this.buttonPanel.addChildren([M.getAllButtonConfig(true),M.getAllButtonConfig(false)]);},onattributeChange:function H(M){var N=this.elementList;N.clearItems();this._super(M);},onsearchPatternChange:function C(){var N=this.elementList,M=N.isHiearachyDisplay();this._super();this.buttonPanel.set("visible",M);this.layoutConfig.h.buttonPanelNode=M?E:"0px";this.doLayout();},isObjSearchable:function K(M){return true;},onElementsListchange:mstrmojo.emptyFn,updateClearAllBtnState:mstrmojo.emptyFn,_set_selectedItems:null});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ObjectBrowser");var H=mstrmojo.array;var E=[257,1024,3072,12032];mstrmojo.vi.ui.editors.ObjectPicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.ObjectPicker",cssClass:"mstrmojo-vi-ObjectPicker",zIndex:9,title:mstrmojo.desc(11496,"Select Object"),help:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:4,supportedTypes:H.hash(E),item:null,OKFn:null,children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",closeable:false,browsableTypes:"8,"+E.join(","),closeOnSelect:false,showCompletePath:false,searchVisible:false,scrollableIncFetch:true,bindings:{rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",isImportFromCube:"this.parent.isImportFromCube",}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btnHBox",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function C(){var J=this.parent.parent;this.parent.parent.close({item:J.item});var I=J.OKFn;if(I){I(J.item);}J.set("item",null);},bindings:{enabled:function B(){return !!this.parent.parent.item;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancle"),onclick:function C(){var I=this.parent.parent;this.parent.parent.close();I.set("item",null);}}]}],preBuildRendering:function A(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];},postBuildRendering:function D(){if(this._super){this._super();}this.browse();},onOBSelect:function F(I){this.set("item",((this.supportedTypes[I.t]||this.supportedTypes[I.st])?I:null));},browse:function G(){this.ob.browse();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor","mstrmojo.ObjectBrowser","mstrmojo.NewFolderEditor","mstrmojo.DI.DIHelpers");var C=mstrmojo.func,F=mstrmojo.DI.DIHelpers,E=mstrmojo.array;function B(){var H={alias:"newFolder",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-createfolder",text:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var J=this.parent.parent,I={zIndex:J.zIndex+10,navigateAfter:false,fId:J.ob.currentFolder.did,okFn:function(K,L){J.ob.refreshContent();if(L){J.ob.browseFolder(K.fid,J.newFolder);}}};if(J.ob.dataProvider){I.dp=J.ob.dataProvider;}J.openPopup("newFolder",I);},postCreate:function(){this.set("visible",false);}},G=mstrmojo.hash.clone(mstrmojo.ObjectBrowser.prototype.children);G.push(H);return G;}mstrmojo.SaveAsObjectBrowser=mstrmojo.declare(mstrmojo.ObjectBrowser,null,{scriptClass:"mstrmojo.SaveAsObjectBrowser",cssClass:"mstrmojo-SaveAs-OB",children:B(),getRecents:function(G){var H=this;G.onClose=function(){if(H.recentFolders){this.removeChildren(this.recentLable);this.removeChildren(this.recentList);delete H.recentFolders;}};this.getDataProvider().loadRecentSaveAsFolders({success:function(I){if(H.recentFolders){G.removeChildren(G.recentLable);G.removeChildren(G.recentList);delete H.recentFolders;}if(I&&I!==""){H.recentFolders=H.getList(I.objects,G);G.addChildren(H.recentFolders);}},failure:function(I){mstrmojo.alert(I.message||I.getResponseHeader("X-MSTR-TaskFailureMsg"));},});},getList:function(H,G){var I=this;return[{scriptClass:"mstrmojo.Label",alias:"recentLable",cssClass:"recentLabel",text:mstrmojo.desc(14354,"Recents")},{scriptClass:"mstrmojo.ui.List",alias:"recentList",items:H,cssClass:"recentList",onclick:function(J){var K=this.getItemFromTarget(J.getTarget());I.browseFolder(K.did,"");G.close();}}];}});var A={success:function(G){var H=this.parent;if(H.onObjectSaved){H.onObjectSaved({name:H.name,did:G.did,desc:H.desc});}mstrmojo.alert(mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",H.typeDesc||"Object").replace("###",H.name),null,mstrmojo.desc(7984,"Object Saved"));H.ob.refreshContent();H.close();},failure:function(H){var G=parseInt(H.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296,I=this.parent;if(G===2147749923){mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",I&&I.typeDesc||"Object").replace("'###'",I&&I.name?'"'+I.name+'"':""),{confirmBtn:{fn:function(){I.saveAs(true);}}},{title:mstrmojo.desc(3179),zIndex:I&&I.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+H.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};mstrmojo.SaveAsEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SaveAsEditor",cssClass:"mstrmojo-SaveAsEditor",title:mstrmojo.desc(3167,"Save As"),sId:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:null,browsableTypes:null,showCompletePath:true,desc:"",name:"",displaySaveLabel:true,searchVisible:true,upButtonVisible:true,children:[{scriptClass:"mstrmojo.SaveAsObjectBrowser",alias:"ob",closeable:false,closeOnSelect:false,fishEyeVisible:false,bindings:{showCompletePath:"this.parent.showCompletePath",rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",browsableTypes:"this.parent.browsableTypes",displaySaveLabel:"this.parent.displaySaveLabel",searchVisible:"this.parent.searchVisible",upButtonVisible:"this.parent.upButtonVisible",sId:"this.parent.sId"},postCreate:function(){this.onSelectCB=[this.parent,"onOBSelect"];this.onBrowseFolder=[this.parent,"onOBBrowseFolder"];}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput",bindings:{value:"this.parent.parent.name"}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",bindings:{value:"this.parent.parent.desc"},rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"buttonBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{alias:"newFolder",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton mstrmojo-createfolder",text:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var H=this.parent.parent,G={zIndex:H.zIndex+10,navigateAfter:false,fId:H.ob.currentFolder.did,okFn:function(I,J){H.ob.refreshContent();if(J){H.ob.browseFolder(I.fid,H.newFolder);}},cssClass:F.getEnvObj().isAppSchema()?"workstation":undefined};if(H.ob.dataProvider){G.dp=H.ob.dataProvider;}H.openPopup("newFolder",G);},postCreate:function(){this.set("visible",mstrmojo.resolveFeature("create-folder")||F.getEnvObj().isAppSchema());}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot okButton",alias:"ok",text:mstrmojo.desc(2400,"Save"),onclick:function(){this.parent.parent.saveAs();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}],newFolder:{scriptClass:"mstrmojo.NewFolderEditor"},onOpen:function(){this.ob.browse();},onOBBrowseFolder:mstrmojo.emptyFn,onOBSelect:function(G){this.set("name",G.n);},saveAsCallback:function D(){return A;},saveAs:function(J){var H=this.contPanel;this.name=H.name.value;this.desc=H.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var L=this.saveParams||{};L.folderID=this.ob.currentFolder.did;L.description=this.desc||"";L.name=this.name||"";L.saveAsOverwrite=!!J;var G=this.saveAsCallback(),K=this,I={success:function(){K.saveRecentFolders(K.ob.currentFolder.did);},failure:function(M){mstrmojo.alert(M.message||M.getResponseHeader("X-MSTR-TaskFailureMsg"));}};G.parent=this;if(!mstrApp.isSingleTier){G=C.wrapMethods(G,I);}mstrmojo.xhr.request("POST",mstrConfig.taskURL,G,L);},saveRecentFolders:function(K){var I,G,H,J=this;J.ob.getDataProvider().loadRecentSaveAsFolders({success:function(L){G=[];E.forEach(L.objects,function(O){G.push(O.did);});H=mstrmojo.array.indexOf(G,K);if(H!==-1){G.splice(H,1);}G.unshift(K);I=G.slice(0,3).join(",")+",";var M={taskId:"setPreference",prefs:"recentFolders\u001E"+I};var N={success:function(){mstrConfig.recentFolders=I;},failure:function(O){mstrmojo.alert(O.message||O.getResponseHeader("X-MSTR-TaskFailureMsg"));}};J.ob.getDataProvider().serverRequest(M,N);},failure:function(L){mstrmojo.alert(L.message||L.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}});mstrmojo.SaveAsEditor.SAVEAS_CALLBACK=A;})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.FilterExpr");var D=mstrmojo.hash,B=mstrmojo.expr.ET;mstrmojo.fe.FilterExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.fe.FilterExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,onConditionEdit:mstrmojo.emptyFn,modifyConditionNode:function(G,F){var H=G.data,E=H.isNew;D.copy(D.clone(F),D.clear(H));delete H.isNew;G.paint();if(H.et===B.MQ||H.et===B.MC){G.set("noCreateSet",!mstrApp.supportAdvFilter);}if(G.tree.onConditionEdit){G.tree.onConditionEdit(G,E);}},getItemConfig:function(I,E,J){var G=this._super(I,E,J),H=J.tree,F=D.walk("tree.editor.controller.dataService.model",J),K=D.walk("tree.editor.controller.data.gsi",J);this.adjustItemName(I,F,K);return D.copy({onclick:H.prenodeclick,containerResizable:H.containerResizable,ondragend:H.ondragend,ondrop:H.ondrop},G);},ondragenter:function A(E){this.dropCuePos={left:0,top:0,idx:0,idxActual:0};this._super(E);},ondragend:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondragend.call(this,E);}},ondrop:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondrop.call(this,E);}},isEditable:function C(F){if(!this.editable){return false;}var E=false;switch(F&&F.et){case B.R:case B.F:E=false;break;case B.ANDOR:case B.MQ:case B.AQ:case B.AL:case B.AC:case B.MC:case B.AE:E=true;break;case B.XML:E=!F.xml||!!F.ph;}return E;},prenodeclick:function(E){if(!E||!E.part){return ;}if(E.part!=="createSet"&&E.part!=="createSetOpt"&&!(E.part==="andor"?this.prefixedAndOrEditable:this.editable)){return ;}var F=this.tree;if(F.onnodeclick){F.onnodeclick.call(this,E);}},getSelectedItemWidget:function(){var E=function(K){var I=K&&K.ctxtBuilder&&K.ctxtBuilder.itemWidgets,G=K.selectedIndex,F=I&&I.length||0;if(!I){return ;}if(G===-1){for(var H=0;H<F;H++){var J=E(I[H]);if(J){return J;}}}else{return I[G];}};return E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.FilterExpr","mstrmojo.threshold.AndOrNode","mstrmojo.threshold.ConditionNode","mstrmojo.expr","mstrmojo.hash");var B=mstrmojo.hash,G=mstrmojo.expr,D=G.ET,H=mstrmojo.mstr.EnumNodeProperties;mstrmojo.threshold.ThresholdExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.threshold.ThresholdExprTree",cssClass:"mstrmojo-ThresholdExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,supportRelation:true,nodeClassMap:{14:mstrmojo.threshold.AndOrNode,"*":mstrmojo.threshold.ConditionNode},getItemIdentityProp:function(J){if(J.node&H.CONDITION){return"*";}return this._super(J);},getItemConfig:function(M,J,N){var L=this._super(M,J,N),K=B.walk("tree.editor.controller.dataService.model",N),O=B.walk("tree.editor.controller.data.gsi",N);this.adjustItemName(M,K,O);return L;},onConditionEdit:mstrmojo.emptyFn,editor:undefined,isEditable:function I(J){if(!this.editable){return false;}if(J&&J.et===D.XML){return !J.xml;}return true;},onNew:function C(J){J.data.isNew=true;this.editor.openConditionWalk(J.data,J.widget.ctxtBuilder.itemWidgets[J.index]);},onnodeclick:function A(J){var K=J.part;if(!J||!K){return ;}var M=K==="andor",L=this.tree.editor;if(!((M&&this.prefixedAndOrEditable)||(!M&&this.editable))){return ;}if(!this.editable){return ;}if(M){L.openAndORPopup(this,J.getTarget());return ;}else{if(K==="addCondition"){this.tree.newCondition({et:D.AE});return ;}}L.openConditionWalk(this.data,this);},allowDrop:function F(J){var O=J&&J.src,N=O&&O.data,L=N&&N.et,M=this.tree,K=O&&O.widget&&O.widget.tree;return L&&(this===M?(K!==M):true);},remove:function E(K){var J=this._super(K);if(this.items.length===0&&K.et===D.ANDOR&&K.nds.length===0&&this.parent.removeFromModel){this.parent.removeFromModel();}return J;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.Label","mstrmojo.Obj","mstrmojo.ui.Checkbox","mstrmojo.ui.CheckList","mstrmojo.warehouse.EnumObjectTypes","mstrmojo._HasItemAliases");var H=mstrmojo.expr,I=H.ET,C=mstrmojo.array,F=mstrmojo.string,E=mstrmojo.warehouse.EnumObjectTypes,G=mstrmojo.mstr.EnumNodeDimty,D=mstrmojo.hash;mstrmojo.fe.CreateSetEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo._HasItemAliases],{onOpen:function(){var b=this,N=this.model,P=this.condition.data,W=!P.m,L=this.attrsBox.attrsList,O=this.relBox.relPd,X=C.filter(N.metrics,function(d){return !d.um;}),Q=[{n:mstrmojo.desc(12037,"System Default"),t:-1,did:"default"}].concat(X),M=this.appQualBox.appQual,V=D.clone(N.attrs),Z=D.walk("opener.docModel",this),a=D.walk("opener.xtab.gridInfo",this);C.forEach(V,function(e){var d=false;if(e.t===E.ATTRIBUTE){C.forEach(e.fs,function(f){if(f.fgr>0){d=true;return false;}});}b.adjustItemName(e,Z,a);e.css=(e.css||"")+" "+(e.t?("t"+e.t+((e.da||e.um)?"d":"")+(d?"g":"")+(e.st?(" st"+e.st):"")):"");});L.set("items",V);mstrmojo.array.forEach(["relBox","appQualBox"],function(d){this[d].set("visible",W);},this);if(P.dmt===4&&P.dmy.uts){var Y={};C.forEach(P.dmy.uts,function(e){var d=C.find(N.attrs,"did",e.utgt.did);if(d>=0){Y[d]=true;}});L.set("selectedIndices",Y);}if(W){O.set("items",Q);if(P.relation&&P.relation.guide){var c=P.relation.guide,S=C.find(Q,"did",c.did);O.set("selectedIndex",S>=0?S:0);}else{O.set("selectedIndex",0);}M.set("checked",!!P.applySubExpr);}if(mstrApp.isWSStyling){var K={left:parseInt(this.left,10),top:parseInt(this.top,10)},J=this.editorNode.getBoundingClientRect(),R={width:window.innerWidth,height:window.innerHeight},U={width:J.right-J.left,height:J.bottom-J.top};if(J.right>R.width){this.set("left",(K.left-U.width)+"px");}if(J.bottom>R.height){this.set("top",(K.top-U.height)+"px");}}},onOK:function(){var Q=this.model,U=this.condition,W=this.condition.data,N=this.attrsBox.attrsList,J=this.relBox.relPd,L=this.appQualBox.appQual;var Y=N.getSelectedItems(),K=[];C.forEach(Y,function(a){K.push({utgt:{n:a.n,did:a.did},utp:H.DMY_TP.ATTR,agg:1,flt:2,gb:true,rps:0,n:a.n});});var X;if(J.selectedIndex>0){var O=J.items[J.selectedIndex];X={n:O.n,did:O.did,t:E.METRIC,st:1024};}var M;if(W.et===15){W.dmt=G.NodeDimtyOutputLevel;W.dmy=W.dmy||{};W.dmy.uts=K;M=W.relation=W.relation||{};if(X){M.guide=X;W.useSchema=false;}else{delete M.guide;delete M.rsTp;delete M.joTp;delete M.paTp;delete M.erTp;W.useSchema=true;}W.applySubExpr=L.checked;U.set("data",W);}else{var V={et:15};V.dmt=G.NodeDimtyOutputLevel;V.dmy={};V.dmy.uts=K;M=V.relation={};if(X){M.guide=X;}else{V.useSchema=true;}V.applySubExpr=L.checked;var P=U,R={rq:V,cq:W},S=[U.childIndex()];if(W.et===I.ANDOR){if(W.nds&&W.nds.length>2){var Z=Q.childIdx;S=[Z,Z-1];}else{P=U.parent;}}else{P=U.parent;R.isMetric=!!W.m;}P.createSet(S,R);}},children:[{scriptClass:"mstrmojo.Box",alias:"attrsBox",cssClass:"Attributes-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14613,"Select attributes to create the set"),cssClass:"Label",alias:"attrsBoxLabel"},{scriptClass:"mstrmojo.ui.CheckList",alias:"attrsList",cssClass:"CheckList"}]},{scriptClass:"mstrmojo.Box",alias:"relBox",cssClass:"RelatedBy-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12036,"Related by"),cssClass:"Label",cssDisplay:"inline-block"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"relPd",cssClass:"Pulldown",cssDisplay:"inline-block",allowHTML:false,onitemSelected:function B(J){}}]},{scriptClass:"mstrmojo.Box",alias:"appQualBox",cssClass:"AppQual-Box",children:[{scriptClass:"mstrmojo.ui.Checkbox",alias:"appQual",cssClass:"AppQual-CheckBox"},{scriptClass:"mstrmojo.Label",cssClass:"AppQual-Label",text:mstrmojo.desc(12038,"Apply this qualification independently of the relationship filter"),postBuildRendering:function(){if(this._super){this._super();}if(mstrApp.isWSStyling){this.set("text",mstrmojo.desc(15015,"Apply this qualification to define the set, and also to the results of the visualization."));}}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float: right; border-collapse: separate; display: table;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(2397,"OK"),onclick:function(){var J=this.editor;J.onOK();J.close();},bindings:{enabled:function(){var K=this.parent.parent.attrsBox.attrsList,J=this.parent.parent.attrsBox.attrsList.selectedIndices;return K.getSelectedItems().length>0;},editor:"this.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.editor.close();},bindings:{editor:"this.parent.parent"}}]}],postBuildRendering:function A(){this._super();if(mstrApp&&mstrApp.isWSStyling){this.attrsBox.attrsBoxLabel.set("text",mstrmojo.desc(15013,"Select the attributes that you look for."));}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasPopup","mstrmojo.fe.AndOrNode","mstrmojo.fe.DynamicNode","mstrmojo.ConditionNode","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.hash","mstrmojo.expr");var E=mstrmojo,A=E.css,I=E.dom,F=E.hash,G=E.string,C=function(N){var O=N.data,M=O.dmy&&O.dmy.uts||[],K=M.length,J=[],L;for(L=0;L<K;L++){J.push(G.encodeHtmlString(M[L].n));}return'<span class="mstrmojo-text">'+J.join(", ")+"</span>";};mstrmojo.fe.RelationNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.fe.RelationNode",markupString:'<div id="{@id}" class="mstrmojo-relation {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-relation-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-relation-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-relationNode"><span class="mstrmojo-relationNode-inf"><span class="mstrmojo-relation-prefix-text">'+mstrmojo.desc(2790,"Set of").replace(/##/g,"")+'</span><span class="mstrmojo-textset"  mstrAttach:click></span><span class="mstrmojo-relation-postfix-text">'+mstrmojo.desc(2793,"Where").replace(/##/g,"")+'</span><span class="mstrmojo-relation-convert-text"  mstrAttach:click >'+mstrmojo.desc(15412,"Convert to Condition")+'</span><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></span><div class="mstrmojo-relation-childTreeNode" style="position:relative;"></div></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},relationNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1];},convertNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[3];},containerNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){A.toggleClass(this.relationNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=C(this);}},noRelationOperator:true,children:[{scriptClass:"mstrmojo.fe.RelationFilterExprTree",alias:"childTree",ignoreLayout:true,dropZone:false,draggable:false,nodeClassMap:{14:mstrmojo.fe.AndOrNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},onNew:function(J){this.parent.tree.onNew(J);},getItemConfig:function(N,J,O){var L=mstrmojo.fe.RelationFilterExprTree.prototype.getItemConfig.call(this,N,J,O),M=O.tree||O,P=mstrmojo.hash.walk("tree.parent.tree.editor.xtab",O),Q=P&&P.gridInfo,K=P&&P.controller.model;if(Q){this.adjustItemName(N,K,Q);}return F.copy({tree:M,rootTree:this.parent.tree,noRelation:true,inRelation:true},L);},prenodeclick:function(J){if(!J||!J.part){return ;}var K=this.rootTree;if(K&&K.onnodeclick&&this.editable){J.editor=K.editor;K.onnodeclick.call(this,J);}}}],premousedown:function(J){if(this._super){this._super(J);}var K=I.eventTarget(J.hWin,J.e);if(!I.contains(this.childTree.domNode,K,true)){this.childTree.clearTreeSelect();}},preselectedChange:function(J){if(!J.value){this.childTree.clearTreeSelect();}},init:function(J){this._super(J);var K=this.data;if(K){delete this.data;this._set_data(null,K);}},_set_data:function(M,J){var K=this.data;if(J&&(!J.relation)){J.relation={};}var L=(K!==J);if(L){this.data=J;if(J){this.childTree.set("items",J.nds||[J]);}}return L;},isSelectableArea:function(J){return mstrmojo.dom.contains(this.relationNode,J,true);},preclick:function D(J){var L=null,K=I.eventTarget(J.hWin,J.e);if(I.contains(this.prefixNode,K,true)){L="andor";}else{if(I.contains(this.textNode,K,true)){L="createSet";}else{if(I.contains(this.convertNode,K,true)){this.parent.removeSet(this);return false;}}}J.part=L;},del:function H(){var J=this.parent;if(J&&J.remove&&this.data){J.remove(this.data);}},newCondition:function B(J){this.childTree.newCondition(J);},avatarCssCls:"mstrmojo-FE mstrmojo-relationNode",getAvatarNode:function(){return this.relationNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.mstr.EnumNodeProperties","mstrmojo.fe.FilterExprTree","mstrmojo.fe.AndOrNode","mstrmojo.fe.RelationNode","mstrmojo.fe.DynamicNode","mstrmojo.fe.ConditionNode","mstrmojo._HasItemAliases");var M=mstrmojo.expr.ET,K=mstrmojo.mstr.EnumNodeProperties;mstrmojo.fe.RelationFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,[mstrmojo._HasItemAliases],{scriptClass:"mstrmojo.fe.RelationFilterExprTree",nodeClassMap:{14:mstrmojo.fe.AndOrNode,15:mstrmojo.fe.RelationNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},getItemIdentityProp:function(N){if(N.node&K.CONDITION){return"*";}if(N.ph){return"ph";}if((N.et===10||N.et===12)&&N.dmt===4){return M.RLS;}return N.et;},isEditable:function L(O){var N=false;switch(O&&O.et){case M.RLS:N=true;break;}return N||this._super(O);},getItemConfig:function B(R,N,S){var P=this._super(R,N,S),Q=(R.et===M.RLS||!!R.relation),U=mstrmojo.hash.walk("editor.xtab",S),V=U&&U.gridInfo,O=U&&U.controller.model;if(Q){P.itemFunction=S.itemFunction;}if(V){this.adjustItemName(R,O,V);}return P;},newCondition:function F(P){var O=this.getSelectedItemWidget(),N=0;if((typeof microstrategy!=="undefined")&&microstrategy.bones&&microstrategy.bones.rwb_viewer){N=microstrategy.bones.rwb_viewer.nextPhIndex;}else{if(mstrApp&&mstrApp.docModelData&&mstrApp.docModelData.phIndex){N=mstrApp.docModelData.phIndex;}}if(P&&P.ph&&!P.ph.idx){P.ph.idx=N++;}if(O&&O.selected&&O.newCondition){return O.newCondition(P);}else{return this._super(P);}},createSet:function E(O,N){var P=N.rq,Q=N.cq;if(P&&Q){this.remove(Q);if(N.isMetric){mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],P,Q);P=Q;}else{P.nds=[Q];}this.add([P],O[0]);}},removeSet:function I(N){var O=N.data,P=[O];this.remove(O);if(O.nds&&O.nds.length>0){P=O.nds;}else{delete O.dmy;delete O.relation;delete O.applySubExpr;delete O.relation;delete O.useSchema;delete O.dmt;}this.add(P,0);},nameFactory:{counter:1,names:{},clear:function(){this.resetCounter();this.names={};},resetCounter:function D(){this.counter=1;},isNameExist:function J(N){return !!this.names[N];},setName:function H(N,O){this.names[N]=O;},changeName:function C(O,N,P){this.removeName(O);this.setName(N,P);},getNewName:function G(Q,P,S){var R=P||"",O=S||"",N;while(this.isNameExist(R+this.counter+O)){this.counter++;}N=R+this.counter+++O;this.names[N]=Q;return N;},removeName:function A(N){delete this.names[N];this.resetCounter();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.desc","mstrmojo.vi.ui.NumberFormatter");var B=mstrmojo.desc;mstrmojo.vi.ui.NumberFormatterEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.NumberFormatterEditor",onSubmenuOpen:function A(){},myData:null,oldData:null,formatValue:null,onOK:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",bindings:{myData:"this.parent.myData",oldData:"this.parent.oldData",formatValue:"this.parent.formatValue"}},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-subtotals-button",children:[{scriptClass:"mstrmojo.Button",text:B(221,"Cancel"),onclick:function(){this.parent.parent.onSubmenuClosed();}},{scriptClass:"mstrmojo.Button",text:B(1442,"OK"),onclick:function(){var C=this.parent.parent,D=C.xtab;C.onSubmenuClosed();this.parent.parent.onOk();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.ui.editors.controls.AdvancedColorPickerPopup","mstrmojo.css");var G=mstrmojo.css,F=Math.round;function J(O){var P=this.previewNode,N=P.clientWidth,R=P.clientHeight,Q=P.offsetWidth-N,S=Math.sqrt(N*N+R*R)-Q/2,M=Math.atan2(R,N)*(-180)/Math.PI;P.style.backgroundColor="#FFFFFF";O.display="block";O.top=F((P.offsetHeight+Q)/2)+"px";O.left=F((N-S+Q)/2)+P.offsetLeft+"px";O.width=F(S)+"px";O[mstrmojo.dom.CSS3_TRANSFORM]="rotate("+F(M)+"deg)";}mstrmojo.ui.editors.controls.ColorPickerButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onselectedValueChange:function(){this.updatePreview();this.colorPicker.set("color",this.selectedValue);},onautoPreviewColorChange:function D(){this.getPopupWidget().set("autoPreviewColor",this.autoPreviewColor);this.updatePreview();},onenabledChange:function H(){G.toggleClass(this.domNode,"disabled",!this.enabled);}},isHostedWithin:false,showGradient:false,showNoFill:true,showAutomatic:false,autoPreviewColor:null,selectedValue:null,init:function L(N){this._super(N);var M=this.colorPicker;M.showGradient=this.showGradient;if(this.showNoFill!==undefined){M.showNoFill=this.showNoFill;M.showAutomatic=this.showAutomatic;}M.showAutomatic=this.showAutomatic;G.addWidgetCssClass(this,"mstrmojo-ColorPickerBtn");},preBuildRendering:function K(){this.colorPicker.showNoFill=this.showNoFill;return this._super();},setDimensions:function I(N,M){this._super(N,M);window.setTimeout(function(){this.updatePreview();}.bind(this),0);},afterLayout:function C(){var M=this.previewNode,N=M.style,P=N.width,O=M.offsetWidth;if(O>0){N.width=(O-4)+"px";}else{if(P!==""){N.width=(parseInt(P,10)-4)+"px";}}if(N.height===""){N.height=(M.offsetHeight-4)+"px";}},postBuildRendering:function A(){var M=this.noFillNode=document.createElement("div");M.style.display="none";M.className="slash";this.domNode.firstChild.appendChild(M);this._super();},updatePreview:function B(){var Q=this.previewNode;if(Q){var O=this.selectedValue===mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC?this.autoPreviewColor:this.selectedValue;if(O){var R=Q.style;if(O.c1){var S=G.buildGradient(O.or,O.c1,O.c2);if(S&&S.n){R[G.convertCssToCamelCase(S.n)]=S.v;}}else{var M=G.buildGradient(0,"0","0");if(M&&M.n){R[G.convertCssToCamelCase(M.n)]=null;}var P="conflict"===O;G.toggleClass(Q,"conflict",P);R.backgroundColor=!P?O:null;}if(this.showNoFill&&this.noFillNode&&this.enabled){var N=this.noFillNode.style;if("transparent"===O){J.call(this,N);}else{N.display="none";}}}Q.style.backgroundOrigin="border-box";}},getPopupWidget:function E(){return this.colorPicker;},children:[{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",alias:"colorPicker",slot:"widgetHostNode",color:this.selectedValue,isHostedWithin:true,showNoFill:true,colorChanged:function(M){this.parent.set("selectedValue",M);this.close();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo.desc","mstrmojo.ME.TokenInputBox","mstrmojo.mstr.EnumDSSXMLTokenTypes","mstrmojo.ME.Enum","mstrmojo._HasTooltip","mstrmojo.dom","mstrmojo.string");mstrmojo.requiresDescs(221,547,9106,9565,9566,9567,9568,11897,13542,13543,15665);var M=mstrmojo.array,S=mstrmojo.hash,I=mstrmojo.desc,O=mstrmojo.mstr.EnumDSSXMLTokenTypes,N=mstrmojo.ME.Enum.METRIC_EDIT_TYPES,L=mstrmojo.string.escape4HTMLText,E=mstrmojo.dom;var Q={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3,AMBIGUITY:4},G={0:"valid",1:"unknown",2:"validating",3:"error",4:"ambiguity"},R={0:I(9565,"Valid Metric Formula."),1:I(9106,"Require Validation?"),2:I(9566,"Validation in Progress..."),3:I(9567,"Validation Failed with Syntax Error!"),4:I(9568,"Validation Failed with Object Ambiguity!")},U={ERROR:"-2147214845",AMBIGUITY:"-2147214846"},B={};B[U.ERROR]=Q.ERROR;B[U.AMBIGUITY]=Q.AMBIGUITY;function P(a){if(!a){return Q.VALID;}return B[a]||Q.ERROR;}mstrmojo.ME.MetricEditBox=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.MetricEditBox",vStatus:Q.VALID,iStatus:"",showStatus:true,browseItemVisible:true,absorbAmbiguity:true,validateFunc:null,isObjectVisible:function(a){return true;},markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-MEBox-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;},statusNode:function(){return this.domNode.lastChild;}},markupMethods:{onvStatusChange:function(){var b=this.vStatus,a=this.vStatusNode;a.className="mstrmojo-MEBox-vStatus "+G[b];a.innerHTML=(this.getStatusDesc&&this.getStatusDesc(b))||R[b]||"";if(this.vStatus===Q.VALID){this.set("cValid",true);}},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;}},children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",renderOnScroll:false,renderBlockSize:0,bindings:{browseItemVisible:"this.parent.browseItemVisible",candidates:"this.parent.candidates"},editEmbeddedFilterToken:function(a){var b=this.parent;if(b.editEmbeddedFilterToken){b.editEmbeddedFilterToken(a);}}}],init:function V(a){var b=this,c=a.validateFunc||this.validateFunc;if(c){b.children=[{scriptClass:"mstrmojo.Button",alias:"validateBtn",slot:"statusNode",text:I(11897,"Validate"),cssClass:"mstrmojo-WebHoverButton right hoverLink",cssDisplay:"inline-block",onclick:c}].concat(this.children);}if(this._super){this._super(a);}this.statusCssClass=this.showStatus?"":"hidden";},getSearchPattern:function Z(){return this.inputBox.getSearchPattern();},getHighlightedText:function W(b,a){return this.inputBox.getHighlightedText(b,a);},item2textCss:function K(a){return{4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[a.t]||"";},handleSuggestionItemSelect:function J(a){var b=this.ambiguityDialog;if(a){b.onItemSelect(a);}b.close();},showDesc:true,showPath:true,ambiguityDialog:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ME-ambiguityDialog",onOpen:function(){this.set("title",I(13542,"Object Ambiguity - ##").replace("##",this.ambiguousName));this.list.clearSelect();this.list.set("items",this.items);this.list.singleSelect(0);this.label.set("text",I(13543,"More than one object with the name '##' were found.").replace("##",this.ambiguousName));},children:[{scriptClass:"mstrmojo.Label",alias:"label",text:""},{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",alias:"list",cssClass:"mstrmojo-ME-ambiguityList",bindings:{items:"this.parent.opener.suggestionItems"},onclick:function(a){mstrmojo._IsList.onclick.call(this,a);},getItemMarkup:function(d,a){var c=this.parent.opener,b=mstrmojo.string.escape4HTMLText;var f=(c&&c.item2textCss(d))||"";var e="";if(d.path){e='<div class="mstrmojo-object-additional-info" idx="'+a+'">'+mstrmojo.desc(16154,"From Dataset:")+" "+L(d.path)+"</div>";}else{d.standalone=true;}return'<div class="mstrmojo-object-item" idx="'+a+'"><div class="mstrmojo-object-name '+f+'" idx="'+a+'">'+L(d.n)+"</div>"+e+"</div>";},buildTooltip:function(a,b){if(a.standalone){return L(a.path)+"> "+L(a.n);}else{return L(a.n)+'<div class="mstrmojo-object-additional-info">'+mstrmojo.desc(16154,"From Dataset:")+" "+L(a.path)+"</div>";}}}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:I(547,"Select"),onclick:function(){var a=this.parent.parent;a.opener.handleSuggestionItemSelect(a.list.selectedItem);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:I(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]},defaultOnTokensModify:function(){this.set("vStatus",Q.UNKNOWN);this.set("iStatus","");},postBuildRendering:function Y(){this._super();this.inputBox.attachEventListener("tokensModify",this.id,"defaultOnTokensModify");this.inputBox.attachEventListener("tokensModify",this.id,"ontokensModify");},updateInputBoxItems:function H(a){this.inputBox.set("items",a.items);},replaceErrorToken:function C(a){this.inputBox.replaceErrorToken(a);},clientSideValidation:function A(g){if(!g){return ;}var c=false,f=false,b=g.items;try{c=mstrApp.rootCtrl.docCtrl.model.isMDXDataset(S.any(this.parent.parent.datasets));f=g.met==N.ADVANCED&&b[0].tp==O.SimpPrefixFun&&b[0].v==="ApplySimple";}catch(h){}if(c&&f){var a=M.filterOne(b,function(e){return e.tp===O.DoubleQString;});var d=/(\'|\/\/|\-\-|\/\*|\*\/)/;if(a&&d.test(a.v)){g.vs=Q.ERROR;g.rjec=U.ERROR;g.rjed=I(15665,"MDX pass-through expression should not contain ', //, --, /*, */.");}}},handleValidation:function F(a){if(!a){this.set("vStatus",Q.ERROR);return ;}a.vs=P(a.rjec);this.set("vStatus",a.vs);this.set("iStatus",mstrmojo.string.encodeHtmlString(a.rjed)||"");this.updateInputBoxItems(a);this.inputBox.focus();if(a.vs===Q.AMBIGUITY){var k=this,h=a.items,g=M.find(h,"sta",-1),b=h[g].v,i=function(c){k.replaceErrorToken(c);k.set("iStatus","");k.set("vStatus",Q.UNKNOWN);if(k.continueValidataion){k.continueValidataion();}else{k.set("vStatus",Q.VALID);}};var d=M.filter(a.srfd.items,this.isObjectVisible);var j=this.parent.candidates,e=j&&j.items;if(e){M.forEach(d,function(f){var c=M.find(e,"did",f.did);if(c===-1){if(this.absorbAmbiguity){e.push(f);}}else{f.path=e[c].path;}});}if(d.length===1){i(d[0]);return ;}this.openPopup("ambiguityDialog",{zIndex:100,items:d,ambiguousName:b,onItemSelect:i});}else{if(this.postHandleValidation){this.postHandleValidation();}}},tooltip:"",useRichTooltip:true,updateTooltipConfig:function X(b){var c=b.target||E.eventTarget(b.hWin,b.e),a=E.position(c);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.getTooltipContent(b),top:a.y+a.h,left:a.x+10,cssClass:"vi-regular vi-tooltip-A"};},getTooltipContent:function(a){return this.iStatus;},showTooltip:function D(a,b){if(a.target===this.iStatusNode){this._super(a,b);}}});mstrmojo.ME.MetricEditBox.VALIDATION_STATUS=Q;mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_CSS=G;mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_DESC=R;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.ui.menus._HasMenuPopup");function E(H,F){var G=this.domPopupPH;G.style.top=H.y+"px";G.style.left=H.x+"px";G.innerHTML="";document.body.appendChild(G);F.hostId=this.id;F.hostElement=G;mstrmojo.css.toggleClass(G,mstrApp.getThemeClassName(),true);this.openPopup(F.newInstance());}function B(){var G=this.domPopupPH,H=G.firstChild,F=G.parentNode;if(H){G.removeChild(H);}if(F){F.removeChild(G);}}function A(G){var F;if(typeof this.parent.boxContent.getTitleRMCPopup==="function"){F=this.parent.boxContent.getTitleRMCPopup.call(this);}if(F){E.call(this,G,F);}}mstrmojo.vi.ui.TitleBarWithRMCPopup=mstrmojo.declare(mstrmojo.vi.ui.TitleBar,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.TitleBarWithRMCPopup",markupString:'<div id="{@id}" class="mstrmojo-VITitleBar {@cssClass}" style="{@cssText}" mstrAttach:contextmenu, click><div class="left-toolbar"></div><div class="title-text"></div><div class="right-toolbar"></div></div>',init:function D(F){this._super(F);var G=document.createElement("div");G.setAttribute("class","gm-menu-placeholder");this.domPopupPH=G;},oncontextmenu:function C(F){A.call(this,{x:F.e.pageX+2,y:F.e.pageY+2});},unrender:function(){this._super();B.call(this);},onclick:function(){B.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.Image","mstrmojo.css");mstrmojo.vi.ui.CollapsibleTitleBar=mstrmojo.declare(mstrmojo.vi.ui.TitleBar,null,{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",btnCollapse:null,canCollapse:false,isCollapsed:false,collapse:mstrmojo.emptyFn,onToggleCollapseByUI:mstrmojo.emptyFn,setToolbarVisibility:function C(D){if(!D||!this.isCollapsed){this._super(D);}},onisCollapsedChange:function B(){if(this.canCollapse){var D=this.isCollapsed;this.parent.set("isCollapsed",D);}},getLeftToolbarChildren:function A(){var D=this;return[{scriptClass:"mstrmojo.Image",slot:"leftToolNode",alias:"btnCollapse",onclick:function(F){var G=this.parent,E=G.parent;if(G.canCollapse){G.set("isCollapsed",!G.isCollapsed);D.onToggleCollapseByUI();var H=F.e;if(H&&H.stopPropagation){H.stopPropagation();}}if(E&&E.clickToCollapse){E.clickToCollapse();}}}];}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.CollapsibleTitleBar,{oncanCollapseChange:function(){this.btnCollapse.set("visible",this.canCollapse);},onisCollapsedChange:function(){mstrmojo.css.toggleClass(this.domNode,"collapsed",this.isCollapsed);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.Popup","mstrmojo._HasPopup","mstrmojo.locales","mstrmojo.date","mstrmojo.string");var B=mstrmojo.ValidationTextBox.prototype.markupMethods,D=mstrmojo.string,A=function(){return mstrmojo.locales.datetime;},C=mstrmojo.date;mstrmojo.DateTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DateTextBox",calendarToBody:false,calendarZIndex:100,changeValueOnOK:false,dynDateValue:null,showAdvanced:false,canSelectDisabledDate:false,isList:false,dtp:14,defaultDate:null,autoFormat:true,enabled:true,min:"",max:"",markupString:'<div id="{@id}" class="mstrmojo-DateTextBox {@cssClass}" style="{@cssText}"><input class="mstrmojo-DateTextBox-input" type="text" title="{@tooltip}"value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><div class="mstrmojo-DateTextBox-icon" mstrAttach:click> </div><div class="mstrmojo-DateTextBox-popup"></div></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.childNodes[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onwidthChange:function(){if(this.width){this.inputNode.style.width=(this.width-20)+"px";this.iconNode.style.left=(this.width-18)+"px";this.domNode.style.width=this.width+"px";}},onvalueChange:B.onvalueChange,onenabledChange:B.onenabledChange,onvalidationStatusChange:B.onvalidationStatusChange},calConfig:null,calendar:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-DateTextBox-calendar",locksHover:true,slot:"popupNode",onOpen:function(){var H=this.opener,G=H&&H.calendarZIndex,I=this.cal,E=H&&H.calConfig;if(G){this.domNode.style.zIndex=G;}for(var F in E){I.set(F,E[F]);}},children:[{scriptClass:"mstrmojo.Calendar",alias:"cal",forceNonEmptySelection:true,bindings:{showAdvanced:"this.parent.opener.showAdvanced",dtp:"this.parent.opener.dtp",value:"this.parent.opener.value",dynDateValue:"this.parent.opener.dynDateValue",enabled:"this.parent.opener.enabled",min:"this.parent.opener.min",max:"this.parent.opener.max",canSelectDisabledDate:"this.parent.opener.canSelectDisabledDate",changeValueOnOK:function(){var F=this.parent.opener.dtp,E=this.parent.opener.changeValueOnOK;return F===15||F===16||E;}},closeOnValueChange:true,onValueUpdate:function(F){var I=this.parent&&this.parent.opener;if(I){var G=I.value,E=window.mstrConfig&&window.mstrConfig.listSep||";",H=I.dtp===15?C.formatTimeInfo(this.timeVal,A().TIMEOUTPUTFORMAT):this.value;if(I.isList&&!D.isEmpty(G)){I.set("value",I.value+E+H);}else{I.set("dynDateValue",this.dynDateValue);I.set("value",H);}I.closePopup();}}}]},onclick:function(E){var F=this._lastOpened,G=this._calendarConfig;if(!G){G={};if(this.calendarToBody){delete this.calendar.slot;G.placeholder=document.body.appendChild(document.createElement("div"));G.nudge=function(){var M=this.opener;if(M){var H=mstrmojo.dom.position(M.popupNode,true),L=this.domNode,P=L.offsetHeight,I=L.offsetWidth,J=mstrmojo.dom.windowDim(),K=H.x,N=H.y;if(N+P>=J.h){N=Math.max(N-P,0);}if(K+I>=J.w){K=Math.max(K-I,0);}var O=L.style;O.top=N+"px";O.left=K+"px";}};}this._calendarConfig=G;}G.lockIW=this;if(F&&F.visible){this.closePopup();}else{this.openPopup("calendar",G);this.calendar.cal.updateSelectedDate(true);}},unrender:function(){this._super();if(this.calendarToBody&&this._calendarConfig){delete this._calendarConfig;}if(this.calendar.hasRendered){this.calendar.unrender();}},_set_value:function(H,F){var G=this.value,E=(G!==F);if(E){this.value=F;this.validate(F);}if(this.showAdvanced&&this.dynDateChanged){this.dynDateChanged=false;E=true;}return E;},_set_dynDateValue:function(H,F){var G=this.dynDateValue,E=(G!==F);if(E){this.dynDateValue=F;this.dynDateChanged=true;}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.Arr","mstrmojo.AjaxCall","mstrmojo.css","mstrmojo.Calendar","mstrmojo.WidgetDial","mstrmojo.Label","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.registry","mstrmojo.string","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox","mstrmojo.mstr.EnumDataType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType");var s=mstrmojo.array,AH=s.map,J=mstrmojo.Arr,E=mstrmojo.css,V=mstrmojo.dom,W=mstrmojo.hash,AI=mstrmojo.string,A=mstrmojo.registry,U=mstrmojo.expr,O=U.ET,h=mstrmojo.mstr.EnumDataType,k=U.ET2TP,X=U.ET2TGT,AE=U.DTP,D=mstrmojo.meta.TP,P=mstrmojo.meta.STP,AO=mstrmojo.mstr.EnumDSSXMLObjectTypes,AA=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,G=mstrmojo.mstr.EnumDSSConsolidationType;var f="dummy",K={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:f,css:"unselectable",cls:"temp"},p={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:f,css:"unselectable",cls:"temp"},C={did:"idAttribute",v:"idAttribute",n:mstrmojo.desc(518,"Attribute"),t:f,css:"unselectable"},AC={did:"idMetric",v:"idMetric",n:mstrmojo.desc(517,"Metric"),t:f,css:"unselectable"},AB={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:f,css:"unselectable"},w={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:f,css:"unselectable"},B={did:"idWait",v:"idQualification",n:mstrmojo.desc(15008,"Qualify on"),t:f,css:"unselectable"};var AN={};AN[AE.DATE]=1;AN[AE.TIME]=1;AN[AE.TIMESTAMP]=1;var x={};x[O.MQ]={key:"metricFns",def:U.METRIC_FNS};x[O.MC]={key:"metricFns",def:U.METRIC_FNS};x[O.AQ]={key:"formFns",def:U.FORM_FNS};x[O.AL]={key:"formFns",def:U.FORM_FNS};x[O.AC]={key:"formFns",def:U.FORM_FNS};x[O.AE]={key:"elemFns",def:U.ELEM_FNS};var S=[U.STP.PROMPT,U.STP.PROMPT_OBJECTS,U.STP.PROMPT_ELEMENTS,U.STP.PROMPT_EXPRESSION,U.STP.PROMPT_EXPRESSION_DRAFT];function Z(AP){if(AP&&AP.t===AO.Consolidation&&AP.st===AA.ConsolidationManaged){return true;}return false;}function F(AR,AT,AQ){var AS=AR.items,AP=s.indexOf(AS,AT);if((AP===0)&&(AS.length===1)){AQ=mstrmojo.Arr.makeObservable((AQ&&AQ.length)?AQ.concat():[]);AR.set("items",AQ);}else{if(AP>-1){AS.splice(AP,1);}if(AQ&&AQ.length){s.insert(AS,(AP>-1)?AP:AS.length,AQ);}AR.refresh();}}function b(AX,AW){if(this.updating){return ;}var AP=this.multiSelect,AR=this.selectedItem,AU=AX&&AX.added,AT=AX&&AX.removed;AW=AW||this.alias;if(!AP&&AU&&AT&&AU[0]===AT[0]){return ;}if(AR&&AR[D]===f){this.updating=true;if(AP){this.removeSelect([this.selectedIndex]);}else{var AV=AT&&Number(AT[0]);AV=(AV==null)?-1:AV;this.set("selectedIndex",AV);}this.updating=false;}else{var AQ=this.parent.parent.parent.model;if(AP){var AS=this.items;AQ.edit(AW,{added:AU&&s.get(AS,AU),removed:AT&&s.get(AS,AT),itemIdField:this.itemIdField});}else{AQ.edit(AW,AR);}}}function R(AP,AR,AS){if(this.updating){return ;}AS=AS||this.alias;var AQ=AP.model;AQ.edit(AS,AR);}function t(){var AQ=this.parent,AP=((AQ&&AQ.cssText)||"").match(/height:\s*(\d*)px/);this.cssText=AP&&AP[0];}function N(AP){return mstrmojo.mixin(AP,{scriptClass:"mstrmojo.rw.ConditionList",cssClass:"mstrmojo-"+AP.alias,postCreate:t});}function Y(){var AQ=this.parent,AP=AQ.parent;AP["invalid"+AQ.cstIndex]=false;}function m(AR,AP,AS){var AQ=AR.cfg;if(AQ){AQ.data=AR;AQ.parent=AS;return A.ref(AQ);}AQ=new mstrmojo.Label({text:AR.n||"&nbsp;",cssClass:"dial-item "+(AR.t?("t"+AR.t):"")});AQ.markupMethods.onselectedChange=function(){E.toggleClass(this.domNode,["selected"],this.selected);};AQ.data=AR;AQ.parent=AS;return AQ;}function z(AP){switch(AP){case h.DataTypeInteger:case h.DataTypeUnsigned:case h.DataTypeDecimal:case h.DataTypeReal:case h.DataTypeDouble:case h.DataTypeFloat:case h.DataTypeCellFormatData:return h.DataTypeNumeric;default:return AP;}}function H(AR,AQ){var AP=AR.model||{},AS=AP.fn;return(AS!=null)&&((AP.et===O.MQ)||(AP.et===O.MC)||(AP.et===O.AQ)||(AP.et===O.AL)||(AP.et===O.AC))&&(U.fnCstCount(AS,AP.fnt)>AQ);}function o(AQ){var AT=AQ&&k[AQ.et],AS=AQ&&AQ.fm&&AQ.fm.dtp,AP=AS&&U.DTP2PROMPT_STP[AS],AR={};AR[AT]=true;if(AP){AR[AP]=true;}return AR;}function AK(AP,AR){var AQ;if(AR){switch(X[AP.et]){case"a":AQ=AR[O.AC];break;case"m":AQ=AR[O.MC];break;default:AQ=false;break;}}else{AQ=true;}return AQ&&U.fn_AC_MC(AP&&AP.fn);}function j(AP){var AS=AP.model,AW=AS&&AS[X[AS.et]]&&AS[X[AS.et]][AP.columnWalk.target.itemIdField||"did"],AR=AS&&AS.fm,AY=AR&&AR.dtp,AQ=AK(AS,AP.ets);if(this.targetsLastMod&&this.targetsLastMod===AP.targetsLastMod&&AW&&AW===this._lastTargetId&&this.lastFmDtp===AY&&this.lastFnTp===AQ){return ;}if(!AQ){this.clearSelect();if(this.items.length!==this.preLen){this.set("items",this.items.slice(0,this.preLen));}}else{var AU=AS.a?[C]:AS.m?[AC]:[],AT=e(AP),AX=AU.concat(AT),AV=this.items.slice(this.preLen);s.forEach(AV.reverse(),function(AZ){this.remove(AZ);},this);this.add(AX,-1);}this._lastTargetId=AW;this.lastFnTp=AQ;this.lastFmDtp=AY;this.targetsLastMod=AP.targetsLastMod;}function e(AP){var AQ=AP.model,AR=o(AQ),AS=AQ[X[AQ.et]];return U.getSortedObjectsByTypeGroup(s.filter(AP.targets,function(AT){return(AT.t!==4||AT.did!==AS.did)&&(AR[AT[D]]||AR[AT[P]]);}));}function a(AQ,AP){var AR=AQ.model||{},AS=AR.cs,AT=AS&&AS[AP];if(AR.et==O.MC&&AR["c"+(AP+2)]){AT=AR["c"+(AP+2)];}return AT;}function I(AP,AS){var AR=AP.model||{},AQ;switch(AR.et){case O.MC:case O.MQ:AQ=(AS&&AS.dtp)||z(AR.m.dt)||U.METRIC_DTP;if(AQ===AE.BIGDECIMAL){AQ=U.METRIC_DTP;}break;case O.AQ:case O.AC:case O.AE:case O.AL:AQ=AR.fm&&AR.fm.dtp;break;}return AQ||AE.CHAR;}function AM(AQ,AR){if(!AQ){return AQ;}if(AQ.dtp===AE.BIGDECIMAL&&AR===O.MQ){var AP=String(AQ.v);if(AP&&AP.indexOf("#")===-1){return"#"+AP+"#";}else{return AP;}}else{return AQ.v;}}function y(AQ,AP){var AS=AQ.model||{},AT=AS.cs,AU,AR;if(AS.et===O.AL){AR=[];s.forEach(AT,function(AV){AR.push(AV&&AV.v);});AR=AR.join(mstrConfig.listSep);}else{AU=a(AQ,AP);AR=AM(AU,AS.et);}return AR;}function L(Aj,Ab){Aj.updating=true;var AX=Aj.parent.parent.parent,Ai=H(AX,Ab),Ac,Ad;if(Ai){j.call(Aj,AX);var AS=AX.model||{},Ah=a(AX,Ab),AY=I(AX,Ah),Aa=y(AX,Ab);var AW=AS.fn,AU=U.fn_List(AW,AS.fnt),Ak=AN[AY],Ae=Ak&&!AU;var AQ=Aj.ctxtBuilder,Ag=AQ&&AQ.itemWidgets,AR=Ak?(Ae?Aj.calIndex:Aj.dtxtIndex):Aj.txtIndex,AV;for(Ac=0,Ad=Aj.preLen;Ac<Ad;Ac++){AV=Ag[Ac];if(Ac==AR){AV.set("dtp",AY);AV.set("isList",AU);var AP=AV.value,AT=AI.isEmpty(AP),Af=AI.isEmpty(Aa);if(!(AT&&Af)&&AP!==Aa){AV.set("value",Aa);}AV.set("visible",true);AV.set("hint",AU?mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"):"");try{if(Aj.alias!=="c1"||Aj.parent.c1Selected){AV.focus&&AV.focus();}}catch(AZ){}if(AW===1||AW===2){AV.constraints.min=0;}if(AV.clearValidation){AV.clearValidation();}}else{AV.set("visible",false);}}if(AX.hasPrompt&&Aj.selectedItem&&Aj.selectedItem.st===U.STP.PROMPT_STRING){AX.invalid0=false;}switch(AS.et){case O.AQ:case O.AL:case O.MQ:if(Ah&&Ah.p){Aj.set("selectedItem",Ah.p);}else{Aj.set("selectedIndex",AR);}break;case O.MC:case O.AC:Aj.set("selectedItem",AS[X[AS.et]+(2+Ab)]);break;}}Aj.updating=false;}function AJ(){var AS=this.parent,AQ=AS.parent.parent.parent,AR=(this.isValid&&this.isValid())||(!this.isValid&&!AI.isEmpty(this.value)),AP=AQ.model;AQ["invalid"+AS.cstIndex]=!AR;if(!this.updating&&AR){this.updating=true;if(AP){AP.edit(AS.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}if(AQ.updateOkBtn){AQ.updateOkBtn();}}function i(AQ){var AP=[{did:660,cfg:{scriptClass:"mstrmojo.ValidationTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP|mstrmojo.validation.TRIGGER.VALUESET},onValid:AJ,onInvalid:AJ,onClearValidation:Y,size:6,visible:false}},{did:154,cfg:{scriptClass:"mstrmojo.Calendar",onvalueChange:AJ,visible:false}},{did:23,cfg:{scriptClass:"mstrmojo.DateTextBox",cssText:"margin-left:9px;",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL-mstrmojo.validation.TRIGGER.ALL.ONBLUR},onValid:AJ,onInvalid:AJ,onClearValidation:Y,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(AR){V.stopPropogation(AR.hWin,AR.e);}},visible:false}}];return N(W.copy(AQ,{scriptClass:"mstrmojo.WidgetDial",makeObservable:true,itemFunction:m,selectionPolicy:"reselect",items:AP.concat(),txtIndex:0,calIndex:2,dtxtIndex:2,preLen:AP.length,insertUnlistedValuesAt:-1,itemIdField:"did",update:function(){L(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},itemsEffect:undefined,onchange:b}));}function AL(AQ,AP){var AR=AP+U.FN_SEP+AQ;return(AQ!=null)?{did:AR,n:AR}:null;}function Q(AR){var AT=this.selectedItem;AR=s.filter(AR,function(AU){return(!AU.icf);});if(AT){var AQ=s.find(AR,this.itemIdField,AT[this.itemIdField]);if(AQ>-1){AR=AR.concat();AR.splice(AQ,1);}}F(this,p,AR);var AS=this.items,AP=AS.length;if(AP===1){this.singleSelect(0);}this.updateScrollbars&&this.updateScrollbars();this.parent.updateScrollbars();}function n(AR,AQ,AS,AV){AR.updating=true;if(AQ){if(AS!=null){AR.set("items",[]);AR.clearSelect();AR.set("items",AS);}var AU=AR.itemIdField,AT=AR.selectedItem;if((AT&&AT[AU])!=(AV&&AV[AU])){var AP=Math.max(s.indexOf(AH((AS||[]),function(AW){return AW[AU];}),AV&&AV[AU]),0);AR.set("selectedIndex",AP);}}AR.updating=false;}function M(AR,AQ,AS,AV){AR.updating=true;if(AQ){if(AS!=null){AR.set("items",AS);}var AU=AR.itemIdField,AT=AR.getSelectedItem();if((AT&&AT[AU])!=(AV&&AV[AU])){var AP=Math.max(s.indexOf(AH((AS||[]),function(AW){return AW[AU];}),AV&&AV[AU]),0);AR.set("selectedIndex",AP);}}AR.updating=false;}function g(AP){return N(W.copy(AP,{insertUnlistedValuesAt:-1,hasDummyLabel:true,postCreate:function(){t.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,readCache:true,writeCache:true,params:{taskId:"getAttributeForms",attributeId:null,displayedForms:"0",styleName:"MojoAttributeStyle"},onsuccess:function(){var AS=this.parent,AR=this.response;if((AR&&AR.did)!==AS.lastAttrId){return ;}Q.call(this.parent,AR.fms||[]);},onerr:function(){F(this.parent,p,[K]);}});},update:function AQ(){var Ag=this.fmPost,AZ=this,AT=this.parent.parent.parent,AW=AT.model,Ae=AW&&AW["a"+Ag],Ab=!!Ae,AV,Aa,Af,AS=AT.disableElementsBrowsing,AR=Ae&&AS&&AS(Ae),Ad=Z(Ae);if(Ab){switch(AW.et){case O.AQ:case O.AL:Aa=AW.fm;break;case O.AC:Aa=AW["fm"+Ag];break;case O.AE:Aa=AL(AW.fn,1);break;}if(this.lastAttrId!==Ae.did){this.lastAttrId=Ae.did;AV=[];if(this.isFirstFm){if(!AR&&(!Ae.ilk&&(!AT.ets||AT.ets[O.AE]))){if(this.hasDummyLabel){AV.push(AB);}var AY=x[O.AE],Ac=AY&&AY.key,AU=AY.def;AV=AV.concat((Ac&&AT[Ac])||(Ad?s.filter(AU,function(Ah){return Ah.did!=="1,57";}):AU)||[]);s.forEach(AV,function(Ah){Ah.cls="fn";});}if(this.hasDummyLabel){AV.push(mstrApp.isWSStyling?B:w);}}if(Aa&&(AW.et!==O.AE)){AV.push(Aa);}Af=this.ajx;Af.params.attributeId=Ae.did;Af.params.otp=Ae.t||12;AV.push(p);J.makeObservable(AV);}}if(AR&&AW.et===O.AE){Aa=null;}n(this,Ab,AV,Aa);if(Ab&&Af){var AX;if(AT.getAttributeForms){AX=AT.getAttributeForms(Ae.did);}else{if(Ae.fms){AX=Ae.fms;}}if(AX&&AX.length>0){Q.call(this,AX);}else{if(Ae&&Ae.t===AO.Consolidation){Q.call(this,[]);}else{if(Af){if(mstrApp&&mstrApp.isWorkstation){mstrApp.serverRequest(Af.params,{success:function(Ah){if((Ah&&Ah.did)!==AZ.lastAttrId){return ;}Q.call(AZ,Ah.fms||[]);},failure:Af.onerror});}else{if(Af._delayId){window.clearTimeout(Af._delayId);delete Af._delayId;}Af._delayId=window.setTimeout(function(){delete Af._delayId;Af.send();},500);}}}}}}}));}function AG(AP){if(AP&&!W.isEmpty(AP)){var AQ=s.hash(S);W.forEach(AP,function(AS,AR){if(AS){AQ[k[AR]]=true;}});return AQ;}return null;}function l(AP,AQ,AS,AR){AP.updating=true;AP.clearSelect();s.forEach(AQ,function(AT){AT.title=AI.encodeHtmlString(AT.title||AT.n||"");});if(AQ){AP.set("items",AQ);}if(AS&&AS.length){AP.setSelectedItems(AS);}else{if(AR&&AR.length){AP.select(AR);}}AP.updating=false;}function d(AQ,AP,AR,AT,AS){if(AP){l(AQ,AR,AT,AS);}}mstrmojo.rw.ConditionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.rw.ConditionList",allowUnlistedValues:true,itemIdField:"did",getItemProps:function u(AT,AP){var AS=!!this.selectedIndices[AP],AV=AT.n,AR=false,AU=AT.ndetype===G.DssRecursiveDerivedElement;if(AT.t===12){var AQ=s.filter(AT.fs,function(AW){return AW.fgr>0;});if(AQ.length>0){AR=true;}}return W.copy({cls:(AS?mstrmojo._IsList.SELECTED_CLS:"")+" "+(AT.css||"")+" "+(AT.t?("t"+AT.t+((AT.da||AT.um)?"d":"")+(AR?"g":"")+(AT.st?(" st"+AT.st+(AU?" nde4ra":"")):"")):""),n:AV||"&nbsp;"},this._super(AT,AP));},onselectionChange:function AD(AP){this._super(AP);b.call(this,AP);}});mstrmojo.rw.ConditionWalkProviderBase=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.rw.ConditionWalkProviderBase",browseEs:function c(AS,AR,AU){AS.openPopup("eb",{zIndex:AS.parent.zIndex+10,left:Math.round(AU.x)+"px",top:Math.round(AU.y)+"px"});var AQ=AS.eb.browser,AP=AS.model,AT=AP&&AP.a&&AP.a.did;if(!AT){return ;}AQ.set("attributeID",AT);AQ.set("selectedItems",AP.es?W.clone(AP.es):[]);AQ.initBrowser();},browseObjs:function AF(AW,AP,AQ){AW.openPopup("ob",{zIndex:AW.parent.zIndex+10,left:Math.round(AQ.x)+"px",top:Math.round(AQ.y)+"px"});var AR=AW.ob.browser;AR.target=AP;var AS;switch(AP.alias){case"dmy":AS=[U.TP.ATTR,U.TP.DIM];break;case"c0":case"c1":var AU=AW.model,AT=AU&&AU.et,AX=AU&&AU.fm,AV=AX&&AX.dtp||(AU.m?U.DTP.DECIMAL:U.DTP.UNKNOWN);AS=(AT===O.MQ||AT===O.MC)?[U.TP.METRIC,U.DTP2PROMPT_STP[AV]]:[U.TP.ATTR,U.DTP2PROMPT_STP[AV]];break;default:AS=AG(AW.ets);AS=AS?W.keyarray(AS,true):[U.TP.ATTR,U.TP.METRIC,U.STP.REPORT_GRID,U.STP.REPORT_GRAPH,U.STP.REPORT_ENGINE,U.STP.REPORT_TEXT,U.STP.REPORT_DATAMART,U.STP.REPORT_BASE,U.STP.REPORT_GRIDGRAPH,U.STP.REPORT_NONINTERACTIVE,U.STP.FILTER].concat(S);}AS[AS.length]=U.TP.FOLDER;AR.browse({rootFolderType:AU&&(AU.et===O.MQ||AU.et===O.MC)?5:26,folderLinksContextId:33,onSelectCB:[AW,"onOBSelect"],browsableTypes:AS.join(",")});},});var q=mstrmojo.rw.ConditionWalkProviderBase;q.onWalkChange=b;q.replaceItem=F;q.getChildJSON=N;q.walkChildPostCreateFn=t;q.cstJson=i;q.isComparisonAllowed=AK;q.clearInvalid=Y;q.updateCst=L;q.widgetItemFn=m;q.shouldShowCst=H;q.getConstant=a;q.getConstantDataType=I;q.getConstantValue=y;q.isDATE=AN;q.getCstListCompareTgts=e;q.fmJson=g;q.fnItem=AL;q.updateList=n;q.allowedTargetTypes=AG;q.updatePulldown=M;q.onWalkChangeThroughPulldown=R;q.updateListMultiData=l;q.updateListMulti=d;})();(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.CollapsibleTitleBar","mstrmojo.ui.menus.ToolbarConfig","mstrmojo.ui.menus.Menu","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.css,C="visible",G="containerNode";function E(Q){Q.btn.style.display=!!Q.menuCfg?"block":"none";}mstrmojo.vi.ui._IsPanel=mstrmojo.provide("mstrmojo.vi.ui._IsPanel",{_mixinName:"mstrmojo.vi.ui._IsPanel",markupString:'<div id="{@id}" class="mstrmojo-VIPanel {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="mstrmojo-VIPanel-titlebar"></div><div class="mstrmojo-VIPanel-content"></div><div class="mstrmojo-VIDND-mask"></div><div class="mstrmojo-VIPanel-handle splitter v"></div></div>',markupSlots:{titlebarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.childNodes[2];},handleNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onisCollapsedChange:function L(){if(this.canCollapse){this.containerNode.style.display=this.isCollapsed?"none":"block";if(!this.isCollapsed){this.doLayout();}}}},title:"",titleBar:null,titlebarNode:null,containerNode:null,maskNode:null,handleNode:null,bubbleMouseOver:true,canCollapse:false,isCollapsed:false,autoHideToolbar:false,init:function K(Q){this._super(Q);this.addChildren([this.getTitleBarCfg()]);this.menuBtnInfo={};},skipsSlotLayout:function(Q){return Q===G&&this.isCollapsed;},getTitleBarCfg:function P(){return{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",slot:"titlebarNode",alias:"titleBar",isCollapsed:this.isCollapsed,title:this.title,close:function(){this.parent.setOpenStatus(false);mstrApp.rootCtrl.generateToolbar();},collapse:function(Q){this.parent.set("isCollapsed",Q);}};},ontitleChange:function H(){this.titleBar.set("title",this.title);},_set_children:function A(U,R,Q){if(R!==this.children){var S=this.titleBar;if(S){R.push(S);}}return this._super(U,R,Q);},preBuildRendering:function I(){this.generateToolbar();this.titleBar.setToolbarVisibility(!this.autoHideToolbar);return this._super();},generateToolbar:function B(){var Q=this.titleBar;Q.set("toolbarCfg",this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));if(!Q.visible){this.menuBtnInfo.menuCfg=Q.getMenuConfig();}},updateToolbar:function O(Q){return Q;},setOpenStatus:function N(Q){if(this.visible!==Q){this.set("visible",Q);this.parent.doLayout();}},setTitleBarVisibility:function D(Q){var S=this.titleBar;S.set("visible",Q);this.generateToolbar();var U=this.menuBtnInfo,R=U.btn;if(!R){R=U.btn=document.createElement("div");R.className="hover-menu-btn";var V=this.id;mstrmojo.dom.attachEvent(R,"click",function(){var X=mstrmojo.all[V],W=U.menuCfg;W.hostId=V;W.hostElement=R;X.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:W}));});this.domNode.appendChild(R);}U.menuCfg=Q?null:S.getMenuConfig();E(U);this.doLayout();},onmouseover:function M(Q){if(!mstrApp.isInteractive()){return ;}if(!this.bubbleMouseOver){Q.cancel();}var S=this._panelTimeout;if(S){window.clearTimeout(S);delete this._panelTimeout;}if(this.autoHideToolbar){this.titleBar.setToolbarVisibility(true);}var R=this.menuBtnInfo;if(!!R.menuCfg){F.addClass(R.btn,C);}},onmouseout:function J(){var Q=this.id;this._panelTimeout=window.setTimeout(function(){var R=mstrmojo.all[Q];if(R){if(R.autoHideToolbar){R.titleBar.setToolbarVisibility(false);}var S=R.menuBtnInfo;if(!!S.menuCfg){F.removeClass(S.btn,C);}}},200);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBarWithRMCPopup","mstrmojo.vi.ui._IsUnitContainerTitleBar","mstrmojo.vi.ui.toolbars.TitleToolbar");function C(F,D,E){return[{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:F+"ToolNode",alias:D,visible:true,useRichTooltip:E}];}mstrmojo.vi.ui.VizBoxTitleBar=mstrmojo.declare(mstrmojo.vi.ui.TitleBarWithRMCPopup,[mstrmojo.vi.ui._IsUnitContainerTitleBar],{scriptClass:"mstrmojo.vi.ui.VizBoxTitleBar",leftToolbar:undefined,getLeftToolbarChildren:function A(){return C("left","leftToolbar",false);},getRightToolbarChildren:function B(){return C("right","tbToolbar",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui.tabs.Tab","mstrmojo.Label","mstrmojo.Button","mstrmojo.Pulldown","mstrmojo.Box","mstrmojo.dom","mstrmojo.css","mstrmojo.tooltip","mstrmojo.ME.MetricEditBox","mstrmojo.array","mstrmojo.hash","mstrmojo.mstr.EnumDSSXMLBaseFormType");var f=mstrmojo.array,N=mstrmojo.hash,M=mstrmojo.ME.MetricToken.brackets,B=mstrmojo.css,S=mstrmojo.vi.ui.tabs.Tab.ACTIONS,m=S.DELETE+S.RENAME,n=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,o=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_CSS,O=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_DESC,W=mstrmojo.mstr.EnumDSSXMLObjectTypes,D=mstrmojo.string,q="This@ID",Y="45C11FA478E745FEA08D781CEA190FE5",V=mstrmojo.mstr.EnumDSSXMLBaseFormType,t=[{n:mstrmojo.desc(959,"Default"),v:V.DssXmlBaseFormReserved},{n:mstrmojo.desc(12276,"String"),v:V.DssXmlBaseFormText},{n:mstrmojo.desc(2052,"Date"),v:V.DssXmlBaseFormDate},{n:mstrmojo.desc(3434,"Number"),v:V.DssXmlBaseFormNumber}],Z=function(){var y="analytical_engine_version.htm",x=mstrApp.showHelpTopic;if(x){x(y,"upgrade");}else{window.open(mstrmojo.upgradeHelpPath()+y,"_blank");}};function H(x){return{n:x,k:x,ftk:[],vs:1,is:"",bft:V.DssXmlBaseFormReserved,bftp:V.DssXmlBaseFormReserved};}function Q(AD,AE,x,AB){var z=AD.forms[AE]||{},AC=AD.forms[x],y=AD.inputBox,AA=AD.statusBox.pulldownBox.pulldown;if(AE!==x){z.vs=AD.vStatus;z.is=AD.iStatus;z.bft=AD.formType||AA.getSelectedItem().v;z.bftp=AD.formType||AA.getSelectedItem().v;z.ftk=y.items;AD.set("vStatus",n.UNKNOWN);}AD.set("vStatus",AC.vs);AD.set("iStatus",AC.is);AD.updateInputBoxItems({items:AC.ftk});if(AD.curFormIdx!==x){AD.curFormIdx=x;AD.tabstrip.setSelectedTab(AC.k);}AA.set("selectedIndex",f.find(AA.items,"v",AC.bft));AD.raiseEvent({name:"tabSwitch",tks:AC.ftk,vs:AC.vs,is:AC.is,bft:AC.bft,bftp:AC.bftp,oidx:AE,nidx:x,toNewTab:AB});}function P(y){var x=y.forms[y.curFormIdx];if(x){x.ftk=y.inputBox.items;x.vs=y.vStatus;x.is=y.iStatus;}}var l=0;function c(x){l=Math.max(x.length-1,l);}function b(){l=0;}function s(x){var y="DESC"+(l?" "+l:"");l++;if(f.find(x,"n",y)>=0){return s(x);}return y;}function J(AA){var z={v:M(AA.n),oi:AA,isNew:true},y,x;if(AA.t===12){y=f.filter(AA.fs,function(AB){return AB.obf||AA.da;}).length;if(y===1){x=AA.fs[0];z=N.copy({v:M(AA.n)+"@"+M(x.fnm),ift:true,exv:x.fid,extp:8},z);}else{z=N.copy({v:M(AA.n)+"@",ift:true},z);}}return z;}function E(y,x){y.set("enabled",!x);var z="mstrmojo-InlineWaitIcon";if(y.iconClass){y.set("iconClass",y.iconClass.replace(new RegExp(z),"")+" "+(x?z:""));}else{mstrmojo.css.toggleClass(y.domNode,z,x);}}function L(x){return x.tp===33||x.tp===37;}function F(x){return x.tp===-1;}var a=function(AD){var AB=AD.items,y=AB.length,AA,AC,z=[],x="";z.push({v:"!",tp:33,lv:4,sta:2});for(AA=0;AA<y;AA++){AC=AB[AA];if((AA===0&&L(AC))||F(AC)){continue;}if(AC.isNew&&!AC.oi){x+=AC.v;}else{if(!D.isEmpty(x)){z.push({v:x,tp:2,lv:1});x="";}if(AC.v&&AC.v.indexOf(q)>=0){AC.v=AC.v.replace("["+q+"]",q);AC.exv=Y;AC.extp=8;delete AC.oi;}else{if(AC.ift){delete AC.oi;}}z.push(AC);}}if(!D.isEmpty(x)){z.push({v:x,tp:2,lv:1});x="";}z.push({v:"",tp:-1,lv:4,sta:2});return{items:z};},g=function(z){var x=z.items||[],y=x[x.length-1];if(y&&y.tp===-1){x.pop();}if(x[0]&&L(x[0])){x.splice(0,1);}f.forEach(x,function(AA){if(AA.v&&AA.v.indexOf(q)>=0){N.copy({extp:8,exv:Y,oi:{n:"This",did:"This",t:12}},AA);}});},e=function(x){if(!x){return n.VALID;}return{"-2147214845":n.ERROR,"-2147214846":n.AMBIGUITY}[x]||n.ERROR;},U=function(z){z=a(z);var y={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true,vtp:true},x={getArrItemName:function(){return"tkn";},isSerializable:function(AA){return(y[AA])?true:false;}};return D.json2xml("tknstrm",z,x);},G=function(z,AC,AB,y){var AA=U(AC),AD=function(AE){if(AE&&AE.tks){var AF=AE.tks;g(AF);AF.vs=e(AF.rjec);AF.tokenXML=AA;if(y){y(AF);}}},x=function(AE){mstrmojo.alert(AE.message||AE.getResponseHeader&&AE.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:AA,localSymbolFolderXML:"",metricXML:"",metricId:z||"",isNew:true,objectType:12,isIDForm:AB,msgID:mstrApp.getMsgID()},{success:AD,failure:x});};mstrmojo.ME.DerivedAttributeFormTab=mstrmojo.declare(mstrmojo.vi.ui.tabs.Tab,null,{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",valid:true,editable:true,postBuildRendering:function X(){if(this._super){this._super();}var x=this,y=x.lbl;y.editOnDoubleClick=this.editable;y.onTextEditComplete=function(AA,z){if(x.validate(y.text)){x.titleEdited(y.text,z);}};},onclick:function k(x){var y=mstrmojo.dom.eventTarget(x.hWin,x.e);if(y===this.menuBtnNode){this.tabDeleted();}else{if(!this.isSelected){this.tabSelected();}}},validate:function(x){var y=!/[\[\]\"\\]/g.test(x);if(!y){this.lbl.set("isEditing",true);}this.set("valid",y);return y;},showErrTooltip:function w(AB,z){var x=mstrmojo.dom.position(this.domNode),y=this,AA=y.errTooltip;if(!AA){y.errTooltip=AA=new mstrmojo.Tooltip({contentNodeCssClass:"me-tooltip-content up me-err",updatePopupConfig:null});this.addDisposable(AA);}AA.set("top",x.y+x.h+2);AA.set("left",x.x+x.w/2-z);AA.set("content",'<div class="content"><span>'+AB+"</span></div>");AA.open();window.setTimeout(function(){AA.close();},2500);},onvalidChange:function(){if(this.valid){this.hideTooltip();}else{this.showErrTooltip(mstrmojo.desc(11569,"Input contains invalid character"),95);}}});function j(AA,AB,AC){var z=f.find(AB,"k",AC.k);return{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",title:AC.n,draggable:false,editable:z!==0,cssClass:"mstrmojo-AEB-Tab "+(z===0?"mstrmojo-AEB-IDTab":""),getMenuActions:function(){return m;},tabSelected:function(){Q(AA,AA.curFormIdx,z);},titleEdited:function y(AE,AD){if(AE!==AD){if(f.find(AA.forms,"n",AE)>=0){this.showErrTooltip(mstrmojo.desc(7209,"Name already exists"),69);}else{var AF=AA.forms[z];AF.n=AE;AA.set("dirty",true);}}},tabDeleted:function x(){var AD=AA.forms.length,AG=(AA.curFormIdx===AD-1)?0:AA.curFormIdx,AE=AA.forms.slice(0),AF=AE[z];if(AF&&AF.did){AA.delForms.push({n:AF.n,did:AF.did});}AE.splice(z,1);AA.curFormIdx=AG;AA.set("forms",AE);Q(AA,-1,AG);AA.set("dirty",true);}};}mstrmojo.ME.AttributeEditBox=mstrmojo.declare(mstrmojo.ME.MetricEditBox,null,{scriptClass:"mstrmojo.ME.AttributeEditBox",markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-AEB-TabStrip"></div><div class="mstrmojo-MEBox-edit mstrmojo-AEB-edit"></div><div class="mstrmojo-AEBox-status {@statusCssClass}"></div></div>',markupSlots:{tabstripNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},statusNode:function(){return this.domNode.lastChild;}},markupMethods:{onvStatusChange:function(){var y=this.vStatus,AC=(y===n.VALID),AA=(y===n.UNKNOWN||y===n.VALIDATING),z=this.statusBox.infoBox;this.validateBtn.set("visible",AA);z.set("visible",!AA);if(!AA){z.infoLabel.set("text",AC?mstrmojo.desc(11655,"Valid formula."):mstrmojo.desc(15953,"Validation failed."));var AB=o[y],x=z.infoIcon.domNode;if(!B.hasClass(AB)){B.removeClass(x,[o[n.VALID],o[n.ERROR],o[n.AMBIGUITY]]);B.addClass(x,AB);}}},oniStatusChange:function(){var z=this.vStatus,x=(z===n.ERROR||z===n.AMBIGUITY),y=this.statusBox.infoBox.infoIcon;y.title=x?(this.getStatusDesc&&this.getStatusDesc(z))||O[z]+" "+this.iStatus:"";}},forms:null,delForms:[],curFormIdx:0,attrid:null,absorbAmbiguity:false,init:function p(AA){var AB=this,AD=function(){AB.validateCurrentForm();},z=[{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",alias:"tabstrip",position:"top",slot:"tabstripNode",isAlignRight:false,getTabCfg:function y(AG,AH,AF){return N.copy(j(AB,AG,AH),AF);},addTab:function AE(){var AH=AB.forms,AF=AH.length,AI=s(AH),AG=AH.slice(0);AG.push(H(AI));AB.set("forms",AG);Q(AB,AB.curFormIdx,AF,true);AB.set("dirty",true);},clear:function x(){f.forEach(this.children,function(AF){AF.hideTooltip();});}},{scriptClass:"mstrmojo.Button",alias:"clearBtn",slot:"tabstripNode",text:mstrmojo.desc(2827,"Clear"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-clearAll hoverLink",onclick:function(){AB.inputBox.clearTokens([]);AB.inputBox.raiseChangeEvent({type:"clear"});}},{scriptClass:"mstrmojo.Box",alias:"statusBox",slot:"statusNode",cssClass:"statusBox",children:[{scriptClass:"mstrmojo.Box",alias:"pulldownBox",cssClass:"pulldownBox",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-AEBox-pulldownLabel AEBox-item",text:mstrmojo.desc(9918,"Data Type")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"pulldown",cssClass:"mstrmojo-AEBox-pulldown AEBox-item",selectedIndex:0,items:t,onitemSelected:function(AI){var AF=AB.curFormIdx,AG=AB.forms,AH=AG&&AG.length>AF&&AG[AF];if(AH){if(AH.bft!==AI.v){AH.bft=AH.bftp=AI.v;AB.set("dirty",true);}}}}]},{scriptClass:"mstrmojo.Box",cssClass:"helpIcon",cssDisplay:"inline-block",richTooltip:{cssClass:"vi-regular vi-tooltip-A A-center AE-tooltip",posType:mstrmojo.tooltip.POS_TOPCENTER,enableHover:true},useRichTooltip:true,tooltipCloseDelay:500,updateTooltipConfig:function AC(){var AG=this.richTooltip,AF=mstrmojo.dom.position(this.domNode);AG.left=AF.x+AF.w-8;AG.top=AF.y+28;AG.content=mstrmojo.desc(16313,"Data Type options for derived attribute forms are only available for data engine version 11.1 and later.");AG.content+="<br /><div class='help-link-label' onclick='mstrmojo.ME.AttributeEditBox.AEHelpFn()'>"+mstrmojo.desc(9849,"Learn More")+"</div>";}},{scriptClass:"mstrmojo.Box",alias:"infoBox",cssClass:"infoBox",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Button",alias:"infoIcon",cssClass:"mstrmojo-AEBox-infoIcon AEBox-item",title:"",tooltipOpenDelay:0,useRichTooltip:true,updateTooltipConfig:function(){var AF=mstrmojo.dom.position(this.domNode);this.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",top:Math.max(AF.y+26,0),left:Math.max(AF.x+10,0),posType:mstrmojo.tooltip.POS_TOPCENTER,content:this.title};}},{scriptClass:"mstrmojo.Label",alias:"infoLabel",cssClass:"mstrmojo-AEBox-infoLabel AEBox-item"}]}]}];this.validateFunc=AD;AB.children=z.concat(this.children);this._super(AA);},item2textCss:function K(x){return this._super(x)||{21:"afm"}[x.t]||"";},onformsChange:function d(){var x=this.forms,y=x[this.curFormIdx].k;f.forEach(x,function(z){g({items:z.ftk});});this.tabstrip.setTabs(x,y);c(x);},selectFormTab:function A(x){Q(this,this.curFormIdx,x);},postBuildRendering:function X(){if(this._super){this._super();}this.clear();var x=this;this.inputBox.ondrop=function(AB){if(!AB.src.data||!AB.src.data.item){return ;}var AA=x.inputBox,AD=AA.ctxtBuilder.itemWidgets,AE=N.copyProps(["did","n","t","fs"],AB.src.data.item),AG=J(AE),y,AF,z;AB.src.data=AG;mstrmojo.ListBase2.prototype.ondrop.call(this,AB);var AC=function(AH){return AH.t===W.Function&&!(!isNaN(AH.fdid)&&AH.fdid<0);};if(AC(AG.oi)){this.insertParenthesisTokens();}if(x.ontokensModify){x.ontokensModify();}y=this.selectedIndices;if(AE.t===12&&AG.ift&&!AG.exv){for(AF in y){z=AD[AF];if(z){AA.startTokenSuggestion(z);}}}AA.clearSelect(true);B.removeClass(AA.domNode,"unselectable");};},clear:function i(){this.curFormIdx=0;this.delForms=[];this.attrid=null;b();this.set("forms",[H("ID")]);this.inputBox.set("items",[]);this.inputBox.resetTokensCache();this.set("vStatus",n.UNKNOWN);this.set("iStatus","");this.tabstrip.clear();},validateCurrentForm:function C(y){var z=this,AA=this.validateBtn,x=function(AB){E(AA,false);z.set("vStatus",AB.vs);z.set("iStatus",AB.rjed||"");z.updateInputBoxItems({items:AB.items});z.statusNode.style.display="block";z.handleValidation(AB);if(y){y(AB.items,AB.vs===n.VALID);}};z.set("vStatus",n.VALIDATING);E(AA,true);G(this.attrid,{items:this.inputBox.items},z.curFormIdx===0,x);},validateAllForms:function u(z){var AA=this,y=AA.forms,x=0,AB=function(AE){var AD=(x===0);if(AE){var AC=y[x-1];AC.ftk=AE.items;AC.vs=AE.vs;AC.is=AE.rjed||"";AC.tokenXML=U({items:AE.items});if(AE.vs!==n.VALID){AA.selectFormTab(x-1);AA.handleValidation(AE);if(z){z(null,false);}return ;}}if(x===y.length){if(z){z(y,true);}return ;}G(AA.attrid,{items:y[x++].ftk},AD,AB);};P(AA);AB();},continueValidataion:function R(){this.validateCurrentForm();},getStatusDesc:function h(x){return{0:mstrmojo.desc(11655,"Valid Formula.")}[x];},onObjectInsert:function I(AA){var AB=this.inputBox,z=J(AA),x=AB.insertTokens([z]),y;if(AA.t===12&&z.ift&&!z.exv){y=AB.ctxtBuilder.itemWidgets[x];if(y){AB.startTokenSuggestion(y);}}}});mstrmojo.ME.AttributeEditBox.preprocessTokenStream=g;mstrmojo.ME.AttributeEditBox.postprocessTokenStream=a;mstrmojo.ME.AttributeEditBox.mapErrorCode=e;mstrmojo.ME.AttributeEditBox.getTokenStreamXML=U;mstrmojo.ME.AttributeEditBox.validateSyntax=G;mstrmojo.ME.AttributeEditBox.prepareInsertToken=J;mstrmojo.ME.AttributeEditBox.AEHelpFn=Z;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton","mstrmojo.color","mstrmojo.hash","mstrmojo.models.FormatModel");var Q=mstrmojo.color,P=1,L=2,E=4,G=45,U=mstrmojo.models.FormatModel,K=U.ENUM_PROPERTY_NAMES,O=K.BACKGROUND_COLOR,F={all:{c:K.BORDER_COLOR,s:K.BORDER_STYLE},top:{c:K.BORDER_TOP_COLOR,s:K.BORDER_TOP_STYLE},right:{c:K.BORDER_RIGHT_COLOR,s:K.BORDER_RIGHT_STYLE},bottom:{c:K.BORDER_BOTTOM_COLOR,s:K.BORDER_BOTTOM_STYLE},left:{c:K.BORDER_LEFT_COLOR,s:K.BORDER_LEFT_STYLE}},J={FILL_COLOR:"fillColor",BORDER:"border",SIZE:"size",POSITION:"position",SIZE_HEIGHT:"sizeHeight",SIZE_WIDTH:"sizeWidth",POSITION_LEFT:"positionLeft",POSITION_TOP:"positionTop"};function S(X,V){V.forEach(function(Z,Y){Z.slot="col"+(Y+1)+"Node";});var W=this.secondColumnWidth;return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:X,col1Width:(100-W)+"%",col2Width:W+"%",children:V};}function C(W,V){V.forEach(function(Y,X){Y.slot="col"+(X+1)+"Node";});return{scriptClass:"mstrmojo.ui.editors.controls.ThreeColumnContainer",alias:W,col1Width:G+"%",col2Width:100-2*G+"%",col3Width:G+"%",children:V};}function A(V,W){return{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:V,cssClass:"right",constraints:{regExp:/^(?:100(?:\.00?)?|\d?\d(?:\.\d\d?)?)?[\%]?$/},onValid:function(){if(this.value){var X=this.parent.parent;if(X.raiseFormatLayoutChange){X.raiseFormatLayoutChange(W,this.value,this.orignText);}}}};}function D(V){return{scriptClass:"mstrmojo.Label",cssClass:"center",text:V};}function H(V,Y,X,W){return C(V,[D.call(this,Y),D.call(this,X),D.call(this,W)]);}function R(X,V,W){return mstrmojo.hash.copy(W,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",showGradient:!!V,postselectedValueChange:function(Y){this.parent.parent.raiseFormatValueChange(X,Y.value,Y.valueWas);}});}function I(Y){var X="transparent",V="none",W;if(Y){W=Y.indexOf("#");if(W===-1){W=Y.indexOf(X);}}if(!isNaN(W)&&W>-1){V=Y.substr(0,W-1);X=Q.fixFullHexValue(Y.substr(W));}else{V=Y;}if(V.indexOf("none")>-1){V="none";}return{s:V,c:X};}mstrmojo.ui.editors.controls.ContainerGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.ContainerGroup",borderTitle:mstrmojo.desc(13631,"Outer border"),fillColorTitle:mstrmojo.desc(7993,"Fill color"),showThickBorderStyle:true,showBackgroundNoFill:true,showBackgroundGradient:false,showBorderNoFill:true,visibleControls:P+L,targetBorder:"all",secondColumnWidth:60,init:function M(Y){this._super(Y);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditContainer");var X=[],W=this.visibleControls,V=F[this.targetBorder];if((W&P)>0){X.push(S.call(this,J.FILL_COLOR,[{scriptClass:"mstrmojo.Label",text:this.fillColorTitle},R(O,this.showBackgroundGradient,{showNoFill:this.showBackgroundNoFill})]));}if((W&L)>0){X.push(new mstrmojo.Label({text:this.borderTitle}));X.push(S.call(this,J.BORDER,[{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:this.showThickBorderStyle,postselectedValueChange:function(Z){var a=this.parent.parent;a.raiseFormatValueChange(V.s,Z.value,Z.valueWas);a[J.BORDER].getControl(2).set("enabled",Z.value!=="none");}},R(V.c,false,{showNoFill:this.showBorderNoFill})]));}if((W&E)>0){X=X.concat([new mstrmojo.Label({text:mstrmojo.desc(16651,"Position and Size")}),H.call(this,null,"X"," ","Y"),C(J.POSITION,[A.call(this,J.POSITION_LEFT,"left"),D.call(this,"x"),A.call(this,J.POSITION_TOP,"top")]),H.call(this,null,mstrmojo.desc(2985,"Width")," ",mstrmojo.desc(2983,"Height")),C(J.SIZE,[A.call(this,J.SIZE_WIDTH,"width"),D.call(this,"x"),A.call(this,J.SIZE_HEIGHT,"height")])]);}this.addChildren(X);},setPositionAndSize:function N(W){var V=this[J.POSITION],Z=this[J.SIZE],X=W.prop,Y=function(b,d){var a=Math.round(d.split("|")[0]*100)/100,c=b.domNode;b.set("value",null);b.set("hint",a+"%");if(c){c.style.borderColor=(a>=0&&a<=100)?"":"red";}};if(V){Y(V[J.POSITION_LEFT],X.left);Y(V[J.POSITION_TOP],X.top);}if(Z){Y(Z[J.SIZE_HEIGHT],X.height);Y(Z[J.SIZE_WIDTH],X.width);}},setFormatSource:function B(W){var V=this[J.FILL_COLOR],Z=this[J.BORDER],Y=this.targetBorder,X=F[Y];if(Y==="all"){X=F.top;}this.syncControls(function(){if(V){var c=U.decodeGradientValue(U.getGradientValues(W)),f;if(!c){if(W[K.FILL_STYLE]===1){f="transparent";}else{var b=W[O];if(typeof b==="undefined"||b===null){b=W["background-color"];}if(typeof b==="undefined"||b===null){b=-1;}f=U.decodeValue(O,b);}}V.getControl(2).set("selectedValue",c||f);}if(Z){var d=W.border;if(!d){if(typeof (W.borderStyle)!=="undefined"&&W.borderStyle!==null){d=typeof (W.borderStyle)==="string"?W.borderStyle:U.decodeValue("borderStyle",W.borderStyle);}else{d=U.decodeValue(X.s,W[X.s]);}if(typeof W.borderColor!=="undefined"&&W.borderColor!==null){d+=" "+U.decodeValue("borderColor",W.borderColor);}else{if(typeof W[X.c]!=="undefined"&&W[X.c]!==null){d+=" "+U.decodeValue(X.c,W[X.c]);}else{d+=" "+U.decodeValue(X.c,-1);}}}var e=I(d),a=Z.getControl(2);Z.getControl(1).set("selectedValue",e.s);a.set("enabled",e.s!=="none");a.set("selectedValue",e.c);}});}});mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS={FILL_COLOR:P,BORDER:L,SIZE_POSITION:E};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.hash","mstrmojo.array","mstrmojo.ValidationTextBox","mstrmojo.expr");var K=mstrmojo.emptyFn,B=mstrmojo.hash,H=mstrmojo.array,I=mstrmojo.expr.DTP,F={FILL_COLOR:"Clr",FILL_TRANSPARENT:"FillTrans"},C=1,J=2;function N(U,Q,P,S,R){return{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"fillColor",slot:U,showNoFill:S!==false,showAutomatic:!!R,showGradient:false,selectedValue:"#000000",isHostedWithin:Q||false,postselectedValueChange:function(V){if(this.propName&&this.parent&&this.parent.parent){this.parent.parent.raiseFormatValueChange(this.propName,V.value,V.valueWas);}},postclick:function(V){this.parent.parent.postclick(V);}};}function O(Q){return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillAlpha",slot:Q,col1Width:"100%",col2Width:"10px",children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"fillAlphaText",slot:"col1Node",value:"100",cssText:"text-align:right",dtp:I.INTEGER,required:true,constraints:{min:0,max:100},onvalueChange:function(R){this.valueWas=R.valueWas;},onValid:function P(){if(this.propName&&this.value!==this.valueWas){this.parent.parent.parent.raiseFormatValueChange(this.propName,this.value,this.valueWas);}},postclick:function(R){this.parent.parent.parent.postclick(R);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:"%"}]};}mstrmojo.ui.editors.controls.FillConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.FillConfigGroup",propNames:undefined,postclick:K,visibleControls:C+J,fillColorAndTrans:undefined,init:function M(U){this._super(U);var Q=[],X="col1Node",R=U&&U.colorPickerHostWithin,P=U&&U.showGradient,W=U&&U.showNoFill,S=U&&U.showAutomaticInColor,V;if((this.visibleControls&C)>0){Q.push(N(X,R,P,W,S));X="col2Node";}if((this.visibleControls&J)>0){Q.push(O(X));}if(Q.length===1){V={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}this.addChildren([B.copy(V,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillColorAndTrans",children:Q})]);},getChildComp:function L(P){if(P.indexOf(F.FILL_COLOR)!==-1){return this.fillColorAndTrans.fillColor;}if(P.indexOf(F.FILL_TRANSPARENT)!==-1){return this.fillColorAndTrans.fillAlpha.fillAlphaText;}return undefined;},iniChildrenComp:function E(P){this.propNames=P;H.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);},setChildValue:function D(Q,R){var P=this.getChildComp(Q);if(P===undefined){return false;}switch(P.alias){case"fillColor":if(R!==P.selectedValue){P.set("selectedValue",R==="undefined"?"conflict":R);}break;case"fillAlphaText":if(R!==P.value){P.set("value",R==="undefined"?"":R);}break;}},setChildEnable:function G(R,Q){var P=this.getChildComp(R);if(P!==undefined){P.set("enabled",Q);}},setChildrenValue:function A(P){var Q=this;P.forEach(function(R){Q.setChildValue(R[0],R[1]);});}});mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS={FILL_COLOR:C,FILL_TRANSPARENCY:J};mstrmojo.ui.editors.controls.FillConfigGroup.FillCompName=F;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.Pulldown","mstrmojo.string","mstrmojo.ui.ButtonBar","mstrmojo.ui.editors.controls.ComboBox","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.NumGroupStepperContentProvider","mstrmojo._FormatDefinition","mstrmojo.models.FormatModel");var C=mstrmojo.string,H=mstrmojo._FormatDefinition,V=mstrmojo.models.FormatModel,L=V.ENUM_PROPERTY_NAMES,K=1,G=2,P=4,F=8,J=16;var R;var M;var I={bold:L.FONT_WEIGHT,italic:L.FONT_STYLE,underline:L.UNDERLINE,strikeout:L.LINE_THROUGH};function D(W){return(W&J)>0;}function S(X){var b=L.FONT_FAMILY,W=X&&(X[b]||V.getFormatBlockValue(X,b)),Z=this.hcgControls.fontFamily,Y=this.getFontFamilyItems();if(W===-1){var a=Z&&Z.list;if(!a){return ;}a.clearSelect();delete Z.selectedIndex;if(Z.hasRendered){Z.refresh();}}else{if(Y){Z.set("selectedIndex",Math.max(Y.map(function(c){return c.n;}).indexOf(W)));}}}function Q(W){var X=[],Y=function(b,c,Z){var a=W[b];if(a===undefined){a=V.getFormatBlockValue(W,b);}if(a){X.push(Z);}};Y(L.FONT_WEIGHT,"bold",0);Y(L.FONT_STYLE,"italic",1);Y(L.UNDERLINE,"underline",2);Y(L.LINE_THROUGH,"line-through",3);this.hcgControls.fontStyle.select(X);}function N(W){var c=this.hcgControls,Z=L.FONT_SIZE,X=L.COLOR,b=W[Z]||V.getFormatBlockValue(W,Z),Y=c.fontSize;var a=W[X];if(typeof a==="undefined"||a===null){a=V.getFormatBlockValue(W,X);}if(typeof a==="undefined"||a===null){a="";}if(D(this.visibleControls)){if(b.length){Y.provider.set("curValGroup",b);}}else{if(b===-1){Y.list.clearSelect();Y.selectedValue="";Y.updatePreview();}else{Y.set("selectedValue",b?(parseInt(b,10)).toString():Y.items[0].n);}}c.fontColor.set("selectedValue",a===""?"conflict":V.decodeValue(L.COLOR,a));}function O(){if(R&&M){return ;}R=H.SizesInVI.map(function(W){return{idx:parseInt(W.n,10),n:W.n};});M=mstrmojo._FormatDefinition.Families.slice(1).map(function(W){return{n:W.n,id:W.n,preview:!W.symbolic};});}mstrmojo.ui.editors.controls._HasCharacterGroup=mstrmojo.provide("mstrmojo.ui.editors.controls._HasCharacterGroup",{_mixinName:"mstrmojo.ui.editors.controls._HasCharacterGroup",visibleControls:K+G+P,showNoFillInColor:true,hcgControls:null,getFontFamilyItems:function A(){return M;},getFontStyleItems:function U(){return[{n:mstrmojo.desc(2718,"Bold"),id:"b",css:"bold"},{n:mstrmojo.desc(2719,"Italic"),id:"i",css:"italic"},{n:mstrmojo.desc(2720,"Underline"),id:"u",css:"underline"},{n:mstrmojo.desc(3062,"Strikeout"),id:"s",css:"strikeout"}];},getHCGControls:function E(Z){O();var X=this.hcgControls={},W=this.visibleControls;if((W&K)>0){X.fontFamily=mstrmojo.ui.Pulldown.newPulldown(this.getFontFamilyItems(),function(b,c){Z(L.FONT_FAMILY,b.id,c&&c.id);},0,{isHostedWithin:false,scrollNodeMaxHeight:350,getPopupListConfig:function Y(){var b=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);b.getItemProps=function c(f,d){var e=mstrmojo._IsList.getItemProps.call(this,f,d);e.style=f.preview?"font-family:'"+C.encodeHtmlString(f.n,true)+"';":"";return e;};return b;}});}if((W&G)>0||(W&F)>0){var a=X.fontStyle=new mstrmojo.ui.ButtonBar({hasSpacing:true,multiSelect:true,items:this.getFontStyleItems(),postselectionChange:function(b){var d=b.added,e=this.items[d?d[0]:b.removed[0]],c=!!d;if(e){Z(I[e.css],c,!c);}}});if((W&F)>0){a.items.pop();}}if((W&P)>0){X.fontSize=D(W)?new mstrmojo.ui.editors.controls.Stepper({provider:new mstrmojo.NumGroupStepperContentProvider({item:{interval:1},curValGroup:[],min:Math.min.apply(Math,R.map(function(b){return b.idx;})),max:Math.max.apply(Math,R.map(function(b){return b.idx;})),container:this,onTraverse:function(){var b=this.container.fontSize;if(b._sync){return ;}this.container.raiseFormatValueChange(L.FONT_SIZE,b.provider.getValGroup());},oncurValGroupChange:function(){var b=this.container.fontSize;if(b.textNode){b.updateDisplayText();}}})}):new mstrmojo.ui.editors.controls.ComboBox({selectedValue:"10",items:R,isHostedWithin:false,validateTextInput:function(b){return(/^[0-9]+(pt)?$/.test(b));},updateSelection:function(){this.set("selectedValue",parseInt(this.txtLabel.value,10).toString());},postselectedValueChange:function(b){Z(L.FONT_SIZE,parseInt(b.value,10)+"pt",parseInt(b.valueWas,10)+"pt");}});X.fontColor=new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:this.showNoFillInColor,selectedValue:"#000000",postselectedValueChange:function(b){Z(L.COLOR,b.value,b.valueWas);}});}return X;},setFormatSource:function B(W){var X=this;this.syncControls(function(){var Y=this.visibleControls;if((Y&K)>0){S.call(X,W);}if((Y&G)>0||(Y&F)>0){Q.call(X,W);}if((Y&P)>0){N.call(X,W);}});}});mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS={FONT_FAMILY:K,FONT_STYLE:G,FONT_SIZE_AND_COLOR:P,FONT_STYLE_NO_STRIKEOUT:F,FONT_SIZE_USE_STEPPER:J};mstrmojo.ui.editors.controls._HasCharacterGroup.ControlsType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasMarkup","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.dom","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.css");var E=mstrmojo.css,F=mstrmojo.dom;mstrmojo.threshold.ColorBand=mstrmojo.declare(mstrmojo.ui.editors.controls.ColorPickerButton,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ColorBand",hovered:false,selected:false,index:undefined,showGradient:false,showNoFill:false,markupString:'<div class = "color-band mstrmojo-ui-PreviewButton {@cssClass}" id="{@id}" style="{@cssText}" mstrAttach:click,keyup,contextmenu,mouseover,mouseout><div class="host mstrmojo-ui-PreviewButton"></div></div>',markupSlots:{previewNode:function(){return this.domNode;},btnNode:function(){return this.domNode;},clickableNode:function(){return this.domNode;},widgetHostNode:function(){return this.domNode.lastChild;}},select:function(){this.set("selected",true);},unselect:function(){this.set("selected",false);},onhoveredChange:function C(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onBandHovered(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onBandUnhovered(this.index);}},onselectedChange:function B(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onBandSelected(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onBandUnselected(this.index);}this.parent.onBandUnhovered(this.index);},onmouseover:function H(){this.set("hovered",true);},onmouseout:function D(){this.set("hovered",false);},oncontextmenu:function G(I){F.preventDefault(window,I.e);var K=this,J=K.parent.parent;var L=new mstrmojo.ui.menus.MenuConfig({position:F.getMousePosition(I.e,I.hWin),isHostedWithin:false});L.addMenuItem(mstrmojo.desc(7604,"Change Color"),"",function(){K.onclick(I);});L.addMenuItem(mstrmojo.desc(13386,"Add Color Band"),"",function(){var N=J.markers;var O=F.position(N.containerNode),M=I.e.clientX-O.x;N.addMarker(M);});L.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){K.unselect();J.bands.remove(K.index);J.update();});this.openPopup(L.newInstance());},postselectedValueChange:function(J){var K=this.parent.parent,I=K.parent,M=K.getPalette().concat();if(J){var L=J.value;if(K.getReversedValue()){M.reverse();}this.backgroundColor=M[this.index]=L;I.switchToCustomScheme(undefined,M);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.threshold.ColorBand,{onwidthChange:mstrmojo.Widget.widthMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onbackgroundColorChange:function A(){this.selectedValue=this.backgroundColor;this.updatePreview();this.colorPicker.set("color",this.selectedValue);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.array","mstrmojo.hash","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton");var L=mstrmojo.emptyFn,I=mstrmojo.array,C=mstrmojo.hash,E=mstrmojo.gm.EnumCombinedLineStyle;var J={LINE_COLOR:"Clr",LINE_STYLE:"Style"},A={"1pt solid":E.THIN,"2pt solid":E.THICK,"1pt dashed":E.DASHED,"1pt dotted":E.DOTTED,none:E.NONE};function D(P,O){return C.copy(O,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"lineColor",slot:P,selectedValue:"#000000",postselectedValueChange:function(Q){if(this.propName){this.parent.parent.raiseFormatValueChange(this.propName,Q.value,Q.valueWas);}},postclick:function(Q){this.parent.parent.postclick(Q);}});}function K(P){return{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:true,showNoneOption:true,hideDashOptions:false,defaultSelectedIndex:3,propName:undefined,alias:"lineStyle",slot:P,postInit:function O(){var Q=["mstrmojo-ui-LineStyle"];if(!this.showNoneOption){Q.push("no-none");}if(this.hideDashOptions){Q.push("no-dash");}mstrmojo.css.addWidgetCssClass(this,Q);(this.list.items||[]).forEach(function(R){R.v=(A[R.id]!==undefined?A[R.id]:A["not defined"]);});},onshowNoneOptionChange:function(Q){var R=["no-none"];if(!Q.value){mstrmojo.css.addWidgetCssClass(this,R);}else{mstrmojo.css.removeWidgetCssClass(this,R);}var S=this.hasRendered;if(S){this.refresh();}},postselectedValueChange:function(R){this._super();var Q=I.find(this.list.items,"id",R.value);if(Q===-1){Q=this.defaultSelectedIndex;}var S=this.list.items[Q].v;if(this.propName){this.parent.parent.setChildEnable(J.LINE_COLOR,S!==A.none);this.parent.parent.raiseFormatValueChange(this.propName,S,A[R.valueWas]);}},postclick:function(Q){this.parent.parent.postclick(Q);}};}mstrmojo.ui.editors.controls.LineConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.LineConfigGroup",propNames:undefined,postclick:L,hideColorControl:false,showGradient:false,showNoFillInColor:true,showAutomaticInColor:false,showNoneOption:true,lineColorAndStyle:undefined,lineTitle:undefined,init:function N(Q){this._super(Q);var O=[],R;O.push(K("col1Node"));if(!this.hideColorControl){O.push(D("col2Node",{showGradient:this.showGradient,showNoFill:this.showNoFillInColor,showAutomatic:this.showAutomaticInColor}));}else{R={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}var P=[];if(this.lineTitle&&this.lineTitle!==""){P.push(new mstrmojo.Label({text:this.lineTitle}));}P.push(C.copy(R,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"lineColorAndStyle",children:O}));this.addChildren(P);},getChildComp:function M(O){if(O.indexOf(J.LINE_COLOR)!==-1){return this.lineColorAndStyle.lineColor;}if(O.indexOf(J.LINE_STYLE)!==-1){return this.lineColorAndStyle.lineStyle;}return null;},iniChildrenComp:function G(P){I.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);var O=this.lineColorAndStyle.lineStyle;O.showNoneOption=this.showNoneOption;O.hideDashOptions=this.hideDashOptions;O.postInit();},onshowNoneOptionChange:function(O){this.lineColorAndStyle.lineStyle.set("showNoneOption",O.value);},setChildValue:function F(Q,R){var O=this.getChildComp(Q);if(O===undefined){return false;}var P;switch(O.alias){case"lineColor":if(R!==O.selectedValue){O.set("selectedValue",typeof R==="undefined"?"conflict":R);}break;case"lineStyle":if(typeof R==="undefined"){O.list.clearSelect();this.syncControls(function(){O.set("selectedValue","conflict");});}else{P=I.find(O.list.items,"v",R);if(P===-1){P=O.defaultSelectedIndex;}var S=O.list.items[P].id;if(S!==O.selectedValue){O.set("selectedValue",S);}}break;}},setChildEnable:function H(Q,P){var O=this.getChildComp(Q);if(O!==undefined){O.set("enabled",P);}},setChildrenValue:function B(O){O.forEach(function(P){this.setChildValue(P[0],P[1]);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.fe.RelationNode","mstrmojo.fe.RelationFilterExprTree","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumNodeDimty","mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.Label","mstrmojo.vi.ui.toolbars.TitleToolbar","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo._HasItemAliases");mstrmojo.requiresDescs(2790,5895,5896,7931,12036,12037,15121,15122);var F=mstrmojo.hash,A=mstrmojo.array,G=mstrmojo.mstr.EnumDSSXMLObjectTypes,H=mstrmojo.mstr.EnumNodeDimty,C=mstrmojo.css,E=mstrmojo.string,D=function(R){var Q=R.data,O=Q.dmy&&Q.dmy.uts||[],P=O.length,U=F.walk("tree.editor.xtab",R),S=U&&U.gridInfo,V=F.walk("tree.editor.docModel",R),N=[],M,K,L;for(M=0;M<P;M++){K=O[M].utgt;R.adjustItemName(K,V,S);N.push(E.encodeHtmlString(K.n));}L=N.join(", ");return'<span class="mstrmojo-text" title="'+L+'">'+L+"</span>";};var I=function(){var M=mstrmojo.desc(2790,"Set of ##"),L=M.split("##")[0];var K=L.length;if(K>0&&L[K-1]===" "){L+="&nbsp;";}return L;};mstrmojo.vi.ui.editors.fe.RelationNode=mstrmojo.declare(mstrmojo.fe.RelationNode,[mstrmojo.vi.ui.toolbars._HasToolbar,mstrmojo._HasItemAliases],{scriptClass:"mstrmojo.vi.ui.editors.fe.RelationNode",markupString:'<div id="{@id}" class="mstrmojo-relation {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-relation-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-relation-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-relationNode"><div class="mstrmojo-relationNode-inf"><div class="mstrmojo-relation-prefix-text">'+I()+'</div><div class="mstrmojo-textset"  mstrAttach:click></div><div class="mstrmojo-relation-prefix-text">'+(mstrmojo.desc(2790,"Set of ##").split("##")[1]||"")+'</div><div class="mstrmojo-relation-postfix-text">'+mstrmojo.desc(15121,"filtered by")+'</div><div class="mstrmojo-relation-related-by-box"></div><div class="mstrmojo-relation-toolbar"></div><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></div><div class="mstrmojo-relation-childTreeNode" style="position:relative;"></div></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},relationNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1];},relatedByBoxNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[4];},toolbarNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[5];},containerNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{onprefixedAndOrEditableChange:function(){C.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){C.toggleClass(this.relationNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=D(this);}},children:[{scriptClass:"mstrmojo.fe.RelationFilterExprTree",alias:"childTree",ignoreLayout:true,dropZone:false,draggable:false,nodeClassMap:{14:mstrmojo.fe.AndOrNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},onNew:function(K){this.parent.tree.onNew(K);},getItemConfig:function(R,O,L){var K=mstrmojo.fe.RelationFilterExprTree.prototype.getItemConfig.call(this,R,O,L),S=L.tree||L,M=F.walk("tree.parent.tree.editor",L),Q=M&&M.docModel,P=M&&M.xtab,N=P&&P.gridInfo;this.adjustItemName(R,Q,N);return F.copy({tree:S,rootTree:this.parent.tree,noRelation:true,inRelation:true,onremove:function(){if(this.rootTree&&this.rootTree.onremove){this.rootTree.onremove();}},onadd:function(){if(this.rootTree&&this.rootTree.onadd){this.rootTree.onadd();}}},K);},prenodeclick:function(K){if(!K||!K.part){return ;}var L=this.rootTree;if(L&&L.onnodeclick&&this.editable){K.editor=L.editor;L.onnodeclick.call(this,K);}}},{scriptClass:"mstrmojo.Box",alias:"relBox",slot:"relatedByBoxNode",cssClass:"RelatedBy-Box",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12036,"Related by"),cssClass:"Label",cssDisplay:"inline-block"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"relPd",cssClass:"Pulldown",cssDisplay:"inline-block",isHostedWithin:false,allowHTML:false,onitemSelected:function B(O){var N=this.parent.parent,L=N.data,K=null;if(this.selectedIndex>0){K={n:O.n,did:O.did,t:O.t||G.Metric,st:O.st||1024};}L.dmt=H.NodeDimtyOutputLevel;L.dmy=L.dmy||{};var M=L.relation=L.relation||{};if(K){M.guide=K;L.useSchema=false;}else{delete M.guide;delete M.rsTp;delete M.joTp;delete M.paTp;delete M.erTp;L.useSchema=true;}N.set("data",L);}}]},{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:"toolbarNode",alias:"toolbar",visible:true,hasContextMenuButton:true,cssClass:"relation-toolbar",cssDisplay:"inline-block"}],_set_data:function(N,V){var O=this._super(N,V),Q=this,L=this.data,P=!L.m,K=this.relBox.relPd,R=A.filter(this.tree.editor.targetMetrics,function(Y){return !Y.um;}),X=[{n:mstrmojo.desc(12037,"System Default"),t:-1,did:"default"}].concat(R);this.relBox.set("visible",P);if(P){var U=0;if(L.relation&&L.relation.guide){var M=L.relation.guide;U=A.find(X,"did",M.did);}if(U!==K.selectedIndex){var W=F.walk("tree.editor.docModel",Q),S=F.walk("tree.editor.xtab.gridInfo",Q);A.forEach(X,function(Y){Q.adjustItemName(Y,W,S);});K.set("items",X);K.set("selectedIndex",U>=0?U:0);}}return O;},updateToolbar:function J(K){var L=this;if(this._super){K=this._super(K);}K.addMenuItem(mstrmojo.desc(15122,"Convert to Condition"),"convert",function(){L.parent.removeSet(L);});K.isHostedWithin=false;return K;}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Widget","num","css","Container","Box","Label","EditableLabel","Image");mstrmojo.requiresClsP("mstrmojo.threshold","ColorBand","ImageBand","MarkersNode","ColorMarker","ThresholdModel");var L=mstrmojo.dom,H=mstrmojo.num,B=mstrmojo.css,c=mstrmojo.array,N=mstrmojo.hash,s=["bands","markers"];var A=0,u=1;var a=mstrmojo.threshold.ThresholdModel,W=a.SLIDER_MODE,V=a.BASED_ON_TYPES,C=function(y,x){return y-x;},f=function(y,x){return x-y;},F=5;function P(x){var y;if(x===s[A]){y=this.sliderMode===W.IMAGE_BASED?new mstrmojo.threshold.ImageBand():new mstrmojo.threshold.ColorBand();}else{y=new mstrmojo.threshold.ColorMarker();}this[x].addChildren([y]);}function g(AC,AE,AF,AA){var y=AC.length-1,AD=AA?0:1,z=AA?y-1:y-2;for(var AB=AD;AB<=z;AB++){if(AB===AD&&AC[AB]<=0){AC[AB]=AE;}else{var x=AC[AB]-AC[AB-1];AC[AB]+=(x<AE)?(AE-x):0;AC[AB]=AC[AB]>=AF?(AF-AE):AC[AB];}}for(var AB=z;AB>AD;AB--){if(AB===z&&AC[z]>=AF){AC[AB]=AF-AE;}else{var x=Math.abs(AC[AB+1]-AC[AB]);AC[AB]-=(x<AE)?(AE-x):0;}}AC.sort(C);}function S(AA){var AB=this[s[AA]],AC=AB.children,y=AC?AC.length:0,AL=this.getComp().sort(C),AK=this.getPalette(),z=this.width,AN=AA?AL.length-1:AL.length,x=this.sliderMode===W.IMAGE_BASED,AO=this.parent.model.globalMinMax(this.minValue(),this.maxValue()),AJ,AD,AG;var AI=c.map(AL,function(AP){return parseInt(z*AP,10);});g(AI,F,z,this.selectedOption===V.VALUE);if(y>AN){for(AJ=y-AN-1;AJ>=0;AJ--){AB.removeChildren(AC[AJ]);}}else{if(AN>y){for(AJ=0;AJ<AN-y;AJ++){P.call(this,s[AA]);}}}if(AA===0&&this.getReversedValue()){AK=AK.concat().reverse();}AC=AB.children;var AF,AE;for(AJ=0;AJ<AN;AJ++){AD=AC[AJ];AF=(AJ===0)?0:AI[AJ-1];AE=AI[AJ];if(AA===0){AD.set("left",(this.containerNode.offsetLeft+AF+1)+"px");AG=AE-AF;B.toggleClass(AD.domNode,"no-border",!AG);AD.set("width",AG+"px");if(x){AD.set("src",AK[AJ]);AD.domNode.firstChild.style.left=AD.domNode.clientWidth/2-12+"px";}else{AD.set("backgroundColor",AK[AJ]);}}else{AD.set("left",AE-(x?0:1)+"px");AD.updateCompValue(AL[AJ]);var AM=this.parent.model,AH=AM.getRealValue(AL[AJ],this.selectedOption,this.minValue(),this.maxValue());AD.updateRealValue(AH);AD.updatePosition(AI[AJ]);}AD.set("index",AJ);}}function o(y,x,z){x.forEach(function(AB){var AA=y[AB.id]={palette:[],comp:[],reversed:false};AB.bands.forEach(function(AC){AA.palette.push(AC[z?"url":"bc"]);AA.comp.push(AC.end/100);});});}function D(){var x=this.parent.model,y={};o(y,x.getDefaultColors(),false);o(y,x.getDefaultImages(),true);return y;}function w(z){var x=H.parseNumeric(z);if(isNaN(x)&&window.numeral){var y=window.numeral(z.toLowerCase()).value();x=typeof y==="number"?y:x;}return x;}mstrmojo.threshold.TextBubble=mstrmojo.declare(mstrmojo.EditableLabel,null,{scriptClass:"mstrmojo.EditableLabel",visible:false,cssClass:"editable-bubble",text:"",isPercentage:true,maxValue:1,showBubble:function(x,z,y){this.updatePosition(x,y);this.updateText(z);this.set("visible",true);},hideBubble:function(){this.set("visible",false);},updatePosition:function U(y,x){var z=(x!==undefined)?x:this.parent.width*y;this.domNode.style.left=z+"px";},updateText:function(AA){var z=this.parent,x=z.parent.model,y=AA;if(z.selectedOption===V.VALUE){this.realValue=y;y=H.formatByMask(x.getFormatString(),y);}if(this.isPercentage){y+="%";}this.set("text",String(y));}});mstrmojo.threshold.ColorSlider=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.threshold.ColorSlider",markupString:'<div class = "mstrmojo-color-slider {@cssClass}"  style="{@cssText}" mstrAttach:click,keyup><div class="labels"></div><input type="text" class="hidden-field"></div>',markupSlots:{containerNode:function X(){return this.domNode;},labelsNode:function Q(){return this.domNode.firstChild;},hiddenField:function e(){return this.domNode.lastChild;}},sliderMode:W.COLOR_BASED,baseColor:undefined,editableBubble:undefined,hoverBubble:undefined,bands:undefined,markers:undefined,colorMap:undefined,selectedOption:undefined,userComp:[],getComp:function Y(){return this.userComp;},getPalette:function M(){return this.colorMap[this.baseColor].palette;},getReversedValue:function m(){var x=this.colorMap;return x&&x[this.baseColor].reversed||false;},postBuildRendering:function R(){this.width=L.position(this.containerNode).w;this.resetColorMap();if(this._super){this._super();}this.update();},resetColorMap:function t(){var x=undefined;if(this.colorMap){x=this.colorMap.custom;}this.colorMap=D.call(this);if(x){this.colorMap.custom=x;}if(this.baseColor in this.colorMap){this.userComp=N.clone(this.colorMap[this.baseColor].comp);}},onkeyup:function(AA){var y=window.event||AA.e,AB=y.keyCode;if(this.sliderMode===W.COLOR_BASED&&(AB===mstrmojo.Enum_Keys.DELETE||AB===mstrmojo.Enum_Keys.BACKSPACE)){if(this.editableBubble.isEditing){return ;}var z,x;if(this.bands.isSelected){z=this.bands;}else{if(this.markers.isSelected){z=this.markers;}else{return ;}}x=z.selectedIndex;z.children[x].unselect();z.remove(x);this.update();}},update:function d(){if(this.baseColor){S.call(this,A);S.call(this,u);}this.updateMinMax();},onsliderModeChange:function h(){B.toggleClass(this.domNode,"image-mode",this.sliderMode===W.IMAGE_BASED);this.resetMinMax();this.unselectAll();this.bands.removeChildren();},onbaseColorChange:function n(x){if(x.value&&x.value in this.colorMap){this.userComp=N.clone(this.colorMap[x.value].comp);}this.resetMinMax();this.unselectAll();this.update();},onselectedOptionChange:function K(y){var z=this.parent.model,AA=this.editableBubble,AB=y.valueWas===V.VALUE?AA.realValue:AA.text;if(y.valueWas!==undefined){this.resetMinMax();this.markers.setMarkerRealValues(z.getRealValue.bind(z),y.value,this.minValue(),this.maxValue());this.update();}if(AA.visible){if(y.valueWas===V.LOWEST_PERCENT||y.valueWas===V.HIGHEST_PERCENT){AB=AB.slice(0,AB.length-1);}var x=this.markers.selectedIndex;AA.updateText(this.markers.children[x].realValue);}},updateLabels:function G(y){var AB=this.parent.model,AC=this.editableBubble,AA=this.hoverBubble,AD=this.markers.selectedIndex,AE,z;y=y||this.selectedOption;if(y===V.LOWEST_PERCENT||y===V.HIGHEST_PERCENT){AE="0%";z="100%";AC.set("isPercentage",true);AA.set("isPercentage",true);}else{if(y===V.LOWEST||y===V.HIGHEST){AE="0";z=AB.getMetricsCount();AC.set("isPercentage",false);AA.set("isPercentage",false);}else{var x=AB.getFormatString();AE=(this.minValue()<AB.getMetricsMinValue())?"-&#8734":H.formatByMask(x,AB.getMetricsMinValue());z=(this.maxValue()>AB.getMetricsMaxValue())?"&#8734":H.formatByMask(x,AB.getMetricsMaxValue());AC.set("isPercentage",false);AA.set("isPercentage",false);}}this.startLabel.set("text",AE);this.endLabel.set("text",z);if(!!this.markers.children&&AD>-1&&AD<this.markers.children.length){AC.updateText(this.markers.children[AD].realValue);}},setColorComp:function i(y,x){this.userComp=N.clone(x);var z=this.colorMap;if(z){z[y].comp=x;this.unselectAll();this.update();}},addCustomScheme:function(y,x){this.colorMap.custom={comp:y,palette:x,reversed:false};this.set("baseColor","custom");},addMarkerToMap:function O(z){var AA=this.getComp(),y=AA.length,AB;if(AA[0]>z){AB=0;}else{for(AB=1;AB<y;AB++){if(AA[AB-1]<=z&&AA[AB]>=z){break;}}}AA.splice(AB,0,z);this.unselectAll();this.resetMinMax();return AB;},unselectAll:function q(){var y=this.bands,z=y.children&&y.selectedIndex>-1&&y.children[y.selectedIndex];if(y.isSelected&&z&&typeof (z.unselect)==="function"){z.unselect();}var AA=this.markers,x=AA.children&&AA.selectedIndex>-1&&AA.children[AA.selectedIndex];if(AA.isSelected&&x&&typeof (x.unselect)==="function"){x.unselect();}},reverseMapColor:function Z(){if(this.colorMap&&this.baseColor){var x=this.colorMap[this.baseColor];x.reversed=!x.reversed;this.unselectAll();this.update();}},_minRealValue:undefined,_maxRealValue:undefined,resetMinMax:function J(){this.set("_minRealValue",undefined);this.set("_maxRealValue",undefined);},updateMinMax:function j(){var AB=this.markers.getMarkerRealValues(C),AA=this.parent.model.globalMinMax(),z=AA.min,x=AA.max,y=-1;if(c.isArray(AB)){while(++y<AB.length){if(AB[y]!==undefined){z=AB[y];break;}}y=AB.length;while(--y>=0){if(AB[y]!==undefined){x=AB[y];break;}}}this.set("_minRealValue",z);this.set("_maxRealValue",x);this.updateLabels(this.selectedOption);},minValue:function E(){return this._minRealValue;},maxValue:function I(){return this._maxRealValue;},children:[{scriptClass:"mstrmojo.Label",cssClass:"start-label",alias:"startLabel",slot:"labelsNode",text:"0%",allowHTML:true},{scriptClass:"mstrmojo.Label",cssClass:"end-label",alias:"endLabel",slot:"labelsNode",text:"100%",allowHTML:true},{scriptClass:"mstrmojo.threshold.TextBubble",alias:"editableBubble",slot:"labelsNode",allowEmptyText:true,onTextEditComplete:function(AE,AF){if(AE){var AJ=this.parent,AC=AJ.parent.model,AB=AJ.markers.selectedIndex,AP=AJ.markers.children[AB];var AG=this.text;if(this.isPercentage){AG=AG.replace(/%$/,"");}var AL=AG.charAt(0),AQ=1;if(AL==="-"||AL==="+"){AG=AG.substring(1);AQ=(AL==="-")?-1:1;AL=AG.charAt(0);}if(AL.match(/\W/)!==null){AG=AG.replace(new RegExp("^\\"+AL),"");}var AH=AC.getFormatString(),AM=(AH||"").indexOf("%")>-1,AA=1,AD=AJ.selectedOption===V.VALUE;if(AD&&AM&&AG.indexOf("%")===-1){AA=0.01;}AG=w(AG)*AA;if(isNaN(AG)){this.set("text",AF);return ;}AG=AG*AQ;if(AG<0&&!AD){AG=0;}AP.updateRealValue(AG);AJ.updateMinMax();var AK=AJ.markers.getMarkerRealValues(C);AB=AK.indexOf(AG);var AN=AK.map(function(AR){return AC.getNormalizedValue(AR,AJ.selectedOption,AJ.minValue(),AJ.maxValue());}),AO=AJ.getComp(),z=AN[AB],y=AJ.width,x=(AJ.sliderMode===W.IMAGE_BASED),AI=parseInt(y*z,10);AN.forEach(function(AS,AR){AO[AR]=AS;AJ.markers.children[AR].updateCompValue(AS);});this.updatePosition(z);AP.updateCompValue(z);AP.set("left",AI-(x?0:1)+"px");AP.unselect();AJ.update();AJ.markers.children[AB].select();}}},{scriptClass:"mstrmojo.threshold.TextBubble",alias:"hoverBubble",slot:"labelsNode",allowEmptyText:false},{scriptClass:"mstrmojo.Box",cssClass:"color-bands",alias:"bands",isSelected:false,selectedIndex:0,remove:function b(z){if(this.children.length===1){return ;}var AA=this.parent;var y=AA.getComp(),x=AA.getPalette();if(z===this.children.length-1){y.splice(z-1,1);}else{y.splice(z,1);}x.splice(z,1);},onBandHovered:function(){this.isSelected=true;},onBandUnhovered:function(){this.isSelected=false;},onBandSelected:function(x){var y,AA=this.children,z=this.parent,AB=z.markers;for(y=0;y<AA.length;y++){if(y!==x&&AA[y].selected){AA[y].unselect();}}if(AB.isSelected===true){AB.children[AB.selectedIndex].unselect();}z.hiddenField.focus();this.isSelected=true;this.selectedIndex=x;},onBandUnselected:function(x){var y,z=this.children;for(y=0;y<z.length;y++){if(y!==x&&z[y].selected){return ;}}this.isSelected=false;this.selectedIndex=-1;}},{scriptClass:"mstrmojo.threshold.MarkersNode",alias:"markers",isSelected:false,selectedIndex:-1,isHovered:false,hoveredIndex:-1,onMarkerSelected:function p(y){var x=this.parent,AC=this.children[y];x.editableBubble.showBubble(AC.compValue,AC.realValue,AC.position);var z,AB=this.children;for(z=0;z<AB.length;z++){if(z!==y&&AB[z].selected){AB[z].unselect();}}var AA=x.bands;if(AA.isSelected===true){AA.children[AA.selectedIndex].unselect();}this.parent.hiddenField.focus();this.isSelected=true;this.selectedIndex=y;},onMarkerUnselected:function(x){var y,z=this.children;for(y=0;y<z.length;y++){if(y!==x&&z[y].selected){return ;}}this.parent.editableBubble.hideBubble();this.isSelected=false;this.selectedIndex=-1;},onMarkerHovered:function l(y){var x=this.parent,z=this.children[y];x.hoverBubble.showBubble(z.compValue,z.realValue,z.position);this.isHovered=true;this.hoveredIndex=y;},onMarkerUnhovered:function k(x){var y,z=this.children;for(y=0;y<z.length;y++){if(y!==x&&z[y].hovered){return ;}}this.parent.hoverBubble.hideBubble();this.isHovered=false;this.hoveredIndex=-1;}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.ToolbarPopup","mstrmojo.ui.editors._HostsControls","mstrmojo.ui.editors.controls._HasCharacterGroup","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.models.FormatModel","mstrmojo.css");var B=mstrmojo.models.FormatModel;mstrmojo.ui.editors.CharacterToolbarPopup=mstrmojo.declare(mstrmojo.ui.editors.ToolbarPopup,[mstrmojo.ui.editors._HostsControls,mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ui.editors.CharacterToolbarPopup",textAlignJustify:true,textAlignValueMap:null,textAlignFmtName:mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES.TEXT_ALIGN,btnTextAlign:null,init:function D(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var K=this.textAlignJustify,H=this,F=function(P,Q,O){H.raiseFormatValueChange(P,Q,O);},L=this.getHCGControls(F),J=L.fontFamily,N=L.fontSize,G=L.fontColor,M={alias:"btnTextAlign",includeJustify:K,onValueChange:function(P,O){F(H.textAlignFmtName,P,O);}};J.width="125px";N.width="50px";G.width="50px";this.width=K?"505px":"476px";var E=this.textAlignValueMap;if(E){M.itemsValueMap=E;}this.addChildren([J,L.fontStyle,N,G,new mstrmojo.vi.ui.TextAlignButtonBar(M)]);},shouldPropagateLockHover:function C(){return false;},setFormatSource:function A(E){this._super(E);this.syncControls(function(){if(this.textAlignFmtName in E){this.btnTextAlign.singleSelectByField(E[this.textAlignFmtName],"v");}else{this.btnTextAlign.singleSelectByField(B.getFormatBlockValue(E,B.ENUM_PROPERTY_NAMES.TEXT_ALIGN),"id");}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls._HasCharacterGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.css");mstrmojo.ui.editors.controls.CharacterGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,[mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",init:function A(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var H=this,C=this.getHCGControls(function(K,L,J){if(!H._sync){H.raiseFormatValueChange(K,L,J);}}),D=[];Object.keys(C).forEach(function(J){this[J]=C[J];}.bind(this));var B=this.fontFamily,I=this.fontStyle,G=this.fontSize,F=this.fontColor;if(B){D.push(B);}if(I){D.push(I);}if(G){G.slot="col1Node";F.slot="col2Node";D.push({scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",children:[G,F]});}if(D.length){this.addChildren(D);}}});mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS=mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS;}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.HBox","mstrmojo.ui.menus.EditorConfig","mstrmojo.mstr.EnumFunction","mstrmojo.DropDownList","mstrmojo.ui.Pulldown","mstrmojo.SearchablePulldown","mstrmojo.ButtonList","mstrmojo.Box","mstrmojo.Label","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.EditableLabel","mstrmojo.CheckBox","mstrmojo._FormatDefinition","mstrmojo.num","mstrmojo.locales","mstrmojo.vi.models.VIComponentMap","mstrmojo.func","mstrmojo.dom","mstrmojo.ME.AttributeEditBox","mstrmojo.ME.MetricToken","mstrmojo.string","mstrmojo.dom","mstrmojo.models.datasets.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.ui.editors.ObjectPicker","mstrmojo.vi.ui.editors.AttributeLinkEditor","mstrmojo.vi.ui.NumberFormatter","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType");mstrmojo.requiresDescs(1442,1885,1886,2022,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,3993,4564,11494,11495,11496,11497,14612);var q=mstrmojo.mstr.EnumFunction,a=mstrmojo.hash,w=mstrmojo.array,D=mstrmojo.css,Y=mstrmojo.dom,z=mstrmojo.Button.newWebButton,V=mstrmojo.ME.MetricToken.brackets,AF=mstrmojo.ME.MetricToken.argDelimiter,W=mstrmojo._FormatDefinition,t=mstrmojo.models.datasets.DataInterface,K=mstrmojo.vi.models.VIComponentMap.TYPES,X=mstrmojo.chart.model.enums.EnumDSSObjectType,s=mstrmojo.mstr.EnumDSSXMLBaseFormType,AT=mstrmojo.mstr.EnumDSSXMLObjectTypes,N=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,AD=mstrmojo.mstr.EnumDSSConsolidationType;var b={SUM:mstrmojo.desc(2131,"Sum"),ADD:mstrmojo.desc(6017,"Add"),AVG:mstrmojo.desc(2122,"Average"),MAX:mstrmojo.desc(2125,"Maximum"),GST:mstrmojo.desc(5869,"Greatest"),MIN:mstrmojo.desc(2127,"Minimum"),LST:mstrmojo.desc(5868,"Least"),CNT:mstrmojo.desc(2123,"Count"),MTP:mstrmojo.desc(5418,"Multiply"),STD:mstrmojo.desc(2130,"Standard Deviation"),PTD:mstrmojo.desc(11494,"Population Standard Deviation")},g={SUM:{n:b.SUM,t:q.FunctionSum},ADD:{n:b.ADD,t:q.FunctionPlus},AVG:{n:b.AVG,t:q.FunctionAvg},MAX:{n:b.MAX,t:q.FunctionMax},GST:{n:b.GST,t:q.FunctionGreatest},MIN:{n:b.MIN,t:q.FunctionMin},LST:{n:b.LST,t:q.FunctionLeast},TMS:{n:b.MTP,t:q.FunctionTimes},CNT:{n:b.CNT,t:q.FunctionCount},GEM:{n:mstrmojo.desc(2124,"Geometric Mean"),t:q.FunctionGeomean},MED:{n:mstrmojo.desc(2126,"Median"),t:q.FunctionMedian},MOD:{n:mstrmojo.desc(2128,"Mode"),t:q.FunctionMode},PDT:{n:mstrmojo.desc(2129,"Product"),t:q.FunctionProduct},STD:{n:mstrmojo.desc(2130,"Standard Deviation"),t:q.FunctionStdev},VAR:{n:mstrmojo.desc(2132,"Variance"),t:q.FunctionVar}},c=[{n:b.SUM,t:q.FunctionOLAPSum},{n:b.AVG,t:q.FunctionOLAPAvg},{n:b.MIN,t:q.FunctionOLAPMin},{n:b.MAX,t:q.FunctionOLAPMax},{n:b.CNT,t:q.FunctionOLAPCount}],AR=[{n:b.SUM,t:q.FunctionOLAPSum},{n:b.AVG,t:q.FunctionOLAPAvg},{n:b.MIN,t:q.FunctionOLAPMin},{n:b.MAX,t:q.FunctionOLAPMax},{n:b.CNT,t:q.FunctionOLAPCount}],M=[{n:mstrmojo.desc(1058,"Previous"),t:q.FunctionLag},{n:mstrmojo.desc(1059,"Next"),t:q.FunctionLead},{n:mstrmojo.desc(4046,"First"),t:q.FunctionFirst},{n:mstrmojo.desc(4049,"Last"),t:q.FunctionLast}];var AA={YEAR:"Year",QUARTER:"Quarter",CONCAT:"Concat",QUARTERSTARTDATE:"QuarterStartDate",MONTH:"Month",TOSTRING:"ToString",MONTHSTARTDATE:"MonthStartDate",WEEK:"Week",WEEKSTARTDATE:"WeekStartDate",DAYOFMONTH:"DayOfMonth",DAYOFWEEK:"DayOfWeek",DAYOFYEAR:"DayOfYear"};var AJ={};AJ[AA.YEAR]="6F7DF5F8449111D5BEA300B0D01A55EF";AJ[AA.QUARTER]="6F7DF5F7449111D5BEA300B0D01A55EF";AJ[AA.CONCAT]="6F7DF5FF449111D5BEA300B0D01A55EF";AJ[AA.QUARTERSTARTDATE]="59E10CE2ADDD4A6DAC2416A72999A9ED";AJ[AA.MONTH]="6F7DF5F6449111D5BEA300B0D01A55EF";AJ[AA.TOSTRING]="D1ED29645DEC4DBF99E8E09ED939074B";AJ[AA.MONTHSTARTDATE]="7C63D4E70B2741C3A5B54A2EFD40961B";AJ[AA.WEEK]="6F7DF5F5449111D5BEA300B0D01A55EF";AJ[AA.WEEKSTARTDATE]="44681336D0DB4E43AC333FFB3CC4400D";AJ[AA.DAYOFMONTH]="6F7DF5F2449111D5BEA300B0D01A55EF";AJ[AA.DAYOFWEEK]="6F7DF5F3449111D5BEA300B0D01A55EF";AJ[AA.DAYOFYEAR]="6F7DF5F4449111D5BEA300B0D01A55EF";var Q="@form";function d(AV){var AX=8,AY=1,AU=w.find(AV.fs,"idf",true);if(AU===-1){return null;}var AW=AV.fs[AU];return((AV.da||AW.obf)&&(AW.bftp===AX||AW.bftp===AY))?AW:null;}var AQ={Year:{ID:[AA.YEAR,"(",Q,")"]},Quarter:{ID:[AA.YEAR,"(",Q,") * 10 + ",AA.QUARTER,"(",Q,")"],DESC:[AA.CONCAT,'("Q"',AF,AA.QUARTER,"(",Q,")",AF,' ", "',AF,AA.YEAR,"(",Q,"))"],DATE:[AA.QUARTERSTARTDATE,"(",Q,")"]},QuarterOfYear:{ID:[AA.QUARTER,"(",Q,")"],DESC:[AA.CONCAT,'("Q"',AF,"This@ID)"]},Month:{ID:[AA.YEAR,"(",Q,") * 100 + ",AA.MONTH,"(",Q,")"],DESC:[AA.TOSTRING,'<Pattern="mmm yyyy">(',Q,")"],DATE:[AA.MONTHSTARTDATE,"(",Q,")"]},MonthOfYear:{ID:[AA.MONTH,"(",Q,")"],DESC:[AA.TOSTRING,'<Pattern="mmmm">(',Q,")"]},Week:{ID:[AA.YEAR,"(",Q,") * 100 + ",AA.WEEK,"(",Q,")"],DESC:[AA.CONCAT,'("W"',AF,AA.WEEK,"(",Q,")",AF,' ", "',AF,AA.YEAR,"(",Q,"))"],DATE:[AA.WEEKSTARTDATE,"(",Q,")"]},WeekOfYear:{ID:[AA.WEEK,"(",Q,")"]},DayOfMonth:{ID:[AA.DAYOFMONTH,"(",Q,")"]},DayOfWeek:{ID:[AA.DAYOFWEEK,"(",Q,")"],DESC:[AA.TOSTRING,'<Pattern="ddd">(',Q,")"]},DayOfYear:{ID:[AA.DAYOFYEAR,"(",Q,")"]}};function j(AW,AY,AX,AU){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:AW,selectedIndex:AY,onitemSelected:function AV(AZ){var Aa=this.parent;while(!Aa.data||!Aa.data[AX]){Aa=Aa.parent;}Aa.data.set(AX,AU?AU(AZ):AZ.v);}};}function AB(AW,AV,AU){return{scriptClass:"mstrmojo.Box",cssClass:"breakByBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13903,"Break by:"),cssClass:"menu-info-text"},a.copy(AU,j(AW,AV,"breakBy",function(AX){return{id:AX.did,type:AX.t,dmy:AX.dmy};}))]};}function AO(AX){var AY=AX.metrics,AZ=AX.propName,AW=AX.optionValueField||"id",AU=w.find(AY,AW,AX.value),Aa=function Aa(Ac){var Ab=this.parent;while(!Ab.data||!Ab.data.hasOwnProperty(AZ)){Ab=Ab.parent;}Ab.data.set(AZ,Ac?{id:Ac[AW],type:4}:{cst:this.text});};return{scriptClass:"mstrmojo.ui.SearchablePulldown",isHostedWithin:false,cssClass:"Calculation-PullDown",items:AY,selectedIndex:AU,useRichTooltip:true,bindings:AX.bindings,valid:true,allowCustomText:true,allowEmptyText:true,allowHTML:false,onvalidChange:function AV(){mstrmojo.css.toggleClass(this.domNode,"invalid",!this.valid);if(this.hasRendered){this.hideTooltip();this.showTooltip();}},updateTooltipConfig:function(){if(this.valid){this.richTooltip=null;return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onitemSelected:Aa,onTextEditComplete:function(){Aa.call(this,this.items[this.selectedIndex]);},onPopupWidgetOpened:function(){this.set("valid",true);},postkeyup:AX.postkeyup};}function U(AX,AW,AV){if(AX&&AX.datap){var AU=w.filterOne(AX.datap,function(AZ){return AZ.tbid===AW;}),AY=AU&&AU.maps.amps;return w.filterOne(AY,function(AZ){return AV===AZ.aimp.atid;});}return null;}function m(AU,AY){var AW=w.filterOne(AU&&AU.afmps,function(AZ){return AZ.fmid===AY;}),AX=AW&&(AW.sqc?AW:AW.col.oi),AV;if(AX&&AX.sqc){AV={did:AX.sqc.id,n:mstrmojo.string.decodeHtmlString(AX.cln),coldtp:AX.sqc.dt.tp,georole:AX.geo,timerole:AX.tim,der:AX.sqc.der};}else{if(AX){AV={did:AX.did,n:mstrmojo.string.decodeHtmlString(AX.def.cln),coldtp:AX.def.dt.tp,georole:AW.geo,timerole:AX.def.dicl.time,der:AX.def.dicl.der};}}return AV;}function C(AW,AV,AY){var AX={success:function(AZ){if(AZ&&AZ.msgid){mstrApp.serverRequest({taskId:"qBuilder.GetReportXDADefinition",msgid:AZ.msgid,bindingflag:2,previewflag:261,browsetype:5},AY);}},failure:function(AZ){mstrApp.onerror(AZ);}};var AU=!!(mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause());mstrApp.serverRequest({taskId:"duplicateReportInstance",datasetID:AV,messageID:AW,skipRebuild:AU},AX);}function I(AZ,Aa,AX){var AV=AZ.srcTableId,Ac=AZ.tgtTableId,AU,AY,AW=function(Ag,Af){var Ai="<mpcs><mpc ",Ae,Ah;for(Ae in Af){Ah=Af[Ae];Ai+='$ACT="$VAL" '.replace("$ACT",Ae).replace("$VAL",Ah);}Ai+="/></mpcs>";return{act:"changeEMMAMapping",tbid:Ag,dsid:AZ.dsid,mapping:Ai};},Ab=function(){var Ae=[],Ah={},Af,Ag;if(!AU||!AY){return ;}Ah[AV]={};Ah[Ac]={};w.forEach(AU.afmps,function(Al){var Aj=w.find(AY.afmps,"fmid",Al.fmid),Am,Ak,Ai;if(Aj>=0){Af=m(AU,Al.fmid);Ag=m(AY,Al.fmid);if(Af.georole!==Ag.georole){Ai=(Af.georole===0)?AV:Ac;Am=(Af.georole===0)?Af.did:Ag.did;Ak=Af.georole||Ag.georole;Ah[Ai][Am]=a.copy({did:Am,georole:Ak},Ah[Ai][Am]);}if(Af.timerole!==Ag.timerole){Ai=(Af.timerole===0)?AV:Ac;Am=(Af.timerole===0)?Af.did:Ag.did;Ak=Af.timerole||Ag.timerole;Ah[Ai][Am]=a.copy({did:Am,timerole:Ak},Ah[Ai][Am]);}if(Af.der!==Ag.der){Ak=Af.der|Ag.der;Ah[AV][Af.did]=a.copy({did:Af.did,drvflg:Ak},Ah[AV][Af.did]);Ah[Ac][Ag.did]=a.copy({did:Ag.did,drvflg:Ak},Ah[Ac][Ag.did]);}}});a.forEach(Ah,function(Ai,Aj){a.forEach(Ai,function(Ak){Ae.push(AW(Aj,Ak));});});Af=m(AU,AU.afmps[0].fmid);Ae.push(AW(AV,{did:Af.did,oid:AY.aimp.atid}));if(AX){AX(Ae);}},Ad=function(Ag){var Ah={success:function(){Ab();}},Af,Ae;AU=U(Ag,AV,AZ.srcId);AY=U(Ag,Ac,AZ.tgtId);Af=m(AU,AU.afmps[0].fmid);Ae=[AW(AV,{did:Af.did,oid:AY.aimp.atid,fg:1})];Aa.getDataService().submitUpdates(Ae,Ah);};C(Aa.mid,AZ.dsid,{success:Ad});}function Z(AZ,AW,AV,Aa){var AU=0,AY=[],AX=function(Ab){var Ac=AV[AU-1];if(Ab&&Ab.tks&&Ac){AY.push({fid:Ac.fid,fnm:Ac.fnm,ftk:Ab.tks.items});}if(AU===AV.length){Aa(AY);return ;}Ac=AV[AU++];mstrmojo.ME.MetricDataService.validateMetric({metricId:AW,formID:Ac.fid,objectType:12,tokenStreamXML:"",metricXML:"",msgID:AZ},{success:AX});};AX();}function AG(AU,AV){return{v:V(AU.n)+"@"+V(AV.fnm),tp:275,lv:1,exv:AV.fid,extp:8,oi:{did:AU.did,t:AU.t,n:AU.n}};}function H(AV){var AX=(AV.t===AT.Filter||AV.t===AT.Consolidation),AW=(AV.t===AT.Attribute&&AV.de),AU=(AV.t===AT.Consolidation&&AV.st===N.ConsolidationManaged);return !!(AX&&!AU||AW);}mstrmojo.vi.ui.DatasetUnitMenuUtils=mstrmojo.provide("mstrmojo.vi.ui.DatasetUnitMenuUtils",{getAvailableShortcutMetricFunctionsGroup:function AN(AU){return{"12":[[g.AVG,g.CNT,g.MAX,g.MIN,g.STD,g.SUM,g.VAR]],"4":[[g.SUM,g.AVG,g.MIN,g.MAX,g.CNT],[g.GEM,g.MED,g.MOD,g.PDT,g.STD,g.VAR]]}[AU.t];},isAmongFunctions:function B(AV,AU){return AU.some(function(AW){return AW.some(function(AX){return AX.t===AV;});});},getMultiSelectionShortcutMetricFunctions:function J(AU){var AV=true;w.forEach(AU,function(AW){if(4!==AW.t){AV=false;return false;}return true;});return AV?[g.ADD,g.AVG,g.GST,g.LST,g.TMS]:[];},getRelativeReferenceMenu:function f(AY,AW,Ab,AU){var AX=0,AV=M[AX],Aa=0,AZ=Ab&&Ab[Aa];return new mstrmojo.ui.menus.EditorConfig({data:{item:AY,relativeRef:AV,breakBy:AZ},cssClass:"RelativeReference-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",cssClass:"funcBox",children:[{scriptClass:"mstrmojo.Label",visible:AW&&AW.length,text:AW,cssClass:"menu-info-text"},a.copy({cssClass:"RelativeReferencePullDown"},j(M,AX,"relativeRef",function(Ac){return Ac.t;}))]},AB(Ab,Aa,{cssClass:"RelativeReferencePullDown"})],fnOk:function(Ac){return AU(Ac.item,Ac.relativeRef,[Ac.breakBy]);}});},getMovingTotalMenu:function A(Ae,AY,Aa){var Af=1,AX=AR[Af].t,AZ=1,AV=mstrmojo.desc(13289,"Starting previous##rows").split("##"),Ad=0,AW=AY&&AY[Ad];return new mstrmojo.ui.menus.EditorConfig({cssClass:"MovingTotal-MenuEditor",data:{item:Ae,funcType:AX,windowSize:AZ,breakBy:AW},contents:[a.copy({cssClass:"MovingTotalPullDown"},j(AR,Af,"funcType",function(Ag){return Ag.t;})),{alias:"winSzBox",scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",cssClass:"WinSzPrefix menu-info-text",text:AV[0]},{alias:"winSz",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:mstrmojo.expr.DTP.INTEGER,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,min:1},postCreate:function Ac(){this.set("value",AZ);},_ontooltipover:function(){var Ag=mstrmojo.all[this.id];Ag._hovered=true;Ag.showTooltip();},_ontooltipout:function(){var Ag=mstrmojo.all[this.id];Ag._hovered=false;Ag.hideTooltip();},useRichTooltip:true,tooltipOpenDelay:0,onInvalid:function(){var Ag=this.validationStatus.msg,Ah=!(this.richTooltip&&Ag===this.richTooltip.content);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-V",top:-5,refNode:this.domNode,content:Ag};if(this._hovered&&Ah){this.hideTooltip();this.showTooltip();}},onValid:function(){this.richTooltip=null;this.hideTooltip();},postvalueChange:function Ab(){var Ag=this.isValid();this.parent.parent.popupConfig.data.set("windowSize",Ag?parseInt(this.value,10):0);}},{scriptClass:"mstrmojo.Label",cssClass:"WinSzSuffix menu-info-text",text:AV[1]}]},AB(AY,Ad,{cssClass:"MovingTotalPullDown BreakByBox"})],bindings:{okEnabled:function(){return !!this.data.windowSize;}},fnOk:function AU(Ag){if(Aa){Aa(Ae,Ag.funcType,Ag.windowSize,[Ag.breakBy]);}}});},getRunningTotalMenu:function AM(AX,Aa,AV){var AW=0,AU=c[AW].t,AZ=0,AY=Aa&&Aa[AZ];return new mstrmojo.ui.menus.EditorConfig({data:{item:AX,func:AU,breakBy:AY},cssClass:"RunningTotal-MenuEditor",contents:[a.copy({cssClass:"RunningTotalPullDown"},j(c,AW,"func",function(Ab){return Ab.t;})),AB(Aa,AZ,{cssClass:"RunningTotalPullDown BreakByBox"})],fnOk:function(Ab){return AV(Ab.item,Ab.func,[Ab.breakBy]);}});},getRankMetricEditor:function AC(AY,Ab,AW){var AU=[{n:mstrmojo.desc(1886,"Descending"),v:"0"},{n:mstrmojo.desc(1885,"Ascending"),v:"-1"}],AV=0,AX=AU[AV].v,Aa=0,AZ=Ab&&Ab[Aa];return new mstrmojo.ui.menus.EditorConfig({data:{item:AY,order:AX,breakBy:AZ},cssClass:"NewRankMetric-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14612,"Sort:"),cssClass:"menu-info-text"},a.copy({cssClass:"NewRankMetricPullDown"},j(AU,AV,"order"))]},AB(Ab,Aa,{cssClass:"NewRankMetricPullDown"})],fnOk:function(Ac){return AW(Ac.item,Ac.order,[Ac.breakBy]);}});},insertAddUnitToFilterMenu:function G(AZ,AV,AU){var AX=this,AW=mstrmojo.desc(2022,"Add to Filter"),AY=w.ensureArray(AU).filter(function(Aa){return AX.isValidAddToFP(AV,Aa);});if(AY.length>0){AZ.addMenuItem(AW,"",function(){AV.addFilterStackSelectors(AY);});}else{AZ.addDisabledMenuItem(AW,"");}},isValidAddToFP:function O(AV,Aa,Ac){var AW=AV.controller.view.builder,AY=AW.getLayoutVIMap(AV.getCurrentLayoutKey()),AZ=AY.getComponent(K.FILTER_STACK),Ab=true;if(!Ac){Ab=(!AZ||w.find(AZ.getFilterDefinitions(),"srcid",Aa.did)===-1);}if(Ab&&Aa.lock){var AX=Aa.fs||[],AU;Ab=false;for(AU=0;AU<AX.length;AU++){if(AX[AU].iidx){Ab=true;break;}}}return Ab;},renameItem:function u(AZ,Ac,AV,AX){var AY=AZ.mstrmojoId,Ab=mstrmojo.dom.findWidget(AZ);AX=AX||{};if(!AY){var Aa=mstrmojo.insert({scriptClass:"mstrmojo.EditableLabel",editOnClick:false,editOnTwoClicks:true,text:Ac.n,title:Ac.dsc||"",allowEmptyText:AX.allowEmptyText,allowTrimming:AX.allowTrimming||false,cssClass:AX.cssClass||"",placeholder:AZ,onTextEditComplete:function AU(Ad){if(Ad){return AV(this);}},onmousedown:function AW(Ad){if(this.isEditing){Ad.cancel();}}});if(Ab&&Ab.draggable){Aa.parent=Ab;}Aa.render();AY=Aa.id;}mstrmojo.all[AY].set("isEditing",true);return mstrmojo.all[AY];},getMultipleMetricsCalculationMenus:function l(Ab,AU,Ae){var Aa=new mstrmojo.ui.menus.MenuConfig(),Ag=mstrmojo.vi.ui.DatasetUnitMenuUtils.getMultiSelectionShortcutMetricFunctions(Ab),AY=function(Ai,Aj,Ah){return{dsid:AU,funcType:Aj,funcType2:Ah,items:Ai};};Aa.useTooltip=true;Ag.forEach(function(Ah){Aa.addMenuItem(Ah.n,"",function(){Ae(AY(Ab,Ah.t));});});if(Ab.length===2){var AZ=mstrmojo.mstr.EnumFunction,AX=AZ.FunctionDivide,AV=AZ.FunctionMinus,Ad=Ab[0],Ac=Ab[1],Af=function(Al,Aj,Ah,Ak,Ai){Aa.addMenuItem(Al,"",function(){Ae(AY([Aj,Ah],Ak,Ai));});},AW=[{n:function(Ai,Ah){return Ai.n+"/"+Ah.n;},fn:AX},{n:function(Ai,Ah){return Ai.n+"-"+Ah.n;},fn:AV},{n:function(Ai,Ah){return"("+Ai.n+"-"+Ah.n+")/"+Ah.n;},fn:AV,fn2:AX}];AW.forEach(function(Ah){Aa.addSeparator();Af(Ah.n(Ad,Ac),Ad,Ac,Ah.fn,Ah.fn2);Af(Ah.n(Ac,Ad),Ac,Ad,Ah.fn,Ah.fn2);});}return Aa;},getCalculationMetricEditor:function L(Ac,Ad,Ab){var AW=[{n:"",css:"operator-plus",funcType:q.FunctionPlus},{n:"",css:"operator-minus",funcType:q.FunctionMinus},{n:"",css:"operator-multiply",funcType:q.FunctionTimes},{n:"",css:"operator-divide",funcType:q.FunctionDivide},{n:!mstrApp.isWSStyling?"%":"",css:"operator-percent-diff",funcType:q.FunctionMinus,funcType2:q.FunctionDivide}],AX={m1:Ad.did,m2:Ac[0].did,operator:q.FunctionPlus,u1:{id:Ad.did,type:4},u2:null},AV=function(Ae){return{}.hasOwnProperty.call(Ae,"cst");},Aa=function(Ae){return typeof Ae==="string"&&!!Ae.length&&!isNaN(Number(Ae));};var AU="this.parent.popupConfig.valid || this.selectedIndex !== -1 || (!!this.selectedNode && this.selectedNode.innerHTML.length === 0)",AZ=function AZ(){var Ae=this.parent.popupConfig;if(Ae){Ae.set("okEnabled",this[this.editableSlot].innerHTML.length!==0);}};return new mstrmojo.ui.menus.EditorConfig({cssClass:"Calculation-MenuEditor",contents:[AO({metrics:Ac,value:AX.m1,propName:"u1",optionValueField:"did",bindings:{valid:AU},postkeyup:AZ}),{scriptClass:"mstrmojo.ButtonListHoriz",items:AW,selectedIndex:0,postselectionChange:function AY(){this.parent.data.set("operator",this.selectedItem.funcType);this.parent.data.set("operator2",this.selectedItem.funcType2);}},AO({metrics:Ac,value:null,propName:"u2",optionValueField:"did",bindings:{valid:AU},postkeyup:AZ})],data:AX,okEnabled:false,bindings:{valid:function(){var Ag=this.data.u1,Af=this.data.u2,Ah=this.data.operator;if(!Ag||!Af||!Ah){return false;}var Ae=!(AV(Ag)&&AV(Af))&&(!AV(Ag)||Aa(Ag.cst))&&(!AV(Af)||Aa(Af.cst));this.set("okEnabled",Ae);return Ae;}},fnOk:function(Ae){return Ab(Ae.u1,Ae.u2,Ae.operator,Ae.operator2);}});},getCfgForAddUnitFromAllObject:function(AU,AV){var AW=null,AX=null,AY=[],AZ=function(Aa,Ab){if(!Ab){return false;}return w.find((Ab.att||[]).concat(Ab.mx||[]),"did",Aa.did)>-1;};a.forEach(AV,function(Ab,Aa){if(Ab.idd){AW=Aa;AX=Ab;return false;}return true;});if(!AW){AW="$GUID_141";AY.push({act:"createDataset",mgo:true,prm:true,name:mstrApp.projectName,idd:true,newObjectIds:[AW]});}w.forEach(AU,function(Aa){if(!AZ(Aa,AX)){AY.push({act:"addUnitToDataset",dsid:AW,unitId:Aa.did,unitType:Aa.t});}});return{actions:AY,dsid:AW};},getAggregateByMenu:function p(AZ,AX){var AV=new mstrmojo.ui.menus.MenuConfig(),AW=function(Ad,Ac){var Af,Ae;if(Ac){var Ab=Ad.mexp.args[0];Af=Ab.did;Ae=Ab.t;}else{Af=Ad.did;Ae=Ad.t;}return{did:Af,t:Ae};},AU=this.getAvailableShortcutMetricFunctionsGroup(AZ),Aa=AZ.mexp?AZ.mexp.ft:null,AY=AZ.mexp&&this.isAmongFunctions(Aa,AU);AU.forEach(function(Ab,Ac){if(Ac!==0){AV.addSeparator();}Ab.forEach(function(Ad){AV.addMenuItem(Ad.n,"",function(){AX(AW(AZ,AY),Ad.t);});});});return AV;},showObjectPicker:function o(AV,AU){var AW="object_picker";return function(){var AX=mstrmojo.all[AW];if(!AX){AX=new mstrmojo.vi.ui.editors.ObjectPicker({id:AW});if(AU){AX.supportedTypes=w.hash(AU);AX.ob.browsableTypes="8,"+AU.join(",");}AX.render();}else{if(AU){AX.supportedTypes=w.hash(AU);AX.ob.browsableTypes="8,"+AU.join(",");}AX.browse();}AX.OKFn=AV||mstrmojo.emptyFn;AX.open();};},getObjectPicker:function o(){var AU="object_picker";return mstrmojo.all[AU];},generateNumberFormat:function y(AZ){var AU=W.DefaultFormat.FormattingNumber,AV=W.NumberFormatCategory,AX=AZ||{},AW=AX.nct,AY=AW===AV.General&&AX.nfs==="General";return{category:(AW===undefined||AY)?AV.Automatic:AW,decimalPlaces:AX.ndp===undefined?2:AX.ndp,thousandSeparator:AX.nth===undefined?parseInt(AU.ThousandSeparator,10):(AX.nth?-1:0),currencySymbol:AX.ncs||AU.CurrencySymbol,currencyPosition:AX.ncp||AU.CurrencyPosition,format:AX.nfs||"",negativeNumbers:AX.nnn||AU.NegativeNumbers};},getNumberFormatEditor:function AE(AX,AW,AV){var AU=this.generateNumberFormat(AW),AY=a.clone(AU),Aa=a.clone(AU);return new mstrmojo.ui.menus.EditorConfig({data:AY,bindings:{okEnabled:function(){return !(this.data.category===Aa.category&&this.data.format===Aa.format);}},cssClass:"NumberFormat-MenuEditor",contents:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",formatValue:AU,myData:AY,oldData:Aa,adjustAfterCategoryChange:function(){this.parent.adjustCornersForPopupOverflow();}}],fnOk:function AZ(Ab){if(!(Ab.category===Aa.category&&Ab.format===Aa.format)){return AV(Ab,Aa);}}});},getHighlightElementHandler:function(AW,AV,AU){return function(){D.toggleClass(AV,AU||"open",AW);};},getConfDataTypeMenuCfg:function AI(AU,Ap,Ah,A3){var Ay="ToString",Ao="ToNumber",Am="ToDateTime",Ag="keepOriginal",AX="Default",Az={ToString:s.DssXmlBaseFormText,ToNumber:s.DssXmlBaseFormNumber,ToDateTime:s.DssXmlBaseFormDate},Ac={ToString:"D1ED29645DEC4DBF99E8E09ED939074B",ToNumber:"399C3EC1041643F1ACE8F2A92B1C1F2F",ToDateTime:"0A558C7295DE42DAA8C5594F1724563F"},Aa="_pattern",A1="_func",Ak="_bft",A6="_state",A4={UNCHANGED:0,TO_CREATE:1,TO_UPDATE:2},AZ={n:"Default",v:"Default"},Aw=[{n:"MM-DD-Year",v:"MM-DD-Year"},{n:"MM/DD/Year",v:"MM/DD/Year"},{n:"DD-MM-Year",v:"DD-MM-Year"},{n:"DD/mm/Year",v:"DD/mm/Year"},AZ],AW=[{n:mstrmojo.desc(13772,"Keep Original"),v:Ag},{n:mstrmojo.desc(12276,"String"),v:Ay},{n:mstrmojo.desc(2052,"Date"),v:Am},{n:mstrmojo.desc(3434,"Number"),v:Ao}];if(mstrApp&&mstrApp.showMultiDataType){AW=[{n:mstrmojo.desc(13772,"Keep Original"),v:Ag},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(3434,"Number"),v:Ao,bft:s.DssXmlBaseFormNumber},{n:mstrmojo.desc(9920,"Big Decimal"),v:Ao,bft:s.DssXmlBaseFormBigDecimal},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(2052,"Date"),v:Am,bft:s.DssXmlBaseFormDate},{n:mstrmojo.desc(9919,"DateTime"),v:Am,bft:s.DssXmlBaseFormDateTime},{n:mstrmojo.desc(2170,"Time"),v:Am,bft:s.DssXmlBaseFormTime},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(3544,"Text"),v:Ay,bft:s.DssXmlBaseFormText},{n:mstrmojo.desc(9921,"HTML Tag"),v:Ay,bft:s.DssXmlBaseFormHTMLTag},{n:mstrmojo.desc(8984,"Phone Number"),v:Ay,bft:s.DssXmlBaseFormPhoneNumber},{n:mstrmojo.desc(4530,"Symbol"),v:Ay,bft:s.DssXmlBaseFormSymbol},{n:mstrmojo.desc(9922,"URL"),v:Ay,bft:s.DssXmlBaseFormUrl},{n:mstrmojo.desc(4699,"Email"),v:Ay,bft:s.DssXmlBaseFormEmail}];}var Af=a.clone(AW).slice(1),An=Ap.fs.filter(function(A8){return Ap.da||A8.obf;}),A7=An.length>1,Aj=An.length>5,Ab=false,Ax=false,Aq=[],Av=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13773,"Select Data Type for New Attribute:"),cssClass:"menu-info-text menu-header-text"}],A5={okEnabled:false},A0=function(){var A8=false;An.forEach(function(A9){A8=A8||(A5[A9.fnm+A1+A6]!==A4.UNCHANGED)||(A5[A9.fnm+Aa+A6]!==A4.UNCHANGED);});return A8;},Ar=function(BA,A9){var A8=0;if(BA.da){w.forEach([Ay,Am,Ao],function(BD,BB){var BC=new RegExp("^\\s*"+BD+"\\s*(<.*>)?\\s*\\((.+)\\)\\s*$","i").exec(A9.f);if(BC&&BC[2]){A8=BB+1;return false;}});}return A8;},Au=function(BA,A9){var A8=0;if(BA.da){var BB=A9&&A9.bftp;w.forEach(AW,function(BD,BC){if(BD.bft===BB){A8=BC;return false;}});}return A8;},At=function(BA,A9){var BB=AX;if(Ap.da){var A8=new RegExp("^\\s*"+A9+'\\s*<\\s*Pattern\\s*=\\s*"(.+)"\\s*>.*$',"i").exec(BA.f);if(!mstrmojo.string.isEmpty(A8&&A8[1])){BB=A8[1];}}return BB;},As=function(){return Aj?this.parent.parent.parent:(A7?this.parent.parent:this.parent);},Al=function(A8){if(Aj){A8.formList.updateScrollbars();}},AY=function(BF,BG,BE){var A8=BG.fnm,BB=Aj?BF.formList[BG.fnm+Aa]:BF[BG.fnm+Aa],BC=A7?BB.children[1]:BB,BD=A5[A8+A1],BA=Ab&&(BD===Am||BD===Ay),A9=BB.visible!==BA;if(A9){BB.set("visible",BA);if(BA){Al(BF);}else{BC.hideTooltip();}}if(BE){BC.set("text",At(BG,BD));BC.set("items",BD===Am?Aw:[AZ]);}},Ai=function(A8){var A9=false;An.forEach(function(BA){if(A5[BA.fnm+A1]===Am||A5[BA.fnm+A1]===Ay){A9=true;return false;}});A8.advancedLabel.set("visible",A9);},AV=function(BA,A8,BB){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:BA,alias:BB.fnm+A1,selectedIndex:A8,onPopupWidgetOpened:function(){Al(As.call(this));},onitemSelected:function A9(BG,BE){var BF=As.call(this),BH=BF.data,BI=BB.fnm,BD=BG.v,BC=function(BJ){if(BJ){return(BA.length===3?A4.TO_UPDATE:A4.TO_CREATE);}return A4.UNCHANGED;};BH.set(BI+A1,BD);BH.set(BI+Aa,At(BB,BD));BH.set(BI+Ak,BD===Ag?BB.bftp:(BG.bft?BG.bft:Az[BD]));BH.set(BI+A1+A6,BC(BE!==A8));BH.set("okEnabled",A0());AY(BF,BB,true);Ai(BF);}};},Ae=function(BA,BB,A8){return{scriptClass:"mstrmojo.ui.SearchablePulldown",isHostedWithin:false,alias:BA.fnm+Aa,useRichTooltip:true,visible:A8,allowCustomText:true,allowEmptyText:true,onPopupWidgetOpened:function(){Al(As.call(this));},customizeSearchResult:function(BC){if(w.find(BC,"v","Default")===-1&&this.items.length>0){BC.push(AZ);}},onclick:function(BC){mstrmojo.ui.SearchablePulldown.prototype.onclick.call(this,BC);this.set("isEditing",true);},updateData:function(BE){var BC=As.call(this),BD=BC.data,BF=BA.fnm;BD.set(BF+Aa,BE);BD.set(BF+Aa+A6,BB!==BE?A4.TO_UPDATE:A4.UNCHANGED);BD.set("okEnabled",A0());},onitemSelected:function A9(BC){if(BC){this.updateData(BC.v);}},onkeyup:function(BC){mstrmojo.ui.SearchablePulldown.prototype.onkeyup.call(this,BC);var BD=this[this.editableSlot],BE=BD.innerText||BD.textContent;this.updateData(BE);},updateTooltipConfig:function(BD){this.tooltipOpenDelay=BD?500:0;var BC=Y.position(this.domNode);this.richTooltip={content:mstrmojo.desc(14114,'Pattern determines the formatting for the resulting string of characters. You can use the custom numeric, date, and time formatting symbols. <br/> Example: if pattern is defined as "0,000.00" for "1001", it returns the string "1,001.00"'),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:BC.y-2,left:BC.x+BC.w+10};}};},A2=function(BG,BF,A8,A9,BE){var BB=mstrApp&&mstrApp.showMultiDataType?Au(BG,BF):Ar(BG,BF),BD=At(BF,AW[BB].v),BA=BF.fnm,BC=AW;if(BB>0){BC=Af;BB--;}A9[BA+Aa]="";A9[BA+A1]="";A9[BA+Ak]="";A9[BA+A1+A6]=A9[BA+Aa+A6]=A4.UNCHANGED;if(BE){A8.push({scriptClass:"mstrmojo.HBox",cssClass:"func-input",alias:BA+A1,children:[{scriptClass:"mstrmojo.Label",text:BA,useRichTooltip:true,updateTooltipConfig:function(BJ){this.tooltipOpenDelay=BJ?500:0;var BI=this.domNode;var BH=Y.position(BI);if(BI.scrollWidth>BI.offsetWidth){this.richTooltip={content:BI.innerText,posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-V",top:BH.y-BH.h-10,left:BH.x-10};}}},a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown HBOXPullDown"},AV(BC,BB,BF,true))]});A8.push({scriptClass:"mstrmojo.HBox",cssClass:"pattern-input",alias:BA+Aa,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12078,"Pattern"),cssClass:"menu-info-text"},a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown HBOXPullDown"},Ae(BF,BD,true))]});}else{A8.push(a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown"},AV(BC,BB,BF,false)));A8.push(a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown"},Ae(BF,BD,false)));}};w.forEach(Ap.fs,function(A8){if(AU.als&&AU.als.links[Ap.did+" "+A8.fid]){Ax=true;return false;}});if(A7){An.forEach(function(A8){A2(Ap,A8,Aj?Aq:Av,A5,true);});}else{A2(Ap,An[0],Av,A5,false);}if(Aj){Av.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"formList",cssClass:"formList",children:Aq});}Av.push({scriptClass:"mstrmojo.Label",cssClass:"advancedLabel",alias:"advancedLabel",allowHTML:true,text:"<span>"+mstrmojo.desc(702,"Advanced")+"</span>",onclick:function(){var A9=this.parent,BA,A8,BB=true;Ab=!Ab;D.toggleClass(this.domNode,"expanded",Ab);An.forEach(function(BC){AY(A9,BC,false);BA=Aj?A9.formList[BC.fnm+Aa]:A9[BC.fnm+Aa];A8=A7?BA.children[1]:BA;if(BA.visible&&BB&&!Aj){BB=false;A8.showTooltip();}});}});return new mstrmojo.ui.menus.EditorConfig({data:A5,cssClass:"ConfDataType-MenuEditor",contents:Av,onOpen:function(){Al(this);},bindings:{okEnabled:"this.data.okEnabled"},fnOk:function Ad(BA){var A8=[],BC=[],A9=false,BB=function(BF,BG,BE){var BI=[],BH=function(BJ){var BK=BJ.ftk&&BJ.ftk.slice(2,-2);if(!BK){return null;}while((BK.shift()).v!=="("){}return BK;},BD=BH(BE)||[AG(Ap,BE)];BI.push({v:"!",tp:33,lv:4});if(BF!==Ag){BI.push({v:BF,oi:{did:Ac[BF],t:11,st:2816,n:BF}});if(!mstrmojo.string.isEmpty(BG)&&BG!==AX&&(BF===Am||BF===Ay)){BI.push({v:'<Pattern="'+BG+'">(',tp:"2",lv:1});}else{BI.push({v:"(",tp:"2",lv:1});}BI=BI.concat(BD);BI.push({v:")",tp:"2",lv:1});}else{BI=BI.concat(BD);}BI.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:BI});};if(Ax){A9=true;}else{An.forEach(function(BD){if(BA[BD.fnm+A1+A6]===A4.TO_CREATE){A9=true;return false;}else{if(BA[BD.fnm+A1+A6]===A4.TO_UPDATE||(BA[BD.fnm+Aa+A6]===A4.TO_UPDATE&&(BA[BD.fnm+A1]===Am||BA[BD.fnm+A1]===Ay))){BC.push(BD);}}});}if(A9){An.forEach(function(BD){A8.push({n:BD.fnm,formula:BB(BA[BD.fnm+A1],BA[BD.fnm+Aa],BD),bft:BA[BD.fnm+Ak]});});A3(A9,A8);}else{if(Ap.da){Z(AU.mid,Ap.did,BC,function(BD){BD.forEach(function(BE){A8.push({did:BE.fid,formula:BB(BA[BE.fnm+A1],BA[BE.fnm+Aa],BE),bft:BA[BE.fnm+Ak]});});A3(A9,A8);});}}}});},getCreateTimeDAEditorCfg:function P(AX,AW){var AU=d(AX);if(!AU){return null;}return new mstrmojo.ui.menus.EditorConfig({data:{okEnabled:false},cssClass:"CreateTimeAttribute-MenuEditor",contents:[{scriptClass:"mstrmojo.ui.CheckList",alias:"time_type",items:[{n:mstrmojo.desc(873,"Year"),v:"Year"},{n:mstrmojo.desc(10051,"Quarter of Year"),v:"QuarterOfYear"},{n:mstrmojo.desc(10050,"Quarter"),v:"Quarter"},{n:mstrmojo.desc(10049,"Month of Year"),v:"MonthOfYear"},{n:mstrmojo.desc(871,"Month"),v:"Month"},{n:mstrmojo.desc(10047,"Week of Year"),v:"WeekOfYear"},{n:mstrmojo.desc(10048,"Week"),v:"Week"},{n:mstrmojo.desc(11608,"Day of Year"),v:"DayOfYear"},{n:mstrmojo.desc(10046,"Day of Month"),v:"DayOfMonth"},{n:mstrmojo.desc(10045,"Day of Week"),v:"DayOfWeek"}],onchange:function AV(){var AZ=false;a.forEach(this.selectedIndices,function(Aa){if(Aa){AZ=true;return false;}});this.parent.data.set("okEnabled",AZ);}}],bindings:{okEnabled:function(){return this.data.okEnabled;}},fnOk:function AY(Ad,Ab){var Ac=Ab.time_type,Ag=Ac.selectedIndices,Aa=Ac.items,Af=[],AZ=[],Ae=function(Ah,Aj,Al){var Ak=[{v:"!",tp:33,lv:4}],Ai;Al.forEach(function(Am){if(Am===Q){Ak.push(AG(Ah,Aj));}else{Ai=AJ[Am];if(Ai){Ak.push({v:Ai,oi:{did:Ai,t:11,st:2816,n:Ai}});}else{Ak.push({v:Am,tp:"2",lv:1});}}});Ak.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:Ak});};a.forEach(Ag,function(Ah,Ai){if(Ah){AZ=[];a.forEach(AQ[Aa[Ai].v],function(Aj,Ak){AZ.push({n:Ak,formula:Ae(AX,AU,Aj),bft:(Ak==="DATE"?8:0)});});Af.push({isTokenStream:true,forms:AZ,name:AX.n+" ("+Aa[Ai].n+")"});}});return AW(Af);}});},RefreshAndCloseAllObjectBrowserCallback:function(AV,AU){return mstrmojo.func.wrapMethods(AU.getDatasetsUpdateCallback(),{success:function(){if(w.find(AV,"act","createDataset")!==-1){AU.controller.datasetsPanel.set("allObjectBrowserOpened",false);}}});},getUnitFromDataset:function e(AV,AX,AU){var AW=null;a.forEach(AV,function(AZ){var AY=AZ.att||[];if(AU===4){AY=AZ.mx||[];}w.forEach(AY,function(Aa){if(Aa.did===AX){AW=Aa;return false;}});if(AW){return false;}});return AW;},getDatasetFromId:function R(AU,AV){var AW=null;a.forEach(AU,function(AX){if(AX.did===AV){AW=AX;return false;}});return AW;},getDatasetFromAttributeId:function R(AU,AV){var AW=null;a.forEach(AU,function(AX){if(w.find(AX.att,"did",AV)>=0){AW=AX;return false;}});return AW;},getSortedDatasetUnits:function E(AU){var AV=function AV(AW){return AW.t===X.DssTypeMetric?2:1;};AU=AU.concat();AU.sort(function(AZ,AX){if(!AZ||!AX){return true;}var Aa=AV(AZ)-AV(AX),AY=AZ.n.toUpperCase(),AW=AX.n.toUpperCase();return Aa!==0?Aa:(AY!==AW?AY.localeCompare(AW):AZ.n.localeCompare(AX.n));});return AU;},isGeoAttr:function AL(AU,AV){return !!(AU.fs&&(AU.fs instanceof Array)&&AU.fs.length&&AU.fs.some(function(AW){return AW.fgr>0&&(!AV||(AV&&AW.obf));}));},isTimeAttr:function h(AU){return !!(AU.fs&&d(AU));},isLngOrLatAttr:function AK(AU){return !!(AU.fs&&(AU.fs instanceof Array)&&AU.fs.length===1&&AU.fs.some(function(AV){return AV.fgr===5||AV.fgr===6;}));},getUnitCssClass:function(AV){var AU=AV.t;if(this.isGeoAttr(AV,AV.useAvailGeoFmsOnly)){AU+="g";}else{if((AV.dm||AV.um)||AV.da){AU+="d";}else{if(AV.de){AU+="de";}else{if(this.isTimeAttr(AV)){AU+="t";}}}}if((AV.t===AT.Consolidation&&AV.st===N.ConsolidationManaged)||(AV.t===AT.Attribute&&AV.st&&AV.st===N.AttributeRecursive)){AU+=(" st"+AV.st);}if(AV.t===AT.Consolidation&&AV.st===N.ConsolidationManaged&&AV.ndetype===AD.DssRecursiveDerivedElement){AU+=" nde4ra";}return"ic"+AU;},hasMultiForms:function n(AV,AU){return t.getFormsByAttrId(AV,AU).length>1;},getDisplayFormsMenu:function F(Aj,Ad,Aa,Al,AX,AV){var AW=[],Ai=[],Ab=[],Af=[{n:mstrmojo.desc(2411,"Off"),v:0},{n:mstrmojo.desc(2410,"On"),v:1},{n:mstrmojo.desc(8504,"Form Name Only"),v:2},{n:mstrmojo.desc(8505,"Show Attribute Name Once"),v:3},{n:mstrmojo.desc(4531,"Automatic"),v:4}];var Ak=Ad.model.data,AU=Ak.gts,AZ;var Ag=Aj.t===AT.Consolidation&&Aj.st===N.ConsolidationManaged;w.forEach((AU.row||[]).concat(AU.col||[]),function(Am){if(Am.id===Aj.did){Ai=Ai.concat(Am.fs);}});AZ=t.getFormsByAttrId(Aj.attId||Aj.did,Aa);w.forEach(AZ||[],function(An){var Ao=An.fid;if(w.find(AW,"id",Ao)<0){AW.push({id:Ao,n:An.fnm});var Am=w.find(Ai,"id",Ao);if(Am>-1&&(!AV||AV(An))){Ab[AW.length-1]=true;}}});var Ah=[{alias:"fs",scriptClass:"mstrmojo.ui.CheckList",minimumSelectCnt:1,items:AW,selectedIndices:Ab},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11918,"Display attribute form names:"),cssClass:"menu-info-text"},{alias:"longNames",scriptClass:"mstrmojo.ui.Pulldown",items:Af,isHostedWithin:false,selectedIndex:w.find(Af,"v",Ak.lnm||0),onitemSelected:function Ac(Am){this.v=String(Am.v);}}];if(Ag||(Ad.getChartStyle&&Ad.getChartStyle()==="NewGraphMatrixVisualizationStyle")){Ah.splice(-2,2);}return new mstrmojo.ui.menus.EditorConfig({cssClass:"displayForms",data:{item:Aj,oldSelected:a.copy(Ab,{})},contents:Ah,okBtnText:mstrmojo.desc(1442,"Ok"),fnOk:function Ae(Ar,Av){var Aq=Av.fs,Ao=Aq.selectedIndices,At=Aq.items,Az=[],As=[],Aw=[];if(!Aq.getSelectedItems().length){mstrmojo.alert("Please select at least one form!");return ;}var An=Ar.oldSelected,Ay=Ao,Ap,Au={},Ax={};for(Ap=0;Ap<At.length;Ap++){if(An[Ap]&&!Ay[Ap]){Au[Ap]=true;}else{if(!An[Ap]&&Ay[Ap]){Ax[Ap]=true;}}}if(!AX){a.forEach(Au,function(A0,A1){if(A0){As.push({act:"removeForm",unitId:Aj.did,unitType:Aj.t,attFormId:At[A1].id});}});}var Am=Ad.model.data.gts;(Am.row||[]).concat(Am.col||[]).forEach(function(A0){if(A0.id===Aj.did){(A0.fs||[]).forEach(function(A1){if(w.find(AW,"id",A1.id)<0){As.push({act:"removeForm",unitId:Aj.did,unitType:Aj.t,attFormId:A1.id});}});}});a.forEach(Ax,function(A0,A1){if(A0){Az.push({act:"addForm",unitId:Aj.did,unitType:Aj.t,attFormId:At[A1].id,unitPos:0});}});Aw.push({act:"putProperties",prs:"Template Formatting",pr:"LongNames",v:Av.longNames?Av.longNames.v:0});if(Al){Al([{act:"updateTemplate",keyContext:Ad.k,partialRetrieval:{nodes:[Ad.k]},actions:As.concat(Az).concat(Aw)}],Ax,Au);}},onOpen:function AY(){this.fs.updateScrollbars();}});},getAttributeLinkMenu:function i(Ag,Aj,Ae,Ai,AZ){var Ak=-2147483648,Ab=Ai.datasets,Ac=Ab[Ae],Ah=Ac.tables||[],AU={},Ad=[],AX=(Aj.fs&&Aj.fs[0])||{},Af=[],Aa=779,AW=Aj.art>1,AV=!AW&&a.keyarray(Ab).length>1,AY=function(){mstrmojo.vi.ui.editors.AttributeLinkEditor.open({attribute:Aj,docModel:Ai,datasetId:Ae});};if((Ac.st!==Aa)||Ah.length<=1||Aj.da){if(AV){Ag.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AY);}return ;}w.forEach(Ac.att,function(An){var Ao=true,Am=null,Al=(An.fs&&An.fs[0])||{};if(An.da){return ;}if(AX.der===Ak||Al.der===Ak||AX.fgr===-1||Al.fgr===-1||AX.ftr===-1||Al.ftr===-1){return ;}if(AX.fgr&&Al.fgr&&AX.fgr!==Al.fgr){return ;}if(AX.ftr&&Al.ftr&&AX.ftr!==Al.ftr){return ;}w.forEach(Ah,function(Ap){var Aq=w.find(Ap.attRefs,"did",Aj.did),Ar=w.find(Ap.attRefs,"did",An.did);if(Aq>=0&&w.indexOf(Ad,Ap.did)<0){Ad.push(Ap.did);}if(Ar>=0){Am=Ap.did;}if(Aq>=0&&Ar>=0){Ao=false;}});if(Ao&&!An.hide){AU[An.did]=Am;Af.push(An);}});if(Af.length>0&&Ac.hcs!==true&&!Ai.isSparkDataset(Ac)){Ag.addEditorMenuItem(mstrmojo.desc(13172,"Map Attributes"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mapAttribute",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:Af,listHooks:{select:function Al(Am,An){Ai.warnForEditStandaloneDS(Ac,function(){w.forEach(Ad,function(Ao){I({dsid:Ae,srcId:Aj.did,srcTableId:Ao,tgtId:An.did,tgtTableId:AU[An.did]},Ai,AZ);});});}}}]}]});});}if(AV){Ag.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AY);}},isDocumentLevelItem:function x(AU){return AU&&(AU.um||AU.da||(AU.t===AT.Consolidation&&AU.st===N.ConsolidationManaged));},isLegalObjectName:function S(AU){var AV=/["\[\]\\]/g;if(AU.match(AV)){return false;}return true;},validateName:function k(AV,AW,AU){if(this.isLegalObjectName(AV)){AW();}else{mstrmojo.alert(mstrmojo.desc(8622,"The # cannot contain the reserved characters ##.").replace("##","'[', ']', '\"' and '\\'").replace("#",mstrmojo.desc(945,"Name")),AU,mstrmojo.desc(1388,"Rename"));}},hasCGorCon:function AS(AU){return AU.att.some(function(AV){return H(AV);});},isCGorCon:function AH(AU,AW){var AV=w.filterOne(AW&&AW.att,function(AX){return AX.did===AU.did;});return H(AV||AU);},hasOldDEOverDatasets:function(AX,AW){var AV=false,AU;a.forEach(AW,function(AY){AU=w.find((AY.att||[]),"did",AX);if(AU!==-1&&AY.att[AU].de){AV=true;return false;}});return AV;},getMarkGeoRoleEditorCfg:function AP(AU,A6,Ao,Al,BF,BH){var Ak=268435456,BC=536870912,AZ=1073741824,Ay=268435456,A9=805306368,A4=805306368,As=1879048192,BG=-2147483648,A7=0,A8=1,Ab=2,Aj=3,An=4,Ah=5,BE=6,Ae=7,Aq=8,Ap=9,A0=10,AX=2,Ax=3,A5={v:A7,n:mstrmojo.desc(2057,"None")},BI={v:Aj,n:mstrmojo.desc(7674,"Country"),der:Ak},A3={v:Ab,n:mstrmojo.desc(7676,"State"),parents:[BI],der:BC},Af={v:Ap,n:mstrmojo.desc(12919,"County"),parents:[BI,A3]},BA={v:A8,n:mstrmojo.desc(7675,"City"),parents:[BI,A3],der:AZ},At={v:Aq,n:mstrmojo.desc(7677,"Zip Code"),parents:[BI,A3,BA]},Am={v:Ah,n:mstrmojo.desc(7696,"Latitude")},A1={v:BE,n:mstrmojo.desc(7697,"Longitude")},Ai={v:An,n:mstrmojo.desc(7675,"City")+", "+mstrmojo.desc(7676,"State")},Aw={v:A0,n:mstrmojo.desc(12973,"Area Code")},Az={v:Ae,n:mstrmojo.desc(2056,"Custom")},Ag={ID:[A5,BI,A3,Af,BA,At,Am,A1,Ai,Aw,Az],ID_NUMERIC:[A5,At,Aw,Am,A1],NON_ID:[A5,BI,A3,Af,BA,At,Ai,Aw,Az],NON_ID_NUMERIC:[A5,At,Aw]},Au=w.filter(A6.fs,function(BJ){return(BJ.bftp===AX||BJ.bftp===Ax)&&BJ.der!==BG;});var A2=(Au.length>1),AW=w.find(Au,"idf",true),AY=(AW===-1?0:AW),Av=Au[AY],Ad,AV,Ar,Aa=[],Ac=function(BJ){var BK=(BJ.idf?"ID":"NON_ID")+(BJ.bftp===AX?"_NUMERIC":"");return Ag[BK];},BD=function(BK,BJ){return w.find(Ac(BJ),"v",BK);};if(Au.length===0||w.find(A6.fs,"fgr",-1)!==-1||Av.der===BG){return null;}w.forEach(Au,function(BL,BJ){var BK=a.clone(BL);BK.n=BK.fnm;Aa.push(BK);if(BL.fgr){Av=BK;AY=BJ;}});Ad=Av.fid;Ar=Av.fgr||0;AV=BD(Ar,Av);return new mstrmojo.ui.menus.EditorConfig({data:{item:A6,geoForm:Av,geoRole:Ar},cssClass:"MarkGeoRole-MenuEditor",contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13522,"Select Attribute Form:"),visible:A2},{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,cssClass:"MarkGeoRolePullDown",items:Aa,selectedIndex:AY,alias:"formList",visible:A2,onitemSelected:function BB(BL){var BJ=this.parent.data,BK=this.parent.geoRoleList;if(BJ.geoForm.fid!==BL.fid){BJ.set("geoForm",BL);BJ.set("geoRole",BL.fgr);BK.set("items",Ac(BL));BK.set("selectedIndex",BD(BL.fgr,BL));}}},{scriptClass:"mstrmojo.ToolSeparator",visible:A2,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13523,"Select Geographic Type:"),cssClass:"menu-info-text"},{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,cssClass:"MarkGeoRolePullDown",items:Ac(Av),selectedIndex:AV,alias:"geoRoleList",onitemSelected:function BB(BP){var BO=this.parent,BJ=BO.data,BQ=BO.geoDrvList;var BL=[],BN=[],BK=Av.der,BM;BJ.set("geoRole",BP.v);w.forEach(BP.parents,function(BR,BS){BM=BR;BL.push({n:BM.n,der:BM.der});if((BK&BM.der)!==0){BN[BS]=true;}});BQ.set("items",BL);BQ.set("selectedIndices",BN);w.forEach(["geoDrvSeparator","geoDrvLabel","geoDrvList"],function(BR){BO[BR].set("visible",BL.length>0);});if(BO.adjustCornersForPopupOverflow){BO.adjustCornersForPopupOverflow();}}},{scriptClass:"mstrmojo.ToolSeparator",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},alias:"geoDrvSeparator"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13524,"(Optional) Create Additional Attributes:"),alias:"geoDrvLabel",cssClass:"menu-info-text"},{scriptClass:"mstrmojo.ui.CheckList",alias:"geoDrvList"}],fnOk:function(BO,BN){var BK=function(BY){var BX=function(Bd){var Be="<mpcs>";w.forEach(Bd,function(Bf){Be+='<mpc did="'+Bf.did+'" n="'+Bf.n+'" georole="'+Bf.georole+'" drvflg="'+Bf.drvflg+'" />';});Be+="</mpcs>";return Be;},BQ=function(Bd,Bf,Bh,Be){var Bg=function(Bl,Bi,Bk){var Bj=U(BY,Bl,Bi),Bm=m(Bj,Bk);return Bm&&Bm.did;};BF.forEach(function(Bi,Bj){var Bk=Bg(Bi.did,A6.did,Bf.fid);if(Bk){Bd[Bj]=Bd[Bj]||[];Bd[Bj].push({did:Bk,n:Bf.fnm,georole:Bh,drvflg:Be});}});},BU=[],Bc=[],BZ=BN.geoDrvList,Ba=0,BS=false,BW=false,Bb={2:Ay,1:A9,9:A4,8:As}[BO.geoRole]||0,BR=Av.fgr!==BO.geoRole,BV=Av.fid!==BO.geoForm.fid,BT=Av.der!==Ba;a.forEach(BZ.selectedIndices,function(Be,Bd){if(Be){Ba|=BZ.items[Bd].der;}});Ba&=Bb;if(BR||BV||BT){if(A2&&BV){if(Av.fgr!==A7){BQ(Bc,Av,A7,0);if(Av.der>0){BS=true;}}}if(BO.geoForm.fgr!==BO.geoRole||BO.geoForm.der!==Ba){BQ(Bc,BO.geoForm,BO.geoRole,Ba);if((Ba&BO.geoForm.der)!==BO.geoForm.der){BS=true;}}if(BR){BW=true;}if(Bc.length>0){Bc.forEach(function(Be,Bd){BU.push({act:"changeEMMAMapping",dsid:Ao,tbid:BF[Bd].did,mapping:BX(Be)});});BH(BU,BS||BW);}}},BL=function(){C(AU.mid,Ao,{success:BK});};var BM=mstrApp.isAppStatePause();if(!Al||BM){var BP,BJ=BM?mstrmojo.desc(212,"Continue"):mstrmojo.desc(219,"Yes");if(Al){BP=mstrmojo.desc(16237,"The operation requires the dataset to be unloaded from memory. It will be automatically reloaded when you resume data retrieval. Do you want to continue?");}else{BP=BM?mstrmojo.desc(16236,"The operation requires modifying the dataset and unloading it from memory. It will be automatically reloaded when you resume data retrieval, however the change will also affect other reports, documents, and dossiers that share the dataset. Do you want to continue?"):mstrmojo.desc(15493,"Modifications to this dataset will affect other reports, documents, and dossiers that share the dataset. Do you want to continue?");}mstrmojo.warn(BP,{},{buttons:[z(BJ,function(){BL();},true,{cssText:"min-Width: 60px"}),z(mstrmojo.desc(221,"Cancel"),function(){})]});}else{BL();}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.array","mstrmojo.hash","mstrmojo.color","mstrmojo._HasLayout","mstrmojo.vi.ui._IsPanel","mstrmojo._HasPopup","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._HasTargets","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo._Formattable","mstrmojo.vi.ui._IsUnitContainerTitleBar","mstrmojo.DynamicClassFactory","mstrmojo.Box","mstrmojo.css","mstrmojo.dom","mstrmojo.func","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.vi.ui.TitleBar","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.vi.ui.rw._HasVisFilterIndicator","mstrmojo.EnumRWUnitType","mstrmojo.vi.ui._CanGroup","mstrmojo.EnumRWUnitType","mstrmojo._IsAccessibleMenu","mstrmojo.util.ui._HostsSplitter","mstrmojo.vi.ui.rw._boxCornerResizer");mstrmojo.requiresDescs(629,1388,11477,11478);var c=mstrmojo.array,BT=mstrmojo.css,Ai=mstrmojo.dom,g=mstrmojo.hash,AT=mstrmojo.color,Bc=mstrmojo.vi.models.EnumDragSources,t=mstrmojo.models.FormatModel,o=t.ENUM_PROPERTY_NAMES,A5=1,Ae="visible",q="mouse-left",BP="no-menu",Ar="ctrlOverlay",z="or-v",K="or-h",AA="accessible",u=3.5,A8=5,Aa=2,BY=0;var BA={SHORT:"ghost-short",TALL:"ghost-tall",GRANDE:"ghost-grande",VENTI:"ghost-venti",HIDE_TITLE:"ghost-hide-title",HIDE_DESC:"ghost-hide-desc"};var i={BLACK:"ghost-black",WHITE:"ghost-white",GREY:"ghost-grey"};var G=g.valarray(BA);var j=g.valarray(i);var a=G.concat(j);var p={W_LV1:{H_LV1:[BA.VENTI],H_LV2:[BA.GRANDE],H_LV3:[BA.TALL],H_LV4:[BA.TALL,BA.HIDE_TITLE],H_LV5:[BA.SHORT,BA.HIDE_TITLE],H_LV6:[BA.SHORT,BA.HIDE_TITLE,BA.HIDE_DESC]},W_LV2:{H_LV1:[BA.GRANDE],H_LV2:[BA.GRANDE],H_LV3:[BA.TALL],H_LV4:[BA.TALL,BA.HIDE_TITLE],H_LV5:[BA.SHORT,BA.HIDE_TITLE],H_LV6:[BA.SHORT,BA.HIDE_TITLE,BA.HIDE_DESC]},W_LV3:{H_LV1:[BA.TALL],H_LV2:[BA.TALL],H_LV3:[BA.TALL],H_LV4:[BA.TALL,BA.HIDE_TITLE],H_LV5:[BA.SHORT,BA.HIDE_TITLE],H_LV6:[BA.SHORT,BA.HIDE_TITLE,BA.HIDE_DESC]},W_LV4:{H_LV1:[BA.SHORT],H_LV2:[BA.SHORT],H_LV3:[BA.SHORT],H_LV4:[BA.SHORT,BA.HIDE_TITLE],H_LV5:[BA.SHORT,BA.HIDE_TITLE],H_LV6:[BA.SHORT,BA.HIDE_TITLE,BA.HIDE_DESC]},W_LV5:{H_LV1:[BA.SHORT],H_LV2:[BA.SHORT],H_LV3:[BA.SHORT],H_LV4:[BA.SHORT,BA.HIDE_TITLE],H_LV5:[BA.SHORT,BA.HIDE_TITLE,BA.HIDE_DESC],H_LV6:[BA.SHORT,BA.HIDE_TITLE,BA.HIDE_DESC]}};function A1(Bg){var Bj=Bg?Bg.c1||Bg:"",Bi=AT.getLuminance(Bj),Bf=255,Bk=68.7914,Bh=Math.max(Bf/Bi,Bi/Bf),Bl=Math.max(Bk/Bi,Bi/Bk);if(Bh>=Bl){return i.WHITE;}if(Bi<190){return i.BLACK;}return i.GREY;}function BS(Bj,Bg){var Bl,Bk,Bi;if(Bj>=1024){Bl="W_LV1";}else{if(Bj>=640){Bl="W_LV2";}else{if(Bj>=320){Bl="W_LV3";}else{if(Bj>=100){Bl="W_LV4";}else{Bl="W_LV5";}}}}if(Bg>=1024){Bk="H_LV1";}else{if(Bg>=640){Bk="H_LV2";}else{if(Bg>=320){Bk="H_LV3";}else{if(Bg>=200){Bk="H_LV4";}else{if(Bg>=100){Bk="H_LV5";}else{Bk="H_LV6";}}}}}Bi=p[Bl][Bk];if(this.getFormats){var Bf=this.getFormats(),Bh=Bf&&Bf["background-color"];Bi=Bi.concat(A1(Bh));}return Bi;}function B(Bf){Bf=document.createElement("div");Bf.className="hover-drag-icon-btn";Bf.setAttribute("tabindex","0");Bf.setAttribute("role","button");var Bg="Drag Icon for "+this.title;Bf.setAttribute("aria-label",Bg);if(this.menuBtnInfo.btn){this.domNode.insertBefore(Bf,this.menuBtnInfo.btn);}else{this.domNode.appendChild(Bf);}return Bf;}mstrmojo.vi.ui.rw.UnitContainerTitleBar=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.vi.ui.TitleBar,[mstrmojo.vi.ui._IsUnitContainerTitleBar],{scriptClass:"mstrmojo.vi.ui.rw.UnitContainerTitleBar"});var BD={n:mstrmojo.desc(11477,"Hide Titlebar"),cls:"htb",fn:function(){this.toggleTitleBar(false);},dsbld:false};var BW={n:mstrmojo.desc(11478,"Show Titlebar"),cls:"stb",fn:function(){this.toggleTitleBar(true);},dsbld:false};function X(Bg,Bf,Bh){var Bi=mstrApp.isAppStatePresentation(),Bj=this.domNode;BT.toggleClass(this.domNode,"pulse",Bg&&!Bi&&!Bh);if(Bf){setTimeout(function(){BT.toggleClass(Bj,"pulse",false);},500);}}function BM(Bg,Bf){return mstrmojo.all[Bg].getPanel().getUnitByKey(Bf);}function AZ(Bf,Bg){BT.toggleClass(Bf,Ae,Bg);BT.toggleClass(Bf,q,!Bg);}function AF(){var Bi=this.menuBtnInfo,Bk=Bi&&Bi.menuCfg,Bh=Bk&&Bk.menus,Bj=(Bh&&Bh.length>0),Bf=Bi&&Bi.btn,Bg=this.dragIcon;if(Bf){Bf.style.display=Bj?"block":"none";}BT.toggleClass(this.domNode,BP,!Bj);AZ(Bg,!Bj&&!mstrApp.isAppStatePresentation());}function BX(Bf,Bh){var Bg=this.getContextDragData(Bf);return !!(Bg&&(Bg.src===Bh));}function AI(Bf){return BX.call(this,Bf,Bc.FILTERS);}function Al(Bf){return BX.call(this,Bf,Bc.DATASETS);}function AU(Bf){return BX.call(this,Bf,Bc.ALL_OBJECT_LIST);}function BN(Bf){var Bg=Bf.children;if(Bg&&Bg.length){Bf.removeChildren();Bg.forEach(function(Bh){Bh.destroy();});}}function U(){var Bf=this.boxContent;if(Bf&&Bf.getFormats){return Bf.getFormats();}return null;}function BF(Bf){if(Bf.visible){if(Bf.controls){this.showControlOverlay(Bf.controls);}else{throw new Error('mstrmojo.vi.ui.rw.UnitContainer: "controls" should be provided when showing the control overlay');}}else{this.hideControlOverlay();}}function A4(Bj,Bg){var Bh=this.model.controller,Bi="propertiesPanel",Bf=function(){var Bl=this.getFormatMenuItemTarget(Bj);var Bn=this.getEditorModel();if(Bn.selectTargetByValue){Bn.selectTargetByValue(Bl);}if(Bg){Bg(Bl);}var Bk=Bh.getViPanel(Bi),Bm=Bk&&Bk.parent;if(Bm&&Bm.highlightSelected){Bm.highlightSelected();}}.bind(this);if(Bh.getViPanel(Bi)){Bh.selectViPanel(Bi);Bf();}else{Bh.openViPanel(Bi,{success:Bf});}}function N(Bh,Bf){var Bg=Bh?"titlebarNode":"domNode";this.clearCache();this.clearSlotBackgroundCSS(Bg);this.applyCSSFormatToNode(Bg,Bf);}mstrmojo.vi.ui.rw.UnitContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._HasPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode,mstrmojo.vi.ui._HasTargets,mstrmojo.vi.ui.rw._HasVisFilterIndicator,mstrmojo.vi.ui._CanGroup,mstrmojo.util.ui._HostsSplitter,mstrmojo.vi.ui.rw._boxCornerResizer],{scriptClass:"mstrmojo.vi.ui.rw.UnitContainer",markupString:'<div id="{@id}" tabindex = "-1" class="mstrmojo-UnitContainer {@cssClass}" style="{@cssText} {@domNodeCssText}" mstrAttach:mouseenter,mouseleave,mousemove,mouseover,mouseout,click,contextmenu><div class="mstrmojo-UnitContainer-titlebar" style="{@titlebarNodeCssText}"></div><div class="mstrmojo-UnitContainer-content"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{titlebarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},splitterHostNode:function(){return this.domNode;},maskNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onzIndexChange:function(){this.domNode.style.zIndex=this.zIndex||A5;},onenabledChange:function(){BT.toggleClass(this.domNode,"inactive",!this.enabled);},onorientationChange:function(){var Bg=this.ctrlOverlay.domNode,Bf=this.orientation;BT.toggleClass(Bg,z,Bf==="v");BT.toggleClass(Bg,K,Bf==="h");this.orientationHasChanged();},onghostImgCssChange:function(){var Bg=this.ctrlOverlay.domNode,Bf=this.ghostImgCss;BT.removeClass(Bg,a);BT.addClass(Bg,Bf);}},layoutConfig:{h:{titlebarNode:"auto",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true},formatHandlers:{domNode:["B","BG"],titlebarNode:{src:"ttl",props:["F","BG","text-align"]}},updateOverlay:mstrmojo.emptyFn,getCacheKey:function Ac(){return this._super()+"-vi-uc";},getPanelForAddAction:function BC(){return"propertiesPanel";},getExcludedPanels:function BU(){return["editPanel"];},titleBarCss:"",orientation:"h",k:"",boxContent:null,parent:null,enabled:true,isUnitContainer:true,draggable:true,ctrlOverlay:null,model:null,title:"",titleBar:null,showTitleBar:false,bubbleMouseOver:true,dimensionsSet:false,getEditOverlayControls:mstrmojo.emptyFn,isNewUnitContainer:true,ghostImgCss:[],splittersInfo:null,resizerInfo:null,splitterCache:null,resizerCache:null,timer:null,shouldShowCustomizeContextMenu:function(Bf){var Bg=Bf.getTarget(),Bh=Bg&&Bg.nodeName.toLowerCase();return Bh&&!(Bh==="textarea"||(Bh==="input"&&Bg.type.toLowerCase()==="text"));},switchToEditMode:function BI(){this.showControlOverlay(this.getEditOverlayControls());},init:function Aq(Bh){this._super(Bh);var Bk=this.id,Bg=this.model,Bj=this.boxContent,Bf;Bg.attachEventListener("viUnitSelected",Bk,function(Bl){this.toggleBoxSelection(Bk===Bl.id);});Bg.attachEventListener("viIconTabClicked",Bk,function(Bm){var Bl=Bg.hgl;if(Bg.getSelectedViUnit()&&Bm.id!=="vi_flt"&&!Bl){X.call(this,Bk===Bg.getSelectedViUnit().id,true,false);}});Bg.attachEventListener("viVizEditorDrag",Bk,function(Bm){var Bl=Bg.hgl;if(Bg.getSelectedViUnit()&&Bm.id!=="vi_flt"&&!Bl){X.call(this,Bk===Bg.getSelectedViUnit().id,false,!Bm.isIn);}});this.addChildren([this.getTitleBarCfg(),{scriptClass:"mstrmojo.Box",cssClass:Ar,alias:"ctrlOverlay",slot:"containerNode",visible:false}],0);Bf=this.titleBar;if(Bf&&Bf.tbToolbar){Bf.tbToolbar.toolbarClicked=function(){Bg.selectVIUnit(Bk);};}this.menuBtnInfo={};this.showTitleBar=!!this.defn.httl;this.draggable=mstrApp.allowWebDashboardDesign();Bj.attachEventListener("toggleCtrlOverlay",this.id,BF);var Bi=Bj.edtModel;if(Bi){Bi.attachEventListener("BEMFormatChange",this.id,"updateGhostImgCss");}},getDocModel:function M(){return this.model;},getBoxBorderWidth:function BB(){var Bf=U.call(this),Bg=Bf&&Bf.border;if(Bg){var Bh=[2,4];if(mstrApp.isSingleTier&&Ai.getOSInfo().name.toLowerCase().indexOf("mac")>=0||mstrApp.isExporting){Bh=[2.66,5.34];}return Bg.indexOf("2pt")>-1?Bh[1]:Bh[0];}return 0;},onFormat:function AJ(){var Bf=this.boxContent;if(Bf.execFormatHandler){Bf.execFormatHandler();return ;}A4.call(this);},showControlOverlay:function H(Bh,Bg){var Bi=this.ctrlOverlay,Bj=Bi.domNode;if(Bj){var Bf=[Ar];Bf.push((this.orientation==="v")?z:K);Bf=Bf.concat(this.ghostImgCss);if(Bg){Bf.push(Bg);}Bj.className=Bf.join(" ");}Bi.set("visible",true);BN(Bi);Bi.addChildren(Bh);},hideControlOverlay:function BG(){var Bf=this.ctrlOverlay;Bf.set("visible",false);BN(Bf);},editingTitleCallback:function I(Bf){var Bg=this.menuBtnInfo;BT.toggleClass(Bg.btn,"editing-title",Bf);},getTitleBarCfg:function Af(){return{scriptClass:"mstrmojo.vi.ui.rw.UnitContainerTitleBar",slot:"titlebarNode",alias:"titleBar",title:this.title,editTitleOnDoubleClick:mstrApp.allowWebDashboardDesign(),beganEditingTitlebar:function Bh(){this.parent.editingTitleCallback(true);},titleEdited:function Bf(){this.parent.editingTitleCallback(false);},close:function(){this.parent.deleteSelf();},getLayoutOffsets:function Bg(){return{h:mstrApp.getThemeProps(mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE.LAYOUT).ucTBLOHeight,w:1};}};},getDisplayName:function Aw(){return this.title;},updateDisplayName:function AV(Bi,Bj,Bf){var Bg=this.model,Bh=this.k;if(Bf){Bg.renameRWUnitTitle(Bi,Bj,Bh,{success:function(Bk){this.set("title",Bk);}.bind(this),failure:function(Bk){mstrmojo.err(Bk);this.set("title",Bj);}.bind(this)});}else{Bg.renameRWUnit(Bi,Bj,Bh,{success:function(){this.set("title",Bi);this.synchronizeEditors();}.bind(this)});}},ontitleChange:function Be(){this.titleBar.set("title",this.title);},oncontextmenu:function A3(Bf){if(mstrApp.isDossier){this.toggleTitleBarButtonCSS(false);}if(mstrApp.isInVFInteractMode||(this.boxContent&&this.boxContent.isCustomSort)){Ai.preventDefault(window,Bf.e);}else{if(this.shouldShowCustomizeContextMenu(Bf)){var Bg=this.addContextMenuItems(new mstrmojo.ui.menus.MenuConfig({position:Ai.getMousePosition(Bf.e,Bf.hWin),isHostedWithin:false}),Bf);Ai.preventDefault(window,Bf.e);if(Bg.hasMenuItems()){this.openPopup(Bg.newInstance());}}}Bf.cancel();},addContextMenuItems:function l(Bi,Bf){var Bh=this.getEditorModel(),Bg;if(Bh.getFormattingToolbar){Bg=function(Bj){var Bk=Bh.getFormattingToolbar(Bj,Bf.getTarget());if(Bk){this.openPopup(Bk);}}.bind(this);}if(!mstrApp.isInVFConfigMode){this.addFormatMenuItem(Bi,Bf,Bg);}return Bi;},addFormatMenuItem:function P(Bh,Bg,Bf){if(!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign()){Bh.addMenuItem(mstrmojo.desc(1918,"Format"),"",function(){this.selectVIUnit();A4.call(this,Bg,Bf);}.bind(this));}return Bh;},updateSelfSplitter:function AE(){if(this.getSplitterHost&&this.calculateContainerRect){this.calculateContainerRect();this.updateSplitters();}},preBoxOp:function BV(){if(this.timer){clearTimeout(this.timer);if(this.originBox){this.parent.snapGuide.boxIntervalOperations([],"delete",this.originBox);this.originBox=null;}this.timer=null;}else{this.parent.snapGuide.boxIntervalOperations(this,"delete");}},postBoxOp:function f(Bj,Bl,Bi){var Bh=this,Bf=this.parent,Bg=this.model;if(Bj){var Bk={execute:function(){Bh.updateLayout(Bi);Bh.updateSelfSplitter();Bf.snapGuide.boxIntervalOperations(Bh,"insert");Bf.saveBoxLayout(this);},urInfo:{extras:mstrmojo.DocDataService.SUPPRESS_DATA}};if(Bl){Bk.undoUIState=Bl;}Bg.execute(Bk);}},toggleGuidesDiv:function BJ(Bh,Bg){var Bf=this.parent&&this.parent.controller&&this.parent.controller.view&&this.parent.controller.view.layoutViewer;if(Bf){if(Bg){Bf.domNode.appendChild(Bh);}else{Bf.domNode.removeChild(Bh);}}},getResizerInfo:function A9(Bg,Bi){if(this.parent){var Bh=this.parent.parentRect,Bj=Bi?this.splitterCache[Bg].getBoundingClientRect():this.resizerCache[Bg].getBoundingClientRect(),Bf=Bj.x,Bk=Bj.y;return{min:{x:Bh.left+4,y:Bh.top+4},max:{x:Bh.right-4,y:Bh.bottom-4},axis:{x:(Bi&&Bg===Aa||!(Bi&&Bg===BY))?Bf:Bf+u,y:(Bi&&(Bg===Aa||Bg===BY))?Bk:Bi?Bk+u:Bk+A8}};}},resizerMouseDown:function AK(Bf){this.preBoxOp();Bf.parentRect=this.parent.parentRect;this.getSplitterHost().appendChild(Bf.boxOverlay);},splitterMouseDown:function Z(){if(this.parent&&this.parent.snapGuide){this.preBoxOp();}},resizerMouseUp:function Ab(Bk,Bi){var Bj=this,Bg=this.parent,Bh=this.model,Bm=Bh.getUIState(),Bf=Bi.parentRect,Bl={left:(Bk.x-Bf.left)+"px",top:(Bk.y-Bf.top)+"px",width:Bk.width,height:Bk.height};this.getSplitterHost().removeChild(Bi.boxOverlay);Bg.boxLayoutConfig.updateFloatLayout(Bl,Bj);this.postBoxOp(true,Bm,Bl);},FixChanged:function BZ(Bf){this.parent.boxLayoutConfig.floatChildren.filter(function(Bg){return Bg.k===this.k;},this)[0].fixed=Bf;},ondragmove:function D(Bh){if(Bh.src.widget&&Bh.src.widget.unDocked&&(Bh.delay=Bh.delay^1)){var Bj=Math.min(Math.max(Bh.last.x,Bh.box.minX),Bh.box.maxX),Bi=Math.min(Math.max(Bh.last.y,Bh.box.minY),Bh.box.maxY),Br=Bh.box.originX+Bj-Bh.box.startX,Bg=Bh.box.originY+Bi-Bh.box.startY;var Bk=Bh.src.widget,Bv=Bk.parent.snapGuide,Bs=Br+Bh.box.minX,Bl=parseFloat(Bk.domNode.style.width),Bn=Bs+(Bl/2),Bp=Bs+Bl,Bo=Bg+Bh.box.minY,Bt=parseFloat(Bk.domNode.style.height),Bm=Bo+(Bt/2),Bu=Bo+Bt,Bw=[Bs,Bp,Bn,Bo,Bu,Bm].reduce(function(By,Bz,Bx){var B0=Bv.findIntersect(Bz,Math.floor(Bx/3)?"y":"x");By.push(B0);return By;},[]);Bw.forEach(function(Bx,By){if(Bx!==null){Bh.highLight.children[By].style.background="#EF3921";Bh.highLight.children[By].style[By>2?"top":"left"]=Bw[By].mid+"px";}else{Bh.highLight.children[By].style.background="";}});var Bq=Bv.findCloset({interval:Bw[0],point:Bs},{interval:Bw[1],point:Bp}),Bf=Bv.findCloset({interval:Bw[3],point:Bo},{interval:Bw[4],point:Bu});if(Bq){Bk.domNode.style.left=(Bq>0?Bw[0].mid-Bh.box.parentRect.left:Bw[1].mid-Bh.box.parentRect.left-Bl)+"px";}else{Bk.domNode.style.left=Br+"px";}if(!Bq&&Bw[2]!==null){Bk.domNode.style.left=(Bw[2].mid-Bh.box.parentRect.left-Bl/2)+"px";}if(Bf){Bk.domNode.style.top=(Bf>0?Bw[3].mid-Bh.box.parentRect.top:Bw[4].mid-Bh.box.parentRect.top-Bt)+"px";}else{Bk.domNode.style.top=Bg+"px";}if(!Bf&&Bw[5]!==null){Bk.domNode.style.top=Bw[5].mid-Bh.box.parentRect.top-Bt/2+"px";}}},getSplitterHost:function BQ(){return this.splitterHostNode;},getSplitterInfo:function J(Bi){if(this.parent){var Bf=this.parent.parentRect,Bg=this.domNode.getBoundingClientRect(),Bh=Bi.orientation;return{splitter:Bi,min:Bh&2?4:Bh%2?Bf.top-Bg.top+10:Bf.left-Bg.left+10,max:Bh&2?Bh%2?Bf.bottom-Bg.top-10:Bf.right-Bg.left-10:Bh%2?Bg.height:Bg.width};}},getNewNode:function W(Bf,Bg){var Bh=document.createElement("div");Bh.setAttribute("unselectable","on");Bh.className=Bf;Bh.setAttribute("pos",Bg%4);return Bh;},calculateContainerRect:function O(){if(!this.domNode){return ;}var Bf=this,Bg=this.getSplitterHost().getBoundingClientRect();["left","top","right","bottom"].forEach(function(Bh,Bi){(Bf.splittersInfo=Bf.splittersInfo||[]).push({left:(Bi%2?Bg.left:Bg[Bh]-3.5)+"px",top:(Bi%2?Bg[Bh]-3.5:Bg.top)+"px",width:(Bi%2?Bg.width:7)+"px",height:(Bi%2?7:Bg.height)+"px"});(Bf.resizerInfo=Bf.resizerInfo||[]).push({left:((Bi===0||Bi===3)?Bg.left:(Bg.right-5))+"px",top:(Bi&2?Bg.bottom-5:Bg.top-5)+"px",width:"7px",height:"7px"});});},updateSplitters:function BR(){if(!this.splittersInfo){return ;}var Bi=this.splitterCache=this.splitterCache||[],Bj=this.resizerCache=this.resizerCache||[],Bh=this.splittersInfo,Bg=this.resizerInfo,Bk=this.getSplitterHost(),Bf=this.getSplitterHost().getBoundingClientRect();if(Bk){[].concat(Bh,Bg).forEach(function(Bp,Bn){var Bm=Bn&1<<2?"resizer":"edge",Bl=Bm==="resizer"?"resizer":"splitter",Bq=this[Bl+"Cache"]||[],Bo=Bq[Bn%4];if(!Bo){Bq[Bn%4]=Bo=this.getNewNode(Bm,Bn);if(Bm==="edge"){Bo.style.position="absolute";Bo.isV=false;if(!(Bn%2)){BT.addClass(Bo,["v"]);Bo.isV=true;}Bo.style.cursor=(Bn%2?"ns":"ew")+"-resize";Bo.isSide=true;this.registerResizerHandler(Bo);}else{Bo.style.position="absolute";Bo.style.cursor=(Bn&2?"s":"n")+(Bn===4||Bn===7?"w":"e")+"-resize";this.registerResizerHandler(Bo);}if(!Bo.parentNode){Bk.appendChild(Bo);}}Bp.left=(parseFloat(Bp.left)-Bf.left)+"px";Bp.top=(parseFloat(Bp.top)-Bf.top)+"px";g.copy(Bp,Bo.style);Bo.style.display=(this.unDocked&&!mstrApp.isAppStatePresentation())?"block":"none";Bo.style.zIndex=this.unDocked?this.zIndex:A5;},this);this.splittersInfo=this.resizerInfo=null;}},splitterMoved:function Ak(Bx,Bw){var Bn=this,Bf=Bw&&Bw.splitter,Bo=mstrmojo.all[this.model.id].getPanel(),Bv=this.model.getUIState(),Bl=Bo.boxLayoutConfig,Bq=Bl.box.floatChildren,Br=Bf.orientation;if(Bf){if(Bl&&Bl.findFloatKey(this)){var Bh=Br%2?"height":"width",Bk=c.find(Bq,"k",this.k);if(Bk!==-1){var Bj=Bq[Bk],Bu=Bl.getBoxTreeRoots(Bo,Bj.rk),Bm=Bu[Bh],Bt=Bx/Bm*100,Bs=Bj[Bh].split("|"),Bi=parseFloat(Bs[0]),Bg=parseFloat(Bs[1]);Bj[Bh]=Br&2?(Bi+Bt)+"|"+(Bg+Bx):(Bi-Bt)+"|"+(Bg-Bx);if(!(Br&2)){var Bp=Br?"top":"left";Bs=Bj[Bp].split("|");Bi=parseFloat(Bs[0]);Bg=parseFloat(Bs[1]);Bj[Bp]=(Bi+Bt)+"|"+(Bg+Bx)+"px";}Bl.updateNodeInBoxTree(Bn);this.postBoxOp(true,Bv,Bo.calculateFloatBoxLayout(Bj,Bu,Bn.fixed));}}else{this.updateSplitters();}}},toggleDock:function Ad(){this.unDocked=!this.unDocked;if(!this.unDocked){this.set("zIndex",1);}},addUnDockMenuItem:function An(Bl){if(!mstrApp.isLayoutModePreview()&&!(mstrApp.isInVFConfigMode||mstrApp.isInVFInteractMode)){var Bj=this.k,Bf=this.parent;if(!this.unDocked){}else{if(Bf.boxOperation){var Bk=Bf.boxLayoutConfig.findIdx(Bf.getUnitByKey(Bj));var Bi=[[true,true],[true,true]];if(Bk.index===0){Bi[1]=[false,false];}if(Bk.index===Bk.maxIndex){Bi[0]=[false,false];}var Bh=Bi.reduce(function(Bn,Bo){return Bn.concat(Bo);});var Bg=[{strId:3100,fn:"bringToFront"},{strId:3102,fn:"bringForward"},{strId:3099,fn:"sendToBack"},{strId:3101,fn:"sendBackward"}],Bm="";c.forEach(Bg,function(Bo,Bn){Bm=mstrmojo.desc(Bo.strId,Bo.fn);if(Bh[Bn]){Bl.addMenuItem(Bm,"",function(){Bf.boxOperation(Bo.fn,Bf.getUnitByKey(Bj));});}else{Bl.addDisabledMenuItem(Bm,"");}});}}}return Bl;},unrender:function AY(){this.splitterCache=null;this.resizerCache=null;return this._super();},getFormatMenuItemTarget:function AG(Bf){return mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE;},applyBoxSize:function n(Bf,Bh,Bk,Bj){this._super(Bf,Bh,Bk,Bj);this.dimensionsSet=true;var Bi=parseInt(Bh,10),Bl=parseInt(Bf,10);var Bg=Bi>Bl?"h":"v";if(Bg!==this.orientation){this.set("orientation",Bg);}this.set("ghostImgCss",BS.call(this,Bi,Bl));},childRenderCheck:function Av(Bg){var Bf=this._super(Bg);if(Bg===this.boxContent){Bf=Bf&&this.dimensionsSet;}return Bf;},postUpdateLayout:function AM(){var Bh=this.boxContent;if(!this.domNode){return ;}if(!Bh.hasRendered){Bh.render();var Bf=this.model.getLatestSelectedViUnitKey(),Bg=Bf&&this.parent.getUnitByKey(Bf);if(Bg){this.model.selectVIUnit(Bg.id);}else{this.parent.selectFirstBox();}}else{this.updateVisFilterIndicator();Bh.refresh(null,!mstrApp.isPartialUpdate);}this.isNewUnitContainer=false;},orientationHasChanged:mstrmojo.emptyFn,onRender:function A0(){this._super();var Bf=this.model.getSelectedViUnit();this.toggleBoxSelection(Bf&&Bf.k===this.k);},onAppStateChange:function Ay(Bn){var Bi=mstrmojo.vi.VisualInsightApp.APP_STATES,Bm=Bi.SELECTOR_TARGETING,Bk=Bi.PRESENTATION,Bo=Bi.PAUSE,Bl=mstrApp.isAppStatePresentation(),Bh=mstrApp.isAppStatePause(),Bj=this.dragIcon;if(Bl||Bn.valueWas&Bk){this.draggable=!(Bl||mstrApp.isLayoutModePreview());this.generateToolbar();}if(Bn.valueWas&Bm||mstrApp.isAppStateSelection()||Bh||Bn.valueWas&Bo){this.generateToolbar();}var Bf=this.model.getSelectedViUnit(),Bg=Bf&&Bf.k===this.k;this.toggleBoxSelection(Bg);if(Bj){AZ(Bj,!Bl&&Bg&&!this.getTitleBarVisibility());}},onLayoutModeChange:function F(Bf){var Bg=mstrApp.isLayoutPreview(Bf.value);if(Bg||mstrApp.isLayoutPreview(Bf.valueWas)){this.draggable=!(mstrApp.isAppStatePresentation()||Bg);this.generateToolbar();}},selectVIUnit:function d(Bf){var Bg=this.parent;if(this.enabled&&Bg&&Bg.selectVIUnit&&!(mstrApp.isAppStateSelection()&&mstrApp.isLayoutModePreview())){this.toggleBoxSelection(this.parent.selectVIUnit(this,Bf));}},synchronizeEditors:function AP(){if(this.model.getLatestSelectedViUnitKey()===this.k){this.selectVIUnit(true);}},addToggleTitleMenuItem:function S(Bf){var Bg=[BD,BW];if(!this.showTitleBar){Bg.reverse();}Bf.addDualStateItem(this.id,Bg[0],Bg[1]);},canShowDesignMenuItems:function AC(){return mstrApp.allowWebDashboardDesign();},updateToolbar:function w(Bf){var Bg=Bf.ENUM_CORNERS,Bh=this.boxContent,Bj=Bh&&Bh.node,Bi=Bj&&(!Bj.defn.vis||!Bj.defn.vis.ve);Bf.setAlignment(Bg.BOTTOM_RIGHT,Bg.TOP_RIGHT);Bf.isHostedWithin=false;Bf.showContextMenu=false;if(this.canShowDesignMenuItems()&&!mstrApp.isAppStatePresentation()){Bf.addSeparator();if(!(mstrApp.isInVFConfigMode&&!Bi)){this.addFormatMenuItem(Bf);}if(this.showTitleBar){Bf.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){this.draggable=false;this.titleBar.editTitle();}.bind(this));}if(undefined!==this.getEditOverlayControls()){Bf.addMenuItem(mstrmojo.desc(3272,"Edit"),"cls",this.switchToEditMode.bind(this));}this.addDeleteMenuItem(Bf);this.addUnDockMenuItem(Bf);}return Bf;},addDeleteMenuItem:function A7(Bg){if(!mstrApp.isLayoutModePreview()&&!(mstrApp.isInVFConfigMode||mstrApp.isInVFInteractMode)){var Bf=this.k,Bh=this.model.id;Bg.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){BM(Bh,Bf).deleteSelf();});}return Bg;},deleteSelf:function Ao(Bs){var Br,Bk=this.k,Bg=this.model,Bq=Bg.id,Bu=Bg.data,Bo=BM(Bq,Bk).parent,Bp=Bo.k,Bt=[Bp],Bf=[],Bm=function(Bv){return Bv.sections||Bv.subsections||Bv.objects||Bv.panels||Bv.layouts||Bv.children;},Bh=function(By,Bx){var Bw=Bm(By),Bv;for(Bv=0;Bw&&(Bv<Bw.length);Bv++){if((Bw[Bv]&&Bw[Bv].k)===Bx){c.removeIndices(Bw,Bv,1);return ;}else{Bh(Bw[Bv],Bx);}}},Bj=Bg.getRebuildCallback(),Bi=function(Bz){var Bx=BM(Bq,Bk),By=mstrmojo.all[Bq],B0=By.getCurrentLayoutDef(),Bw=(B0&&B0.units)||{},Bv=Bw[Bk];if(Bx){if(Bz){Bx.defn._isDeleted=true;}else{delete Bx.defn._isDeleted;}}if(Bv){if(Bz){Bv._isDeleted=true;}else{delete Bv._isDeleted;}}By.syncLayerDefn(Bk,Br,Bz);};Bf=Bf.concat(Bg.getSourceFilterKeys(Bk,true));Bf=Bf.concat(Bg.getTargetFilterKeys(this));this.model.execute({execute:function(){var Bw=BM(Bq,Bk);if(Bw){var Bv=Bw.parent,Bx=mstrmojo.all[Bq],B0=Bx.getDataService().newUpdate();var By=Bv.hasMultipleChildren();B0.addUpdate(Bw.createDeleteUpdate());Br=Bx.getMapLayerKeys(Bw.boxContent);B0.addActions(Bx.getDeleteMapLayersActions(Br));B0.addCallbacks({success:function Bz(B1){Bx.partialUpdate(B1.data,Bx.getTargetDefn(Bf),B1.defn,Bf);Bh(Bu,Bk);Bx.deleteDataCache(Bw.boxContent&&Bw.boxContent.id);Bw.defn._isDeleted=true;Bx.syncLayerDefn(Bk,Br,true);Bw.destroy();}});Bv.deleteBoxAndSubmitDeferred(B0,Bw,null,true);if(!By){Bx.addVisualizationDeferred(B0,Bv.k);}Bv.selectFirstBox();B0.addCallbacks(Bs);B0.addExtras({style:{params:{treesToRender:0}}});this.submitUpdate(B0);}},urInfo:{undo:function Bn(){Bi(false);},redo:function Bl(){Bi(true);},puKeys:Bt,extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA,callback:Bj}});},undoInsert:function A2(){var Bf=this.parent,Bg=mstrmojo.all[this.model.id];Bf.deleteBoxAndSubmitDeferred(Bg.getDataService().newUpdate(),this,null,true);Bf.selectFirstBox();this.destroy();},createDeleteUpdate:function AH(){},getTitleBarVisibility:function b(){return this.titleBar&&this.showTitleBar;},setTitleBarVisibility:function AD(Bf){var Bh=this.titleBar;Bh.set("visible",Bf);var Bj=this.menuBtnInfo,Bg=Bj&&Bj.btn;if(Bj){if(!Bj.menuCfg){Bj.menuCfg=Bh.getMenuConfig();}if(mstrApp&&mstrApp.isInVFInteractMode){Bj.menuCfg=null;}if(!Bg){Bg=Bj.btn=document.createElement("div");Bg.className="hover-menu-btn";Bg.setAttribute("tabindex","0");Bg.setAttribute("role","button");var Bk="Menu for "+this.title;Bg.setAttribute("aria-label",Bk);var Bl=this.id;var Bi=function(Bo){var Bn=mstrmojo.all[Bl],Bm=Bj.menuCfg;Bm.hostId=Bl;Bm.hostElement=Bg;Bm.supportsScroll=true;Bm.isHostedWithin=false;Bm.maxHeight=Ai.getMaxScrollHeight();Bm.hasAccessibility=Bn.boxContent.hasAccessibility;var Bp=mstrmojo.ui.menus.Menu;if(Bm.hasAccessibility){Bp=mstrmojo.DynamicClassFactory.newComponent(Bp,[mstrmojo._IsAccessibleMenu]);Bn.boxContent.isMenuClicked=true;}var Bq=new Bp({popupConfig:Bm});if(Bm.hasAccessibility){Bq.onCloseMenuCallBack=Bn.onMenuClose;}Bn.openPopup(Bq);if(Bo.type==="contextmenu"){Bo.stopPropagation();}Bo.preventDefault();};Ai.attachEvent(Bg,"click",Bi);Ai.attachEvent(Bg,"contextmenu",Bi);Ai.attachEvent(Bg,"keydown",function(Bm){var Bo=Ai.findWidget(this),Bn=Bo.boxContent&&Bo.boxContent.hasAccessibility;if(Bn&&Bm.keyCode===13){Bi(Bm);}});}this.domNode.appendChild(Bg);}AF.call(this);this.doLayout();},refresh:function BE(){delete this._currentLayout;if(!this.parent.boxLayoutConfig.dirty){this._super();if(this.hasRendered&&this.parent.isManualMode()){this.updateSelfSplitter();}}else{N.call(this,false,this.getFormats());N.call(this,true,this.getFormats());}},addFormatProps:function h(Bg,Bf){return Bg;},onclick:function Ah(Bf){Bf.e.justSwitched=this.k!==this.getDocModel().getLatestSelectedViUnitKey();this.selectVIUnit();if(!Bf.e.ptvSelected&&this.switchPropertyOnClick(Bf)){this.boxContent.edtModel.selectTargetByValue(mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE);}},switchPropertyOnClick:function Ap(){var Bf=this.boxContent.edtModel;return !!(Bf&&Bf.selectTargetByValue);},getZonesModel:function A6(){return null;},getEditorModel:function Bb(){return this.boxContent.edtModel;},onmouseenter:function Au(){var Bg=this.menuBtnInfo,Bf=this.dragIcon;if(Bg&&Bg.menuCfg){BT.addClass(Bg.btn,Ae);BT.removeClass(Bg.btn,q);}if(Bf&&!this.showTitleBar&&!mstrApp.isAppStatePresentation()){AZ(Bf,true);}},onmouseleave:function Bd(){var Bg=this.menuBtnInfo,Bf=this.dragIcon;if(Bg&&Bg.menuCfg){BT.addClass(Bg.btn,q);BT.removeClass(Bg.btn,Ae);}if(Bf&&this.model._latestSelectedViUnitKey!==this.k&&!this.showTitleBar&&!mstrApp.isAppStatePresentation()){AZ(Bf,false);}},onfocusin:function At(){var Bg=Ai.findWidget(this),Bf=Bg&&Bg.boxContent&&Bg.boxContent.hasAccessibility;if(Bf){Bg.toggleTitleBarButtonCSS(true);}},onMenuClose:function x(){var Bh=window.event,Bi=Bh&&Bh.currentTarget;if(Bi&&Bi.tagName==="BODY"){var Bg=this.opener&&this.opener.containerNode,Bf=Bg&&Ai.findWidget(Bg);if(Bf&&Bf.toggleTitleBarButtonCSS){Bf.toggleTitleBarButtonCSS(false);}}},onfocusout:function AB(){var Bk=Ai.findWidget(this),Bh=Bk&&Bk.boxContent&&Bk.boxContent.hasAccessibility,Bi=window.event;if(Bh){var Bg=Ai.findWidget(Bi.currentTarget),Bj=Ai.findWidget(Bi.relatedTarget),Bf;if(Bj&&(Bj.isUnitContainer||Bj.parent)){Bf=Bj.isUnitContainer?Bj:Bj.parent.parent;}if(Bg&&Bf&&Bg.isUnitContainer&&Bf.isUnitContainer&&Bg!==Bf){Bg.toggleTitleBarButtonCSS(false);Bf.toggleTitleBarButtonCSS(true);}else{if(Bg&&Bg.isUnitContainer&&!Bj){Bg.toggleTitleBarButtonCSS(false);}}}},toggleTitleBarButtonCSS:function AX(Bi){var Bh=this.menuBtnInfo,Bf=this.filterBtnNode&&this.filterMenuCfg,Bg=this.maxRestoreBtnNode;if(Bh&&Bh.menuCfg){BT.toggleClass(Bh.btn,AA,Bi);}if(Bf){BT.toggleClass(this.filterBtnNode,AA,Bi);}if(Bg){BT.toggleClass(Bg,AA,Bi);}},onmouseover:function L(Bf){if(!mstrApp.isInteractive()){return ;}if(!this.bubbleMouseOver){Bf.cancel();}var Bg=this._panelTimeout;if(Bg){window.clearTimeout(Bg);delete this._panelTimeout;}if(this.titleBar.visible&&!mstrApp.isAppStateSelection()){this.titleBar.setToolbarVisibility(true);}},onmouseout:function AN(){var Bf=this.id;this._panelTimeout=window.setTimeout(function(){var Bg=mstrmojo.all[Bf];if(Bg){Bg.titleBar.setToolbarVisibility(false);}},200);},menuDisplayCallback:function Q(Bg){var Bf=this.menuBtnInfo;BT.toggleClass(Bf.btn,Ae,Bg);BT.toggleClass(Bf.btn,q,!Bg);},onmousemove:function Ag(){var Bf=this,Bg=Bf.menuBtnInfo;if(Bf.titleBar&&!Bf.titleBar.visible&&Bg&&Bg.menuCfg){if(!!Bf.mouseMovingTimer){clearTimeout(Bf.menuDisplayTimeout);}Bf.mouseMovingTimer=setTimeout(function(){clearTimeout(Bf.menuDisplayDelay);Bf.menuDisplayDelay=null;clearTimeout(Bf.menuDisplayTimeout);Bf.menuDisplayTimeout=setTimeout(function(){Bf.menuDisplayCallback(false);},1500);},100);if(!Bf.menuDisplayDelay){Bf.menuDisplayDelay=setTimeout(function(){Bf.menuDisplayCallback(true);},500);}}},isDragValid:function AW(Bg){var Bi=Bg.src.node,Bf=Bi.tagName,Bh=Bi.getAttribute("class");Bf=(Bf&&Bf.toLowerCase())||"";Bh=(Bh&&Bh.toLowerCase())||"";if(Bf==="input"||Bf==="textarea"||Bh.indexOf("hover-menu-btn")>-1||Bh.indexOf("icn")>-1||Bh.indexOf("edge")>-1||Bh.indexOf("resizer")>-1){return false;}return this.unDocked&&this.parent.hasMultipleFloatChildren()||this.parent.hasMultipleChildren();},initializeDrag:function AR(){if(this._super()!==false){this.selectVIUnit();}},getTargetDropZone:function AQ(Bf){if(Al.call(this,Bf)||AU.call(this,Bf)){return"";}return this._super(Bf);},allowDrop:function C(Bf){var Bh=Bf.src,Bg=Bh&&Bh.widget;if(Bg&&Bg===this){return false;}if(AI.call(this,Bf)&&this.allowDropFromFilter(Bf)){return true;}if(Al.call(this,Bf)&&this.allowDropFromDataset(Bf)){return true;}if(AU.call(this,Bf)&&this.allowDropFromAllObjectsBrowser(Bf)){return true;}return this._super(Bf);},allowDropFromFilter:function BL(Bf){var Bh=Bf&&Bf.src,Bg=Bh&&Bh.widget;return mstrApp.allowWebDashboardDesign()&&!(Bg&&Bg.isVisFilter());},allowDropFromDataset:function Az(Bf){return false;},allowDropFromAllObjectsBrowser:function V(Bf){return this.allowDropFromDataset(Bf);},close:function(){this.parent.deleteBoxAndSubmit(this);this.parent.removeChildren(this);mstrApp.rootCtrl.generateToolbar();this.destroy();},createAvatar:function Y(){this.domNode.style.zIndex="-1";var Bf=document.createElement("div");Bf.className=this.getAvatarCls().join(" ");Bf.textContent=this.getDisplayName();return this.offsetAvatar(Bf);},ondragend:function e(Bg){this.domNode.style.zIndex=Bg.floatIndex?Bg.floatIndex:A5;var Bf=this.parent;if(Bf&&Bf.isManualMode()){Bf.buildBoxLayout();}this._super(Bg);},wasDropped:function s(Bf){this.domNode.style.zIndex=A5;this._super(Bf);},ondrop:function A(Bf){var Bh=AI.call(this,Bf),Bg=this.maskNode.zone,Bj,Bn=this.getDocModel(),Bm=this;if(Bh){Bj=Bf.src.widget.selector.node;}this._super(Bf);if(Al.call(this,Bf)){Bn.selectVIUnit(this.id);this.dropFromDataset(Bf);}if(AU.call(this,Bf)){var Bk=Bf.src.widget,Bi=Bk&&Bk.dataProvider;if(Bi){Bi.loadObjects(Bf.getCtxtDragData().items,{success:function(){Bm.dropFromAllObjects(Bf);}});}}if(Bh){var Bl=this;if(!Bg){Bg=this.parent.getPanelTargetEdge(Bf);if(Bg){Bl=null;}}this.model.insertExistingFilter(Bj,Bl,Bg);}},postDropBox:function BK(){this.domNode.style.zIndex=A5;},rebuildBoxContent:function AS(Bf){var Bh=this.boxContent,Bg=this.parent;this.removeChildren(Bh);Bh.destroy();if(Bf){Bh=Bg.builder.build([Bf],this.model,{pk:Bg.k})[0].boxContent;}else{Bh=this.model.rebuildUnitFromDataCache(Bh.id,Bg.k,Bg.builder).boxContent;}this.addChildren([Bh]);},dropFromDataset:mstrmojo.emptyFn,dropFromAllObjects:mstrmojo.emptyFn,generateToolbar:function E(){var Bf=this.titleBar,Bg=Bf.toolbarCfg,Bh=this.menuBtnInfo;if(Bh){if(Bg){Bg.destroy();}if(Bh.menuCfg&&Bh.menuCfg.destroy){Bh.menuCfg.destroy();}if(mstrApp&&mstrApp.isInVFInteractMode||mstrApp.isAppStateSelection()){Bh.menuCfg=null;}else{Bf.set("toolbarCfg",this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));Bh.menuCfg=Bf.getMenuConfig();}}if(this.hasRendered){AF.call(this);}},getTitleVisibilityFmts:function k(Bf){return{FormattingView:{ShowTitleBar:Bf}};},toggleTitleBar:function Aj(Bg){var Bl=this.boxContent.id,Bj=this.model,Bk=function Bk(Bm){var Bo=mstrmojo.all[Bl],Bn=Bo.parent;clearTimeout(Bn.mouseMovingTimer);clearTimeout(Bn.menuDisplayTimeout);clearTimeout(Bn.menuDisplayDelay);Bn.setTitleBarVisibility(Bm);Bn.parent.selectVIUnit(Bn,true);Bn.applyBoxSize(Bn.height,Bn.width,Bn.top,Bn.left);Bn.showTitleBar=Bm;Bn.generateToolbar();Bo.refresh(null,true);},Bf=this.id;Bk(Bg);Bj.controller.cmdMgr.execute({execute:function(){var Bm=mstrmojo.all[Bl].parent;this.submit([Bj.getUnitFormatAction(Bm,Bm.defn.t===mstrmojo.EnumRWUnitType.SELECTOR?5:1,Bm.getTitleVisibilityFmts(Bg?1:0),true)],{success:function Bo(){mstrmojo.all[Bf].defn.httl=Bg;},failure:function Bn(){Bk(!Bg);}},mstrmojo.DocDataService.RAPID_EXEC);Bk(Bg);},urInfo:{silent:true,undo:function Bh(){Bk(!Bg);},redo:function Bi(){Bk(Bg);}}});},getFormats:function Am(){var Bf=this.boxContent;if(Bf){return Bf.getFormats();}return null;},clearFormats:function R(){var Bf=this.boxContent;if(Bf&&Bf.clearFormats){Bf.clearFormats();}},preBuildRendering:function m(){var Bf=this.boxContent;if(Bf){Bf.attachEventListener("regenerateToolbar",this.id,"generateToolbar");}if(this.parent&&this.parent.boxLayoutConfig&&this.parent.boxLayoutConfig.box.children){if(this.parent.boxLayoutConfig.findFloatKey(this)){this.unDocked=true;}}this.generateToolbar();return this._super();},postBuildRendering:function Ba(){var Bf=this.showTitleBar;this.setTitleBarVisibility(Bf);if((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview())){this.draggable=false;}this._super();this.titleBar.setToolbarVisibility(false);this.applyBoxSize(this.height,this.width,this.top,this.left);this.updateSplitters();if(!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode){this.dragIcon=B.call(this,this.dragIcon);}return true;},changeUnitFormats:function BO(Bi,Bl,Bp,Bn,Bh,Bf,Bj,Bm){var Bk=function(Bu){if(Bj){Bu=Bj(Bu);}t.updateFormatBlock(Bi?Bp.ttl:Bp,Bn,Bu);var Bs=this.parent?this:this.model.getSelectedViUnit();N.call(Bs,Bi,Bp);var Bt=this.boxContent;if(!Bt.excludeData){if(!Bi&&Bt.restylePlotly){Bt.restylePlotly(Bp);}}if(Bm){Bm(Bu);}Bs.synchronizeEditors();if(Bi&&Bn===o.FONT_SIZE){Bs.doLayout();Bs.postUpdateLayout();}},Bo=function(Bu){var Bt,Bs=this.model.currlaykey;Bt=c.filterOne(Bu.defn.layouts,function(Bv){return(Bv.k===Bs&&Bv.loaded);});Bp.border=Bt.units[this.k].fmts.border;},Bq={success:Bk.bind(this,Bh)};var Br="none",Bg=mstrmojo.DocDataService.SUPPRESS_DATA;if(Bn===o.BORDER_STYLE&&Bf===Br){Bg=mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION;Bq=mstrmojo.func.wrapMethods({success:Bo.bind(this)},Bq);}this.model.saveUnitFormatProperty(this,[{formatType:Bl,propertyName:Bn,newValue:Bh,oldValue:Bf}],Bq,Bg,{silent:true,undo:Bk.bind(this,Bf),redo:Bk.bind(this,Bh)});},redraw:function AO(){if(this.boxContent.redraw()===true){return true;}return this._super();},getAvatarCls:function Ax(){return["mstrmojo-VIUnit-avatar","icn-avi",mstrApp.getThemeClassName()];},addDragHandle:function AL(){var Bf=document.createElement("div");Bf.className="uc-drag-handle";this.domNode.appendChild(Bf);},toggleDragHandleVisibility:function BH(Bf){BT.toggleClass(this.domNode,"no-handler",!Bf);},toggleBoxSelection:function As(Bg){if(mstrApp.isInVFInteractMode){return ;}var Bh=mstrApp.isAppStatePresentation(),Bf=mstrApp.isAppStatePrintPreview(),Bj=this.domNode,Bi=this.dragIcon;BT.toggleClass(Bj,"selected",Bg&&!(Bh||Bf));if(Bi&&!this.showTitleBar&&!mstrApp.isAppStatePresentation()){AZ(Bi,Bg);}},updateGhostImgCss:function y(Bf){if(Bf.propertyName===o.BACKGROUND_COLOR&&!Bf.isTitle){var Bg=this.ghostImgCss||[];Bg=c.filter(Bg,function(Bh){return j.indexOf(Bh)===-1;});Bg=Bg.concat(A1(Bf.value));this.set("ghostImgCss",Bg);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.css","mstrmojo.AjaxCall","mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.Label","mstrmojo.ListBase","mstrmojo.ui.CheckList","mstrmojo.ui.ColumnContainer","mstrmojo.rw.ConditionWalkProviderBase","mstrmojo.elementHelper");var G=mstrmojo.css,X=mstrmojo.hash,s=mstrmojo.array,W=mstrmojo.expr,M=W.ET,Z=W.ET2TGT,Y=W.FN,S=W.FN_MRP,m=W.DTP2FN_DTP,E=mstrmojo.meta.TP,AA=W.TP,J=W.STP,k=mstrmojo.elementHelper,p=mstrmojo.rw.ConditionWalkProviderBase;var P={};P[M.AQ]={target:1,fm:1,fn:1,c0:1,c1:1};P[M.AL]={target:1,fm:1,fn:1,c0:1};P[M.AE]={target:1,fm:1,es:1};P[M.AC]={target:1,fm:1,fm2:1,fm3:1,fn:1,c0:1,c1:1};P[M.MQ]={target:1,fn:1,c0:1,c1:1,dmy:1};P[M.MC]=P[M.MQ];P["*"]={target:1};var w={};w[M.MQ]={key:"metricFns",def:W.METRIC_FNS};w[M.MC]={key:"metricFns",def:W.METRIC_FNS};w[M.AQ]={key:"formFns",def:W.FORM_FNS};w[M.AL]={key:"formFns",def:W.FORM_FNS};w[M.AC]={key:"formFns",def:W.FORM_FNS};w[M.AE]={key:"elemFns",def:W.ELEM_FNS};var AF=mstrmojo.desc(14084,"Select a filter option or a qualification."),AE=mstrmojo.desc(15007,"Choose to select in list or qualify on an attribute form."),AD=mstrmojo.desc(14085,"Select one or more elements."),N=mstrmojo.desc(15009,"Select element(s)."),AC=mstrmojo.desc(14086,"Select an operator."),AB=mstrmojo.desc(14087,"Enter a value or select an attribute from the list."),C=mstrmojo.desc(15010,"Enter a specific value or select an attribute form as variable."),z=mstrmojo.desc(14088,"Select an attribute form. When done, click ## button.").replace("##",'"√"'),y=mstrmojo.desc(14089,"Select a condition."),AH=mstrmojo.desc(15011,"Select an operator."),x=mstrmojo.desc(14090,"Enter a value or select a metric from the list."),R=mstrmojo.desc(15012,"Enter a specific value or select a metric as variable.");var j=0,q=1;var H=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;var e="dummy",I={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:e,css:"unselectable"},o={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:e,css:"unselectable"},AG={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:e,css:"unselectable"},u={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:e,css:"unselectable"},D={did:"idWait",v:"idQualification",n:mstrmojo.desc(15008,"Qualify on"),t:e,css:"unselectable"};var b=p.onWalkChange,F=p.replaceItem,L=p.getChildJSON,t=p.walkChildPostCreateFn,n=p.updateList,AL=p.fnItem,AK=p.isComparisonAllowed,h=p.cstJson,f=p.fmJson,d=p.updateListMulti,l=p.updateListMultiData;function i(AM){return AM.targets?s.filter(AM.targets,function(AN){return AN[E]===W.TP.ATTR;}):[];}function K(AM){this.tip.set("text",AM);}var V=[W.STP.PROMPT,W.STP.PROMPT_OBJECTS,W.STP.PROMPT_ELEMENTS,W.STP.PROMPT_EXPRESSION,W.STP.PROMPT_EXPRESSION_DRAFT];var AJ=p.allowedTargetTypes;mstrmojo.rw.ConditionWalkProvider=mstrmojo.declare(mstrmojo.rw.ConditionWalkProviderBase,null,{scriptClass:"mstrmojo.rw.ConditionWalkProvider",browseEs:function c(AP,AO,AR){AP.openPopup("eb",{zIndex:AP.parent.zIndex+10,left:Math.round(AR.x)+"px",top:Math.round(AR.y)+"px"});var AN=AP.eb.browser,AM=AP.model,AQ=AM&&AM.a&&AM.a.did;if(!AQ){return ;}AN.set("attributeID",AQ);AN.set("selectedItems",AM.es?X.clone(AM.es):[]);AN.initBrowser();},browseObjs:function AI(AT,AM,AN){AT.openPopup("ob",{zIndex:AT.parent.zIndex+10,left:Math.round(AN.x)+"px",top:Math.round(AN.y)+"px"});var AO=AT.ob.browser;AO.target=AM;var AP;switch(AM.alias){case"dmy":AP=[W.TP.ATTR,W.TP.DIM];break;case"c0":case"c1":var AR=AT.model,AQ=AR&&AR.et,AU=AR&&AR.fm,AS=AU&&AU.dtp||(AR.m?W.DTP.DECIMAL:W.DTP.UNKNOWN);AP=(AQ===M.MQ||AQ===M.MC)?[W.TP.METRIC,W.DTP2PROMPT_STP[AS]]:[W.TP.ATTR,W.DTP2PROMPT_STP[AS]];break;default:AP=AJ(AT.ets);AP=AP?X.keyarray(AP,true):[W.TP.ATTR,W.TP.METRIC,W.STP.REPORT_GRID,W.STP.REPORT_GRAPH,W.STP.REPORT_ENGINE,W.STP.REPORT_TEXT,W.STP.REPORT_DATAMART,W.STP.REPORT_BASE,W.STP.REPORT_GRIDGRAPH,W.STP.REPORT_NONINTERACTIVE,W.STP.FILTER].concat(V);}AP[AP.length]=W.TP.FOLDER;AO.browse({rootFolderType:AR&&(AR.et===M.MQ||AR.et===M.MC)?5:26,folderLinksContextId:33,onSelectCB:[AT,"onOBSelect"],browsableTypes:AP.join(",")});},getFm2NodeProps:function U(){return{alias:"fm2",children:[f({alias:"fm2",fmPost:2})],updateColumnContainer:function AM(){var AN=this.parent.parent;if(this.domNode){G.addClass(this.domNode,"lastStage");}this.fm2.update();K.call(AN,z);H.call(this);}};},getC0NodeProps:function Q(){var AM=this;return{alias:"c0",c1Selected:false,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},h({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},h({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false}],updateColumnContainer:function AN(){this.c0.update();var AX=this.parent,AT=AX.parent,AS=AX.parent.model,AV=AS&&AS.fn,AP=AV===Y.BETWEEN||AV===Y.NOT_BETWEEN||AV===S.BETWEEN||AV===S.BETWEEN_DESCENDING,AU=AV===Y.EQUAL||AV===Y.NOT_EQUAL||AV===Y.GREATER||AV===Y.GREATER_EQUAL||AV===Y.LESS||AV===Y.LESS_EQUAL,AW=this.idx,AR=this.next;this.browseLink.set("visible",AT.objectBrowsingEnabled&&AK(AS,AT.ets));this.btwn.set("visible",AP);this.c1.set("visible",AP);if(AP){this.c1.update();}else{AS.edit("c1",{v:null,dtp:null,skipET:true},true);}if(AS.a2&&AU){if(!(AR&&AR.fm2)){AX.insertAndRemoveTrailing(AW,AM.getFm2NodeProps());}}else{AX.removeTrailingContainer(AW);}var AQ=mstrApp.isWSStyling?C:AB,AO=mstrApp.isWSStyling?R:x;K.call(AT,AS.a?AQ:AS.m?AO:"");if((!AS.a)&&AS.m&&this.domNode){G.addClass(this.domNode,"lastStage");}H.call(this);}};},getFnNodeProps:function a(){var AM=this;return{alias:"fn",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrApp.isWSStyling?mstrmojo.desc(15006,"Operator"):mstrmojo.desc(9579,"Condition")},f({alias:"fn",allowUnlistedValues:false,update:function(){var AT=this.parent.parent.parent,AP=AT.model||{},AU=AP.et,AS,AV=false,AW,AO;switch(AU){case M.AE:AV=!!AP.a;break;case M.AQ:case M.AC:case M.AL:AV=!!(AP.fm&&AP.fm.did);AS=AV?AP.fm.dtp:null;break;case M.MQ:case M.MC:AV=!!AP.m;AS=AV?W.METRIC_DTP:null;break;}if(AV){var AX=m[AS];if((this.lastEt!==AU)||(this.lastFnDtp!==AX)){this.lastEt=AU;this.lastFnDtp=AX;var AR=AU?w[AU]:null,AQ=AR&&AR.key;AW=(AQ&&AT[AQ])||AR.def||[];if(typeof (AW)==="object"){AW=AW[AX]||AW["*"];}}AO=AL(AP.fn,AP.fnt||1);}n(this,AV,AW,AO);this.parent.updateScrollbars();}})],updateColumnContainer:function AN(){this.fn.update();var AO=this.parent,AP=AO.parent,AQ=AP.model,AS=AQ&&AQ.fn,AR=this.next,AU=AS===Y.IS_NULL||AS===Y.IS_NOT_NULL;if(AS&&AU){AO.removeTrailingContainer(this.idx);}else{if(AS&&!(AR&&AR.c0)){AO.insertAndRemoveTrailing(this.idx,AM.getC0NodeProps());}}var AT=mstrApp.isWSStyling?AH:y;K.call(AP,AQ.a?AC:AQ.m?AT:"");AR=this.next;if(AR){AR.updateColumnContainer();}}};},getEsNodeProps:function B(){var AO=[{scriptClass:"mstrmojo.ui.CheckList",alias:"es",itemIdField:"v",allowUnlistedValues:true,insertUnlistedValuesAt:0,selectionPolicy:"toggle",postCreate:function AN(){t.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,params:{taskId:"browseElements",attributeID:null,styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30},onsuccess:function(){var AZ=this.parent,AT=this.response;if((AT&&AT.did)!==AZ.lastAttrId){return ;}var AV=(AT&&AT.es)?s.filter(AT.es,function(Aa){return !k.isNullElem(Aa.v);}):[],AY=AZ.parent.parent.parent.model&&AZ.parent.parent.parent.model.es,AW=function(Ag,Ab){var Af=Ag&&Ag.length||0,Ae=Ab&&Ab.length||0,Aa=[],Ad,Ac;for(Ad=0;Ad<Ae;Ad++){for(Ac=0;Ac<Af;Ac++){if(Ab[Ad].n===Ag[Ac].n){break;}}if(Ac===Af){Aa.push(Ab[Ad]);}}return Aa;},AX=function(Aa,Ab,Ae){var Ad=[],Ac;s.forEach(Aa,function(Af){Ac=s.filterOne(Ab,function(Ag){return Af[Ae]&&Ag[Ae]&&Af[Ae]===Ag[Ae];});if(Ac){Ad.push(Ac);}});return Ad.length===Aa.length?Ad:Aa;};AY=AY&&AX(AY,AV,"v");if(AZ.allowUnlistedValues){var AU=AW(AV,AY);AV=(AZ.insertUnlistedValuesAt===0)?AU.concat(AV):AV.concat(AU);}l(AZ,AV,AY,null);AZ.parent.updateScrollbars();},onerr:function(){F(this.parent,o,[I]);}});},onselectionChange:function AR(AT){mstrmojo.ListBase.prototype.onselectionChange.call(this,AT);b.call(this,AT);},update:function AQ(){var AW=this.parent.parent.parent,AV=AW.model,Aa=AV&&AV.a,Ab=!!Aa&&!Aa.ilk,Ac,AT,AZ,AX,AU,Ad;if(Ab){if(this.lastAttrId!==Aa.did){this.lastAttrId=Aa.did;Ac=AV.es;AX=Ac&&Ac.length;Ac=AX?Ac.concat():[];Ac.push(o);if(AX){AZ=[];for(AU=1;AU<=AX;AU++){AZ[AU]=AU;}}Ad=this.ajx;AW.updateBrowseElementsParams(Ad.params,Aa);}else{AT=AV.es;}}d(this,Ab,Ac,AT,AZ);if(Ab&&Ad){if(AW.getElements){var AY=this;AW.getElements(Aa,{success:function(Ae){l(AY,Ae.es||[],AW.model&&AW.model.es,null);AY.parent.updateScrollbars();},failure:function(){F(AY,o,[I]);}});}else{Ad.send();}}},setupScrollNodes:function AP(){this.scrollNode=null;}}];if(!mstrApp.isSingleTier){AO.splice(0,0,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7928,"Browse elements..."),onclick:function AM(){this.parent.parent.parent.browse(this.parent.es);}});}return{alias:"es",children:AO,updateList:function(AT){d(this.es,true,AT,this.parent.parent.model.es,null);this.updateScrollbars();},updateColumnContainer:function AS(){var AT=this.parent.parent;if(this.domNode){G.addClass(this.domNode,"lastStage");}this.es.update();K.call(AT,mstrApp.isWSStyling?N:AD);}};},getFmNodeProps:function O(){var AM=this;return{alias:"fm",children:[f({alias:"fm",fmPost:"",filter:false,isFirstFm:true})],updateColumnContainer:function AN(){this.fm.update();var AX=this.parent,AS=AX.parent,AR=AS.model,AU=AR&&AR.fm,AW=this.idx,AV=AR&&AR.a,AP=AS.disableElementsBrowsing,AO=AV&&AP&&AP(AV);var AT=(AR.etWas&&AR.etWas===M.AE)?q:j,AQ=j;if(AR.et===M.AE&&!AO){AQ=q;}if(AT!==AQ||AQ===j){AX.removeTrailingContainer(AW);if(AQ===j&&AU){AX.addNextColumn(AM.getFnNodeProps());}else{if(AQ===q){AX.addNextColumn(AM.getEsNodeProps());}}}K.call(AS,mstrApp.isWSStyling?AE:AF);H.call(this);}};},getTargetNodeProps:function g(){var AM=this;return{alias:"target",target:null,browseLink:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(11859,"Based On")},L({alias:"target",insertUnlistedValuesAt:0,makeObservable:true,hideIfEmpty:true,postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},onObjBrowsed:function(AP){if(AP.st===J.FILTER||AP.t===AA.REPORT||AP.t===AA.PROMPT){this.parent.parent.parent.onOK();}},update:function AO(){var AQ=this.parent.parent.parent,AR=AQ.model,AU=AQ.targetsLastMod,AV=AR&&AR.et;if(this.lastModel!==AR||this.targetsLastMod!==AU){this.lastModel=AR;this.targetsLastMod=AU;var AP=AQ.targets,AW=AQ.ets;if(AW&&AP&&AP.length){var AT=AJ(AQ.ets);AP=s.filter(AP,function(AX){return AT[AX[E]];});}var AS=AR&&AR[Z[AV]];n(this,true,W.getSortedObjectsByTypeGroup(AP),AS);this.parent.updateScrollbars();}}}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.target);}}],updateColumnContainer:function AN(){this.target.update();var AQ=this.parent,AR=AQ.parent,AS=AR.model,AU=AS&&AS.et,AP=this.idx,AT=this.next;this.browseLink.set("visible",AR.objectBrowsingEnabled);if(AU){switch(AU){case M.AQ:case M.AL:case M.AC:case M.AE:if(AS.a&&!(AT&&AT.fm)){this.parent.insertAndRemoveTrailing(AP,AM.getFmNodeProps());}break;case M.MQ:case M.MC:if(AS.m&&!(AT&&AT.fn)){this.parent.insertAndRemoveTrailing(AP,AM.getFnNodeProps());}break;case M.R:case M.F:case M.XML:this.parent.removeTrailingContainer(AP);break;}}AT=this.next;if(AT){AT.updateColumnContainer();}}};}});var A=mstrmojo.rw.ConditionWalkProvider;A.setTip=K;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo.ui.ColumnWalk","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.ConditionModel","mstrmojo.rw.ConditionWalkProvider");var S=mstrmojo.Widget,J=mstrmojo.array,F=mstrmojo.dom,O=mstrmojo.hash,A=mstrmojo.mstr.EnumNodeDimty,K=mstrmojo.rw.ConditionWalkProvider.setTip,Q=mstrmojo.expr,I=Q.ET;var C=mstrmojo.desc(11899,"Select a dataset object.");var M=J.hash([A.NodeDimtyOutputLevel]);function E(){var X=this.model;if(X){if(!X.attachEventListener){O.make(X,mstrmojo.ConditionModel,{});}X.attachEventListener("edit",this.id,"onmodeledit");}}function N(Y,X){if(X&&X.detachEventListener){X.detachEventListener("edit",Y.id,"onmodeledit");}}function P(c,X){var a=X,b=[],Z=[],Y=[],d=false;O.forEach(a,function(e){b=b.concat(e.att.filter(function(f){return f.did===c;}));});d=b[0]&&b[0].da;b.forEach(function(e){Z=Z.concat(e.fs||[]);});Z.forEach(function(e){if((e.obf||d)&&Y.filter(function(f){return f.did===e.fid;}).length===0){Y.push({did:e.fid,dtp:mstrmojo.expr.mapBaseFormTypeToDataType(e.bftp),n:e.fnm,t:e.t,isbf:e.isbf});}});return Y;}function D(c,X){var Y,a=X,b,Z=false;if(typeof microstrategy!=="undefined"){a=a||microstrategy.bones.rwb_viewer.datasetInfos;}O.forEach(a,function(d){Y=d.mx;O.forEach(Y,function(e){if(e.did===c){b=d;Z=e.um||e.rdm;return false;}});return !b;});return Z&&b&&b.isMDX;}mstrmojo.rw.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.rw.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},walkNode:function(){return this.domNode.children[1];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function L(){S.visibleMarkupMethod.call(this);if(this.visible){this.initWalk();}},onheightChange:S.heightMarkupMethod,onwidthChange:S.widthMarkupMethod},layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",applyNode:"auto"},xt:true},editor:undefined,columnWalk:undefined,tip:undefined,walkProvider:null,objectBrowsingEnabled:true,postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=mstrmojo.insert(mstrmojo.rw.ConditionWalkProvider);}},initWalk:function R(){var X=this.columnWalk,Y=this.walkProvider;K.call(this,C);X.removeTrailingContainer(-1);X.addNextColumn(Y.getTargetNodeProps());X.target.updateColumnContainer();this.updateOkBtn();},updateBrowseElementsParams:function(a,Z){a.attributeID=Z.did;a.otp=Z.t||12;var Y=this.editor,X=Y&&Y.onUpdateBrowseElementsParams;if(X){X.call(Y,a,Z);}},children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"333px",width:"750px"},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",title:mstrmojo.desc(2399,"Cancel"),ignoreLayout:true,onclick:function(){var X=this.parent;if(X.close){X.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",title:mstrmojo.desc(2397,"OK"),onclick:function(){var X=this.parent;if(X.onOK){X.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:C,ignoreLayout:true}],eb:{scriptClass:"mstrmojo.Editor",cssClass:F.isIE7?"mstrmojo-ElementsEditorIE7":"mstrmojo-ElementsEditor",title:mstrmojo.desc(6149,"Select Elements"),help:"element_browser_dialog_box.htm",children:[{scriptClass:"mstrmojo.ElementsBrowser",alias:"browser",onUpdateBrowseElementsParams:function(Y){var X=this.parent.opener;X.updateBrowseElementsParams(Y,X.model.a);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-WebButton hot",cssText:"width: 66px;",onclick:function(){var X=this.parent.parent,Y=X&&X.opener;if(Y){Y.onEBSelect();Y.closePopup();}}},{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-WebButton",cssText:"min-width: 66px; margin-left: 11px;",onclick:function(){var X=this.parent.parent,Y=X&&X.opener;if(Y){Y.closePopup();}}}]}]},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,upButtonVisible:true,scrollableIncFetch:true,showCompletePath:false,closeable:false,closeOnSelect:false,browsableTypes:"3,4,8,10,12,256",includeObjectDesc:true,quickSearch:true,minSearchLength:1}]},_set_model:function V(a,X){var Y=this.model,Z=(X!==Y);if(Z){N.call(this,Y);X.dimtyTypes=this.dimtyTypes||M;this.model=X;E.call(this,X);if(this.hasRendered&&this.visible){this.columnWalk.target.updateColumnContainer();}}return Z;},onmodeledit:function H(Y){var X=Y.prop,a=X==="c0"||X==="c1",Z=this.columnWalk[a?"c0":X];if(a){Z.c1Selected=X==="c1";}Z.updateColumnContainer();Z.c1Selected=false;this.updateOkBtn();},browse:function G(Z){var b=this.parent.editorNode,a=function(d,f){var c=mstrmojo.dom.position(d,true),e=mstrmojo.dom.position(f,true);return{x:c.x+c.w,y:e.y};},X=this.columnWalk,Y=this.walkProvider;switch(Z&&Z.alias){case"target":case"dmy":Y.browseObjs(this,Z,a(Z.alias==="target"?X.target.domNode:this.dmyNode,b));break;case"c0":case"c1":Y.browseObjs(this,Z,a(X.c0.domNode,b));break;case"es":Y.browseEs(this,Z,a(X.es.domNode,b));break;}},onOBSelect:function(b){var Z=this.ob.browser,d=Z.target;this.closePopup();var Y=this.targets,c=d.itemIdField,a=Y||[],X=J.find(Y,c,b[c]);if(X===-1){a.push(b);this.targets=a;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}d.setSelectedItems([b],d.multiSelect);if(d.onObjBrowsed){d.onObjBrowsed(b);}},onEBSelect:function(){var Y=this.eb.browser,a=this.columnWalk.es.es;a.set("selectedIndices",{});var X=a.items,Z=[];J.forEach(Y.selectedItems||[],function(c){if(J.find(a.items,"v",c.v)<0){Z.push(c);}});var b=a.insertUnlistedValuesAt||0;if(b<0){b=X.length;}a.set("items",X.slice(0,b).concat(Z).concat(X.slice(b)));a.setSelectedItems(Y.selectedItems,false);},destroy:function U(Y){var X=this.walkProvider;if(X&&X.destroy){this.walkProvider.destroy();}this._super(Y);},updateOkBtn:function W(){var a=true,X=this.model,Y,Z=X&&Q.fnCstCount(X.fn,X.fnt);if(!X){return ;}switch(X.et){case I.AQ:case I.AL:case I.MQ:for(Y=0;Y<Z;Y++){a=a&&!this["invalid"+Y];}break;}a=a&&!!X.completed;this.okBtn.set("visible",a);this.raiseEvent({name:"conditionWalkUpdateOkBtn",valid:a});}});mstrmojo.rw.ConditionWalk.getAttForms=P;mstrmojo.rw.ConditionWalk.isMdxDM=D;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.DatasetUnitMenuUtils");var A=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui._CanDropFromSchema=mstrmojo.provide("mstrmojo.vi.ui._CanDropFromSchema",{_mixinName:"mstrmojo.vi.ui._CanDropFromSchema",augmentDropContextForSchema:function B(E,C){var F=E.getCtxtDragData();if(F.src===mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST){var D=A.getCfgForAddUnitFromAllObject(F.items,C.datasets||{});F.dsid=D.dsid;if(D.actions.length){E.actions=D.actions;E.callback=C.getDatasetsUpdateCallback();}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.vi.ui.DatasetUnitMenuUtils");var B=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui.UnitList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.vi.ui.UnitList",init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIUnitList");},getItemProps:function A(F,D){var E=this._super(F,D);E.addCls("unit "+B.getUnitCssClass(F));return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.DropZoneHelper","mstrmojo.string","mstrmojo.vi.ui.DatasetUnitMenuUtils");var G="mstrmojo-VIUnitList",I="icn clsx_sub",D=mstrmojo.vi.viz.DropZoneHelper.isMetricNames,C=mstrmojo.vi.ui.DatasetUnitMenuUtils,J=mstrmojo.string;mstrmojo.vi.ui.VIDragUnit=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.ui.VIDragUnit",getItemDisplayName:function F(K){return K.n;},getUnitAvatar:function A(N,Q){var M=document.createElement("div"),P=N.getCtxtDragData(),K=P.items,L=['<div class="',[G,mstrApp.getThemeClassName()].join(" "),'">'],O=this;K.forEach(function(S){var U=O.getItemDisplayName(S),R="item unit isAvatar "+C.getUnitCssClass(S);if(D(S)){U=mstrmojo.desc(3582,"Metrics");R+=" is-mh";}L.push('<div class="'+R+'"><span class="txt" unselectable="on">'+(Q?J.encodeHtmlString(U):U)+"</span></div>");});L.push("</div>");M.innerHTML=L.join("");return M.removeChild(M.firstChild);},getUnitDragData:function B(M,K){var L=this.setAvatarClass.bind(this);return{items:K,item:K[0],setAvatarClass:function N(P){L(M,P);},setInvalidAvatarClass:function O(){L(M,I);}};},getDragUnitOffsets:function E(){return{x:21,y:16};},setAvatarClass:function H(N,K){var L=N.avatar;if(L){var M=[G,"hasOwnAvatar",mstrApp.getThemeClassName(),K||""];L.className=M.join(" ");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.elementHelper","mstrmojo.func","mstrmojo.VisEnum","mstrmojo.num","mstrmojo.array","mstrmojo.VisMenuList","mstrmojo.mstr.EnumFunction","mstrmojo._HasMarkup","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.FormatModel","mstrmojo._FormatDefinition","mstrmojo.css","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.chart.model.enums.EnumDSSBaseFormType","mstrmojo.string","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.ui.rw.GhostImageContainer","mstrmojo.vi.ui.rw.FreezingImageContainer");mstrmojo.requiresClsP("mstrmojo.ui.menus","MenuConfig","EditorConfig");var O=document.getElementById("vis-measure-canvas"),F=document.getElementById("vis-measure-span"),i={},N={},t={},AE=mstrmojo.dom,f=mstrmojo.elementHelper,AU=mstrmojo.vi.ui.DatasetUnitMenuUtils,W=mstrmojo.VisEnum.EnumColorRankMode,s=mstrmojo.chart.model.enums.EnumDSSObjectType,AM=mstrmojo.chart.model.enums.EnumDSSBaseFormType,AS=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,AW=mstrmojo.chart.enums.EnumFontStyle,Y=mstrmojo.hash,d=mstrmojo.string,Ad=mstrmojo.func.wrapMethods,a=mstrmojo.VisEnum,R=mstrmojo._FormatDefinition,Ah=a.SERVER_JSON_ERROR_TYPE,z=mstrmojo.vi.viz.EnumVizStyles,AN=mstrmojo.vi.enums.EnumFeatures,E=mstrmojo.vi.ui.rw.FreezingImageContainer,Ab=mstrmojo.vi.ui.rw.GhostImageContainer,g=mstrmojo.num;var x=64,AG=128,C=4,AB=5,c=6,G=7,h=mstrmojo,U=h.array,Ae=mstrmojo.array,A=h.desc,l=h.mstr.EnumFunction,V=mstrmojo.vi.enums.EnumDerivedElementType,AZ=h._HasMarkup,Ac=h.css;var Q;var e=NaN;mstrmojo.requiresDescs(221,358,1422,2122,6017,5868,5869,11819,11827);function Ag(Am,Al){var Ak=mstrmojo.VisUtility;var An=Ak.pluck(Al,"tid"),Ao=Ak.pluck(Al,"eid"),Aj=(Am.getDocModel&&Am.getDocModel())||Ak.getPropertyByPath(Am,"model.docModel");if(Ak.getPropertyByPath(Aj,"getColorBy") instanceof Function){return Aj.getColorBy(An,Ao);}}function Aa(Aj,Al,An){var Am=Al.id,Ak=Al.getHost();if(Ak&&Ak.observableModel){Aj.forEach(function(Ap){var Ao=Ak.observableModel[Ap];if(Ao){Ao.attachEventListener("valueChanged",Am,An);}});}}function Ai(Ak){var Aj={SINGLE:[{text:A(358,"Absolute"),value:l.FunctionAbs,n:A(358,"Absolute"),v:l.FunctionAbs}],PAIR:[{text:A(6017,"Add"),value:l.FunctionAdd,n:A(6017,"Add"),v:l.FunctionAdd},{text:A(2122,"Average"),value:l.FunctionAverage,n:A(2122,"Average"),v:l.FunctionAverage},{text:A(5868,"Least"),value:l.FunctionLeast,n:A(5868,"Least"),v:l.FunctionLeast},{text:A(5869,"Greatest"),value:l.FunctionGreatest,n:A(5869,"Greatest"),v:l.FunctionGreatest},{text:"A-B",value:l.FunctionMinus+";0",n:"A-B",v:l.FunctionMinus+";0"},{text:"B-A",value:l.FunctionMinus+";1",n:"B-A",v:l.FunctionMinus+";1"},{text:"A/B",value:l.FunctionDivide+";0",n:"A/B",v:l.FunctionDivide+";0"},{text:"B/A",value:l.FunctionDivide+";1",n:"B/A",v:l.FunctionDivide+";1"}],MORE:[{text:A(6017,"Add"),value:l.FunctionAdd,n:A(6017,"Add"),v:l.FunctionAdd},{text:A(2122,"Average"),value:l.FunctionAverage,n:A(2122,"Average"),v:l.FunctionAverage},{text:A(5868,"Least"),value:l.FunctionLeast,n:A(5868,"Least"),v:l.FunctionLeast},{text:A(5869,"Greatest"),value:l.FunctionGreatest,n:A(5869,"Greatest"),v:l.FunctionGreatest}]};return Aj[Ak];}function AR(Ak,Aj){return !!(((Ak&&Ak.at)||0)&Aj);}function Z(Aj){return !Aj.cmSelCells.some(function(Ak){var Al=Aj.getCellForNode(Ak);return f.isNonGroupNull(Al)||!AR(Al,x)||Al.dei!==undefined||Aj.model.isRecursiveAttribute(Al.tid);});}function n(Ak){var Aj;return !Ak.cmSelCells.some(function(Al){Aj=Ak.getCellForNode(Al);return(f.isNonGroupNull(Aj)||!AR(Aj,AG))||Ak.model.isRecursiveAttribute(Aj.tid);});}function Af(Am,Aj){var Al=Am&&Aj&&Am.getCellForNode(Aj),Ak=Al&&Am.getDEInfo(Al);return Ak&&Ak.de;}function X(An,Am,Ap,Al){if(Al){var Ak=Am&&An.getDEInfo(Am),Ao=Ak&&Ak.de,Aj=Ao&&Ao.func;if((Aj===Ap)||(typeof Ap==="string"&&Ap.indexOf(Aj)===0&&Ap.indexOf(";0")>0)){return ;}An.editDECalculation(Am,Ap);}else{An.derivedElementCalculation(Am,Ap);}}function o(Av,At,Ar){var Au=At&&At.es,Aj=(Au&&Au.length)||Av.cmSelCells.length,Am=(Aj===1)?"SINGLE":((Aj===2)?"PAIR":"MORE"),As=Ai(Am),Al=(At&&At.func),An,Aw=Av.cmSelCells,Ak,Aq,Ap,Ao;if(Am==="PAIR"){if(At){Ao=Au[0].v>Au[1].v;if(Ao){Ap=Au[0].n;Aq=Au[1].n;As[4]={value:l.FunctionMinus+";1",v:l.FunctionMinus+";1"};As[5]={value:l.FunctionMinus+";0",v:l.FunctionMinus+";0"};As[6]={value:l.FunctionDivide+";1",v:l.FunctionDivide+";1"};As[7]={value:l.FunctionDivide+";0",v:l.FunctionDivide+";0"};}else{Aq=Au[0].n;Ap=Au[1].n;}}else{Aq=Ar(Aw[0]);Ap=Ar(Aw[1]);}As[C].text=Aq+" - "+Ap;As[AB].text=Ap+" - "+Aq;As[c].text=Aq+" / "+Ap;As[G].text=Ap+" / "+Aq;As[C].n=Aq+" - "+Ap;As[AB].n=Ap+" - "+Aq;As[c].n=Aq+" / "+Ap;As[G].n=Ap+" / "+Aq;}for(An in As){if(typeof As[An].value==="string"&&As[An].value.indexOf(Al)===0&&As[An].value.indexOf(";0")>0){Ak=As[An];break;}if(As[An].value===Al){Ak=As[An];break;}}return{items:As,selectedItem:Ak};}function y(Aj,Am){if(!Aj){return Aj;}if(Am.length===1){return Aj[Am[0]];}var Al=(Am&&Am.length)||0,Ak;for(Ak=0;Ak<Al;Ak++){Aj=Aj[Am[Ak]];if(!Aj){break;}}return Aj;}function AT(Al,Ak,Aj){return Al.every(function(Am){return Am.ttp===Ak||Am.ttp===Aj;});}function H(Ak,An,Ao){var Am=(An&&An.length)||0,Al,Aj,Ap=Ak;for(Al=0;Al<Am-1;Al++){Aj=An[Al];if(!Ap[Aj]){Ap[Aj]={};}Ap=Ap[Aj];}Ap[An[Am-1]]=Ao;}function AD(Ar){var As,Aq,Am,Ao,Aj,Ap=this.model.docModel.datasets,Ak=false,An=false,Al={isDM:false};for(As in Ap){if(Ap.hasOwnProperty(As)){Aq=Ap[As].mx;U.forEach((Aq||[]),function(At){if(At.did===Ar){if(At.um||At.rdm){An=true;}Ak=true;return false;}});if(Ak){break;}}}if(An){Aj=this.model.data.gts.col;Am=(Aj&&Aj[Aj.length-1]);if(Am&&Am.otp===-1){Ao=Am.es;}U.forEach((Ao||[]),function(At){if(At.oid===Ar){Al={isDM:true,id:At.id};return false;}});}return Al;}function M(Aj,Am){var Ap=[],Al={act:"updateElementsPropertiesMap",epm:Ap},An=[],Ak={},Ar=[Ak],Aq=this;Ap.push({epmk:An,epmv:Ar});Aj.forEach(function(At){var Au=At.tid,Aw=At.tp,As=Au===-1,Av={ob:{did:As?"":Au,tp:Aw}};An.push(Av);});if(Am&&Am.indexOf("default")<0){Ak.v={vv:Am};}var Ao=[];Ak.k={chn:Ao};Aj.forEach(function(Au){var Av=Au.tid,As=Av===-1,At;if(As){At=AD.call(Aq,Au.eid);if(At.isDM){Ao.push({emt:2,ei:At.id});}else{Ao.push({emt:2,mt:{did:Au.eid,tp:4,ql:0}});}}else{Ao.push({emt:1,ei:Au.eid,at:{did:Av,tp:Au.tp,ql:0}});}});return Al;}function AO(An,Al){var Am="00000000000000000000000000000000",Ak=An&&An.dropZones,Aj=U.find(Ak,"id",Al);return Aj===-1?[]:U.filter(Ak[Aj].items,function(Ao){return Ao.t===4&&Ao.id!==Am;});}function AJ(Ao,Al,An,Ak,Aj){var Ap=Ak?Ao:Ao&&Ao.parentNode;while(Ap&&(Ap!==Aj)){var Am=Ap.getAttribute&&Ap.getAttribute(Al);if(Am!==null&&Am.indexOf(An)>=0){return true;}Ap=Ap.parentNode;}return false;}function AC(Ak,Al){var Aj=Y.walk("rootCtrl.docCtrl",mstrApp);if(Aj&&(typeof Aj.selectViPanel==="function")){Aj.selectViPanel(Al);}Ak.getDocModel().selectVIUnit(Ak.parent.id,true);}var I={sessions:{},instances:[],init:function AK(){this.supportedEventTypes=[];if(window.TouchEvent){this.supportedEventTypes.push("TouchEvent");}else{if(window.PointerEvent){this.supportedEventTypes.push("PointerEvent");}}if(window.MouseEvent){this.supportedEventTypes.push("MouseEvent");}return this;},startNewSessions:function AH(Aj){var An=this;var Al=this;var Ak=document;var Am=function(Ax){var As=Aj.callbacks.start.bind(Aj.callbackThis),At=Aj.callbacks.change.bind(Aj.callbackThis),Au=Aj.callbacks.end.bind(Aj.callbackThis),Aw=Aj.callbacks.context;var Ap={};Ap.identifier=Ax.identifier;Ap.context=Y.clone(Aw);Ap.clientX=Ax.clientX;Ap.clientY=Ax.clientY;var Ar=function Ar(Ay){var Az=this.context;return As({api:Al,event:Ay,session:this,context:Az});};var Av=function Av(Az,Ay){var A0=this.context,A2=0,A1=0;A2=Ay.clientX-this.clientX;A1=Ay.clientY-this.clientY;this.clientX=Ay.clientX;this.clientY=Ay.clientY;var A3={api:Al,event:Az,deltaX:A2,deltaY:A1,session:this,context:A0};return At(A3);};var Aq=function Aq(Ay){var Az=this.context;return Au({api:Al,event:Ay,session:this,context:Az});};Ap.onStart=Ar;Ap.onChange=Av;Ap.onEnd=Aq;return Ap;};var Ao=function(Aq,Ap){Aq.listeners={};Aq.listeners.change=function(Ar){var As=An.getChangedSessions(Ar);for(var At=0;At<As.length;At++){if(Aq.identifier===As[At].identifier){return An.sessions[Aq.identifier].onChange(Ar,As[At]);}}};Aq.listeners.end=function(As){var At=An.getChangedSessions(As);for(var Au=0;Au<At.length;Au++){if(Aq.identifier===At[Au].identifier){if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(Ap)){Ak.removeEventListener("touchmove",Aq.listeners.change);Ak.removeEventListener("touchend",Aq.listeners.end);Ak.removeEventListener("touchcancel",Aq.listeners.end);}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(Ap)&&(Ap.pointerType&&Ap.pointerType!=="mouse")){Ak.removeEventListener("pointermove",Aq.listeners.change);Ak.removeEventListener("pointerleave",Aq.listeners.end);Ak.removeEventListener("pointerup",Aq.listeners.end);}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(Ap)&&!Ap.pointerType){Ak.removeEventListener("mousemove",Aq.listeners.change);Ak.removeEventListener("mouseup",Aq.listeners.end);}}}var Ar=An.sessions[Aq.identifier].onEnd(As);delete An.sessions[Aq.identifier];return Ar;}}};if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(Ap)){Ak.addEventListener("touchmove",Aq.listeners.change);Ak.addEventListener("touchend",Aq.listeners.end);Ak.addEventListener("touchcancel",Aq.listeners.end);}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(Ap)&&(Ap.pointerType&&Ap.pointerType!=="mouse")){Ak.addEventListener("pointermove",Aq.listeners.change);Ak.addEventListener("pointerleave",Aq.listeners.end);Ak.addEventListener("pointerup",Aq.listeners.end);}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(Ap)&&!Ap.pointerType){Ak.addEventListener("mousemove",Aq.listeners.change);Ak.addEventListener("mouseup",Aq.listeners.end);}}}};return function(Ar){var As=An.getChangedSessions(Ar),Aq=An.sessions,At=As.filter(function(Au){if(Aq[Au.identifier]){return false;}else{return true;}});At.forEach(function(Au){An.sessions[Au.identifier]=Am(Au);Ao(An.sessions[Au.identifier],Ar);});var Ap=[];At.forEach(function(Au){Ap.push(An.sessions[Au.identifier].onStart(Ar));});return Ap;};},newInstance:function AL(Am,Ap,Ao){var Al,Ak,Aj=this.getInstanceIndex(Am);if(Aj!==-1){for(Al=0;Al<this.supportedEventTypes.length;Al++){Ak=this.supportedEventTypes[Al];if(Ak==="TouchEvent"){Am.removeEventListener("touchstart",this.instances[Aj].starter);}else{if(Ak==="PointerEvent"){Am.removeEventListener("pointerdown",this.instances[Aj].starter);}else{if(Ak==="MouseEvent"){Am.removeEventListener("mousedown",this.instances[Aj].starter);}}}}delete this.instances[Aj];}var An={domNode:Am,callbacks:Ap,callbackThis:Ao};An.starter=this.startNewSessions(An);if(Aj!==-1){this.instances[Aj]=An;}else{this.instances.push(An);}for(Al=0;Al<this.supportedEventTypes.length;Al++){Ak=this.supportedEventTypes[Al];if(Ak==="TouchEvent"){Am.addEventListener("touchstart",An.starter);}else{if(Ak==="PointerEvent"){Am.addEventListener("pointerdown",An.starter);}else{if(Ak==="MouseEvent"){Am.addEventListener("mousedown",An.starter);}}}}return this;},getInstanceIndex:function K(Aj){return U.find(this.instances,"domNode",Aj);},getInstance:function q(Ak){var Aj=this.getInstanceIndex(Ak);return this.instances[Aj];},getChangedSessions:function AF(Aj){var Ak=[];if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(Aj)){var An=Aj.changedTouches;for(var Al=0;Al<An.length;Al++){var Am={};Am.identifier=An[Al].identifier;Am.clientX=An[Al].clientX;Am.clientY=An[Al].clientY;Ak.push(Am);}}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(Aj)&&(Aj.pointerType&&Aj.pointerType!=="mouse")){Ak.push({identifier:Aj.pointerId,clientX:Aj.clientX,clientY:Aj.clientY,});}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(Aj)&&!Aj.pointerType){Ak.push({identifier:"mouse",clientX:Aj.clientX,clientY:Aj.clientY,});}}}return Ak;}};var w=I.init();mstrmojo.VisUtility=mstrmojo.provide("mstrmojo.VisUtility",{detectMinimumFontSize:function(){if(AE.isChrome){var Al="I am a sample string, I am a sample string, I am a sample string.",An,Aj={fontFamily:"Open Sans",fontSize:"1pt",fontStyle:"normal",fontWeight:"normal",textDecoration:"none"},Am=this.measureTextWidthWithSpan(Al,Aj,0,undefined,true,true,true);for(var Ak=2;Ak<72;++Ak){Aj.fontSize=Ak+"pt";An=this.measureTextWidthWithSpan(Al,Aj,0,undefined,true,true,true);if(An>Am){e=Ak;break;}}}},getCache:function(){return JSON.stringify(t);},getUpdateColorMapAction:function(Ak,Aj){return M.call(this,Ak,Aj);},measureTextSize:function(Ak,Aj,Al){return{width:this.measureTextWidth(Ak,Aj,Al),height:this.measureTextHeight(Ak,Aj,Al)};},measureTextWidth:function(An,Am,Ao,Al,Aj,Ak){if(AE.isIE||AE.isIEW3C){return this.measureTextWidthWithSpan(An,Am,Ao,Al,Aj);}else{if(AE.isChrome){if(isNaN(e)){this.detectMinimumFontSize();}return parseInt(Am.fontSize)>=e?this.measureTextWidthWithCanvas(An,Am,Ao):this.measureTextWidthWithSpan(An,Am,Ao,Al,Aj,false,Ak);}}return this.measureTextWidthWithCanvas(An,Am,Ao);},measureTextWidthWithCanvas:function(Am,An,Aq,Ao){Ao=Ao||false;if(Am===""){return 0;}if(Am===" "){Am="\u00A0";}var Ap=An.fontFamily,As=An.fontSize,Al=An.fontStyle,Ar=An.fontWeight;if(typeof As==="number"){As+="pt";}Al=Al||"normal";Ar=Ar||"normal";Aq=Aq||0;var Ak=Ao?undefined:y(i,[Ap,As,Al,Ar,Am]);if(!Ak){if(!O){O=document.createElement("canvas");O.width=0;O.height=0;O.id="vis-measure-canvas";O.style.position="absolute";O.style.top="0";O.style.fontSize="medium";document.body.appendChild(O);}var Aj=O.getContext("2d");Aj.font=Al+" "+Ar+" "+As+" "+this.surroundWithQuotes(Ap);Ak=Math.ceil(Aj.measureText(Am).width);H(i,[Ap,As,Al,Ar,Am],Ak);}return Ak+Aq;},measureTextWidthQuick:function(Am,An,Aq,Ao){Ao=Ao||false;if(Am===""){return 0;}if(Am===" "){Am="\u00A0";}var Ap=An.fontFamily,As=An.fontSize,Al=An.fontStyle,Ar=An.fontWeight;if(typeof As==="number"){As+="pt";}Al=Al||"normal";Ar=Ar||"normal";Aq=Aq||0;var Ak=Ao?undefined:y(i,[Ap,As,Al,Ar,Am]);if(!Ak){if(!O){O=document.createElement("canvas");O.width=0;O.height=0;O.id="vis-measure-canvas";O.style.position="absolute";O.style.top="0";O.style.fontSize="medium";document.body.appendChild(O);}var Aj=O.getContext("2d");Aj.font=Al+" "+Ar+" "+As+" "+this.surroundWithQuotes(Ap);Ak=Math.ceil(Aj.measureText(Am).width);H(i,[Ap,As,Al,Ar,Am],Ak);}return Ak+Aq;},measureTextWidthWithSpan:function(An,Ao,As,Au,Ap,Aj,Al){if(An===""){return 0;}if(An===" "){An="\u00A0";}var Aq=Ao.fontFamily,Av=Ao.fontSize,Am=Ao.fontStyle,Ar=Ao.fontWeight;if(typeof Av==="number"){Av+="px";}Am=Am||"normal";Ar=Ar||"normal";Au=Au||"auto";As=As||0;Ap=!!Ap;if(typeof Au==="number"){Au+="px";}var Ak=y(N,[Aq,Av,Am,Ar,Au,An]);if(!Ak||Aj){var At;if(!F){F=document.createElement("span");At=F.style;F.id="vis-measure-span";At.position="absolute";At.top="0";At.visibility="hidden";At.width="auto";At.height="auto";if(Ap){At.whiteSpace="nowrap";}else{At.whiteSpace="normal";}document.body.appendChild(F);}At=F.style;if(Ap){At.whiteSpace="nowrap";}else{At.whiteSpace="normal";}At.width="auto";At.height=Au;At.fontFamily=this.surroundWithQuotes(Aq);At.fontSize=Av;At.fontStyle=Am;At.fontWeight=Ar;F.innerHTML=d.encodeHtmlString(An,Al);Ak=Math.floor(F.clientWidth)+1;H(N,[Aq,Av,Am,Ar,Au,An],Ak);}return Ak+As;},measureTextHeight:function(Al,Am,Ar,Au,Aj,Ao,An){if(Al===""){return 0;}if(Al===" "){Al="\u00A0";}var Ap=Am.fontFamily,Aw=Am.fontSize,Ak=Am.fontStyle,Aq=Am.fontWeight,At=Am.lineHeight||"inherit";Aj=Aj||"normal";An=!!An;if(typeof Aw==="number"){Aw+="px";}Ak=Ak||"normal";Aq=Aq||"normal";Au=Au||"auto";Ar=Ar||0;if(typeof Au==="number"){Au+="px";}var Av=Ao?undefined:y(t,[Ap,Aw,Ak,Aq,Au,Al]);if(!Av){var As;if(!F){F=document.createElement("span");As=F.style;F.id="vis-measure-span";As.position="absolute";As.top="0";As.visibility="hidden";As.width="auto";As.height="auto";if(An){As.whiteSpace="nowrap";}else{As.whiteSpace="normal";}document.body.appendChild(F);}As=F.style;if(An){As.whiteSpace="nowrap";}else{As.whiteSpace="normal";}As.heigth="auto";As.width=Au;As.lineHeight=At;As.fontFamily=this.surroundWithQuotes(Ap);As.fontSize=Aw;As.fontStyle=Ak;As.fontWeight=Aq;As.wordBreak=Aj;F.innerHTML=d.encodeHtmlString(Al);Av=F.clientHeight;if(!Ao){H(t,[Ap,Aw,Ak,Aq,Au,Al],Av);}}return Av+Ar;},getVisEmptyMsg:function(Aj,Ak){var Al="";switch(Aj){case"AE_ERROR":Al='<div class="gm-vis-msg-container"><div class="gm-vis-msg-vcenter"><div class="gm-vis-msg-hcenter"><div style="padding:25px"><div class="gm-warning-icon" style="padding-bottom:18px"></div><div style="padding-bottom:8px">'+(Ak||this.errorMsg||"")+"</div><div></div></div></div></div></div>";break;case"NODATA_OTHERERROR":Al='<div class="error-msg"><div class="error-content"><div class="text" style="visibility: visible;padding-top:0px;"><div>'+(this.errorMsg||mstrmojo.desc(2388,"No data returned for this view. This might be because the applied filter excludes all data."))+"</div></div></div></div>";break;default:Al='<div class="mstrmojo-Label dropMsg" style="display: block;" >'+mstrmojo.desc(11668,"Drag objects here.")+"</div>";}return Al;},getVisEmptyMsgControls:function B(){var Al=this.error,As,Ap=this.errorType,Ak,An=mstrConfig&&mstrConfig.pluginsVisList,Ar;var Am=mstrmojo.VisUtility;if(this.excludeData){As=Am.getVisStyle.call(this);var Ao=Am.getAttMetricCount.call(this);return[{scriptClass:"mstrmojo.vi.ui.rw.FreezingImageContainer",cssClass:As,visName:mstrConfig.pluginsVisList[As]&&mstrConfig.pluginsVisList[As].d,visDropzoneMsg:E.getVisDropzoneMsg(Ao.attCount,Ao.metricCount)}];}if(!this.hasError()){return ;}switch(Ap){case Ah.NO_DATASET:case Ah.NO_TEMPLATE_UNIT:if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(AN.SUPPORT_GHOST_IMG)){As=Am.getVisStyle.call(this);var At="",Aq="",Aj="";if(As===z.HEAT_MAP){At="heatmap";Aq=mstrmojo.desc(11819,"Heat Map");Aj=Ab.getVisDesc("heatmap");}else{if(As===z.NETWORK){At="network";Aq=mstrmojo.desc(11827,"Network");Aj=Ab.getVisDesc("network");}else{if(As===z.KPICARD){At="kpicard";Aq=mstrmojo.desc(15800,"KPI");Aj=Ab.getVisDesc("kpicard");}else{if(this.isCustomVis){At=As||"";Ar=(An&&An[As]&&An[As].d)||As;Aq=Ar||mstrmojo.desc(14402,"CUSTOM VISUALIZATION");Aj=this.errorDetails;}}}}Ak=[{scriptClass:"mstrmojo.vi.ui.rw.GhostImageContainer",cssClass:At,visName:Aq,visDesc:Aj}];}else{Ak=[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:Al}];}break;case Ah.AE_ERROR:Ak=[{scriptClass:"mstrmojo.Container",cssClass:"error-msg",markupString:Am.getVisEmptyMsg("AE_ERROR",Al),markupSlots:{containerNode:function(){return this.domNode;}}}];break;default:Ak=[{scriptClass:"mstrmojo.Container",cssClass:"error-msg",markupString:'<div class="{@cssClass}"><div class="error-content" style="visibility: visible">'+Al+"</div></div>",markupSlots:{containerNode:function(){return this.domNode;}}}];break;}return Ak;},applyStyles2DomNode:function(Ao,Ar){var Aj,Ap=Ao.style;if(Object.prototype.hasOwnProperty.call(Ar,"backgroundColor")&&Ar.backgroundColor!==""&&Ar.backgroundColor!=="transparent"){var An=1;if(Object.prototype.hasOwnProperty.call(Ar,"opacity")&&Ar.opacity!==""){An=Ar.opacity;}var Ak=Ar.backgroundColor,Aq=function Aq(As){if(isNaN(As)){As=0;}As%=16777216;return{b:As%256,g:(As>>8)%256,r:(As>>16)%256};},Am="";if(Ak){var Al=function Al(At,Au){if(At==="transparent"){return"rgba(0,0,0,0)";}At=this.parseCSSColor(At,false);var As=Aq(At);return"rgba("+As.r+" ,"+As.g+" ,"+As.b+" ,"+Au+" )";}.bind(this);if(Ak.c1!==undefined&&Ak.c2!==undefined&&Ak.or!==undefined){Am=(Ac.buildGradient(Ak.or,Al(Ak.c1,An),Al(Ak.c2,An))).v;}else{Am=Al(Ak,An);}Ap.background=Am;}}else{Ap.backgroundColor="rgba(0,0,0,0)";}for(Aj in Ar){if(Aj!=="backgroundColor"&&Aj!=="opacity"&&Object.prototype.hasOwnProperty.call(Ar,Aj)&&Ar[Aj]&&Ar[Aj]!==""){Ap[Aj]=Ar[Aj];if(Aj==="fontFamily"){Ap[Aj]="'"+Ar[Aj]+"'";}}}},parseCSSColor:function(An,Ak){var Aj,Al;if(An.length===7){if(Ak===true){Aj=An[5]+An[6]+An[3]+An[4]+An[1]+An[2];}else{Aj=An.slice(1);}}else{Aj=[];var Am=An.slice(1);if(Ak===true){for(Al=2;Al>=0;Al--){Aj.push(Am[Al]);Aj.push(Am[Al]);}}else{for(Al=0;Al<3;Al++){Aj.push(Am[Al]);Aj.push(Am[Al]);}}Aj=Aj.join("");}return parseInt(Aj,16);},positionDomNode:function(Al,An){var Ak,Aq,Ao,Am=["width","height","top","left","right","bottom"],Ap=Am.length,Aj=Al.style;for(Ak=0;Ak<Ap;Ak++){Aq=Am[Ak];Ao=An[Aq];if(Ao!==undefined){if((typeof Ao)==="number"){Ao+="px";}Aj[Aq]=Ao;}}},getComputedFontStyle:function L(Al){var Aj=mstrmojo.css.getComputedStyle(Al);var Am={};Am.fontFamily=Aj.fontFamily;Am.fontSize=Aj.fontSize;Am.fontStyle=Aj.fontStyle;Am.fontWeight=Aj.fontWeight;Am.fontVariant=Aj.fontVariant;var Ak=parseInt(Aj.paddingLeft)||0,An=parseInt(Aj.paddingLeft)||0;Am.bonus=Ak+An;return Am;},splitWordIfTooLong:function(At,Ar,Am){var Ap=[];var Aq=At.length;var An;for(An=0;An<Aq;An++){var Ak=At[An];while(true){var Au=this.measureTextWidth(Ak,Am);if(Au>Ar){var As=(Ar/Au)*Ak.length;var Aj=Math.max(Math.round(As),1);while(Aj>0){var Ao=Ak.substr(0,Aj);var Al=Math.round(this.measureTextWidth(Ao,Am));if(Al<=Ar||Aj===1){Ap.push(Ao);break;}else{Aj--;}}Ak=Ak.substr(Aj,Ak.length-Aj);}else{Ap.push(Ak);break;}}}return Ap;},truncateTextToLineWithWordWrap:function m(A9,A2,A0,Ap,A1,At){var Ax=A9.split(" "),A3=Ax.length;if(!At){Ax=this.splitWordIfTooLong(Ax,A0,A2);}var BG,Av=[],BB=[],Aj=0,An=Ax.length,BI=this.measureTextWidth(" ",A2),Am=0,As=false,Az=(A3===Ax.length);BB.push(0);for(BG=0;BG<An;BG++){var A7=this.measureTextWidth(Ax[BG],A2);if(!At&&A7>A0){var Ak=Ax[BG];var BE=(A0/A7)*Ak.length;Ax[BG]=Ak.substr(0,parseInt(BE,10));A7=A0;}Av.push(A7);Aj+=A7;BB.push(Aj);if(BG!==An-1){Aj+=BI;}}var BD,BF,A5=Ap;for(BD=0,BF=0;BF<BB.length;){var Ar=BB[BF]-BB[BD];if(BD>0&&BF!==BD){Ar-=BI;}var Aq=BB[BF+1]-BB[BD];if(BD>0&&BF+1!==BD){Aq-=BI;}if(Ar<=A0&&((BF+1===BB.length)||(Aq>A0))){Am=Math.max(Am,Ar);A5--;if(A5===0||BF===An){break;}else{BD=BF;BF++;}}else{BF++;}}if(BF>An){BF=An;}var Au=BB[BF]-BB[BD];if(BD>0&&BF!==BD){Au-=BI;}var A8;if(BF>=An&&Au<A0){A8=Ax.join(" ");}else{As=true;Am=A0;A8=Ax.slice(0,BF).join(" ");var Aw=this.measureTextWidth("...",A2);if(Au+Aw<=A0){if(Au+BI+Aw>A0){A8+="...";}else{var BH=Ax[BF],Ay;for(var A4=1;A4<BH.length;A4++){Ay=this.measureTextWidth(BH.substr(0,A4),A2);if(Au+BI+Ay+Aw>A0){break;}}A8+=" "+BH.substr(0,A4-1)+"...";}}else{if(A8.charAt(A8.length-1)===" "){A8=A8.substr(0,A8.length-1);}var A6=A8.lastIndexOf(" ");var Al=A8.length-1-A6;if(Al===3){A8=A8.substr(0,A8.length-3)+" ...";}else{var BA=0,Ao="",BC=0;while(BA<Aw&&A8.length>BC){BC++;Ao=A8.substr(A8.length-BC,A8.length);BA=this.measureTextWidth(Ao,A2);}A8=A8.substr(0,A8.length-BC)+"...";}}}if(A1){return{text:A8,truncated:As,maxLineLen:Am,canWordWrap:Az};}return A8;},measureSuperTextWidth:function AA(Ak,Al,Aj,Am){return Ak?this.measureTextWidth("<sup>"+Al+"</sup>",Aj,Am):this.measureTextWidth(Al,Aj,Am);},splitTokenIfTooLong:function k(Au,As,Am){var Aq=[];var Ar=Au.length;var An,Ak,Av,Ap,Aw;for(An=0;An<Ar;An++){Ak=Au[An];Ap=Ak.isSuper;while(true){Av=Ak.v;if(Ak.textWidth!==undefined){Aw=Ak.textWidth;}else{Aw=Ak.textWidth=this.measureSuperTextWidth(Ap,Av,Am);}if(Aw>As){var At=(As/Aw)*Av.length;var Aj=Math.max(Math.round(At),1);while(Aj>0){var Ao=Av.substr(0,Aj);var Al=Math.round(this.measureSuperTextWidth(Ap,Ao,Am));if(Al<=As||Aj===1){Aq.push({v:Ao,isSuper:Ap,textWidth:Al});break;}else{Aj--;}}Ak={v:Av.substr(Aj,Av.length-Aj),isSuper:Ap};}else{Aq.push(Ak);break;}}}return Aq;},truncateTextToLineWithWordWrapForTokens:function AX(At,An,BC,A4,BD,Az){var A7=At.length;At=this.splitTokenIfTooLong(At,BC,An);var BB,Ay=[],Aj=0,A2=At.length,Ak=0,A3=false,Ap=(A7===At.length),Ar,Aw,A5,Al,A9,As,Ax;if(Az&&!Ap){return{canWordWrap:Ap};}Ay.push(0);for(BB=0;BB<A2;BB++){Ar=At[BB];A5=Ar.v;Aw=Ar.isSuper;if(Ar.textWidth!==undefined){Al=Ar.textWidth;}else{Al=Ar.textWidth=this.measureSuperTextWidth(Aw,A5,An);}if(Al>BC){var BA=(BC/Al)*A5.length;Ar.v=A5.substr(0,parseInt(BA,10));Al=Ar.textWidth=BC;}Aj+=Al;Ay.push(Aj);}var Av,A6,Au=A4;for(Av=0,A6=0;A6<Ay.length;){var Aq=Ay[A6]-Ay[Av];var Ao=Ay[A6+1]-Ay[Av];if(Aq<=BC&&((A6+1===Ay.length)||(Ao>BC))){Ak=Math.max(Ak,Aq);Au--;if(Au===0||A6===A2){break;}else{Av=A6;A6++;}}else{A6++;}}if(A6>A2){A6=A2;}var A1=Ay[A6]-Ay[Av];var BE;if(A6>=A2&&A1<BC){BE=At;}else{A3=true;Ak=BC;BE=At.slice(0,A6);var Am=this.measureTextWidth("...",An);if(A1+Am<=BC){As=At[A6];A5=As.v;Aw=As.isSuper;for(A9=1;A9<A5.length;A9++){Ax=this.measureSuperTextWidth(Aw,A5.substr(0,A9),An);if(A1+Am+Ax>BC){break;}}if(A9>1){Ar={v:A5.substr(0,A9-1),isSuper:Aw};Ar.textWidth=this.measureSuperTextWidth(Aw,Ar.v,An);BE.push(Ar);BE.push({v:"...",textWidth:Am});}}else{var A0=0,A8;for(BB=BE.length-1;BB>=0;BB--){Ar=BE[BB];A5=Ar.v;Aw=Ar.isSuper;A8=0;for(A9=A5.length-1;A9>=0;A9--){A8=this.measureSuperTextWidth(Aw,A5.substr(A9),An);if(A0+A8>=Am){break;}}if(A9>=0){break;}else{A0+=A8;}}if(BB>=0){if(A9>0){Ar.v=A5.substr(0,A9);Ar.textWidth=this.measureSuperTextWidth(Aw,Ar.v,An);BE=BE.slice(0,BB+1);}else{if(A9===0){BE=BE.slice(0,BB);}}BE.push({v:"...",textWidth:Am});}else{BE=[{v:"...",textWidth:Am}];}}}if(BD){return{text:BE,truncated:A3,maxLineLen:Ak,canWordWrap:Ap};}return BE;},getRankMode:function P(Ap){var Ar=1,Aq=2,Ao=3,Ak=4,Am=5,Aj=6,An=7,Al=W.INVALID;if(Ap){if(AT(Ap,Ao,Aq)){Al=W.TOP_PERCENT;}else{if(AT(Ap,Ao,Ar)){Al=W.BOTTOM_PERCENT;}else{if(AT(Ap,Aj,Ak)){Al=W.BOTTOM;}else{if(AT(Ap,Aj,Am)){Al=W.TOP;}else{if(AT(Ap,An)){Al=W.VALUE;}}}}}}return Al;},getColorByTitle:function b(Ak,Aj){if(Aj===W.BOTTOM_PERCENT||Aj===W.TOP_PERCENT){Ak=mstrmojo.desc(2787,"Percentage of ##").replace("'##'",Ak);}else{if(Aj===W.BOTTOM||Aj===W.TOP){Ak=mstrmojo.desc(2788,"Rank of ##").replace("'##'",Ak);}}return Ak;},getColorByFormatStr:function j(Ak,Aj){if(Aj===W.BOTTOM_PERCENT||Aj===W.TOP_PERCENT){Ak="0%;(0%)";}else{if(Aj===W.BOTTOM||Aj===W.TOP){Ak="";}}return Ak;},getColorByItems:function AY(Aj,At,A0,Aw,Ar,Ap,Ax){var Av=[],A1,Al,Aq=mstrmojo.num,Ao,As;if(Aj===undefined||Aj.length===0){return Av;}var A3=true;if(Aj.length>1){if(Aj[0].ceil===Aj[1].flr){A3=false;}else{A3=true;}}for(A1=0;A1<Aj.length;A1++){var A2=Aj[A1],An={},Ak=A2.ceil,Az=A2.flr;if((A1===0&&A3)||(A1===Aj.length-1&&!A3)){if(At===W.BOTTOM_PERCENT||At===W.TOP_PERCENT){An.flr=Az/100;An.ceil=1;}else{if(At===W.TOP||At===W.BOTTOM){Az+=1;An.flr=Math.floor(Az);An.ceil=Ar;}else{An.flr=Az;An.ceil=A0;}}As=An.ceil;}else{if((A1===0&&!A3)||(A1===Aj.length-1&&A3)){if(At===W.BOTTOM_PERCENT||At===W.TOP_PERCENT){An.flr=0;An.ceil=Ak/100;}else{if(At===W.TOP||At===W.BOTTOM){An.flr=0;An.ceil=Math.floor(Ak);}else{An.flr=Aw;An.ceil=Ak;}}Ao=An.flr;}else{if(At===W.BOTTOM_PERCENT||At===W.TOP_PERCENT){Az=Az/100;Ak=Ak/100;}else{if(At===W.TOP||At===W.BOTTOM){Az+=1;Az=Math.floor(Az);Ak=Math.floor(Ak);}}An.flr=Az;An.ceil=Ak;}}if(At===W.TOP||At===W.BOTTOM){An.ceil=An.ceil>Ar?Ar:An.ceil;}if(Ap){An.label=Aq.formatByMask(Ap,An.flr);if(An.flr!==An.ceil){An.label+=" - "+Aq.formatByMask(Ap,An.ceil);}}else{An.label=An.flr;if(An.flr!==An.ceil){An.label+=" - "+An.ceil;}}if(A2.fmt&&A2.fmt.bc){An.color=A2.fmt.bc;}else{An.color=Ax;}Av.push(An);}Av=Av.filter(function(A4){return A4.flr<=A4.ceil&&!(A4.flr>As||A4.ceil<Ao);});if(At!==W.VALUE){if(Av[0]&&(Av[0].label===0)){Av.shift();}}if(At===W.TOP||At===W.BOTTOM){Al=Ar;}else{if(Av.length>0){if(A3){Al=Av[0].ceil-Av[(Av.length-1)].flr;}else{Al=Av[(Av.length-1)].ceil-Av[0].flr;}}}var Ay=0,Au,Am;for(A1=0;A1<Av.length;A1++){if(A1===Av.length-1){Av[A1].scopePercent=1-Ay;}else{if(At===W.TOP||At===W.BOTTOM){Am=Av[A1].ceil-Av[A1].flr+1;}else{Am=Av[A1].ceil-Av[A1].flr;}Au=Am/Al;Av[A1].scopePercent=Au;Ay+=Au;}}return Av;},getDefaultColorByItems:function(Am,Ak,Al){var Aj={};Aj.label=Al+" - "+Ak;Aj.flr=Al;Aj.ceil=Ak;Aj.color=Am;Aj.scopePercent=1;return[Aj];},getNumberFormat:function(Am,Ak){var An=Am.nf,Al=Am.gvs;function Aj(){var Aq=(Al&&Al.items&&Al.items[0]&&Al.items[0].items)||[],Ap=Aq[Ak]||{},Ao=Ap.nfs;return typeof Ao==="string"?Ao:"";}if(An&&An[Ak]&&typeof An[Ak].nfs!=="string"){An[Ak].nfs=Aj();}return An&&An[Ak]&&An[Ak].nfs;},hasOnlyMetricsOnColumn:function(Ak){var Aj=(Ak&&Ak.gts&&Ak.gts.col)||[];return Aj.every(function(Al){return Al.otp===s.DssTypeUnknown&&(Al.es||[]).every(function(Am){return Am.otp===s.DssTypeMetric;});});},hasNoMetricOnRow:function(Ak){var Al=(Ak&&Ak.gts&&Ak.gts.row)||[],Aj=function(Am){return Am.otp!==s.DssTypeMetric;};return Al.every(Aj);},getAttMetricCount:function(){var Am=this.getEditingGridData&&this.getEditingGridData()||this.model&&this.model.data,Aq=Am&&Am.gsi,Ap=Aq&&Aq.rows||[],Al=Aq&&Aq.cols||[],Ak=[].concat(Ap).concat(Al),Ao=Aq&&Aq.mx||[],Aj=0,An=Ao.length;Ae.forEach(Ak,function(Ar){if(Ar.t!==s.DssTypeMetric){Aj++;}});return{attCount:Aj,metricCount:An};},isOnExpressMode:function(){return mstrApp.isExpress;},modifyScExp:function(Ar,Aj,Av,Ap){if(!Ar||!Aj){return ;}var Am=Ar.nds,Aq,Ak,As,Au,At,Ao,An,Al;Ae.forEach(Am||[],function(Aw){Aq=Aw.nds;Ae.forEach(Aq||[],function(Ax){Ak=Ax.es;Ae.forEach(Ak||[],function(Ay){Au=Ay.v;Ao=Ap[Au];if(!Ao){Ao=Av.getNormalizedFormElementId(Au);Ap[Au]=Ao;}Ae.forEach(Aj||[],function(Az){As=Az.es;Ae.forEach(As||[],function(A0){Al=false;At=A0.id;if(At===Au){Al=true;}else{An=Ap[At];if(!An){An=Av.getNormalizedFormElementId(At);Ap[At]=An;}if(Ao===An){Al=true;}}if(Al){Ay.v=A0.id;Ay.n=A0.n;return false;}});if(Al){return false;}});});});});},modifyScExpDeprecated:function(Ap,Aq,An,Al){if(!Ap||!Aq){return ;}var Am=Ap.nds,Ak,Aj,Ao;Ae.forEach(Am||[],function(Ar){Ak=Ar.nds;Ae.forEach(Ak||[],function(As){Aj=As.es;Ae.forEach(Aj||[],function(At){Ae.forEach(Aq||[],function(Au){Ae.forEach(Au||[],function(Av){Ao=Av.es;Ae.forEach(Ao||[],function(Aw){if(An.call(Al,Aw.id,At.v)){At.v=Aw.id;At.n=Aw.n;}});});});});});});},getMouseOffset:function(Ak){var Aj=(Ak.offsetX!==undefined)?Ak.offsetX:(Ak.layerX),Al=(Ak.offsetY!==undefined)?Ak.offsetY:(Ak.layerY);return{x:Aj,y:Al};},translateLineStyle:function(Aj){var Al=["none","solid","solid","dashed","dotted"],Ak=["1px","1px","2px","1px","1px"];return{width:Ak[Aj]||"0px",style:Al[Aj]||"none"};},getVisStyle:function(){var Aj=mstrmojo.VisUtility;return Aj.getPropertyByPath(this,"model.data.visName")||Aj.getPropertyByPath(this,"model.data.vis.vn");},getGroupAndCalculationContextMenuForDataPoints:function(Av,BA){var Ax,Az=[],Al=[],A7=[],Aq=BA.fnCellName,A1=BA.fnUnique,Ap=BA.fnMakeNode,A5=Av.getCellForNode.bind(Av),BC=BA.selection,A4=BA.hideGroupMenu,Au=BA.hideCalculationMenu;var Ao=new h.ui.menus.MenuConfig(),Ak=new h.ui.menus.MenuConfig(),A3=new h.ui.menus.MenuConfig(),A9=new h.ui.menus.MenuConfig();function BB(BD){Av.cmSelCells=Az[BD].cmSelCells;Av.derivedElementGroup(A5(Av.cmSelCells[0]));}function Ar(BD){Av.cmSelCells=Al[BD].cmSelCells;Av.derivedElementsEdit(A5(Av.cmSelCells[0]));}function A0(BD){Av.cmSelCells=Al[BD].cmSelCells;Av.removeQuickDE(A5(Av.cmSelCells[0]));}function Ay(BD){Av.cmSelCells=Al[BD].cmSelCells;Av.renameDEList(A5(Av.cmSelCells[0]));}function A2(BD){X(Av,A5(Av.cmSelCells[0]),BD,false);}function Aj(BD){X(Av,A5(Av.cmSelCells[0]),BD,true);}function An(BE){var BD=A5(Al[BE].cmSelCells[0]);Av.removeQuickDE(BD);}function A8(BE){var BD=A5(Al[BE].cmSelCells[0]);Av.editDECalculation(BD);}function As(BE,BD){return function(){var BF=new h.ui.menus.MenuConfig();BF.addNonInteractiveMenuItem(mstrmojo.desc(11859,"Based on"),"xt",true);BF.addRadioMenuGroup(null,BE,BD,"checkMark",undefined,true);return BF;};}function Aw(BD){BD=BD||[];function BE(BI){var BF=BI.extra||{},BJ=BI.setup||mstrmojo.emptyFn,BG=BI.action||mstrmojo.emptyFn,BH=[];BJ(BH,BF);BG(BH,BF);}BD.forEach(BE);}var Am=[{name:"group",setup:function(BD){Az.forEach(function(BE){Av.cmSelCells=Az[BE.v].cmSelCells;if(!Object.prototype.hasOwnProperty.call(Al,BE.v)&&Z(Av)){BD.push(BE);}});},action:function(BE){var BD;if(BE.length===1){BD=BE[0].v;Ao.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){Av.cmSelCells=Az[BD].cmSelCells;Av.derivedElementGroup(A5(Av.cmSelCells[0]));});}if(BE.length>1){Ao.addPopupMenuItem(mstrmojo.desc(1911,"Group"),Av.id,As(BB,BE),"xt");}}},{name:"edit-group",setup:function(BD){Al.forEach(function(BF){var BE=Af(Av,Al[BF.v].cmSelCells[0]);if(BE&&BE.t===V.LIST){BD.push(BF);}});},action:function(BE){if(BE.length===1){var BD=Al[BE[0].v].cmSelCells,BF=A5(BD[0]);Ak.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){Av.cmSelCells=BD;Av.derivedElementsEdit(BF);});Ak.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){Av.cmSelCells=BD;Av.removeQuickDE(BF);});A9.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){Av.cmSelCells=BD;Av.renameDEList(BF);});}if(BE.length>1){Ak.addPopupMenuItem(mstrmojo.desc(13395,"Edit Group..."),Av.id,As(Ar,BE),"xt");Ak.addPopupMenuItem(mstrmojo.desc(12195,"Ungroup"),Av.id,As(A0,BE),"xt");A9.addPopupMenuItem(mstrmojo.desc(13968,"Rename Group..."),Av.id,As(Ay,BE),"xt");}}},{name:"calculation",setup:function(BD){A7.forEach(function(BG,BF,BE){Av.cmSelCells=BE[BG.v].cmSelCells;var BH=Af(Av,Av.cmSelCells[0]);if(!(BH&&BH.t===V.RESIDUE)&&n(Av)){BD.push(BG);}});},action:function(BD){if(BD.length===1){Ao.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),Av.id,function(){var BE=BD[0].v,BF=new h.ui.menus.MenuConfig();Av.cmSelCells=A7[BE].cmSelCells;BF.addRadioMenuGroup(null,A2,o(Av,null,Aq).items,"checkMark",undefined,true);return BF;},"xt");}if(BD.length>1){Ao.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),Av.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"base-on-calculation-editor",data:{},hasToggleItem:true,contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:BD,selectedIndex:0,onitemSelected:function(BE){var BF=BE.v;Av.cmSelCells=A7[BF].cmSelCells;this.parent.checkList.set("items",[]);this.parent.checkList.set("items",o(Av,null,Aq).items);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(BF,BE){X(Av,A5(Av.cmSelCells[0]),BE.checkList.selectedItem.v,false);}});});}}},{name:"edit-calculation",setup:function(BD){Al.forEach(function(BF){var BE=Af(Av,Al[BF.v].cmSelCells[0]);if(BE&&BE.t===V.CALCULATION&&n(Av)){BD.push(BF);}});},action:function(BD){function BE(){var BF=BD[0].v;Av.cmSelCells=Al[BF].cmSelCells;var BI=Af(Av,Av.cmSelCells[0]),BH=o(Av,BI,Aq),BG=new h.ui.menus.MenuConfig();BG.addRadioMenuGroup(BH.selectedItem.value,Aj,BH.items,"checkMark",undefined,true);return BG;}if(BD.length===1){A3.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),Av.id,BE,"xt");A3.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){var BF=BD[0].v;Av.cmSelCells=Al[BF].cmSelCells;var BG=A5(Av.cmSelCells[0]);Av.removeQuickDE(BG);});A9.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){var BF=BD[0].v;Av.cmSelCells=Al[BF].cmSelCells;var BG=A5(Av.cmSelCells[0]);Av.editDECalculation(BG);});}if(BD.length>1){A3.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),Av.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"base-on-calculation-editor",data:{},hasToggleItem:true,contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:BD,selectedIndex:0,onitemSelected:function(BG){var BH=BG.v;Av.cmSelCells=Al[BH].cmSelCells;var BI=Af(Av,Av.cmSelCells[0]);var BF=o(Av,BI,Aq);this.parent.checkList.set("items",[]);this.parent.checkList.set("items",BF.items);this.parent.checkList.set("selectedItem",BF.selectedItem);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(BG,BF){X(Av,A5(Av.cmSelCells[0]),BF.checkList.selectedItem.v,true);}});});A3.addPopupMenuItem(mstrmojo.desc(12197,"Delete Calculation"),Av.id,As(An,BD),"xt");A9.addPopupMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),Av.id,As(A8,BD),"xt");}}}];Ax=A1(BC);Ax.forEach(function(BE){var BG=Ap(BE),BD=A5(BG),BF,BH,BI;if(!Av.model.supportsViewFilterActions(BD.tid)){return ;}BF=BD.dei===undefined?Az:Al;BH=BD.tid;BI=Av.model.getObjectInfo(BH).n;if(BF[BH]===undefined){BF[BH]={};BF[BH].cmSelCells=[];BF.push({n:BI,v:BH,text:BI,value:BH});}BF[BH].cmSelCells.push(BG);if(A7[BH]===undefined){A7[BH]={};A7[BH].cmSelCells=[];A7.push({n:BI,v:BH,text:BI,value:BH});}A7[BH].cmSelCells.push(BG);});var At=mstrmojo.VisUtility;var A6=At.getVisStyle.call(Av);if(A6===z.HEAT_MAP){Am.splice(2,2);}if(A4){Am.splice(0,2);}if(Au){Am.splice(2,2);}Aw(Am);return{createDe:Ao,editGroup:Ak,editCalculation:A3,renameDe:A9};},getGroupAndCalculationContextMenu:function(As,A7,A4){var A6=As,Az=A4.skipSingleAttrCheck||A6.isSingleAttrSelection(),Am=false,Ao=A6.isSingleContextMenuSelection(),At=A6.getDEInfo(A7),An=At&&At.deObject,A3=At&&At.de,Ax=An&&A6.getOthersDEInfo(An),Av=A6.getContextMenuSelections(),A2=true,Aq=A4.fnCellName,A5=this.getPropertyByPath(A6,"model.data.visName")||this.getPropertyByPath(A6,"model.data.vis.vn"),A0=A4.hideGroupMenu,Ar=A4.hideCalculationMenu;var Ap=new h.ui.menus.MenuConfig(),Ak=new h.ui.menus.MenuConfig(),Aw=new h.ui.menus.MenuConfig(),A1=new h.ui.menus.MenuConfig();A6.cmSelCells=A4.selection;if(As.model.supportsViewFilterActions(A7.tid)){if(!A0){if((Am||Az)&&AR(A7,x)&&Z(A6)){Ap.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){As.derivedElementGroup(A7);});}if(Ao&&A3&&A3.t===V.LIST){Ak.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){As.derivedElementsEdit(A7,At);});Ak.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){As.removeQuickDE(A7);});A1.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){As.renameDEList(A7);});}}if(!Ar){var Au=function(A8){X(A6,A7,A8,false);},Ay=function(A8){X(A6,A7,A8,true);};if(Ax&&!Ao&&Az){U.forEach(Av,function(A8){if(A8[0]&&A8[0].eid.indexOf(Ax.id)>-1){A2=false;return false;}});}if(A5!=="VIHeatMapVisualizationStyle"&&!(Ao&&A3&&A3.t===V.RESIDUE)&&(Am||Az)&&AR(A7,AG)&&n(A6)){var Aj=function(){var A8=new h.ui.menus.MenuConfig(),A9=o(A6,null,Aq);A8.addRadioMenuGroup(null,Au,A9.items,"checkMark",undefined,true);return A8;};Ap.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),this.id,Aj,"xt");}if(Ao&&A3&&A3.t===V.CALCULATION&&n(A6)){var Al=function(){var A8=new h.ui.menus.MenuConfig(),A9=o(A6,A3,Aq);A8.addRadioMenuGroup(A9.selectedItem.value,Ay,A9.items,"checkMark",undefined,true);return A8;};Aw.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),this.id,Al,"xt");Aw.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){As.removeQuickDE(A7);});A1.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){As.editDECalculation(A7);});}}}return{createDe:Ap,editGroup:Ak,editCalculation:Aw,renameDe:A1};},isHostedPopupNode:function(Am,Al,Ak,Aj){return AJ(Am,Al,"mstrmojo-popup-widget-hosted",Ak,Aj);},isMojoEditorNode:function(Am,Al,Ak,Aj){return AJ(Am,Al,"mstrmojo-Editor",Ak,Aj);},applyStyle2Legend:function(Am,Al,Ak){var Aj,Ao={},An={};for(Aj in Am){if(Aj.indexOf("font")>=0||Aj.indexOf("color")>=0||Aj.indexOf("textDecoration")>=0){Ao[Aj]=Am[Aj];}else{An[Aj]=Am[Aj];}}if(Al){Al.style.background="";this.applyStyles2DomNode(Al,An);}if(Ak){this.applyStyles2DomNode(Ak,Ao);}},mergeMenuConfigs:function AI(Ak,Aj){function Al(An,Ao,Am){if(!Ao){return ;}if(!Am&&An.hasMenuItems()&&Ao.hasMenuItems()){An.addSeparator();}if(Ao.hasMenuItems()){An.absorbMenuItems(Ao);if("function"===typeof Ao.destroy){Ao.destroy();}}}return Aj.reduce(function(Am,An){Al(Am,Ak[An.name],An.noSeparator);return Am;},new mstrmojo.ui.menus.MenuConfig());},absorbMenuItems:function(Ak,Aj,Al){Ak.addDisposable(Aj);Ak.absorbMenuItems(Aj);if(Al&&Aj.menus.length>0){Ak.addSeparator();}},addWheelListener:(function(){var Am=mstrmojo.dom,Al=Am.attachEvent,Ak=Am.preventDefault,An;function Aj(Ar,Aq,As,Ap){var Ao=(An==="wheel")?As:function(At){if(!At){At=window.event;}var Av={originalEvent:At,target:At.target||At.srcElement,type:"wheel",deltaMode:(At.deltaMode!==undefined?At.deltaMode:1),deltaX:0,deltaZ:0,preventDefault:function(){Ak(window,At);}},Au=this;if(An==="mousewheel"){Av.deltaY=-At.wheelDelta;if(At.wheelDeltaX!==undefined){Av.deltaX=-At.wheelDeltaX;}}else{Av.deltaY=At.detail;}return As.call(Au,Av);};return Al(Ar,Aq,Ao,Ap);}if(Object.prototype.hasOwnProperty.call(document.createElement("div"),"onwheel")){An="wheel";}else{An=document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";}return function(Ap,Aq,Ao){return Aj(Ap,An,Aq,Ao);};}()),isNearZero:function(Ak,Aj){Aj=Aj||5;var Al=1/Math.pow(10,Aj);return(Math.abs(Ak)<Al);},hasMergedRowCells:function(Aj){return false;},getMockUpThresholds:function(Al,Am){var Aj=[{tid:1,n:"threshold 0",scope:1,rtp:2,rtxt:"",fmt:{bc:"#cc2525",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,flr:0,ceil:10},{tid:2,n:"threshold 1",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e34b4b",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5},{v:"30%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:10,ceil:30},{tid:3,n:"threshold 2",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e97d7d",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"30%",dtp:5},{v:"50%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:30,ceil:50},{tid:4,n:"threshold 3",scope:1,rtp:2,rtxt:"",fmt:{bc:"#79d479",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"50%",dtp:5},{v:"70%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:50,ceil:70},{tid:5,n:"threshold 4",scope:1,rtp:2,rtxt:"",fmt:{bc:"#57ba57",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"70%",dtp:5},{v:"90%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:70,ceil:90},{tid:6,n:"threshold 5",scope:1,rtp:2,rtxt:"",fmt:{bc:"#2ca02c",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"90%",dtp:5}],fn:5,fnt:3}],fn:19},ttp:1,flr:90,ceil:100}];U.forEach(Aj,function(Ao){var An=Ao.expr.nds[0].m;An.did=Al;An.n=Am;});var Ak={};Ak[Al]=Aj;return Ak;},generateThresholdsInfo:function(Al,Aq,Aj,An){var Ap=Aj.length,Ak=[],At,Am,Au=0,As=0;for(var Ao=0;Ao<Ap;Ao++){Am=Math.round(An[Ao]*100);As=Au;Au=Am||100;At={tid:Ao+1,n:"threshold "+Ao,scope:1,rtp:2,rtxt:"",fmt:{bc:Aj[Ao],bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:Al,n:Aq},cs:[{v:Am+"%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,ceil:Au,flr:As};Ak.push(At);}var Ar={};Ar[Al]=Ak;return Ar;},psPt2CssPt:function(Al,Ak){var Aj=parseInt(Al,10)*0.75;if(Ak instanceof Function){Aj=Ak(Aj);}return Aj+"pt";},captureEventOnce:function(Ao,An,Aj,Am,Al){function Ak(Ap){An.call(Aj,AZ.newDomEvent(Ao,window,Ap||window.event),Al);AE.detachEvent(Am,Ao,Ak);}Al=Al||{};Am=Am||document;AE.attachEvent(Am,Ao,Ak);},getPropertyByPath:function(An,Am,Aj){var Ak,Al;if(typeof Am!=="string"){return Aj;}Ak=Am.split(".");Al=Ak.every(function(Ap){var Ao=An[Ap];if(Ao!==undefined){An=Ao;return true;}return false;});return Al?An:Aj;},mergeHashes:function(){return Array.prototype.slice.apply(arguments).reduce(function(Aj,Ak){if(Ak){Object.keys(Ak).forEach(function(Al){Aj[Al]=Ak[Al];});}return Aj;},{});},toggleControlEnabled:function(Aj,Ak){[].concat(Aj).forEach(function(Al){Al.set("enabled",!!Ak);});},findInArray:function(Am,Al,Ak){var Ao=-1,An,Aj;if(!Array.isArray(Am)){return Ao;}for(An=Ak===undefined?0:Ak,Aj=Am.length;An<Aj;An+=1){if(Al(Am[An])){return An;}}return Ao;},arrayUnique:function(Aj,Al){if(!Array.isArray(Aj)){return Aj;}var Ak=mstrmojo.VisUtility;return Aj.filter(function(Am,An){return Ak.findInArray(Aj,function(Ao){return Al(Am,Ao);},An+1)===-1;});},range:function(Aj,An,Am){Am=Am||1;var Al,Ak=[];for(Al=Aj;Al!==An;Al+=Am){Ak.push(Al);}return Ak;},drawDashLine:function J(Ar,Al,Ap,Ak,An,Aj,Aq){var Ao=(Al===Ak),Am;Ar.beginPath();Ar.moveTo(Al,Ap);if(Ao){Am=0;Ap+=Aj;while(Ap<=An){if(Am%2===0){Ar.lineTo(Al,Ap);Ap+=Aq;}else{Ar.moveTo(Al,Ap);Ap+=Aj;}Am++;}if(Am%2===0){Ar.lineTo(Ak,An);}}else{Am=0;Al+=Aj;while(Al<=Ak){if(Am%2===0){Ar.lineTo(Al,Ap);Al+=Aq;}else{Ar.moveTo(Al,Ap);Al+=Aj;}Am++;}if(Am%2===0){Ar.lineTo(Ak,An);}}Ar.stroke();},repeat:function(Al,Am){var Aj=[],Ak;Am=Math.max(0,Am);for(Ak=0;Ak<Am;Ak+=1){Aj[Ak]=Al;}return Aj;},isHierarchyObject:function(Aj){return(Aj&&Aj.t)===s.DssTypeDimension;},selectDropZonePanel:function(Aj){AC(Aj,"editPanel");},selectPropertyPanel:function(Ak,Al){AC(Ak,"propertiesPanel");var Aj=Ak.edtModel;if(Aj){Aj.selectTargetByValue(Al);}},pluck:function(Ak,Aj){if(!U.isArray(Ak)){return Ak;}return Ak.map(function(Al){return Al&&Al[Aj];});},pick:function(Ak,Aj){return Aj.reduce(function(Am,Al){Am[Al]=Ak[Al];return Am;},{});},isColorManuallySet:function(Al,Ak){var Aj=Ag(Al,Ak);if(Aj){return Aj.isManual;}},getCombColor:function(Al,Ak){var Aj=Ag(Al,Ak);if(Aj){return Aj.color;}},setColorPickerShowAutomatic:function(Ak,Aj){Ak.children[0].fillColor.colorPicker.showAutomatic=Aj;},getCharGroupValueChangeCb:function(Aj){var Ak=(function(){var Al={};Al[AS.FONT_WEIGHT]=AW.FS_BOLD;Al[AS.FONT_STYLE]=AW.FS_ITALIC;Al[AS.UNDERLINE]=AW.FS_UNDERLINE;Al[AS.LINE_THROUGH]=AW.FS_STRIKETHROUGH;return function(Am,An){return Am^Al[An];};}());return function(Am,Al){if(Aj instanceof Function){Aj=Aj();}if(!Aj){return ;}switch(Am){case AS.COLOR:Aj.fontColor.fill.value.setValue(Al);break;case AS.FONT_SIZE:Aj.fontSize.setValue(Al);break;case AS.FONT_FAMILY:Aj.fontFamily.setValue(Al);break;case AS.FONT_WEIGHT:case AS.FONT_STYLE:case AS.UNDERLINE:case AS.LINE_THROUGH:Aj.fontStyle.setValue(Ak(Aj.fontStyle.getValue(),Am));break;}};},getMetricsInDropZone:AO,addLegendFontChangeListeners:function(Ak,Al){var Aj=["lgdFntClr","lgdFntSz","lgdFntFml","lgdFntStyle"];Aa(Aj,Ak,Al);},addLegendBackgroundChangeListeners:function(Ak,Al){var Aj=["lgdBgFillClr","lgdBgFillTrans"];Aa(Aj,Ak,Al);},isValidDropZone:function(Aj){if(Aj===undefined){return false;}var Al=Object.keys(Aj).filter(function(Am){return Am!=="visProp";});var Ak=Y.copyProps(Al,Aj);return Aj&&!Y.equals(Ak,{});},unitExistInTemplate:function(Am,Aj){var Al,Ao,An=Aj.row,Ak=Aj.col;for(Al=0,Ao=An.length;Al<Ao;Al++){if(An[Al].id===Am){return true;}}for(Al=0,Ao=Ak.length;Al<Ao;Al++){if(Ak[Al].id===Am){return true;}}return false;},findDisabledUnits:function(As,At){var Ao,Ak,Am=At.docModel.datasets,Aj=As.gts,Aq=As.datasetId,An=Am[Aq]||{},Ap=An.att||[],Ar=[];var Al=mstrmojo.VisUtility;if(Ap){for(Ao=0,Ak=Ap.length;Ao<Ak;Ao++){if(!Al.unitExistInTemplate(Ap[Ao].did,Aj)){Ar.push(Ap[Ao]);}}}return Ar;},getDrillCandidates:function(Ao,Ap){var Ar=Ao.modelData,At=Ao.model,An=At.docModel.datasets,Aj=Ar.gts,Al=mstrmojo.VisUtility,Au=Al.findDisabledUnits(Ar,At),Ak=[],Am=(function(){var Av;if(Ap){U.forEach(Aj.row.concat(Aj.col),function(Aw){if(Aw.id&&Aw.id===Ap){Av=Aw.dp;}});}return Av;}()),Aq=function(Av,Ay){var Aw=U.find(Av,"did",Ay.id),Ax=Av[Aw];if(Ax&&!Ax.hide){Ay.n=Ax.n;return true;}return false;},As=U.filter(Am,function(Ax){var Av;for(Av in An){var Aw=An[Av];if(Aq(Aw.att,Ax)){return true;}}return false;});if(As){Ak=U.filter(Au,function(Aw){for(var Av in As){if(As[Av].n===Aw.n){return true;}}return false;});}return Ak;},getDrillSubMenu:function(Aj){if(!Aj||!Aj.items||!Aj.drillAction){return{};}var An=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,isHostedWithin:false,alignWithAnchor:true,maxHeight:350}),Ak=Aj.items,Am=Aj.drillAction,Al=[];if(mstrmojo.resolveFeature("sort-drill-paths")){Ak.sort(function(Ap,Ao){if(Ap.n>Ao.n){return 1;}if(Ap.n<Ao.n){return -1;}return 0;});}Ak.forEach(function(Aq,Ao){if(Al.indexOf(Aq.did)===-1){Al.push(Aq.did);if(Aq.att){var Ap=mstrmojo.VisUtility;var Ar={};Y.copy(Aj,Ar);Ar.items=Ak[Ao].att;An.addPopupMenuItem(Aq.n,this.id,Ap.getDrillSubMenu,"xt",Ar);}else{An.addMenuItem(Aq.n,"xt",Am,Y.copy(Aj,{drillUnit:Aq}));}}});return An;},getDrillMenu:function(Ap,Aq,Av,Aj){var Ar=Ap.model,Am=mstrmojo.VisUtility,As=Am.getDrillCandidates(Ap,Aq),At=As.length,Ao=Ar.docModel,Al=Ao.datasets[Ap.modelData.datasetId],Az,Au=[],Ax=-1,Aw,Ay,An,Ak;if(Al&&Ao.isMDXDataset(Al)){Am.sortMdxDrillCandidates(As);Az=Al.tables[0];Az.dimensions.forEach(function(A0){An=true;Aw=-1;A0.hierarchies.forEach(function(A1){Ak=true;A1.att.forEach(function(A2){Ay=Ae.findBin(As,A2,"did",At);if(Ay!==-1){if(An){Au.push({id:A0.did,did:A0.did,n:A0.n,att:[]});Ax++;An=false;}if(Ak){Au[Ax].att.push({id:A1.did,did:A1.did,n:A1.n,att:[]});Aw++;Ak=false;}Au[Ax].att[Aw].att.push(As[Ay]);}});});});}else{Au=As;}return Am.getDrillSubMenu(Y.copy(Aj,{items:Au,drillAction:Av}));},sortMdxDrillCandidates:function(Aj){Aj.sort(function(Al,Ak){if(Al.did<Ak.did){return -1;}if(Al.did>Ak.did){return 1;}return 0;});return Aj;},getDrillMenuItemsCallback:function(Al,Am,Aj,Ak){return function(){var Ao=mstrmojo.VisUtility;var Ap=Ao.getDrillCandidates(Al,Ak),An=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:350});Ap.forEach(function(Aq){An.addMenuItem(Aq.n,"xt",Am,Y.copy(Aj,{drillUnit:Aq}));});return An;};},doDrill:function(Al,Az,Au,A0){var A1=Al;function Ar(A3){return A3.model.controller.cmdMgr;}function Ax(){return{success:function A3(){var A4=mstrmojo.VisUtility;A4.visPrint("reaise");this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}var Ak=A1.model,Ay=(A1.getDocModel&&A1.getDocModel())||A1.model.docModel,Aw=Ay.getDataService(),Ao=Aw.newUpdate();var Aq=true;if(Ay.prefs&&Ay.prefs.rtprnt){Aq=parseInt(Ay.prefs.rtprnt,10)===1;}else{if(Ak.xtab.defn.tkp!==undefined){Aq=parseInt(Ak.xtab.defn.tkp,10)===-1;}}A0=A0||{};A0.keepParent=Aq;var Ap=Au.call(Al,Az,A0);var As=A1.zonesModel,A2=As.getUpdateCallback(),At=A1.model.controller||Ay.controller,Am=At._getXtabCallback(A1);Ao.add(Ap,Ad(A2,Am));var Aj=Ak.getSelectorDataFromTemplateLimit(A1.model.data.tpl).concat({keepOnly:true,data:A1.getContextMenuSelections()}),Av=Ay.getKeepOnlyOrExcludeAction(A1.k,Aj);Ao.add(Av,Ax.call(A1));Ar(A1).execute({execute:function An(){this.submitUpdate(Ao);},urInfo:{callback:Ao.callback}});},strStartsWith:function(Al,Ak,Aj){Aj=Aj||0;return Al.lastIndexOf(Ak,Aj)===Aj;},changeWidgetBackground:function(Al,Am,Ak){var Aj=Al.parent;if(Aj&&Am!==Ak){Aj.changeUnitFormats(false,1,Al.getFormats(),AS.BACKGROUND_COLOR,Am,Ak);Aj.raiseEvent({name:"BEMFormatChange",propertyName:AS.BACKGROUND_COLOR,value:Am,isTitle:false});}},translateGridError:function(Ak,Aj){if(Aj===undefined){Aj=Ah.AE_ERROR;}if(Aj===Ah.EMPTY_DATA){Ak=mstrmojo.desc(2388,"No data returned for this view. This might be because the applied filter excludes all data.");}if(Aj===Ah.NO_DATASET||Aj===Ah.NO_TEMPLATE_UNIT){Ak=mstrmojo.desc(11668,"Drag objects here.");}if(!Ak){Ak=mstrmojo.desc(13687,"Unknown error");}return{msg:Ak,type:Aj};},hasValidValueInMetric:function(Am,Ak){var Aj=mstrmojo.VisUtility;var Al=Aj.getPropertyByPath(Am,"model.data.gsi.mx");if(Al===undefined||Al.length<=Ak||Ak<0){return false;}var An=Al[Ak];return["min","max"].every(function(Ao){var Ap=An[Ao];return Ap!==undefined&&Ap!==null&&Ap!=="";});},renderWidgetErrorRSD:function(Am,Ao,Ak){var Aq=document.createElement("div");var Ap='<div style="display: table; height: 100%; width: 100%; background-color:#F5F5F2; border: solid 1px #A7A7A7; box-sizing: border-box;"><div style="display: table-cell; vertical-align: middle; text-align: center; color: #000000; font-size: 14pt;">'+Ao+"</div></div>";Aq.innerHTML=Ap;Aq=Aq.firstChild;var Aj=Am.width,Al=Am.height;if(Aj!==undefined){Aq.style.width=Aj+"px";}if(Al!==undefined){Aq.style.height=Al+"px";}var An=Am.domNode;if(An){Ak.forEach(function(Ar){An["on"+Ar]=undefined;});while(An.firstChild){An.removeChild(An.firstChild);}An.appendChild(Aq);}else{Am.parent.domNode.appendChild(Aq);}},visPrint:function(){var Aj=mstrmojo.VisUtility.enableInVis;if(Aj&&window.mstr_profile&&mstr_profile.enabled&&console){Function.prototype.apply.call(console.log,console,arguments);}},hasCGorCon:function(Am,Aj){var Al=Aj&&Aj.did,Ak=Am.model.data.datasetId||"",An=null;if(Al){An=AU.getDatasetFromAttributeId(Am.model.docModel.datasets,Al);}else{if(Ak){An=AU.getDatasetFromId(Am.model.docModel.datasets,Ak);}}return An&&AU.hasCGorCon(An);},isCGorCon:function p(Am,Aj){var Al=Aj&&Aj.did,Ak=Am.model.data.datasetId||"",An=null;if(Al){An=AU.getDatasetFromAttributeId(Am.model.docModel.datasets,Al);}else{if(Ak){An=AU.getDatasetFromId(Am.model.docModel.datasets,Ak);}}return An&&AU.isCGorCon(Aj,An);},findElementsByAttribute:function S(Al,An,Am,Aj){Aj=!!Aj;var Ao=[];if(Am.constructor!==Array){Am=[Am];}var Ap=function(Aq){if(Aj){return Aq.identity&&Aq.identity.tlOpt&&Aq.identity.tlOpt[An];}else{return Aq.getAttribute(An);}};function Ak(As){var Aq=Ap(As),Ar;if(As.hasChildNodes()){Ar=As.firstChild;while(Ar){if(Ar.nodeType===1){Aq=Ap(Ar);if(Am.indexOf(Aq)!==-1){Ao.push(Ar);}else{Ak(Ar);}}Ar=Ar.nextSibling;}}}Ak(Al);return Ao;},restoreEsForUnit:function AQ(An){if(!An){return ;}var Ao=An.es,Ak=An.fs,Am=An.otp,Aj=Ak&&Ak.length||0;function Al(Ap){var Aq=document.createElement("div");Aq.innerHTML=Ap;return Aq.innerText;}if(Ao){U.forEach(Ao,function(Aq,Ap){Aq.n=d.decodeHtmlString(Aq.n);if(Am===s.DssTypeAttribute&&Aj){switch(Ak[Ap%Aj].bftp){case AM.DssBaseFormHTMLTag:Aq.n=Al(Aq.n);break;default:}}});}},isTrue:function AV(Aj){return Aj==="true"||Aj===true;},getFontFamilyItems:function u(){if(Q){return Q;}else{Q=[];U.forEach(R.Families.slice(1),function(Aj){Q.push({n:Aj.n,id:Aj.n,did:Aj.n,preview:!Aj.symbolic});});return Q;}},surroundWithQuotes:function AP(Aj){if(!Aj){return"";}return"'"+Aj.replace(/^['|"]+/,"").replace(/['|"]+$/,"")+"'";},sendToMobileDevice:function D(Aj){var Ak=Y.walk("webkit.messageHandlers.selectionDataJSONString",window);if(mstrApp.isDisplayOnMobile&&Ak){Ak.postMessage(Aj);return true;}return false;}});mstrmojo.VisUtility.enableInVis=true;}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.Label","mstrmojo.hash","mstrmojo.array","mstrmojo.ui.Checkbox","mstrmojo.css","mstrmojo.string","mstrmojo.threshold.ThresholdExprTree","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.models.FormatModel","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.threshold.ThresholdModel","mstrmojo.vi.util.NumberFormatUtility");mstrmojo.requiresDescs(2869,3397,5893,7978,7979,13788,13789,13790,13894,14599,14600,14601,14611);var M=mstrmojo.hash,I=mstrmojo.array,U=mstrmojo.css,B=mstrmojo.string,A=mstrmojo.models.FormatModel.decodeValue,J=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL,D=mstrmojo.vi.ui.DatasetUnitMenuUtils,K=12,L=mstrmojo.models.FormatModel.ENUM_NUMBER_FORMAT_KEYS_OBJ,N=mstrmojo.vi.util.NumberFormatUtility;function S(W){this.threshold.scope=W;}function C(c,X,W,b){var Y=this.previewNode;switch(c){case 10:var a=I.filterOne(J,function(d){return d.v===X;});if(a){Y.innerHTML=a.n;}break;case 4:U.addClass(Y,"hasImage");Y.innerHTML='<img class="replaceImg" src="'+B.encodeHtmlString(X)+'" />';break;default:var Z=B.encodeHtmlString(X)||(W===K?mstrmojo.desc(14611,"Sample"):"1234.567");if(!!b){Z=N.applyFormatToNumber(b,Z);}Y.innerHTML=Z;}}function E(Y,W){W.fontFamily="'"+(Y.ff||"").replace(/\'/g,"")+"'";W.fontSize=parseInt(Y.fsz,10)+"pt";W.fontWeight=Y.fw?"bold":"normal";W.textDecoration=(Y.fun?"underline":"")+" "+(Y.fst?"line-through":"");W.fontStyle=Y.fit?"italic":"";W.color=Y.fc;var X;if(!!Y.bc&&!!Y.bc.c1){X=U.buildGradient(Y.bc.or,Y.bc.c1,Y.bc.c2);if(X&&X.n){W[X.n]=X.v;}}else{if(!!Y.gdc){X=U.buildGradient(Y.gda===90?0:1,Y.bc,Y.gdc);if(X&&X.n){W[X.n]=X.v;}}else{W.backgroundColor=Y.bc;}}W.textAlign=Y.alh;W.verticalAlign=Y.alv;W.wordWrap=Y.atw;W.direction=Y.atd;var Z=Y.bts;W.border=Y.borderStyle||(Z?A("bts",Z):"1px dotted");W.borderColor=Y.borderColor||Y.btc||"#e1e1e1";}mstrmojo.threshold.ThresholdRow=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ThresholdRow",markupString:'<div id="{@id}" class="mstrmojo-thresholdRow cf {@cssClass}" style="{@cssText}" mstrAttach:click><div class="draggable-icon"></div><div class="container"></div><div class="previewWrap"><div class="preview"></div></div><div class="menu"></div><div class="delete"></div></div>',markupSlots:{containerNode:function P(){return this.domNode.children[1];},draggableNode:function O(){return this.domNode.firstChild;},previewNode:function P(){return this.domNode.children[2].firstChild;},menuNode:function P(){return this.domNode.children[3];},deleteNode:function G(){return this.domNode.children[4];}},threshold:undefined,idx:undefined,editor:undefined,model:undefined,lblIndex:undefined,chkBox:undefined,exprTree:undefined,postBuildRendering:function R(){this.destroyChildren(false);var W=this.threshold,X=this.model,Y=this.previewNode.style,a=M.copy(W.fmt,M.clone(X.getGridValueFormat())),Z=W.expr;C.call(this,W.rtp,W.rtxt,X.objectType,a.nfs);if(a){E(a,Y);}this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.Label",alias:"lblIndex",text:this.idx+1},{scriptClass:"mstrmojo.threshold.ThresholdExprTree",alias:"exprTree",editor:this.editor,model:this.model,items:[Z]}]);X.attachEventListener("selectedThresholdsChange",this.id,"onselectedThresholdsChange");return this._super();},onselectedThresholdsChange:function Q(){},onclick:function V(Z){var X=this.editor,b=Z.getTarget(),Y=this,W=this.model,a=X.objectType===K;if(b===this.deleteNode){this.removeFromModel();}else{if(b===this.menuNode){var c=new mstrmojo.ui.menus.MenuConfig();c.hostId=this.id;c.hostElement=this.menuNode;c.isHostedWithin=false;c.addSubMenuItem(mstrmojo.desc(13788,"Apply to"),"",X.id,function(){var d=new mstrmojo.ui.menus.MenuConfig();d.addRadioMenuGroup(Y.threshold.scope||1,S,[{value:1,text:a?mstrmojo.desc(14599,"Element Rows Only"):mstrmojo.desc(13789,"Metric Only")},{value:2,text:a?mstrmojo.desc(14600,"Subtotal Rows Only"):mstrmojo.desc(13790,"Subtotals Only")},{value:3,text:a?mstrmojo.desc(14601,"Elements and Subtotals"):mstrmojo.desc(13894,"Metric and Subtotals")}],"",Y,true);return d;});c.addMenuItem(mstrmojo.desc(2869,"Formatting"),"",function(){X.openPropertyPanel(Y);});if(W.showNumberFormat()){c.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),"",function(){var d=function(e){M.forEach(e,function(g,f){if(!Y.threshold.fmt){Y.threshold.fmt={};}Y.threshold.fmt[f]=g;});Y.model.raiseEvent(M.copy(Y.model,{name:"modelEdit"}));};return D.getNumberFormatEditor(Y,Y.threshold.fmt||{},function(f){var e={};e[L.CATEGORY]=f.category||-3;e[L.CURRENCY_POSITION]=f.currencyPosition||0;e[L.CURRENCY_SYMBOL]=f.currencySymbol||"$";e[L.DECIMAL_PLACES]=f.decimalPlaces||2;e[L.FORMAT]=f.format||"";e[L.NEGATIVE_NUMBERS]=f.negativeNumbers||3;e[L.THOUSAND_SEPARATOR]=f.thousandSeparator||0;d(e);});});}c.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"",function(){W.duplicateThreshold(Y.idx);});if(this.idx!==0){c.addMenuItem(mstrmojo.desc(7978,"Move Up"),"",function(){W.moveThreshold(Y.idx,Y.idx-1);});}else{c.addNonInteractiveMenuItem(mstrmojo.desc(7978,"Move Up"),"",true);}if(this.idx!==W.thresholds[W.metricId].length-1){c.addMenuItem(mstrmojo.desc(7979,"Move Down"),"",function(){W.moveThreshold(Y.idx,Y.idx+1);});}else{c.addNonInteractiveMenuItem(mstrmojo.desc(7979,"Move Down"),"",true);}c.addMenuItem(mstrmojo.desc(5893,"New Condition"),"",function(){Y.exprTree.newCondition(null);});this.openPopup(c.newInstance());}else{if(b===this.previewNode||b===this.previewNode.firstChild){X.openPropertyPanel(this);}}}},removeFromModel:function F(){this.model.deleteThreshold(this.threshold);},onpropertyModelChange:function H(W){M.copy(W.threshold,M.clear(this.threshold));this.refresh();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.elementHelper","mstrmojo.mstr.EnumFunction","mstrmojo.mstr.EnumDSSConsolidationType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.rw.xtab.XtabMenuConfig","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.ui.NumberFormatterEditor","mstrmojo.vi.ui.CalculationMenuEditor","mstrmojo.vi.enums.EnumDerivedElementType","mstrmojo.array");mstrmojo.requiresDescs(14388,14717,13355,12197,15356,15599);var X=mstrmojo.hash,l=mstrmojo.array,W=mstrmojo.dom,h=mstrmojo.elementHelper,d=mstrmojo.vi.enums.EnumDerivedElementType,t=mstrmojo.vi.ui.DatasetUnitMenuUtils,O=mstrmojo.mstr.EnumFunction,D=mstrmojo.mstr.EnumDSSConsolidationType,F=mstrmojo.mstr.EnumDSSXMLObjectTypes,b=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,g=mstrmojo.vi.enums.EnumFeatures;var G=mstrmojo.rw.xtab.XtabMenuConfig.ACTION_TYPES,s=G.GROUP,k=G.CALCULATION,f=2,C=3,V=1;function R(){return mstrApp.isAppStatePresentation();}function S(x){if(!x||!x.items||!x.data||!x.xtab){return{};}var AC=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,isHostedWithin:false,alignWithAnchor:true,maxHeight:350}),y=x.items,AA=x.data,AB=x.xtab,z=[];if(mstrmojo.resolveFeature("sort-drill-paths")){y.sort(function(AE,AD){if(AE.n>AD.n){return 1;}if(AE.n<AD.n){return -1;}return 0;});}y.forEach(function(AE,AD){if(z.indexOf(AE.id)===-1){z.push(AE.id);if(AE.att){AC.addPopupMenuItem(AE.n,this.id,S,"xt",{items:y[AD].att,data:AA,xtab:AB});}else{AC.addMenuItem(AE.n,"xt",function(){AB.drill(AA,y[AD]);});}}});return AC;}function w(AE){var AK=AE.xtab,AA=AE.data,AB=AK.model,AD=AB.getAllDrillWithinPathsForCell(AA,undefined,true),AF=AD.length,AC=AB.docModel,y=AC.datasets[AB.data.datasetId],AL,AG=[],AI=-1,AH,AJ,z,x;if(y&&AC.isMDXDataset(y)){AD.sort(function(AN,AM){AN.did=AN.id;AM.did=AM.id;if(AN.id<AM.id){return -1;}if(AN.id>AM.id){return 1;}return 0;});AL=y.tables[0];AL.dimensions.forEach(function(AM){z=true;AH=-1;AM.hierarchies.forEach(function(AN){x=true;AN.att.forEach(function(AO){if(AO){AJ=l.findBin(AD,AO,"did",AF);if(AJ!==-1){if(z){AG.push({id:AM.did,n:AM.n,att:[]});AI++;z=false;}if(x){AG[AI].att.push({id:AN.did,n:AN.n,att:[]});AH++;x=false;}AG[AI].att[AH].att.push(AD[AJ]);}}});});});}else{AG=AD;}return S({items:AG,data:AA,xtab:AK});}function n(y){var AB=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:250});var AA=y.xtab,z=y.deObject,x=y.groups;x.forEach(function(AD,AC){if(AD.t===d.LIST&&!AD.ido){AB.addMenuItem(AD.n,"",function(){AA.addElementsToGroup(z,x[AC],AC,AA.getContextMenuSelections());});}});return AB;}function p(y){var x=y&&y.des;return !!x&&x.some(function(z){return(z.t===d.LIST&&!z.ido);});}function j(x,AC,z){var y=false,AB=undefined;if(AC){y=!h.isNonGroupNull(x.data)&&this.isActionAvailable(x.data,s)&&x.de===undefined;}else{if(z){var AA=M.call(this,x);y=AA.isActionAvailable;AB=AA.group;}}return{isAddToGroupSupported:y,group:AB};}function M(y,z){var AA,AC=undefined,AB=y.xtab,AE=0,AD=AB.cmSelCells;var x=AD.filter(function(AF,AG){return AD.indexOf(AF)===AG;});AA=!x.some(function(AF){var AG=AB.getCellForNode(AF);if(!h.isNonGroupNull(AG)&&this.isActionAvailable(AG,s)){if(AG.dei!==undefined){AC=AB.getDEInfo(AG).de;if(AC.t!==d.LIST||++AE>1){return true;}}return false;}else{return true;}},this);if(z){AA=(AA)?!!AC:AA;}return{isActionAvailable:AA,group:(AA)?AC:undefined};}function P(x){var y=x.xtab;return !y.cmSelCells.some(function(z){var AA=y.getCellForNode(z);return h.isNonGroupNull(AA)||!this.isActionAvailable(AA,s)||AA.dei!==undefined;},this);}function I(y){var x;return !y.cmSelCells.some(function(z){x=y.getCellForNode(z);return(h.isNonGroupNull(x)||!this.isActionAvailable(x,k));},this);}function Z(AA){var x=t.generateNumberFormat(AA&&AA.de&&AA.de.nf),AB=X.clone(x),AD=X.clone(x),y=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.vi.ui.NumberFormatter({myData:AB,oldData:AD,formatValue:x}),data:AB}),z=this.delegateActionToXtab;X.make(AB,mstrmojo.Obj);X.make(AD,mstrmojo.Obj);y.fnOk=function AC(){z(AA,"editQuickDECalculationNumberFormat",X.copy(this.data,{de:AA.de}));};return y;}function Y(x){var z=x.xtab,y=z.cmSelCells;return y.every(function(AA){var AB=z.getCellForNode(AA);return AB.ln;});}function c(AB){var AL=new mstrmojo.ui.menus.MenuConfig(),AE=4,AO=5,AJ=6,y=7,AM=" - ",AD=" / ",AG={SINGLE:[{n:mstrmojo.desc(358,"Absolute"),v:O.FunctionAbs}],PAIR:[{n:mstrmojo.desc(6017,"Add"),v:O.FunctionAdd},{n:mstrmojo.desc(2122,"Average"),v:O.FunctionAverage},{n:mstrmojo.desc(5868,"Least"),v:O.FunctionLeast},{n:mstrmojo.desc(5869,"Greatest"),v:O.FunctionGreatest},{n:"A-B",v:O.FunctionMinus+";0"},{n:"B-A",v:O.FunctionMinus+";1"},{n:"A/B",v:O.FunctionDivide+";0"},{n:"B/A",v:O.FunctionDivide+";1"}],MORE:[{n:mstrmojo.desc(6017,"Add"),v:O.FunctionAdd},{n:mstrmojo.desc(2122,"Average"),v:O.FunctionAverage},{n:mstrmojo.desc(5868,"Least"),v:O.FunctionLeast},{n:mstrmojo.desc(5869,"Greatest"),v:O.FunctionGreatest}]},AK=AB.isEdit,AN=AK&&AB.de,AR=AB.data,AP=AN&&AN.es,AQ=AB.xtab,AI=AK?(AP&&AP.length):AQ.getCxtMnuSelectionSize(),x=(AI===1)?"SINGLE":((AI===2)?"PAIR":"MORE"),AH=AG[x],AC=(AN&&AN.func),AA;if(x==="PAIR"){if(AK&&AN){AH[AE].n=AP[0].n+AM+AP[1].n;AH[AO].n=AP[1].n+AM+AP[0].n;AH[AJ].n=AP[0].n+AD+AP[1].n;AH[y].n=AP[1].n+AD+AP[0].n;}else{AA=this.xtab.cmSelCells;var z=AA[0].innerText||AA[0].textContent,AF=AA[1].innerText||AA[1].textContent;AH[AE].n=z+AM+AF;AH[AO].n=AF+AM+z;AH[AJ].n=z+AD+AF;AH[y].n=AF+AD+z;}}AH.forEach(function(AS){var AU=AS.v,AT=AK&&((typeof AU==="string"&&AU.indexOf(AC)===0&&AU.indexOf(";0")>0)||AU===AC);AL.addMenuItem(AS.n,"xt "+(AT?"checked":""),function(){var AW=AB.xtab,AV=AN&&AN.func;if((AN&&AV===AU)||(typeof AU==="string"&&AU.indexOf(AV)===0&&AU.indexOf(";0")>0)){return ;}if(AB.isEdit===true){AW.editDECalculation(AR,AU);}else{AW.derivedElementCalculation(AR,AU);}});},this);return AL;}function i(x){var z=new mstrmojo.ui.menus.MenuConfig();var y=function(AB,AA){return function(){x.delegateActionToXtab(x,"keepOnlyOrExclude",[AB,AA]);};};z.addMenuItem(mstrmojo.desc(16599,"Branch"),"",y(x.isKeep,true));z.addMenuItem(mstrmojo.desc(16600,"Element"),"",y(x.isKeep,false));return z;}function m(x){var AA=new mstrmojo.ui.menus.MenuConfig(),z=x.xtab;var y=function(AB){return function(){z.handleContextMenuSelectionData(true,AB);};};AA.addMenuItem(mstrmojo.desc(16599,"Branch"),"",y(true));AA.addMenuItem(mstrmojo.desc(16600,"Element"),"",y(false));return AA;}function A(z){var AM=z.xtab,AD=z.data,AG=AM.model,AC=AG.getCellTitleInfo(AD),AN=AG.isRecursiveAttribute(AD.id||AC.title.id),AF=AM.getDEInfo(AD),AB=AF&&AF.deObject,AL=AF&&AF.de,AH=AL&&AL.t,AJ=AB&&AM.getOthersDEInfo(AB),y=z.singleCellClick,AE=AM.isSingleContextMenuAttrSelection(),AI=true,AA=AM.getContextMenuSelections(),x=AM.isSingleContextMenuSelection(),AK={de:AL,xtab:AM,data:AD,td:z.td,singleClick:y};if(AJ&&!x&&AE){AA.forEach(function(AO){if(AO[0]&&AO[0].eid.indexOf(AJ.id)>-1){AI=false;return false;}});}if(!mstrApp.isInVFConfigMode&&(y||AE)&&this.isActionAvailable(AD,k)&&I.call(this,AM)&&mstrmojo.resolveFeature(g.INSERT_NEW_METRIC)){if(!AN&&!(x&&AH===d.RESIDUE)&&AI){this.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,c,X.copy(AK,{isEdit:false}));}else{if(AN&&x&&!AH&&!AD.ln){this.addMenuItem(mstrmojo.desc(15356,"Calculated Member..."),"",function(){AM.derivedElementCalculation(AD,O.FunctionApplySimple);});}}}if(!mstrApp.isInVFConfigMode&&x&&AN&&AH===d.CALCULATION){this.addMenuItem(mstrmojo.desc(15366,"Delete Calculated Member"),"",function(){this.delegateActionToXtab(AK,"removeQuickDE",AF);}.bind(this));this.addMenuItem(mstrmojo.desc(15599,"Edit Calculated Member..."),"",function(){this.delegateActionToXtab(AK,"derivedElementsEdit",[AF]);}.bind(this));}}function U(){var AB=this.xtab,x=AB.model,z=this.selectedData,y=AB.getContextMenuSelections(),AA=!z.olap;if(y.length>0){y.forEach(function(AC){AC.forEach(function(AD){AA=AA&&x.supportsViewFilterActions(AD.tid);});});}else{AA=AA&&x.supportsViewFilterActions(x.getCellTitleInfo(z).title.id);}if(z.mix!==undefined){AA=AA&&x.getCellDataUnion(z).every(function(AC){return x.supportsViewFilterActions(AC.tid);});}return AA;}function e(x){return x&&x.mix!==undefined&&!!x._e;}function a(x){return x&&x.otp===F.Attribute;}function E(x){return x&&x.otp===F.Consolidation&&x.ost===b.ConsolidationManaged;}function q(x){var AC=x.data,AD=this.xtab,z=AD.model,AE=e(AC),AB=AE?AC._e:z.getCellTitleInfo(AC).title,y=!AE&&AB.otp===-1,AA;if(y){l.forEach([AC._lp,AC._tp],function(AG){var AH=AG;while(AH&&AH!==AH._p&&!AA){if(AH.stt){continue;}var AF=z.getCellTitleInfo(AH),AK=AF.title,AJ=AK&&AK.id;if(AJ&&AK.ost===12033){var AI=AD.getDEInfo(AH),AL=AI&&AI.de;if(AL&&AL.t===d.CALCULATION&&AL.nf&&Object.keys(AL.nf).length>0){AA={de:AL,xtab:AD,data:AH,td:x.td,singleClick:x.singleClick};break;}}AH=AH._p;}return !AA;});}if(!AA){if(y){AB={oid:z.data.gsi.mx[AC.mix].did,otp:4};}AA={did:AB.oid||AB.id,t:AB.otp,stp:AB.ost,fs:AB.fs};}return AA;}function K(z,x){var y=z&&x.td&&z.getCellForNode(x.td);if(e(y)){y.id=y._e.oid;y.otp=y._e.otp;}return y;}function B(z){var AA=z.de?z:q.call(this,z),AB=AA.de,AC=z.xtab,y=AC.model,AF,x,AE,AD=y.id;if(AB){if(AC.isSingleSelection()&&AB.t===d.CALCULATION&&AB.func!==O.FunctionApplySimple){AF=true;AE=AA;x=Z;AD=this.id;}}else{AF=y.showNumberFormat(AA);AE={item:AA};x=y.getNumberFormatEditorCfg;}if(AF){this.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),AD,x,AE);}}function u(z,x){var y=this.delegateActionToXtab;if(a(z)||(z.otp===47&&z.ost===12033)){this.addMenuItem(mstrmojo.desc(14655,"Expand All Levels"),"",function(){y(x,"raExpandAll",[true]);});this.addMenuItem(mstrmojo.desc(14656,"Collapse All Levels"),"",function(){y(x,"raExpandAll",[false]);});}else{this.addMenuItem(mstrmojo.desc(14669,"Expand All Lower Levels"),"",function(){y(x,"raExpandDescendants");});}}mstrmojo.vi.ui.rw.xtab.XtabMenuConfig=mstrmojo.declare(mstrmojo.rw.xtab.XtabMenuConfig,null,{scriptClass:"mstrmojo.vi.ui.rw.xtab.XtabMenuConfig",buildXtabMenuConfig:function N(AM){var AK=this.xtab=AM.xtab,Am=R(),AC=AK.model,Aw=this.selectedData=AM.data=AM.data||K(AK,AM),Au=t.getDatasetFromAttributeId(AC.docModel.datasets,Aw.id),Aa=Aw.stt===1,Ag=AK.getCellForNode(AM.td),AE=AC.isSubtotalValue(Ag),Ad=Aw.otp,Ap=Aw.ost,Ar=AC.getCellTitleInfo(Aw),Aj=AK.zonesModel,Ai=Aj.id,z=Aj.docModel,As=this.delegateActionToXtab,At=AK.isSingleContextMenuAttrSelection(),AF=AM.singleCellClick,AZ=U.call(this),Ao=AK.getDEInfo(Aw),AW=Ao&&Ao.deObject,AH=Ao&&Ao.de,AN=AH&&AH.t,Al=AC.isRecursiveAttribute(Aw.id||Ar.title.id),AA=AK.isSingleContextMenuSelection(),AG=mstrmojo.desc(190,"Remove"),AS,AP,AO=!Au||!z.isMDXDataset(Au),Av=AK.isInFilterPanel()&&mstrApp&&mstrApp.isInVFInteractMode,Af={did:Aw.id||AW&&AW.did,t:Ad||AW&&AW.t,st:Ap||AW&&AW.st,attId:AW&&AW.attId,ndetype:AW&&AW.ndetype},AX=Af.attId&&E(Aw)&&AC.getNDEFormsFromDataset(Af.attId),y={n:Aw.n,did:Aw.id,t:Af.t,st:Af.st,ndeForms:AX},Ae={de:AH,ndeInfo:y,xtab:AK,data:Aw,cfg:AM,td:AM.td,singleClick:AF},AI=AK.isCustomSort;this.selectedNode=AM.td;if(AM.onClose){this.addPopupHandlers(AK.id,mstrmojo.emptyFn,AM.onClose);}if(!AE){if(AI){if(Al&&!Aa){u.call(this,Aw,Ae);}}else{if(Av&&this.supportWebSort()){this.addSortMenuItem(Ae);return ;}var AR=AK.model.getAttributeFormsInTemplate(Aw.id||Ar.title.id).length,AB=Aw.fix;if(AR>1&&(!Ao||Af.ndetype===D.DssRecursiveDerivedElement)){var AD="pivot";var An=AW&&AW.t||Ad||"";var AJ=!Am&&!mstrApp.isInVFConfigMode&&AA&&AN===d.LIST;if(!a(Aw)&&!E(Aw)&&!AJ){AB=Ar.title.fix||(Ae.data.fi||0)+1;AD+="Form";}if(AB&&!Aa&&!mstrApp.isDossier){if(AB>1){this.addMenuItem(mstrmojo.desc(5362,"Move Left"),"",function(){As(Ae,AD,["l",An]);});}if(AB<AR){this.addMenuItem(mstrmojo.desc(5363,"Move Right"),"",function(){As(Ae,AD,["r",An]);});}this.addSeparator();}}if(Al&&!Aa){u.call(this,Aw,Ae);}if(!Am&&!mstrApp.isInVFConfigMode){if(e(Aw)&&Aw.um&&mstrmojo.resolveFeature(g.USE_METRIC_EDITOR)){this.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){As(Ae,"derivedMetric",["edit"]);});}if(a(Aw)){if(AK.getDerivedAttribute(Aw.id)&&AO){this.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){Aj.editDerivedAttribute({item:{did:Af.did,t:Af.t,n:Aw.n}});});}}if(this.isActionAvailable(Aw,G.GROUP_EDIT)&&AW){this.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"",function(){As(Ae,"derivedElementsEdit",[Ao]);});}if(AA&&AN===d.CALCULATION&&!Al){this.addSubMenuItem(mstrmojo.desc(12196,"Edit Calculation"),"",this.id,c,X.copy(Ae,{isEdit:true}));}}this.addSeparator();this.addSortMenuItem(Ae);if(AK.model.getAllDrillPathsForCell(Aw).length>1){this.addSeparator();}if(!Am&&!mstrApp.isInVFConfigMode){if(AA&&AN===d.LIST){this.addSeparator();this.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"",function(){As(Ae,"derivedElementsEdit",Ao);});}if(AA&&AN===d.LIST){this.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"",function(){As(Ae,"removeQuickDE",Ao);});}if(AA&&AN===d.RESIDUE){this.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"",function(){As(Ae,"separateOthers",[AH]);});}if(a(Aw)&&!Aj.isDynamicLink(Af)){this.addSeparator();if((!Au||!t.isCGorCon(Af,Au))&&AO&&mstrmojo.resolveFeature(g.INSERT_NEW_METRIC)){this.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){As(Ae,"newDerivedAttribute");});this.addMenuItem(mstrmojo.desc(14717,"Create Links..."),"",function(){As(Ae,"newDynamicLinkAttr");});}if(this.isActionAvailable(Aw,G.GROUP_EDIT)&&!AW){this.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"",function(){As(Ae,"derivedElementsEdit",[Ao]);});}this.addSeparator();}}this.addGoToTargetsMenuItem(Ae,Al);if(Al&&!!AK.selectorControl&&!Aa&&!a(Aw)&&!AK.isLinkedFilterEnabled()&&!Y.call(this,Ae)){var AU=function(){AK.handleContextMenuSelectionData(false,false);};this.addSeparator();this.addMenuItem(mstrmojo.desc(16604,"Use element as filter"),"",AU);}if(!Aa&&this.isActionAvailable(Aw,G.KEEP_ONLY)&&AZ){this.addKeepAndExcludeMenuItem(Ae,Al);}if(!Aa&&!(mstrApp.isInVFConfigMode||mstrApp.isInVFInteractMode)&&!Al&&mstrmojo.resolveFeature(g.WEB_DRILL_AND_LINK)){this.addDrillMenuItem(Ae);}if(Aw&&Aw.mix===undefined&&Ar.isSrcTitle&&Ad!==-1&&Ad!==1&&!(Ad===47&&Ap===12032)){this.addShowTotalMenuItem(Ae);}var Ab=Aw.axis;if(!Am){if(Aj.shouldShowDisplayFormsMenu(Af)){this.addSeparator();this.addPopupMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return t.getDisplayFormsMenu(Af,AK,AK.model.docModel.datasets,function(Ay){Aj.submitDropZoneUpdates(Ay);});});}this.addSeparator();if(!mstrApp.isInVFConfigMode&&(AF||At)&&this.isActionAvailable(Aw,s)&&P.call(this,Ae)&&mstrmojo.resolveFeature(g.INSERT_NEW_METRIC)){this.addMenuItem(mstrmojo.desc(1911,"Group"),"",function(){As(Ae,"derivedElementGroup");});}var Ah=p(AW)&&j.call(this,Ae,AA,At);if(!!Ah.isAddToGroupSupported){this.addAddToGroupMenuItem(Ae.xtab,AW,Ah.group);}if(!mstrApp.isInVFConfigMode&&e(Aw)&&mstrmojo.resolveFeature(g.INSERT_NEW_METRIC)){var AV=AK&&AM.td&&AK.getCellForNode(AM.td)._e,Aq={did:AV.oid,t:AV.otp},AY={zone:{id:-1,items:AK.model.data.gsi.mx},axis:Ab,idx:Aw.idx,item:Aq};this.addSeparator();if(z.findDatasetIdFromUnit(Aq.did)&&!z.isFromSolrCube(Aq.did)&&!z.isFromMDXCube(Aq.did)){this.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",Ai,Aj.getAggregateByMetricSubMenu,AY);this.addSeparator();}this.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",Ai,Aj.getCalculationEditorCfg,AY);this.addSubMenuItem(mstrmojo.desc(12287,"Shortcut Metric"),"",Ai,Aj.getShortcutMetricSubMenu,AY);this.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){As(Ae,"derivedMetric",["editNew"]);});}if(!e(Aw)&&!Ad&&mstrmojo.resolveFeature(g.INSERT_NEW_METRIC)){A.call(this,AM);}this.addSeparator();if(!Aa){B.call(this,Ae);}if(e(Aw)||a(Aw)){this.addThresholdMenuOptions(Ae);}}if(e(Aw)){this.addToggleMenuItem(mstrmojo.desc(6193,"Show Totals"),"",function(){Aj.showQuickSubtotals();},function(){Aj.hideDefinedSubtotals();},null,Aj.hasVisibleSubtotals());}if(!Aa&&this.isActionAvailable(Aw,G.KEEP_ONLY)&&AZ&&!mstrApp.isDossier&&!AK.excludeData){this.addSeparator();this.addMenuItem(mstrmojo.desc(13537,"Show Data..."),"",function(){mstrmojo.vi.ui.ViewDataDialog.open(AK.parent,true);});}var x=AK.gridData.gts,Ak,AT=[x.rowSubPos,x.colSubPos],Ac,Ax;if(Aa){Ax=Ab===V;Ac=AT[Ab-1];if(Ac===f){Ak=Ax?mstrmojo.desc(12206,"Move to Bottom"):mstrmojo.desc(13900,"Move to Right");AT[Ab-1]=C;}else{Ak=Ax?mstrmojo.desc(12205,"Move to Top"):mstrmojo.desc(13901,"Move to Left");AT[Ab-1]=f;}this.addMenuItem(Ak,"",function(){AC.moveSubTotals(Ae,AT);});}if(this.isActionAvailable(Aw,G.TOTAL_HEADER)&&Aw.mix===undefined){AS=function(){As(Ae,"removeTotal");};}if(!Am&&AA){if(AN===d.LIST){AP=function(){As(Ae,"renameDEList",Ao);};}else{if(AN===d.CALCULATION&&!mstrApp.isInVFConfigMode){AP=function(){this.delegateActionToXtab(Ae,"editDECalculation");}.bind(this);AS=function(){this.delegateActionToXtab(Ae,"removeQuickDE",Ao);}.bind(this);AG=mstrmojo.desc(12197,"Delete Calculation");}}}this.addSeparator();}}if(!Am&&!AI){var AQ=AK.parent;if(AQ.addFormatMenuItem){AQ.addFormatMenuItem(this,{info:Ar,isMetricHeader:e(Aw)},function(Ay){var Az=AK.highlightFormatTarget(Ay,Aa||AE);AK.openPopup(AK.edtModel.getFormattingToolbar(Ay,AM.td,{onClose:function(){AK.restoreHighlights(Az);}}));});}}if(!AE&&!AI){if(((Ar&&Ar.isSrcTitle)||e(Aw))&&(!Am||!!mstrmojo.resolveFeature(g.WEB_DRILL_AND_LINK))){this.addPopupMenuItem(mstrmojo.desc(14003,"Replace with"),Ai,Aj.getReplaceSubMenu,"",{zone:Aj.getZoneForObject(Ar.title.id||Aw.id),item:Af});}if(AP){this.addMenuItem(mstrmojo.desc(2453,"Rename..."),"",AP);}if(AS&&!(Al&&AN===d.CALCULATION)){this.addMenuItem(AG,"",AS);}if(!Am){if((Ar&&Ar.isSrcTitle)||e(Aw)){if(!AP){this.addMenuItem(mstrmojo.desc(2453,"Rename..."),"",function(){As(Ae,"renameUnit");});}if(!AS){this.addMenuItem(AG,"",function(){As(Ae,"removeUnit");});}}}var AL=X.walk("node.data.olm",AK)&&!(X.walk("node.data.rw.row.bc",AK)>0);if(AK.isCopySupported&&!Aa&&!a(Aw)&&!e(Aw)&&!AL){this.addSeparator();this.addMenuItem(mstrmojo.desc(14388,"Copy Rows"),"",function(){As(Ae,"copyRowsFromXtab",[AK.cmSelCells]);});}}this.supportsScroll=true;this.isHostedWithin=false;this.maxHeight=W.getMaxScrollHeight();},addAddToGroupMenuItem:function(AA,y,z){var x=(y&&y.des)||[];this.addPopupMenuItem(mstrmojo.desc(14553,"Add to Group"),this.id,n,"",{xtab:AA,deObject:y,groups:z?[z]:x});},addDrillMenuItem:function J(x){var AB=x.xtab,AA=x.data,y=AB.model.getUnHiddenDrillPathsForCell(AA),z=y.length;if(!(e(AA)||AA.mix!==undefined)){if(z>1){this.addSubMenuItem(mstrmojo.desc(145,"Drill"),"",this.id,w,x);}else{if(z===1){this._super(x,y[0]);}else{this.addNonInteractiveMenuItem(mstrmojo.desc(145,"Drill"),"",true);}}}},addKeepAndExcludeMenuItem:function Q(y,z){this.addSeparator();var AA=this.delegateActionToXtab;var x=function(AB){return function(){AA(y,"keepOnlyOrExclude",[AB]);};};if(!mstrApp.isInVFInteractMode){if(z&&!Y(y)){this.addSubMenuItem(mstrmojo.desc(11701,"Keep Only"),"",this.id,i,X.copy(y,{isKeep:true,delegateActionToXtab:AA}));this.addSubMenuItem(mstrmojo.desc(3946,"Exclude"),"",this.id,i,X.copy(y,{isKeep:false,delegateActionToXtab:AA}));}else{this.addMenuItem(mstrmojo.desc(11701,"Keep Only"),"",x(true));this.addMenuItem(mstrmojo.desc(3946,"Exclude"),"",x(false));}}},addGoToTargetsMenuItem:function o(x,z){var AA=x.xtab;if(AA.isLinkedFilterEnabled&&AA.isLinkedFilterEnabled()){this.addSeparator();var y=function(AB){return function(){AA.handleContextMenuSelectionData(true,AB);};};if(z&&!Y(x)){this.addSubMenuItem(mstrmojo.desc(15070,"Go to Targets"),"",this.id,m,x);}else{this.addMenuItem(mstrmojo.desc(15070,"Go to Targets"),"",y(false));}}},getSubtotalEditorConfig:function H(y){var x=this._super(y),z=y.data,AA=y.xtab;x.fnOk=AA.getOnSubtotalsChangeFn(x,z);return x;},addThresholdMenuOptions:function L(y){var x=y.data._e||y.data,z={did:x.oid||x.id,t:x.otp,n:x.n};this.xtab.model.buildThresholdMenuOptions(this,{item:z},false,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.CheckList","mstrmojo.DataGrid","mstrmojo.hash","mstrmojo.models.FormatModel","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.func","mstrmojo.array","mstrmojo.dom");var J=mstrmojo.hash,f=mstrmojo.array,C=mstrmojo.css,V=mstrmojo.Button.newWebButton,m=mstrmojo.ui.Pulldown.newPulldown,i=mstrmojo.models.FormatModel.getFormatUpdate,a=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,d=mstrmojo.vi.ui.DatasetUnitMenuUtils,H,I=mstrmojo.dom;var B=1,j=2,G=3,D="480px",g="visfilter";var E=[{n:mstrmojo.desc(6031,"Off"),v:"0"},{n:mstrmojo.desc(6030,"On"),v:"1"},{n:mstrmojo.desc(8504,"Form name only"),v:"2"},{n:mstrmojo.desc(8505,"Show attribute name once"),v:"3"},{n:mstrmojo.desc(4531,"Automatic"),v:"4"}],Z=[{n:mstrmojo.desc(13786,"Show both nulls and zeros"),v:"-1"},{n:mstrmojo.desc(13787," Hide both nulls and zeros"),v:"2"},{n:mstrmojo.desc(9845,"Hide nulls only"),v:"0"},{n:mstrmojo.desc(9846,"Hide zeros only"),v:"1"}],N=[{n:mstrmojo.desc(13544,"Last selection only"),v:0},{n:mstrmojo.desc(13545,"Intersection of all selections"),v:1}],h=[{n:mstrmojo.desc(959,"Default"),v:"-1",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(9640,"Inner Join"),v:"0",title:mstrmojo.desc(9640,"Inner Join")},{n:mstrmojo.desc(9641,"Outer Join"),v:"1",title:mstrmojo.desc(9641,"Outer Join")}],M=[{n:mstrmojo.desc(959,"Default"),v:"-1",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(13177,"Inner Join"),v:"0",title:mstrmojo.desc(13178,"Results displaying only those attribute elements that have metric value")},{n:mstrmojo.desc(13179,"Outer Join - Ignore Filter"),v:"2",title:mstrmojo.desc(13180,"Outer join to attribute's look up table without considering the filter on template")},{n:mstrmojo.desc(13181,"Outer Join - Preserve Filter"),v:"3",title:mstrmojo.desc(13182,"Outer join to attribute's look up table after considering the filter on template")}];var c={"-1":mstrmojo.desc(959,"Default"),"0":mstrmojo.desc(9640,"Inner Join"),"2":mstrmojo.desc(13179,"Outer Join - Ignore Filter"),"3":mstrmojo.desc(13181,"Outer Join - Preserve Filter")},W={"-1":mstrmojo.desc(959,"Default"),"0":mstrmojo.desc(9640,"Inner Join"),"1":mstrmojo.desc(9641,"Outer Join")};var U;var e=false;function P(t,p,o,s){var q={scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",col1Width:t,col2Width:p,children:o};return J.copy(s,q);}function Q(p,q,o){return J.copy(o,{scriptClass:"mstrmojo.Label",slot:q,text:p});}function F(s,o){return[Q(s,"col1Node",{cssClass:"subTitle"}),{scriptClass:"mstrmojo.ui.CheckList",orientation:"h",slot:"col2Node",preBuildRendering:function p(){var x=mstrmojo.all[H].data[o],t=this.items,w=this.selectedIndices;if(x){f.forEach(t,function(z,y){w[y]=x[z.id]==="-1";});}var u=mstrmojo.all[H].olm;if(!!u&&o==="rows"){this.items[1].css="disabled";}else{this.items[1].css="";}},postselectionChange:function q(t){var w=this.items,u=[t.added,t.removed];u.forEach(function(y,x){if(y&&y.length>0){i(o+w[y[0]].id,x===0?"-1":"0",mstrmojo.all[H].newData);}});},items:[{n:mstrmojo.desc(2969,"Show"),id:a.SHOW_HEADER},{n:mstrmojo.desc(1095,"Merge"),id:a.MERGE_HEADER,css:""},{n:mstrmojo.desc(2970,"Lock"),id:a.LOCK_HEADER}]}];}function S(){var p=H.split("-"),o=p.length;if(!mstrApp.isInVFConfigMode&&p[o-1]===g){p.splice(p.length-1,1);}else{if(mstrApp.isInVFConfigMode&&p[o-1]!==g){p.splice(p.length,1,g);}}H=p.join("-");}function X(p){S();var o=mstrmojo.all[H];if(p){o.update=o.update.actions?o.update:{actions:[]};o.update.actions=o.update.actions.concat(mstrmojo.hash.valarray(o.joinActions));o.update.callback=mstrmojo.func.wrapMethods(o.update.callback,o.host.parent.model.getRebuildCallback());if(o.SelectionLimitSection&&o.limitVal){o.host.writeGlobalProperty("slctnLmt",o.limitVal);}o.submitAction(o.newData,o.update.actions,o.update.callback,o.update.extras);}o.newData=o.update={};o.joinActions={};o.close();}function O(p){var t=p.parent.data,q=mstrmojo.all[H],o=q.host.k,s=q.host.controller,u=new mstrmojo.ui.menus.MenuConfig();q.joinActions=q.joinActions||{};if(t.did==="AllAttr"){M.forEach(function(w){u.addMenuItem(w.n,"",function(){p.parent.jtValue.set("text",w.n);t.v=w.v;t.dv=w.n;q.joinActions.AllAttr=s.dataService().getSetAttributesJoinTypeAction(o,w.v);});});}else{h.forEach(function(w){u.addMenuItem(w.n,"",function(){p.parent.jtValue.set("text",w.n);t.v=w.v;t.dv=w.n;q.joinActions[t.did]=s.dataService().getSetMetricJoinTypeAction(o,t.did,t.dt,t.t,w.v);});});}u.hostId=H;u.isHostedWithin=false;u.hostElement=p.domNode;u.menuCssClass="joinbehavior";u.setAlignment(3,2);q.openPopup(u.newInstance());}mstrmojo.vi.ui.editors.MoreOptionsEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.editors.MoreOptionsEditor",host:undefined,showHeadersSection:false,showSelectionLimitSection:false,data:undefined,lockHeadersCase:undefined,update:undefined,newData:undefined,joinActions:undefined,cssClass:"mstrmojo-MoreOptions-Editor",title:mstrmojo.desc(9126,"More options"),help:"more_options_dialog_box.htm",submitAction:mstrmojo.emptyFn,init:function k(o){this._super(o);if(mstrApp.isInVFConfigMode){this.children.splice(2,1);}H=this.id;this.newData=this.update={};this.joinActions={};this.onshowHeadersSectionChange(this.showHeadersSection);this.onshowSelectionLimitSectionChange(this.showSelectionLimitSection);},onOpen:function R(){S();var o=this.host,p=o&&o.gridData,s=p&&p.olm&&!(p.rw&&p.rw.row.bc>0);this.olm=!!s;if(this.showSelectionLimitSection){var q=this.SelectionLimitSection.children[1].children[1].provider;q.curVal=o.readGlobalProperty("slctnLmt");this.limitVal=undefined;}this.refresh();},_set_lockHeadersCase:function Y(s,o){this.lockHeadersCase=o;var p=this.data,q=this.lockHeadersCase;if(!p){p=this.data={rows:{},cols:{}};}else{p.rows=p.rows||{};p.cols=p.cols||{};}p.rows.lhv=(q===G||q===B)?"-1":"0";p.cols.lhv=(q===G||q===j)?"-1":"0";},onshowHeadersSectionChange:function K(p){var q=p.value,o=this.headersSection;if(!q&&o){this._headersSecOrphan=o;this.removeChildren(o);}else{if(q&&!o){this.addChildren(this._headersSecOrphan,0);}}},onshowSelectionLimitSectionChange:function b(o){var q=o.value,p=this.SelectionLimitSection;if(!q&&p){this._selectionSecOrphan=p;this.removeChildren(p);}else{if(q&&!p){this.addChildren(this._selectionSecOrphan,2);}}},children:[P("26%","74%",[Q(mstrmojo.desc(2967,"Headers"),"col1Node",{cssClass:"title"}),P("20%","80%",F(mstrmojo.desc(2968,"Rows"),"rows"),{slot:"col2Node"}),P("20%","80%",F(mstrmojo.desc(122,"Columns"),"cols"),{slot:"col2Node"})],{alias:"headersSection",cssClass:"headers",width:D}),P("26%","74%",[Q(mstrmojo.desc(4083,"Display"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[Q(mstrmojo.desc(8503,"Show attribute form names:"),"containerNode",null),m(E,function(o){i(a.LONG_NAME,o.v,mstrmojo.all[H].newData);},0,{width:"151px",preBuildRendering:function A(){var o=this.items.map(function(p){return p.v;}).indexOf(mstrmojo.all[H].data[a.LONG_NAME]);this.selectedIndex=Math.max(o,0);}},true)]},{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row2",children:[Q(mstrmojo.desc(13200,"Hide metric nulls and zeros"),"containerNode",null),m(Z,function(p){var o=p.v,q=o==="-1"?"-1":"0";if(o!=="-1"){i(a.HIDE_NULL,o,mstrmojo.all[H].newData);}i(a.SHOW_ALL_ROWS,q,mstrmojo.all[H].newData);},0,{width:"181px",preBuildRendering:function A(){var p=mstrmojo.all[H].data,o=p[a.SHOW_ALL_ROWS]==="-1"?0:this.items.map(function(q){return q.v;}).indexOf(p[a.HIDE_NULL]);this.selectedIndex=Math.max(o,0);}},true)]}],{alias:"viewSection",cssClass:"view",width:D}),P("26%","74%",[Q(mstrmojo.desc(13546,"Filtering"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[Q(mstrmojo.desc(13547,"When this visualization is filtered by multiple other visualizations, filter by:"),"containerNode",{cssClass:"dropdownLabel"}),m(N,function(o){var p=mstrmojo.all[H],q=p.host;if(q.switchFilterType){p.update=q.switchFilterType(o.v);}},0,{width:"181px",preBuildRendering:function A(){var o=mstrmojo.all[H].host;if(o.getFilterType){this.selectedIndex=o.getFilterType();}}},true)]}],{alias:"filteringSection",cssClass:"filtering",width:D}),P("26%","73%",[Q(mstrmojo.desc(16265,"Selection Data Limit"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[Q(mstrmojo.desc(16264,"Set a limit for the maximum quantity of data points that a user can select on this visualization."),"containerNode",{cssClass:"stepperLabel"}),{scriptClass:"mstrmojo.ui.editors.controls.Stepper",width:"75px",preBuildRendering:function A(){C.addWidgetCssClass(this,"selection");mstrmojo.ui.editors.controls.Stepper.prototype.preBuildRendering.call(this);},provider:new mstrmojo.NumStepperContentProvider({item:{interval:1},min:1,max:200000,onTraverse:function(){var o=mstrmojo.all[H];o.limitVal=this.item.value;}})},Q(mstrmojo.desc(16263,"(Max quantity should be no more than 200K.)"),"containerNode",{cssClass:"stepperLabel"})]}],{alias:"SelectionLimitSection",cssClass:"filtering",width:D}),P("26%","74%",[Q(mstrmojo.desc(4571,"Join Behavior"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.DataGridWithTooltip",slot:"col2Node",cssClass:"jointype",banding:false,lockHeader:true,columns:[{headerText:mstrmojo.desc(5467,"Objects"),dataField:"n",headerCss:"objects-hd",tooltip:false,itemTooltipField:"tf",itemCSSField:"itemCss",colWidth:115,colHeight:24},{headerText:mstrmojo.desc(13176,"Join Type"),headerCss:"jointype-hd",dataWidget:{scriptClass:"mstrmojo.Box",cssClass:"jt-col",children:[{scriptClass:"mstrmojo.Label",cssClass:"jt-value",alias:"jtValue",bindings:{text:"this.parent.data.dv"}},{scriptClass:"mstrmojo.Button",cssClass:"jt-menu",alias:"jtBtn",onclick:function(){var o=mstrmojo.all[H];O.call(o,this);}}]}}],items:[],itemFunction:function(){var o=mstrmojo.DataGridWithTooltip.prototype.itemFunction.apply(this,arguments);o.themeClassName=!!mstrApp.isWSStyling?"":"mojo-theme-dark";return o;},preBuildRendering:function A(){var z=mstrmojo.all[H].host,y=z.model&&z.model.docModel,q=z.gridInfo||{},AA=q.rows||[],w=q.cols||[],x=q.mx||[],s=q.dmx||[],u=z.tmsProps,o=u.tpltProp&&u.tpltProp["VLDB Select"]&&u.tpltProp["VLDB Select"][0].v,t=[];o=(o&&o.length)?o:"-1";(AA.concat(w)).some(function(AB){if(AB.t===12){t.push({did:"AllAttr",n:mstrmojo.desc(13185,"All Attributes"),v:o,dv:c[o],itemCss:"jt-allattr"});return true;}return false;});x=f.filter(x,function(AC){var AD=d.getUnitFromDataset(y.datasets,AC.did,4),AB=AC.isSmart&&AC.decomposable===2;return AD&&(!AD.um||AC.afb||!AC.isSmart||AB);});var p=[].concat(u.mxProp);s.forEach(function(AC){var AB={};AB[AC.did]=AC.prop;p.push(AB);});(x||[]).forEach(function(AC){var AB={v:"-1"};(p||[]).forEach(function(AD){if(AD[AC.did]){(AD[AC.did]["VLDB Select"]||[]).forEach(function(AE){if(AE.n==="Metric Join Type"){AB=AE;}});}});t.push({did:AC.did,n:AC.n,dt:AB.dt,t:4,v:AB.v,dv:W[AB.v],itemCss:"jt-metric"});});this.items=t;mstrmojo.DataGridWithTooltip.prototype.preBuildRendering.apply(this,arguments);},postBuildRendering:function L(){mstrmojo.DataGridWithTooltip.prototype.postBuildRendering.apply(this,arguments);this.domNode.style.overflow="hidden";}}],{alias:"JoinBehaviorSection",cssClass:"joinbehavior",width:D}),{alias:"buttonBar",scriptClass:"mstrmojo.Box",slot:"buttonNode",children:[V(mstrmojo.desc(221,"Cancel"),function(){X(false);}),V(mstrmojo.desc(118,"Save"),function(){X(true);},true)]}]});mstrmojo.DataGridWithTooltip=mstrmojo.declare(mstrmojo.DataGrid,[mstrmojo._HasTooltip],{scriptClass:"mstrmojo.DataGridWithTooltip",tooltip:"",useRichTooltip:true,itemFunction:function(q,o,p){var s=new mstrmojo.DataRow({columns:p.columns,data:q,idx:o,dataGrid:p,parent:p});p.dataTextCSSClass=s.dataTextCSSClass;return s;},updateTooltipConfig:function l(p){var q=p.target||I.eventTarget(p.hWin,p.e),o=I.position(q);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMRIGHT,content:this.getTooltipContent(p),top:o.y+1.5*o.h,left:o.x,cssClass:"vi-regular vi-tooltip-D"};},getTooltipContent:function(o){return mstrmojo.string.regEscape(o.target.innerText);},showTooltip:function n(o,p){if(o.target.className===this.dataTextCSSClass){this._super(o,p);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.string","mstrmojo.vi.ui.HierarchyElementsCheckListBrowser","mstrmojo.vi.ui.ElementsBrowser","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox","mstrmojo.Label","mstrmojo._IsList","mstrmojo.rw.ConditionWalkProviderBase","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.ui.CheckList","mstrmojo.ui.ColumnContainer","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo._HasItemAliases");var P=mstrmojo.array,W=mstrmojo.css,F=mstrmojo.string,M=mstrmojo.expr,X=mstrmojo.dom,Y=mstrmojo.hash,y=M.ET,a=M.ET2TGT,n=M.DTP2FN_DTP,Z=M.FN,m=M.FNT,S=M.FN_MRP,s=mstrmojo.rw.ConditionWalkProviderBase,d=s.onWalkChange,p=s.updateList,AI=s.fnItem,AH=s.isComparisonAllowed,b=s.clearInvalid,D=s.shouldShowCst,e=s.getConstant,G=s.getConstantDataType,x=s.getConstantValue,AJ=s.isDATE,f=s.getCstListCompareTgts,g=s.fmJson,AB=s.allowedTargetTypes,L=s.updatePulldown,U=s.onWalkChangeThroughPulldown,o=mstrmojo.mstr.EnumDSSXMLObjectTypes,AF=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,AL=mstrmojo.vi.ui.DatasetUnitMenuUtils,B=mstrmojo.ui._HasListTooltip;var E=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;var Q=mstrmojo.meta.TP,AE=mstrmojo.meta.STP,C="-2";var N={SELECT:0,QUALIFICATION:1};var h={TEMPLATE_LEVEL:0,DATASET_LEVEL:1};var V={VALUE:1,RANK_PERCENTAGE:2,BOTH:3};var l=0,q=1;var H=368,AD=H-5,AK=5,R=26,K=10;var w={};w[y.MQ]={key:"metricFns",def:M.METRIC_FNS};w[y.MC]={key:"metricFns",def:M.METRIC_FNS};w[y.AQ]={key:"formFns",def:M.FORM_FNS};w[y.AL]={key:"formFns",def:M.FORM_FNS};w[y.AC]={key:"formFns",def:M.FORM_FNS};w[y.AE]={key:"elemFns",def:M.ELEM_FNS};function AG(AM){return'<div class="unit item '+AL.getUnitCssClass(AM)+'">'+F.encodeHtmlString(AM.n)+"</div>";}function AA(AM){var AN=this.selectedNode;P.forEach(AN.classList,function(AO){if(AO&&F.startsWith(AO,"ic")){W.removeClass(AN,AO);}});W.addClass(AN,"unit");W.addClass(AN,"item");W.addClass(AN,AL.getUnitCssClass(AM));return F.encodeHtmlString(AM.n);}function k(AN,AV){var AR=AN.model,AU=AR.et,AW=AR&&AR[a[AU]]&&AR[a[AU]][AN.columnWalk.target.itemIdField||"did"],AQ=AR&&AR.fm,AZ=AQ&&AQ.dtp,AO=AH(AR,AN.ets);if(this.targetsLastMod&&this.targetsLastMod===AN.targetsLastMod&&AW&&AW===this._lastTargetId&&this.lastFmDtp===AZ&&this.lastFnTp===AO&&this.lastEt===AU){return ;}var AT=this.attMxPd,AY=this.attMxLabel;if(!AO){AT.set("items",[]);AY.set("visible",false);AT.set("visible",false);}else{var AX=AR.a?mstrmojo.desc(518,"Attribute"):AR.m?mstrmojo.desc(517,"Metric"):"",AS=f(AN),AM=AR[a[AR.et]+(2+AV)],AP=AM?P.find(AS,"did",AM.did):undefined;AY.set("text",AX);AT.items=AS;AT.selectedIndex=AP>=0?AP:undefined;AT.refresh();AY.set("visible",true);AT.set("visible",true);}this._lastTargetId=AW;this.lastFnTp=AO;this.lastFmDtp=AZ;this.lastEt=AU;this.targetsLastMod=AN.targetsLastMod;}function J(AU,AX){AU.updating=true;var AQ=AU.parent.parent.parent,AW=D(AQ,AX);if(!AW){AU.updating=false;return ;}var AO=AQ.model||{},AT=e(AQ,AX),AP=G(AQ,AT),AY=x(AQ,AX),AV=AO.fn,AS=M.fn_List(AV,AO.fnt),AM=AJ[AP];var AR=AM?AU.dateInput:AU.txtInput;var AN=AM?AU.txtInput:AU.dateInput;AN.set("visible",false);AR.updating=true;AR.set("dtp",AP);AR.set("isList",AS);AR.set("value",AY);AR.set("visible",true);AR.set("hint",AS?mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"):"");AR.updating=false;if(AV===1||AV===2){AR.constraints.min=0;}if(AR.clearValidation&&AR.inputNode){AR.clearValidation();}k.call(AU,AQ,AX);switch(AO.et){case y.AQ:case y.AL:case y.MQ:AU.attMxPd.set("selectedIndex",undefined);break;}AU.updating=false;}function AC(){var AP=this.parent,AN=AP.parent.parent.parent,AO=(this.isValid&&this.isValid())||(!this.isValid&&!F.isEmpty(this.value)),AM=AN.model;AN["invalid"+AP.cstIndex]=!AO;if(!this.updating){this.updating=true;if(AM){AM.edit(AP.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}if(AN.updateOkBtn){AN.updateOkBtn();}}function I(AM){if(AM){var AO=AM.n,AN=AM.dsName;if(AO&&AN){return'<div class="name">'+F.encodeHtmlString(AO,true)+'</div><div class="dsc dataset">'+F.encodeHtmlString(AN,true)+"</div>";}else{return B.getTooltipText.call(this,AM);}}}function j(AM){return Y.copy(AM,{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"txtInput",cssText:"width: 100%",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.VALUESET},onValid:AC,onInvalid:AC,onClearValidation:b,size:6,visible:true},{scriptClass:"mstrmojo.DateTextBox",alias:"dateInput",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:AC,onInvalid:AC,onClearValidation:b,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(AP){X.stopPropogation(AP.hWin,AP.e);}},visible:true},{scriptClass:"mstrmojo.Label",cssClass:"attMxLabel",text:"Attribute",alias:"attMxLabel"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attMxPd",itemIdField:"did",cssClass:"conditionWalk-attMxPd",onSelectedItemChange:function AN(AQ){if(this.hasRendered){var AP=this.parent.parent.parent.parent;U.call(this,AP,AQ,"c0");}},getPulldownTextInnerHTML:AG,getPopupListConfig:function AO(){var AP=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);AP.showTooltipForLargeText=false;AP.getItemProps=function AQ(AT,AR){var AS=mstrmojo._IsList.getItemProps.call(this,AT,AR);AS.title="";AS.style=this.parent.itemCssText||"";AS.addCls("unit "+AL.getUnitCssClass(AT));return AS;};AP.getTooltipText=I;return AP;}}],update:function(){J(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});}});}function t(AM){return AM[Q]===o.Attribute&&AM[AE]===AF.AttributeRecursive;}function u(AM){var AO=AM[Q]===o.Consolidation&&AM[AE]===AF.ConsolidationManaged,AN=mstrApp&&mstrApp.rootCtrl&&mstrApp.rootCtrl.docCtrl&&mstrApp.rootCtrl.docCtrl.model;if(AO&&AN&&AN.findUnitInDataSet){AM=AN.findUnitInDataSet(AM.did);if(AM&&AM.attId){return t(AN.findUnitInDataSet(AM.attId));}}}mstrmojo.vi.ui.ConditionWalkProvider=mstrmojo.declare(mstrmojo.rw.ConditionWalkProviderBase,[mstrmojo._HasItemAliases],{scriptClass:"mstrmojo.vi.ui.ConditionWalkProvider",getTargetNodeProps:function i(){var AW=this;return{alias:"target",isAttribute:false,isMetric:false,showChooseMethod:true,showLevel:false,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(15115,"Based on")},{scriptClass:"mstrmojo.ui.SearchablePulldown",alias:"target",itemIdField:"did",cssClass:"conditionWalk-target",allowEmptyText:true,onRender:function(){if(this.hasRendered){this[this.editableSlot].setAttribute("placeholder",mstrmojo.desc(10,"Search"));}},postCreate:function(){this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},getEditableTextInnerHTML:function AX(){var AZ=this.selectedIndex,AY=this.getPopupList(),Aa=AY&&AY.items;if(this.selectedNode&&Aa&&Aa[AZ]){return this.getPulldownTextInnerHTML(Aa[AZ]);}else{return"";}},update:function AS(){var Ab=this.parent.parent.parent,Aa=Ab.model,AY=Ab.targetsLastMod,Aj=Ab.editor.docModel,Ai=Ab.editor.xtab,Ae=Ai&&Ai.gridInfo,Af=Aa&&Aa.et;if(this.lastModel!==Aa||this.targetsLastMod!==AY){this.lastModel=Aa;this.targetsLastMod=AY;var AZ=Ab.targets,Ac=Ab.ets;if(Ac&&AZ&&AZ.length){var Ad=AB(Ab.ets);AZ=P.filter(AZ,function(Am){return Ad[Am[Q]];});}var Ak=Aa&&Aa[a[Af]],Ah=Ab.objectBrowsingEnabled,Al=Ah&&(!AZ||P.find(AZ,"did",C)===-1);if(Af===y.ANDOR){Ak=Aa.a||Aa.m||null;}Ak=Ak&&Ak.did&&Ak.n?Ak:undefined;this.set("objectBrowsingEnabled",Ah);if(Al){AZ=AZ||[];var Ag=mstrmojo.desc(15346,"Browse Metadata Objects...");AZ.push({did:C,n:Ag,t:-1,title:Ag});}if(Aj){P.forEach(AZ,function(Am){AW.adjustItemName(Am,Aj,Ae);});}L(this,true,M.getSortedObjectsByTypeGroup(AZ),Ak);if((!Ah||Al)&&!Ak){this.set("isEditing",true);this.openPopup(this.getPopupList());}}},onitemSelected:function AN(AZ){if(this.hasRendered){var AY=this.parent.parent.parent;U.call(this,AY,AZ,"target");}},preisEditingChange:function AT(){if(this.hasRendered&&this.isEditing){var AY=this.selectedNode;this._lastText=AY.innerHTML;W.removeClass(AY,"unit");W.removeClass(AY,"item");}return true;},postisEditingChange:function AU(){if(this.hasRendered&&!this.isEditing){var AY=this.selectedNode;if(this._lastText){AY.innerHTML=this._lastText;W.addClass(AY,"unit");W.addClass(AY,"item");}else{AY.innerHTML="";}delete this._lastText;}},onPopupWidgetClosed:function AV(Aa){if(this.objectBrowsingEnabled&&Aa&&Aa.pressingEnter){var AY=this.getPopupList(),Ad=AY._oldItems,Ac=this.text;if(Ad&&Ac){var Ab=P.filterOne(Ad,function(Ae){return Ae.n===Ac;});Ab=Ab||AY.items[0];if(!Ab){delete AY._oldItems;AY.set("items",Ad);return ;}if(Ab.did===C){var AZ=this.parent.parent.parent;AZ.browse(this);delete AY._oldItems;AY.set("items",Ad);return ;}}}mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this,Aa);},getPulldownTextInnerHTML:AA,getPopupListConfig:function AM(){var AY=mstrmojo.ui.SearchablePulldown.prototype.getPopupListConfig.call(this);AY.showTooltipForLargeText=false;AY.getItemProps=function AZ(Ae,Ac){var Ad=mstrmojo._IsList.getItemProps.call(this,Ae,Ac);Ad.title="";Ad.style=this.parent.itemCssText||"";Ad.addCls("unit "+AL.getUnitCssClass(Ae));Ad.addCls(Ae.isInvalid?"invalid":"");return Ad;};AY.doItemSelect=function Aa(Af,Ac){if(Af.did===C){var Ad=this.parent;Ad.parent.parent.parent.browse(Ad);}else{if(Af.isInvalid){var Ae=this;window.setTimeout(function(){Ae.showTooltip({target:Ae._getItemNode(Af._renderIdx)},window);},0);}else{mstrmojo._IsList.doItemSelect.call(this,Af,Ac);}}};AY.showTooltip=function Ab(Ah,Ag){if(!this.hasOpenTooltip&&!(this._lastOpened&&this._lastOpened.visible)){var Af=X.eventTarget(Ag,Ah),Ae=this.getItemFromTarget(Af);if(Ae&&Ae.isInvalid){var Ad=this.getItemNodeFromTarget(Af),Ac=X.position(Ad);this.richTooltip={content:mstrmojo.desc(15391,"This is an invalid object. Please contact your administrator for more information."),cssClass:"vi-warning triangle-warning vi-tooltip-C A-center",left:Ac.x+168,top:Ac.y};mstrmojo._HasTooltip.showTooltip.call(this,Ah,Ag);}else{this.constructor.prototype.showTooltip.call(this,Ah,Ag);}}};AY.tooltipOpenDelay=700;AY.getTooltipText=I;return AY;}},{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(15116,"Choose elements by"),alias:"attrLabel",bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"chooseMethodPd",items:null,visible:false,bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"},onitemSelected:function AN(Ab){var Aa=this.parent.fm,AZ=Aa&&Aa.cssClass,AY=Aa&&Aa.domNode,Ac=Aa&&Aa.selectedItem;if(Ab.v===N.SELECT){W.toggleClass(AY,"forms",false);if((AZ||"").indexOf(" forms")>-1){Aa.cssClass=AZ.replace(" forms","");}if((!Ac)||Ac.did!=="1,22"&&Ac.did!=="1,57"){Aa.singleSelectByField("1,22","did");}}else{W.toggleClass(AY,"forms",true);if((AZ||"").indexOf(" forms")===-1){Aa.cssClass=(AZ||"")+" forms";}if(!Ac||Ac.did==="1,22"||Ac.did==="1,57"){Aa.singleSelect(2);}}Aa.updateScrollbars();},update:function AS(){var Ad=this.parent.parent.parent,Ab=Ad&&Ad.model,AZ=Ad&&Ad.disableElementsBrowsing,AY=Ab&&Ab.a,Aa=AY&&AZ&&AZ(AY);if(Aa){this.set("items",[{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION}]);}else{if(AY.ndetype===1){this.children[0].showTooltipForLargeText=false;this.set("items",[{n:mstrmojo.desc(15118,"Selecting in list"),v:N.SELECT,ttpDisabled:true},{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION,cls:"disabled",dsbld:true,ttp:mstrmojo.desc(16184,"This method is not available for this object type.")}]);}else{this.set("items",[{n:mstrmojo.desc(15118,"Selecting in list"),v:N.SELECT},{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION}]);}}var Ac=this.getSelectedItem();switch(Ab.et){case y.AQ:case y.AL:case y.AC:if(!Ac||Ac.v!==N.QUALIFICATION){this.selectItemByField("v",N.QUALIFICATION);}break;default:if(!Ac||Ac.v!==N.SELECT){this.selectItemByField("v",N.SELECT);}break;}}},g({scriptClass:"mstrmojo.ui.CheckList",alias:"fm",fmPost:"",itemIdField:"did",filter:false,isFirstFm:true,multiSelect:false,minimumSelectCnt:0,hasDummyLabel:false,lastAttrId:null,height:AD-R*4-K*2-AK+"px",onchange:function AQ(AY){d.call(this,AY,"fm");},bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"},onvisibleChange:function(){this.lastAttrId=null;}}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15119,"Output Level"),cssClass:"baseOn",alias:"metricLabel",bindings:{visible:"this.parent.isMetric && this.parent.showLevel"}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"outputLevelPd",items:[{n:mstrmojo.desc(12178,"Visualization level"),v:h.TEMPLATE_LEVEL},{n:mstrmojo.desc(13519,"Dataset level"),v:h.DATASET_LEVEL}],selectedIndex:0,bindings:{visible:"this.parent.isMetric && this.parent.showLevel"},onSelectedItemChange:function AO(AZ){var AY=this.parent.parent.parent,Aa=AY.condition;Aa.level=AZ.v;}}],updateColumnContainer:function AP(){this.target.update();var Ab=this.parent,Ag=Ab.parent,Aj=Ag.model,Ar=Aj&&Aj.et,Ak=this.idx,Ao=this.next,Ap=Aj&&Aj.a,Ah=Aj&&Aj.fm,Ae=Ag&&Ag.inRelation;if(Ar){switch(Ar){case y.AQ:case y.AL:case y.AC:case y.AE:case y.ANDOR:if(Ap){this.set("isMetric",false);this.set("isAttribute",true);var An=Ag.disableElementsBrowsing,Aa=Ap&&An&&An(Ap),Al=Ag.getAttributeInfo(Ap.did),Af=t(Al)||u(Al),Ai=Ag.disableHierarchyLevel;if(Af){Aj.et=y.AE;this.set("showChooseMethod",false);}var Ad=(Aj.etWas&&Aj.etWas===y.AE)?q:l,Am=l;if(Aj.et===y.AE&&!Aa){Am=q;}if(Ad!==Am||Am===l||!Ab.next){Ab.removeTrailingContainer(Ak);if(Am===l&&Ah){Ab.addNextColumn(AW.getFnNodeProps());}else{if(Am===q){Ab.addNextColumn(AW.getEsNodeProps(Af,Ai));}}}Ag.condition.level=h.DATASET_LEVEL;var Aq=this.fm;Aq.updating=true;Aq.update();this.chooseMethodPd.update();Aq.updating=false;}break;case y.MQ:case y.MC:if(Aj.m){this.set("isMetric",true);this.set("isAttribute",false);var AZ=Ag.isMDXDM(Aj.m.did),AY=Ag.condition.level,Ac=Ag.editor&&Ag.editor.showLimits;if(AY!==h.TEMPLATE_LEVEL&&AY!==h.DATASET_LEVEL){AY=Ag.condition.level=Ac?h.TEMPLATE_LEVEL:h.DATASET_LEVEL;}if(!Ae&&!AZ&&Ac){this.set("showLevel",true);this.outputLevelPd.set("selectedIndex",AY);}else{this.set("showLevel",false);}if(!(Ao&&Ao.fn)){this.parent.insertAndRemoveTrailing(Ak,AW.getFnNodeProps());}}break;case y.R:case y.F:case y.XML:this.set("isMetric",false);this.set("isAttribute",false);Ag.condition.level=h.DATASET_LEVEL;this.parent.removeTrailingContainer(Ak);break;}}else{this.set("isMetric",false);this.set("isAttribute",false);}E.call(this);},setupScrollNodes:function AR(){this.scrollNode=null;}};},getEsNodeProps:function A(AT,AO){var AS=AT?"HierarchyElementsCheckListBrowser":"ElementsBrowser",AN=[{scriptClass:"mstrmojo.vi.ui."+AS,alias:"es",height:AD-5+"px",disableLevel:AO,update:function AR(){var AX=this.parent.parent.parent,AY=AX.model,AW=AY&&AY.a,AV=!!AW&&!AW.ilk;if(!AV){return ;}this.set("ifDataSource",AX.getIfDataSource());this.onUpdateBrowseElementsParams=function(Ab){AX.onUpdateBrowseElementsParams(Ab);};if(!AY.es){AY.es=[];}if(AT){var Aa=AX.getAttributeInfo(AW.did);Y.copyProps(["t","st"],Aa,AW);if(Aa&&Aa.attId){Aa=AX.getAttributeInfo(Aa.attId);}Y.copyProps(["fs","lvfs"],Aa,AW);}else{if(!AW.fs){Y.copyProps(["fs"],AX.getAttributeInfo(AW.did),AW);}}var AZ=Y.clone(AT?AY.data:AY.es);this.set("attribute",AW);this.set("selectedItems",AZ);},onBrowseElementsFailure:function AM(){var AY=this.attributeId,AV=this.parent.parent,AX=AV.parent,AW=P.filterOne(AX.targets,function(Aa){return Aa.did===AY;});if(AW){AW.isInvalid=true;AW.cls=(AW.cls||"")+" invalid";}AX.set("model",{et:5,isNew:true,defaultETAttr:5});var AZ=AV.target.target;AZ.openPopup(AZ.getPopupWidget());},onItemsSelectionChange:function AU(AV){var AW=this.parent.parent.parent,AX=AW.model;AX.edit(AT?"data":"es",AV);}}];return{alias:"es",children:AN,cssClass:"lastStage",updateColumnContainer:function AP(){this.es.update();},setupScrollNodes:function AQ(){this.scrollNode=null;}};},getFnNodeProps:function c(){var AQ=this,AN=[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrApp.isWSStyling?mstrmojo.desc(15006,"Operator"):mstrmojo.desc(9579,"Condition")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"fnTypePulldown",items:[{n:mstrmojo.desc(15302,"By Value"),v:V.VALUE},{n:mstrmojo.desc(15303,"By Rank"),v:V.RANK_PERCENTAGE}],onSelectedItemChange:function AR(){var AT=this.parent;AT.fn.update();}},g({scriptClass:"mstrmojo.ui.CheckList",alias:"fn",multiSelect:false,allowUnlistedValues:false,hideCheckMark:true,itemIdField:"did",onchange:function AM(AT){d.call(this,AT);},update:function(){var AV=this.parent,AZ=AV.parent.parent,AU=AZ.model||{},Aa=AU.et,AY,Ab=false,Ac,AT,Ae=V.BOTH;switch(Aa){case y.AE:Ab=!!AU.a;break;case y.AQ:case y.AC:case y.AL:Ab=!!(AU.fm&&AU.fm.did);AY=Ab?AU.fm.dtp:null;break;case y.MQ:case y.MC:Ab=!!AU.m;AY=Ab?M.METRIC_DTP:null;Ae=AV.fnTypePulldown.getSelectedItem().v;break;}if(!Ab){return ;}var Ad=n[AY];if((this.lastEt!==Aa)||(this.lastFnDtp!==Ad)||(this.lastFnTypeToDisplay!==Ae)){this.lastEt=Aa;this.lastFnDtp=Ad;this.lastFnTypeToDisplay=Ae;var AX=Aa?w[Aa]:null,AW=AX&&AX.key;Ac=(AW&&AZ[AW])||AX.def||[];if(typeof (Ac)==="object"){Ac=Ac[Ad]||Ac["*"];}if(Ae!==V.BOTH){Ac=P.filter(Ac,function(Af){var Ag=Af.tp===m.PER||Af.tp===m.RANK;return Ae===V.RANK_PERCENTAGE?Ag:!Ag;});}AT=AI(AU.fn,AU.fnt||1);AT=P.filterOne(Ac,function(Af){return Af.did===(AT&&AT.did);});p(this,Ab,Ac,AT);if(!AT){this.set("selectedIndex",0);}}this.parent.updateScrollbars();}})];return{alias:"fn",children:AN,updateColumnContainer:function AS(){var Ab=this.parent,AX=Ab.parent,AW=AX.model,AY=AW&&AW.fn,Aa=AW&&AW.fnt,AZ=AW&&AW.et,AV=this.next,AU=AY===Z.IS_NULL||AY===Z.IS_NOT_NULL,AT=(AZ===y.MC||AZ===y.MQ);this.changeFnTypePdVisibility(AT);if(AT){this.fnTypePulldown.getPopupList().singleSelectByField((Aa===m.RANK||Aa===m.PER)?V.RANK_PERCENTAGE:V.VALUE,"v");}else{this.fn.update();}if(AY&&AU){Ab.removeTrailingContainer(this.idx);}else{if(AY&&!(AV&&AV.c0)){Ab.insertAndRemoveTrailing(this.idx,AQ.getC0NodeProps());}}AV=this.next;if(AV){AV.updateColumnContainer();}},changeFnTypePdVisibility:function AP(AU){this.fnTypePulldown.set("visible",AU);var AT=AD-AK-R;if(AU){AT-=(R+K);}this.fn.set("height",AT+"px");},setupScrollNodes:function AO(){this.scrollNode=null;}};},getC0NodeProps:function O(){return{alias:"c0",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},j({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},j({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false},g({scriptClass:"mstrmojo.ui.CheckList",alias:"fm2",fmPost:2,itemIdField:"did",filter:false,multiSelect:false,minimumSelectCnt:0,hasDummyLabel:false,height:AD-R*4-K*2-AK+"px",onchange:function AM(AP){d.call(this,AP,"fm2");}})],updateColumnContainer:function AO(){this.c0.update();var AQ=this.parent,AT=AQ.parent,AU=AQ.parent.model,AV=AU&&AU.fn,AS=AV===Z.BETWEEN||AV===Z.NOT_BETWEEN||AV===S.BETWEEN||AV===S.BETWEEN_DESCENDING,AP=AV===Z.EQUAL||AV===Z.NOT_EQUAL||AV===Z.GREATER||AV===Z.GREATER_EQUAL||AV===Z.LESS||AV===Z.LESS_EQUAL;this.browseLink.set("visible",AT.objectBrowsingEnabled&&AH(AU,AT.ets));this.btwn.set("visible",AS);var AW=this.c1;AW.set("visible",AS);if(AS){AW.update();}else{if(AU.c1){AU.edit("c1",{v:null,dtp:null,skipET:true},true);}}if((!AU.a)&&AU.m&&this.domNode){W.addClass(this.domNode,"lastStage");}var AR=this.fm2;if(AU.a2&&AP){AR.update();AR.set("visible",true);}else{AR.set("visible",false);}E.call(this);},setupScrollNodes:function AN(){this.scrollNode=null;}};},browseObjs:function z(AR,AQ,AT){var AP=X.position(AR.parent.containerNode);AT=AT||{};AT.x=AP.x+40;AT.y=AP.y;this._super(AR,AQ,AT);var AN=AR.ob.browser,AM=AR.parent.opener.docModel,AO=AQ.alias,AS=AR.model.et;AM.controller.rootCtrl.loadDataProvider(function(AU){if(AO==="target"||AS===y.AQ){AN.rootFolder={did:"6F55FB47F9974EABA18CB0C5FF46785C"};}else{if(AS===y.MQ){AN.rootFolder={did:"E0CCB9CF22104A489CBE78D974AFD19E"};}}AN.model=AM;AN.set("dataProvider",AU);AN.set("opened",true);});}});}());(function(){mstrmojo.requiresClsP("mstrmojo","array","css","hash","color","dom","Editor","Button","Box","Label","num");mstrmojo.requiresClsP("mstrmojo.ui","Pulldown","Checkbox","CheckList");mstrmojo.requiresClsP("mstrmojo.threshold","ColorSlider","ThresholdModel");mstrmojo.requiresClsP("mstrmojo.models","FormatModel");mstrmojo.requiresDescs(16098,16096,16094,16097,16095,16099,16100,16101,16102,16103,16104,2290,16105,16106,16107,16108,5585,7665,7666,7905,7907,7908,7909,7910,12110,12111,16110,16109,16106);var P=mstrmojo.array,e=mstrmojo.css,W=mstrmojo.hash,X=mstrmojo.Button.newWebButton,b=mstrmojo.num,E=mstrmojo.dom,G=mstrmojo.models.FormatModel.getFormatUpdate,S=mstrmojo.vi.viz.EnumVizStyles,D=mstrmojo.vi.viz.EnumVisualizationTemplates,A=4,R=20,Q=[{n:mstrmojo.desc(16111,"Sequential"),idx:0},{n:mstrmojo.desc(16134,"Diverging"),idx:14},{n:mstrmojo.desc(16135,"Accessible"),idx:20}],H={BUSINESS_BLUE:1,MARINE_BLUE:2,BUSINESS_TEAL:3,AQUAMARINE:4,EMERALD:5,YELLOW_TO_GREEN:6,TANGERINE:7,HONEY:8,SUNFLOWER:9,BUSINESS_RED:10,RASPBERRY:11,LAVENDER:12,GRAY:13,TROPICAL_JUNGLE:15,ORANGE_AND_TEAL:16,WILD_BERRY:17,TRAFFIC_LIGHTS:18,TEMPERATURE:19,ACCESSIBLE_GOLD_AND_PURPLE:21,ACCESSIBLE_GRAY:22,ACCESSIBLE_ORANGE_AND_TEAL:23};var c=mstrmojo.threshold.ThresholdModel.SLIDER_MODE,I=mstrmojo.threshold.ThresholdModel.FEATURES;var N=null,B=null,d=[{n:mstrmojo.desc(527,"Value"),v:7},{n:mstrmojo.desc(4405,"Lowest"),v:4},{n:mstrmojo.desc(529,"Highest"),v:5},{n:mstrmojo.desc(4406,"Lowest %"),v:1},{n:mstrmojo.desc(4407,"Highest %"),v:2}];function Z(w){var x=[],s=this.colorSlider,q=s.getComp(),l=s.getPalette(),u=this.basedOn.value,n=this.model,o=this.controller,y=n.orgThresholds,h=this.metricId,k=y&&y[h],g=this.breakBy.breakByList,p=g.items[g.selectedIndex],j=q.length,m,z;if(s.getReversedValue()){l=l.concat().reverse();}for(m=0;m<j;m++){z={};if(this.colorSlider.sliderMode===c.IMAGE_BASED){z.rtp=4;z.rtxt=l[m];}else{z.fmt=G("bc",l[m]);}if(m>0){z.flr=b.toLocaleString(n.getRealValue(q[m-1],u,s.minValue(),s.maxValue()));}if(m<j-1||j===1){z.ceil=b.toLocaleString(n.getRealValue(q[m],u,s.minValue(),s.maxValue()));}if(p&&p.did!==-1){z.dmy={did:p.did,t:p.t};}x.push(z);}o.onSubmitActions(x,k,h,o.supportsFeature(I.SHOW_BASED_ON)?this.basedOn.selectedMetric:h,this.basedOn.value,w,A);}function M(q){var m=this.model,AJ=m.data,i=m.thresholds&&m.thresholds[q],AE=AJ.gsi,u=this.colorSlider,o=[],AI=[],n=[],t,AH,g,x=this.colorPalettes,s=this.imageSelector,AC=x.colorPulldown,AG=this.typeSelector.typeCheckList,h=s.imagePulldown,p=this.basedOn,l=p.options,AA=p.metricsList,z=this.breakBy.breakByList,y=this.controller.supportsFeature(I.SHOW_BASED_ON);if(i&&i.length>0){t=m.getSimpleThresholdType(q);if(t!==-2){g=m.isImageBasedType(q);l.set("selectedIndex",P.find(l.items,"v",t));i.forEach(function(AK){var AM=W.copy(AK),AL=AM.ceil;if(AL!==Infinity){AM.comp=m.getNormalizedValue(AL,AK.ttp,u.minValue(),u.maxValue());}else{AM.comp=1;}o.push(AM);});o.sort(function(AL,AK){return AL.comp-AK.comp;});o.forEach(function(AK){AI.push(AK.comp);if(g){n.push(AK.rtxt);}else{n.push(AK.fmt.bc);}});AG.set("selectedIndex",g?c.IMAGE_BASED:c.COLOR_BASED);if(g){AH=m.getImageSetName(n);h.set("selectedIndex",P.find(B,"v",AH));}else{AH=m.getColorScheme(n);if(AH==="custom"){this.switchToCustomScheme(AI,n);u.unselectAll();u.update();}else{AC.set("items",N);AC.set("selectedIndex",P.find(N,"v",AH));}}u.set("baseColor",AH);u.setColorComp(AH,AI);if(m.isMapReversed(AH,n,g)){u.reverseMapColor();}if(y){var k=i[0].expr,w=k.m||k.nds[0].m;AA.set("selectedIndex",P.find(AE.mx,"did",(w&&w.did)||m.metricId));}var AF;try{AF=i[0].expr.nds[0].dmy.uts[0].utgt.did;}catch(AD){}z.set("selectedIndex",Math.max(0,P.find(z.items,"did",AF)));}}else{var AB=AJ.visName,j;AG.set("selectedIndex",c.COLOR_BASED);AC.set("items",N);if(AB===undefined){AC.set("selectedIndex",H.TRAFFIC_LIGHTS);}else{if(AB===S.HEAT_MAP){AC.set("selectedIndex",H.TRAFFIC_LIGHTS);}else{if(AB===S.NETWORK){AC.set("selectedIndex",H.BUSINESS_BLUE);}else{if(AB===S.ESRI_MAP||AB===S.GOOGLE_MAP||AB===S.MAPBOX){AC.set("selectedIndex",H.MARINE_BLUE);}else{j=parseInt(W.walk("dz.visProp.fmt.visType",AJ));switch(j){case D.GRAPHMATRIXVERTICALLINECLUSTERED:case D.GRAPHMATRIXVERTICALLINESTACKED:case D.GRAPHMATRIXVERTICALLINEPERCENT:case D.GRAPHMATRIXVERTICALLINEAUTOMATIC:case D.GRAPHMATRIXHORIZONTALLINECLUSTERED:case D.GRAPHMATRIXHORIZONTALLINESTACKED:case D.GRAPHMATRIXHORIZONTALLINEPERCENT:case D.GRAPHMATRIXHORIZONTALLINEAUTOMATIC:case D.GRAPHMATRIXVERTICALAREACLUSTERED:case D.GRAPHMATRIXVERTICALAREASTACKED:case D.GRAPHMATRIXVERTICALAREAPERCENT:case D.GRAPHMATRIXVERTICALAREAAUTOMATIC:case D.GRAPHMATRIXHORIZONTALAREACLUSTERED:case D.GRAPHMATRIXHORIZONTALAREASTACKED:case D.GRAPHMATRIXHORIZONTALAREAPERCENT:case D.GRAPHMATRIXHORIZONTALAREAAUTOMATIC:AC.set("selectedIndex",H.TRAFFIC_LIGHTS);break;case D.GRAPHMATRIXBUBBLECIRCLEMM:case D.GRAPHMATRIXBUBBLEGRIDCIRCLEAA:case D.GRAPHMATRIXBUBBLEGRIDSQUAREAA:case D.GRAPHMATRIXBUBBLESQUAREAM:case D.GRAPHMATRIXBUBBLESQUAREMM:AC.set("selectedIndex",H.MARINE_BLUE);break;default:AC.set("selectedIndex",H.BUSINESS_BLUE);break;}}}}}u.update();if(y){AA.set("selectedIndex",P.find(AE.mx,"did",q||m.metricId));}z.set("selectedIndex",0);}}function U(g){this.parent.colorSlider.set("baseColor",g);this.selectedColor=g;}function V(){return X("",function(){this.parent.parent.colorSlider.reverseMapColor(this.checked);},false,{cssClass:"reverse-btn"});}function O(){var g=this.model,i=this.basedOn.options,k=i.items,l=isNaN(g.getMetricsMaxValue())||isNaN(g.getMetricsMinValue()),h=(l||!this.controller.supportsFeature(I.SHOW_VALUE_ITEM))?d.slice(1):d,j=k[i.selectedIndex];if(h.length!==k.length){i.set("items",h);i.set("selectedIndex",Math.max(h.indexOf(j),0));}}mstrmojo.threshold.SimpleThresholdEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.threshold.SimpleThresholdEditor",cssClass:"mstrmojo-SimpleThresholdEditor",title:mstrmojo.desc(3647,"Thresholds"),help:"thresholds_editor.htm",model:undefined,controller:undefined,metricId:undefined,metricName:undefined,typeSelector:undefined,basedOn:undefined,breakBy:undefined,colorSlider:undefined,colorPalettes:undefined,imageSelector:undefined,showAdvancedEditorLink:undefined,init:function Y(i){this._super(i);var h=mstrApp.customization.getCustomThresholds(),g=function(j){return{n:mstrmojo.desc(j.title,"N/A"),v:j.id,cls:j.id};};if(!N){N=h.color.map(function(j){return g(j);});}P.forEach(Q,function(j){N.splice(j.idx,0,{n:j.n,cls:"title",v:null});});this.colorPalettes.colorPulldown.set("items",N);if(!B){B=h.image.map(function(k){var j=g(k);j.bc=k.combinedImageUrl;return j;});this.imageSelector.imagePulldown.set("items",B);}},onOpen:function F(){var g=this.controller,h=this.model,l=this.basedOn,j=l.options,m=l.metricsList,i=this.metricId,k=h.data.gsi;this.colorSlider.resetColorMap();if(this.colorSlider.editableBubble){this.colorSlider.editableBubble.hideBubble();}e.toggleClass(this.containerNode,"hideImage",!g.supportsFeature(I.SHOW_IMAGE));if(g.supportsFeature(I.SHOW_BASED_ON)){e.addClass(j.domNode,"right-pulldown");m.set("items",k.mx);m.set("visible",true);}else{m.set("visible",false);e.removeClass(j.domNode,"right-pulldown");}this.breakBy.breakByList.set("items",[{n:mstrmojo.desc(2057,"None"),did:-1}].concat(this.targets.filter(function(n){return n.t===12;})));this.showAdvancedEditorLink.set("visible",g.supportsFeature(I.SHOW_ADVANCED_EDITOR));M.call(this,i);this.colorSlider.updateLabels();this.domNode.oncontextmenu=function(){if(mstrApp.isSingleTier){return false;}};},onClose:function C(){this.model.cleanUp();},switchToCustomScheme:function K(o,i){var j="custom",m=this.colorSlider,l=this.colorPalettes.colorPulldown,k=l.items,g=k.map(function(p){return p.v;}).indexOf(j)!==-1;o=o||m.getComp().concat();if(!i){var h=m.getPalette().concat();i=m.getReversedValue()?h.reverse():h;}m.addCustomScheme(o,i);if(!g){var n=W.clone(k);n.unshift({n:mstrmojo.desc(2056,"Custom"),v:j});l.set("items",n);}l.set("selectedIndex",P.find(l.items,"v",j));},children:[{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"typeSelector",typeCheckList:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12112,"Thresholds Type:")},{scriptClass:"mstrmojo.ui.CheckList",alias:"typeCheckList",multiSelect:false,orientation:"h",postselectionChange:function L(t){var n=this.parent.parent,l=n.model,o=n.colorSlider,i=n.colorPalettes,k=i.colorPulldown,q=n.imageSelector,j=q.imagePulldown,h=k.items[k.selectedIndex],g=B[j.selectedIndex],s=t.added[0],m=s?g:h,p=s?l.getDefaultImages()[0].id:l.getDefaultColors()[0].id;i.set("visible",!s);q.set("visible",!!s);o.set("sliderMode",s);o.set("baseColor",(m&&m.v)||p);o.editableBubble.set("visible",false);if(s===c.IMAGE_BASED&&!j.selectedIndex){j.set("selectedIndex",0);}},selectedIndex:0,items:[{n:mstrmojo.desc(12113,"Color-based"),v:"color",cls:"color"},{n:mstrmojo.desc(12114,"Image-based"),v:"image",cls:"image"}]}]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"colorPalettes",selectedColor:undefined,colorPulldown:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2060,"Color:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"color-pulldown",alias:"colorPulldown",onitemSelected:function J(h){U.call(this.parent,h.v);for(var g=0;g<=R;g++){e.removeClass(this.selectedNode,["C"+g]);}if(h.cls){e.addClass(this.selectedNode,h.cls);}},getPopupListConfig:function a(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",selectionPolicy:"reselect",locksHover:true,useRichTooltip:true,showTooltipForLargeText:true,scrollNodeMaxHeight:this.scrollNodeMaxHeight,getItemMarkup:function i(l,j){var k="item {@cls}";if((E.isFF&&!E.isMac())||E.isEdge){k+=" scrollbar-fix";}if(l.cls==="title"){return'<{@tag} class="'+k+'" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';}return'<{@tag} class="'+k+'" idx="{@idx}" style="{@style}" title="{@title}"><div class="text">{@en@n}</div></{@tag}>';},listHooks:{select:function g(k,l,j){if((l.cls||"").indexOf("title")>-1){j++;}this.parent.set("selectedIndex",j);if(this.visible&&this.closeAfterSelection){this.close();}}},getItemProps:function h(l,j){var k=mstrmojo._IsList.getItemProps.call(this,l,j);k.style=this.parent.itemCssText||"";return k;}};},selectedIndex:1,items:N},V()]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"imageSelector",visible:false,selectedColor:undefined,imagePulldown:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(6369,"Images:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"image-pulldown",alias:"imagePulldown",onitemSelected:function J(g){U.call(this.parent,g.v);},getPopupListConfig:function a(){var g=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);g.getItemMarkup=function i(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}"><div class="bc" style="{@bc}"></div><div class="text">{@n}</div></{@tag}>';};g.getItemProps=function h(l,j){var k=mstrmojo._IsList.getItemProps.call(this,l,j);k.bc="background:url("+l.bc+");background-size: contain;background-repeat: no-repeat;";return k;};return g;},items:B},V()]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"basedOn",value:"",metricsList:undefined,options:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4402,"Based on:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"left-pulldown",alias:"metricsList",onitemSelected:function J(j){var i=this.parent,g=i.parent,h=j.did;i.selectedMetric=g.model.basedOnId=h;g.colorSlider.resetMinMax();g.colorSlider.update();g.colorSlider.updateLabels();O.call(g);}},{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:3,cssClass:"right-pulldown option",alias:"options",onitemSelected:function J(i){var l=this.parent,h=l.parent,k=h.breakBy,j=i.v,g=j===7;l.value=j;h.colorSlider.set("selectedOption",i.v);k.set("visible",!g);if(g){k.breakByList.set("selectedIndex",0);}},items:d}]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"breakBy",breakByList:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4564,"Break By:")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"breakByList"}]},{scriptClass:"mstrmojo.threshold.ColorSlider",alias:"colorSlider"},{scriptClass:"mstrmojo.Label",cssClass:"link",alias:"showAdvancedEditorLink",slot:"buttonNode",text:mstrmojo.desc(4569,"Advanced Thresholds Editor..."),onclick:function f(){var i=this.parent,h=i.breakBy.breakByList,g=h.items[h.selectedIndex].did!==-1,j=function(){i.colorSlider.unselectAll();i.close();i.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;};mstrmojo.warn(g?mstrmojo.desc(14160,"Save thresholds definition before proceeding to the Advanced Thresholds Editor? The Break By attribute will be lost."):mstrmojo.desc(14159,"Save thresholds definition before proceeding to the Advanced Thresholds Editor?"),undefined,{cssClass:"save-threshold-warning",buttons:[X(mstrmojo.desc(2827,"Clear"),function(){j();i.controller.openEditor();},false,{cssClass:"nosave"}),X(mstrmojo.desc(2223,"Cancel")),X(mstrmojo.desc(2031,"Apply"),function(){j();h.set("selectedIndex",0);Z.call(i,true);},true)]});}},{scriptClass:"mstrmojo.Box",cssClass:"editor-buttons",slot:"buttonNode",children:[X(mstrmojo.desc(221,"Cancel"),function f(){var g=this.parent.parent;g.colorSlider.unselectAll();g.close();}),X(mstrmojo.desc(1442,"OK"),function f(){var g=this.parent.parent;Z.call(g);g.colorSlider.unselectAll();g.close();},true),X(mstrmojo.desc(2031,"Apply"),function f(){var g=this.parent.parent;Z.call(g,true);g.colorSlider.unselectAll();},true)]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.xtab.XtabMenuConfig");var A=mstrmojo.rw.xtab.XtabMenuConfig.ACTION_TYPES;mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig=mstrmojo.declare(mstrmojo.vi.ui.rw.xtab.XtabMenuConfig,null,{scriptClass:"mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig",buildXtabMenuConfig:function B(C){this._super(C);this.menus=this.menus.filter(function(D){return D.ctxt&&!D.ctxt.isTotals&&(this.isActionAvailable(D.ctxt.data,A.SORT)||this.isActionAvailable(D.ctxt.data,A.PIVOT));},this);},addDrillMenuItem:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.Container","mstrmojo.threshold.TextGroup","mstrmojo.threshold.ThresholdRow","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.ui.editors.controls.CharacterGroup");var G=mstrmojo.Widget,F=mstrmojo.hash,D="180px";mstrmojo.threshold.PropertyPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo.threshold.PropertyPanel],{markupString:'<div class="mstrmojo-threshold-PropertyPanel"><div class="condition"></div><div class="format mstrmojo-vi-PropEditor"><div class="text"><div class="title">'+mstrmojo.desc(5998,"Replace Data")+'</div></div><div class="font mstrmojo-vi-EditorGroup"><div class="title">'+mstrmojo.desc(3433,"Font")+'</div></div><div class="border"><div class="title">'+mstrmojo.desc(5616,"Color And Borders")+'</div></div></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.children[1].firstChild;},fontNode:function(){return this.domNode.children[1].children[1];},borderNode:function(){return this.domNode.children[1].children[2];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:G.visibleMarkupMethod,onheightChange:G.heightMarkupMethod,onwidthChange:G.widthMarkupMethod},model:undefined,editor:undefined,textGroup:undefined,charGroup:undefined,containerGroup:undefined,onvisibleChange:function A(){if(this.visible){var J=this.model;J.updateControl(this);var H=F.clone(J.threshold),I=this.thresholdRow;if(I){this.removeChildren(I);}this.addChildren({scriptClass:"mstrmojo.threshold.ThresholdRow",alias:"thresholdRow",slot:"conditionNode",idx:J.thresholdRow.idx,model:this.editor.model,threshold:H,onclick:mstrmojo.emptyFn});this.refresh();}},onOK:function B(){this.model.submitChange();this.close();},close:function E(){var H=this.thresholdRow;if(H){this.removeChildren(H);}this.set("visible",false);this.editor.toggleButtonStatus(true);this.editor.setRowPanelVisibility(true);},children:[{scriptClass:"mstrmojo.threshold.TextGroup",slot:"textNode",alias:"textGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("threshold",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",slot:"fontNode",alias:"charGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("fmt",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.ContainerGroup",slot:"borderNode",alias:"containerGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("fmt",H,I);}},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",onclick:function(){var H=this.parent;if(H.close){H.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",onclick:function(){var H=this.parent;if(H.onOK){H.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:mstrmojo.desc(14000,"Press ## after finishing formatting.").replace("##",'"√"')}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.Box","mstrmojo.Label","mstrmojo.ui.CheckList","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.models.datasets.DataInterface","mstrmojo.expr","mstrmojo.array","mstrmojo.VisUtility");mstrmojo.requiresDescs(2031,3945,3946,11505,11571,13629,13630,13860,14595,15952);var L=mstrmojo.vi.ui.DatasetUnitMenuUtils,F=mstrmojo.models.datasets.DataInterface,R=mstrmojo.expr.DTP,M=mstrmojo.array,D=mstrmojo.VisUtility;function S(d){var b=350,W={fontFamily:"Arial",fontSize:"12px"},a=D.measureTextWidth(d,W);if(a>b){var Z,X,Y=d.indexOf(" "),c=Y;while(Y>-1){Z=d.substring(0,Y);X=D.measureTextWidth(Z,W);if(X>=b){break;}c=Y;Y=d.indexOf(" ",Y+1);}if(Y>-1){d=d.substring(0,c)+"\n"+d.substring(c);}}return d;}function E(b){var Z,W=b.selector,Y=b.fn(),d=Y.keys,X=Y.items,c=new mstrmojo.ui.CheckList({cssClass:"units",items:X.map(function(e){e.css=L.getUnitCssClass(e.src||{});return e;}),onchange:function(){if(Z){Z.set("okEnabled",true);}}}),a=S(b.title);c.setSelectedItems(X.filter(function(e){return d.indexOf(e.id)>-1;}));Z=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.Box({cssClass:"mstrmojo-vi-FilterBox-content",children:[{scriptClass:"mstrmojo.Label",text:a},c]}),okEnabled:false,data:{},onOpen:function(){c.updateScrollbars();},cssClass:"mstrmojo-vi-FilterBox-targets",okBtnText:mstrmojo.desc(2031,"Apply"),fnOk:function(){W.model.changeFilterTargets(W,d,c.getSelectedItems().map(function(e){return e.id;}),W.isInFilterPanel());}});return Z;}function K(W,X){return function(Y,Z){var a=Y!==Z;if(a){W.set(X,Y);}return a;};}mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu",addModeMenuItems:function N(X,W,Y){if(!W.supportsInclude()){return false;}var Z=function(c,a){var b=W.include===a;X.addMenuItem(c,b?"on":"",function(){if(!b){W.set("include",a);this.generateToolbar();if(Y){Y();}}return !b;}.bind(this));}.bind(this);Z(mstrmojo.desc(3945,"Include"),true);Z(mstrmojo.desc(3946,"Exclude"),false);X.hasToggleItem=true;X.addSeparator();return true;},addShowAllMenuItem:function O(X,W){if(!W.supportsShowAllToggle()||W.isAttrQualSelector()||W.isRecursiveAttributeSelector()||W.isSearchBox()||mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()){return false;}var Z=mstrmojo.desc(4741,"Show option for all");if(!W.include){X.addNonInteractiveMenuItem(Z,"",true);return true;}var Y=function(){var c=!W.defn.showall,a=W.model,b=a.getSelectorPropsChangeAction(W,{showAll:c}),d=b.concat(a.getCtrlActionsByStyleForToggleShowAll(W,c));a.submitToggleShowAllActions(W,d);};X.addToggleMenuItem(Z,"",Y,Y,this.id,W.defn.showall);return true;},addClearFilterMenuItem:function H(X,W,Y){X.addMenuItem(mstrmojo.desc(14595,"Unset Filter"),"",function(){W.clearSelector(true);if(Y){Y();}});return true;},addMenuItemIfSelectTargetsValid:function V(X,W,Y){if(!mstrApp.isAppStatePresentation()){var Z=this.getTargetInfo();if(Z.items.length){X.addEditorMenuItem(mstrmojo.desc(13629,"Select Targets"),this.id,E,{selector:W,fn:this.getTargetInfo.bind(this),title:Y});}}},addFilterStyleMenuItem:function C(X,W){if(mstrApp.isAppStatePresentation()||W.isSolrSelector()){return false;}var Y=W.getSelectorStyleList();if(!Y.length){return false;}X.addSubMenuItem(mstrmojo.desc(11505,"Display Style"),"",this.id,function(){var a=W.defn.style,Z=function(c){return function(){if(c!==a){var d=mstrmojo.DocSelector.STYLES.ATTR_QUAL;if(c===d||a===d){W.model.openSelWarnFlag(W.k);}W.model.changeFilterStyle(W,c);}};};var b=new mstrmojo.ui.menus.MenuConfig();if(W.isDynamicAttributeSelector()&&W.expr){b.useTooltip=true;Y.forEach(function(d){var c=d.n;if(a!==d.v){c=typeof c==="object"?c.n:c;b.addDisabledMenuItem({n:c,ttp:mstrmojo.desc(15952,"Please unset filter selections before switching to the # display style").replace("#",c)});}else{b.addMenuItem(c,"on",mstrmojo.emptyFn);}});}else{Y.forEach(function(c){var d=c.v;b.addMenuItem(c.n,a===d?"on":"",Z(d));},this);}b.hasToggleItem=true;return b;});return true;},addMultiSelectMenuItem:function I(X,W){if(!W.allowsTogglingMultiSelect()||mstrApp.isAppStatePresentation()){return false;}X.addMenuItem(mstrmojo.desc(13860,"Allow Multiple Selections"),W.multi?"on":"",function(){W.model.changeFilterStyle(W,W.style,!W.multi,W.iase);});X.hasToggleItem=true;return true;},addAutoSearchMenuItem:function G(X,W){if(!W.allowsTogglingAutoSearch()||mstrApp.isAppStatePresentation()){return false;}X.addMenuItem(mstrmojo.desc(15913,"Allow Instant Search"),W.iase?"on":"",function(){W.model.changeFilterStyle(W,W.style,W.multi,!W.iase);});X.hasToggleItem=true;return true;},addConfigVisSelectorMenu:function B(X,W){var Y=this;X.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){Y.closeVisSelectorPanel();var a=W.model,Z=W.k;a.checkLargeItemsForVisFilter(Z,function(){var b=a.addVisFilterContainer(),d=a.getSelectedViUnit(),c;a.oldSelectedVizBoxId=d.id;mstrApp.isInVFConfigMode=true;mstrApp.restoreVFKey=Z;a.beforeEnterVFConfigMode();c=a.insertVizBox(Z,b,{});a.controller.rootCtrl.initPanelStautsInConfigMode();a.selectVIUnit(c.id,true,{isAddAction:true});mstrApp.getRootController().enterVizFilterConfigMode(W.parent.baseTitle,true);});});},addQualMenuItems:function P(X,W){if(W.isSolrSelector()||!W.isMetricSelector()||W.isRankMetricSelector()||!W.isNumericMetricSelector()){return false;}X.addRadioMenuGroup(W.qua>0?1:0,K(W,"qua"),[{value:0,text:mstrmojo.desc(11571,"Qualify on Value")},{value:1,text:mstrmojo.desc(13630,"Qualify on Rank")}],"",undefined,true);X.addSeparator();return true;},addBFAMenuItem:function J(X,W){if(W.isRecursiveAttributeSelector()&&W.showBFAMenu&&!mstrApp.isDossier&&!mstrApp.isAppStatePresentation()){X.addMenuItem(mstrmojo.desc(16618,"Use alternate filter technique"),W.defn.pdf?"on":"",function(){W.changeFilterTechnique();});X.hasToggleItem=true;}},addSetDisplayFormsMenuItem:function A(c,Z){var X=Z.node.data.dt;if(!Z.isAttributeSelector()&&!Z.isNewDerivedRecursiveElementSelector()||(Z.isAttrQualSelector()&&(X===R.DATE||X===R.TIMESTAMP))){return false;}var a=Z.model,d=Z.defn,Y=[],h=L.getUnitFromDataset(a.datasets,d.srcid,d.srct),f=h&&h.attId,W=F.getFormsByAttrId(f||d.srcid,a.datasets);if(Z.isRecursiveAttributeSelector()){W=M.filter(W,function(i){return i.fid!=="A9BFF03B4D72CC4F457ACBB4B185E91D"&&i.fnm!=="LEVEL_NUMBER";});}if(W.length<2){return false;}var e=d.fs;if(!e){var b=[],g=a.getDatasetUnits(["att","mx"],function(i){return i.did===(f||d.srcid);})[0]||{};(g.fs||[]).forEach(function(i){if(i.isbf){b.push({did:i.fid});}});if(b.length){e=b;}}W=M.map(W,function(j,i){var k=j.fid;if(M.find(e,"did",k)!==-1){Y[i]=true;}return{id:k,n:j.fnm};});if(mstrmojo.resolveFeature("set-attributeform-display")&&!mstrApp.isAppStatePresentation()){c.addPopupMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"displayForms",data:{defn:d,oldSelectedIndices:Y.slice()},contents:[{alias:"formCheckList",scriptClass:"mstrmojo.ui.CheckList",minimumSelectCnt:1,items:W,selectedIndices:Y.slice()}],fnOk:function j(o,t){var m=[],q=t.formCheckList,u=q.items,k=q.selectedIndices,n=false,p;for(p=0;p<u.length;p++){var l=!!o.oldSelectedIndices[p],s=!!k[p];if(l!==s){n=true;break;}}if(!n){return ;}M.forEach(k,function(w,x){if(w){m.push(u[x]);}});a.setFilterDisplayForms(Z,m);},onOpen:function i(){this.formCheckList.updateScrollbars();}});});}},addReplaceWithMenuItem:function U(X,W){var Y=W.getSelectorReplaceUnitList();if(Y.length===0){return false;}X.addEditorMenuItem(mstrmojo.desc(14003,"Replace with"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"replaceReference",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:W.getSelectorReplaceUnitList(),listHooks:{select:function Z(a,b){if(W.isInFilterPanel()){W.model.replaceFilterStackSelectors(W.defn,b);}else{W.model.replaceFilter(W,b);}}}}]}]});});return true;},getTargetInfo:function Q(){this.throwAbstractMethodError("getTargetInfo");}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.VisUtility");var E=mstrmojo.array,D=mstrmojo.hash,A=mstrmojo.func.wrapMethods;function B(F){return F.model.controller.cmdMgr;}mstrmojo._colorPalette=mstrmojo.provide("mstrmojo._colorPalette",{listenToUpdateColorMap:function(I){if(mstrmojo.VisUtility.isOnExpressMode()){return ;}var H=this,G,F=(H.getDocModel&&H.getDocModel())||H.model.docModel;if(F){return F.attachEventListener("colorMapChanged",H.id,function(K){G=H.parent.parent;if(G.isPanelDisplaying()){I.call(H);}else{var J=G.attachEventListener("panelDisplaying",H.id,function(L){if(H.postBuilderingCalled){I.call(H);}G.detachEventListener(J);});}});}},detachUpdateColorMapListener:function(G){if(!G){return ;}var F=(this.getDocModel&&this.getDocModel())||this.model.docModel;F.detachEventListener(G);},submitUpdatesAndPersistXML:function C(H,L,F,P){if(!H||H.length===0){return ;}var G={},M=this,Q=(M.getDocModel&&M.getDocModel())||M.model.docModel,O=Q.getDataService(),I=M.model.controller||Q.controller,J=I._getXtabCallback(M);if(F){D.copy(mstrmojo.DocDataService.SUPPRESS_DATA,G);}if(P){D.copy(mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION,G);}var K=false;E.forEach(H,function(R){if(R.act==="updateElementsPropertiesMap"){K=true;}});if(K){A(Q.getUpdateColorMapCallback(),J);}B(M).execute({execute:function N(){var R=O.newUpdate(this,undefined);R.add(H,L,G);this.submitUpdate(R);},urInfo:{callback:J}});},updateColorMap:function(I,G,K){if(!E.isArray((G))){G=[G];I=[I];}if(I.length!==G.length){throw new Error("comb and color number mismatch");}var F=(this.getDocModel&&this.getDocModel())||this.model.docModel,J=mstrmojo.VisUtility.getUpdateColorMapAction.bind(this),H=I.map(function(M,L){return J(M,JSON.stringify({color:G[L]}));});this.submitUpdatesAndPersistXML(H,K?A(F.getUpdateColorMapCallback(),K):F.getUpdateColorMapCallback(),false,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._Formattable","mstrmojo._IsDocumentTemplate","mstrmojo.Label","mstrmojo.VisUtility","mstrmojo.ui.menus.MenuConfig","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.rw._SupportViewFilterInVizBox","mstrmojo.util.FontLoader");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");var R={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};var L=["background-color","fx"],H={width:"width",height:"height"},Y=mstrmojo.array,K=mstrmojo.hash;mstrmojo.VisBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._IsDocumentTemplate,mstrmojo.vi.ui.rw._SupportViewFilterInVizBox,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.VisBase",updated:false,waitingForData:false,node:null,excludeData:false,skipReRender:false,updateFormatsOnUpdate:true,bgFormats:{},init:function d(l){this.excludeData=!!(mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause());if(this._super){this._super(l);}},setModel:function g(l){this.set("model",l);},destroy:function c(){var l=this.model;if(l&&l.destroy){l.destroy();delete this.model;}this._super();},resize:function N(){var l=this.getFormats();if(parseInt(l.height,10)===0||parseInt(l.width,10)===0){this.domNode.style.display="none";}else{this.setDimensions(l.height,l.width);this.domNode.style.display="";}},setDimensions:function b(n,m){var l=this._super(n,m);if(l&&this.hasRendered&&!this.skipReRender){this.reRender();}return l;},reRender:function J(){this.unrender();this.render();},getWidth:function h(){return parseInt(this.width,10);},getHeight:function X(){return parseInt(this.height,10);},getLeft:function V(){return parseInt(this.left,10);},getTop:function B(){return parseInt(this.top,10);},getFonts:mstrmojo.emptyFn(),loadFonts:function E(l,m){if(mstrmojo.util.FontLoader.load(l,m)){m.success();}},preBuildRendering:function A(){if(this.requirePreload){var l=function l(){this.requirePreload=false;this.render();};if(mstrmojo.util.FontLoader.load(this.getFonts(),{success:l.bind(this),failure:l.bind(this)})){return this._super();}else{return false;}}return this._super();},buildRendering:function D(){this.height=this.getHeight();this.width=this.getWidth();this.left=this.getLeft();this.top=this.getTop();if(!this.updated){this.update();}this._super();},initFromVisProps:function a(){},postBuildRendering:function(){var l=this.isEmpty();this._super();this.raiseEvent({name:"toggleCtrlOverlay",visible:l||this.excludeData,controls:this.getVisEmptyMsgControls()});this.applyBackground();return !l;},applyBackground:function W(){var m=this.bgFormats,o,l,p,n;if(mstrApp.isExpress&&!K.isEmpty(m)){o=this.formatHandlers=this.formatHandlers||{};p=o.domNode=o.domNode||[];l="BG";n=Y.indexOf(p,l);if(n<0){p.push(l);}this.applyCSSFormatToNode("domNode",m);}},parseBgFormats:function G(){var l=this.id;return{success:function(s){var o,u,q,m,t,n,p=mstrmojo.all[l],w=p&&p.getDocModel();if(s.defn&&s.defn.layouts&&p&&w){u=s.defn.layouts;o=Y.find(u,"k",w.getCurrentLayoutKey());q=u[o];m=q&&q.units&&q.units[p.k];t=m&&m.fmts;if(t){n=p.bgFormats={};Y.forEach(L,function(x){if(t[x]){n[x]=t[x];}});}}}};},onAppStateChange:function(l){var m=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),n=l.valueWas&mstrmojo.vi.VisualInsightApp.APP_STATES.PAUSE;this.excludeData=!!(mstrConfig.resolveOnly||m);if(this._super){this._super(l);}if(m&&!n||(!m&&n&&!mstrApp.enableUpdate)){this.raiseEvent({name:"toggleCtrlOverlay",visible:this.excludeData||this.isEmpty(),controls:this.getVisEmptyMsgControls()});}},refresh:function i(l){if(this.excludeData){this.raiseEvent({name:"toggleCtrlOverlay",visible:true,controls:this.getVisEmptyMsgControls()});return ;}this._super(l);},update:function Z(o){o=o||this.node;if(o){var l=o.data;if(l){this.model.set("data",l);}this.waitingForData=!!l.nsj;if(this.waitingForData){var m="ServerJsonRWDStyle";var p=this.model,n=p.getDataService(),q={host:this,nodes:[this.k]},t;if(l.wid!==undefined){q.slices=[l.wid];}t=mstrmojo.func.wrapMethods(this.parseBgFormats(),p.docModel.getUpdateColorMapCallback(),p.docModel.getUpdateThemePaletteCallback(true),p.controller._getXtabCallback(this,false));n.retrieveServerJson(q,t,{preserveUndo:true,style:{name:m,params:{treesToRender:3}},params:{styleName:m}});this.updated=true;return false;}this.updateContentFormats(o);}if(this.model){var u=this.model&&this.model.docModel;this.initFromVisProps(this.model.vp);if(u&&u.getDocBuilder){var s=u.getDocBuilder().getMojoVisName(o);if(s){o.data.visName=s;}}}this.updated=true;if(this._super){return this._super(o);}return true;},updateContentFormats:function M(p){var n,q,m,o=p.defn,l=this.builder;if(this.updateFormatsOnUpdate&&o){if(l&&l.isPortlet&&l.isPortlet(o)){q=H;}else{q=R;}m=o.fmts||o.units[this.model.k].fmts;for(n in q){if(q.hasOwnProperty(n)&&m.hasOwnProperty(n)){this[q[n]]=m[n];}}}},isEmpty:function O(){return false;},getVisEmptyMsgControls:function I(){return[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(11668,"Drag objects here.")}];},getModel:function j(){return this.model;},getData:function Q(){return this.model.data;},getRowsAndCols:function(){var l=this.model.data.gts;return(l.row||[]).concat(l.col||[]);},getExp:function(){var l=this.model.data,m=l&&l.sc&&l.sc.exp;return m;},getDocModel:function e(){return this.model&&this.model.docModel;},getTitleRMCPopup:mstrmojo.emptyFn,getMenuHandler:function U(){return mstrmojo.emptyFn;},renderErrorMessage:function k(l){this.domNode.innerHTML='<div class="mstrmojo-message">'+l+"</div>";},getMessageID:function S(){return this.model.docModel.mid||this.model.mid;},performAction:function f(l){var m=this.model,p=this.scriptClass==="mstrmojo.heatmap.vi.VisHeatMap",o=p?m.getHMAction(l):m.getAction(l),n=o&&o.h;if(n&&this.controller[n]){this.controller[n](this,o.a);return true;}return false;},deleteSelectorControl:function P(){var l=this.getData(),m=l.sc;if(m&&parseInt(m.ct,10)===6){delete l.sc;}},findSelectorControl:function F(){var m=this.getData(),l=m&&m.sc;if(l&&parseInt(l.ct,10)===6){this.selectorControl=l;this.isMultiSelect=true;}else{delete this.selectorControl;}return this.selectorControl;},displayVizBoxVisFilterIndicator:function C(l,m){if(l&&m&&m.displayVisFilterIndicator){m.displayVisFilterIndicator();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.locales");mstrmojo.requiresCls("mstrmojo.chart.enums.EnumFontStyle");mstrmojo.requiresCls("mstrmojo.VisUtility");mstrmojo.requiresClsP("mstrmojo.chart.common","DSSDateTime","ScalePlate");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphProperty","EnumDSSGraphDataTextShowType","EnumDSSGraphObject");var h=mstrmojo.chart,d=h.model,p=mstrmojo.VisUtility,Q=h.enums,E=Q.EnumFontStyle,S=d.enums,AA=S.EnumDSSGraphProperty,Y=S.EnumDSSGraphDataTextShowType,AB=S.EnumDSSGraphObject;var F=mstrmojo.gm.EnumDataLabels;var W=[["xAxLbFntClr","yAxLbFntClr","dlFntClr","lgdFntClr"],["xAxLbFntFml","yAxLbFntFml","dlFntFml","lgdFntFml"],["xAxLbFntSz","yAxLbFntSz","dlFntSz","lgdFntSz"],["xAxLbFntStyle","yAxLbFntStyle","dlFntStyle","lgdFntFml"]];var q=[["majorGridLnThk","minerGridLnThk","majorGridLnThk","minerGridLnThk"],["majorGridLnClr","minerGridLnClr","majorGridLnClr","minerGridLnClr"],["majorGridLnStyle","minerGridLnStyle","majorGridLnStyle","minerGridLnStyle"]];var Z=[["bgFillClr"],["bgFillStyle"],["bgFillTrans"]];function V(AL){switch(AL){case AA.DssGraphFontColor:return 0;case AA.DssGraphFontName:return 1;case AA.DssGraphFontSize:return 2;case AA.DssGraphFontStyle:return 3;case AA.DssGraphFontSize100:return 4;default:return -1;}}function w(AL){switch(AL){case AA.DssGraphAreaColor:return 0;case AA.DssGraphFillEffect:return 1;case AA.DssGraphAreaAlpha:return 2;}return -1;}function y(AL){var AM;switch(AL){case AB.DssGraphX1Body:case AB.DssGraphX1Label:case AB.DssGraphX1Major:case AB.DssGraphX1Minor:case AB.DssGraphUserLabel3:case AB.DssGraphUserLine3:AM="X1";break;case AB.DssGraphX2Body:case AB.DssGraphX2Label:case AB.DssGraphX2Major:case AB.DssGraphX2Minor:case AB.DssGraphUserLabel4:case AB.DssGraphUserLine4:AM="X2";break;case AB.DssGraphY1Body:case AB.DssGraphY1Label:case AB.DssGraphY1Major:case AB.DssGraphY1Minor:case AB.DssGraphUserLabel1:case AB.DssGraphUserLine1:AM="Y1";break;case AB.DssGraphY2Body:case AB.DssGraphY2Label:case AB.DssGraphY2Major:case AB.DssGraphY2Minor:case AB.DssGraphUserLabel2:case AB.DssGraphUserLine2:AM="Y2";break;case AB.DssGraphZBody:AM="Z";break;case AB.DssGraphO1Body:case AB.DssGraph2DO1Label:case AB.DssGraphO1Major:case AB.DssGraphO1Minor:AM="O1";break;case AB.DssGraphO2Body:case AB.DssGraph2DO2Label:case AB.DssGraphO2Major:case AB.DssGraphO2Minor:AM="O2";break;default:AM="No_Axis";break;}return AM;}function e(AL,AM){if(!!AL===false){return undefined;}return undefined;}function X(AQ,AL){if(!!AQ===false){return undefined;}var AV,AT,AS=AL.isVertical!==undefined?AL.isVertical:true,AN=AL.isGridChart||false,AW=AL.isPieShape||false,AR={Name:0,Value:0},AO=AQ.gaid,AP=AQ.goid,AM=AQ.gsid,AU=AQ.v;if(!!AO===false){return undefined;}switch(AO){case AA.DssGraphShowLBLFeeler:if(AW){AR.Name="DataLabel";if((AU&Y.DssGraphDataTextValue)!==0){AR.Value=F.SHOW_VALUE_ONLY;}else{if((AU&Y.DssGraphDataTextLabel)!==0){AR.Value=F.SHOW_TEXT_ONLY;}else{AR.Value=F.HIDE;}}}break;case AA.DssGraphAreaColor:case AA.DssGraphFillEffect:case AA.DssGraphAreaAlpha:AT=w.call(this,AO);if(AT<0){return undefined;}if(AP===AB.DssGraphBackground){AR.Name=Z[AT][0];if(AR.Name.search("Trans")!==-1){AR.Value=AU/255*100;}else{AR.Value=AU;}}break;case AA.DssGraphShowLegendText:AR.Name="LegendVisibleness";AR.Value=AU===0?false:true;break;case AA.DssGraphSDShowDataText:AR.Name="ShowSeriesDataLabel";AR.Value=AU!==0;break;case AA.DssGraphShowDataText:if(AW===false){AR.Name="DataLabel";AR.Value=F.HIDE;if(AU&Y.DssGraphDataTextValue){AR.Value=F.SHOW_VALUE_ONLY;}else{if(AU&Y.DssGraphDataTextLabel){AR.Value=F.SHOW_TEXT_ONLY;}}}break;case AA.DssGraphFontColor:case AA.DssGraphFontName:case AA.DssGraphFontSize100:case AA.DssGraphFontSize:case AA.DssGraphFontStyle:AR.Value=AU;AV=y.call(this,AP);AT=V.call(this,AO);if(AT<0){return undefined;}if(AT===4){AT=3;AR.Value/=100;}if(AV==="No_Axis"){if(AP===AB.DssGraphDataText){if(AW){return undefined;}AR.Name=W[AT][2];}else{if(AP===AB.DssGraphPieFeelerLabel||AP===AB.DssGraphPieFeelerLabel){if(AW===false){return undefined;}AR.Name=W[AT][2];}else{if(AP===AB.DssGraphLegendText){AR.Name=W[AT][3];}else{return undefined;}}}}else{if(AV[0]==="X"){AR.Name=W[AT][0];}else{if(AV[0]==="Y"){AR.Name=W[AT][1];}else{if(AV[0]==="O"){AR.Name=AS?W[AT][0]:W[AT][1];}else{return undefined;}}}}break;}return AR;}var U,j=String.fromCharCode,AE=mstrmojo.locales.datetime,AK=0,L=document.getElementById("measureText"),B={},i={};var n=0.03,K=0,R=0,H=0.2;function o(AM){var AL,AN=[],AO;for(AL=0;AL<=AM;AL++){AO=AL.toString(16);if(AO.length===1){AO="0"+AO;}AN[AL]=AO;}U=AN;return AN;}function AH(AL){var AM=parseFloat(AL);if(isNaN(AM)===false&&AM!==undefined&&AM!==null){return AM;}return 0;}function D(AL){AL=AL.replace(/ddd/g,"EEE");AL=AL.replace(/AM\/PM/g,"a");AL=AL.replace(/tt/g,"a");AL=AL.replace(/:'/g,":");AL=AL.replace(/'\/'/g,"/");AL=AL.replace(/\\/g,"");var AM,AO=true,AN=AL.length;for(AM=0;AM<AN;AM++){if(AL[AM]==="h"||AL[AM]==="H"||AL[AM]===":"){AO=true;}else{if(AL[AM]===" "&&AO){AO=true;}}if(AL[AM]==="m"&&AO){AL=AL.substring(0,AM)+"M"+AL.substring(AM+1);}}return AL;}mstrmojo.chart.common.Utility=mstrmojo.provide("mstrmojo.chart.common.Utility",{point2D:{},rect2D:{},tripleId:{create:function M(AM,AQ,AO,AN,AP){if(AM===null||AM===undefined){AM=-3;}if(AQ===null||AQ===undefined){AQ=-3;}if(AO===null||AO===undefined){AO=-3;}var AL={mObjectId:AM,mSeriesId:AQ,mGroupId:AO};if(AN!==undefined&&AN!==null){AL.angleByIndex=AN;}if(AP!==undefined&&AP!==null){AL.sliceById=AP;}return AL;},walks:function l(AP,AN){if(!!AP===false||!!AN===false){return null;}if(AP.length===1){return AN[AP[0]];}var AO=(AP&&AP.length)||0,AM,AL=AP[AM];for(AM=0;AM<AO;AM++){if(AN[AL]===undefined){AN[AL]={};}AN=AN[AL];}return AN;},equal:function b(AL,AM){return(AL.mObjectId===AM.mObjectId&&AL.mSeriesId===AM.mSeriesId&&AL.mGroupId===AM.mGroupId);},reset:function s(AN,AP,AO,AM,AL,AQ){AN.mObjectId=AP!==undefined?AP:-3;AN.mSeriesId=AO!==undefined?AO:-3;AN.mGroupId=AM!==undefined?AM:-3;if(AL!==undefined&&AL!==null){AN.angleByIndex=AL;}if(AQ!==undefined&&AQ!==null){AN.sliceById=AQ;}return AN;}},transformProperty:function A(AL,AN,AM){if(AN===0){return X.call(this,AL,AM);}return e.call(this,AL,AM);},abbreviateNumber:function c(AV,AL){var AW,AM,AX="",AO=(AV<0),AY=(this.isIntegar(AV)===false);if(AY){AL++;}if(AV<0){AL++;}var AR=AO?-AV:AV;var AS=0;if(AR>=1e+27){AR=999;AX="Y";}else{if(AR>=1e+24){AR/=1e+24;AX="Y";}else{if(AR>=1e+21){AR/=1e+21;AX="Z";}else{if(AR>=1000000000000000000){AR/=1000000000000000000;AX="E";}else{if(AR>=1000000000000000){AR/=1000000000000000;AX="P";}else{if(AR>=1000000000000){AR/=1000000000000;AX="T";}else{if(AR>=1000000000){AR/=1000000000;AX="B";}else{if(AR>=1000000){AR/=1000000;AX="M";}else{if(AR>=1000){AR/=1000;AX="K";}else{if(AR>=1){AS++;}else{if(AR>=0.001){AS++;}else{if(AR>=0.000001){AS++;}else{if(AR>=1e-9){AS++;}else{if(AR>=1e-12){AS++;}else{AO=false;}}}}}}}}}}}}}}if(this.isIntegar(AR)===false){AW=AR.toString();var AN=5,AQ=2,AZ;AM=AW.indexOf(".");AZ=AW.length-AM-1;if(AZ>AN||(AZ>AQ&&AZ>AM)){if(AZ>AN&&AL-AZ<0){AQ=Math.max(AQ,Math.min(AQ,AL-AZ));}else{AQ=Math.max(1,Math.min(AQ,AL-AZ));}AR=AR.toFixed(AQ);}}AW=AR.toString();if(this.isIntegar(AR)===false){var AU=AW.length-1;AM=AW.indexOf(".");if(AM!==-1){if(AM>=AU){AW=AW.substring(0,AM);}else{var AT,AP=true;for(AT=AU;AT>AM&&AP;--AT){if(AW[AT]!=="0"){AP=false;}}if(AP){AW=AW.substring(0,AM);}}}}if(AO){AW="-"+AW;}AW+=AX;return AW;},getScalePlate:function AG(AL){AL=AL||false;this.mScalePlate=mstrmojo.chart.common.ScalePlate;if(AL){this.mScalePlate.clear();}return this.mScalePlate;},prepareScalePlateOptions:function AD(AN,AM,AO){var AL={mUseLogarithmicScale:AN,mAlwaysIncludeZero:!AN&&(AM||!!(AO&1)||!!(AO&2)),mShowMinLabel:true,mShowMaxLabel:true,mDrawCustomLine:false,mAxisMinValue:0,mAxisMaxValue:0,mAxisCustomValue:0,mUseCustomMinMax:false};return AL;},evaluateTextMargin:function P(AL){this.mTextMargins=this.mTextMargins||{};var AM=this.mTextMargins;if(AM[AL]){return AM[AL];}var AN=[];AN[0]=Math.floor(AL*n+0.5);AN[1]=Math.floor(AL*K+0.5);AN[2]=Math.max(Math.floor(AL*R+0.5),1);AM[AL]=AN;return AN;},AlmostZero:function z(AL){return(Math.abs(AL)<0.000001);},isValidNumber:function J(AL){if(typeof AL==="number"){if(AL===0){return true;}return !!AL;}return false;},isIntegar:function k(AL){return AL===+AL&&AL===(AL|0);},HasArrayIntersection:function O(AM,AL){var AN;for(AN=0;AN<AM.length;AN++){if(AL.indexOf(AM[AN])!==-1){return true;}}return false;},EscapeString:function C(AL){var AN='"',AM='\\"',AO=new RegExp(AN,"g");return String(AL).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"\\\\").replace(AO,AM).replace(/\r\n/g,"<br/>").replace(/\r/g,"<br/>").replace(/\n/g,"<br/>");},EscapeStringForJSON:function N(AL){var AN='"',AM='\\"',AO=new RegExp(AN,"g");return String(AL).replace(/\\/g,"\\\\").replace(AO,AM).replace(/\r/g,"\\r").replace(/\n/g,"\\n");},TrimLastComma:function AF(AM){var AL;if(!AM.buf||AM.len===-1){return ;}AL=AM.len;var AN=String(AM.buf[AL]);if(AN&&AN[AN.length-1]===","){AM.buf[AL]=AN.slice(0,-1);}},decodeUTF8:function g(AL){var AM="",AO=0,AQ=0,AP=0,AN=0;while(AO<AL.length){AQ=AL.charCodeAt(AO);if(AQ<128){AM+=j(AQ);AO++;}else{if((AQ>191)&&(AQ<224)){AP=AL.charCodeAt(AO+1);AM+=j(((AQ&31)<<6)|(AP&63));AO+=2;}else{AP=AL.charCodeAt(AO+1);AN=AL.charCodeAt(AO+2);AM+=j(((AQ&15)<<12)|((AP&63)<<6)|(AN&63));AO+=3;}}}return AM;},formatDateTimeValue:function f(AM,AR){var AP=new mstrmojo.chart.common.DSSDateTime({ifTime:AR});var AL="";var AO="";var AS=0;while(AS<AM.length){var AN=1;switch(AM.charAt(AS)){case"[":AS++;while(AS<AM.length&&AM.charAt(AS)!=="]"){AO+=AM.charAt(AS);AS++;}if(AO.length>0&&(AO[0]===">"||AO[0]==="<"||AO[0]==="=")){AO="";}AS++;break;case"y":AS++;while(AS<AM.length&&AM.charAt(AS)==="y"){AN++;AS++;if(AN===4){break;}}if(AN===1||AN===2){AL+=this.fillZeroToWidth(AP.mnYear%100,2);}else{if(AN===3){AL+=this.fillZeroToWidth(AP.mnYear%100,2);AS--;}else{if(AN===4){AL+=AP.mnYear;}}}break;case"M":AS++;while(AS<AM.length&&AM.charAt(AS)==="M"){AN++;AS++;}if(AN<3){AL+=this.fillZeroToWidth(AP.mnMonth,AN);}else{if(AN===3){AL+=AE.MONTHNAME_SHORT[AP.mnMonth];}else{AL+=AE.MONTHNAME_FULL[AP.mnMonth];}}break;case"d":AS++;while(AS<AM.length&&AM.charAt(AS)==="d"){AN++;AS++;}if(AN<3){AL+=this.fillZeroToWidth(AP.mnDay,AN);}else{if(AN===3){AL+=AE.dayShortNames[AP.mnDay];}else{AL+=AE.dayNames[AP.mnDay];}}break;case"h":AS++;while(AS<AM.length&&AM.charAt(AS)==="h"){AN++;AS++;}var AQ=AP.mnHour;if(AQ===0){AQ=12;}if(AQ>12){AQ-=12;}AL+=this.fillZeroToWidth(AQ,AN);break;case"H":AS++;while(AS<AM.length&&AM.charAt(AS)==="H"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnHour,AN);break;case"m":AS++;while(AS<AM.length&&AM.charAt(AS)==="m"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnMinute,AN);break;case"s":AS++;while(AS<AM.length&&AM.charAt(AS)==="s"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnSecond,AN);break;case"S":AS++;while(AS<AM.length&&AM.charAt(AS)==="S"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnMillisecond,AN);break;case"a":AQ=AP.mnHour;if(AQ<12){AL+=AE.AM_NAME;}else{AL+=AE.PM_NAME;}AS++;break;default:AL+=AM.charAt(AS++);break;}}if(AO.length!==0){AL='<SPAN STYLE="COLOR: '+AO+'" >'+AL+"</SPAN>";}return AL;},fillZeroToWidth:function m(AP,AN){var AM="",AO=AM+AP;var AL=AO.length;while(AL<AN){AO="0"+AO;AL++;}return AO;},fillZeroRightToWidth:function AJ(AQ,AO){var AN="",AP=AN+AQ;var AM=AP.indexOf(".");if(AM!==-1){AP=AP.slice(0,AM)+AP.slice(AM+1);}var AL=AP.length;while(AL<AO){AP=AP+"0";AL++;}return AP;},updateCache:function AI(AM,AP,AQ){var AO=(AP&&AP.length)||0,AN,AL,AR=AM;for(AN=0;AN<AO-1;AN++){AL=AP[AN];if(!AR[AL]){AR[AL]={};}AR=AR[AL];}AR[AP[AO-1]]=AQ;},measureTextHeight:function(AQ,AN,AU,AR,AL){var AT,AP=AQ;if(AP===" "){AP="\u00A0";}AL=AL||"pt";if(typeof AU==="number"){AU=AU+AL;}var AM="none",AS="normal";if(AR&E.FS_ITALIC){AM="italic";}if(AR&E.FS_BOLD){AS="bold";}var AO={fontFamily:AN,fontSize:AU,fontStyle:AM,fontWeight:AS};if(i&&i.H&&i.H[AN]&&i.H[AN][AU]&&i.H[AN][AU][AR]){AT=i.H[AN][AU][AR];}else{AT=p.measureTextHeight("H",AO,1);this.updateCache(i,["H",AN,AU,AR],AT);}return AT;},measureText:function x(AS,AP,AY,AT,AN){var AM=true,AL,AW=AY+1;var AR=AS;if(AR===" "){AR="\u00A0";}AN=AN||"pt";if(typeof AY==="number"){AY=AY+AN;}if(B&&B[AR]&&B[AR][AP]&&B[AR][AP][AY]&&B[AR][AP][AY][AT]){return B[AR][AP][AY][AT];}if(AM){var AO="normal",AU="normal";if(AT&E.FS_ITALIC){AO="italic";}if(AT&E.FS_BOLD){AU="bold";}var AQ={fontFamily:AP,fontSize:AY,fontStyle:AO,fontWeight:AU};if(i&&i.H&&i.H[AP]&&i.H[AP][AY]&&i.H[AP][AY][AT]){AW=i.H[AP][AY][AT];}else{AW=p.measureTextHeight("H",AQ,true);this.updateCache(i,["H",AP,AY,AT],AW);}AL=p.measureTextWidth(AS,AQ,0);}else{if(!L){var AV=document.createElement("div");AV.id="measureText";AV.style.position="absolute";AV.style.top="0";AV.style.visibility="hidden";AV.style.height="auto";AV.style.width="auto";document.body.appendChild(AV);L=AV;}L.innerHTML="";L.appendChild(document.createTextNode(AR));L.style.fontFamily=AP;L.style.fontSize=AY;L.style.fontWeight="normal";L.style.fontStyle="none";if(AT&E.FS_ITALIC){L.style.fontStyle="italic";}if(AT&E.FS_BOLD){L.style.fontWeight="bold";}AL=L.scrollWidth+1;AW=L.scrollHeight+1;}var AX={Width:AL,Height:AW};this.updateCache(B,[AR,AP,AY,AT],AX);return AX;},ReplaceDecimalPoint:function AC(AM,AL){return AM.replace(".",AL);},ReplaceMinusSign:function u(AL,AM){return AL.replace("-",AM);},insert:function G(AM,AL,AN){if(typeof AM==="string"&&typeof AL==="string"&&AN<=AM.length){return AM.substr(0,AN)+AL+AM.substr(AN);}return AM;},InsertThousandSeparator:function t(AN,AO,AS){var AL=AS.mstrDecimalPoint;var AM=AN.indexOf(AL);if(AM===-1){AM=AN.length;}var AP=0;while(AP<AM&&!this.chk_val(AN.charAt(AP))){AP++;}var AR=AN;var AQ;for(AQ=AM-3;AQ>AP;AQ-=3){AR=this.insert(AR,AO,AQ);}return AR;},chk_val:function I(AL){return/^\d+$/.test(AL);},hFormatValue:function a(AY,AP,Aj,A7){var AW=0;var Aq=0;var Af=AY.length;var BF=false;if(!A7){A7={};var Ao=window.navigator.userLanguage||window.navigator.language;var BQ=Ao.split("-");this.mstrLanguageCode=BQ[0];this.mstrCountryCode=BQ[1]||BQ[0];A7.mstrThousandSeparator=mstrmojo.locales.number.THOUSANDSEPARATOR||",";A7.mstrCurrencySymbol="$";A7.mstrDecimalPoint=mstrmojo.locales.number.DECIMALSEPARATOR||".";A7.mstrPercentSign="%";A7.mstrMinusSign="-";}while(AW<Af){if(AY.charAt(AW)==='"'){AW++;while(AW<Af&&AY.charAt(AW)!=='"'){AW++;}AW++;}else{if(AY.charAt(AW)==="["){AW++;var Ap="";while(AW<Af&&AY.charAt(AW)!=="]"){Ap+=AY.charAt(AW);AW++;}if(Ap.length>1&&(Ap.charAt(0)===">"||Ap.charAt(0)==="<"||Ap.charAt(0)==="=")){var AM=-1;var A9=0;switch(Ap.charAt(0)){case">":if(Ap.charAt(1)>="0"&&Ap.charAt(1)<="9"){AM=1;A9=1;}else{if(Ap.charAt(1)==="="&&Ap.length>2&&Ap.charAt(2)>="0"&&Ap.charAt(2)<="9"){AM=2;A9=2;}}break;case"=":if(Ap.charAt(1)>="0"&&Ap.charAt(1)<="9"){AM=3;A9=1;}else{if(Ap.charAt(1)==="="&&Ap.length>2&&Ap.charAt(2)>="0"&&Ap.charAt(2)<="9"){AM=3;A9=2;}}break;case"<":if(Ap.charAt(1)>="0"&&Ap.charAt(1)<="9"){AM=5;A9=1;}else{if(Ap.charAt(1)==="="&&Ap.length>2&&Ap.charAt(2)>="0"&&Ap.charAt(2)<="9"){AM=4;A9=2;}}break;}if(AM>0){var Aa=Ap.substr(A9);var BI=parseFloat(Aa);if((AM===1&&AP>BI)||(AM===2&&AP>=BI)||(AM===3&&AP===BI)||(AM===4&&AP<=BI)||(AM===5&&AP<BI)){BF=true;}return mstrmojo.num.formatByMask(AY,AP);}}}else{if(AY.charAt(AW)===";"){if(BF){Af=AW;break;}else{Aq=AW+1;AW++;}}else{AW++;}}}}if(!BF){Aq=0;}AW=Aq;var Av=false;while(AW<Af){if(AY.charAt(AW)==='"'){AW++;while(AW<Af&&AY.charAt(AW)!=='"'){AW++;}}else{if(AY.charAt(AW)==="["){AW++;while(AW<Af&&AY.charAt(AW)!=="]"){AW++;}}else{if(AY.charAt(AW)==="y"||AY.charAt(AW)==="M"||AY.charAt(AW)==="d"||AY.charAt(AW)==="h"||AY.charAt(AW)==="H"||AY.charAt(AW)==="m"||AY.charAt(AW)==="s"||AY.charAt(AW)==="S"){Av=true;break;}else{AW++;}}}}if(Av){var BD="";if(BF){BD=AY.substr(Aq,Af-Aq);}else{BD=AY;}return mstrmojo.num.formatByMask(BD,AP);}var BH;var An;var As=false;var AS=false;var BC=false;var Ae=false;var BN=[];var Ai="";var Ab=0;var A8=false;var AZ=0;var BO="";var AT="";var Am="";var A6="";var AX=0;var BK=0;var BJ=false;var BA=A7.mstrCurrencySymbol;var A1=A7.mstrThousandSeparator;var Ax=A7.mstrDecimalPoint;var BB=A7.mstrPercentSign;var A5=A7.mstrMinusSign;AW=Aq;var Al="";if(AP<0&&!BF){while(AW<Af&&AY.charAt(AW)!==";"){if(AY.charAt(AW)==='"'){AW++;while(AW<Af&&AY.charAt(AW)!=='"'){AW++;}}AW++;}AW++;if(AW>=Af){if(AP<0){BO+="-";}AW=Aq;}}var BP=false;while(AW<Af){var Ar=false;switch(AY.charAt(AW)){case"[":AW++;while(AW<Af&&AY.charAt(AW)!=="]"){Am+=AY.charAt(AW);AW++;}if(Am.length>0&&(Am.charAt(0)===">"||Am.charAt(0)==="<"||Am.charAt(0)==="=")){Am="";}AW++;break;case'"':AW++;while(AW<Af&&AY.charAt(AW)!=='"'){if(BP){AT+=AY.charAt(AW);}else{BO+=AY.charAt(AW);}AW++;}AW++;break;case"#":case"0":var Ad=AY.charAt(AW);BP=true;var Ah=1;AW++;while(AW<Af&&AY.charAt(AW)===Ad){Ah++;AW++;}if(AW+1<Af&&AY.charAt(AW)==="-"&&AY.charAt(AW+1)===Ad){Ae=true;BN.push(Ah);AW++;while(true){Ah=0;while(AW<Af&&AY.charAt(AW)===Ad){Ah++;AW++;}BN.push(Ah);if(AW>=Af||AY.charAt(AW)!=="-"){break;}AW++;}}while(AW<Af){if(AY.charAt(AW)===","){if(AW+1<Af&&AY.charAt(AW+1)===Ad){As=true;}else{break;}}else{if(AY.charAt(AW)!==Ad){break;}}AW++;}break;case".":BP=true;AW++;Ab=0;while(AW<Af&&AY.charAt(AW)==="0"){Ab++;AW++;}if(Ab===0){while(AW<Af&&AY.charAt(AW)==="#"){Ab++;AW++;}}break;case"E":BK=6;while(AW<Af&&AY.charAt(AW)!=="0"){if(AY.charAt(AW)==="+"&&AW<Af&&AY.charAt(AW+1)==="0"){AS=true;}else{A6+=AY.charAt(AW);}AW++;}AX=0;while(AW<Af&&AY.charAt(AW)==="0"){AX++;AW++;}break;case"%":BK=4;AW++;break;case"(":AW++;BO+="(";break;case")":AW++;AT+=")";break;case"-":AW++;if(AP<0){BO+=A5;}break;case"?":AW++;break;case"/":if(AW>Aq&&AY.charAt(AW-1)==="?"&&AW+1<Af&&AY.charAt(AW+1)==="?"){BK=5;A8=false;An=AW-1;while(An>Aq&&AY.charAt(An)==="?"){An--;}while(An>Aq&&AY.charAt(An)===" "){An--;}if(An>=Aq&&(AY.charAt(An)==="#"||AY.charAt(An)==="0")){A8=true;}AZ=0;AW++;while(AW<Af&&AY.charAt(AW)==="?"){AZ++;AW++;}}else{AW++;}break;case",":if(AW>Aq&&(AY.charAt(AW-1)==="0"||AY.charAt(AW-1)==="#")){BC=true;AW++;}An=AW+1;while(An<Af){if(AY.charAt(An)===","){An++;continue;}else{break;}}if(An===Af||AY.charAt(An)==="."){BJ=true;}if(BJ||(!BJ&&AW+1<Af&&AY.charAt(AW+1)===",")){while(AW<Af&&AY.charAt(AW)===","){AP/=1000;AW++;}AW--;}AW++;break;case";":Ar=true;break;case"$":if(BP){AT+=BA;}else{BO+=BA;}AW++;break;case"_":if(BP){AT+=" ";}else{BO+=" ";}AW++;AW++;break;default:if(BP){AT+=AY.charAt(AW);}else{BO+=AY.charAt(AW);}AW++;}if(Ar){break;}}if(AP<0){AP=-AP;if(BO.length===0){BO=A5;}}var Az="";if(Ae){var Au=0;for(BH=0;BH<BN.length;BH++){Au+=BN[BH];}Az=Al=this.fillZeroToWidth(Au,AP.toFixed());for(BH=0;BH<BN.length-1;BH++){Au-=BN[BH];var At=Az.length-Au;Az=Az.slice(0,At)+"-"+Az.slice(At);}}else{switch(BK){case 0:if(BC){AP/=1000;}var A3=AP;if(A3<0){A3=-A3;}var AL=0;while(A3>=10){A3/=10;AL++;}if(AL>=15){Az=Al=this.fillZeroRightToWidth((A3<0?-A3:A3),15);Az=Az.substr(0,16);if(Az.charAt(15)>="5"){var AV=14;while(AV>=0&&Az.charAt(AV)==="9"){Az=Az.slice(0,AV)+"0"+Az.slice(AV+1);AV--;}var AQ=Az.charAt(AV);AQ++;if(AV>=0){Az=Az.slice(0,AV)+AQ+Az.slice(AV+1);}else{Az="1"+Az;}}Az=Az.substr(0,15);var BG;for(BG=AL-14;BG>0;BG--){Az+="0";}if(AP<0){Az=A5+Az;}}else{Al+=(AP+Math.pow(0.1,Ab+6)).toFixed(Ab);Az=Al;Az=this.ReplaceDecimalPoint(Az,Ax);if(AP<0){Az=this.ReplaceMinusSign(Az,A5);}}if(As){Az=this.InsertThousandSeparator(Az,A1,A7);}if(BC){Az+=Ai;}break;case 5:if(BC){AP/=1000;}var Ak=10;for(BH=1;BH<AZ;BH++){Ak*=10;}var AN={numerator:0,denominator:1};var AU={numerator:1,denominator:1};var AR={numerator:1,denominator:2};var Ay={numerator:0,denominator:1};var Ag=AP>=0;var A4=Math.abs(AP);var A2=parseInt(A4,10);A4-=A2;while(AR.denominator<Ak){if(Math.abs(AH.call(AR)-A4)<1e-15){Ay=AR;break;}if(AH.call(AR)>A4){AU=AR;}else{AN=AR;}AR.denominator=AN.denominator+AU.denominator;AR.numerator=AN.numerator+AU.numerator;}if(AR.denominator>=Ak){if(A4-AH.call(AN)<AH.call(AU)-A4){Ay=AN;}else{Ay=AU;}}if(A2>0){Ay.numerator+=A2*Ay.denominator;}if(Ay.denominator===0){A8=false;}var BE=false;var A0=false;var BM=Ay.numerator;if(A8){A2=Math.floor(Ay.numerator/Ay.denominator);BM=Ay.numerator%Ay.denominator;A0=A0||(BM!==0);if(A2>0){BE=true;Al+=A2;if(A0){Al+=" ";}}}if(!A0&&!BE&&BM===0){Al+="0";}else{if(!A0&&BE&&BM===0){AK++;}else{Al+=BM;Al+="/";Al+=Ay.denominator;}}Az=Al;if(!Ag){Az=A5+Az;}if(As){Az=this.InsertThousandSeparator(Az,A1,A7);}if(BC){Az+=Ai;}break;case 4:AP*=100;Al+=(AP+Math.pow(0.1,Ab+6)).toFixed(Ab);Az=Al;Az=this.ReplaceDecimalPoint(Az,Ax);if(AP<0){Az=this.ReplaceMinusSign(Az,A5);}if(As){Az=this.InsertThousandSeparator(Az,A1,A7);}Az+=BB;break;case 6:var Aw=AP;var BL=0;if(Aw>1){while(Aw>=10){Aw/=10;BL++;}}else{if(Aw!==0){while(Aw<1){Aw*=10;BL--;}}}Al+=(Aw+Math.pow(0.1,Ab+6)).toFixed(Ab);Al+=A6;if(AS&&BL>=0){Al<<"+";}if(BL<0){Al<<"-";BL=-BL;}Al+=this.fillZeroToWidth(BL,AX);Az=Al;Az=this.ReplaceDecimalPoint(Az,Ax);if(AP<0){Az=this.ReplaceMinusSign(Az,A5);}break;}}var AO=BO+Az+AT;var Ac=false;if(Am.length!==0&&Ac){AO='<SPAN STYLE="COLOR: '+Am+'" >'+AO+"</SPAN>";}return AO;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.color","mstrmojo.string","mstrmojo.vi.enums.EnumFeatures","mstrmojo.VisUtility");var c=mstrmojo,s=c.dom,AS=c.css,N=c.array,k=c.color,V=c.string,J=mstrmojo.VisUtility,O=90,AP=-90,t=180,d=-180,f=true,z=c.vi.enums.EnumFeatures,AT="http://www.w3.org/2000/svg";var o;function AR(){var AX=navigator.userAgent.toLowerCase();return s.isIE||(AX&&AX.match(/rv:([\d.]+)\) like gecko/));}mstrmojo.gmaps.MapUtils=mstrmojo.provide("mstrmojo.gmaps.MapUtils",{_mixinName:"mstrmojo.gmaps.MapUtils",checkVal:function p(AX){return this.checkDefined(AX)&&!(isNaN(parseInt(AX)));},checkVals:function S(AY){var AX=true;N.forEach(AY,function(AZ){if(!this.checkVal(AZ)){AX=false;return false;}});return AX;},checkHasFunction:function e(AY,AX){return AY&&AY[AX]&&AY[AX] instanceof Function;},checkDefined:function X(AX){return(AX!==undefined)&&(AX!==null);},parseBoolean:function b(AX){return AX===true||AX==="true";},isAsp:function AQ(){return(window.location.pathname.indexOf("/asp/")>0);},trimString:function AG(AX){return mstrmojo.string.trim(AX);},log:function D(AX){if(console&&console.log){console.log(AX);}},replaceSpace:function AV(AZ,AY){if(!this.checkDefined(AZ)){return ;}var AX=(this.checkDefined(AY))?AY:"_";return AZ.replace(/ /g,AX);},getProtocol:function F(){return this.isSingleTier()?"http:":window.location.protocol;},createMouseEvt:function M(AY){var AX;if(AR()||s.isFF){AX=document.createEvent("MouseEvents");AX.initEvent(AY,true,false);}else{if(window.MouseEvent){AX=new MouseEvent(AY);}}return AX;},isRMClick:function u(AX){var AY=false;if(AX){if(AX.which){AY=AX.which===3;}else{if(AX.button){AY=AX.button===2;}}}return AY;},createNormalNode:function P(AX){if(!!AX){return document.createElement(AX);}},createSvgNode:function AL(AX){if(!!AX){return document.createElementNS(AT,AX);}},appendNode:function E(AX,AY){if(this.checkHasFunction(AX,"appendChild")&&AY){AX.appendChild(AY);}},appendSvgNode:function AB(AX){if(!AX){return ;}var AY=this.createSvgNode("svg");this.setCssStyles(AY,{position:"absolute",width:AX.style.width,height:AX.style.height,top:"0px",left:"0px"});AX.appendChild(AY);return AY;},appendGNode:function m(AY){if(!this.checkHasFunction(AY,"appendChild")){return ;}var AX=this.createSvgNode("g");AY.appendChild(AX);return AX;},setNodeAttributes:function W(AY,AX){if(!this.checkHasFunction(AY,"setAttribute")||!AX){return ;}for(var AZ in AX){if(this.checkDefined(AX[AZ])){AY.setAttribute(AZ,AX[AZ]);}}},setCssStyles:function K(AZ,AY){var AX=AZ&&AZ.style,Aa;if(!AX||!AY){return ;}for(Aa in AY){if(this.checkDefined(AY[Aa])){AX[Aa]=AY[Aa];}}},setCssTransform:function AW(AX,AY){if(!AY||!this.checkVal(AY.x)||!this.checkVal(AY.y)){return ;}N.forEach(N.ensureArray(AX),function(AZ){this.setNodeAttributes(AZ,{transform:"translate("+AY.x+" "+AY.y+")"});},this);},emptyDomElement:function AD(AX){if(!this.checkHasFunction(AX,"removeChild")){return ;}while(AX.firstChild){AX.removeChild(AX.firstChild);}},insertAfter:function U(AZ,AY){var AX=AY&&AY.parentNode;if(AZ&&this.checkHasFunction(AX,"insertBefore")){if(AY.nextSibling){AX.insertBefore(AZ,AY.nextSibling);}else{AX.appendChild(AZ);}}},insertAsFirstChild:function AN(AX,AY){if(AX&&AY){if(AX.firstChild){AX.insertBefore(AY,AX.firstChild);}else{AX.appendChild(AY);}}},getEvtCoordInsideNode:function a(AY,AX){var AZ=this.getBoundingRect(AX);if(!AY||!this.checkVal(AY.clientX)||!this.checkVal(AY.clientY)||!AZ||!this.checkVal(AZ.left)||!this.checkVal(AZ.top)){this.log("getEvtCoordInsideNode(): Invalid clientRect.");return ;}return{x:AY.clientX-AZ.left,y:AY.clientY-AZ.top};},getBoundingRect:function AF(AX){if(this.checkHasFunction(AX,"getBoundingClientRect")){return AX.getBoundingClientRect();}},showWait:function w(){if(this.checkHasFunction(mstrApp,"showWait")){mstrApp.showWait();}else{if(this.checkHasFunction(microstrategy,"showWait")){microstrategy.showWait(true);}}},hideWait:function AO(AX){if(this.checkHasFunction(mstrApp,"hideWait")){mstrApp.hideWait(AX);}else{if(this.checkHasFunction(microstrategy,"showWait")){microstrategy.showWait(false);}}},isValidLatLng:function AI(AY,AX){if(!this.checkVal(AY)||!this.checkVal(AX)){return false;}return parseInt(AY)>=AP&&parseInt(AY)<=O&&parseInt(AX)>=d&&parseInt(AX)<=t;},isExpress:function AA(){return !!(mstrApp&&mstrApp.isExpress);},isVI:function AH(){return mstrApp&&mstrApp.isVI;},isOIVM:function H(){return mstrApp&&(mstrApp.isExpress||mstrApp.isVI);},isSingleTier:function Y(){return !!(mstrApp&&mstrApp.isSingleTier);},isWorkstation:function AJ(){return mstrApp&&mstrApp.isWorkstation;},isWSLiveMode:function n(){return mstrApp&&mstrApp.supportFeature(z.SUPPORT_LIVEMODE)&&(typeof mstrApp.getWSLiveMode==="function")&&mstrApp.getWSLiveMode();},isWSLocalMode:function l(){return this.isSingleTier()&&!this.isWSLiveMode();},getEvent:function y(AX){if(!s.supportsTouches){return AX;}else{return s.firstChangedTouch(window,AX);}},enableZoomLevelAndPosSaving:function Q(){return !this.isWorkstation()||f;},isCanvasSupported:function AK(){var AX=document.createElement("canvas");return !!(AX.getContext&&AX.getContext("2d"));},convertImageUrl:function h(AX){if(mstrApp.isDossier&&AX&&AX.indexOf("../")===0){return c.getStyleRoot()+"/../"+AX.substr(3);}return AX;},encode:function g(AZ,AY){var Ab=AZ;if(!this.checkDefined(AY)){AY=false;}if(AZ&&AZ.length>0){Ab="";for(var Aa=0,AX=AZ.length;Aa<AX;Aa++){switch(AZ.charAt(Aa)){case"&":if((AZ.length!==(Aa+1))&&(AZ.charAt(Aa+1)==="#")){Ab+="&";}else{Ab+="&amp;";}break;case"<":Ab+="&lt;";break;case">":Ab+="&gt;";break;case"'":Ab+="&#039;";break;case"\n":if(!AY){Ab+="<br />";}else{Ab+=AZ.charAt(Aa);}break;case'"':Ab+="&quot;";break;case" ":if(Aa===0||(Aa<AZ.length-1&&AZ.charAt(Aa+1)===" ")){Ab+="&nbsp;";}else{Ab+=AZ.charAt(Aa);}break;default:Ab+=AZ.charAt(Aa);break;}}}return Ab;},loadCss:function AU(AX,Ac){var Ab=document.styleSheets;if(Ab){var AZ,Aa;for(AZ=0;AZ<Ab.length;AZ++){Aa=Ab[AZ];if(Aa.id===AX){return ;}}}var AY=document.createElement("link");AY.setAttribute("rel","stylesheet");AY.setAttribute("type","text/css");AY.setAttribute("href",Ac);AY.setAttribute("id",AX);document.getElementsByTagName("head")[0].appendChild(AY);},getGraphicLayerById:function B(AX){var AY=mstrmojo.all[AX];if(!AY){this.hideWait();}return AY;},isEmbedded:function C(){return mstrApp&&mstrApp.isEmbedded;},_verifyProtocol:function i(AX){if("https:"===window.location.protocol&&(-1!==AX.search(/^http\:\/\/server\.arcgisonline\.com/i)||-1!==AX.search(/^http\:\/\/services\.arcgisonline\.com/i)||-1!==AX.search(/^http\:\/\/.+\.arcgis\.com/i))){AX=AX.replace(/http:/i,"https:");}return AX;},loadExternalScript:function L(AY,Ab,AZ){if(!AY){return ;}var AX=document.createElement("script");AX.type="text/javascript";AX.src=AY;if(AZ){AX.onerror=AZ;}if(AX.addEventListener){AX.addEventListener("load",function Aa(){AX.removeEventListener("load",Aa);AX.onerror=null;if(Ab){Ab();}},false);}else{if(AX.readyState){AX.onreadystatechange=function(){if(AX.readyState==="loaded"||AX.readyState==="complete"){AX.onreadystatechange=null;AX.onerror=null;if(Ab){Ab();}}};}}document.getElementsByTagName("head")[0].appendChild(AX);},getNoInternetMessage:function x(){var AY,AX;if(mstrApp.isSingleTier){AY="Unable to create the map. Please check your connection. You can configure an Internet proxy through your computer's #";AX='<a href="" style="color:#7CC5EC" onclick="window.FormWrapper.showProxyEditor(); return false;">'+mstrmojo.desc(7831,"Settings")+"</a>.";AY=AY.replace("#",AX);}else{AY="Unable to download the requested map. Please contact your administrator to resolve this issue.";}return AY;},getThemeClass:function A(){if(mstrApp&&mstrApp.getThemeClassName){return" "+mstrApp.getThemeClassName();}},adjustHSV:function AC(Ah,AZ,Ab,Ag){if(!Ah||!this.checkVal(AZ)||!this.checkVal(Ab)||!this.checkVal(Ag)){return Ah;}var Ae,Ai,AY,AX,Ac,Ad,Aa,Af;if(!Ah){return Ah;}if(Ah.length===7){Ae=parseInt(Ah.substring(1,3),16);Ai=parseInt(Ah.substring(3,5),16);AY=parseInt(Ah.substring(5,7),16);}else{if(Ah.length===4){Ae=parseInt(Ah.substring(1,2)+Ah.substring(1,2),16);Ai=parseInt(Ah.substring(2,3)+Ah.substring(2,3),16);AY=parseInt(Ah.substring(3,4)+Ah.substring(3,4),16);}else{return Ah;}}AX=k.rgb2hsv(Ae,Ai,AY);AX[0]=AX[0]*AZ;AX[1]=AX[1]*Ab;AX[2]=parseInt(AX[2]*Ag>100?100:AX[2]*Ag,10);Ac=k.hsv2rgb(AX[0],AX[1],AX[2]);Ae=parseInt(Ac[0],10);Ai=parseInt(Ac[1],10);AY=parseInt(Ac[2],10);Ad=Ae<16?"0"+Ae.toString(16):Ae.toString(16);Aa=Ai<16?"0"+Ai.toString(16):Ai.toString(16);Af=AY<16?"0"+AY.toString(16):AY.toString(16);Ah="#"+Ad+Aa+Af;return Ah;},fillColorAjustForCMSelection:function R(AX){return this.adjustHSV(AX,1,0.5,1.2);},fillColorAjustForHover:function AE(AX){return this.adjustHSV(AX,1,0.6,1.15);},setLayerNodeProps:function I(Aa,Ab,AZ,AY,AX){this.setNodeAttributes(Aa,{id:Ab,"class":AZ});this.setCssStyles(Aa,{position:"absolute",top:"0px",left:"0px"});if(this.checkVal(AY)&&this.checkVal(AX)){AY=parseInt(AY);AX=parseInt(AX);this.setCssStyles(Aa,{width:AY+"px",height:AX+"px"});}},destroyNode:function AM(AX){if(!AX){return ;}try{if(AX.parentNode){AX.parentNode.removeChild(AX);}}catch(AY){}},destroyObj:function Z(AX){if(AX&&AX.destroy instanceof Function){AX.destroy();}},removeHTMLTagsAndProps:function G(AY,Aa,AX){try{(AY.match(/<[^>]+>/g)||[]).forEach(function(Af){var Ai,Ad,Ac,Ae,Aj,Ab,Ag,Ak,Ah=Af.toLowerCase();Ad=Ah.match(/<\/?([a-z]+\b)/);if(Ad&&Ad.length===2){Ac=Ad[1];if(Aa.indexOf(Ac)<0){AY=AY.replace(Af,"");return ;}if(Ah.charAt(1)==="/"){Ah=Ah.substring(2);Ag="</";}else{Ah=Ah.substring(1);Ag="<";}Ai=Ah.length-2;if(Ah.charAt(Ai)==="/"){Ah=Ah.substring(0,Ai);Ak="/>";}else{Ah=Ah.substring(0,Ah.length-1);Ak=">";}Ah=Ah.replace(Ac,"");Ab="";Aj="";while(Ah!=Ab){Ab=Ah;Ah=V.trim(Ah);Ad=Ah.match(/([^=]+)=\s*('[^']*'|"[^"]*")/);if(Ad&&Ad.length===3){Ae=V.trim(Ad[1]).split(/\s+/);if(Ae&&Ae.length>0){Ae=Ae[Ae.length-1];if(AX.indexOf(Ae)>=0){Aj+=" "+Ae+"="+Ad[2];}}Ah=Ah.substring(Ad[0].length);}}AY=AY.replace(Af,Ag+Ac+Aj+Ak);}});}catch(AZ){console.log("HTML Parse Error: "+AZ);}finally{return AY;}},addArrowNode:function q(AY){if(AY){var AX=this.createNormalNode("div");AS.addClass(AX,"mstrmojo-Tooltip-arrow");this.appendNode(AY,AX);}},getFontFamilyItems:function j(AX){if(o){return o;}else{o=N.filter(J.getFontFamilyItems(),function(AY){return N.indexOf(AX,AY.n)===-1;});return o;}},unserializeTooltipForms:function(AY){if(!AY){return{};}try{return JSON.parse(AY);}catch(AX){return{};}},serializeTooltipForms:function(AX){return JSON.stringify(AX);},});}());(function(){mstrmojo.requiresCls("mstrmojo.gm.GMEnums","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.VisEnum","mstrmojo.VisUtility");var N=mstrmojo.gm.EnumTRFManipulations;var J=mstrmojo.array,C=mstrmojo.hash,M=mstrmojo.func.wrapMethods,G=mstrmojo.func.composite,I=mstrmojo.VisEnum.GMLegendFormatingPropertyTag;var D={silent:false,undo:mstrmojo.emptyFn,redo:mstrmojo.emptyFn};function K(O){return O.model.controller.cmdMgr;}function L(){return(this.getDocModel&&this.getDocModel())||this.model.docModel;}function H(){return{success:function O(){this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}function E(P,R){var O,V,Q,S,U={};U.tks=this.k;U.selectorObjects=P;U.keepOnly=!!R;U.isDocVis=true;O=L.call(this);V=O.getDataService();Q=V.getGMViewFilterAction(U);S=O.getSliceCallback(U);return{action:Q,callbacks:S};}function B(Q,P){var O,S,R;O=L.call(this);R=O.getDataService();if(!this.isXMLDirty()){R.submitUpdates(Q,P);}else{S=this.getPersistAction();R.submitUpdates([Q,S],P);this.resetXMLDirtyFlag();}}function A(){var c=this.modelData||this.model.data,S=c.k,a,Z="FormattingWidget",V,U,Y,P,Q,R=[],X=[],W=this.edtModel;if(!c){console.log("warning: modelData is missing");return null;}var b=function(e,g){var d=U.createElement(g),f;if(e instanceof Object){for(f in e){if(e.hasOwnProperty(f)){var h=b(e[f],f);if(h){d.appendChild(h);}}}}else{d.setAttribute("value",e);}return d;};var O=function(d){return d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;");};Y=this.createWidgetPropsXML?this.createWidgetPropsXML():null;if(!Y||Y.length===0){V=this.getProperties(S);if(this.useCompatibleXML){U=(new DOMParser()).parseFromString("<widgetProps></widgetProps>","text/xml");U.firstChild.appendChild(b(V,"fmt"));}else{U=(new DOMParser()).parseFromString("<props><widgetProps></widgetProps></props>","text/xml");U.firstChild.firstChild.appendChild(b(V,"fmt"));}Y=(new XMLSerializer()).serializeToString(U);}P=O(Y);Q={act:"setProperty",nodeKey:S,prs:Z,pri:4,v:P};R.push(Q);return R;}function F(P,Q,O,U){if(!(U instanceof Function)){return D;}var S=this.id;function R(V){return function(){var X=mstrmojo.all[S],W;if(!X){return ;}W=X.getProperties();W[P]=V;U.call(X,V,true);X.getDocModel().selectVIUnit(X.parent.id,true);};}return{silent:true,undo:R(O),redo:R(Q)};}mstrmojo._VizSelectionHelper=mstrmojo.provide("mstrmojo._VizSelectionHelper",{postBuilderingCalled:false,listenToUpdateColorMap:function(R){if(mstrmojo.VisUtility.isOnExpressMode()){return ;}var Q=this,P,O=(Q.getDocModel&&Q.getDocModel())||Q.model.docModel;if(O){return O.attachEventListener("colorMapChanged",Q.id,function(U){P=Q.parent&&Q.parent.parent;if(Q.forceUpdateColorMap||(P&&P.isPanelDisplaying())){R.call(Q);}else{var S=P.attachEventListener("panelDisplaying",Q.id,function(V){if(Q.postBuilderingCalled){R.call(Q);}P.detachEventListener(S);});}});}},detachUpdateColorMapListener:function(P){if(!P){return ;}var O=(this.getDocModel&&this.getDocModel())||this.model.docModel;O.detachEventListener(P);},updateTargets:function(P){var S={},Q=this,O=L.call(this);S.fromGM=true;S.type=1;S.src=this.k;S.selectorObjects=P;function R(W){var U=Q.modelData||Q.model.data,V=U.sc;if(V!==undefined){return V[W];}return undefined;}S.keepOnly=true;S.ck=R.call(this,"ck");S.keyContext=S.ck;S.tks=R.call(this,"tks");S.ckey=R.call(this,"ckey");S.isDocVis=true;S.include=true;S.showall=R.call(this,"showall");O.slice(S);},updateAfterViewFilter:function(Q,O){var W,V,P,U,S,X,R;W=L.call(this);V=W.getDataService();U=E.call(this,Q,O);P=U.action;S=U.callbacks;R=this.model.controller||W.controller;if(this.currKeepOnlyAction){X=[C.clone(this.currKeepOnlyAction)];}else{X=E.call(this,[],false).action;}this.currKeepOnlyAction=P;R.submitUndoRedoUpdates([P],X,S);},updateAfterKeepOnly:function(Q){var P=L.call(this),O=this.model.controller||P.controller,R=M(O._getXtabCallback(this),H.call(this));O.applyKeepOnly(this,R,{keepOnly:Q,data:this.getContextMenuSelections()},Q?-2:undefined);},updateAfterKeepOnlyForMultiTemplate:function(Q){var P=L.call(this),O=this.model.controller||P.controller,R=M(O._getXtabCallback(this),H.call(this));O.applyKeepOnlyForMutilTemplate(Q,R,true);},updateAfterDrill:function(O,d,Z){var a=this,e=L.call(this),c=e.getDataService(),U=c.newUpdate(),R=this.getContextMenuSelections(),P=Z||this,S=P.model,V=P.model.data||P.node.data,Y=S.getSelectorDataFromTemplateLimit(V.tpl).concat({keepOnly:true,data:R}),Q=e.getKeepOnlyOrExcludeAction(V.k,Y),W=a.model.controller||e.controller,X=W._getXtabCallback(a);U.add(O,M(d,X));U.add(Q,H.call(a));K(a).execute({execute:function b(){this.submitUpdate(U);},urInfo:{callback:U.callback}});},updateAfterSort:function(R){var P=this,O=L.call(this),S=O.getDataService(),U=O.getSliceCallback({tks:P.k});K(P).execute({execute:function Q(){var W=S.newUpdate(this,undefined),V={act:"sortGM",nodeKey:P.k,subActions:R,partialUpdate:{nodes:[P.k]}};W.add(V,U,undefined);if(P.isXMLDirty()){W.addActions(P.getPersistAction());}this.submitUpdate(W,undefined);},urInfo:{callback:U}});},updateAfterAction:function(U,O,P,b,Y){if(!U){return ;}var W=this,Q=W.parent&&W.parent.id,c=W.model.docModel,V=W.model.controller||c.controller,a,Z,S={},X,R=Y||D;if(P){a=mstrmojo.emptyFn;X=function(){this.submitSilent(U);};}else{a=c.getSliceCallback({tks:this.k});a.success=G([a.success,function(){c.selectVIUnit(Q,true);}]);X=function(){this.submit(U,a,S);};}Z=V._getXtabCallback(W);if(O){a=M(a,O);Z=M(Z,O);}Z.success=G([Z.success,function(){c.selectVIUnit(Q,true);}]);if(P){C.copy(mstrmojo.DocDataService.SUPPRESS_DATA,S);}if(b){C.copy(mstrmojo.DocDataService.REQUEST_DEFN_DATA,S);}K(this).execute({execute:X,urInfo:{silent:R.silent,callback:Z,redo:R.redo,undo:R.undo}});},getProperties:mstrmojo.emptyFn,getSetPropertiesAction:A,updateAfterPropertiesChange:function(P,Q,O,R){this.updateAfterAction(A.call(this),P,Q,O,R);},setProperty:function(W,R,U){var P=U.callback,Q=!!U.suppressData,Y=U.requestDefinition,S=U.clientUndoRedoCallback,X=this.getProperties(),O=X[W],V;if(W===I.COLOR_SQUARE_COLOR){if(this.colorSqureIdentity){this.updateColorMap(this.colorSqureIdentity.comb,R);}}else{if(X&&(X[W]===undefined||X[W].toString()!==R.toString())){X[W]=R;V=F.call(this,W,R,O,S);this.updateAfterPropertiesChange(P,Q,Y,V);}}},showData:function(O){if(!this.gridData){this.gridData=this.model.data;}mstrmojo.vi.ui.ViewDataDialog.open(this.parent,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._HasSuggestion","mstrmojo.css","mstrmojo.VisUtility","mstrmojo.hash","mstrmojo.dom");var K=mstrmojo.dom,E=mstrmojo.css,R="srchBoxState",C=mstrmojo.Enum_Keys,S=mstrmojo.VisUtility,M=200,g,H=24,Q={fontFamily:"Arial",fontSize:"11px"};var e={2147762262:mstrmojo.desc(16256,"Please enter a numeric value"),2147762227:mstrmojo.desc(16257,"Unable to perform search with the operators provided")};var P={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};var k="mstrmojo-SimpleObjectInputBox-del";function F(){var p=this.inputBox,q=p&&p.value;if(q!==""&&(q!==this._lastPattern||!this.suggestionShown)){this.showSuggestion(q);this._isSearching=true;if(this.hitEnterToTest){this.inputBox.blur();}}this._lastPattern=q;delete this._timerHandle;}function D(){var p=this._timerHandle;if(p){window.clearTimeout(p);delete this._timerHandle;}}function A(){if(this.richTooltip){if(this.tooltip){this.tooltip.set("allowOtherTooltips",false);}this.hideTooltip();}}function b(p){var s=this._inputPos,q=!mstrApp.isAppStatePresentation||mstrApp.isAppStatePresentation(),t=this,u;if(this.richTooltip){u=this.richTooltip;if(!this.hasOpenTooltip&&!this.suggestionShown){u.top=(s.h+s.y)+"px";u.left=s.x+"px";if(!this.hitEnterToTest&&!q){window.setTimeout(function(){var y=t.tooltip,x=y&&y.contentNode,z,w;z=x?x.childNodes:null;if(z&&z.length>1){w=z[1];z=w.childNodes;if(z&&z.length>1){w=z[1];}else{w=null;}}if(t.hasOpenTooltip&&w&&!E.hasClass(x,"lng")){if(u.onclick){t.tooltip.onclick=u.onclick;K.attachMarkupEvent(t.tooltip.id,w,"click");}E.addClass(x,"lng");}},3000);}this.showTooltip(p.e,p.hWin);this.set("allowOtherTooltips",!this.hitEnterToTest);}}}function G(){if(window.mstrLocalStorage===undefined){return{};}var p=(mstrLocalStorage.getLocalStorage()||{})[R];return(p&&JSON.parse(p))||{};}function Y(p){if(window.mstrLocalStorage!==undefined){mstrLocalStorage.setItem(R,JSON.stringify(p));}}mstrmojo.SimpleObjectInputBox=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasSuggestion,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.SimpleObjectInputBox",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-SimpleObjectInputBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-SimpleObjectInputBox-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}<input type="text" mstrAttach:keydown,keyup,blur,focus style="display: none;" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" /><div class="mstrmojo-SimpleObjectInputBox-empty"><div>{@en@emptyText}</div></div></div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},emptyTextNode:function(){return this.domNode.firstChild.lastChild;},inputBox:function(){var p=this.domNode.firstChild.children;return p[p.length-2];},scrollboxNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onmaxItemWidthChange:function d(){var p=this.maxItemWidth;if(!isNaN(p)&&p>0){this.emptyTextNode.style.maxWidth=p+"px";}}},itemField:"n",emptyText:"",state:0,maxItemWidth:"none",useKeyDelay:false,hitEnterToTest:false,maxObjectCount:null,useRichTooltip:true,init:function l(p){this._super(p);if(mstrApp.isWorkstation){Q.fontFamily="Helvetica";}},showTooltip:function o(q,u){var t=q.target||K.eventTarget(q.hWin,q.e),s=this.getItemFromTarget(t);if(s&&s.n){var w=this.getItemNodeFromTarget(t).firstChild,p=K.position(w);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPCENTER,cssClass:"vi-regular vi-tooltip-A A-center",refNode:w,content:mstrmojo.string.encodeHtmlString(s.n),top:p.h+11,left:p.w/2};this._super(q,u);}},getItemMarkup:function(p){if(!g){var q=this.itemField;g=this._super(p).replace(">{@en@n}<",'><div class="elem">{@en@'+q+'}<div class="'+k+'"></div></div><');}return g;},getItemProps:function c(u,p){var s=this._super(u,p),w=this.itemField;var t=this.maxItemWidth;if(!isNaN(t)&&t>0){t=(t-H);}if(!mstrmojo.string.isEmpty(u[w])){var q=u[w];s[w]=q;if(t<S.measureTextWidth(q,Q)){s.title=q;}}s.addStyle("max-width:"+t+"px");return s;},getSuggestionPos:function U(){var p=this._inputPos;return{target:this.inputBox,left:p.x+"px",top:p.y+p.h+"px",zIndex:100};},updateSuggestion:function Z(p){var q=G();if(!q.srch){if(this._super){this._super(p);}}this.inputBox.focus();A.call(this);},failMessage:function B(q){var s=e[q.errCode]||q.msg,p=s?[{n:s,t:-101,cls:"nomatch"}]:[];this.updateSuggestion(p);},getSearchPattern:function N(){return this.inputBox?this.inputBox.value:"";},showInfoTooltip:function X(t){var u=G(),p=this.parent.parent,w=K.position(p.domNode),q=this.richTooltip,s=this;if(!u.hasShownInfo&&!mstrmojo.SimpleObjectInputBox.HAS_SHOWN_INFO){mstrmojo.SimpleObjectInputBox.HAS_SHOWN_INFO=true;u.hasShownInfo=true;this.set("richTooltip",{posType:mstrmojo.tooltip.POS_BOTTOMCENTER,cssClass:"vi-regular vi-tooltip-V vi-tooltip-leftcenter",contentNodeCssClass:"srch info",top:w.y+"px",left:w.x+w.w+8+"px",content:mstrmojo.desc(15909,'You can re-enable "Instant Search" from the menu.'),onClose:function(){s.set("richTooltip",q);}});this.showTooltip(window.event,window);if(this.tooltip){this.tooltip.set("allowOtherTooltips",false);}else{this.set("allowOtherTooltips",false);}}u.srch=t;Y(u);},onIncrementalFetch:function J(){this.inputBox.blur();},onSuggestionItemSelect:function i(p){D.call(this);this.set("items",this.items.concat(p));this._super();var q=this.id;window.setTimeout(function(){var s=mstrmojo.all[q];if(parseInt(s.state,10)!==P.FULL){s.set("state",P.ADDING);}},0);},onstateChange:function W(q){var s=q.value;if(this.parent.defn.multi){this.emptyTextNode.style.display=(s===P.ADDING)?"none":"block";}else{this.emptyTextNode.style.display=(s===P.EMPTY)?"block":"none";}var p=this.inputBox,t=p.style;if(s===P.ADDING){t.display="";this.updateScrollbars();p.focus();this._inputPos=K.position(p,true);}else{D.call(this);t.display="none";p.value="";this._lastPattern="";this.updateScrollbars();if(this.parent.getFormats&&!this.parent.getFormats().height&&this.parent.parent.performCanGrowCanShrink){this.parent.parent.performCanGrowCanShrink(this.parent.parent.children);}}},postBuildRendering:function O(){var p,q=G();M=(mstrApp.getSearchAutoCompleteDelay&&mstrApp.getSearchAutoCompleteDelay())||M;this.state=0;this.setDefaultState();if(q.srch){this.inputBox.value=q.srch;this.set("state",P.ADDING);delete q.srch;Y(q);}p=this._super();return p;},preitemsChange:function L(){this.setDefaultState();},onclick:function f(q){var u=K.eventTarget(q.hWin,q.e);if(u&&u.className===k){var t=K.findAncestorByAttr(u,"idx",true,this.domNode),p=t&&parseInt(t.value,10);this.hideTooltip();if(p!==null&&!isNaN(p)){var s=this.items.concat();s.splice(p,1);this.set("items",s);}return ;}if(parseInt(this.state,10)!==P.FULL){this.set("state",P.ADDING);}},onblur:function V(){if(this._isSearching||this.tooltip){return ;}D.call(this);A.call(this);if(!this.suggestionShown){this.setDefaultState();}},onfocus:function j(){this._isSearching=false;if(this.suggestionShown){A.call(this);}},prekeydown:function I(q){var u=q.e;switch(parseInt(u.keyCode||u.charCode,10)){case C.DOWN_ARROW:this.nextHighlight();break;case C.UP_ARROW:this.preHighlight();break;case C.TAB:case C.ENTER:K.preventDefault(q.hWin,u);if(this.suggestionShown){var t=this.getSelected();if(t){this.handleSuggestionItemSelect(t);}else{this.hideSuggestion();}}else{if(this.hitEnterToTest){A.call(this);F.call(this);}}break;case C.ESCAPE:D.call(this);if(this.suggestionShown){this.hideSuggestion();}else{this.setDefaultState();}break;case C.BACKSPACE:if(!this.getSearchPattern()&&!mstrApp.hasRequests()){K.preventDefault(q.hWin,u);var s=this.items&&this.items.concat();if(s&&s.length){s.splice(s.length-1,1);mstrApp.ignoreBackSpace=true;this.set("items",s);var x=this.id;window.setTimeout(function(){mstrmojo.all[x].set("state",P.ADDING);mstrApp.ignoreBackSpace=false;},0);}}break;}var p=this.richTooltip,w=(p&&p.contentNodeCssClass)||"";if(w.indexOf("srch info")>-1){A.call(this);}},prekeyup:function n(p){var t=p.e,q=parseInt(t.keyCode||t.charCode,10),s=this.getSearchPattern();if(!s||s!==this._lastPattern){K.preventDefault(p.hWin,p.e);this.hideSuggestion();}if(this.inputBox.value.length&&q!==C.ENTER&&q!==C.TAB&&!this.suggestionShown){b.call(this,p);}else{A.call(this);}if(this.hitEnterToTest){return ;}if(this.useKeyDelay){var u=this.id;if(!this._timerHandle){this._timerHandle=window.setTimeout(function(){F.call(mstrmojo.all[u]);},M);}}else{F.call(this);}},widgetResized:function m(){if(this.hasRendered){var t=parseInt(this.width,10),w=this.items.length,x=this.itemsContainerNode.childNodes;if(w<=(x&&x.length)){var u=t-H;for(var s=0;s<w;s++){var p=x[s],q=p.textContent;p.style.maxWidth=u+"px";if(q&&u<S.measureTextWidth(q,Q)){p.title=q;}else{p.title="";}}}if(this.emptyTextNode){this.emptyTextNode.style.maxWidth=t+"px";}this.updateScrollbars();}},setupScrollNodes:function h(){this.scrollNode=this.scrollboxNode;},setDefaultState:function a(){var s=this.maxObjectCount,p=(this.items&&this.items.length)||0,q=(s!==null&&s!==undefined&&p>=s);this.set("state",!p?P.EMPTY:(q?P.FULL:P.DEFAULT));}});mstrmojo.SimpleObjectInputBox.HAS_SHOWN_INFO=false;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.num","mstrmojo.VisUtility","mstrmojo.models.template.Titles","mstrmojo.models.template.MetricValue","mstrmojo.models.template.Headers","mstrmojo.models.datasets.DataInterface");var a=mstrmojo.array,K=mstrmojo.hash,m=mstrmojo.string,U=mstrmojo.num,M=mstrmojo.VisUtility,X=mstrmojo.models.datasets.DataInterface,L=m.decodeHtmlString;var Q=-1,l=1,V=2,E=3;var H=1,i=2,C=3;var I="0";var j="root";function J(t){var u={};K.forEach(t,function(y,x){var w=[];a.forEach(y,function(z){w.push({fillColor:z.fillclr,text:z.n});});u[x]=w;});return u;}function W(x){var AH=this.getTotalRows(),z=this.data,AC=[],AE=z.gts.col[0],w=AE?AE.es:[],AG=w.length,AA=0;x=K.copy(x,{minAttribute:1,minMetric:1});if(AH<x.minAttribute||AG<x.minMetric){throw"Error";}do{var u=this.getRowHeaders(AA),y,t={},AD=u.size();for(y=0;y<AD;y++){while(y<AD&&u.getHeader(y).getFormIndex()!==undefined){y++;}if(y<AD){var AB=u.getHeader(y);t[AB.t.n]=AB.getName();}}for(y=0;y<w.length;y++){var AF=this.getMetricValue(AA,y).value;t[w[y].n]={v:AF.v,rv:AF.rv};}AC.push(t);AA++;}while(AA<AH);return AC;}function B(u){var t=[],w=this.data.gts.row;a.forEach(w,function(y,x){a.forEach(u,function(z){if(y.id===z.id){t[x]=true;}});});return t;}function s(y,AJ,AD,AA,AC,AI,u,x,t,AH){var AF=AC.getName(),z=x?L(AF):AF,w=AI&&(x?L(AI.n):AI.n),AB=AC.getElementId(),AG=AC.getFormIndex()!==undefined;var AE={name:z};if(t){AE.tname=w;}if(AH){AE.headerObj=AC;AE.attributeSelector={n:AF,tid:u,eid:AB,isSelectAttr:true};if(!AG){if(!y.metricSelector){y.metricSelector={};}y.metricSelector[u]=[{n:AF,id:AB}];}}if(AJ&&AD[AA]===true){y.colorInfo.push(AB);}y.headers.push(AE);if(y.idValueMapping[u]){y.idValueMapping[u]+=(" "+AF);}else{y.idValueMapping[u]=AF;}}function p(u,AK,x,AF,t,AJ,AL,AG,AI){var AA;if(u.additional){AA=u.additional[u.additional.length-1];}for(var AE=0;AE<x.length;AE++){var z=x[AE].oid,AC=this.getColTitles().titles[0].es[AE].n,AB=t?L(AC):AC,AD=this.getMetricValue(AF,AE).value,AH={v:AD.v,rv:AD.rv,id:z};if(AL){var y=AJ[AE];var w=y&&y[AD.ti];if(w){AH.threshold=w;}}if(AG){AH.name=AB;}if(AA){AA.values.push(K.copy(AH));AA.idValueMapping[z]=AD.v;}if(!AI){u.values.push(AH);u.idValueMapping[z]=AD.v;}else{u.values[AE].rv+=Number(AH.rv);}}}function h(AU){var AD=this.getTotalRows(),AX=this.data,AA=[],AF=AX.gts.col[0],y=AF?AF.es:[],AJ=y.length,z,AP=0;AU=K.copy(AU,{minAttribute:1,minMetric:1,colorByInfo:[],hasTitleName:false,hasSelection:false,needDecode:false});if(AD<AU.minAttribute||AJ<AU.minMetric){throw"Error";}var t=AU.needDecode,AR=AU.hasTitleName,AQ=AU.hasSelection,AY=AU.hasThreshold,AI=AU.colorByInfo,AC=AU.additionalAttrIds||[];var AS=AI.length;var AV=AY?J(AX.th):undefined;z=B.call(this,AI);var AO={};do{var w=this.getRowHeaders(AP),x=w.size(),AW="",AT,AN,AZ,AH,AE,u={headers:[],values:[],colorInfo:[],idValueMapping:{}},AG,AL;if(AC.length){AG={headers:[],values:[],colorInfo:[],idValueMapping:{}};for(AL=0;AL<x;AL++){AN=w.getHeader(AL);AZ=AN.t;AH=AZ&&AZ.id;AE=AN.getElementId();if(AC.indexOf(AH)===-1){AW+=AE;}}AT=!!AO[AW];}else{AT=false;}for(AL=0;AL<x;AL++){AN=w.getHeader(AL);AZ=AN.t;AH=AZ&&AZ.id;if(AC.indexOf(AH)>-1){s.call(this,AG,AS,z,AL,AN,AZ,AH,t,AR,AQ);}else{if(!AT){s.call(this,u,AS,z,AL,AN,AZ,AH,t,AR,AQ);}}}if(AT){u=AO[AW];}else{if(AC.length){u.additional=[];AO[AW]=u;}AA.push(u);}if(AC.length){if(AQ){AG.metricSelector=K.copy(u.metricSelector,AG.metricSelector);}u.additional.push(AG);}p.call(this,u,AX,y,AP,t,AV,AY,AR,AT);AP++;}while(AP<AD);if(AC.length){for(var AK=0;AK<y.length;AK++){var AB=y[AK].oid,AM=M.getNumberFormat(AX,AK);a.forEach(AA,function(Aa){Aa.idValueMapping[AB]=Aa.values[AK].v=U.formatByMask(AM,Aa.values[AK].rv);});}}return AA;}function g(x,t){for(var u=0;u<t.length;u++){var w=t[u];x.idValueMapping[w.cid]=x.values[u].v=U.formatByMask(w.mask,x.values[u].rv);}}function o(w,t){var u;if(w.children){a.forEach(w.children,function(y){o.call(this,y,t);if(w._eid!==j){if(!w.values){w.values=[];}for(u=0;u<t.length;u++){var x=y.values[u];if(!w.values[u]){w.values[u]=K.copy(x);}else{w.values[u].rv+=Number(x.rv);}}}});if(w._eid!==j){g.call(this,w,t);}}else{if(w.additional){g.call(this,w,t);w.formattedValue=w.values[0].v;w.value=w.values[0].rv;}}}function P(AW){var AZ=this.data,AE=this.getTotalRows(),AF=AZ.gts.col[0],z=AF?AF.es:[],AL=z.length,AM={},AO=[],AQ,AR=0,AP;AW=K.copy(AW,{minAttribute:1,minMetric:1,descKey:"name",childrenKey:"children",hasTitleName:false,hasSelection:false,needDecode:false,nestedLevel:undefined,colorByInfo:[]});if(AE<AW.minAttribute||AL<AW.minMetric){throw"Error";}var AC=AW.descKey,AJ=AW.childrenKey,t=AW.needDecode,AT=AW.hasTitleName,AS=AW.hasSelection,x=AW.nestedLevel||0,AY=AW.hasThreshold,AK=AW.colorByInfo,AU=AK.length,AD=AW.additionalAttrIds||[];var AX=AY?J(AZ.th):undefined;AM[AC]="root";AM._eid=j;AQ=B.call(this,AK);var AH={},y,AI,w,AG;var AV=function(Ax,Ac,Al,Ap,Af,Aq,As){var Ay=Ac.getHeader(Al),A3=Ay&&Ay.t,Av=A3&&A3.id,At=(Ay&&Ay.getName())||"",Am=Ac&&Ac.headers&&Ac.headers.length||0,Ar=Ay&&Ay.getElementId(),A0=a.some(AQ,function(A5,A4){return A5&&((Al-A4)%Am===0);});if(AD.indexOf(Av)===-1){if(!Ax[AJ]){Ax[AJ]=[];AH[Ax._eid]={};}y=Ax[AJ];AI=AH[Ax._eid];w=AI[Ar];}var A1=Al+1,Ah=[At];while(A1<Ac.size()){var Ag=Ac.getHeader(A1),Ab=Ag&&Ag.t,Ai=Ab&&Ab.id;if(Ai===Av){Al++;if(Ag&&Ag.getName()){Ah.push(Ag.getName());}}else{break;}A1++;}At=Ah.join(" ");if(AU&&A0){AO.push(Ar);}var Ak=(Ay!==undefined);var Az={headerObj:Ay,attributeSelector:{n:At,tid:Av,eid:Ar,isSelectAttr:true}};var Aa=[{n:At,id:Ar}];if(AD.indexOf(Av)>-1){As.idValueMapping[Av]=At;if(AS&&Ak){As.headers.push(Az);As.metricSelector[Av]=Aa;}}else{if(!w||(Al===x-1)){w={_eid:Ar,idValueMapping:{}};if(Ax.idValueMapping){w.idValueMapping=K.copy(Ax.idValueMapping);}w.idValueMapping[Av]=At;if(Ak){w[AC]=t?L(At):At;if(AT){var A2=A3&&A3.n;w.tname=t?L(A2):A2;}if(AS){w=K.copy(Az,w);}}y.push(w);AI[Ar]=w;}if(AS&&Ak){Aq.push(Az);Af[Av]=Aa;if(As){As.metricSelector[Av]=Aa;}}}if(Al<Ac.size()-1&&(!x||(Al<x-1))){AV.call(this,!w?Ax:w,Ac,Al+1,Ap,Af,Aq,As);}else{var Ao=this.getMetricValue(Ap,0).value;if(Ao){w.value=Ao.rv;w.formattedValue=Ao.v;}if(AU){w.colorInfo=AO;AO=[];}if(AD.length){if(!w.additional){w.additional=[];}w.additional.push(As);}if(!w.values){w.values=[];}for(AP=0;AP<z.length;AP++){var An=z[AP].oid,Aw=this.getMetricValue(Ap,AP).value,Ad={v:Aw.v,rv:Aw.rv,id:An};if(AY){var Aj=AX[AP],Ae=Aj&&Aj[Aw.ti];if(Ae){Ad.threshold=Ae;}}if(AT){var Au=this.getColTitles().titles[0].es[AP].n;Ad[AC]=t?L(Au):Au;}if(As){As.values.push(K.copy(Ad));As.idValueMapping[An]=Aw.v;if(!w.values[AP]){w.idValueMapping[An]=Aw.v;w.values.push(Ad);}else{w.values[AP].rv+=Number(Aw.rv);}}else{w.idValueMapping[An]=Aw.v;w.values.push(Ad);}}if(AS){w.headers=Aq;w.metricSelector=Af;}}};do{var u=this.getRowHeaders(AR);if(AD.length){AG={metricSelector:{},idValueMapping:{},values:[],headers:[]};}w=undefined;AV.call(this,AM,u,0,AR,{},[],AG);AR++;}while(AR<AE);var AA=[];for(var AN=0;AN<z.length;AN++){var AB=z[AN].oid;AA.push({cid:AB,mask:M.getNumberFormat(AZ,AN)});}if(AA.length){o.call(this,AM,AA);}return AM;}function Z(t,u){var w=[];a.forEach((t.row||[]).concat(t.col||[]),function(x){if((x.id===u)&&(x.fs)){w=w.concat(x.fs);}});return w;}mstrmojo.models.template.DataInterface=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.models.template.DataInterface",data:null,init:function(t){this.data=t;},getRowTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:true});},getColTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:false});},getTotalRows:function d(){if(this.data.eg){return 0;}var w=this.data,u=w&&w.ghs,t=u&&u.rhs,x=t&&t.items;return(x&&x.length)||0;},getTotalColHeaderRows:function e(){var t=this.data.ghs.chs.items;return(t&&t.length)||0;},getTotalCols:function D(){return this.getColHeaders(0).size();},getRowHeaders:function Y(t){return new mstrmojo.models.template.Headers({data:this.data,i:t,isRow:true});},getColHeaders:function b(t){return new mstrmojo.models.template.Headers({data:this.data,i:t,isRow:false});},getMetricValue:function F(w,t){var u=this.data;return new mstrmojo.models.template.MetricValue({data:u,value:u.gvs.items&&u.gvs.items[w].items[t]});},getColumnHeaderCount:function O(){var t=this.data.gvs.items;return t?t[0].items.length:0;},getCSSString:function c(){return this.data.cssString;},isEmpty:function N(){var t=this.data.gsi;return !t||(!t.rows.length&&!t.cols.length&&!t.mx.length);},getAggregatePadding:function G(){var u=this.data.gsi&&this.data.gsi.fmts,w=function(y,x){return y+x;},t=function(y){var x=0;return["ch","rh","va"].map(function(z){var AA=false;return y.map(function(AB){if(u[z]&&u[z].hasOwnProperty(AB)){if(!AA){AA=true;x++;}return u[z][AB];}return 0;}).reduce(w)/y.length;}).reduce(w)/(x||1);};if(!u){return null;}return{v:t(["tp","bp"]),h:t(["rp","lp"])};},getColResizeScenario:function k(){var t=this.data;if(t.afw){return l;}else{if(t.afc===false){return E;}else{return V;}}},getColResizeInfo:function f(z){var AA=this.data,x={v:this.getColResizeScenario(),widths:null};var AB=AA.gsi,u=AA.gts||{},AE=[],y=AA.twm||{},AC=y.top||[],AD=y.bottom||[],w=0,t=function(AG,AF){if(AB){AB[AG].every(function(AI){var AJ=AI.did,AK=Z(u,AJ),AH=X.getFormsByAttrId(AJ,z);(AK.length?AK:[]).forEach(function(AN,AM){var AO=AH[a.find(AH,"fid",AN.id)],AL=(AD&&AD[w])||{};AE.push({n:AI.n+(AH.length?(" - "+AO.fnm):""),did:AJ,depth:AM+1,t:AI.t||4,width:parseInt(AL.w||0,10),widthModel:{top:(AC&&AC[w])||{},bottom:AL}});w++;});return !AF;});}};t("rows",false);if(AE.length===0){t("cols",false);}t("mx",AB.tma===1);x.widths=AE;return x;},getRowResizeScenario:function R(){return !!this.data.rh?E:V;},getRowResizeInfo:function A(){var u=this.data,t=u.rh;return{v:this.getRowResizeScenario(),height:(t===undefined||t==="")?u.xrh:t};},getColumnHeaderData:function S(AF){var AA=this.data,AH=AA.gts,AG=AA.gts.rec,AI=[],u=[],AD=AH.row,AB=AA.gsi.prop.rows.shw===I&&AF;a.forEach(AD,function(AK){var AJ=AK.fs,AL=AK.otp===Q;if(!AB){if(AJ&&AJ.length>1){a.forEach(AJ,function(){AI.push(AK);});}else{AI.push(AK);}}if(AL){u=AK.es;}});var z=AH.col;if(z&&z.length>0){var y=AA.ghs,w=y.chs,t=w.items,AE=t.length>0?t[t.length-1].items:[],x=function x(AJ){var AK=AJ.pi,AL=AK&&AK.ci,AM=AK&&AK.ri;if(AJ.mix!==undefined){return AJ;}if(AM===undefined||AL===undefined){return ;}return x(t[AM].items[AL]);};a.forEach(z,function(AJ){var AK=AJ.otp===Q;if(!AB&&(AK&&(!AG||AD.length===0))){AI.push(AJ);}if(AK){u=AJ.es;}});var AC=AI.length;a.forEach(AE,function(AJ){delete AJ._ridx;});if(u.length>0){a.forEach(AE,function(AM){var AJ=x(AM);var AN=AJ?AJ.idx:(AM.pi?0:AM.idx),AL=u[AN]||u[0];var AK=AL._ridx=AL._ridx||[];if(AK.length===0){a.forEach(AE,function(AP,AQ){var AO=x(AP);if(!AJ||AO.mix===AN){AK.push(AC+AQ);}});}AI.push(AL);});}}else{if(u.length>0){AI.push(u[0]);}}return AI;},getUnitById:function n(w){var u=this.data.gsi,t=null;[u.rows,u.cols,u.mx].some(function(x,y){if(y===2){y=-2;}x.some(function(z,AA){if(z.did===w){t={axis:y+1,depth:AA+1,unit:z};}return !!t;});return !!t;});return t;},getRawData:function q(t,u){switch(t){case i:return W.call(this,u);case C:return h.call(this,u);}return P.call(this,u);}});mstrmojo.models.template.DataInterface.inflateGridData=function(w){var x=w.gvs,u=w.ghs;if(w.egt===undefined&&(w.eg===undefined||w.eg===null)&&!!x&&K.isEmpty(x)){var t={v:"",rv:""},y={items:(u.chs.cws||[0]).map(function(){return t;})};x.items=u.rhs.items?u.rhs.items.map(function(){return y;}):[];x.show=true;}};mstrmojo.models.template.DataInterface.ENUM_GRID_RESIZE={FIT_TO_WINDOW:l,FIT_TO_CONTENTS:V,FIXED:E};mstrmojo.models.template.DataInterface.ENUM_RAW_DATA_FORMAT={TREE:H,ROWS:i,ROWS_ADV:C};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo._HasExtraSelectionInfo","mstrmojo.customviz.GraphicModel","mstrmojo.CustomVisUtility","mstrmojo.VisUtility");var D=mstrmojo.array,I=mstrmojo.vi.ui.rw.SelectionType,H=mstrmojo.CustomVisUtility.log,F=mstrmojo.customviz.PICKED_TYPE,A=mstrmojo.customviz.PICKED_CRITERIA,K=mstrmojo.VisUtility;function L(O,N,Q){var P={};P[O]=[{id:N,n:Q}];return P;}mstrmojo._SupportCustomVizBrushesAndHighlights=mstrmojo.provide("mstrmojo._SupportCustomVizBrushesAndHighlights",{_mixinName:"mstrmojo.kpicard._SupportKPICardBrushesAndHighlights",isHighlightedAsTarget:false,canPickGraphicModel:function M(c,R,d,S){if(!c||!d||d.scriptClass!=="mstrmojo.customviz.GraphicModel"){return false;}var Z=[F.ATTR,F.METRIC,F.BOTH],e,a,U,Y=this.isHighlightedAsTarget,N=0;if(!Y){e=F.ATTR;a=F.METRIC;U=A.SUBSET;}else{e=Z.indexOf(S&&S.attribute)===-1?F.ATTR:S.attribute;a=Z.indexOf(S&&S.metric)===-1?F.METRIC:S.metric;U=(S&&(S.criteria===A.SUBSET||S.criteria===A.INTERSECTION))?S.criteria:A.INTERSECTION;}var P=R?e:a;if((P===F.ATTR&&!d.isAttributeSelector())||(P===F.METRIC&&d.isAttributeSelector())){return false;}var Q={},b=c,f,O=0;if(d.isAttributeSelector()){D.forEach(D.ensureArray(d.getSelector()),function(g){if(g.tid){Q[g.tid]=[{id:g.eid}];}});}else{Q=d.getSelector();}for(f in b){++N;if(!Q.hasOwnProperty(f)){if(U===A.SUBSET){return false;}continue;}if(b.hasOwnProperty(f)){var X=D.ensureArray(Q[f]),W=D.ensureArray(b[f]),V=(X.length===W.length)&&(D.difference(X,W,"id").length===0);if(!V){return false;}}++O;}return Y?O!==0:N===Object.keys(Q).length;},addGraphicSelection:function J(Q,S,P){var N=this,R,O;N.isHighlightedAsTarget=P;for(R in Q){if(Q.hasOwnProperty(R)){O=Q[R];N.addSelectionBySingleSelector(O,S,true,false);}}},highlight:function C(P,R,N){if(this._super){this._super.apply(this,arguments);}if(this.noHighlightAfterKeepOnlyExcludeDrill||this.isEmpty()||this.excludeData){return ;}var Q=this,O=!N;this.clearCxtMnuSelection(true);this.clearSelections(false,true);if(P===I.ATTS){Q.addGraphicSelection(R,true,O);}else{if(P===I.METRICS){Q.addGraphicSelection(R,false,O);}}if(this.plotted){this.updateHighlight();}},updateHighlight:function E(){},clearSelections:function(N,O){if(this._super){this._super(O);}if(N&&this.plotted){this.updateHighlight();}},addNormalizedSelection:function J(U,S,P,O){var N=this,R,Q;for(Q=0;Q<U.length;++Q){R=U[Q];if(S){R=L(R.tid,R.eid,R.n);}N.addSelectionBySingleSelector(R,S,P,O);}},highlightElements:function B(P){var Q=D.ensureArray(P.selection),U=D.ensureArray(P.contextMenu),S=Q[0]&&Q[0].isSelectAttr,R=U[0]&&U[0].isSelectAttr,O,N=this;N.clearSelections(false,false);N.clearCxtMnuSelection(false);O=N.isHighlightedAsTarget;N.isHighlightedAsTarget=true;N.addNormalizedSelection(Q,S,false,false);N.addNormalizedSelection(U,R,false,true);N.isHighlightedAsTarget=O;if(this.plotted){this.updateHighlight();}},handleBrushHighlightMobile:function G(P){var N=this,O,Q=P[0]&&P[0].isSelectAttr;N.clearSelections(false,false);N.clearCxtMnuSelection(false);O=N.isHighlightedAsTarget;N.isHighlightedAsTarget=true;N.addNormalizedSelection(P,Q,true,false);N.isHighlightedAsTarget=O;if(this.plotted){this.updateHighlight();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.string","mstrmojo.ui._HasScroller","mstrmojo.VisUtility");var B=mstrmojo.css,I=mstrmojo.dom,Y=mstrmojo.VisUtility,X=mstrmojo.array,l=mstrmojo.string,J=mstrmojo.hash,W="new-vis-tooltip",C=16,L=12,Q=20,e=5,c=20,V=2,O=220,h=120,n="px",P=200,D=["mouseover","mouseout"];function m(o){var q=this.tableNode;q.innerHTML="";for(var p=0;p<o;p++){q.appendChild(document.createElement("COL"));}return q;}function b(s,t){s=s||"";t.innerHTML=l.encodeHtmlString(s,true);var o,q=Y.getComputedFontStyle(t),p=Math.ceil(Y.measureTextWidth(t.innerHTML,q,q.bonus));if(p>O){o=Y.truncateTextToLineWithWordWrap(s,q,O,3,true);t.innerHTML=l.encodeHtmlString(o.text,true);t.setAttribute("title",s);}return Math.min(p,O);}function K(u,t){var q=u.childNodes,w=(t&&t.length)||0,o=0,p,s;for(p=0;p<w;p++){s=t[p]+((p<w-1)?C:1);q[p].style.width=s+n;o+=s;}u.style.width=o+n;}mstrmojo.NewVisTooltip=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.NewVisTooltip",prevInfoObj:null,hideTooltipHandler:null,domEventListeners:{},markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="new-vis-tooltip-container-wrapper"><div class="new-vis-tooltip-container"><div  class="new-vis-tooltip-table"></div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild.firstChild;},tableNode:function(){return this.domNode.firstChild.firstChild.firstChild;}},init:function k(o){this._super(o);B.addWidgetCssClass(this,(o&&o.widgetClass)?[o.widgetClass,W]:W);},postBuildRendering:function N(){this._super();this.attachListeners();},attachListeners:function R(){this.detachListeners();X.forEach(D,function(o){this.domEventListeners[o]=I.attachMarkupEvent(this.id,this.domNode,o);},this);},setupScrollNodes:function d(){this.scrollNode=this.containerNode;this.scrollbarHostNode=this.domNode;},toggle:function S(o){var p=mstrApp.isAppStatePrintPreview&&mstrApp.isAppStatePrintPreview();if(this.domNode){this.domNode.style.display=o&&!p?"block":"none";}},isVisible:function E(){return this.domNode&&(this.domNode.style.display!=="none");},hasTableContent:function A(){return this.tableNode;},clearTooltipHandler:function F(){if(this.hideTooltipHandler){clearTimeout(this.hideTooltipHandler);this.hideTooltipHandler=null;}},renderTooltip:function a(o,p){if(!o||o.length===0){return ;}this.toggle(true);if(X.isArray(o)){this.showSimpleInfo(o,p);}else{this.showGridInfo(o,p);}this.prevInfoObj=o;},showTooltipDelay:function j(p,q){this.clearTooltipHandler();var o=this;this.showTooltipHandler=setTimeout(function(){o.renderTooltip(p,q);},200);},showDossierTtp:function g(o,p){this.clearTooltipHandler();if(this.isVisible()&&J.equals(this.prevInfoObj,o)){this.moveTo(p,true);}else{this.renderTooltip(o,p);}},showSimpleInfo:function H(p,u){if(!p||p.length<=0){return ;}var s=m.call(this,2),q=document.createElement("tbody"),t=0,o=0;s.appendChild(q);X.forEach(p,function(x){var y=q.insertRow(-1),z=y.insertCell(-1),w=y.insertCell(-1);if(!x){B.addClass(y,"seperator");}else{B.addClass(z,"name");t=Math.max(t,b(x.n,z));o=Math.max(o,b(x.v,w));}});K.call(this,s,[t,o]);this.moveTo(u);},showGridInfo:function U(o,AB){var p=o&&o.header,u=o&&o.body,z=o&&o.attrCount,AD,q,w;if(!p||p.length<=0){return ;}var y=p.length,AC=m.call(this,y),AA=document.createElement("thead"),t=document.createElement("tbody"),x=AA.insertRow(-1),s=[];AC.appendChild(AA);AC.appendChild(t);X.forEach(p,function(AF,AE){q=x.insertCell(-1);B.addClass(q,"header");if(AE>=z){B.addClass(q,"metric");}s[AE]=b(AF,q);});X.forEach(u,function(AE,AF){AD=t.insertRow(-1);for(w=0;w<y;w++){q=AD.insertCell(-1);if(AF===0){B.addClass(q,"firstRow");}if(w>=z){B.addClass(q,"metric");}s[w]=Math.max(s[w],b(AE[w],q));}});K.call(this,AC,s);this.moveTo(AB);},moveTo:function(AF,q){if(!AF||isNaN(AF.x)||isNaN(AF.y)||!this.tableNode){return ;}var AD=mstrmojo.dom.position(document.body),AA=this.domNode,AB=this.containerNode,AJ=this.tableNode,s=AA.style,z=AB.style,AH=AJ.offsetWidth+c+V,AC=AJ.offsetHeight+c+V,u=AD.x+AD.w,AI=AD.y+AD.h,AG=AF.x,AE=AF.y,p=AG+L,o=AE+Q,t;if(AH>AD.w*0.8){AH=AD.w*0.8;}t=AH<h?(h-AH)/2:0;z.paddingLeft=t+n;if(AH<h){AH=h;}z.width=AH-c-V-t+n;if(AC>AD.h*0.8){AC=AD.h*0.8;}z.height=AC-c-V+n;AH+=e;AC+=e;if(p+AH<=u&&o+AC>AI){o=AI-AC;}else{if(p+AH>u&&o+AC<=AI){p=u-AH;}else{if(p+AH>u&&o+AC>AI){p=u-AH;if(AE>=AC+e){o=AE-AC-e;}else{if(AE>AI-AE){o=e;z.height=AE-2*e-c-V+n;}else{z.height=AI-AE-Q-e-c-V+n;}}}}}s.left=p+n;s.top=o+n;this.updateScrollbars();if(z.overflowY==="scroll"||z.overflowX==="scroll"){if(!q){AB.scrollLeft=0;AB.scrollTop=0;}}},onmouseover:function G(){this.clearTooltipHandler();},onmouseout:function i(){this.hide(true);},hide:function f(o){var p=this;if(this.isVisible()){if(o){if(!this.hideTooltipHandler){this.hideTooltipHandler=setTimeout(function(){p.toggle(false);},P);}}else{this.clearTooltipHandler();this.toggle(false);}}},detachListeners:function M(){X.forEach(D,function(o){var p=this.domEventListeners[o];if(p){I.detachEvent(this.domNode,o,p);}},this);this.domEventListeners={};},destroy:function Z(){this.detachListeners();this.clearTooltipHandler();this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.array","mstrmojo.vi.ui.theme","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui.VIDragUnit","mstrmojo.hash");var G=mstrmojo.css,E=mstrmojo.dom,B=mstrmojo.vi.ui.theme,F=mstrmojo.array,C=mstrmojo.hash;function D(P,Q,O){var N=false;F.forEach(this.getSelectedItems(),function(R){if(R.itemNode===Q||R===P){N=true;}});if(P&&!N){this.doItemSelect(P,O||{});}}var M={avatarCssClass:"mstrmojo-VIUnitList",encodeUnitAvatar:true,getDragData:function L(N){var O=N.src.node,Q=E.findAncestorByAttr(O,"idx",true,this.domNode);N.src.node=Q?Q.node:O;var P=(N.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit()).getUnitDragData(N,this.getSelectedItems());if(this.getItemDisplayName){mstrmojo.func.override({getItemDisplayName:this.getItemDisplayName},N.dragUnitHelper);}P.srcId=this.id;return P;},createAvatar:function A(O,N){if(N.dragUnitHelper){return N.dragUnitHelper.getUnitAvatar(N,this.encodeUnitAvatar);}},selectDragNode:function K(N){var O=N.src;D.call(this,this.getItemFromTarget(O.node),this.getItemNodeFromTarget(O.node),O);},onItemContextMenu:function J(O,N){D.call(this,O,this.getItemNodeFromTarget(N.getTarget()),N);if(this._super){return this._super(O,N);}},positionAvatar:function H(O,N){N.dragOffsets=N.dragUnitHelper.getDragUnitOffsets();if(this._super){this._super(O,N);}}},I=C.copy(M);I._mixinName="mstrmojo.vi.ui._HasUnitListAvatar2";I.getDragData=function(N){if(this.isDraggingItem&&!this.isDraggingItem(N)){if(this._super){return this._super(N);}}else{return M.getDragData.call(this,N);}};mstrmojo.vi.ui._HasUnitListAvatar2=mstrmojo.provide("mstrmojo.vi.ui._HasUnitListAvatar2",I);mstrmojo.vi.ui._HasUnitListAvatar=mstrmojo.provide("mstrmojo.vi.ui._HasUnitListAvatar",mstrmojo.mixin(M,mstrmojo.mixin(mstrmojo._HasOwnAvatar)));}());(function(){mstrmojo.requiresCls("mstrmojo.rw.ConditionWalk","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.mstr.EnumNodeDimty","mstrmojo.mstr.DocElementDataHelper","mstrmojo.ui._IsIncFetchList");var E=mstrmojo.array,G=mstrmojo.css,C=mstrmojo.mstr.EnumNodeDimty,K=E.hash([C.NodeDimtyUnspecified,C.NodeDimtyNone]);function H(){var L=this.thresholdRow,M=this.editor;if(L){this.removeChildren(L);}G.toggleClass(M.content.domNode,"no-overflow",false);this.set("visible",false);M.setRowPanelVisibility(true);}mstrmojo.threshold.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,[mstrmojo.ui._IsIncFetchList],{objectBrowsingEnabled:false,dimtyTypes:K,targets:null,targetsLastMod:null,ets:null,condition:null,onOK:function B(){var L=this.editor;L.model.setConditionData(this.condition,this.model.get());H.call(this);L.toggleButtonStatus(true);},close:function I(){var O=this.editor;var Q=this.condition,M=Q.tree.parent,L=M.exprTree;if(Q.isEmpty()){Q.del();}var N=L&&L.items,P=N&&N.length;if(!P||P===0){O.model.deleteThreshold(M.threshold);}H.call(this);O.toggleButtonStatus(true);},browse:function F(L){this._super(L);if(L.alias==="es"){G.toggleClass(this.eb.domNode,"adv-threshold",true);}},getAttributeForms:function J(L){return mstrmojo.rw.ConditionWalk.getAttForms(L,this.editor.controller.datasets);},getElements:function D(O,R){var Q={},M=R.complete,N=this;this.scrollNode=this.columnWalk.es.scrollNode;var L=this.scrollNode&&this.scrollNode.style;if(L){L.height="100%";}if(!this.ifDataHelper){this.ifDataHelper=new mstrmojo.mstr.DocElementDataHelper({source:this.editor.controller.dataService});}else{var P=this.ifDataHelper;P.set("items",null);P.set("blockBegin",1);P.set("blockCount",0);P.set("totalSize",0);P.browseConfig.attributeID=O.did;}this.columnWalk.es.es.allowUnlistedValues=false;this.updateBrowseElementsParams(Q,O);this.ifDataHelper.browseConfig=Q;R=mstrmojo.func.wrapMethods(R,{complete:function(S){N.initScroll();N.set("isFetching",false);}});this.ifDataHelper.getItems(1,R);},postNext:function A(){this.columnWalk.es.updateList(this.ifDataHelper.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.rw.ConditionWalk","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.expr","mstrmojo.css");var F=mstrmojo.expr.ET.MQ,H=mstrmojo.expr.ET.MC,C=mstrmojo.css,B=mstrmojo.desc(14387,"Evaluate this condition independent of other dataset level conditions");var G=function(L,N){var K=L.et,I=L.m&&mstrmojo.rw.ConditionWalk.isMdxDM(L.m.did),M=((K===F||K===H)&&!this.inRelation&&!I)?"block":"none",J=(((N===1)||K!==F)&&!I)?1:0;C.toggleClass(this.toolNode,"unselectable",K===H);this.toolNode.style.display=M;this.level.set("selectedIndex",J);this.includeExist.set("visible",J===1&&(K===H||K===F));this.includeExist.set("checked",L.idcsi===undefined?false:L.idcsi);};mstrmojo.fe.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,null,{scriptClass:"mstrmojo.fe.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="tools"></div><div class="apply"></div></div>',markupSlots:mstrmojo.hash.copy({toolNode:function(){return this.domNode.childNodes[2];}},mstrmojo.hash.copy(mstrmojo.rw.ConditionWalk.prototype.markupSlots)),layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",toolNode:"auto",applyNode:"auto"},xt:true},postCreate:function E(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Label",slot:"toolNode",text:mstrmojo.desc(13517,"Calculate on")},{scriptClass:"mstrmojo.ui.Pulldown",slot:"toolNode",alias:"level",isHostedWithin:false,items:[{n:mstrmojo.desc(13518,"Template level"),v:0},{n:mstrmojo.desc(13519,"Dataset level"),v:1}],onitemSelected:function I(J){var K=this.parent;if(K&&K.condition&&K.visible){K.includeExist.set("visible",J.v===1);K.condition.level=J.v;}}},{scriptClass:"mstrmojo.ui.Checkbox",alias:"includeExist",slot:"toolNode",postBuildRendering:function(){this.domNode.innerHTML=B;},oncheckedChange:function(){var J=this.parent;if(J){J.model.set("idcsi",this.checked);}}}]);if(this._super){this._super();}},onvisibleChange:function A(I){var J=this.condition;if(J&&this.toolNode&&this.visible){G.call(this,J.data,J.tree.level);}if(this._super){this._super(I);}},onmodeledit:function D(I){if(this._super){this._super(I);}if(this.toolNode){G.call(this,this.model.get(),this.model.level);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.css","mstrmojo.Button","mstrmojo.Label","mstrmojo.rw.ConditionWalk","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.ui._IsIncFetchList","mstrmojo.ui.ColumnWalk","mstrmojo.mstr.DocElementDataHelper");var F=mstrmojo.expr.ET.MQ,B=mstrmojo.expr.ET.MC,H=mstrmojo.css,G=mstrmojo.desc(14387,"Evaluate this condition independent of other dataset level conditions");var D=function(Q,S){var P=Q.et,N=this.parent&&this.parent.docModel&&this.parent.docModel.datasets,M=Q.m&&mstrmojo.rw.ConditionWalk.isMdxDM(Q.m.did,N),R=((P===F||P===B)&&!this.inRelation&&!M)?"block":"none",O=(((S===1)||P!==F)&&!M)?1:0;H.toggleClass(this.toolNode,"unselectable",P===B);this.toolNode.style.display=R;this.level.set("selectedIndex",O);this.includeExist.set("visible",O===1&&(P===B||P===F));this.includeExist.set("checked",Q.idcsi===undefined?false:Q.idcsi);};mstrmojo.vi.ui.editors.fe.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,[mstrmojo.ui._IsIncFetchList],{scriptClass:"mstrmojo.vi.ui.editors.fe.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="tools"></div><div class="apply"></div></div>',markupSlots:mstrmojo.hash.copy({toolNode:function(){return this.domNode.childNodes[2];}},mstrmojo.hash.copy(mstrmojo.rw.ConditionWalk.prototype.markupSlots)),layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",toolNode:"auto",applyNode:"auto"},xt:true},children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"333px",width:"800px"},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",title:mstrmojo.desc(2399,"Cancel"),ignoreLayout:true,onclick:function(){var M=this.parent;if(M.close){M.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",title:mstrmojo.desc(2397,"OK"),onclick:function(){var M=this.parent;if(M.onOK){M.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:"",ignoreLayout:true}],init:function K(M){this._super(M);this.attachEventListener("conditionWalkUpdateOkBtn",this.id,function(N){var P=N.valid,O=this.parent;O.toggleOkButtonStatus(P);});},postCreate:function I(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Label",slot:"toolNode",text:mstrmojo.desc(13517,"Calculate on")},{scriptClass:"mstrmojo.ui.Pulldown",slot:"toolNode",alias:"level",isHostedWithin:false,items:[{n:mstrmojo.desc(13518,"Template level"),v:0},{n:mstrmojo.desc(13519,"Dataset level"),v:1}],onitemSelected:function M(N){var O=this.parent;if(O&&O.condition&&O.visible){O.includeExist.set("visible",N.v===1);O.condition.level=N.v;}}},{scriptClass:"mstrmojo.ui.Checkbox",alias:"includeExist",slot:"toolNode",postBuildRendering:function(){this.domNode.innerHTML=G;},oncheckedChange:function(){var N=this.parent;if(N){N.model.set("idcsi",this.checked);}}}]);if(this._super){this._super();}},onvisibleChange:function J(M){var N=this.condition;if(N&&this.toolNode&&this.visible){D.call(this,N.data,N.tree.level);}if(this._super){this._super(M);}},onmodeledit:function A(M){if(this._super){this._super(M);}if(this.toolNode){D.call(this,this.model.get(),this.model.level);}},getAttributeForms:function L(M){return mstrmojo.rw.ConditionWalk.getAttForms(M,this.editor.docModel.datasets);},getElements:function E(P,R){var Q={},N=R.complete,O=this;this.scrollNode=this.columnWalk.es.scrollNode;var M=this.scrollNode&&this.scrollNode.style;if(M){M.height="100%";}if(!this.ifDataHelper){this.ifDataHelper=new mstrmojo.mstr.DocElementDataHelper({source:this.editor.docModel.getDataService()});}else{this.ifDataHelper.set("items",null);}this.columnWalk.es.es.allowUnlistedValues=false;this.updateBrowseElementsParams(Q,P);this.ifDataHelper.browseConfig=Q;R=mstrmojo.func.wrapMethods(R,{complete:function(S){O.initScroll();}});this.ifDataHelper.getItems(1,R);},postNext:function C(){this.columnWalk.es.updateList(this.ifDataHelper.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Dial","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Obj","mstrmojo.CheckBox","mstrmojo.mstr.EnumNodeProperties","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.fe.FilterExprTree","mstrmojo.fe.RelationFilterExprTree","mstrmojo.fe.CreateSetEditor","mstrmojo.fe.ConditionWalk","mstrmojo.ui.Pulldown","mstrmojo.ui.StatusButton");var a=mstrmojo.expr,I=a.ET,O=a.BRANCH_FNS,Y=mstrmojo.Obj,X=mstrmojo.dom,b=mstrmojo.array,S=mstrmojo.hash,e=mstrmojo.css,F=mstrmojo.mstr.EnumNodeProperties,C=mstrmojo.warehouse.EnumObjectTypes,K={TEMPLATE:0,DATASET:1},E=mstrmojo.mstr.EnumNodeDimty,Q=b.hash([E.NodeDimtyUnspecified,E.NodeDimtyNone]),M=200,H=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function Z(){var h=this.avatar;if(h){h.parentNode.removeChild(h);delete this.avatar;e.removeClass(h,[this.avatarCssClass]);}}mstrmojo.fe.FilterEditorBase=mstrmojo.declare(mstrmojo.Editor,null,{onSave:null,onCancel:null,title:mstrmojo.desc(12032,"View Filter Editor"),help:"view_filter_editor_for_report_services_documents.htm",cssClass:"mstrmojo-charcoalboxe mstrmojo-FE",showLimits:true,objectBrowsingEnabled:false,children:null,showCondWalk:false,isNewCond:false,vizTitle:"",init:function U(h){this.children=[{alias:"feContent",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-content",postCreate:function(){this.children=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-exprTool",children:[{scriptClass:"mstrmojo.ui.StatusButton",cssClass:"mstrmojo-FE-addCondition",postCreate:function i(){this.editor=this.parent.parent.parent;this.statusList=this.editor.getAddConditionList();this.status=this.statusList[0];},onButtonClick:function(j){if(j){j.handler.apply(this.editor);}}}]},this.parent.getExpressionContainerCfg()];}},this.getConditionWalkConfig(),{alias:"buttonBar",scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",toggleBtnStatus:function(i){this.children[0].btnSave.set("enabled",i);this.children[0].btnCancel.set("enabled",i);},children:[{scriptClass:"mstrmojo.HBox",cssText:"float:right; border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(118,"Save"),alias:"btnSave",onclick:function(){var i=this.editor;i.save();i.close();},bindings:{enabled:function(){return !this.editor.readOnly;},editor:"this.parent.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"btnCancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var i=this.editor;if(i.onCancel){i.onCancel(i.model);}i.close();},bindings:{editor:"this.parent.parent.parent"}}]}]}];this._super(h);this.model=this.model||new Y();},save:function W(){var h=this.model;h.expr=f(h.exprForest);h.limitExpr=f(c(h.limitExprForest));this.onSave(h);},getExpressionContainerCfg:function(){var h=this;return{alias:"feExpr",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-expr-list",postCreate:function(){this.children=h.getExpressionContentsConfig();},onRender:function(){X.attachMarkupEvent(this.id,this.domNode,"mousedown");},onmousedown:function(i){var j=X.eventTarget(i.hWin,i.e);if(this.isBlankArea(j)){this.clearSelect();}},isBlankArea:function(i){return i===this.domNode;},clearSelect:function(){}};},getExpressionContentsConfig:function(){return[];},getConditionWalkConfig:function(){var i=this;return{scriptClass:"mstrmojo.rw.ConditionWalk",width:"750px",objectBrowsingEnabled:false,dimtyTypes:Q,alias:"walk",visible:false,onOK:function h(){var k=this.condition;i.feContent.set("visible",true);this.set("visible",false);i.onConditionEdit(k,this.model.get());i.toggleButtonStatus(true);i.set("showCondWalk",false);},close:function j(){i.feContent.set("visible",true);this.set("visible",false);var k=this.condition;if(k&&k.isEmpty()){k.del();}i.toggleButtonStatus(true);i.set("showCondWalk",false);},targets:null,targetsLastMod:null,ets:null,condition:null,bindings:{disableElementsBrowsing:"this.parent.disableElementsBrowsing"}};},onConditionEdit:function(i,h){i.tree.modifyConditionNode(i,h);},getAddConditionList:function d(){return[{n:mstrmojo.desc(1994,"Add Condition"),handler:function(){this.mainExpr.newCondition(null,true);}}];},toggleButtonStatus:function B(h){this.buttonBar.toggleBtnStatus(h);},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-FE-andOrPopup mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",slot:"containerNode",modal:false,autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var h=this.condition,k=h&&h.data&&h.data.not,l=h&&h.parent,i=l&&l.data,j=(i&&i.fn)+(k?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(j)?null:{did:j});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",renderOnScroll:false,items:[{did:19,n:O[19]},{did:20,n:O[20]},{did:19+21,n:O["19_21"]},{did:20+21,n:O["20_21"]}],onchange:function(){if(this.opening){return ;}var i=this.parent,h=i.condition,n=this.selectedItem,m=n&&n.did,l=m>21?true:null,k=m-(l?21:0);i.close();var j=h&&h.parent;if(j&&j.data&&j.data.et===I.ANDOR){j.edit(h,k,l);}else{var o=h&&h.data;if(o&&(o.not!==l)){o.not=l;h.paint();}}}}]},createSetPopupRef:{scriptClass:"mstrmojo.fe.CreateSetEditor",contentNodeCssClass:"",cssClass:"CreateSet-Editor",title:mstrmojo.desc(12034,"Create a Set"),slot:"containerNode"},_set_busy:function(i,h){if(h){this.set("enabled",false);this.set("iconClass","mstrmojo-WaitIcon");}else{this.set("enabled",true);this.set("iconClass","");}},_set_model:function(l,i){var j=this.model,k=j!==i;if(k){this.model=i;this.modelLastSet=new Date();var h=function(m){return P(J(m));};i.exprForest=h(i.expr);i.limitExprForest=h(i.limitExpr);if(this.feContent&&this.feContent.feExpr.ve){this.feContent.feExpr.ve.nameFactory.clear();}}return k;},onUpdateBrowseElementsParams:mstrmojo.emptyFn,openWalk:function(p,q,w,x){var t=this,i=X.delta(q.domNode,t.containerNode);i.y+=(w==="andor"?16:parseInt(q.domNode.offsetHeight,10));var u={condition:q,zIndex:t.zIndex+10,left:i.x+"px",top:i.y+"px"},h;switch(w){case"andor":if(t.skipAndOrPopup){return ;}h="andOrPopupRef";break;case"createSet":case"createSetOpt":if(x&&x.e&&x.e.target){var l=x&&x.e&&x.e.target,o=X.delta(l,t.containerNode);u.left=o.x+"px";u.top=o.y+parseInt(l.offsetHeight,10)+"px";}var s=t.model.targets;h="createSetPopupRef";u.type=w;u.model={attrs:b.filter(s,function(n){return n.t===C.ATTRIBUTE;}),metrics:b.filter(s,function(n){return n.t===C.METRIC;})};if(w==="createSetOpt"){u.condition=q.parent;u.model.childIdx=q.childIndex();}break;case"condition":var m=t.walk,j=q.textNode.cloneNode(true),k=m.conditionNode.firstChild;e.removeClass(j,"editable");e.addClass(m.conditionNode,"mstrmojo-ConditionNode");if(k.firstChild){k.removeChild(k.firstChild);}k.appendChild(j);m.set("objectBrowsingEnabled",t.objectBrowsingEnabled);m.set("targets",t.model.targets);m.set("targetsLastMod",t.modelLastSet);m.set("ets",q.tree.validExprTypes||t.validExprTypes);m.set("condition",q);m.set("model",S.clone(p));m.set("hasPrompt",t.model.hasPrompt);m.set("disableElementsBrowsing",t.disableElementsBrowsing||m.disableElementsBrowsing);m.set("editor",t);m.set("inRelation",q.inRelation);t.feContent.set("visible",false);m.set("visible",true);m.columnWalk.target.updateScrollbars();t.toggleButtonStatus(false);t.set("showCondWalk",true);t.set("isNewCond",!!p.isNew);return ;}t.openPopup(h,u);}});mstrmojo.fe._isReportFilterEditor=mstrmojo.provide("mstrmojo.fe._isReportFilterEditor",{_mixinName:"mstrmojo.fe._isReportFilterEditor",getExpressionContainerCfg:function(){var h=this._super();return mstrmojo.mixin({clearSelect:function(){this.re.clearTreeSelect();}},h);},getExpressionContentsConfig:function(){return[{alias:"re",scriptClass:"mstrmojo.fe.ReportFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}}];}});mstrmojo.fe.ReportFilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,[mstrmojo.fe._isReportFilterEditor],{scriptClass:"mstrmojo.fe.ReportFilterEditor"});mstrmojo.fe.ReportFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.ReportFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",onNew:function(h){h.data.isNew=true;this.editor.openWalk(h.data,h.widget.ctxtBuilder.itemWidgets[h.index],"condition");},onnodeclick:function A(h){var i=h.editor||this.tree.editor;i.openWalk(this.data,this,h&&h.part,h);},allowDrop:function G(h){var j=h&&h.src,l=j&&j.data,k=l&&l.et,i=j&&j.widget&&j.widget.tree;return k&&this!==i;}});mstrmojo.fe.FilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,null,{getExpressionContainerCfg:function(){var h=this._super();return mstrmojo.mixin({isBlankArea:function(i){if(this._super(i)){return true;}return !b.filterOne([this.ve,this.vle,this.re],function(j){if(j&&X.contains(j.domNode,i,true)){return true;}});},clearSelect:function(){this.ve.clearTreeSelect();this.vle.clearTreeSelect();}},h);},getExpressionContentsConfig:function(){return[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11746,"Dataset Level Conditions"),cssClass:"mstrmojo-FE-expr-header dl",bindings:{visible:"true || this.parent.parent.parent.showLimits"}},{alias:"ve",scriptClass:"mstrmojo.fe.RWViewFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},onBlankClick:function(h){this.parent.clearSelect(h);},supportRelation:true,postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11747,"Template Level Conditions"),cssClass:"mstrmojo-FE-expr-header tl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"vle",scriptClass:"mstrmojo.fe.RWViewLimitExprTree",level:K.TEMPLATE,bindings:{visible:"this.editor.showLimits",items:"this.editor.model.limitExprForest || []"},onBlankClick:function(h){this.parent.clearSelect(h);},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("limitExpr",this);}}];},getConditionWalkConfig:function(){var h=this._super();S.copy({scriptClass:"mstrmojo.fe.ConditionWalk"},h);return h;},getAddConditionList:function d(){var h=this._super();h.push({n:mstrmojo.desc(12055,"Add Dynamic Condition"),handler:function(){this.mainExpr.newCondition({et:I.XML,idc:1,ph:{}},true);}});return h;},onConditionEdit:function(j,i){if(j.tree.level===j.level||j.tree.level===undefined){this._super(j,i);}else{j.parent.remove(j.data);var h=K.TEMPLATE===j.level?this.limitExpr:this.mainExpr;h.addSingleCondition(i);}}});mstrmojo.fe.RWViewFilterExprTree=mstrmojo.declare(mstrmojo.fe.RelationFilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",levelSwitchValidTypes:[I.MQ],onNew:function(h){h.data.isNew=true;if(!h.data.ph){this.editor.openWalk(h.data,h.widget.ctxtBuilder.itemWidgets[h.index],"condition");}},onnodeclick:function A(i){var h=this.tree,k=i.editor||h.editor;this.level=h.level;var j=typeof (k.disableElementsBrowsing)==="function"&&k.disableElementsBrowsing();if(j&&this.data.et===I.AE){return ;}k.openWalk(this.data,this,i&&i.part,i);},ondragend:function N(j){var i=j&&j.tgt,h=i&&i.widget;if(this.tree&&h&&h.tree&&h.tree!==this.tree){Z.call(this);return ;}this._super(j);},getItemConfig:function(j,h,k){var i=this._super(j,h,k);return S.copy({getConditionTextPostfix:function(){if(this.data.et!==I.MQ){return"";}return'<img class="mstrmojo-moveToViewLimit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(4978,"Move to view limit")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewLimit(w); return false;\" />";}},i);},moveMQNodeToViewLimit:function(j){if(b.indexOf(this.levelSwitchValidTypes,j.data.et)===-1){return ;}var i=S.copy(j.data);j.parent.remove(j.data);var h=this.editor.limitExpr;h.addSingleCondition(i);},allowDrop:function G(h){var j=h&&h.src,m=j&&j.data,l=m&&m.et,k=this.tree,i=j&&j.widget&&j.widget.tree;return l&&(this===k?(i!==k):true);}});mstrmojo.fe.RWViewLimitExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewLimitExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-limitExpr",validExprTypes:b.hash([I.MQ]),levelSwitchValidTypes:[I.MQ],onnodeclick:function A(i){var h=this.tree,j=h.editor;this.level=h.level;j.openWalk(this.data,this,i&&i.part,i);},onConditionEdit:function(i,h){this._super(i,h);i.data.mdxUnitId=i.data.m.did;V(i);},addSingleCondition:function(i){var h=this._super(i);V(h);},allowDrop:function(h){var k=h&&h.src,m=k&&k.data,l=m&&m.et,j=this.tree,i=k&&k.widget&&k.widget.tree;if(j===i){return this!==i&&this.data&&(this===k.parent||this.data.mdxUnitId===(m&&m.mdxUnitId));}return !(b.indexOf(this.levelSwitchValidTypes,l)===-1);},ondrop:function L(i){var l=i&&i.src,h=l&&l.widget;if(h&&h.tree!==this.tree){var k=l&&l.data;if(k&&k.index!==null){var j=h.ctxtBuilder.itemWidgets[k.index];j.tree.moveMQNodeToViewLimit(j);}l.data=null;}this._super(i);},isEditable:function(h){return h.mdxUnitId&&this._super(h);},ondragend:function R(h){var k=h&&h.tgt,i=k&&k.widget;if(i&&i.tree!==this.tree){var j=h.src&&h.src.data;if(j&&(j.indices||(j.index!==null))){this.remove(j.indices||j.index);}Z.call(this);}else{this._super(h);}},moveMQNodeToViewFilter:function(i){var h=this.editor.mainExpr;i.parent.remove(i.data);h.addSingleCondition(i.data);},getItemConfig:function(j,h,k){j.mdxUnitId=D(j);var i=this._super(j,h,k);return S.copy({cssClass:g(j,h,k)?"per-metric-limit":"",forbidRelation:true,getConditionTextPostfix:function(){if(this.data.et!==I.MQ||mstrmojo.rw.ConditionWalk.isMdxDM(this.data.m.did)){return"";}return'<img class="mstrmojo-moveToViewFilter" src="../images/1ptrans.gif" title="'+mstrmojo.desc(9746,"Move to view filter")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewFilter(w); return false;\" />";}},i);}});function P(i){var h=[];b.forEach(i,function(j){if(!j){return ;}if(j.et===I.ANDOR&&!(j.node&F.CONDITION)){j.nds=P(j.nds);if(j.nds.length===0){return ;}else{if(j.nds.length===1){var k=j.nds[0];if(j.not){k.not=!k.not;}h.push(k);return ;}}}h.push(j);});return h;}function J(h){return h?[h]:[];}function f(h){return h&&h.length===1?h[0]:null;}function c(j){var i=P(j),h;if(!i[0]||i[0].mdxUnitId){h={et:I.ANDOR,fn:a.FN.AND,nds:i};}else{h=i[0];}return[h];}function g(i,h,j){return(j===j.tree||j.parent===j.tree)&&!!i.mdxUnitId;}function D(i){if(!("mdxUnitId" in i)){var h;switch(i.et){case I.MQ:case I.MC:h=i.m.did||null;break;case I.ANDOR:b.forEach(i.nds,function(k){var j=D(k);if(h===undefined){h=j;}else{if(h!==j){h=null;return false;}}return true;});break;default:h=undefined;break;}i.mdxUnitId=h;}return i.mdxUnitId;}function V(m){var o=m.tree,n=o.ctxtBuilder.itemWidgets[0],s=m.parent,p=b.indexOf(s.items,m.data),k=s.items[p],i=k.mdxUnitId;if(s===o){return ;}if(s.data.mdxUnitId===i){return ;}if(n.data.mdxUnitId){var j={et:I.ANDOR,fn:a.FN.AND,nds:[n.data,k]};o.remove(0);o.add([j]);o.ctxtBuilder.itemWidgets[0].ctxtBuilder.itemWidgets[0].remove(k);}else{var l=n,h;b.forEach(n.data.nds,function(u,t){if(u.mdxUnitId===k.mdxUnitId&&n.items[t]!==k){l=n.ctxtBuilder.itemWidgets[t];h=t;return false;}});if(l===s){return ;}if(l.data.et!==I.ANDOR){var q={et:I.ANDOR,fn:a.FN.AND,nds:[l.data,k]};n.add([q],h+1);n.remove(l.data);}else{l.add([k]);}s.remove(k);}}}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.array","mstrmojo.Container","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.TreeBrowserSelector","mstrmojo.DynamicClassFactory","mstrmojo._HasLayout","mstrmojo.ObjectBrowserDataProvider","mstrmojo.ui._HasScroller","mstrmojo.ui.SearchBox","mstrmojo.ui._HasUITheme","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.ui._IsViPanel","mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui.CollapsibleTitleBar","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.css","mstrmojo.vi.ui.theme");var G=mstrmojo.DynamicClassFactory,V=mstrmojo.array,I=mstrmojo.hash,H=mstrmojo.dom,A=mstrmojo.css,h=mstrmojo.string,F=mstrmojo.vi.ui.theme,b=mstrmojo.vi.ui.DatasetUnitMenuUtils,g=[4,12,1,47];var J={n:mstrmojo.desc(15348,"No applicable objects"),t:0},R={n:mstrmojo.desc(15559,"No result matches your search."),t:0};function L(o){var n=[],m=[],t=this._shiftStartIndex,s=this.selectedIndices,q=Math.min(t,o),p=Math.max(t,o);V.forEach(this.items,function(u,w){if(q<=w&&w<=p){if(!s[w]){n.push(w);}}else{if(s[w]){m.push(w);}}});this.addSelect(n);this.removeSelect(m);}function P(){return !mstrmojo.resolveFeature("hide-objects-description");}function Y(n){var m=mstrmojo.vi.enums.EnumDSSAccessRightFlags;return n.acg&&(n.acg&m.DssAccessRightUseFlag)&&(n.acg&m.DssAccessRightExecuteFlag);}function i(n,q){var p=n.itemsContainerNode,o=H.isMetaKey(q.src.hWin,q.src.e),t=H.eventTarget(q.src.hWin,q.src.e),m=-1;if(p&&t){V.forEach(p.childNodes,function(u,w){if(H.contains(u,t,true,u)){m=w;return false;}});}if(m!==-1){var s=n.items[m];if(!o&&!n.selectedIndices[m]){n.tree.clearTreeSelect();}if(V.indexOf(g,s.t)>=0){n.addSelect(m);}return true;}return false;}function c(o,m){var n=this.listSelector;if(n){n[o](this,this.itemsContainerNode,m);}}function M(n,o){var m=false;if(n.itemsContainerNode){V.forEach(n.ctxtBuilder.itemWidgets,function(p){if(H.contains(p.itemsContainerNode,o,p.domNode)){m=true;}});}return m;}mstrmojo.vi.ui.BrowserNodesAvatarContent=G.newComponent(mstrmojo.vi.ui.UnitList,null,{getItemProps:function(o,m){var n=this._super(o,m);n.addCls("isAvatar");return n;}});mstrmojo.vi.ui.TreeBrowserSelector=I.copy({premousedown:function(n,o,m){n.tree._selectNode=H.eventTarget(m.hWin,m.e);},premouseup:function D(y,m,AA){if(H.isPrimaryMouseBtn(AA.e)){var q=AA.hWin,t=AA.e,u=H.eventTarget(q,t),o=H.shiftKey(AA.hWin,AA.e),z=y._shiftStartIndex,s=M(y,u),x=y.listMapper.findIndex(y,m,u);if(x>-1&&!s&&y.tree._selectNode===u){var n=V.indexOf(g,y.items[x].t)!==-1;if(o&&z>-1&&n){y.rangeSelect(x);}else{y.toggleSelect(x);if(y.selectedIndices[x]&&n){y._shiftStartIndex=x;}}}}}},mstrmojo.TreeBrowserSelector);mstrmojo.vi.ui.TreeBrowser=G.newComponent(mstrmojo.TreeBrowser,[mstrmojo.vi.ui._HasUnitListAvatar],{containerResizable:false,draggable:true,avatarCssClass:"mstrmojo-VIUnitList",rangeSelect:L,_selectNode:null,_shiftStartIndex:-1,blockBegin:1,blockCount:50,getContent:function(n,s){n=n||this;var o=(n===this),m=this,t=function(u){if(o){mstrmojo.css.removeClass(m.domNode,["loading"]);}m.updateTreeContent(n,u);},p=function(u){n.contentRetrieved=true;n.set("items",[m.failItemCreaterFunc()]);mstrmojo.err(u);},q={success:t,failure:p};if(o){mstrmojo.css.addClass(m.domNode,["loading"]);}if(mstrApp.objectsBlockCount){this.blockCount=parseInt(mstrApp.objectsBlockCount,10);}this.getContentThroughTaskCall({isRoot:o,data:n.data,blockBegin:s||n.blockBegin,blockCount:parseInt(mstrApp.objectsBlockCount,10)||m.blockCount},q);},getDragData:function j(n){n.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit();var q=this,s=function(x){V.forEach(x.ctxtBuilder.itemWidgets,function(y){var z=H.eventTarget(n.src.hWin,n.src.e);if(z&&H.contains(y.itemsContainerNode,z,true,y.itemsContainerNode)){q=y;s(y);return false;}});};s(this);var o=i(q,n);var t=o?this.getSelectedItems().filter(function(x){return V.indexOf(g,x.t)!==-1;}):null;var m=this.id,p=function p(x){var AA=mstrmojo.all[m],y=AA.avatar;if(y){var z=[AA.avatarCssClass,"hasOwnAvatar",x];y.className=z.join(" ");}};return{items:t,item:t&&t[0],src:mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST,setAvatarClass:function u(x){p(x);},setInvalidAvatarClass:function w(){p("icn clsx_sub");}};},getSelectedItems:function(){var m=this.ctxtBuilder,n=[];if(m){V.forEach(m.itemWidgets,function(o){if(o.state===1){n=n.concat(o.getSelectedItems());}});}n=(this._super()||[]).concat(n);return n;},createAvatar:function(o,n){var m=document.createElement("div");this.avatarContent=new mstrmojo.vi.ui.BrowserNodesAvatarContent({items:n.src.data.items});this.avatarContent.render();A.addClass(this.avatarContent.domNode,[F.getThemeClass.call(this)]);m.appendChild(this.avatarContent.domNode);return m;},ondragend:function(m){this._super(m);if(this.avatarContent&&this.avatarContent.destroy){this.avatarContent.destroy();}delete this.avatarContent;},isDragValid:function S(n){var m=n.src.data.items;return(m&&m.length)||this._super(n)||false;},contentRetrieved:false,onvisibleChange:function(){if(!this.contentRetrieved){this.getContent(this);}}});mstrmojo.vi.ui.TreeBrowserNode=G.newComponent(mstrmojo.TreeBrowserNode,[{_mixinName:"newClass"}],{containerResizable:false,draggable:false,_shiftStartIndex:-1,rangeSelect:L,premousedown:function(m){this.tree._selectNode=H.eventTarget(m.hWin,m.e);},premouseup:function(n){if(H.isPrimaryMouseBtn(n.e)){var s=H.isMetaKey(n.hWin,n.e),q=H.shiftKey(n.hWin,n.e),t=H.eventTarget(n.hWin,n.e),u=H.contains(this.itemsContainerNode,t,true,this.domNode),p=u&&M(this,t),o=(this.state===2),m=!o&&(t!==this.stateNode&&t!==this.textNode)&&!u;if(p||this.tree._selectNode!==t){return ;}if((!s&&!q)||this.tree.isSelectedFolder||m){this.tree.clearTreeSelect();}if(m){this.tree.isSelectedFolder=true;}else{if(!u){this.tree.isSelectedFolder=false;}}if(!o&&(t===this.stateNode||t===this.textNode)){this.toggleState();this.tree.updateScroller();H.stopPropogation(n.hWin,n.e);}else{if(u){c.call(this,"premouseup",n);}else{this.handleNodeClicked();}}}},getSelectedItems:function(){var m=this.ctxtBuilder,n=[];if(m){V.forEach(m.itemWidgets,function(o){if(o.state===1){n=n.concat(o.getSelectedItems());}});}n=(this._super()||[]).concat(n);return n;}});function Z(o){var n=this;return I.copy(o,{scriptClass:"mstrmojo.vi.ui.TreeBrowser",alias:"contents",slot:"containerNode",isSelectedFolder:false,browserNodeClass:mstrmojo.vi.ui.TreeBrowserNode,noCheckBox:true,itemIdField:"did",useRichTooltip:true,dataProvider:this.dataProvider,listSelector:mstrmojo.vi.ui.TreeBrowserSelector,showTooltip:function s(AC,y){var AA=AC.target||H.eventTarget(AC.hWin,AC.e),x=H.findWidget(AA),u=x.data;if(u&&u.n){var AB=x.domNode.firstChild,t=function(){var AF=I.walk("anc.items",u),AE=[];V.forEach(AF,function(AG){AE.push(AG.n);});return AE.join(" > ");},AD=t();var z='<div class="name">'+h.encodeHtmlString(u.n,true)+"</div>"+(AD.length>0?'<div class="path">'+h.encodeHtmlString(AD,true)+"</div>":"")+(u.desc?'<div class="dsc">'+h.encodeHtmlString(u.desc,true)+"</div>":"");var w=H.position(AB);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",content:z,top:w.y-4,left:w.x+w.w+6};this.constructor.prototype.showTooltip.call(this,AC,y);}},updateScroller:function(){n.updateScrollbars();},isBranch:function(t){return t.t===8;},items:null,bindings:{data:"this.parent.rootFolder"},setDimensions:mstrmojo.emptyFn,item2textCss:function m(u){var x={8:"folder",3:"report",12:"attribute",4:"metric",47:"consolidation",1:"custom-group",0:"no-obj"},t=mstrmojo.TreeBrowser.prototype.item2textCss(u)||x[u.t],w=this.parent&&this.parent.highlightItems;if(w&&w.indexOf(u.did)!==-1){t+=" highlight";}return t;},onnodechange:function q(t){this.constructor.prototype.onnodechange.call(this,t);this.parent.onSelectedItemsChange(t);},getTotalSelections:function(){return[];},getContentThroughTaskCall:function p(AB,y){var t=this.parent,x=AB.data||{fty:t.rootFolderType},w=AB.isRoot,u=t.folderList,z=AB.blockBegin,AA=AB.blockCount;this.dataProvider.fetchFolderContents({sId:mstrApp.sessionState,browsableTypes:t.getObjectSubTypes().join(","),includeObjectDesc:true,folderLinksContextId:t.folderLinksContextId||29,blockCount:AA||50},{fid:x.did,fty:x.fty,blockBegin:z||1},{success:function(AD){var AC=AD.items?AD.items.filter(function(AF){return AF.t===8||Y(AF);}):[];y.success({items:AC.length?AC:[J],sz:AD.sz,bb:AD.bb,bc:AD.bc});if(w&&!u.initialized){u.set("items",AD.sc);var AE=V.find(AD.sc,"did",AD.did);if(AE!==-1){u.set("selectedIndex",AE);}}u.initialized=true;n.updateScrollbars();},failure:y.failure});}});}function e(n,o){if(n.state===2){var m=n.data;A.toggleClass(n.textNode,"highlight",m&&(o.indexOf(m.did)!==-1));}else{n.ctxtBuilder.itemWidgets.forEach(function(p){e(p,o);});}}mstrmojo.vi.ui.AllObjectsBrowser=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._IsViPanel,mstrmojo.ui._HasScroller,mstrmojo.vi.ui.toolbars._HasToolbar,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",markupString:'<div id="{@id}" class="mstrmojo-VIPanel mstrmojo-VIAllObjectsBrowser {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIPanel-titlebar"></div><div class="filter"></div><div class="search-box"></div><div class="horizontal-line"></div><div class="mstrmojo-VIPanel-contentContainer"><div style="overflow:hidden;"><div class="mstrmojo-VIPanel-content"></div></div></div></div>',markupSlots:{titlebarNode:function k(){return this.domNode.firstChild;},filterNode:function B(){return this.domNode.childNodes[1];},searchBox:function Q(){return this.domNode.childNodes[2];},contentNode:function l(){return this.domNode.childNodes[4].firstChild;},containerNode:function U(){return this.domNode.childNodes[4].firstChild.firstChild;}},title:mstrmojo.desc(5679,"All Objects"),model:null,rootFolder:null,rootFolderType:null,highlightItems:null,getObjectSubTypes:function(){var m=[2048,3072,1024];if(!mstrApp.isSingleTier){m.push(12032);m.push(257);m.push(2560);}return m;},layoutConfig:{h:{titlebarNode:"30px",filterNode:"30px",searchBox:"33px",containerNode:"100%"},w:{titlebarNode:"100%",searchBox:"100%",containerNode:"100%"},xt:true},opened:false,dataProvider:null,onSelectedItemsChange:mstrmojo.emptyFn,onopenedChange:function(){if(!this.searchList&&this.opened){var m=this.folderList,n=m.getSelectedItem(),o=this.rootFolder;if(n&&o&&n.did!==o.did){m.initialized=false;}this.addChildren([Z.call(this,{ondataChange:function(){if(this.data){this.getContent(this);}},ondblclick:this.dblClickOnNodes.bind(this)}),Z.call(this,{alias:"searchList",visible:false,contentRetrieved:true,ondblclick:this.dblClickOnNodes.bind(this)})]);}},reset:function(){if(this.contents){this.removeChildren(this.contents);}if(this.searchList){this.removeChildren(this.searchList);}},dblClickOnNodes:function N(n){var q=n.getTarget(),p=H.findWidget(q).data,o=this.model,m=o.getSelectedViUnit();if(m&&p&&V.indexOf(g,p.t)!==-1){this.dataProvider.loadObjects([p],{success:function(){var s=b.getCfgForAddUnitFromAllObject([p],o.datasets);if(m){m.getZonesModel().addUnitsFromDataSource([p],s.dsid,s.actions,o.getDatasetsUpdateCallback());}}},true);}},getSelectedItems:function K(){var n=this.contents,m=n.visible?n:this.searchList;return m.getSelectedItems();},getLayoutOffsets:function(){return{w:18,h:0};},children:[{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",cssClass:"vi-allObjects-tb",slot:"titlebarNode",alias:"titleBar",editTitleOnDoubleClick:false,getLayoutOffsets:function(){return{w:0,h:5};},onclick:function W(){this.close();},close:function(){this.parent.close();},bindings:{title:"this.parent.title"}},{scriptClass:"mstrmojo.ui.Pulldown",slot:"filterNode",alias:"folderList",initialized:false,getLayoutOffsets:function(){return{w:0,h:9};},onitemSelected:function(m){if(this.initialized){this.parent.set("rootFolder",m);this.parent.obSearchBox.clearSearch(true);}}},{scriptClass:"mstrmojo.ui.SearchBox",slot:"searchBox",alias:"obSearchBox",getLayoutOffsets:function(){return{w:0,h:13};},searchTriggered:function O(s){this.text=s;if(!s){this.clearSearch(true);return ;}var m=this.parent,p=m.contents.visible?m.contents:m.searchList,u=p.getSelectedItems(),n=m.folderList,o=this.parent.dataProvider,t=n.items[n.selectedIndex].did,q=this;u.forEach(function(w){if(w.t===8){t=w.did;return false;}});A.addClass(p.domNode,["loading"]);o.fetchFolderContents({browsableTypes:m.getObjectSubTypes().join(","),includeObjectDesc:true,folderLinksContextId:m.folderLinksContextId||29,blockCount:50,enableQuickSearch:!!(mstrApp.useQuickSearch&&mstrApp.useQuickSearch())},{fid:t,searchPattern:s,recursive:1},{success:function(w){A.removeClass(p.domNode,["loading"]);if(q.inputNode.value===s){m.contents.set("visible",false);m.searchList.set("visible",true);(m.searchList||this).set("items",w.items||[R]);m.updateScrollbars();}}});},onkeyup:function f(n){var m=n.hWin,o=n.e||m.event;if((mstrApp.useQuickSearch&&mstrApp.useQuickSearch())||((o.keyCode===13||o.keyCode===27||!this.inputNode.value))){this.constructor.prototype.onkeyup.call(this,n);}},postClearSearch:function(){var m=this.parent,o=m.contents,n=m.searchList;if(o){o.set("visible",true);}if(n){n.set("visible",false);}}}],getDropAvatarIcon:function C(m){return" ";},passToolbarCfg:function E(m){this.titleBar.set("toolbarCfg",m);},updateToolbar:function a(m){m.hasCloseButton=true;m.closeButtonText="";return m;},onhighlightItemsChange:function X(){var m=this.highlightItems;if(m){e(this.contents,m);e(this.searchList,m);}},setupScrollNodes:function d(){this.scrollNode=this.containerNode;},updateScrollbars:function(){this._super();if(this.scrollNode&&this.hasCustomScrollbar){var n=this.scrollNode,m=H.getComputedScrollbarWidth(n);n.style.marginRight=-m+"px";n.style.paddingRight=m+"px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.NewVisTooltip");var H=mstrmojo.array,G=mstrmojo.NewVisTooltip;mstrmojo.customviz._TooltipHelper=mstrmojo.provide("mstrmojo.customviz._TooltipHelper",{_mixinName:"mstrmojo.customviz._TooltipHelper",initTooltip:function F(){if(!this.tooltipWin){this.tooltipWin=this.addDisposable(new G());this.tooltipWin.render();}},showTooltip:function E(L,M){if(!mstrApp.isDisplayOnMobile){var J=this.tooltipWin,I=J&&J.domNode,K=this.getTooltipContent(L);if(!I.parentNode){document.body.appendChild(I);}J.showDossierTtp(K,M);}},hideTooltip:function A(I){if(!mstrApp.isDisplayOnMobile){if(this.tooltipWin){this.tooltipWin.hide(I===false?false:true);}}},getTooltipContent:function B(J){var K=J.additional&&J.additional.length||1,I;if(K===1){I=this.generateSimpleInfoObj(J);}else{I=this.generateGridInfoObj(J);}return I;},generateSimpleInfoObj:function C(O){var J=[],N=this,K,M=O.idValueMapping,I=O.additional,L={};if(I){L=I[0].idValueMapping;}H.forEach(this.tooltipObjsInOrder,function(P){if(P!=="seperate"){K=N.idTitleMapping[P];if(L[P]!==undefined){J.push({n:K,v:L[P]});}else{if(M[P]!==undefined){J.push({n:K,v:M[P]});}}}else{J.push(null);}});return J;},generateGridInfoObj:function D(N){var P=this,K={header:[],body:[]},J,M=N.idValueMapping,L=N.additional,Q;var I=function(){var R=K.header;H.forEach(P.tooltipObjsInOrder,function(S){if(S!=="seperate"){J=P.idTitleMapping[S];R.push(J);}});if(R.length>0){return true;}return false;},O=function(){var U=K.body,S,R;for(R=0;R<L.length;R++){S=[];U.push(S);Q=L[R].idValueMapping;H.forEach(P.tooltipObjsInOrder,function(V){if(V!=="seperate"){if(Q[V]!==undefined){S.push(Q[V]);}else{if(M[V]!==undefined){S.push(M[V]);}}}});}};if(!I()){return K;}O();return K;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Button","mstrmojo.EnumRWUnitType","mstrmojo.vi.models.VIComponentMap","mstrmojo.VisEnum","mstrmojo.gmaps.MapEnums","mstrmojo.models.template.DataInterface");mstrmojo.requiresDescs(15518,15519,15526);var G=mstrmojo.array,E=mstrmojo.hash,C=12,B=4,D="-1",I=1,H=2,J=-1,F=mstrmojo.Button.newWebButton,K=mstrmojo.vi.models.VIComponentMap.TYPES,A=mstrmojo.models.template.DataInterface;mstrmojo.vi.models._CheckDataCards=mstrmojo.provide("mstrmojo.vi.models._CheckDataCards",{_mixinName:"mstrmojo.vi.models._CheckDataCards",CARDLIMIT:mstrmojo.VisEnum.VIS_CARDLIMIT.NON_GRID,isUnitRestrictedInViz:function(){var Q=this.getHost&&this.getHost(),P=Q&&Q.defn,M=!!(P&&P.iifp);if(M){return false;}var L=this.docModel,N=[],O=L.getVIComponent(K.FILTER_PANEL),R=O&&O.parent;N=N.concat((R&&R.getFilterDefinitions())||[]);return N.length;},_addInLargeItems:[],_columnCardinalityCount:1,_totalRow:0,clearCardinalityFlags:function(){this._addInLargeItems=[];this._columnCardinalityCount=1;this._totalRow=0;},existLargeOrManyItems:function(){return(!!this._addInLargeItems.length||this._columnCardinalityCount>this.CARDLIMIT);},existLargeRowCount:function(){return(this._totalRow>mstrmojo.vi.models.editors.XtabEditorModel.ENUM_MAX_ROWS_OUTLINE);},findTotalColumnCount:function(Q,R){var S=this,V,N=1,P=0,U=this.getHost().gridData;S._columnCardinalityCount=1;if(U){if(R&&R.id===I){var L=U.rw,W=L&&L.row;S._columnCardinalityCount=(W&&W.tc)||1;return ;}var M=U.ghs,O=M&&M.chs;G.forEach(O&&O.items,function(X){if(X.items){N=Math.max(N,X.items.length);}});}G.forEach(Q,function(X){if(R&&R.id===H){R.items.every(function(Y){if(Y.t===C&&Y.did===X.did&&Y.card){P++;N=N/Y.card;return false;}return true;});}V=X.cardg>0?X.cardg:X.card;if(!V&&X.otp===C&&X.es){V=X.es.length+1;}if(V){N=N*V;}});S._columnCardinalityCount=(P===Q.length)?1:N;},findEstimatedTotalRow:function(R,N,M){var U=this,b,X=1,O=0,a=this.getHost&&this.getHost(),V=a.gridData,Z=this.docModel,S=Z&&Z.datasets;M=M||[];U._totalRow=1;function Q(e){var d=0;Object.keys(S).every(function(f){return S[f].att&&S[f].att.every(function(g){if(g.did===e){d=g.card;return false;}return true;});});return d;}function P(d){return R.some(function(e){return d.did===e.did;})||M.some(function(e){return d.did===e.did;});}if(V){var L=parseInt(E.walk("rhsCP.rc",a)||0,10);if(L>0){X=L;}else{var W=V.gsi||{},c=W.rows,Y=W.mx;G.forEach(c,function(d){if(P(d)){return ;}if(d.t===C){X*=Q(d.did)||1;}else{if(d.t===B){if(d.did===D&&Y){O=Y.length;G.forEach(Y,function(e){if(P(e)){O--;}});}}}});}}G.forEach(R,function(d){if(d.t===B){if(N===I||N===J){if(d.did===D&&V&&V.gsi.mx){O=V.gsi.mx.length;}else{O++;}}}b=d.cardg>0?d.cardg:d.card;if(!b&&d.otp===C&&d.es){b=d.es.length+1;}if(b){if(N===I){X=X*b;}}});X=X+X*O;U._totalRow=X;return X;},addAttributeNameAndTargetVisForAddUnits:function(S,Q,R,P,N){if(!S){return ;}var O={data:S},L=S&&S.vp,M;R=R||S&&S.vis&&S.vis.vn;P=P||L&&L.gtp;N=N||L&&L.ln;M=R===mstrmojo.vi.viz.EnumVizStyles.GOOGLE_MAP||R===mstrmojo.vi.viz.EnumVizStyles.ESRI_MAP||R===mstrmojo.vi.viz.EnumVizStyles.MAPBOX;G.forEach(Q,function(U){var W=U.id,V;if(W&&!U.attributeName){V=A.prototype.getUnitById.call(O,W);U.attributeName=V&&V.unit&&V.unit.n;}if(P===mstrmojo.gmaps.EnumGraphicType.Area&&M){if(!U.targetVis){U.targetVis={};}U.targetVis.vis=R;U.targetVis.gtp=P;U.targetVis.ln=N;}else{if(U.targetVis){U.targetVis=undefined;}}});},findLargeItemsForAddUnits:function(L,M,P){var O=this,Q,N={};if((!M&&!O.isUnitRestrictedInViz())||M){L.forEach(function(U){var R=U.cardg>0?U.cardg:U.card;Q=!!P?P:O.CARDLIMIT;if(U.targetVis&&U.targetVis.gtp===mstrmojo.gmaps.EnumGraphicType.Area){Q=mstrmojo.VisEnum.VIS_CARDLIMIT.AREA_MAP;}if(R&&R>Q){var V=U.attributeName||U.n;if(!N[V]){N[V]=true;var S=U.targetVis&&U.targetVis.ln?(V+"("+U.targetVis.ln+") ("+R+")"):V+" ("+R+")";O._addInLargeItems.push(S);}}});}},warnAndExecCallBackForOutlineAddUnits:function(N,M){var L=this,M=M||mstrmojo.emptyFn;if(this.existLargeRowCount()){mstrmojo.confirm(mstrmojo.desc(15792,"The dossier will attempt to display more than 5000 rows in outline mode. This may affect performance and stability. Do you want to continue?"),null,{id:"OutlineModeWarningDialog",title:mstrmojo.desc(11812,"Notification"),allowHTML:false,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(212,"Continue"),N),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),M)],onPreClose:function(){M();return true;}});}else{N();}},checkAndWarnForOutlineAddUnits:function(L,N,P,O,M){if(this.getHost().isOutlineMode){this.findEstimatedTotalRow(L,N,M);this.warnAndExecCallBackForOutlineAddUnits(P,O);}else{P();}},warnAndExecCallBackForAddUnits:function(S,Q,N,R){if(this.existLargeOrManyItems()&&!mstrApp.isAppStatePresentation()){var O=this._addInLargeItems,P=O.length,M;if(P>1){M=mstrmojo.desc(15518,"The following attributes contain a large number of elements: ##. This action may impact dossier performance.").replace("##",O);}else{if(P===1){M=mstrmojo.desc(15519,"The attribute ## has too many elements. This action may impact dossier performance.").replace("##",O);}else{M=mstrmojo.desc(15526,"The dossier will attempt to display more than ### columns. This can affect performance and stability.").replace("###",this.CARDLIMIT);}}var L=[];if(P&&Q){L.push(F(mstrmojo.desc(7977,"Move to Rows"),function(){Q();},true));}L.push(F(mstrmojo.desc(212,"Continue"),function(){S();}));L.push(F(mstrmojo.desc(2140,"Cancel"),function(){if(N){if(R){R();}else{if(mstrApp.isWorkstation&&mstrApp.isSingleTier){window.FormWrapper.closeWindow("{}");}else{mstrmojo._DocToolbarActions.close.call({model:{isnew:false}});}}}}));mstrmojo.warn(M,{},{buttons:L});O.splice(0,O.length);return ;}S();},checkAndWarnLargeItemsForAddUnits:function(O,S,Q,L,N,M,P,R){this.clearCardinalityFlags();if(!N||N.id===H){this.findLargeItemsForAddUnits(O,M,P);}if(L){this.findTotalColumnCount(O,N);}this.warnAndExecCallBackForAddUnits(S,Q,M,R);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.dom","mstrmojo.SimpleObjectInputBox");var D=mstrmojo.array,B=mstrmojo.dom,E=mstrmojo.Enum_Keys,A=mstrConfig.thousandsSep;var H={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};if(A===undefined){A=",";}var I;mstrmojo.TextBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{cssClass:"mstrmojo-TextBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",preBuildRendering:function G(){this.set("maxItemWidth",parseInt(this.parent.contentNode.style.width,10));this._super();},prekeydown:function C(J){var L=J.e;switch(parseInt(L.keyCode||L.charCode,10)){case E.TAB:case E.ENTER:B.preventDefault(J.hWin,L);var M=this.inputBox.value;if(M){if(D.find(this.items,"v",M)===-1){this.onSuggestionItemSelect({n:M,v:M});}else{this.setDefaultState();}}break;case E.ESCAPE:this.setDefaultState();break;case E.BACKSPACE:if(!this.getSearchPattern()){B.preventDefault(J.hWin,L);var K=this.items&&this.items.concat();if(K&&K.length){K.splice(K.length-1,1);this.set("items",K);var N=this.id;window.setTimeout(function(){mstrmojo.all[N].set("state",H.ADDING);},0);}}break;}},prekeyup:function F(J){}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.RaErrorHandler","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.SimpleObjectInputBox","mstrmojo._HasTooltip","mstrmojo.mstr.EnumDSSXMLObjectTypes");var O=mstrmojo.array,L=mstrmojo.RaErrorHandler,H=mstrmojo.dom,B=mstrmojo.Enum_Keys,Q=mstrmojo.hash,d=mstrmojo.mstr.EnumDSSXMLObjectTypes,R=mstrConfig.thousandsSep;if(R===undefined){R=",";}var K=2147762227,Y=2147762262,I=2147762269,M=140,P=118,Z=350,J=-100,X=-101,C=64;var W;mstrmojo.SearchBoxSelectorList=mstrmojo.declare(mstrmojo.SuggestionList,null,{postBuildRendering:function V(){var g=this._super(),e=this.parent,i=e.id;if(!this.onScroll){this.onScroll=function f(){var j=mstrmojo.all[i],k=j.domNode;if(!j.isFetching&&Math.ceil(k.offsetHeight+k.scrollTop)>=k.scrollHeight){j.isFetching=true;j.opener.getCandidatesThroughTaskCall({isIncFetch:true},{});}};}var h=e.domNode;if(e.supportsIncFetch){H.attachEvent(h,"scroll",this.onScroll);}else{H.detachEvent(h,"scroll",this.onScroll);}return g;},getItemMarkup:function(f,e){if(!W){W=this._super(f,e).replace(">{@"+this.itemField+"}<",">{@"+this.itemField+"}{@weight}<");}return W;},getItemProps:function c(g,e){var f=this._super(g,e),h=g.wt;f.weight=h?"<em>("+mstrmojo.num.addSeparators(h,R)+" "+this.parent.opener.wtStr+")</em>":"";return f;},onmouseover:function(g,h){var f=g.e.srcElement;if(f.scrollWidth<=f.offsetWidth){f.title="";}},onclick:function(f){var i=this.parent.opener.suggestionItems,e=i.length;this._super(f);if(e<=1){return ;}var g=O.find(i,"t",J),h=this.getItemFromTarget(f.getTarget());if(h&&h.t&&h.t===J){O.forEach(i,function(j,k){if(!this.selectedIndices[k]){this.doItemSelect(j,{});}},this);}else{if(this.selectedIndices[g]){this.doItemSelect(i[g],{});}}}});mstrmojo.SearchBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,[mstrmojo._HasTooltip],{scriptClass:"mstrmojo.SearchBoxSelector",cssClass:"mstrmojo-SearchBoxSelector",srcid:null,srct:d.Attribute,dataSourcesXML:null,useClientForm:false,maxItemWidth:"",wtStr:"likes",suggestionListClass:"mstrmojo.SearchBoxSelectorList",useRichTooltip:false,postCreate:function A(){var e=Q.clone(this.suggestionPopup);e.cssClass="mstrmojo-SearchBoxSelector-suggest";e.nudge=function(){var p=this.domNode,i=this.containerNode;if(!p){return ;}var m=Math.min(i&&i.offsetHeight||M,(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||M),f=p.offsetWidth,g=H.windowDim(),h=parseInt(this.left,10),k=parseInt(this.top,10);if(k+m>=g.h){k=Math.max(k-m-(this.target?this.target.offsetHeight:0),0);if(k+m>=g.h){k=5;m=H.getMaxScrollHeight();}}if(h+f>=g.w){h=Math.max(h-f,0);}var o=p.style;o.top=k+"px";o.left=h+"px";o.maxHeight=m+"px";var l=this.opener,n=l&&l.width,j=H.position(p).w;if(n!==undefined&&j<parseInt(n,10)&&o.maxWidth!==n){o.maxWidth=n;this.nudge();}};this.suggestionPopup=e;},preBuildRendering:function D(){var e=this.parent.contentNode.offsetWidth||this.parent.width;this.set("maxItemWidth",parseInt(e,10));this._super();},postBuildRendering:function V(){var e=this.parent.defn.fmts;if(!e.height){this.domNode.style.height="auto";}return this._super();},filterCandidates:function b(f,i,e){var j=f,g=this.suggestCount;if(!this.noCache){e=e||g;if(i==="*"){i="";}else{i=mstrmojo.string.regEscape(i);}var k=this.itemField,h=new RegExp(i,"i");j=O.filter(f,function(l){return h.test(l[k]);},{max:e});}if(j.length){O.forEach(this.items,function(m){var l=O.find(j,"v",m.v);if(l>-1){j.splice(l,1);}});}return j;},getCandidatesThroughTaskCall:function G(z,AD){var s=this.id,k=this.getSuggestionTarget(),o=z.pattern||"",n=o,l=this.parent,u=this.srcid,p=z.isIncFetch,m=this._last_hit,AB=this,x=false,j;if(p){o=z.pattern=m.pattern;}if(o===""||o.trim()==="%"){return ;}if(u){var AC={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:u,dataSourcesXML:this.dsrc||"",blockBegin:p?m.loadedCount:1,blockCount:this.items.length+this.suggestCount,searchPattern:o,rawInput:n,browseFlags:1,otp:this.srct},q=null;var g=l.defn;if(g.dsid){q={};q.datasetID=g.dsid;q.messageID=l.model.mid;q.ctlKey=l.ckey;}if(this.srct===d.Consolidation){AC.browseFlags=C;}var y=g.fs||g.sfs;if(y){var w="",i="";O.forEach(y,function(AE){w+=i+AE.did;i=";";});AC.searchForms=w;if(l.model.isnew||this.useClientForm){var AA="",e="",h=l.model,t=O.filterOne(h.getDatasetUnits(["att"]),function(AE){return AE.did===u;}),f=t.fs||[];O.forEach(y,function(AE){var AF=O.filterOne(f,function(AG){return AG.fid===AE.did;});AA+=e+AE.did+":"+(AF&&AF.bftp||0);e=";";});AC.clientFormPatterns=AA;}}AD.success=function(AM){var AI=mstrmojo.all[s],AG=AI&&AI.suggestionPopup,AL,AK,AO,AN,AF=z.pattern,AE=AI&&AI._searchQueue,AH=!AE||AE.length<=(p?0:1)||!AI.stifleIntermediateSearch;if(AI){if(AM&&AM.es){AL=AI.getSuggestionTarget();AK=AM.es.length;if(!AM||!AL||(k!==AL)){return ;}AO=AL.getSearchPattern();AN=AM.es;if(u){AN=mstrmojo.elementHelper.buildElemsTerseID(AN,u,true);}AI._last_hit={items:AN,pattern:AF,loadedCount:AM.bb+AK};AG.isFetching=false;if(AH){AG.supportsIncFetch=(AM.bb+AM.bc)<AM.sz;if(AO&&AO.indexOf(AF)>-1){var AJ=AI.filterCandidates(AN,AO);AI.updateSuggestion(p?AI.suggestionItems.concat(AJ):AJ);}if(AI.inputBox){AI.inputBox.focus();}if(!AI._ListenerProc){AI._ListenerProc=function(){var AP=AI.suggestionPopup;if(AP.visibile){AP.nudge();}};H.attachEvent(window,"resize",AI._ListenerProc);}}}else{if(AH){AI.updateSuggestion([]);}}}};AD.failure=function(AF){var AH=mstrmojo.all[s],AE=parseInt(AF.code,10)+4294967296,AG=(AE===K||AE===Y||AE===I);L.handleRAPopUpError(AF);if(AH&&AH.failMessage){AH.failMessage(AG?{errCode:AE,msg:AF.message}:{});}};AD.complete=function(){var AF=AB._searchQueue,AE=AF&&AF.pop();mstrApp.hideWait();if(AF&&AF.length&&AB.showSuggestion){AB._searchQueue=[];AB.showSuggestion(AE);}};if(this.hitEnterToTest){if(p&&this.onIncrementalFetch){this.onIncrementalFetch();}mstrApp.showWait({message:mstrmojo.desc(15823,'Searching "#"...').replace("#",o)});}else{if(!p){j=this._searchQueue;x=j&&j.length;if(!j){this._searchQueue=[];}this._searchQueue.push(o);}}if(!x){mstrmojo.elementHelper.browseElements(AD,AC,q);}}},destroy:function a(e){if(this._ListenerProc){H.detachEvent(window,"resize",this._ListenerProc);delete this._ListenerProc;}this._super(e);},onsuggestionItemsChange:function F(){var i=this.suggestionItems,f=this.suggestionPopup,h=f.editorNode,m=i&&(i.length>8),l="",j="";if(m){l=(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||M;j="px";}if(h){h.style.maxHeight=l+j;}else{if(m){j+=";";f.cssText=(f.cssText||"")+"max-height:"+l+j;}}if(mstrApp.isExpress){var g=this.parent.contentNode.offsetWidth,e=(g===null||P<g)?P:g,k=(g===null||Z>g)?Z:g;f.cssText=(f.cssText||"")+"min-width:"+e+"px; max-width:"+k+"px;";}},getSuggestionPos:function S(){var e=this._super();if(e){e.lockIW=this;}return e;},updateSuggestion:function U(f){var e=f&&f.length;this.autoSelect=true;this.set("disableClick",false);if(this.parent.defn.multi&&e&&e>1){f=O.filter(f,function(h){return(h.v!=="u;"&&h.t!==14)&&(h.t!==J);});f.unshift({n:mstrmojo.desc(13976,"(All search results)"),t:J});this.autoSelect=false;}if(!e){f=[{n:mstrmojo.desc(13779,"No elements match your search"),t:X,cls:"nomatch"}];}if(f.length===1&&f[0].t===X){this.autoSelect=false;this.set("disableClick",true);}this._super(f);var g=this;g.mw=g.mw||function(k){var h=g._lastOpened;if(!h||!h.visible){H.detachEvent(document,H.isFF?"DOMMouseScroll":"mousewheel",g.mw);return ;}var j=H.eventTarget(self,k);var i=h.domNode;if(!H.contains(i,j,true,document.body)){h.close();H.detachEvent(document,H.isFF?"DOMMouseScroll":"mousewheel",g.mw);}};H.attachEvent(document,H.isFF?"DOMMouseScroll":"mousewheel",g.mw);},handleSuggestionItemSelect:function N(f,g){if(O.isArray(f)||f.t===J){f=O.ensureArray(f);var e=O.filter(f,function(h){return h.t!==J;});if(e.length<f.length){e=O.filter(this.suggestionItems,function(h){return h.t!==J;});}this.onSuggestionItemSelect(e);}else{this._super(f,g);}},prekeydown:function E(n){this._super(n);var k=n.e,o=(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||M,i=8,g=o/i;var h=this.getSelected();if(h){var j=h._renderIdx,f=(j-i+1)*g,m=(j-1)*g,l=this.suggestionPopup.domNode.scrollTop;switch(parseInt(k.keyCode||k.charCode,10)){case B.DOWN_ARROW:if(l<=f){this.suggestionPopup.domNode.scrollTop=f;}else{if(l>m){this.suggestionPopup.domNode.scrollTop=m;}}break;case B.UP_ARROW:if(l<=f||l>m){this.suggestionPopup.domNode.scrollTop=m;}break;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.gmaps.MapUtils","mstrmojo.gmaps.MapEnums");var R=mstrmojo.gmaps,J=R.MapUtils,N=R.EnumGeographicRole,F=R.EnumBaseMapType,L=R.EnumPolygonSource,I=R.EnumThresholdType,Q="4-s",G=R.CustomShapeId;function D(S){return !!(S&&S.custom&&(S.custom==="true"||S.custom===true));}mstrmojo.gmaps._AreaMapHelper=mstrmojo.provide("mstrmojo.gmaps._AreaMapHelper",{_mixinName:"mstrmojo.gmaps._AreaMapHelper",getAvailableShapes:function C(S,a,Y,Z){var W=[],V,X,U;if(!S||Y==undefined){return W;}if(Z===F.Mapbox){return this.getShapesForMapbox(S,a);}for(X=0,U=S.length;X<U;X++){V=S[X];if(J.isWSLocalMode()&&D(V)){continue;}if(Z!==F.Esri&&!D(V)){continue;}if(this.isMapBoxShapeConfig(V,a)){continue;}if(Y===N.EnumGeographicRoleNone||Y===N.EnumGeographicRoleGeometry||Y===N.EnumGeographicRoleOther&&D(V)||Y==V.roleId){W.push(V);}}return W;},getShapesForMapbox:function E(S,Y){var W=[],V,X,U;for(X=0,U=S.length;X<U;X++){V=S[X];if(this.isMapBoxShapeConfig(V,Y)){V.supportedGeoRoles=[V.roleId];if(V.roleId===N.EnumGeographicRoleCity){V.supportedGeoRoles.push(N.EnumGeographicRoleCounty);}W.push(V);}}return W;},getPolygonSource:function B(S,U,V,Y){var W=S&&S.data,Z=W&&W.vp,a=Z&&Z.lid,X,b;if(!Z){return L.Cloud;}if(!!a){X=this.getMatchingShape(U,a,null);}else{b=this.getShapeAttributeGeoRole(W,S.dropZones.geoAttribute);U=this.getAvailableShapes(U,V,b,Y);X=this.getMatchingShape(U,null,b);}if(!!X){if(!a){Z.lid=X.id;}if(D(X)){if(this.isMapBoxShapeConfig(X,V)){if(X.id===G){return L.MapboxCustomShape;}return L.MapBoxPolygon;}return L.Custom;}}return L.Cloud;},isMapBoxShapeConfig:function P(S,X){var V,U,W=(X&&X.length)||0;for(V=0;V<W;V++){U=X[V];if(S.layerId===U.id){return parseInt(U.scope)===parseInt(F.Mapbox);}}return false;},isMapboxStatisticalShape:function O(S,X){var V,U,W=(X&&X.length)||0;for(V=0;V<W;V++){U=X[V];if(S&&S.layerId===U.id){return U.scope===Q;}}return false;},getShapeAttributeGeoRole:function H(X,Z){var U=X.gts,e=U&&U.row,S,d,c,Y,b,V,W,a=false;if(!e||!e.length){return ;}b=e.length;if(!!Z){for(Y=0;Y<b;Y++){c=e[Y];if(c.id!==Z){continue;}S=c.fs;for(V=0,W=S.length;V<W;V++){d=S[V].fgr;if(d==undefined){continue;}d=d.toString();if(d!==N.EnumGeographicRoleNone&&d!==N.EnumGeographicRoleLatitiude&&d!==N.EnumGeographicRoleLongitude){a=true;break;}}if(a){break;}}}else{for(Y=0;Y<b;Y++){c=e[Y];S=c.fs;for(V=0,W=S.length;V<W;V++){d=S[V].fgr;if(d!==N.EnumGeographicRoleNone&&d!==N.EnumGeographicRoleLatitiude&&d!==N.EnumGeographicRoleLongitude){break;}}}}return d;},getMatchingShape:function K(U,Y,b){var W,X,a,S,V,Z;if(!U){return null;}if(b===N.EnumGeographicRoleNone){b=null;}if(!!Y){for(V=0,Z=U.length;V<Z;V++){if(U[V].id==Y){W=U[V];break;}}}else{if(!!b){for(V=0,Z=U.length;V<Z;V++){S=U[V];if(D(S)&&(S.roleId==b||(S.supportedGeoRoles&&S.supportedGeoRoles.indexOf(b)>-1))){if(!X){X=S;}if(!!S["default"]&&(S["default"]+"").toLowerCase()==="true"){W=S;break;}}else{if(!a&&S.roleId==b&&!!S["default"]&&(S["default"]+"").toLowerCase()==="true"){a=S;}}}if(!W){if(!!X){W=X;}else{if(!!a){W=a;}}}}}return W;},getShape4MapboxSecondGeoAttr:function A(U,V,Z,c){var S,X,W,a,b,Y;U=this.getAvailableShapes(U,V,N.EnumGeographicRoleOther,F.Mapbox);a=(U&&U.length)||0;X=this.getMatchingShape(U,Z,null);for(W=0;W<a;W++){S=U[W];if(S.roleId==c||(S.supportedGeoRoles&&S.supportedGeoRoles.indexOf(c)>-1)){if(c==N.EnumGeographicRoleCountry){return S;}b=this.isMapboxStatisticalShape(X,V);Y=this.isMapboxStatisticalShape(S,V);if(b===Y){return S;}}}return null;},populateColorBy:function M(Z,S,b,V){if(!!S&&S.length===1&&S[0].otp===-1){var Y=Z[b].items,U=S[0].es;for(var W=0,d=Y.length;W<d;W++){var a=Y[W],e=U[W].n,f=a.v,c=a.ty;if(!c||c===I.Number){V[J.replaceSpace(e)]=f;}else{V[J.replaceSpace(e)]=Y[W].rv;}}}if(this.isColorByAttr===true){this.populateColorInfo(V);}var X=this.getThresholdInfo(b,this.colorMetricIdx);if(!!X){V.threshold=X;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.num","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.color","mstrmojo.chart","mstrmojo.chart.common.Utility");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumGraphMajorType");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphObject");var o=mstrmojo,B=o.css,p=mstrmojo.array,Q=mstrmojo.hash,I=mstrmojo.num,H=mstrmojo.VisUtility,c=mstrmojo.chart,L=c.enums,d=L.EnumGraphMajorType,K=c.common.Utility,V=c.model,N=V.enums,y=N.EnumDSSGraphObject,AC=mstrmojo.VisEnum.ControlType,z=o.gm,W=mstrmojo.gm.EnumTextAlignH,s=mstrmojo.gm.EnumTextAlignV,x=";",k=",",A="_tmsp",M=" ",a=-20,l=mstrmojo.gm.EnumSelectionOptionLevel,AE=mstrmojo.gm.EnumShape,h=mstrmojo.color,J=mstrmojo.gm.EnumIdentityType,S=0.00001,E,b=Math.pow(2,30),e=Math.pow(2,60);var g=["Reserved",mstrmojo.desc(2125,"Maximum"),mstrmojo.desc(2127,"Minimum"),mstrmojo.desc(2122,"Average"),mstrmojo.desc(2126,"Median"),mstrmojo.desc(4046,"First"),mstrmojo.desc(4049,"Last"),mstrmojo.desc(7194,"Constant")];function m(AK,AJ){var AL,AI=AK.length;if(AI!==AJ.length){return false;}for(AL=0;AL<AI;AL++){if(AK[AL]!==AJ[AL]){return false;}}return true;}function AD(AL,AJ,AM){var AK=false,AN=AM+A,AI=AL[AN],AO=AJ[AN];if(AJ[AM]===undefined){AK=true;}else{if((AO===undefined&&AI!==undefined)||(AO!==undefined&&AI!==undefined&&AO<AI)){AK=true;}}if(AK){AJ[AM]=AL[AM];if(AO!==undefined){AJ[AN]=AI;}}}function AH(AJ,AI){var AK;for(AK in AJ){if(AJ.hasOwnProperty(AK)){AD(AJ,AI,AK);}}return AI;}function Y(AM){var AL={},AK,AJ=[],AI;p.forEach(AM,function(AN){if(AN!==undefined){AJ.push(AN);}});AI=AJ.length;if(AI===1){return AJ[0];}for(AK=0;AK<AI;AK++){AH(AJ[AK],AL);}return AL;}function AB(AI){return{n:AI,s:AI.toString(),on:AI};}function Z(AK,AI,AM){if(AI===AK){return 0;}var AJ=AI-AK,AL=1;while(AJ<1){AJ*=10;AL/=10;}while(AJ>=10){AJ/=10;AL*=10;}if(AJ<1.8){AL*=0.2;}else{if(AJ<3.1){AL*=0.4;}else{if(AJ<4.6){AL*=0.5;}else{if(AJ>=8.1){AL*=2;}}}}if(AM){AL=Math.round(AL);if(AL<1){AL=1;}}return AL;}function C(AL,AP,AR,AJ){var AN=[];if(AL===AP){if(AL<0){AN.push(mstrmojo.gm.GMUtility.formatNumber(AL,"nearest"));}AN.push({n:0,s:"0",on:0});if(AL>0){AN.push(mstrmojo.gm.GMUtility.formatNumber(AL,"nearest"));}return AN;}var AI=AJ>0?AJ:Z(AL,AP,AR);var AK=Math.ceil(AP/AI)*AI;if(AK-AP>=AI*0.9){AK=Math.floor(AP/AI)*AI;}var AO=Math.floor(AL/AI)*AI;if(AL-AO>=AI*0.9){AO=Math.ceil(AL/AI)*AI;}var AQ=Math.floor((AK-AO+AI/100)/AI)+1,AM;for(AM=0;AM<AQ;++AM){AN.push(mstrmojo.gm.GMUtility.formatNumber(AO+AM*AI,"nearest"));}return AN;}function U(AI,AL){var AK;AI.mMaxTick=1;if(this.mChartContextPtr.mIsGraphMatrix){AI.mStep=this.mMinimum<0?0.2:0.1;if(AL.mUseCustomMinMax){var AJ=AL;AI.mMaxTick=AJ.mAxisMaxValue;AI.mMinTick=AJ.mAxisMinValue;AI.mMaxTick=Math.min(1,AI.mMaxTick);AI.mMinTick=Math.max(-1,AI.mMinTick);AI.mStep=0.1;}else{if(this.mMaximum>=0.5){AI.mMaxTick=1;AI.mMinTick=Math.floor(this.mMinimum/AI.mStep)*AI.mStep;AI.mMinTick=(AI.mMinTick*this.mMinimum<0)?0:(AI.mMinTick>0?0:AI.mMinTick);if(this.mMinimum<-0.5){AI.mMinTick=-1;}}else{if(this.mMaximum>0){AI.mMaxTick=Math.ceil(this.mMaximum/AI.mStep)*AI.mStep;AI.mMinTick=-1;}else{AI.mStep=0.1;AI.mMaxTick=0;AI.mMinTick=-1;}}}}else{AI.mMinTick=(this.mMinimum<0)?-1:0;if(w.call(this,AI)){return ;}AI.mStep=this.mMajorGrid.mUseManualGrid?this.mMajorGrid.mGridInterval:(AI.mMaxTick-AI.mMinTick)/10;}for(AK=AI.mMinTick+AI.mStep;AK+c.gModuleMain.mTolerance<AI.mMaxTick;AK+=AI.mStep){AI.mTicks.push(Math.round(AK*100)/100);}}function P(AI,AN){var AM,AJ,AP=AN,AO=AP.mDrawCustomLine,AK=AP.mAxisCustomValue,AL;AI.mStep=1;if(this.mMaximum<=0){AI.mMinTick=1;AI.mMaxTick=10;if(AO&&AK<=1){AP.mAxisCustomValue=AI.mMinTick;}return ;}if(this.mMinimum<=0){AJ=this.mMaximum>1?0:-1;AI.mMinTick=Math.pow(10,AJ);if(AP.mUseCustomMinMax){AI.mMaxTick=this.mMaximum;AM=Math.floor(i.call(this,this.mMaximum));if(i.call(this,this.mMaximum)===AM){AM--;}}else{AM=Math.ceil(i.call(this,this.mMaximum));AI.mMaxTick=Math.pow(10,AM);}for(AL=AJ+1;AL<AM;++AL){AI.mTicks.push(Math.pow(10,Math.floor(AL)));}if(AO&&AK<=0){AP.mAxisCustomValue=Math.max(AI.mMinTick,AP.mAxisCustomValue);}return ;}if(AP.mUseCustomMinMax){AM=i.call(this,this.mMaximum);AJ=i.call(this,this.mMinimum);AI.mMaxTick=this.mMaximum;AI.mMinTick=this.mMinimum;}else{AM=Math.ceil(i.call(this,this.mMaximum));AJ=Math.floor(i.call(this,this.mMinimum));AI.mMaxTick=Math.pow(10,AM);AI.mMinTick=Math.pow(10,AJ);}for(AL=AJ+1;AL<AM;++AL){AI.mTicks.push(Math.pow(10,Math.floor(AL)));}if(AO&&AK<=0){AP.mAxisCustomValue=AI.mMinTick;}}function t(AS,AN){var AK=AN,AI,AL;AS.mStep=f.call(this,this.mMaximum,this.mMinimum,AK.mAlwaysIncludeZero);AS.mMaxTick=Math.ceil(this.mMaximum/AS.mStep)*AS.mStep;AS.mMinTick=Math.floor(this.mMinimum/AS.mStep)*AS.mStep;AS.mMaxTick=AS.mMaxTick<this.mMaxmum?this.mMaxmum:AS.mMaxTick;AS.mMinTick=AS.mMinTick>this.mMinimum?this.mMinimum:AS.mMinTick;AS.mMinTick=(AS.mMinTick*this.mMinimum<0)?0:AS.mMinTick;if(AK.mAlwaysIncludeZero){AS.mMaxTick=(this.mMaximum<0)?0:AS.mMaxTick;AS.mMinTick=(this.mMinimum>0)?0:AS.mMinTick;}var AM=AS.mMaxTick-AS.mMinTick;if(AS.mStep>=AM){return ;}if(w.call(this,AS)){return ;}AI=Math.floor((AS.mMaxTick-AS.mMinTick+AS.mStep/100)/AS.mStep)+1;var AO=this.mNumberFormat;for(AL=1;AL<AI-1;++AL){var AQ=AS.mMinTick+AL*AS.mStep,AR,AJ,AP;if(AS.mStep<1&&AO.mFormatType===4&&AO.mCustomFormat.indexOf("%")!==-1){AR=AQ*100;if(!K.isIntegar(AR)){AJ=Math.round(AR);AP=Math.abs(AR-AJ);if(AP<S){AQ=AJ/100;}}}AS.mTicks.push(AQ);}}function D(AS,AM){var AR=AM,AL,AI,AP,AK,AO,AN,AJ,AQ;AS.mMaxTick=AR.mAxisMaxValue;AS.mMinTick=AR.mAxisMinValue;if(w.call(this,AS)){return ;}if(!X.call(this)||this.mMajorGrid.mUseManualGrid){AS.mStep=f.call(this,AS.mMaxTick,AS.mMinTick,false);AL=AS.mMaxTick-AS.mMinTick;if(AS.mStep>=AL){return ;}AI=Math.floor(AL/AS.mStep);if(!(this.mChartContextPtr.mIsTimeSeriesChart)&&AL===AI*AS.mStep){for(AK=1;AK<AI;++AK){AS.mTicks.push(AS.mMinTick+AK*AS.mStep);}}else{AL=AS.mMaxTick-AS.mMinTick;AP=10;AO=false;for(AK=3;AK<AI;++AK){AN=AL/AK;while(AN<1){AN*=10;}while(AN>=10){AN/=10;}if(AN===Math.floor(AN)){AP=AK;AO=true;break;}}if(AO){AS.mStep=AL/AP;for(AK=1;AK<AP;++AK){AS.mTicks.push(AS.mMinTick+AK*AS.mStep);}}else{AJ=Math.ceil((AS.mMinTick+AS.mStep/100)/AS.mStep)*AS.mStep;AQ=Math.floor((AS.mMaxTick-AS.mStep/100-AJ)/AS.mStep)+3;for(AK=0;AK<AQ-2;++AK){AS.mTicks.push(AJ+AK*AS.mStep);}}}}else{AL=AS.mMaxTick-AS.mMinTick;AP=10;for(AK=6;AK<=9;++AK){AN=AL/AK;while(AN<10){AN*=10;}while(AN>=100){AN/=10;}if(AN===Math.floor(AN)){AP=AK;break;}}AS.mStep=AL/AP;for(AK=1;AK<AP;++AK){AS.mTicks.push(AS.mMinTick+AK*AS.mStep);}}}function F(AI,AM){var AL,AJ,AK;AI.mMaxTick=AM.mAxisMaxValue;if(AI.mMaxTick<=this.mMinimum){this.mMinimum=AI.mMaxTick-1;}AI.mStep=f.call(this,AI.mMaxTick,this.mMinimum,AM.mAlwaysIncludeZero&&(AI.mMaxTick>0));AL=(AM.mAlwaysIncludeZero&&(this.mMinimum>0))?0:this.mMinimum;if(X.call(this)){AI.mMinTick=AI.mMaxTick-Math.ceil((AI.mMaxTick-AL)/AI.mStep)*AI.mStep;}else{AI.mMinTick=Math.floor(AL/AI.mStep)*AI.mStep;}if(w.call(this,AI)){return ;}AJ=Math.floor((AI.mMaxTick-AI.mStep/100-AI.mMinTick)/AI.mStep)+2;for(AK=1;AK<AJ-1;++AK){AI.mTicks.push(AI.mMinTick+AK*AI.mStep);}}function j(AI,AN){var AJ,AM,AK,AL;AI.mMinTick=AN.mAxisMinValue;if(AI.mMinTick>=this.mMaximum){this.mMaximum=AI.mMinTick+1;}AI.mStep=f.call(this,this.mMaximum,AI.mMinTick,AN.mAlwaysIncludeZero&&(AI.mMinTick<0));AJ=(AN.mAlwaysIncludeZero&&(this.mMaximum<0))?0:this.mMaximum;if(X.call(this)){AI.mMaxTick=AI.mMinTick+Math.ceil((AJ-AI.mMinTick)/AI.mStep)*AI.mStep;}else{AI.mMaxTick=Math.ceil(AJ/AI.mStep)*AI.mStep;}if(w.call(this,AI)){return ;}AM=Math.ceil((AI.mMinTick+AI.mStep/100)/AI.mStep)*AI.mStep;AK=Math.floor((AI.mMaxTick-AM+AI.mStep/100)/AI.mStep)+2;for(AL=0;AL<AK-2;++AL){AI.mTicks.push(AM+AL*AI.mStep);}}function f(AY,AS,AK){var AR,AM;if(this.mMajorGrid.mUseManualGrid){return this.mMajorGrid.mGridInterval;}AR=0;if(AK){AR=Math.max(AY,AY-AS);AR=Math.max(AR,-AS);}else{AR=AY-AS;}if(AR===0){this.mIsShown=false;return 1;}if(AR>=1&&AR<=4&&parseInt(AR)===AR){var AZ=this.PrimaryMetricIndex,AN=AZ.length;for(var AU=0;AU<AN;AU++){var AQ=this.mChartContextPtr.mDatasetPtr,AT=AQ.dataProvider,AL=AT.getSeriesCount(),AP=AT.getGroupCount(),AJ=AZ[AU],AO,AW;for(var AX=0;AX<AL;AX++){AO=AT.getMetricIndexForSeries(AX);if(AO===AJ){AW=true;for(var AV=0;AV<AP;AV++){var Aa=AQ.GetData(AX,AV);if(parseInt(Aa)!==Aa){AW=false;break;}}}if(AW){return 1;}}}}var AI=AR;AM=1;while(AR<1){AR*=10;AM/=10;}while(AR>=10){AR/=10;AM*=10;}if(AR<1.8){AM*=2;AM/=10;}else{if(AR<3.1){AM*=4;AM/=10;}else{if(AR<4.6){AM*=5;AM/=10;}else{if(AR>=8.1){AM*=2;}}}}AM=this.postProcessStep(AM,AI);return AM;}function w(AI){if(this.mChartContextPtr.mIsGraphMatrix){return false;}var AJ=this.mMajorGrid;return AJ.mUseManualGrid&&(AJ.mGridInterval<(AI.mMaxTick-AI.mMinTick)/30);}function i(AI){return Math.log(AI)/Math.log(10);}function X(){return(this.mGraphMajorType===d.GMT_HISTOGRAM||this.mGraphMajorType===d.GMT_POLAR)&&this.mTripleId.mObjectId===y.DssGraphX1Body;}function AA(AL){var AM=this,AI=AM.id,AK=AL.metricId,AJ=new o.ui.menus.MenuConfig();(AL.options).forEach(function(AN){if(AN!==z.EnumRefLineModelType.CONST){AJ.addMenuItem(g[AN],"xt",function(){AM.toggleRefLineEnabled(AK,AN,true);});}else{AJ.addEditorMenuItem(g[z.EnumRefLineModelType.CONST],AI,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},contents:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"constVal",dtp:mstrmojo.expr.DTP.FLOAT,constraints:{trigger:mstrmojo.validation.TRIGGER.ONBLUR},onEnter:function(){this.validate();}}],fnOk:function(AP,AO){var AQ=AO.constVal;if(AQ.isValid()){AM.toggleRefLineEnabled(AK,AN,true,AQ.value);}}});});}});return AJ;}function u(AK){var AL=this,AJ=AK.metricId,AI=new o.ui.menus.MenuConfig();(AK.options).forEach(function(AO){var AM=AO.refType,AN=g[AM]+((AM===z.EnumRefLineModelType.CONST)?("-["+I.toLocaleString(AO.c)+"]"):"");AI.addMenuItem(AN,"xt",function(){AL.toggleRefLineEnabled(AJ,AM,false,0,AO.modix);});});return AI;}function AF(AM,AI){var AL=AM.GMController,AJ=AL.getForbiddenShapeForMetric(AI),AK=[];[{text:mstrmojo.desc(12097,"Bar"),value:AE.BAR},{text:mstrmojo.desc(2059,"Line"),value:AE.LINE},{text:mstrmojo.desc(9738,"Area"),value:AE.AREA},{text:mstrmojo.desc(12100,"Circle"),value:AE.CIRCLE},{text:mstrmojo.desc(12101,"Square"),value:AE.SQUARE},{text:mstrmojo.desc(12102,"Tick"),value:AE.TICK}].forEach(function(AN){if(AJ.indexOf(AN.value)<0){AK.push(AN);}});if(AL.chartType===mstrmojo.gm.EnumGraphType.BAR||AL.chartType===mstrmojo.gm.EnumGraphType.LINE){AK=AK.filter(function(AN){return AN.value!==AE.AREA;});}return AK;}function q(AJ,AI){return function(AL,AK){if(AL!==AK){AI({ctxt:{sp:AL,mid:AJ}});}};}function AG(AL){var AJ=AL.options,AI=this.getMenuHandler("changeShape"),AK=new mstrmojo.ui.menus.MenuConfig();AK.addRadioMenuGroup(AL.currValue,q(AL.metricId,AI),AJ,"checkMark",undefined,true);return AK;}mstrmojo.gm.GMUtility=mstrmojo.provide("mstrmojo.gm.GMUtility",{mTimers:[],mUseTimer:true,timerId:0,timerHistory:[],timerHistoryMax:50,startTimer:function R(AJ){if(this.mUseTimer){var AI=this.timerId++;this.mTimers.push({timeStamp:new Date(),timerId:AI,desc:AJ.functionName+": "+AJ.purpose});return AI;}},endTimer:function G(AM,AO){if(this.mUseTimer){var AJ,AK=this.mTimers,AP=0;if(AM===undefined){AJ=AK.pop();}else{var AN,AQ;for(AN=0;AN<AK.length;AN++){AQ=AK[AN];if(AQ.timerId===AM){AJ=AQ;AK.splice(AN,1);AN--;}}}if(AJ){var AI=new Date();var AL=(AI-AJ.timeStamp);if(AO){this.timerHistory[this.timerId%this.timerHistoryMax]={desc:AJ.desc,duration:AL,start:AJ.timeStamp.getTime(),end:AI.getTime()};}H.visPrint("%c"+AJ.desc+": "+AL+"ms","color: blue");AP=new Date()-AJ.timeStamp;}return AP;}},computeTicksForPercentchart:function(AJ,AI,AK){return C(AJ,AI,false,AK);},computeTicksForFlexMinMax:function(AJ,AI,AK,AL){return C(AJ,AI,AK,AL);},formatNumber:function(AK,AJ,AI){return AB(AK,AJ,AI===undefined?3:AI);},sizeCalculator:{sum:function(AI,AM,AN){var AK,AJ=0,AL=0;if(AN===undefined){AN=AI.length;}AM=AM||1;for(AK=0;AK<AN;AK++){if(AI[AK]>0){AL+=AI[AK];AJ+=1;}}if(AJ>1){AL+=(AJ-1)*AM;}return AL;},add:function(AK,AI,AJ){AJ=AJ||1;if(AI>0){AK+=(AI+AJ);}return AK;},minus:function(AK,AI,AJ){if(AI>0){AK-=(AI+AJ);}return AK;}},replaceSpecialChars:function(AI){return AI.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");},restoreSpecialChars:function(AI){return AI.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&amp;/g,"&");},removeExtraSpace:function(AI){return AI.replace(/ {2,}/g," ");},stringToJSON:function(AI){if(AI===undefined){return undefined;}if(typeof AI==="string"){AI=AI.replace(/'/g,'"');try{return JSON.parse(AI);}catch(AJ){return AI;}}return AI;},everythingToString:function(AJ){if(AJ===undefined){return undefined;}var AI;if(typeof AJ==="object"){AI=JSON.stringify(AJ.jsonObj||AJ);}else{AI=AJ.toString();}AI=AI.replace(/"/g,"'");return AI;},compareElementObj:function(AM,AJ){var AL=AM.tid.toString(),AI=AJ.tid.toString(),AN=AM.eid,AK=AJ.eid;if(AL!==AI){return AL>AI?1:-1;}if(AN===AK){return 0;}return AN>AK?1:-1;},isEqualComb:function(AJ,AI){var AN=true,AM,AL=AJ.length,AK=AI.length;if(AL!==AK){return false;}if(AJ.length>1){AJ.sort(this.compareElementObj);}if(AI.length>1){AI.sort(this.compareElementObj);}for(AM=0;AM<AL;AM++){if(this.compareElementObj(AJ[AM],AI[AM])!==0){AN=false;break;}}return AN;},serializeCombination:function(AJ){var AI="";if(AJ.length>1){AJ.sort(this.compareElementObj);}p.forEach(AJ,function(AK){if(AI!==""){AI+=x;}AI+=(AK.tid+k+AK.eid);});return AI;},deserializeCombination:function(AJ){var AK=AJ.split(x),AI=[];p.forEach(AK,function(AO){var AL=AO.split(k);var AN=AL[0];var AM=AL[1];AI.push({tid:AN,eid:AM});});return AI;},getElementCombinationForMetric:function(AI){var AJ=[];AJ.push({tid:-1,eid:AI});return AJ;},getResolvedFormatsObject:function(AI){return Y(AI);},isDigitalArrayEqual:function(AJ,AI){return m.call(this,AJ,AI);},indexOf:function(AJ,AL){var AK,AI=AJ.length;for(AK=0;AK<AI;AK++){if(m(AJ[AK],AL)){return AK;}}return -1;},parseAxisScaleData:function(AM){var AK,AN,AJ,AI=AM.split(","),AL=[];for(AK=0,AN=AI.length;AK<AN;AK++){AJ=AI[AK].split(":");AL.push(AJ);}return AL;},parseCSSColor:function(AM,AJ){var AL=AM.slice(1),AI=[],AK;if(AL.length===6){if(AJ===true){AI[0]=AL[4];AI[1]=AL[5];AI[2]=AL[2];AI[3]=AL[3];AI[4]=AL[0];AI[5]=AL[1];}else{for(AK=0;AK<6;AK++){AI[AK]=AL[AK];}}}else{if(AJ===true){for(AK=2;AK>=0;AK--){AI.push(AL[AK]);AI.push(AL[AK]);}}else{for(AK=0;AK<3;AK++){AI.push(AL[AK]);AI.push(AL[AK]);}}}return parseInt("0x"+AI.join(""),16);},RGB_BRG_Switch:function(AJ){var AL=(AJ>>16)&255,AK=(AJ>>8)&255,AI=(AJ>>0)&255;return(AI<<16)|(AK<<8)|(AL<<0);},encodeColor:function(AJ){if(AJ===undefined||AJ===null||AJ==="transparent"||AJ==="default"){return AJ;}var AK=false,AI={};if(AK){if(typeof AJ==="object"){AI.c1=this.RGB_BRG_Switch(h.encodeColor(AJ.c1));AI.c2=this.RGB_BRG_Switch(h.encodeColor(AJ.c2));AI.or=AJ.or;return AI;}return this.RGB_BRG_Switch(h.encodeColor(AJ));}if(typeof AJ==="object"){AI.c1=h.encodeColor(AJ.c1);AI.c2=h.encodeColor(AJ.c2);AI.or=AJ.or;return AI;}return h.encodeColor(AJ);},checkEquality:function(AJ,AI){if(typeof AJ==="object"&&AJ.c1!==undefined){if(AJ.c1!==AI.c1){return false;}if(AJ.c2!==AI.c2){return false;}if(AJ.or!==AI.or){return false;}return true;}return AJ===AI;},ptToPx:function(AI){return AI&&Math.ceil(parseInt(AI,10)/72*96);},decodeColor:function(AJ){if(AJ===undefined||AJ===null||AJ==="transparent"||AJ==="default"){return AJ;}var AK=false,AI={};if(AK){if(typeof AJ==="object"){AI.c1=h.decodeColor(this.RGB_BRG_Switch(AJ.c1));AI.c2=h.decodeColor(this.RGB_BRG_Switch(AJ.c2));AI.or=AJ.or;return AI;}return h.decodeColor(this.RGB_BRG_Switch(AJ));}if(typeof AJ==="object"){AI.c1=h.decodeColor(AJ.c1);AI.c2=h.decodeColor(AJ.c2);AI.or=AJ.or;return AI;}return h.decodeColor(AJ);},getTrendLineToggleHandler:function(AI,AK,AJ){return function(){AI.switchOnOffTrendLineForMetric(AK,AJ);};},getTrendLineToggleState:function(AI,AJ){return AI.queryTrendLineStatusForMetric(AJ);},getEditTrendLineHandler:function(AI,AJ){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AI.raiseEventCMSelection(J.TREND_LINE,AJ);};},getEditRefLineHandler:function(AI,AJ){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AI.raiseEventCMSelection(J.REF_LINE,AJ);};},getEditAxisScaleHandler:function(AI,AJ){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AI.raiseEventCMSelection(J.AXIS_SCALE,AJ);};},getEditAxisOriginHandler:function(AI,AJ){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AI.raiseEventCMSelection(J.AXIS_ORIGIN_DEFINE,AJ);};},getEditLogScaleHandler:function(AI,AJ){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AI.raiseEventCMSelection(J.LOG_SCALE,AJ);};},getOptionObjArr:function(AI,AK,AM){if(!E){E=mstrmojo.gm.GMUtility;}var AJ={},AL;if(AK!==undefined){AK=AK.toLowerCase();if(AK==="x1"){AK="x";}else{if(AK==="y1"){AK="y";}}}if(AI.length>1||(AM&&AI.length===1)){if(AK==="x"){AJ.opt=mstrmojo.desc(11712,"Bottom Axis");AJ.key="XAxis";}else{if(AK==="x2"){AJ.opt=mstrmojo.desc(11710,"Top Axis");AJ.key="X2Axis";}else{if(AK==="y"){AJ.opt=mstrmojo.desc(11715,"Left Axis");AJ.key="YAxis";}else{if(AK==="y2"){AJ.opt=mstrmojo.desc(11713,"Right Axis");AJ.key="Y2Axis";}else{if(AK==="z"){AJ.opt=mstrmojo.desc(12090,"SizeBy");AJ.key="SizeBy";}}}}}AJ.optLvl=l.AXIS;AJ.mos=this.getMetricFormatFromIndexArray(AI);}else{if(AI.length===1){AL=this.getMetricFormat(AI[0]);AJ.opt=AL.n;AJ.mos=[AL];AJ.key=AL.mId;AJ.comb=E.getElementCombinationForMetric(AL.mId);AJ.optLvl=l.METRIC;if(AK==="z"){AJ.sizeBy=true;}}}return AJ;},filterInValidMetricIndex:function(AJ){var AI=[];p.forEach(AJ,function(AK){if(AK!==a){AI.push(AK);}});return AI;},fillBackgroundDiv:function(AJ){var AI=document.createElement("div");AI.setAttribute("class","gm-bk-div");AI.style.backgroundColor="rgba(0,0,0,0)";AJ.appendChild(AI);},getSubMenu:function(AN,AO,AM,AL){var AK=AF(AN,AL),AI=AN.getMenuHandler("changeShape"),AJ=AN.GMController.getOnTheFlyShapeForMetric(AL);if(AK.length>1){AO.addSubMenuItem(mstrmojo.desc(11972,"Change Shape"),"",AN.id,AG,{currValue:AJ,options:AK,metricId:AM});}else{AO.addRadioMenuGroup(AJ,q(AM,AI),AK,"checkMark",undefined,true);}},getReferenceLineSubMenu:function(AJ,AN,AO,AI){var AP=mstrmojo.gm.EnumSubtype,AM=AJ.GMController.chartSubType;if(AO&&AM===AP.PERCENT){return ;}var AQ=AJ.id,AK=AJ.getAvailableRefLineTypes(AI)||[];if(AK.length>0){AN.addSubMenuItem(mstrmojo.desc(13021,"Add Reference Line"),"xt",AQ,AA,{metricId:AI,options:AK});}var AL=AJ.getExistingRefLineOptions(AI)||[];if(AL.length>0){AN.addMenuItem(mstrmojo.desc(13659,"Edit Reference Line"),"xt",E.getEditRefLineHandler(AJ,AI));AN.addSubMenuItem(mstrmojo.desc(13022,"Remove Reference Line"),"xt",AQ,u,{metricId:AI,options:AL});}},reverseMapping:function n(AJ){var AL={},AK,AI=AJ.length;for(AK=0;AK<AI;AK++){AL[AJ[AK]]=AK;}return AL;},longIntAnd:function(AJ,AI){var AK;if(AJ===AI){return AJ;}if(AJ>e||AI>e){throw new Error("Operand exceeds valid data range.");}if(AJ<b&&AI<b){return AJ&AI;}if(AJ>=b||AI>=b){if(AJ<AI){AK=AJ;AJ=AI;AI=AK;}}var AM=Math.floor(AJ/b),AL=Math.floor(AI/b),AO=AJ-AM*b,AN=AI-AL*b;return(AO&AN)+(AM&AL)*b;},longIntOr:function(AJ,AI){var AK;if(AJ===AI){return AJ;}if(AJ<b&&AI<b){return AJ|AI;}if(AJ<AI){AK=AJ;AJ=AI;AI=AK;}AK=this.longIntAnd(AJ,AI);return AI-AK+AJ;},parseNumeric:function(AI){return +AI||parseFloat(AI);},fillImageInDiv:function(AL,AK,AJ,AI){AI=AI||"gm-img";AL.innerType=AK;if(AK===4){AL.innerHTML="<img class="+AI+' src="'+AJ+'"/>';}else{if(AK===7){AL.innerHTML=AJ;B.addClass(AL.firstChild,AI);}}},fillTextInDiv:function(AI,AR,AT,AJ,AU,AK,AW,AM,AP){if(AJ===undefined){AJ=AI.offsetWidth;}if(AU===undefined){AU=AI.offsetHeight;}if(AM===undefined){AM=W.MIDDLE;}if(AP===undefined){AP=s.MIDDLE;}if(AK===undefined){AK=false;}AT=this.replaceSpecialChars(AT);var AQ,AS,AO,AV=AK?"gm-text-body":"gm-text-body-nowrap",AL=false,AN;AQ=H.measureTextWidth(AT,AW,6);AN=H.measureTextWidth("...",AW,6);if(AQ>AJ&&AN>AJ){return ;}AO=document.createElement("div");AO.setAttribute("class",AV);AO.setAttribute("type",AC.GM_TEXT_BODY);AO.identity=AR;H.applyStyles2DomNode(AO,AW);AO.innerHTML=AT;AI.appendChild(AO);if(AK){if(AQ>AJ){AS=AO.offsetHeight;}else{AS=H.measureTextHeight(AT,AW,4);}}else{AS=H.measureTextHeight(AT,AW,4);AL=AQ>AJ;}AQ=Math.min(AQ,AJ);AO.style.width=AQ+"px";if(AK){AL=AO.scrollWidth>AQ||AO.scrollHeight>AS;}if(AL){AO.setAttribute("title",AT);}else{AO.setAttribute("title","");}switch(AM){case W.LEFT:AO.style.left="0px";AO.style.textAlign="left";break;case W.MIDDLE:AO.style.left=((AJ-AQ)>>1)+"px";break;case W.RIGHT:AO.style.right="0px";AO.style.textAlign="right";break;}switch(AP){case s.TOP:AO.style.top="0px";break;case s.MIDDLE:AO.style.top=((AU-AS)>>1)+"px";break;case s.BOTTOM:AO.style.bottom="0px";break;}},updateTextColorAndAlignment:function(AI,AK,AL){var AM=AI.firstChild,AN=AM.style,AJ=AI.clientWidth,AO=AM.clientWidth,AQ=AI.clientHeight,AP=AM.clientHeight;AN.left="auto";AN.right="auto";switch(AK){case W.LEFT:AN.left="0px";break;case W.MIDDLE:AN.left=((AJ-AO)>>1)+"px";break;case W.RIGHT:AN.right="0px";break;}AN.top="auto";AN.bottom="auto";switch(AL){case s.TOP:AN.top="0px";break;case s.MIDDLE:AN.top=((AQ-AP)>>1)+"px";break;case s.BOTTOM:AN.bottom="0px";break;}},toggleDisplay:function(AJ,AI){if(!AJ){return ;}if(AI){AJ.style.display="block";}else{AJ.style.display="none";}},isTrendLineAvailableForMetric:function(AM,AN,AQ){var AX=AM&&AM.excludeData,AU=mstrmojo.gm.EnumSubtype,AP=o.gm.EnumShape,AV=AM.GMController,AR=AV.chartSubType,AW=AM.model.data.dz,AK=AW.XAxis,AI=AW.YAxis,AL=AW.BreakBy,AO=AW.SliceBy,AS=AQ,AJ=AV.getChartInfo(),AT=AV.getBreakByAttrsID().length>0||(AJ.isABL&&((AK.MetricNames!==undefined)||(AI.MetricNames!==undefined)||(AL.MetricNames!==undefined)||(AO.MetricNames!==undefined)));if(AS===undefined){AS=AV.getOnTheFlyShapeForMetric(AN);}if(AJ.isABL&&AR===AU.PERCENT){AX=true;}if(AT&&!AJ.isBubbleOrScatter&&(AS===AP.BAR||AR===AU.STACKED||(AR===AU.AUTO&&AS===AP.AREA))){AX=true;}if(AJ.isABL){if(AK.TemplateUnit&&AK.TemplateUnit.length>1){AX=true;}if(AI.TemplateUnit&&AI.TemplateUnit.length>1){AX=true;}if(AK.TemplateUnit===undefined&&AI.TemplateUnit===undefined){AX=true;}}AX=AX||this.isIgnoredMetric(AM,AN);return !AX;},isTrendLineAvailableForAnyMetric:function(AK){var AJ=AK.model.data.gsi.mx,AI;for(AI in AJ){if(this.isTrendLineAvailableForMetric(AK,AI)){return true;}}return false;},isIgnoredMetric:function(AL,AJ){var AK=AL.GMController,AM,AI;if(AK.bubbleSeriesNum!==undefined){AM=AK.getMetricsOnYAxis();AI=AM.indexOf(AJ);if(AI>=AK.bubbleSeriesNum){return true;}AM=AK.getMetricsOnXAxis();AI=AM.indexOf(AJ);if(AI>=AK.bubbleSeriesNum){return true;}}return false;},getAxisMetricsInfo:function(AN){var AI=AN.model.data.dz,AO=AN.model.data.gsi.mx,AJ,AK,AM=[];if(!AI||!AI.ColorBy||!AO){return AO;}var AL=function(AP){return(AP&&AP.TemplateMetric)||[];};AJ=AL(AI.YAxis).concat(AL(AI.XAxis));p.forEach(AO,function(AP){AK=false;p.forEach(AJ,function(AQ){if(AP.did===AQ.id){AK=true;return false;}});if(AK){AM.push(AP);}});return AM;},isInvalidTemplate:function O(AL){if(AL.eg){return false;}var AJ=AL.gts;var AI=AJ.row.length===0&&AJ.col.length===0;p.forEach(AJ.row,function(AO){if(AO.otp===-1){AI=true;}});var AN=AJ.col;if(AN.length>0){var AK,AM=AN.length-1;for(AK=0;AK<AM;AK++){if(AN[AK].otp===-1){AI=true;}}}return AI;},isNoData:function(AI){return AI.eg!==undefined;},getInvalidTemplateErrMsg:function(AI){return AI||mstrmojo.desc(12094,"The Graph Matrix requires:")+"\n"+mstrmojo.desc(12095,"- at least one attribute to be placed on the row or column axis")+"\n"+mstrmojo.desc(12096,"- all metrics to be placed on the column axis, below any attributes");},initColorPickerBtnWithGradientDir:function(AJ,AK){mstrmojo.func.override({showPickerForCurrentMode:function AI(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var AL=this.gradientOrientation,AM=AK.getChartInfo().dirc===mstrmojo.gm.EnumABLDirection.VERTICAL;AL.set("selectedIndex",p.find(AL.items,"id",AM?0:1));}}},AJ.colorPicker);},generateToolTipContent:function(AR,AM,AI,AN,AP,AO,AU){var AL,AJ,AK,AQ,AS,AT;for(AL=AR;AL<AM;AL++){AJ=AN[AL];AQ=AP[AL];if(AL>AR){AK=AN[AL-1];AS=AP[AL-1];if(AJ.id===AK.id){if(AQ===""){continue;}if(AJ.fid===AK.fid&&AQ.idx===AS.idx){continue;}if(AJ.n===""){AO[AO.length-1].v+=M+AQ.n;continue;}}}if(AU){AO.push({n:AJ.n,tid:AJ.id,v:AQ.n});}else{AT=AI===undefined?AJ.isRowAttribute:AI;AO.push({n:AJ.n,tid:AJ.id,v:AQ.n,eid:AQ.id,tp:AJ.otp,axis:AT?1:2,tui:AJ.tui,ui:AJ.tui,dpt:AJ.tui+1,at:AQ.at,isRowAttribute:AT,dei:AQ.dei,o:AQ.o});}}},getAttributeFormCnt:function(AI){var AJ;if((AI.fcnt===undefined||AI.fcnt===null)&&AI.fs){AI.fcnt=AI.fs.length||1;}if(AI.fcnt!==undefined&&AI.fcnt!==null){AJ=AI.fcnt;}else{if(AI.t===47){AJ=1;}else{AJ=AI.cs!==undefined?AI.cs:AI.rs;}}return AJ;},isTrueForBoolValue:function(AI){return AI===true||AI==="true";},computeTicksForAxis:function(AL,AJ){var AK=AL.mOptions,AM,AI={mTicks:[]};if(AJ){AM=Q.copy(AK);Q.copy(AJ,AM);}else{AM=AK;}if(AL.mIsPercent){U.call(AL,AI,AM);return AI;}if(AM.mUseLogarithmicScale){P.call(AL,AI,AM);return AI;}if(AL.mGraphMajorType===d.GMT_BUBBLE&&AL.mTripleId.mObjectId===y.DssGraphZBody){AI.mMinTick=AM.mUseMinValue?AM.mAxisMinValue:AL.mMinimum;AI.mMaxTick=AM.mUseMaxValue?AM.mAxisMaxValue:AL.mMaximum;if(AL.mMinTick>=AL.mMaxTick){AI.mMaxTick=AI.mMinTick+1;}return AI;}if(!AM.mUseMaxValue&&!AM.mUseMinValue){t.call(AL,AI,AM);}else{if(AM.mUseMaxValue&&AM.mUseMinValue){D.call(AL,AI,AM);}else{if(AM.mUseMaxValue){F.call(AL,AI,AM);}else{j.call(AL,AI,AM);}}}return AI;},computeTicksForLogScale:function(AK){var AJ=AK.mOptions,AI={mTicks:[]};P.call(AK,AI,AJ);return AI;},destroyDisposable:function(AI,AJ){if(AJ){p.removeItem(AI.disposables,AJ);AJ.destroy();}},handleDestroy:function(AM,AL,AJ){if(!AM){return ;}var AN,AK=0,AI=AM.disposables,AO=(AI&&AI.length)||0;while(AK<AO){AN=AI[AK];if((!AN.scriptClass||AL.indexOf(AN.scriptClass)<0)&&p.indexOf(AJ,AN.id)===-1){this.destroyDisposable(AM,AN);}if(AI.length<AO){AO=AI.length;}else{AK++;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.VisBase","mstrmojo.DocPortlet");var L={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"},P,B;mstrmojo.Vis=mstrmojo.declare(mstrmojo.VisBase,null,{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,reRenderOnDimensionChg:true,isVis:function(){return true;},setModel:function Q(R){this._super(R);if(R.data){this.set("model",R.data);}this.xtabModel=R;if(this.controller&&typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function O(){this._super();var R=this.xtabModel;if(R&&R.destroy){R.destroy();delete this.xtabModel;}},setDimensions:function N(U,S){var R=this._super(U,S);if(R&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return R;},buildRendering:function M(){if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function G(){P=this.width;B=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function E(){var R=mstrmojo.boxmodel.offset(this.domNode);this.offsetTop=R.top;this.offsetLeft=R.left;},update:function F(W){W=W||this.node;if(W){if(W.data){this.set("model",W.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",W.data);}this.model=W.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(W.data.extProps,this);}var U=this.controller,S=U.view,Y=(S.hasRendered&&S.getCurrentLayout&&S.getCurrentLayout());if(U.view.fullScreenInfoWindow&&(Y&&Y.defn.visName)){var X=mstrApp.rootView.getContentDimensions();this.height=X.h+"px";this.width=X.w+"px";}else{this.fmts=W.defn.fmts||W.defn.units[this.model.k].fmts;var R=this.fmts;if(R){for(var V in L){v=L[V];if(V in R){this[v]=R[V];}}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;return true;},getModel:function A(S){if(S){var R=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,S);if(R){return R.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));return{};}}else{return this.model;}},getDataParser:function K(R){return new mstrmojo.Vis.DataParser(this.getModel(R));},renderErrorMessage:function H(R){this.domNode.innerHTML='<div class="mstrmojo-message">'+R+"</div>";},getMessageID:function J(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function D(V){var c=this.xtabModel,b=(c&&c.docModel);var d=false;if(b){var a=b.defn&&b.defn.layouts,U=null;var S;if(a){for(S in a){if(a[S].loaded){U=a[S];break;}}}var W=U&&U.units;this.selectorTargets={};if(W&&V.scObjList){for(var S=0;S<V.scObjList.length;S++){var X=V.scObjList[S];var Y=X.sc.tks.split("\x1E");for(var R=0;R<Y.length;R++){var Z=W[Y[R]];if(Z){this.selectorTargets[Y[R]]=Z;if(!this.isChildOfIfw(W,Z)){d=true;}}}}}}return d;},isChildOfIfw:function I(R,S){while(S){if(S.ifw){return true;}S=R[S.pnk];}return false;},performAction:function C(R){var U=this.xtabModel.getAction(R),S=U&&U.h;if(S&&this.controller[S]){this.controller[S](this,U.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(R,Z,S){var X=Z;var V=R.getChildren(Z,false);for(var U=0;U<V.length;U++){var Y=V[U];if(Y.k==S){return Y;}else{var W=mstrmojo.Vis.getVisGrid(R,Y,S);if(W){Z=X;return W;}}}};mstrmojo.Vis.DataParser=function(U){var b=mstrmojo.Vis;return{getRowTitles:function(){return new b.Titles(U,true);},getColTitles:function(){return new b.Titles(U,false);},findMetricValue:function(g,l){var k=U.ghs.rhs.items;for(var h in k){var j=k[h].items;var f=true;for(var d in g){if(g[d]!=j[d].idx){f=false;break;}}if(f){return new mstrmojo.Vis.MetricValue(U.gvs.items[h].items[l]);}}},getTotalRows:function X(){var c=U.ghs&&U.ghs.rhs&&U.ghs.rhs.items;return(U.eg||!c)?0:c.length;},getTotalColHeaderRows:function V(){return(!U.ghs.chs.items?0:U.ghs.chs.items.length);},getTotalCols:function R(){return this.getColHeaders(0).size();},getRowHeaders:function a(c){return new b.Headers(U,c,true);},getColHeaders:function Z(c){return new b.Headers(U,c,false);},getMetricValue:function Y(d,c){return new b.MetricValue(U,U.gvs.items[d].items[c]);},getColumnHeaderCount:function W(){return U.gvs.items[0].items.length;},getCSSString:function S(){return U.cssString;}};};mstrmojo.Vis.Titles=function(R,X){var W=(X)?R.gts.row:R.gts.col;return{size:function V(){return W.length;},getTitle:function U(Y){return new mstrmojo.Vis.Title(W[Y]);},getCSS:function S(Y){return R.css[W[Y].cni].n;}};};mstrmojo.Vis.Headers=function(S,U,Y){var Z=(Y)?S.gts.row:S.gts.col;var X=(Y)?S.ghs.rhs:S.ghs.chs;var V=X.items&&X.items[U].items;return{size:function a(){return(!V?0:V.length);},getHeader:function R(b){return V&&V[b]&&new mstrmojo.Vis.Header(V[b],Y?Z[b]:Z[U]);},getCSS:function W(b){return V&&S.css[V[b].cni].n;},getHeaderCell:function(b){return V&&V[b];}};};mstrmojo.Vis.Title=function(S){return{getActionType:function(){return S.at;},getDrillPath:function(){return S.dp;},getHeaderValues:function R(){return S.es;},getHeaderName:function U(W){return S.es[W].n;},getHeaderId:function U(W){return S.es[W].id;},getForms:function V(){return S.fs;},getFormId:function(){return S.fid;},getFormType:function(){return S.ftp;},getUnitId:function(){return S.id;},getLinkMap:function(){return S.lm;},getName:function(){return S.n;},getUnitDssType:function(){return S.otp;},getSelectorControl:function(){return S.sc;}};};mstrmojo.Vis.Header=function(U,R){return{getName:function W(){return(U.idx===-1)?"":R.es[U.idx].n;},getElementId:function Z(){return(U.idx===-1)?"":R.es[U.idx].id;},getObjectId:function V(){return(U.idx===-1)?"":R.es[U.idx].oid;},getElementIndex:function S(){return U.idx;},getActionType:function Y(){return U.at;},isTotal:function X(){return U.otr===1;}};};mstrmojo.Vis.MetricValue=function(R,Z){var Y=Z;return{getValue:function S(){return Y.v;},getThresholdType:function U(){return Y.ty;},getRawValue:function X(){return Y.rv;},getCSS:function V(){return R.css[Y.cni].n;},getThresholdValue:function a(b){if(Y.ti==undefined){return b;}return R.th[Y.ti].n;},getFillColor:function W(b){if(Y.ci==undefined){return b;}return R.fc[Y.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.Box","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui.toolbars.Toolbar","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.ui.rw._IsViewDataGrid","mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig");mstrmojo.requiresClsP("mstrmojo.vi.models","VIComponentMap");var g=mstrmojo.array,b=mstrmojo.hash,d=mstrmojo.dom,a=mstrmojo.Button.newWebButton,O=mstrmojo.vi.ui.DatasetUnitMenuUtils,L=mstrmojo.vi.models,Z=L.VIComponentMap.TYPES,J=4,D=3,N=10,W,V=function V(j,k){var i=[],l=j.getDatasetUnits(["mx","att"]),h=k&&k.getDropZones();if(h&&h.zones){h.zones.forEach(function(m){m.items.forEach(function(n){if(parseInt(n.did,10)!==-1){i.push(l[g.find(l,"did",n.did)]);}});});}return i;},C=function(i,h,k){var j=V(i,h);return i.getDatasetUnits(["mx","att"],null,k).filter(function(l){return g.find(j,"did",l.did)===-1&&!l.hide;});},I=function I(){var m=this.grid,s=this.model,q=s.getSelectedViUnit(),i=q.boxContent.model.data.datasetId,n=q.getZonesModel(),l=[],j=function(x){x.tooltip=x.n+" ("+x.ds+")";return x;},w=C(s,n,i),p=(w.filter(function(x){return x.t!==4&&!m.model.hasSameRecursiveAttributeGroup(x,m.gridData);})).map(j),u=(w.filter(function(x){return x.t===4;})).map(j),k=function(x){var y={};(x||[]).forEach(function(AA,z){if(g.find(V(s,m.zonesModel),"did",AA.did)>-1){y[z]=true;}});return y;},t=function(x){return(x||[]).filter(function(y){return !y.hide||y.usedInDropZones;});},h=function(x){x.unshift({t:"All",formType:3,n:mstrmojo.desc(4928,"All"),tooltip:"Select All Objects"});return x;};function o(z,x){x=t(x);x=h(x);if(x.length){var y=new mstrmojo.ui.CheckList({cssClass:"units",allIdx:0,items:x.map(function(AA){AA.tt=AA.n+" ("+AA.ds+")";AA.css=O.getUnitCssClass(AA);return AA;}),selectedIndices:k(x)});l.push({scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:z,children:[y],getSelectedItems:function(){var AA=y.getSelectedItems();if(AA.length>0&&AA[0].t=="All"){AA.shift();}return AA||[];}});}}o(mstrmojo.desc(3581,"Attributes"),O.getSortedDatasetUnits(p));o(mstrmojo.desc(3582,"Metrics"),O.getSortedDatasetUnits(u));return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mstrmojo-ui-Menu visible datasetObjects",contents:l,hostId:this.id,fnOk:function(){var AB=[],AH,AD,x=m.zonesModel,z=x.getDropZones().zones,AF=z[1],AI=z[0],AC=[],y=AF.items.length+1,AG=AI.items.length+1,AA=V(x.docModel,x),AE=V(s,n);l.forEach(function(AJ){AB=AB.concat(AJ.getSelectedItems());});AH=(AB||[]).filter(function(AJ){return g.find(AA,"did",AJ.did)===-1;});AD=(AA||[]).filter(function(AJ){if(AJ.did==="-1"){return false;}return g.find(AB,"did",AJ.did)===-1&&g.find(AE,"did",AJ.did)===-1;});AH.forEach(function(AJ){AC.push(m.model.getAddTemplateUnitAction(AJ,i,(AJ.t===4?AF:AI).id,AJ.t===4?y++:AG++));});AD.forEach(function(AJ){AC.push(m.model.getRemoveTemplateUnitAction(AJ));});m.controller.onSubmitTemplateUpdates(m,AC);}});},M=function(j,k,h){return{success:function l(n){var m=mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.ViewDataDialog",grid:n,model:j,isViewFilter:k,showUnits:h});m.set("visible",true);m.render();},failure:function i(m){throw {message:"Couldn't open view data dialog <br>("+(m.message||"")+")",name:"Something went wrong"};}};},E=function(i){var h=mstrApp.isInVFConfigMode?Z.FILTER_STACK:Z.VIZ_CONTENT;return mstrApp.rootCtrl.docCtrl.view.builder.getLayoutVIMap(i.getCurrentLayoutKey()).getComponent(h).selectedKey;},A,S=function S(h){if(h&&mstrmojo.dom.isMetaKey(null,h)&&h.keyCode===65&&A){A.selectAll();return false;}return true;},K=function K(i){var j=mstrApp.isSingleTier,h=mstrApp.isWorkstation&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode();if(mstrApp.isInVFConfigMode){return ;}if((j||!!mstrApp.features["web-export-to-excel-privilege"])&&!h){i.push({n:mstrmojo.desc(3958,"Excel"),v:J});}if(j||!!mstrApp.features["web-export-to-pdf-privilege"]){i.push({n:mstrmojo.desc(1877,"PDF"),v:D});}if(j||!!mstrApp.features["web-export-to-csv-privilege"]){i.push({n:mstrmojo.desc(11807,"Data"),v:N});}};B=function B(h){return{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",alias:"toolbar",useRichTooltip:true,visible:h.showUnits};};F=function F(h){var i=this;return{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-export-type",alias:"exportType",value:mstrmojo.desc(13287,"Export Data"),isHostedWithin:true,items:h,visible:h.length>0&&f(A)>0,onitemSelected:function(j){this.selectedNode.innerHTML=mstrmojo.desc(121,"Export Data");i.xport(j.v);}};};X=function X(){var h=this;return{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-addGridButton mstrmojo-WebHoverButton",text:mstrmojo.desc(11893,"Add as Grid"),onclick:function(){h.close(true);},bindings:{visible:function(){return mstrApp.allowWebDashboardDesign();},enabled:function(){return !mstrApp.isLayoutModePreview();}}};};Y=function Y(){return{scriptClass:"mstrmojo.Label",alias:"rowCount",cssClass:"mstrmojo-rowcount",text:""};};U=function U(m,j){var n=B(m),i=X.call(this),l=F.call(this,j),h=Y(),k=[n,i,l,h];if(mstrApp.isInVFConfigMode||mstrApp.isAppStatePresentation()){k.splice(1,1);}return k;};f=function f(h){var i=h.gridData;return b.walk("rw.row.tc",i)||0;};mstrmojo.vi.ui.ViewDataDialog=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.vi.ui.toolbars._HasToolbar],{scriptClass:"mstrmojo.vi.ui.ViewDataDialog",title:mstrmojo.desc(11476,"Show Data"),help:"Show_Data_dialog_box.htm",cssClass:"mstrmojo-ViewDataDialog",modal:true,visible:false,btnAlignment:"right",init:function c(j){var i=j.grid,k=this,h=[];this.grid=i;i.viewDataDialog=this;A=i;i.openPopup=function(){};i.model.canShowCellMenu=function(l){var m=i.model.getCellDataUnion(l);return !!l&&(m.length===0||(m.length===1&&!m[0].eid));};this.set("buttons",[a(mstrmojo.desc(2177,"Close"),function(){k.close();})]);K.call(this,h);j.children=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-toolBox",alias:"tools",children:U.call(k,j,h),slot:"containerNode"},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-gridBox",children:[i],slot:"containerNode"}];d.attachEvent(document.body,"keydown",S);this._super(j);},postBuildRendering:function e(){this._super();var i=this.tools.exportType;if(i.visible){i.list.popupConfig.clear();}var h=document.createElement("textarea");h.className="hiddenArea";h.onblur=function(){h.focus();h.select();};this.editorNode.appendChild(h);this.grid.hiddenField=h;},openXtabCellMenu:function R(h){var j=mstrApp.rootCtrl.document,i=new mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig({isHostedWithin:false,position:h.cmPos||d.position(h.btn.domNode),hostId:this.id});i.buildXtabMenuConfig(b.copy({tabularGrid:true,hideAdvancedSort:true},h));if(i.hasMenuItems()){h.opener=this;j.openPopup(i.newInstance(),h);}},closePopup:function(){var h=mstrApp.rootCtrl.document;if(h){h.closePopup();}},close:function Q(j){var i=this;d.detachEvent(document.body,"keyup",S);A=null;if(mstrApp.isAppStatePresentation()){this.model.controller.startAutoRefresh();}this.model.removeViewDataGrid(this.grid,!!j,W,{failure:function h(k){throw {name:"Something went wrong.",message:"Couldn't close view data dialog <br>("+(k.message||"")+")"};}});i.destroy();},xport:function P(i){var h=this.model.controller;switch(i){case N:h.exportCSV(this.grid.k);break;default:h.exportVisualization(this.grid,i);}},updateToolbar:function H(i){var l=this,j=this.model,n=j.getSelectedViUnit(),m=n.boxContent.model.data.datasetId,h=n.getZonesModel(),k=C(j,h,m);i.btns.push({n:mstrmojo.desc(11780,"Add Data"),cls:"add "+(!!mstrApp.isWSStyling?"mojo-theme-light":"mojo-theme-dark")+" mstrmojo-Button mstrmojo-WebButton"+(k.length===0?" disabled":""),fn:function(p,o){if(k.length!==0){o.openMenu(I.call(l),p);}}});return i;},passToolbarCfg:function G(h){this.tools.toolbar.set("toolbarCfg",h);},oncontextmenu:function(h){d.preventDefault(window,h.e);return false;},updateToolbarChildren:function(h){this.tools.rowCount.set("text",h);if(f(A)>0&&!mstrApp.isInVFConfigMode){this.tools.exportType.set("visible",true);}}});mstrmojo.vi.ui.ViewDataDialog.openDS=function(h,j,i){W=h.createViewDataGrid(h.getDatasetUnits(["mx","att"],null,i),h.getCurrentLayoutKey(),null,M(h,false,false),i);};mstrmojo.vi.ui.ViewDataDialog.openDSTable=function(h,k,i,j){W=h.createViewDataGrid(h.getDatasetUnits(["mx","att"],null,i,j),h.getCurrentLayoutKey(),null,M(h,false,false),i);};mstrmojo.vi.ui.ViewDataDialog.open=function(s,o){var m=s.getDocModel(),n=m.controller;if(n.autoRefReqSent){mstrApp.serverProxy.cancelRequest(n.autoRefReqId);}n.pauseAutoRefresh();s.selectVIUnit();var h=s.boxContent,t=h.isVisMap,i=t&&h.getXtabForSelection()?h.getXtabForSelection():h,l=i.model,u=l.data,q=s.getZonesModel(),k=t?q.getDropZones(true,i.k):q.getDropZones(),j=(h.getContextMenuSelections&&h.getContextMenuSelections())||{},p,w=function w(){W=m.createViewDataGrid(null,E(m),p,M(m,o,true),null,i,k);};if(o){p=l.getSelectorDataFromTemplateLimit(u.tpl)||[];p=p.concat({keepOnly:true,data:j});w();}else{w();}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Vis","mstrmojo._HasOwnAvatar");var K=mstrmojo.css,I=mstrmojo.dom,F="px";function B(Q,P){return{x:Q.x-P.x,y:Q.y-P.y};}function M(Q,P){return(Q.x-P.x)*(Q.x-P.x)+(Q.y-P.y)*(Q.y-P.y);}function N(P){var Q=P.src.data;return(!Q||!Q.isScrollBar);}mstrmojo.VisLegend=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.gm.VisLegend",bodyCssClass:"",avatarCssClass:"legend-dragged",dropZoneHighlightCss:"legend-dropZone",ownAvatar:true,draggable:true,dropZone:true,dockedPositions:null,calculateDockedPositions:mstrmojo.emptyFn,widget:null,boundaryNode:null,draggableNodeName:"domLegend",legendMarkup:"",extrasMarkup:"",markupString:'<div id="{@id}" class="{@cssClass}" style="width:{@width}px;height:{@height}px;top:{@top}px;left:{@left}px;position:absolute;" mstrAttach:click,mouseover,mouseout><div class="gm-legend-bg"><div class="{@bodyCssClass}" style="width:{@width}px;height:{@height}px;text-decoration:inherit">{@legendMarkup}</div></div><div class="gm-anchor-point topLeft"></div><div class="gm-anchor-point topRight"></div><div class="gm-anchor-point bottomLeft"></div><div class="gm-anchor-point bottomRight"></div>{@extrasMarkup}</div>',markupSlots:{dropZoneNode:function(){return this.domNode;},domLegend:function(){return this.domNode.firstChild.firstChild;}},postBuildRendering:function(){this._super();this.calculateDockedPositions(this.widget.getWidth(),this.widget.getHeight());this.boundaryNode=this.widget.domNode;this.boundaryPosition=I.position(this.boundaryNode,true);},createAvatar:function D(){return this[this.draggableNodeName];},updateDropZoneNode:function C(R){var P=this.dockedPositions;if(P&&P.length>0){var X=B(R.tgt.pos,this.boundaryPosition);var V=M(X,P[0]),U=0,Q,W;for(Q=1;Q<P.length;Q++){W=M(X,P[Q]);if(W<V){V=W;U=Q;}}if(U!==this.currDockedPositionIdx){var S=this.dropZoneNode.style;S.left=P[U].x+F;S.top=P[U].y+F;if(this.widget.onLegendDropZoneChange){this.widget.onLegendDropZoneChange(P[U],U);}this.currDockedPositionIdx=U;this.updateAlignClass();return true;}}return false;},toggleDropZoneBorder:function O(P){K.toggleClass(this.dropZoneNode,this.dropZoneHighlightCss,P);},isDragValid:N,ondragstart:function E(P){if(!N(P)){return ;}this._super(P);this.toggleDropZoneBorder(true);},ondragmove:function A(P){if(!N(P)){return ;}this.updateDropZoneNode(P);this._super(P);},allowDrop:function H(P){var R=P.src,Q=R&&R.widget;return(Q&&Q!==this&&Q.parent===this.parent);},ondrop:function J(R){var P=this.domLegend;K.removeClass(P,this.avatarCssClass);var S=P.style;S.left="0";S.top="0";this.dropZoneNode.firstChild.appendChild(P);if(this.widget.onLegendDropped){var Q=this.getDockedPosition();this.widget.onLegendDropped(Q&&Q.pos);}R.dropSuccessful=true;},getDockedPosition:function G(){return this.dockedPositions&&this.dockedPositions[this.currDockedPositionIdx];},ondragend:function A(P){if(!N(P)){return ;}this._super(P);if(!P.dropSuccessful){this.ondrop(P);}this.toggleDropZoneBorder(false);},positionAvatar:function L(V){var R=this,Q=this.avatar,S=Q.style,U=this.boundaryPosition;var P=function(W,X){if(W==="x"){if(X<U.x){return U.x;}return Math.min(X,U.x+U.w-R.domNode.offsetWidth);}if(W==="y"){if(X<U.y){return U.y;}return Math.min(X,U.y+U.h-R.domNode.offsetHeight);}};S.left=P("x",V.x)+F;S.top=P("y",V.y)+F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.models.FormatModel","mstrmojo.Label","mstrmojo.gm.GMUtility","mstrmojo.VisUtility","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.CustomVisUtility");mstrmojo.requiresClsP("mstrmojo.ui.editors.controls","CharacterGroup","FillConfigGroup","LineConfigGroup");var b={HBOX:"HBox",LABEL:"Label",CHARACTERGROUP:"CharacterGroup",FILLGROUP:"FillGroup",LINEGROUP:"LineGroup",COLORBYGROUP:"ColorByGroup"};var P=mstrmojo.hash,K=mstrmojo.array,F=K.ensureArray,C=mstrmojo.VisUtility,R=mstrmojo.gm.GMUtility,S=mstrmojo.CustomVisUtility,L=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,G=mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS,X=mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS,U=mstrmojo.mstr.EnumDSSXMLObjectTypes,Y=S.log;var B="30%",J="70%";function W(g,f){g.set("enabled",!f.disabled);var h=F(f.items);if(h.length>0&&g.getChildControl instanceof Function){h.forEach(function(i){var k=g.getChildControl(i.childName),j=i.disabled;if(k&&j!==undefined){k.set("enabled",!j);}});}}function e(f,i,h,g){f.forEach(function(l,k){l.slot="col"+(k+1)+"Node";});g=P.copy(g,{col1Width:i,col2Width:h,children:f});var j=new mstrmojo.ui.editors.controls.TwoColumnContainer(g);W(j,g);return j;}function O(g,f){g=g||[];f=f||"";K.forEach(g,function(h){h.cssDisplay="inline-block";});return{scriptClass:"mstrmojo.HBox",cssClass:f,children:g};}function V(f,g){return new mstrmojo.Box({children:f||[],cssText:g});}function a(g,k,l,f){var h=new mstrmojo.Label({text:g.text}),j=V(h,"white-space: nowrap;"+(g.width?"width:"+g.width:""));var i=l?[k,j]:[j,k];return O(i,f);}function A(g){var f={};P.forEach(g,function(i,h){f[i]=h;});return f;}function Z(g,h){var f={};if(g){P.forEach(h,function(j,i){var k=g[i];f[j]=k==="true"?true:(k==="false"?false:k);});}return f;}function N(p,g,q,j,n,i,m){var k=g.propertyName,h;var l={getChildComp:n,onGroupValueChange:function(t,s){if(typeof m==="function"){m(t,s);}else{p.saveObjectProperty(k,t,s,g.config,g.showFormatPanel);}},getChildControl:function(s){return this.getChildComp(s);}};P.copyProps(["width","showGradient","showNoFill","showAutomaticInColor","visibleControls","hideColorControl"],g,l);if(g.provideDefaultWidth&&l.width===undefined){l.width="140px";}h=new q(l);if(q===mstrmojo.ui.editors.controls.LineConfigGroup){var f=h.lineColorAndStyle.lineStyle;f.showNoneOption=h.showNoneOption;f.postInit();}var o=i?i:p.getProperty(k)||{};j.forEach(function(s){h.setChildValue(s,o[s]);});h.iniChildrenComp(j);W(h,g);if(g.label){return a(g.label,h);}return h;}mstrmojo.FormatControlHelper=mstrmojo.provide("mstrmojo.FormatControlHelper",{_mixinName:"mstrmojo.FormatControlHelper",getFillGroupControl:function M(h,j){var i="fillColor",f="fillAlpha";var g=0;if(j&&j.showFillColor!==false){g=g|X.FILL_COLOR;}if(j&&j.showFillAlpha!==false){g=g|X.FILL_TRANSPARENCY;}j.visibleControls=g;return N(h,j,mstrmojo.ui.editors.controls.FillConfigGroup,[i,f],function(l){if(l===i){return this.fillColorAndTrans.fillColor;}if(l===f){var k=this.fillColorAndTrans.fillAlpha;return k&&k.fillAlphaText;}return undefined;});},getLineGroupControl:function E(g,i){var h="lineColor",f="lineStyle";return N(g,i,mstrmojo.ui.editors.controls.LineConfigGroup,[h,f],function(j){if(j===h){return this.lineColorAndStyle.lineColor;}if(j===f){return this.lineColorAndStyle.lineStyle;}return undefined;});},getCharacterGroupControl:function d(o,g){var f=g&&g.config,i=g.propertyName,m=0,h,j={fontSize:L.FONT_SIZE,fontColor:L.COLOR,fontFamily:L.FONT_FAMILY,fontWeight:L.FONT_WEIGHT,fontItalic:L.FONT_STYLE,fontUnderline:L.UNDERLINE,fontLineThrough:L.LINE_THROUGH};if(g){if(g.showFontFamily!==false){m=m|G.FONT_FAMILY;}if(g.showFontStyle!==false){m=m|G.FONT_STYLE;}if(g.showFontSizeAndColor!==false){m=m|G.FONT_SIZE_AND_COLOR;}if(g.isFontSizeStepper===true){m=m|G.FONT_SIZE_USE_STEPPER;}}var k={visibleControls:m,onGroupValueChange:function(s,q){if(s===L.FONT_SIZE){if(this.visibleControls&G.FONT_SIZE_USE_STEPPER){q=q[0];}q=parseInt(q,10)+"pt";}o.saveObjectProperty(i,A(j)[s],q,f,g.showFormatPanel);},getChildControl:function(q){return this[q];}};h=new mstrmojo.ui.editors.controls.CharacterGroup(P.copy(k,g));var n=o.getProperty(i),l=Z(n,j),p=l[L.FONT_SIZE];if(g.isFontSizeStepper&&p){l[L.FONT_SIZE]=[parseInt(p,10)];}h.setFormatSource(l);W(h,g);if(g.label){return a(g.label,h);}return h;},getTwoColumnControl:function D(n,f,i){var l=K.ensureArray(f.items),k=l[0],j=l[1],h,g;h=(k&&k.width)||B;g=(j&&j.width)||J;var m=i(n,l);return e(m,h,g,f);},getLabelControl:function H(g){var f=g.labelText,h=g.cssText,i=new mstrmojo.Label({text:f});if(g.width&&g.width.match(/px$/)){h+=" white-space: nowrap;width:"+g.width;}if(h){return new mstrmojo.Box({children:i,cssText:h});}return i;},getHBoxControl:function c(i,g,f){var h=K.ensureArray(g.items),k=f(i,h),j;j={scriptClass:"mstrmojo.HBox",children:k};return j;},getColorByFillGroupControl:function I(n,h){var f="fillColor";var j=n.getColorBy(h.colorInfo);if(!j){Y("could not find color in color palette, please use the colorInfo got from dataInterface");return ;}var m=n.zonesModel.getColorByAttributes();if(!m||m.length===0){return ;}var o=n.getColorByAttInfo(m),i=K.filterOne(o,function(s,p){if(!s.colorByElementIDs){return false;}var q=P.equals(K.hash(s.colorByElementIDs),K.hash(h.colorInfo));if(q){n.currColorbyAttrListIdx=p;}return q;}),k={},l=function(u,t){var p=u===f,s=[],q=[],x=h.colorInfo,w=i.comb;q.push(w);if(p){s.push(R.encodeColor(t));x.color=t;n.updateColorMap(q,s,{success:n.openFormatPanelWithColorbyGroup.bind(n)});}};k[f]=j;h.visibleControls=X.FILL_COLOR;var g=N(n,h,mstrmojo.ui.editors.controls.FillConfigGroup,[f],function(p){if(p===f){return this.fillColorAndTrans.fillColor;}return undefined;},k,l);return g;},getColorByGroupControl:function Q(q,g){var m=q&&q.edtModel,f="fillColor",p=q.zonesModel.getColorByAttributes(),s=q.getColorByAttInfo(p),o=s.map(function(u,t){return{n:u.text,title:u.text,v:t};}),l=function(t){function u(){q.currColorbyAttrListIdx=t;var w=s[t];this.setChildValue(f,w.color);}this.syncControls(u);},i,n,h={},j=C.range(1,o.length),k=function(y,x){var w=[].concat(q.currColorbyAttrListIdx||j),u=[],t=[],AA,z;w.forEach(function(AB){AA=s[AB];z=AA&&AA.comb;t.push(z);u.push(R.encodeColor(x));AA.color=x;});q.updateColorMap(t,u);};g.visibleControls=X.FILL_COLOR;h[f]=s[q.currColorbyAttrListIdx||0].color;n=N(q,g,mstrmojo.ui.editors.controls.FillConfigGroup,[f],function(t){if(t===f){return this.fillColorAndTrans.fillColor;}return undefined;},h,k);i=m.getPulldown(o,l.bind(n),q.currColorbyAttrListIdx||0);if(p.length===0){i.set("enabled",false);n.set("enabled",false);}else{W(i,g);W(n,g);}return m.getEditorGroup([m.getGroupTitle(mstrmojo.desc(13753,"Shape Color")),i,n]);}});mstrmojo.FormatControlHelper.FORMAT_CONTROL_TYPE=b;}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.array","mstrmojo.css","mstrmojo.hash","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMUtility","mstrmojo.color","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.menus.ToolbarEditorConfig","mstrmojo.vi.ui.editors.EditorGroup","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.AdvancedColorPicker");var a=mstrmojo,I=a.dom,K=a.hash,b=a.array,A=a.css,j=a.VisEnum.ControlType,i=mstrmojo.gm,F=mstrmojo.color,V=i.GMUtility,R=a.VisUtility,k=i.FormatingPropertyTag,f=mstrmojo.models.FormatModel,d=f.ENUM_PROPERTY_NAMES,P=mstrmojo.chart.enums.EnumFontStyle,g=mstrmojo.VisEnum.GMLegendFormatingPropertyTag,G=mstrmojo.VisEnum.NetworkLegendFormattingCategory,W=mstrmojo.ui.editors.controls.AdvancedColorPicker,X={GLOBAL:"glb",FORMATTING:"fmt"},D={FONT_COMP:"FntCmp",FONT_FAMILY:"FntFml",FONT_STYLE:"FntStyle",FONT_SIZE:"FntSz",FONT_COLOR:"FntClr",LINE_COMP:"LnCmp",SHOW:"Shw",COLOR:"Clr",STYLE:"Style",THICKNESS:"Thk"};function N(s,o){var n=this.widget,p=n.domToolbarPH,q=this;n._lastOpened=null;p.innerHTML="";document.body.appendChild(p);A.toggleClass(p,mstrApp.getThemeClassName(),true);this.configureLegendPopup(o,p);n.toolEditor=o.newInstance({unrender:function(){}});n.toolEditorClosefn=function(t){var w=t.target,u=n.toolEditor.domNode;if(!I.contains(u,w,true,u)&&!R.isHostedPopupNode(w,"class",true,document.body)){q.hideToolbar();}};I.attachEvent(document.body,"mousedown",n.toolEditorClosefn,true);n.openPopup(this.widget.toolEditor);A.toggleClass(document.body,"hasToolbarPopup",true);}function L(o,n){var p;if(n===X.GLOBAL){p=this.readGlobalProperty(o);}else{if(n===X.FORMATTING){p=this.widget.getPropertiesOfFormatable();}}if(o.slice(-3)===D.COLOR){if(o!==k.COLOR_SQUARE_COLOR||n!==X.GLOBAL){p=V.decodeColor(p);}}return p;}function Q(o,n){var p=this;if(n===X.GLOBAL){return function(s){var q=L.call(p,o,X.GLOBAL);if(o===k.COLOR_SQUARE_COLOR){q=q.color;}if(!K.equals(s,q)){if(o.indexOf(D.COLOR)!==-1){s=V.encodeColor(s);}p.writeGlobalProperty(o,s);}};}return function(t,q){var s=L.call(p,o,X.FORMATTING);if(t!==s){if(o.indexOf(D.COLOR)!==-1){t=F.encodeColor(t);}p.widget.writeFormatableProperties(o,t,q);}};}function O(o,n){o=o||[];n=n||"";b.forEach(o,function(p){p.cssDisplay="inline-block";});return{scriptClass:"mstrmojo.HBox",cssClass:n,children:o};}function e(o,p){o=o||[];var n=new mstrmojo.Box({children:o,cssText:p});return n;}function B(s,t,n){var q="white-space: nowrap; width: 50px;";if(s===mstrmojo.desc(3905,"Background")||s===mstrmojo.desc(6242,"Color")){q="white-space: nowrap;";}else{if(s===mstrmojo.desc(2885,"Fill")){q="white-space: nowrap; margin-right: 9px;";}}var o=new mstrmojo.Label({text:s}),p=e(o,q);return O([p,t],n);}function c(o,p,n){var q=this;o=o||{};if(o.propNames===undefined){o.propNames=p;}o.onGroupValueChange=function(s,u,t){if(u!==t&&u!==undefined){(Q.call(q,s,n))(u,t);}};return o;}function S(p,o,n){var q=this;b.forEach(o,function(s){var t=L.call(q,s,n);if(t!==undefined){p.setChildValue(s,t);}});}function C(n,q,p,o){o=c.call(this,o,q,p);K.copy({width:"140px",height:"22px",colorPickerHostWithin:true},o);var s=new mstrmojo.ui.editors.controls.FillConfigGroup(o);if(s){s.iniChildrenComp(q);S.call(this,s,q,p);}if(typeof n==="string"){return B(n,s,(o||[]).rowContainerCSSClass);}return s;}function Z(p,o,n){return new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-ui-ToolBoxBackgroundFill",children:[C.call(this,mstrmojo.desc(2885,"Fill"),p,o,K.copy({rowContainerCSSClass:"mstrmojo-ui-rowContainer"},n))]}]});}function l(s,p,u,t,o){var q=L.call(this,u,t),w=this;var n=new mstrmojo.ui.editors.controls.ColorPickerButton({isHostedWithin:true,width:"40px",selectedValue:q,showNoFill:true,postselectedValueChange:function(x){(Q.call(w,u,t))(x.value,x.valueWas);}});if(s){n.alias=s;}if(typeof p==="string"){return B(p,n);}return n;}function m(o){var n;if(o.listenToUpdateColorMap instanceof Function){n=o.listenToUpdateColorMap(function(){o.raiseEvent({name:"colorByColorChange",type:"invalidateCache"});if(n&&o.detachUpdateColorMapListener instanceof Function){o.detachUpdateColorMapListener(n);}});}}function h(p,o){var n=L.call(this,p,o),q=this;return new mstrmojo.ui.menus.ToolbarEditorConfig({cssClass:"cbsquare-colorpicker",contents:[new mstrmojo.ui.editors.controls.AdvancedColorPicker({showAutomatic:!n.isDefaultColor,color:n.color,colorChanged:function(s){s=(this.showAutomatic&&s===W.VAL_AUTOMATIC)?"default":s;m(q.widget);(Q.call(q,p,o))(s,n.color);q.hideToolbar();},colorCanceled:function(){q.hideToolbar();}})]});}function U(u,o){var n={},t=L.call(this,o+D.FONT_STYLE,X.GLOBAL),q=L.call(this,o+D.FONT_COLOR,X.GLOBAL),p=L.call(this,o+D.FONT_FAMILY,X.GLOBAL),s=L.call(this,o+D.FONT_SIZE,X.GLOBAL);if(t!==undefined){n[d.FONT_WEIGHT]=(!isNaN(t)&&((t&P.FS_BOLD)>0));n[d.FONT_STYLE]=(!isNaN(t)&&((t&P.FS_ITALIC)>0));n[d.UNDERLINE]=(!isNaN(t)&&((t&P.FS_UNDERLINE)>0));n[d.LINE_THROUGH]=(!isNaN(t)&&((t&P.FS_STRIKETHROUGH)>0));}if(q!==undefined){n[d.COLOR]=q;}if(s!==undefined){n[d.FONT_SIZE]=s;}if(p!==undefined){n[d.FONT_FAMILY]=p;}u.setFormatSource(n);}function H(o,n){var p=null;if(n.indexOf(D.FONT_FAMILY)!==-1){p=o.fontFamily;}else{if(n.indexOf(D.FONT_STYLE)!==-1){p=o.fontStyle;}else{if(n.indexOf(D.FONT_SIZE)!==-1){p=o.fontSize;}else{if(n.indexOf(D.FONT_COLOR)!==-1){p=o.fontColor;}}}}return p;}function M(q,p,n){var o={bold:P.FS_BOLD,italic:P.FS_ITALIC,underline:P.FS_UNDERLINE,strikeout:P.FS_STRIKETHROUGH},s=this;p.forEach(function(t){var u=H(q,t);if(u){u.propName=t;if(t.indexOf(D.FONT_STYLE)!==-1){u.postselectionChange=function(w){var z=w.added,AA=u.items[(z&&z[0]!==undefined)?z[0]:w.removed[0]],y=!!z,x=L.call(s,t,n),AB=(x===undefined?0:x);if(y){AB=AB|o[AA.css];}else{AB=AB&(~o[AA.css]);}u.parent.raiseFormatValueChange(t,AB,x);};}else{if(t.indexOf(D.FONT_FAMILY)!==-1){u.postselectedIndexChange=function(w){var z=w.value,y=w.valueWas;if(z!==y){var x=u.items;u.parent.raiseFormatValueChange(t,x[z].id,x[y]&&x[y].id);}};}else{if(t.indexOf(D.FONT_SIZE)!==-1){u.postselectedValueChange=function(w){var y=parseInt(w.value,10)+"pt",x=parseInt(w.valueWas,10)+"pt";if(y!==x){u.parent.parent.raiseFormatValueChange(t,y,x);}};}else{u.postselectedValueChange=function(w){u.parent.parent.raiseFormatValueChange(t,w.value,w.valueWas);};}}}}});}function Y(o,s,q,p){var w=this;p=p||{};if(p.propNames===undefined){p.propNames=s;}if(p.onGroupValueChange===undefined){p.onGroupValueChange=function(x,z,y){if(z!==y&&z!==undefined){(Q.call(w,x,X.GLOBAL))(z,y);}};}var n={cssClass:"mstrmojo-ui-ToolbarCharacter cf",layoutConfig:null,width:"397px",height:"22px"};p=K.copy(n,p);var u=new mstrmojo.ui.editors.controls.CharacterGroup(p),t=H(u,k.LEGEND_FONT_COLOR);t.showNoFill=true;M.call(this,u,s,q);U.call(this,u,o);return u;}function J(s,q){var x=q.firstChild,AB=x?x.offsetWidth:0,o=x?x.offsetHeight:0,t=document.body.offsetWidth,AA=document.body.offsetHeight,u=10,w=5,z=5;if(x){x.style.left="0";x.style.right="auto";x.style.top="0";x.style.bottom="auto";}var y={w:AB,h:0};var p=o>0;if(p){y.h=o;}else{return false;}if(p){q.style.left=s.x+"px";q.style.top=s.y-o-u/2+"px";}if(s.x+y.w>t){q.style.left=s.x-AB+"px";}if(p){var n=0;if(s.y-o-u/2<w){n=w;q.style.top=n+"px";}else{if(s.y+u/2>AA){n=Math.max(AA-u-o,w);q.style.top=n+"px";}}}}function E(n,q,p,o){return new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.vi.ui.editors.EditorGroup",showDivider:false,children:[Y.call(this,n,q,p,o)]}]});}mstrmojo._FormateVisLegend=mstrmojo.provide("mstrmojo._FormateVisLegend",{_mixinName:"mstrmojo._FormateVisLegend",widget:null,readGlobalProperty:undefined,writeGlobalProperty:undefined,configureLegendPopup:undefined,init:function(n){this.widget=null;if(this._super){this._super(n);}if(this.widget&&!this.widget.domToolbarPH){var o;o=document.createElement("div");o.setAttribute("class","gm-menu-placeholder");this.widget.domToolbarPH=o;}},handleRMCOnLegend:function(AA){var t=AA.getTarget(),u=AA.e,y={x:u.pageX,y:u.pageY},x=t.getAttribute("type"),o,w,q,s=this,p=this.widget;AA.cancel();AA.preventDefault();if(mstrApp.isAppStatePresentation()||!mstrApp.allowWebDashboardDesign()||mstrApp.isInVFInteractMode){return ;}var z,n=function(AB){switch(AB){case j.LGD_COLORBOX_CTN:case j.LGD_COLORBOX:if(AB===j.LGD_COLORBOX){t=t.parentNode;}w=t.firstChild.identity;if(w&&w.comb){this.widget.colorSqureIdentity=w;this.selectColorBox(t,this.fmtMode);o=h.call(this,k.COLOR_SQUARE_COLOR,X.GLOBAL);y=this.adjustColorPickerPos(t);if(!y.alignLeft){q=o.ENUM_CORNERS;o.setAlignment(q.BOTTOM_LEFT,q.TOP_RIGHT);}}break;case j.LGD_TITLE:case j.LGD_TEXT:this.selectText(true);var AC=[k.LEGEND_FONT_SIZE,k.LEGEND_FONT_FAMILY,k.LEGEND_FONT_STYLE,k.LEGEND_FONT_COLOR];o=E.call(this,"lgd",AC,X.GLOBAL);z="lgd";break;default:this.selectLegendBody();var AD=[k.LEGEND_BG_COLOR,k.LEGEND_BG_FILL_TRANSPARENCY];o=Z.call(this,AD,X.GLOBAL);z="lgd";break;}if(o){N.call(this,y,o);if(!!z){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");p.parent.selectVIUnit();var AE=p.edtModel._targetPulldown;if(AE){AE.selectItemByField("v",z);}}}};n.call(this,x);J.call(this,y,this.widget.domToolbarPH);},hideToolbar:function(){var o=this.widget,p=o.domToolbarPH,s=p.firstChild,n=p.parentNode;if(s){p.removeChild(s);}if(n){n.removeChild(p);}var q=o.toolEditor;if(q){q.unrender=function(){q._super();};q.destroy();q.unrender=function(){};delete o.toolEditor;A.toggleClass(document.body,"hasToolbarPopup",false);A.toggleClass(p,mstrApp.getThemeClassName(),false);}if(o.toolEditorClosefn){I.detachEvent(document.body,"mousedown",o.toolEditorClosefn,true);delete o.toolEditorClosefn;}},highlightText:function(n){throw new Error("subclass need to implement highlightText function");}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.GraphMatrixHelper","mstrmojo.vi.viz.MapHelper","mstrmojo.vi.viz.KnownVisualizations","mstrmojo.vi.util.ThresholdUtils","mstrmojo.gm.GMEnums","mstrmojo.gmaps.MapEnums","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.gmaps._AreaMapHelper","mstrmojo.vi.ui.DatasetUnitMenuUtils");var Z=mstrmojo,V=Z.array,Y=Z.vi.viz,K=Z.gmaps,M=Y.GraphMatrixHelper,X=Y.EnumDSSDropZones,A=Y.KnownVisualizations,C=Z.vi.util.ThresholdUtils,S=Z.chart.model.enums.EnumDSSObjectType,G=K.EnumGraphicType,O=K.EnumPropertyType,F=K.EnumDefaultShapeFormatStyle,b=Z.gm.EnumABLDirection,I=K._AreaMapHelper,R=Z.vi.ui.DatasetUnitMenuUtils,L=K.CustomShapeId;function Q(c){return c&&c.getHostModel&&c.getHostModel();}function E(d){var c=false;if(d.t!==4){V.forEach(d.fs||[],function(e){if(e.ftr||e.bftp===1||e.bftp===8||e.bftp===9){c=true;return false;}});}return c;}function D(d,f){var c=d.getHost(),e=c.GMController;if(e){switch(f){case"bp":return e.isBoxPlot;case"wf":return e.isWaterfall;case"hg":return e.isHistogram;default:break;}}return false;}function H(z,l,AM,h,p){var o=AM.dz,t=AM.gsi||{},AH=[],AL=false,e=false,AA=false,j=h.getHost(),AF=j.GMController,u=j.getChartStyle()==="NewGraphMatrixVisualizationStyle",n=D(h,"bp"),AJ=D(h,"wf"),AC=D(h,"hg"),g=AF.property.hGetPropValue("visType")==="57",m=AF.isDualAxis,k=["Reserved","Rows","Columns","XAxis","YAxis","BreakBy","SliceBy","ColorBy","SizeBy"],c=function(AP){return AP.shape==="Pie"||AP.shape==="Ring";},AO=function(){var AP=h.getHost();return AP&&AP.GMController&&AP.GMController.isBubbleOrScatter();},AK=function(AP,AT,AS){AH.push({ax:AS?AS:0,act:"addDropZoneUnit",zoneId:AP,datasetId:l,unitId:z.did,unitType:z.t,unitPos:AT||0});AL=true;AA=(AP===X.ColorBy);e=(AP===X.AdditionalMetrics);var AR=k[AP],AQ=z.t===4?"TemplateMetric":"TemplateUnit";if(o[AR]){if(!o[AR][AQ]){o[AR][AQ]=[];}o[AR][AQ].push(z);}},d=function(AP,AQ){AH.push({act:"removeDropZoneUnit",zoneId:AP,unitId:AQ.did,unitType:AQ.t});},AG=function(AP){AH.push({act:"addDropZoneUnit",zoneId:AP,unitId:"00000000000000000000000000000000",unitType:0});},s=new Y.GraphMatrixHelper({data:AM}),i=function(AP){if(!s.shape){s.shape=AP;p=true;}},q=function(AS,AU){var AW,AV=k[AS],AT,Aa=h.getHost(),AX=Aa.GMController,AP,AZ=!g,AR=AX.getChartInfo(),AQ={dndGM:false};if(g){AT=o[AV].TemplateMetric?o[AV].TemplateMetric.length:0;var AY=AT?o[AV].TemplateMetric[AT-1]:undefined;if(AY&&AY.ax===0){AW=1;}else{if(!AT){AZ=true;}}}if(g||m){AX.shallWeUseGroupInfo=true;}AK(AS,AU,AW);if(!s.metricsDropZone){if(AS===X.XAxis&&s.xAxisObjects.length){AG(X.Columns);}else{if(AS===X.YAxis&&s.yAxisObjects.length){AG(X.Rows);}}}if(AX.shallWeUseGroupInfo){AP=!g||!AT?AX.getGroupInfo():AX.getDummyGroupInfo();if((AR.dirc===b.VERTICAL&&AS===X.YAxis)||(AR.dirc===b.HORIZONTAL&&AS===X.XAxis)){AP=h.fillGroupInfo(AQ,AP,z.did,AW?false:true,AZ);}AX.setGroupInfo(AP);p=true;}};s.setData(AM.dz);s.setMetricsDropZone(AM.dz);s.visType=AF.property.hGetPropValue("visType");if(z.t===S.DssTypeMetric){if(AC){if(!s.yAxisObjects.length){AK(X.YAxis);}else{d(X.YAxis,s.yAxisObjects[0]);AK(X.YAxis);}}else{if(s.exists(z,"yAxisObjects")||s.exists(z,"xAxisObjects")||s.exists(z,"sizeByObjects")||s.exists(z,"colorByObjects")||s.exists(z,"angleObjects")){var w=!s.exists(z,"yAxisObjects")&&!s.exists(z,"xAxisObjects");if(w&&(!s.yAxisObjects.length||s.yAxisObjects[0].t===4)){q(X.YAxis);}else{if(w&&(!s.xAxisObjects.length||s.xAxisObjects[0].t===4)){q(X.XAxis);}else{if(!s.angleObjects.length&&c(s)){AK(X.Angle);}else{if(!n&&!s.colorByObjects.length){AK(X.ColorBy);}else{if(!s.sizeByObjects.length||(!s.exists(z,"sizeByObjects")&&AO())){AK(X.SizeBy);}}}}}}else{if(!n&&!s.angleObjects.length&&c(s)){AK(X.Angle);}else{if((!s.yAxisObjects.length)&&(!s.xAxisObjects.length)){q(X.YAxis);if(!n&&!AJ){i(M.PROP_SHAPE_BAR);}}else{if(s.yAxisObjects.length&&!s.xAxisObjects.length){if((n||AJ)&&s.yAxisObjects[0].t===4){q(X.YAxis);}else{if(!s.exists(z,"yAxisObjects")){q(X.XAxis);if(!n&&!AJ){i(h.isMetricZone(X.YAxis)?M.PROP_SHAPE_CIRCLE:M.PROP_SHAPE_BAR);}}}}else{if((!s.yAxisObjects.length)&&s.xAxisObjects.length){if((n||AJ)&&s.xAxisObjects[0].t===4){q(X.XAxis);}else{if(!s.exists(z,"xAxisObjects")){q(X.YAxis);if(!n&&!AJ){i(h.isMetricZone(X.XAxis)?M.PROP_SHAPE_CIRCLE:M.PROP_SHAPE_BAR);}}}}else{if((s.xAxisObjects[0].t!==4)&&(s.yAxisObjects[0].t===4)&&!s.exists(z,"yAxisObjects")&&!s.exists(z,"sizeByObjects")&&!s.exists(z,"colorByObjects")){q(X.YAxis);if(s.metricsDropZone!==M.PROP_COLUMNS&&s.metricsDropZone!==M.PROP_ROWS&&(!s.colorByObjects.length||s.colorByObjects[0].t!==4)){AG(X.ColorBy);}}else{if((s.xAxisObjects[0].t===4)&&(s.yAxisObjects[0].t!==4)&&!s.exists(z,"xAxisObjects")&&!s.exists(z,"sizeByObjects")&&!s.exists(z,"colorByObjects")){q(X.XAxis);if(s.metricsDropZone!==M.PROP_COLUMNS&&s.metricsDropZone!==M.PROP_ROWS&&(!s.colorByObjects.length||s.colorByObjects[0].t!==4)){AG(X.ColorBy);}}else{if((s.xAxisObjects[0].t===4)&&(s.yAxisObjects[0].t===4)&&!s.exists(z,"xAxisObjects")&&!s.exists(z,"yAxisObjects")&&!s.exists(z,"sizeByObjects")&&!s.exists(z,"colorByObjects")){if(!n&&!s.colorByObjects.length&&s.metricsDropZone!==M.PROP_COLORBY){AK(X.ColorBy);}else{if(!s.sizeByObjects.length&&s.shape!=="Area"){AK(X.SizeBy);}else{if(s.xAxisObjects.length===1){q(X.XAxis);}else{if(s.yAxisObjects.length===1){q(X.YAxis);}else{if(s.sizeByObjects.length===1&&s.shape!=="Area"){AK(X.SizeBy);}else{if(!s.exists(z,"tooltipMetrics")){AK(X.AdditionalMetrics);}}}}}}}else{if(!n&&!s.colorByObjects.length&&s.metricsDropZone!==M.PROP_COLORBY){AK(X.ColorBy);}else{if(!s.sizeByObjects.length){AK(X.SizeBy);}else{if(!s.exists(z,"tooltipMetrics")){AK(X.AdditionalMetrics);}}}}}}}}}}if((!e)&&AL){if(s.exists(z,"tooltipMetrics")){var AN=V.find(s.tooltipMetrics,"did",z.did);if(AN>-1){s.tooltipMetrics.splice(AN,1);d(X.AdditionalMetrics,z);}}}}if(AL&&AA){var j=h.getHost(),y=j.getVisType().vt,AB=C.getDefaultGMThreshold(y);C.addThresholds(j.model,j,j.node,z,AH,AB.colors,AB.ranges,false);}}}else{if(AC){AK(X.XAxis);}else{if((t.rows||[]).concat(t.cols||[]).some(function(AP){return AP.did===z.did;})){if(n&&s.exists(z,"breakByObjects")){}else{if(!s.colorByObjects.length||(s.colorByObjects[0].t!==4&&!s.exists(z,"colorByObjects"))){AK(X.ColorBy);}}}else{if(!n&&!s.sliceObjects.length&&c(s)){AK(X.SliceBy);if(!s.colorByObjects.length){AK(X.ColorBy);}}else{if((!s.yAxisObjects.length)&&(!s.xAxisObjects.length)){AK(X.XAxis);if(!n&&!AJ){i(E(z)?M.PROP_SHAPE_LINE:M.PROP_SHAPE_BAR);}}else{if((s.yAxisObjects.length)&&(!s.xAxisObjects.length)){if((n||AJ)&&s.yAxisObjects[0].t!==4){AK(X.Rows);}else{AK(X.XAxis);if(!n&&!AJ){i(E(z)&&s.yAxisObjects[0]===4?M.PROP_SHAPE_LINE:M.PROP_SHAPE_BAR);}}}else{if((!s.yAxisObjects.length)&&(s.xAxisObjects.length)){if((n||AJ)&&s.xAxisObjects[0].t!==4){AK(X.Columns);}else{AK(X.YAxis);if(!n&&!AJ){i(E(z)&&s.xAxisObjects[0]===4?M.PROP_SHAPE_LINE:M.PROP_SHAPE_BAR);}}}else{if((s.xAxisObjects[0].t!==4)&&(s.yAxisObjects[0].t===4)){if(n&&!s.breakByObjects.length){AK(X.BreakBy);}else{if(!s.colorByObjects.length&&!n){AK(X.ColorBy);if(!s.exists(z,"breakByObjects")){AK(X.BreakBy);}}else{AK(X.Columns);}}}else{if((s.xAxisObjects[0].t===4)&&(s.yAxisObjects[0].t!==4)){if((n||AJ)&&!s.breakByObjects.length){AK(X.BreakBy);}else{if(!s.colorByObjects.length&&!n){AK(X.ColorBy);if(!s.exists(z,"breakByObjects")){AK(X.BreakBy);}}else{AK(X.Rows);}}}else{if((s.xAxisObjects[0].t!==4)&&(s.yAxisObjects[0].t!==4)){AK(X.Columns);}else{if((s.xAxisObjects[0].t===4)&&(s.yAxisObjects[0].t===4)){if((n||AJ)&&!s.breakByObjects.length){AK(X.BreakBy);}else{if(!s.colorByObjects.length&&!n){AK(X.ColorBy);if(!s.exists(z,"breakByObjects")){AK(X.BreakBy);}}else{if(!s.columnObjects.length&&s.rowObjects.length&&s.rowObjects[0].t!==4){AK(X.Rows);}else{AK(X.Columns);}}}}}}}}}}}}}}var AE=[];if(AH.length){if(u){AK(X.AdditionalMetrics,h.getTooltipDropzoneIdx(z)+1);}var AD=h.getUpdateTemplateAction(AH);var f=h.docModel,x=f.controller.view.builder,AI=x.getLayoutVIMap(f.getCurrentLayoutKey()).getComponent(mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK);if(AI&&!mstrApp.isInVFConfigMode){AD.partialRetrieval.nodes.push(AI.k);}AE.push(AD);}if(p){AE.push({act:"setProperty",nodeKey:AM.k,prs:"FormattingWidget",pri:4,v:mstrmojo.string.encodeXMLAttribute(s.getXml())});}if(AE.length){h.clearCardinalityFlags();h.findLargeItemsForAddUnits([z]);}return AE;}function U(f,h,g,c){var d,e=true;function i(m,o,l){var n=c.getZoneModelByZoneId(m);if(c.getUnitIndexInZone(n,f)===-1&&(!l||l(n))){var k=o?0:n.items.length;d=c.getAddItemActions(n,[f],k,false,o?n.items[k]:null,h);n.items.push(f);return false;}return true;}function j(k){return k.items.length===0;}if(!c.isMetric(f)){e=i(X.ColorBy,false,j);e=e&&i(X.Grouping);if(d){c.clearCardinalityFlags();c.findLargeItemsForAddUnits([f]);}}else{e=i(X.SizeBy,false,j);e=e&&i(X.ColorBy,false,j);e=e&&i(X.SizeBy,true,function(k){return k.items[0].did===c.getZoneModelByZoneId(X.ColorBy).items[0].did;});e=e&&i(X.AdditionalMetrics,false,function(){return c.getUnitIndexInZone(c.getZoneModelByZoneId(X.SizeBy),f)===-1&&c.getUnitIndexInZone(c.getZoneModelByZoneId(X.ColorBy),f)===-1;});}return d?[c.docModel.getDataService().getUpdateTemplateAction(c.getHost().k,d)]:[];}function W(e,g,f,c){var d=null,h=!c.isMetric(e)?[X.FromItem,X.ToItem]:[X.ColorBy,X.ItemSize,X.SizeBy];V.forEach(h,function(i){var j=c.getZoneModelByZoneId(i);if(j.items.length===0){d=c.getAddItemActions(j,[e],0,g);j.items.push(e);return false;}});if(d){c.clearCardinalityFlags();c.findLargeItemsForAddUnits([e]);return[c.docModel.getDataService().getUpdateTemplateAction(c.getHost().k,d)];}return[];}function P(l,g,d,k){var c=null,f=!k.isMetric(l)?[X.BreakBy,X.Trend]:[X.Metric],j=k.getZoneModelByZoneId(X.Trend);if(R.isTimeAttr(l)&&j.items.length===0){c=k.getAddItemActions(j,[l],0,g);j.items.push(l);}else{for(var e=0;e<f.length;e++){var h=k.getZoneModelByZoneId(f[e]);if(h.items.length===0){c=k.getAddItemActions(h,[l],0,g);h.items.push(l);break;}}}if(c){k.clearCardinalityFlags();k.findLargeItemsForAddUnits([l]);return[k.docModel.getDataService().getUpdateTemplateAction(k.getHost().k,c)];}return[];}function a(e,g,f,c){var d=null,h=!c.isMetric(e)?[X.GeoAttribute,X.Layout]:[X.ColorBy,X.SizeBy,X.AdditionalMetrics];V.forEach(h,function(i){var j=c.getZoneModelByZoneId(i);if((i===X.AdditionalMetrics||j.items.length===0)&&c.isZoneAvalaible(i)){d=c.getAddDropZoneUnitsActions(j,[e],0,{datasetId:g});return false;}});return d?[c.docModel.getDataService().getUpdateTemplateAction(c.getHost().k,d)]:[];}function J(AE,j,AK,n,f,y){n.getDropZones();var AF=AK.gsi||{},m=n.getHost(),s=m.fnGetWidget(),z=s&&s.scriptClass==="mstrmojo.mapbox.VisMapbox",o=[],q=false,AB=n.getZoneModelByZoneId(X.ColorBy),AC=n.getZoneModelByZoneId(X.SizeBy),AA=n.getZoneModelByZoneId(X.Angle),u=n.getZoneModelByZoneId(X.SliceBy),h=n.getZoneModelByZoneId(X.AdditionalMetrics),AD=mstrmojo.vi.viz,p=AD.MapHelper,k=false,g=function(AQ,AP,AN,AR){if(AQ){var AO=n.getCreateDropZonesAction(AN);o=o.concat(AO.length?n.getUpdateTemplateAction(AO):[]);o.push(n.getUpdateTemplateAction([{act:"addDropZoneUnit",zoneId:AN,unitId:AQ,unitType:AP,datasetId:AR}]));if(AN===X.ColorBy){o.push(n.getUpdateTemplateAction(C.addThresholds(m.model,m,m.node,AE)));}}switch(AN){case X.GeoAttribute:f.geoAttribute=AQ;break;case X.Latitude:f.latitude=AQ;break;case X.Longitude:f.longitude=AQ;break;case X.Geometry:f.geometry=AQ;break;case X.SliceBy:if(!f.slice){f.slice=[];}f.slice.push(AQ);break;case X.ColorBy:f.colorBy=AQ;break;case X.SizeBy:f.sizeBy=AQ;break;case X.Angle:f.angle=AQ;break;case X.AdditionalMetrics:f.tooltip.push(AQ);break;}k=true;},l=function(AP,AO,AN,AQ){g(AP,AO,AN,AQ);if(z&&p.shouldSyncItemToTooltipZone(AP,AN,f&&f.tooltip)){g(AP,AO,X.AdditionalMetrics,AQ);}},AM=function(AQ,AP,AN){if(AQ){o.push(n.getUpdateTemplateAction([{act:"removeDropZoneUnit",zoneId:AN,unitId:AQ,unitType:AP}]));}switch(AN){case X.geoAttribute:f.geoAttribute="";break;case X.Latitude:f.latitude="";break;case X.Longitude:f.longitude="";break;case X.Geometry:f.geometry="";break;case X.SliceBy:var AO=f.slice.indexOf(AQ);if(AO!==-1){f.slice(AO,1);}break;case X.Angle:f.angle="";break;case X.ColorBy:f.colorBy="";break;case X.SizeBy:f.sizeBy="";break;case X.AdditionalMetrics:f.tooltip=V.filter(f.tooltip,function(AR){return AR!==AQ;},{max:f.tooltip.length});break;}},AJ=function(AN,AO){o.push(n.getUpdateTemplateAction({act:"addForm",unitId:AN,attFormId:AO,unitPos:0}));};f.setWidget(m);V.forEach((AF.rows||[]).concat(AF.cols||[]),function(AN){if(AN.did===AE.did){q=true;return false;}});if(q){return[];}switch(AE.t){case 4:if(AB&&!AB.items.length){l(AE.did,AE.t,X.ColorBy,j);}else{if(AC&&!AC.items.length){l(AE.did,AE.t,X.SizeBy,j);}else{if(AA&&!AA.items.length){l(AE.did,AE.t,X.Angle,j);}else{if(h){var x=AE.did;if(f.colorBy.indexOf(x)<0&&f.sizeBy.indexOf(x)&&f.angle.indexOf(x)&&f.tooltip.indexOf(x)<0){l(x,AE.t,X.AdditionalMetrics,j);}}}}}break;default:var t=s.edtModel.getEditingPropertyVal(O.graphicType),c=!f.geoAttribute&&(t!==G.Area&&!f.latitude&&!f.longitude||t===G.Area&&!f.geometry),e=p.getGeoForm(AE,function(AN){return p.isGeoRoleSupportArea(AN.fgr);}),i=p.getLatitudeForm(AE),AL=p.getLongitudeForm(AE),d=p.getGeometryForm(AE),w=function(){var AN=f.vp,AP=f.tooltip;if(!p.canShowSizeByZone(AN)&&f.sizeBy&&AP.indexOf(f.sizeBy)<0){l(f.sizeBy,4,X.AdditionalMetrics);AM(f.sizeBy,4,X.SizeBy);}if(!p.canShowColorByZone(AN)&&f.colorBy&&AP.indexOf(f.colorBy)<0){l(f.colorBy,4,X.AdditionalMetrics);AM(f.colorBy,4,X.ColorBy);}if(!p.showAngleZone(AN)&&f.angle&&AP.indexOf(f.angle)<0){l(f.angle,4,X.AdditionalMetrics);AM(f.angle,4,X.Angle);}if(!p.showSliceZone(AN)&&f.slice&&f.slice.length>0){var AO=f.slice;V.forEach(AO,function(AQ){l(AQ,12,X.AdditionalMetrics);AM(AQ,12,X.SizeBy);});}};if(z&&c&&d){f.setMapType(G.Area);f.setShapeFile(L);if(e){l(AE.did,AE.t,X.GeoAttribute,j);AJ(AE.did,d.fid);l(d.fid,21,X.Geometry,j);f.setUseAttributeForm(true);}else{l(AE.did,AE.t,X.Geometry,j);AJ(AE.did,d.fid);f.setUseAttributeForm(false);}f.setBorderStyle(F.BORDER_STYLE);}else{if(c&&f.supportAreaMap&&e&&!((t!==G.Area)&&(i||AL))){f.setMapType(G.Area);if(z){f.setBorderStyle(F.BORDER_STYLE);}f.setUseAttributeForm(false);l(AE.did,AE.t,X.GeoAttribute,j);AJ(AE.did,e.fid);}else{var AH=(y&&AE.card>500)?G.Density:((t!==G.Area)?t:G.Marker);if(i&&AL&&c){l(AE.did,AE.t,X.GeoAttribute,j);f.setMapType(AH);if(z&&AH===G.Marker&&t===G.Area){f.setBorderStyle(F.BORDER_STYLE_CIRCLE);}f.setUseAttributeForm(true);AJ(AE.did,i.fid);AJ(AE.did,AL.fid);l(i.fid,21,X.Latitude,j);l(AL.fid,21,X.Longitude,j);}else{if((i||p.isLatitude(AE.n))&&(!AL&&!p.isLongitude(AE.n))&&!f.geoAttribute&&!f.latitude){l(AE.did,AE.t,X.Latitude,j);f.setMapType(AH);f.setUseAttributeForm(false);}else{if((!i&&!p.isLatitude(AE.n))&&(AL||p.isLongitude(AE.n))&&!f.geoAttribute&&!f.longitude){l(AE.did,AE.t,X.Longitude,j);f.setMapType(AH);f.setUseAttributeForm(false);}else{if(!i&&!AL&&!e&&u){l(AE.did,AE.t,X.SliceBy,j);}else{if(f.tooltip.indexOf(AE.did)<0){l(AE.did,AE.t,X.AdditionalMetrics,j);}}}}}}}if(k){w();}break;}if(k){o.push({act:"setProperty",nodeKey:AK.k,prs:"FormattingWidget",pri:4,v:mstrmojo.string.encodeXMLAttribute(f.getXml())});}if(o.length){var AG=AK.visName,t=f.getMapType(),AI=f.getLayerName();n.addAttributeNameAndTargetVisForAddUnits(AK,[AE],AG,t,AI);n.clearCardinalityFlags();n.findLargeItemsForAddUnits([AE]);}return o;}function B(o,g,f,m){var q=m.getHost().model,l=f.gsi||{},p=l.rows||[],j=l.cols||[],i=l.mx||[],e=[],d,k,c,n;m.clearCardinalityFlags();if(V.find(p.concat(j).concat(i),"did",o.did)===-1&&!q.hasSameRecursiveAttributeGroup(o)){n=!!V.filterOne(j,function(s){return s.t!==4;});c=!!V.filterOne(p,function(s){return s.t!==4;});if(o.t===4){d=-1;if(i.length===0){if(!c&&!!n){d=1;k=p.length;m.findEstimatedTotalRow([o],d);}else{d=2;k=j.length;}}else{if(p.some(function(s){return s.did==="-1";})){var h=1;m.findEstimatedTotalRow([o],h);}}k=i.length;}else{if(n&&!c){d=2;k=j.length;m.findLargeItemsForAddUnits([o]);m.findTotalColumnCount([o],null);}else{d=1;k=p.length;m.findEstimatedTotalRow([o],d);}}e.push({act:"updateTemplate",keyContext:f.k,actions:[q.getAddTemplateUnitAction(o,g,d,k)]});}return e;}var N=function(d,f,e,c){var h=[];var g=c.getActionsForDoubleClick(d,f);if(V.isArray(g)&&g.length>0){h.push(c.getUpdateTemplateAction(g));}return h;};mstrmojo.vi.models.DatasetDoubleClick=mstrmojo.provide("mstrmojo.vi.models.DatasetDoubleClick",{addObject:function(j,e,i){var d=Q(i),c=[],h=i.getHost();if(!j||!d){return c;}var k=d.visName||"Grid";switch(A.getDefinition(k).id){case A.GRAPHMATRIX:case A.NEWGRAPHMATRIX:c=H(j,e,d,i);break;case A.ESRIMAP:case A.GOOGLEMAP:c=J(j,e,d,i,new Y.MapHelper({data:d}),true);break;case A.MAPBOX:c=J(j,e,d,i,new Y.MapHelper({data:d}),false);break;case A.HEATMAP:c=U(j,e,d,i);break;case A.NETWORK:c=W(j,e,d,i);break;case A.KPICARD:c=P(j,e,d,i);break;case A.IMAGELAYOUT:c=a(j,e,d,i);break;case A.CUSTOM:if(i.getCustomDropZones&&i.getCustomDropZones()){c=N(j,e,d,i);}else{c=B(j,e,d,i);}break;default:c=B(j,e,d,i);break;}if(e!==d.datasetId){var g=i.getHost().model.data.gsi;var f=g?(g.rows||[]).concat(g.cols||[]).concat(g.mx||[]):[];if(e&&(c.length||mstrmojo.array.find(f,"did",j.did)!==-1)){c.push({act:"editNode",nodeKey:h.k,datasetId:e});}}return c;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.MetricSlider","mstrmojo.MetricQualification","mstrmojo.SearchBoxSelector","mstrmojo.TextBoxSelector","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.array","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.func","mstrmojo.string","mstrmojo._IsSelectorTarget","mstrmojo.elementHelper","mstrmojo.MetricSelectorUtility","mstrmojo.RaErrorHandler","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi._MonitorsAppState","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSConsolidationType");mstrmojo.requiresDescs(4729,4730,4732,4733,4734,4735,5225,5443,6738,8967,12297);var V=mstrmojo.array,a=mstrmojo.hash,AO=mstrmojo.dom,Az=mstrmojo.expr,Ac=Az.BFTP,AU=mstrmojo.RaErrorHandler.embeddedErrStr,Av=Az.TP,i=Az.STP,BF=mstrmojo.css,q=mstrmojo.func,Ad=mstrmojo.MetricSelectorUtility,Ak=mstrmojo.vi.ui.DatasetUnitMenuUtils,m=mstrmojo.DocDataService,AB=m.REQUEST_DEFN_DATA,A0=0,At=1,A4=2,Aj=3,AJ=4,AQ=5,Am=6,AD=7,Ah=8,Ao=9,h=10,B=11,j=12,BG=mstrmojo.elementHelper,AA=BG.ELEM_ALL_ID,BI=q.wrapMethods,Q=mstrmojo.string.escapeIllegalXML,AK=mstrmojo.mstr,H=AK.EnumDSSXMLBaseFormType.DssXmlBaseFormHTMLTag,J=AK.EnumDSSConsolidationType,c=AK.EnumDSSXMLObjectTypes,AZ=Av.FILTER,Y=Av.METRIC,Ai=Av.ATTR,BD=Av.CONS,A2=0,A6=i.NDE,Ap=3076,AC=3077,G=i.CUSTOMGROUP,AE=BG.ELEM_ALL,AS=338,AY="RA_LIMIT_ERR",t=-2147204406;mstrmojo.DocSelectorEvtType=null;var l={};l[AD]="MetricSlider";l[Ah]="MetricQualification";l[Ao]="SearchBoxSelector";l[h]="TextBoxSelector";var BM=2;var AW=function AW(){var BN={type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,tks:this.tks,include:this.include,isUConDS:!!this.defn.dsTks};if(this.style===Ah||this.style===AD){mstrmojo.hash.copy(BN,{srcid:this.srcid,srct:this.type,f:this.f,ft:this.ft,qt:this.qt,unset:!!this.unset,cs:this.cs});}return BN;},Aq=function Aq(){var BO=this.node,BQ=BO&&BO.data,BN=BO&&BO.defn,BP=BN&&BN.srct;return((mstrApp.isAppStatePause&&mstrApp.isAppStatePause())||mstrConfig.resolveOnly)&&this.style!==Ao&&BP&&this.hasAttrData()&&!BQ[C.ELMSREADY]&&!BQ[C.ELMSREQUEST]&&parseInt(BN.ds,10)===A2&&!BQ[C.DISABLED];},An=function An(BN){var BQ=this.node.defn,BT=this.node.data,BP=mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig.resolveOnly,BU={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:BQ.srcid||"",dataSourcesXML:BQ.dsrc||"",browseFlags:1};if(!BQ.srcid){return ;}var BO=function(BY){var BV=this.model,BX=BV.datasets,BW=Object.keys(BX),Ba=[],BZ;V.forEach(BW,function(Bb){Ba=BX[Bb].att;V.forEach(Ba,function(Bc){if(Bc&&Bc.did===BY){BZ=Bb;return false;}});if(!!BZ){return false;}});return BZ;};if(!BN){BU.datasetID=BQ.dsid||BO.call(this,BQ.srcid);BU.messageID=this.model.mid;if(!BU.datasetID){return ;}}var BS=this,BR={success:function(BV){BS.bGetElems=true;BS.set("wait",false);if(BV&&BV.es){BT.elms=(BQ.srcid)?BG.buildElemsTerseID(BV.es,BQ.srcid,true):BV.es;if(BP){BS.toggleDisplayAll(BQ.showall);}var BW=BS.parent,BX=BW&&BW.parent;if(BQ.sec&&BT.ces&&BT.elms&&BT.elms.length>0&&BW){BW.set("count",BG.buildElemsCountStr(BT.ces,BT.elms,BS.isSelectionExcluded()));}if(BS.isInvalid){BS.isInvalid=false;}if(BS.hasRendered){BS.refresh();if(BP&&BW){BF.toggleClass(BW&&BW.domNode,"invalid",false);if(BX){BX.rebuildChild(BW);}}if(BS.isInFilterPanel()){if(BW&&BW.defn&&BW.defn.ttl){BW.updateContentHeight();}if(BX&&BX.refreshFP){BX.refreshFP();}}}}},failure:function(BV){if(BP){BS.model.setDataReady(BS.k,BS.id,C.DISABLED,true);var BW=BS.parent;BS.isInvalid=true;BF.toggleClass(BW&&BW.domNode,"invalid",true);if(BS.isInFilterPanel()){if(BW){BW.canCollapse=false;if(BW.titleBar){BW.titleBar.canCollapse=false;}BW.generateToolbar();}}else{if(BW.hasRendered&&BW.showInvalidMessage){BW.showInvalidMessage();}}return ;}mstrmojo.alert(BV.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){if(BP){BS.node.data[C.ELMSREQUEST]=false;BS.model.setDataReady(BS.k,BS.id,C.ELMSREQUEST,false);if(!mstrApp.isSingleTier){mstrApp.hideWait();}}}};this.set("wait",true);if(BP){BT[C.ELMSREQUEST]=true;this.model.setDataReady(this.k,this.id,C.ELMSREQUEST,true);}if(mstrApp.isSingleTier&&BP){mstrApp.serverRequest(BU,BR,{hideFailureErr:true});}else{if(BP){mstrApp.showWait();}mstrmojo.xhr.request("POST",mstrConfig.taskURL,BR,BU,false,null,true);}},n={getWidgetClass:function D(BQ,BP,BO){var BN=l[BP];if(BN&&BN.constructor===Array){BN=BN[BO?0:1];}return BN;},allowHTML:function As(){return false;},getWidgetConfig:function U(BT,BP,BR,BN){var BU=BP===2?false:BR.horiz,BS=BT.getFormats(),BV=BS&&BS.height,BQ={scriptClass:this.getWidgetClass(BT,BP,BU),docSelector:BT,enabled:this.enabled,multiSelect:BR.multi,isHoriz:BU,include:BR.include,itemWidthMode:BR.iwm,allIdx:V.find(BN,"v",mstrmojo.elementHelper.ELEM_ALL_ID),noneIdx:BR.include?-1:V.find(BN,"v",mstrmojo.elementHelper.ELEM_ALL_ID),renderAllItems:!BV,allowHTML:this.allowHTML(),onchange:function BO(){if(!BT._inSyncPhase){BT.selectorControlChange(this);}}};if(BQ.noneIdx!==-1){BQ.allIdx=-1;}if(BS&&BP===mstrmojo.DocSelector.STYLES.PULLDOWN){if(BS.color){BQ.itemCssText="color: "+BS.color+";";}if(BS.font){BQ.itemCssText=(BQ.itemCssText||" ")+"font:"+BS.font;}if(mstrApp.isExpress){BQ.cssTextClass="express";}}return BQ;},expandOrEditToFetchElements:function d(){var BN=this.node&&this.node.data;if(BN&&BN[C.DISABLED]){BN[C.DISABLED]=false;}this.model.setDataReady(this.k,this.id,C.disabled,false);this.checkAndFetchAllElemsForDelayed();},checkAndFetchAllElemsForDelayed:function M(BN){if(BN||Aq.call(this)){An.call(this);}},newSelectorWidget:function A9(BY){var BU=BY.style,BP=BY.node,BX=BP.defn,BS=BP.data,BN=BS.elms||[],BT=BY.isInFilterPanel(),BO,BW=this.getWidgetConfig(BY,BU,BX,BN),BR=BW.scriptClass,BV=function(Bb){var BZ=this.getPopupList(),Ba=this.items;if(BZ.items.length!==Ba.length){this.selectedIndex=V.find(Ba,"v",Bb.v);}if(Bb){this.set("text",Bb.n||mstrmojo.desc(14561,"(null)"));}else{this.set("text","");}};if(!BR){BO=new mstrmojo.Label({cssClass:"unsupported",text:"This selector is not supported."});}else{if(BU===A0){if(mstrApp&&mstrApp.isVI){BW.useDarkTheme=!BT&&mstrApp.getRootController().isDarkThemeSelected();BW.scrollNodeMaxHeight=AS;BW.focusOnPopup=true;BW.allowCustomText=true;BW.allowEmptyText=true;BW.onitemSelected=BW.onitemSelected?mstrmojo.func.composite([BV,BW.onitemSelected]):BV;BW.customizeSearchResult=function(Bb){var Be,Bc=this.allIdx,Ba=this.multiSelect,BZ=Bb.length,Bd={v:"u;",n:mstrmojo.desc(13976,"(All search results)"),t:c.Dimension,_renderIdx:Bc};if(BZ!==this.items.length){if(Bc>=0){Be=V.find(Bb,"v","u;");if(Be>-1){if(Ba&&BZ>1){Bb.splice(Be,1,Bd);}else{Bb.splice(Be,1);}}else{if(Ba&&BZ>0){Bb.splice(Bc,0,Bd);}}}}};BW.setDefaultListAndIndex=function(Ba){var BZ=this.getPopupList();BZ.set("items",Ba);if(!this.multiSelect){BZ.set("selectedIndex",this.selectedIndex);this.set("text",Ba[this.selectedIndex].n||mstrmojo.desc(14561,"(null)"));}else{this.set("selectedIndices",this.selectedIndices);}};BW.onclearSelection=function(){var Ba=this.getSelectedItem(),BZ=this.getPopupList();if(Ba){BZ.set("selectedIndex",V.find(BZ.items,"v",Ba.v));}};}}delete BW.scriptClass;var BQ=a.walk(BR,mstrmojo);BO=new BQ(BW);}return BO;},getCekEvtListener:function A5(BO,BN){return function(BP){var BS=[],BQ=this.node.data.elms,BR={};V.forEach(BQ,function(BU,BT){BR[BU.v]=BT;});V.forEach(BP.value,function(BU){var BT=BR[BU];if(BT>-1){BS.push(BT);}});this.handleActionInSyncPhase(function(){if(BN&&BN.select){BN.select(BS);}});};},newAndInitWidget:function AN(BR){var BT,BP=BR._cekEvtListener,BO=BR.node,BN=BO.defn,BQ=BR.id,BS;if(BP){BN.detachEventListener(BP);delete BR._cekEvtListener;}BT=this.newSelectorWidget(BR);if(BT){BS=this.getCekEvtListener(BR,BT);}BQ=BS.cekContextId||BQ;BS=BS.cekEvtListener||BS;if(BS){BR._cekEvtListener=BN.attachEventListener("cekChange",BQ,BS);}BR.addChildren(BT);if(this.isAttributeSelector()){BR.addChildren({scriptClass:"mstrmojo.Box",cssClass:AY,alias:"ctrlOverlay",slot:"containerNode",visible:false,markupString:AU,});}return BT;},updateWidget:function A1(BO){var BN=BO.children,BP=BN&&BN[0];if(!BP){BP=this.newAndInitWidget(BO);}else{BP.set("enabled",this.enabled);}return BP;}};function Ax(BN){return BN.some(function(BO){return this.style===BO;},this);}function g(){var BN=this;return BN.model.getDatasetUnits(["mx"],function(BO){return BO.did===BN.defn.srcid;})[0]||{};}function AL(BN,BR,BS,BU,BX,BQ,BO){if(!BN){return[];}var BW=0,BT,BV=BN.length-(BQ?1:0)-(BR?1:0),BP=[];if(BO){if(BS&&BR){BW++;}else{if(BU){BW=(BN.length-1);if(BQ){BW--;}}}for(BT=0;BT<BX;BT++){if(BS){if(BW<=BV&&BN[BW]){BP.push(BN[BW++]);}}else{if(BU){if(BW>=(BR?1:0)){BP.push(BN[BW--]);}}}}}else{if(BS){BW=BX;if(BQ){BW--;}}else{if(BU){BW=0;if(BR){BW++;}}}for(BT=BX+1;BT<=BV;BT++){if(BW<=BV){BP.push(BN[BW++]);}}}return BP;}mstrmojo.DocSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,n,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.DocSelector",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSelector {@cssClass} {@extCls}" nm="{@en@n}" title="{@tooltip}" style="{@domNodeCssText}"><div class="filter" style="{@filterNodeCssText}"></div><div class="wait" style="display:none;z-index:100;position:absolute;top:0;left:0;width:100%;height:100%"></div><div class="content" style="{@contentNodeCssText}"></div></div>',markupSlots:{filterNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode.lastChild;},wIconNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:q.composite([function(){var BN=this.children,BO=BN&&BN[0];if(BO&&BO.updateScrollbars&&this.visible){setTimeout(function(){BO.updateScrollbars();},25);}},mstrmojo.Widget.visibleMarkupMethod]),onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenableChange:mstrmojo.Widget.enabledMarkupMethod,onincludeChange:function(){BF.toggleClass(this.domNode,"strikeout",!this.include);},onwaitChange:function(){BF.toggleClass(this.domNode,"wait",!!this.wait);this.wIconNode.style.display=((this.wait)?"block":"none");}},_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},ckey:null,ck:null,tks:null,style:0,selIdx:null,extCls:"",min:-1,max:-1,bGetElems:false,n:"",_inSyncPhase:false,ctrlOverlay:null,toggleDisplayAll:function BE(BN){var BR=this.node,BS=BR.data,BQ=BR.defn,BP=V.filterOne(BS.elms,function(BT){return BT.t===14;});if(BN&&!BP){BP=AE;BS.elms=V.insert(BS.elms,0,[BP]);}if(!BN&&BP){BS.elms=V.filter(BS.elms,function(BT){return BT.t!==14;});}if(this.children&&this.children[0]){var BO=V.find(BS.elms,"v",mstrmojo.elementHelper.ELEM_ALL_ID);this.children[0].items=BS.elms;this.children[0].allIdx=BO;this.children[0].noneIdx=BQ.include?-1:BO;}BS[C.ELMSREADY]=true;this.model.setDataReady(this.k,this.id,C.ELMSREADY,true,"elms",BS.elms);},init:function AX(BP){this._super(BP);if(mstrmojo.dom.isIE){this.formatHandlers=this._ieformatHandlers;}var BO=BP.node.defn,BN=BO.style;this.n=BO.n;this.showBFAMenu=false;if(mstrApp.showSelectAllMenuOptionForSelector===1&&BO.multi){switch(BN){case A4:case AJ:case AQ:case Am:this.spm=true;break;}}},_fetchOnInit4UCOnDS:function Al(BP){var BN=!this.bGetElems&&parseInt(this.node.defn.subTp,10)===BM,BO=this.node.data;if(BN||Aq.call(this)){An.call(this,BN);BP=BO.elms;}return BP;},initControlInfo:function K(){var Bc=this.node,Bh=Bc.data,BP=Bc.defn,Ba=Bh.elms,Bg=Bh.ces;var BU=["include","ckey","ck","tks","style","multi","iase","showall"];Ba=this._fetchOnInit4UCOnDS(Ba,Bh);this.type=BP.ct;var BZ=BP.fmts;if(BZ){var BX=BZ.width;if(!BX||parseInt(BX,10)<=0){BZ.width="95px";}}a.copyProps(BU,BP,this);var BT=this.selIdx={},BR=false,Bb=BP.multi;if((BP.style===At)||Bb){if(!this.oces&&(Bg!==undefined)){this.oces=a.cloneArray(Bg);BR=true;}var BO=BP.showall,Bf=(V.find(Bg,"v",mstrmojo.elementHelper.ELEM_ALL_ID)>-1),Be=(parseInt(BP.dfm,10)===1),BQ=(Bh.unset===true),Bd=(!Be&&BQ&&(Bg&&Bg.length===0)),BN=(BO&&Bf)||(Bf&&!Be&&BQ)||(BO&&Be&&BQ&&Bg&&Bg.length===0);if(BN){Bg=Ba;}else{if(Bd){if(!BR&&(BP.sus!==1)){var BY=BP.htot,BV=(BP.sus===2),BW=(BP.sus===4),Bi=BP.suc||1;Bg=AL(Ba,BO,BV,BW,Bi,BY,this.include);}else{if(this.oces){Bg=this.oces;}}}}}if(Bg){var BS={};V.forEach(Bg,function(Bj){BS[Q(Bj.v)]=true;});V.forEach(Ba,function(Bk,Bj){if(BS[Q(Bk.v)]){BT[Bj]=true;}});}if(BP.min>=0){this.min=BP.min;}if(BP.max>=0){this.max=BP.max;}if(this.isRecursiveAttributeSelector()){this.levelForms=Bh.lvfs||[];}},resetFormatHandlers:function P(){this.formatHandlers={contentNode:["RW"]};},_getSelectionCount:function x(BN){return a.keyarray(BN.selectedIndices).length;},canApply:function L(BR){var BQ=this.defn,BS=BQ.multi,BP=this.min,BN=BS?this.max:1,BO=this._getSelectionCount(BR||this.content);return(BP>=0&&BN>=0&&BP>BN)||((BP<0||BP<=BO)&&(BN<0||BN>=BO));},_buildEvent:mstrmojo.emptyFn,selectorControlChange:function W(BP){var BO=AW.call(this),BV=this.isInFilterPanel()&&this.getFilterPanel(),BS=(BV&&BV.isAutoApply());this._buildEvent(BO,BP);if(!this.canApply(BP)){var BN=this.getPanelContainer();if(this.isInSearchBoxPanel(BN)){BN.set("canApplySbp",false);}if(BS){this.set("err",true);mstrmojo.alert(mstrmojo.desc(12297,"One or more selectors are incorrectly set. Please review the selector(s) and try again."));}if(BV){BV.set("applyEnabled",false);}return ;}if(BS){this.set("err",false);}if(mstrApp.isExpress&&this.node.defn.style===A0){this.handleExpressPulldown();}if(BO.requireToggle){this.deferredEvt=BO;this.set("include",BO.include);this.deferredEvt=undefined;}else{this.slice(BO);}if(this.node.data.unset===true){this.node.data.unset=null;}var BQ=this.model,BR=BQ&&BQ.controller,BU=BR&&BR.view,BT=this.k,BW=this.defn&&this.defn._lkz;V.forEach(BU&&BU.children,function(Bb){var Ba=Bb.defn,BY=Ba&&Ba.loaded,BX=Ba&&Ba.units;if(BY&&Bb.k!==BW){for(var BZ in BX){if(BZ===BT){if(BX[BZ].tsk!==""){Ba.loaded=false;}break;}}}});},showInfoWin:function u(BS){var BV=this.node&&this.node.defn,BP=BV&&BV.ifw,BO=this.model,BQ=[].concat(BO.getTargetInfoWin(BP)).concat(BO.getTargetInfoWin(this.tks));if(BQ&&BQ.length){var BX=this.defn.horiz,BN=BS||this.contentNode,BU=AO.position(BN),BW=AO.position(this.contentNode),BT=(BX||parseInt(this.defn.style,10)===At)?null:{x:BW.x,y:BU.y,w:BW.w,h:BU.h},BR;for(BR=0;BR<BQ.length;BR++){BO.showInfoWin(BQ[BR],BN,BX?"v":"h",false,a.copy(BT));}}},unrender:function AH(BN){delete this.formatHandlers;this._super(BN);},postBuildRendering:function BL(){var BP=this.node.defn.style,BR=this.filterNode.style,BN=this.contentNode,BO=this.node.defn;if(this.isInFilterPanel()&&!this.isHorizFP()){this.domNode.style.width=this.contentNode.style.width="100%";if(this.formatHandlers.filterNode){this.filterNode.style.width=this.contentNode.style.width="100%";}this.set("visible",parseInt(BO.ds,10)===A2);}this.handleActionInSyncPhase(this._super,this);if(mstrApp.isExpress&&BP===A0){this.handleExpressPulldown();}if(this.isInFilterPanel()&&this.parent.adjustFP){this.parent.adjustFP();}if(this.formatHandlers.filterNode){var BQ=this.getFormats();if(!BQ.width){BR.width=BN.clientWidth+"px";}if(!BQ.height){BR.height=BN.clientHeight+"px";}}else{BR.display="none";}this.model.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");if(AO.isAndroid&&BP===At){BN.style.overflow="visible";}BF.toggleClass(this.parent.domNode,"invalid",this.isInvalid);return true;},updateHeight:function A8(){this.contentNode.style.height=this.filterNode.style.height=this.content.getClientHeight()+"px";var BN=this.parent;if(BN&&(BN.defn.ttl!==undefined)&&BN.updateContentHeight){BN.updateContentHeight();}},handleExpressPulldown:function I(){var BP=this.model.getZoomFactor();if(BP!==1){var BQ=this.contentNode.firstChild.firstChild,BR=parseInt(window.getComputedStyle(BQ).height),BN=BR*BP+"px";BQ.style.height=BN;BQ.style.lineHeight=BN;}var BO=document.createElement("DIV");BO.setAttribute("class","mstrmojo-ui-Pulldown-arrow");BO.setAttribute("src","#");this.content.selectedNode.appendChild(BO);},handleActionInSyncPhase:function A3(BP,BO){var BN=this._inSyncPhase;this._inSyncPhase=true;try{if(BO){BP.call(BO);}else{BP();}}catch(BQ){throw ("There was an error handling the selector action in sync phase.");}this._inSyncPhase=BN;},onCGBMapChange:function A7(BO){var BN=BO.cgbMap;if(!BN){return ;}var BP=this.tks;a.forEach(this.defn.cgb,function(BR){var BQ=BN[BR];if(BQ&&BP.indexOf(BQ)<0){BP+="\u001E"+BQ;}});this.tks=BP;},onAppStateChange:function Ab(BW){var BU=mstrmojo.vi.VisualInsightApp.APP_STATES,BY=BU.PAUSE,BV=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),BT=this.model,BP=this.node,BS=BP&&BP.data,BX=BT.updateCSKeysforPause,BR=this.k,BN=this.id;var BO=BW.valueWas&BY;if(BS){if(BV&&!BO){if(this.hasAttrData()){var Ba=(V.indexOf(BX,this.ckey)===-1)&&BS.elms&&(BS.elms.length>0),BZ=this.style===Ao,BQ=Ba&&!BZ;BS[C.ELMSREADY]=BQ;BS[C.CESREADY]=Ba;BS[C.DISABLED]=!Ba&&!BZ;BT.setDataReady(BR,BN,C.ELMSREADY,BQ);BT.setDataReady(BR,BN,C.CESREADY,Ba);BT.setDataReady(BR,BN,C.DISABLED,!Ba&&!BZ);if(!BQ&&this.shouldDisableGdde()){this.isInvalid=true;}}else{if(this.hasQualData()){BS[C.METRICVALUES]=!mstrConfig.resolveOnly;BT.setDataReady(BR,BN,C.METRICVALUES,!mstrConfig.resolveOnly);BS[C.CSREADY]=true;if(this.isAttrQualSelector()&&this.children&&this.children.length){BT.setDataReady(BR,BN,C.CSREADY,true,"cs",this.children[0].cs);}else{BT.setDataReady(BR,BN,C.CSREADY,true);}}}}if(!BV&&BO){if(this.hasAttrData()){BS[C.ELMSREADY]=BS[C.CESREADY]=BS[C.ELMSREQUEST]=BS[C.DISABLED]=false;BT.setDataReady(BR,BN,C.DISABLED,false);BT.setDataReady(BR,BN,C.ELMSREADY,false);BT.setDataReady(BR,BN,C.CESREADY,false);BT.setDataReady(BR,BN,C.ELMSREQUEST,false);}else{if(this.hasQualData()){BS[C.METRICVALUES]=BS[C.CSREADY]=false;BT.setDataReady(BR,BN,C.METRICVALUES,false);BT.setDataReady(BR,BN,C.CSREADY,false);}}}}},update:function p(Bb){this._super(Bb);var BV=mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig.resolveOnly,BN=this.node&&this.node.data,BR=this.model;if(BV&&BN){if(!Bb.data){Bb.data={};}var Bc=Bb.data;if(BN[C.CESREADY]){Bc.ces=BN.ces;Bc[C.CESREADY]=BN[C.CESREADY];}else{if(!this.hasQualData()){Bc.ces=Bb.defn&&Bb.defn.ces;Bc[C.CESREADY]=true;BR.setDataReady(this.k,this.id,C.CESREADY,true,"ces",Bc.ces);}}if(BN[C.ELMSREADY]){Bc[C.ELMSREADY]=BN[C.ELMSREADY];Bc.elms=BN.elms;}if(BN[C.DISABLED]){Bc[C.DISABLED]=BN[C.DISABLED];}if(BN[C.METRICVALUES]){Bc[C.METRICVALUES]=BN[C.METRICVALUES];Ad.restoreMetricSelectorProps(Bc,BN);}if(BN[C.CSREADY]){Bc[C.CSREADY]=BN[C.CSREADY];Ad.restoreMetricSelectorSelections(Bc,BN);}}this.node=Bb;var BQ=this.node.defn,Bi=this.node.data,Be=BQ.style,BY=Bi.elms,BW=this.parent,BZ=(Be===At),BP=(Be===Ao),Ba=this.isDynamicAttributeSelector(),Bg,Bf;if(BV){if(Bi&&BQ){if(this.hasAttrData()){BR.setDataReady(this.k,this.id,C.CESREADY,true);if(BP){Bi.elms=Bi.ces;Bi[C.ELMSREADY]=false;Bi[C.DISABLED]=false;BR.setDataReady(this.k,this.id,C.ELMSREADY,false);BR.setDataReady(this.k,this.id,C.DISABLED,false);}else{BR.setDataReady(this.k,this.id,C.DISABLED,!BN[C.ELMSREADY]);}if(!Bi[C.ELMSREADY]&&this.shouldDisableGdde()){this.isInvalid=true;}}else{if(this.hasQualData()){BR.setDataReady(this.k,this.id,C.CSREADY,true);}}}}if(BQ.srct===Ai&&BQ.srcid&&this.model.getBrowseFormTypes&&this.model.getBrowseFormTypes(BQ.srcid).indexOf(H)>-1){Bg=window.document.createElement("span");V.forEach(BY,function(Bj){Bg.innerHTML=Bj.n;Bf=Bg.firstChild;Bj.n=Bf&&(Bf.text||Bf.alt)||Bj.n||"";});Bf=null;Bg=null;}if(BZ&&BQ.multi){var BX=V.find(BY,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(BX>-1){Bi.del={idx:BX,elem:BY[BX]};V.removeIndices(BY,BX,1);}}if(BQ.sec){var Bd=[].concat(Bb.data.ces||[]);if(BW&&(BW.count!==null&&BW.count!==undefined)){if(BZ||Ba){BW.set("count","");}else{if((Bd&&BY&&BY.length)||BQ.sos){if(!BQ.include){var Bh=V.find(Bd,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(Bh>=0){V.removeIndices(Bd,Bh,1);}}var BT={};V.forEach(BY,function(Bj){BT[Bj.v]=true;});Bd=V.filter(Bd,function(Bj){return BT[Bj.v];});var BO=Bd,BU;if(!BP){if(!BQ.multi){BO=BY;}BU=BY;}if(Bb.data.unset){BW.set("count",BG.buildElemsCountStr(BU,BU));}else{BW.set("count",BG.buildElemsCountStr(BO,BU,this.isSelectionExcluded()));}}}}}if(this.content){this.content.allIdx=V.find(this.node.data.elms,"v",AA);}this.initControlInfo();var BS=this.content=this.updateWidget(this);if(!BS){this.set("visible",false);}this.toggleControlOverlay(Bi);this.clearCache();},toggleControlOverlay:function Aw(BO){var BN=this.ctrlOverlay;if(!BN){return ;}BN.set("visible",!!(BO.em&&BO.pfec===t));},refresh:function Ar(){var BO=this.parent,BN=this.node&&this.node.defn;if(BO&&BO.generateToolbar){BO.set((this.isInFilterPanel()?"baseTitle":"title"),BN.ttl);BO.generateToolbar();}this._super();if(BO.fc&&BO.updateContentHeight){BO.updateContentHeight();}},onselectAllChange:function Ag(BW){var BO=this.children&&this.children[0],BU=BO.items,BN=BO.allIdx,BQ=BO.selectedIndices,BV,BT=[];if(BW.value){if(BQ[BN]){BO.removeSelect(BN,true);var BS=BO.itemRenderer,BR=BS&&BS.unselect;if(BR){var BP=BO._getItemNode(BN);if(BP){BR(BP,BU[BN],BN,BO);}}}for(BV=0;BV<BU.length;BV++){if(BV!==BN&&!BQ[BV]){BT.push(BV);}}BO.addSelect(BT);}else{for(BV in BQ){BT.push(parseInt(BV,10));}BO.removeSelect(BT);}},changeFilterTechnique:function AM(){var BW=this.node.defn,BN="\u001E",BX=this.k,BO=BW.pdf=!BW.pdf,BU=this.model,BQ=this.isInFilterPanel()&&this.getFilterPanel(),BS=BW.tks?BW.tks.split(BN):[],BR=[BX].concat(BS),BP=BU.getDataService(),BT=BP.getUseAlternateFilterTechniqueAction(BW.ck,BW.ckey,BW.ct,BR,BO),BV=BP.newUpdate(BQ);if(BQ&&BQ._bufferedSlices){BQ.applyBufferedSlices(true,BV);}this.model.controller.submitUndoRedoUpdates((BV.actions||[]).concat(BT),null,{success:function(BZ){var BY=BR.join(BN);BU.partialUpdate(BZ.data,BU.getTargetDefn(BY),BZ.defn,[BX]);}},AB);},onincludeChange:function y(Bb){var BZ=this.node.defn,BP=Bb.value,BY=this.model,BT=this.isInFilterPanel()&&this.getFilterPanel(),BX=BY.getDataService().newUpdate(BT);BZ.include=this.include=BP;if(BT&&BT._bufferedSlices){BT.applyBufferedSlices(true,BX);}if(this.style!==AD&&this.style!==B){var BR=AW.call(this);BR.ckey=this.ckey;BR.changeInclude=true;if(BZ.srct===Ai||BZ.srct===BD){var Ba=this,BU=this.model,BV=this.node.k,BS=BU.getDataService(),BO=BU.getSliceCallback(BR),BQ=this.isDynamicAttributeSelector(),BW=[BS.getSelectorShowAllAction({ck:BZ.ck,ckey:BZ.ckey,type:BZ.type,showAll:BP}),BS.getSelectorIncludeAction({ck:BZ.ck,ckey:BZ.ckey,type:BZ.type,include:BP})],Bc=BI(BO,{success:function(Bd){Ba.set("wait",false);if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){Ba.toggleDisplayAll(BP);}if(!BQ){BU.partialUpdate(Bd.data,BU.getTargetDefn(BV));}if(!Ba.isInFilterPanel()&&Ba.parent){Ba.parent.selectVIUnit(Ba,true);}}});this.showall=this.defn.showall=Bb.value;var BN=this.deferredEvt;if(!!BN){BU.sliceDeferred(BX,BN);}BW=!!BN?BW.concat(BX.actions):(BX.actions||[]).concat(BW);this.set("wait",true);BU.controller.cmdMgr.execute({execute:function(){this.submit(BW,Bc);},urInfo:{extraPuKeys:BZ.ck.split("\u001E").slice(1),treesToRender:3}});}else{this.slice(BR);}}},getSelectorStyleList:function AP(){var BP=[],BS=this.defn.srct,BO=this.node,BN=BO&&BO.defn,BR=BO&&BO.data;if(this.useAttrStyle()){var BT=!this.isInFilterPanel();if(this.isRecursiveAttributeSelector()){return[{n:mstrmojo.desc(4733,"Check Boxes"),v:AJ},{n:mstrmojo.desc(8967,"Search Box"),v:Ao},{n:mstrmojo.desc(4729,"Drop-down"),v:A0}];}BP=[{n:mstrmojo.desc(4733,"Check Boxes"),v:AJ},{n:mstrmojo.desc(4730,"Slider"),v:At}];if(BS===Ai){BP.push({n:mstrmojo.desc(8967,"Search Box"),v:Ao});}if(BT){BP=BP.concat([{n:mstrmojo.desc(4735,"Link Bar"),v:Am},{n:mstrmojo.desc(4734,"Button Bar"),v:AQ}]);}BP=BP.concat([{n:mstrmojo.desc(4732,"Radio Buttons"),v:Aj},{n:mstrmojo.desc(4729,"Drop-down"),v:A0}]);if(BT){BP=BP.concat([{n:mstrmojo.desc(6738,"List Box"),v:A4}]);}var BQ=Ak.getUnitFromDataset(this.model.datasets,this.defn.srcid,12);if(BR.fid&&(BQ&&!BQ.de)){BP.push({n:mstrmojo.desc(5443,"Calendar"),v:B});}}else{if(BS===Y){if((mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig.resolveOnly)&&BN&&BN.style!==AD&&!(BR&&BR.max&&BR.min)){BP=[{n:mstrmojo.desc(5225,"Qualification"),v:Ah}];}else{BP=[{n:mstrmojo.desc(4730,"Slider"),v:AD},{n:mstrmojo.desc(5225,"Qualification"),v:Ah}];}}}return BP;},supportsInclude:function AV(){var BN=this.defn;if(this.isRecursiveAttributeSelector()){return !this.isDynamicAttributeSelector();}return((BN.srct===Ai&&!this.hasDE)||(BN.srct===Y&&BN.style===AD))&&!this.isSolrSelector()&&!mstrApp.isInVFConfigMode;},isSelectionExcluded:function e(){return this.isDynamicAttributeSelector()&&!this.defn.include;},isSolrSelector:function F(){return this.model.isFromSolrCube(this.defn.srcid);},isMetricSelector:function BB(){return this.defn.srct===Y;},isRankMetricSelector:function Aa(){var BN=g.call(this).f;return BN&&typeof BN==="string"&&BN.search(/rank/i)===0;},isNumericMetricSelector:function Ay(){var BN=g.call(this).dt;return this.model.isNumericDataType(BN);},isAttributeSelector:function Ae(){return this.defn.srct===Ai;},supportsShowAllToggle:function BH(){return this.defn.srct===Ai||this.defn.srct===BD||(this.defn.srct===AZ&&this.defn.srcst===G);},useAttrStyle:function A(){var BN=this.defn.srct;return BN===AZ||BN===Ai||BN===BD;},hasAttrData:function BA(){return this.useAttrStyle()&&!this.isAttrQualSelector();},hasQualData:function w(){return this.isAttrQualSelector()||this.isMetricSelector();},isDerivedAttributeSelector:function Au(){return this.defn.srct===Ai&&this.defn.srcst===AC;},isNewDerivedElementSelector:function k(){return this.defn.srct===BD&&this.defn.srcst===A6;},isNewDerivedRecursiveElementSelector:function E(){return this.isNewDerivedElementSelector()&&this.defn.ndetype===J.DssRecursiveDerivedElement;},isAttrQualSelector:function AF(){return this.defn.srct===Ai&&this.defn.style===B;},isRecursiveAttributeSelector:function z(){var BN=this.defn;return BN.srct===Ai&&BN.srcst===Ap||this.isNewDerivedRecursiveElementSelector();},isDynamicAttributeSelector:function AT(){return this.isRecursiveAttributeSelector()&&this.isInFilterPanel()&&this.defn.style===AJ;},allowsOrientationChange:function Af(){return !this.isAttrQualSelector()&&!Ax.call(this,[Ao,A4,A0,At,AD,Ah]);},isSearchBox:function O(){return Ax.call(this,[Ao]);},isAttrElemListSelector:function BC(){return this.defn.srct===Ai&&this.defn.style!==B;},isCGSelector:function N(){return this.defn.srcst===G;},isGeoSelector:function b(){var BN=Ak.getUnitFromDataset(this.model.datasets,this.defn.srcid,12);return !!BN&&Ak.isGeoAttr(BN);},shouldDisableGdde:function R(){return this.isCGSelector()||this.isGeoSelector();},getInvalidTooltip:function o(){var BO=mstrmojo.desc(15787,"Unable to retrieve the list of elements for this filter")+mstrmojo.desc(1006,"."),BN=" "+mstrmojo.desc(15931,"Please resume data retrieval to use this filter.");if(this.isCGSelector()){BO=mstrmojo.desc(15924,"This Filter is based on a Custom Group, which is not supported when data retrieval is paused.")+BN;}else{if(this.isGeoSelector()){BO=mstrmojo.desc(15932,"This filter is based on a Geo Attribute, which is not supported when data retrieval is paused.")+BN;}}return BO;},slice:function f(BQ){var BN=this.model;if(BQ&&BQ.eid){BQ.eid=Q(BQ.eid);}if(BN.closeSelWarnFlag){BN.closeSelWarnFlag(this.k);}if(this.isInFilterPanel()){var BO=this.getFilterPanel();if(BO&&!BO.isAutoApply()){BO.bufferSlice(BQ);return ;}}var BR=this.getPanelContainer();if(this.isInSearchBoxPanel(BR)){BR.parent.bufferSlice(BQ);BR.set("canApplySbp",BR.canApplySearchBoxPanel());return ;}var BP=BR&&BR.parent;if(BP&&BP.bufferSlice&&BP.hasDisabledSelectionApply&&BP.hasDisabledSelectionApply()&&BQ&&!BQ.forceApply){BP.bufferSlice(BQ);return ;}BN.slice(BQ);},isInFilterPanel:function AG(){var BN=this.parent;return(BN&&BN.isInFilterPanel&&BN.isInFilterPanel())||false;},isHorizFP:function BJ(){var BN=this.parent;return(BN&&BN.isHorizFP&&BN.isHorizFP())||false;},getFilterPanel:function BK(){var BN=this.parent;return(BN&&BN.getFilterPanel&&BN.getFilterPanel())||null;},isInSearchBoxPanel:function(BN){var BO=BN||this.getPanelContainer();return BO&&(BO.isSbp||(BO._isSearchBoxPanel&&BO._isSearchBoxPanel()));},getPanelContainer:function(){var BN=mstrmojo.EnumRWUnitType,BO;for(BO=this.parent;BO&&BO.defn;BO=BO.parent){if(parseInt(BO.defn.t,10)===BN.PANEL){return BO;}}return null;},clearSelector:function Z(BN){var BZ=AW.call(this),BV=[AA],BY=this.node.data.elms||[],Bi="\u001E",Bd=this.style,BO=this.defn.include,BQ=this.isFilterNothing&&this.isFilterNothing(),BS=this.node.defn,Bf=BS.srcst===257||(BS.srct===47&&BS.srcst!==12033),Bj=mstrApp&&mstrApp.getSelectAllForUnsetForVI&&mstrApp.getSelectAllForUnsetForVI(),Bc=[AE],BR=C.CESREADY,BT="ces",Ba=[],BX=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();if(Bd===Ao){if(Bj){BZ.eid=BV.join(Bi);Ba=Bc;}else{BZ.ckey=this.ckey;BZ.unset=true;}this.defn.set("cek",[]);}else{if(Bd===AD||Bd===Ah){BZ.cs="";BZ.ckey=this.ckey;BZ.unset=true;BS.set("cek",{cs:null,qua:this.qua,include:BO,f:null,ft:null});BR=C.CSREADY;BT=["f","ft","cs"];Ba=[null,null,""];}else{if(Bd===B){BZ.unset=true;BZ.ckey=this.ckey;var BW=[{v:""},{v:""}];BS.set("cek",{cs:BW});BR=C.CSREADY;BT="cs";Ba=BW;}else{if(Bj){BZ.eid=BV.join(Bi);Ba=Bc;}else{BZ.ckey=this.ckey;BZ.unset=true;}var Bh;if((BO||Bd===At)&&this.multi){V.forEach(BY,function(Bl){var Bk=Bl.v;if(BV[0]!==Bk){BV.push(Bk);if(!Bh){Bh=[Bl];}}});}var BU=BO||Bd===At;if(!Bf){BS.set("cek",BU?BV:[]);Ba=BU?Bc:[];if(!BU&&this.content&&this.content.text){this.content.text="";}}else{if(BX){BS.set("cek",(BU&&BV.length>1)?[BV[1]]:[]);}Ba=Bh||[];}BT="ces";}}}if(this.defn.sec&&Bd!==At){this.parent.set("count",Bd===Ao?"":BG.buildElemsCountStr(BV,BY,this.isSelectionExcluded()));}BZ[BN?"forceApply":"forceBuffer"]=true;if(BQ&&!Bf){BZ.ignoreTargetData=true;}BZ.retrieveCtrlKey=Bf;if(BX){var Be=this.model,Bg=Be.getCurrentLayoutDef(),Bb=Bg&&Bg.units,BP=this.k;if(Bb&&Bb[BP]){Bb[BP].cesChange=false;}Be.setDataReady(BP,this.id,BR,true,BT,Ba);}this.slice(BZ);},allowsTogglingMultiSelect:function AI(){return Ax.call(this,[A0,AQ,Am,Ao,At,A4]);},allowsTogglingAutoSearch:function X(){return !this.isRecursiveAttributeSelector()&&Ax.call(this,[Ao]);},allowsSameSizeItems:function S(){return Ax.call(this,[AJ,Aj,AQ,Am])&&!this.isRecursiveAttributeSelector();},supportsSetTarget:function AR(){var BN=this.defn;return this.isAttrElemListSelector()||(BN.srct===BD||BN.srcst===G);},supportSelectionColor:function s(){return Ax.call(this,[A4,Am]);}});mstrmojo.DocSelector.UC_ON_DS=BM;mstrmojo.DocSelector.STYLES={PULLDOWN:A0,SCROLLER:At,LIST:A4,RADIO:Aj,CHECKBOX:AJ,BUTTON:AQ,LINK:Am,METRIC_SLIDER:AD,METRIC_QUAL:Ah,SEARCH_BOX:Ao,TEXT_BOX:h,ATTR_QUAL:B,VISUALIZATION:j};mstrmojo.DocSelector.DATAPARAMS={CESREADY:"cesReady",ELMSREADY:"elmsReady",ELMSREQUEST:"elemsRequest",METRICVALUES:"metricValues",CSREADY:"csReady",DISABLED:"disabled"};var C=mstrmojo.DocSelector.DATAPARAMS;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo._HasPopup","mstrmojo.Popup","mstrmojo.hash","mstrmojo.expr","mstrmojo.Container","mstrmojo.ConditionModel","mstrmojo.Widget","mstrmojo.Button","mstrmojo.ui.ColumnWalk","mstrmojo.rw.ConditionWalk","mstrmojo.mstr.EnumNodeDimty","mstrmojo.vi.ui.ConditionWalkProvider","mstrmojo.vi.ui.AllObjectsBrowser");var U=mstrmojo.Widget,M=mstrmojo.array,G=mstrmojo.dom,Q=mstrmojo.hash,b=mstrmojo.css,V=mstrmojo.Button.newWebButton,L=mstrmojo.expr,C=L.ET,A=mstrmojo.mstr.EnumNodeDimty,N=M.hash([A.NodeDimtyOutputLevel]);var O=mstrmojo.rw.ConditionWalk.getAttForms,E=mstrmojo.rw.ConditionWalk.isMdxDM;function F(){var d=this.model;if(d){if(!d.attachEventListener){Q.make(d,mstrmojo.ConditionModel,{defaultETAttr:d.defaultETAttr,data:d.data});}d.attachEventListener("edit",this.id,"onmodeledit");}}function P(e,d){if(d&&d.detachEventListener){d.detachEventListener("edit",e.id,"onmodeledit");}}mstrmojo.vi.ui.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.vi.ui.ConditionWalk",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-ConditionWalk" mstrAttach:click><div class="walk"></div></div>',markupSlots:{walkNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:U.visibleMarkupMethod,onheightChange:U.heightMarkupMethod,onwidthChange:U.widthMarkupMethod},layoutConfig:{h:{walkNode:"100%"},xt:true},editor:undefined,columnWalk:undefined,walkProvider:null,objectBrowsingEnabled:false,children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"370px",width:"600px"}],postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=this.addDisposable(mstrmojo.insert(mstrmojo.vi.ui.ConditionWalkProvider));}},initWalk:function W(){var d=this.columnWalk,e=this.walkProvider;d.removeTrailingContainer(-1);d.addNextColumn(e.getTargetNodeProps());d.target.updateColumnContainer();this.updateOkBtn();},ob:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-vi-ui-ConditionWalk ObjectBrowserPopup mojo-theme-light",children:[{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",alias:"browser",title:mstrmojo.desc(5298,"Select an Object"),layoutConfig:null,onSelectedItemsChange:function K(){var d=this.getSelectedItems(),e=d&&d[0],f=e&&e.t;this.parent.buttons.selectBtn.set("enabled",f&&f!==L.TP.FOLDER);},browse:function R(d){Q.copy(d,this);},getObjectSubTypes:function(){var d=this.browsableTypes;if(d){return d.split(",");}return this.constructor.prototype.browsableTypes();},dblClickOnNodes:function a(d){var g=this.onSelectCB,f=d.getTarget(),e=G.findWidget(f).data;g[0][g[1]](e);}},{scriptClass:"mstrmojo.Box",alias:"buttons",cssClass:"buttons",children:[V(mstrmojo.desc(221,"Cancel"),function(){this.parent.parent.opener.closePopup();}),V(mstrmojo.desc(547,"Select"),function(){var f=this.parent.parent,g=f.browser,h=g.onSelectCB,e=g.getSelectedItems(),d=this.parent.parent.opener;if(e&&e.length>0){h[0][h[1]](e[0]);}else{d.closePopup();}},true,{alias:"selectBtn",enabled:false})]}],onOpen:function H(){var h=this.shadowNode,d=document.body,e=document.documentElement,g=h.style,f=this.domNode;this.browser.obSearchBox.clearSearch(true);g.width=Math.max(d.clientWidth,e.scrollWidth)+"px";g.height=Math.max(d.clientHeight,e.scrollHeight)+"px";window.setTimeout(function(){b.addClass(f,"open");},1);},onClose:function D(){b.removeClass(this.domNode,"open");var d=this.browser;d.opened=false;d.reset();}},_set_model:function Z(g,d){var e=this.model,f=(d!==e);if(f){P.call(this,e);d.dimtyTypes=this.dimtyTypes||N;this.model=d;F.call(this,d);this.initWalk();}return f;},onmodeledit:function J(e){var d=this.columnWalk[e.prop==="c1"?"c0":e.prop];if(e.prop==="fm"){d=this.columnWalk.target;}if(d){d.updateColumnContainer();}this.updateOkBtn();this.postmodeledit(e);},postmodeledit:mstrmojo.emptyFn,updateOkBtn:function c(){var g=true,d=this.model,e,f=d&&L.fnCstCount(d.fn,d.fnt);if(!d){return ;}switch(d.et){case C.AQ:case C.AL:case C.MQ:for(e=0;e<f;e++){g=g&&!this["invalid"+e];}break;}g=g&&!!d.completed;this.delegateUpdateOkBtn(g);},delegateUpdateOkBtn:mstrmojo.emptyFn,browse:function I(f){var h=this.parent.editorNode,g=function(j,l){var i=G.position(j,true),k=G.position(l,true);return{x:i.x+i.w,y:k.y};},d=this.columnWalk,e=this.walkProvider;switch(f&&f.alias){case"target":case"dmy":e.browseObjs(this,f);break;case"c0":case"c1":e.browseObjs(this,f);break;case"es":e.browseEs(this,f,g(d.es.domNode,h));break;}},onOBSelect:function(i){var k=i.t;if(k===L.TP.FOLDER||k===0||k===undefined){return ;}var g=this.ob.browser,l=g.target;this.closePopup();if(l.alias==="c0"){l=l.attMxPd;}var e=this.targets,j=l.itemIdField,h=e||[],d=M.find(e,j,i[j]);if(d===-1){h.push(i);this.targets=h;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}l.list.set("selectedIndex",M.find(l.items,"did",i.did));if(l.onObjBrowsed){l.onObjBrowsed(i);}},getDatasets:mstrmojo.emptyFn,getAttributeForms:function X(f){var e=this.editor;if(e&&e.getAttributeForms){return e.getAttributeForms(f);}var d=this.getDatasets();return O(f,d);},getAttributeInfo:function Y(d){var e,g=this.editor;if(g&&g.model&&g.model.targets){M.forEach(g.model.targets,function(h){if(h.did===d){e=Q.clone(h);return false;}});}else{var f=this.getDatasets();Q.forEach(f,function(h){e=Q.clone(h.att.filter(function(i){return i.did===d;})[0]);if(e){return false;}});}if(e){e.fs=this.getAttributeForms(d);}return e?e:{};},isMDXDM:function S(d){return E(d,this.getDatasets());},getIfDataSource:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.fe.FilterEditor","mstrmojo.fe.AndOrNode","mstrmojo.fe.DynamicNode","mstrmojo.fe.ConditionNode","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.editors.fe.RelationNode");var C=mstrmojo.hash,B=mstrmojo.expr,A=B.ET;mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree=mstrmojo.declare(mstrmojo.fe.RWViewFilterExprTree,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree",markupString:'<div id="{@id}"><div class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},nodeClassMap:{14:mstrmojo.fe.AndOrNode,15:mstrmojo.vi.ui.editors.fe.RelationNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},levelSwitchValidTypes:[A.MQ,A.MC],setupScrollNodes:function(){this.scrollNode=this.scrollboxNode;},getItemConfig:function(F,D,G){var E=this._super(F,D,G);return C.copy({getConditionTextPostfix:function(){return"";}},E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.Editor","mstrmojo.registry","mstrmojo.fe.FilterUtils","mstrmojo.fe.FilterEditor","mstrmojo.func");mstrmojo.requiresDescs(15544);var G=mstrmojo.array,F=mstrmojo.hash,D=mstrmojo.fe.FilterUtils.getExprXml,E=mstrmojo.expr,A=E.TP,C=E.STP;mstrmojo.fe._HasFilterEditor=mstrmojo.provide("mstrmojo.fe._HasFilterEditor",{filterEditorScriptClass:"mstrmojo.fe.FilterEditor",limitMdxUnitIdsHashTable:{},getLimitMdxUnitIdsHashTable:function B(I){var H=I&&I.limitExpr,K=H&&H.nds||[],L={};var J=function(M){G.forEach(M,function(N){if(N.mdxUnitId){L[N.mdxUnitId]=true;}else{if(N.m&&N.m.did){L[N.m.did]=true;}else{if(N.nds){J(N.nds);}}}});};J(K);return L;},onShowFilterEditor:function(Q){var O=this,V=this.model,L=this.getDataService?this.getDataService():V.getDataService(),H=this._getXtabCallback?this:V.controller,I="mfe",P={},N=Q.getNodeKeys?Q.getNodeKeys():[Q.k],M=function M(Y,a){var X,Z=Y.nds;if(Y.ph){a[Y.ph.idx]=true;}else{if(Z){for(X=0;X<Z.length;X++){M(Z[X],a);}}}return a;},K=function K(Z){var Y=O.getLimitMdxUnitIdsHashTable(Z),X=[];F.forEach(O.limitMdxUnitIdsHashTable,function(b,a){if(!Y[a]){X=X.concat({did:a,t:4});}});L.saveViewFilter({filterModel:Z,limitExp:D(Z.limitExpr),nodeKeys:N,limitMdxToRemove:X},mstrmojo.func.wrapMethods(H._getXtabCallback(Q),{success:function(){var a=Q.boxContent;a&&a.raiseEvent&&a.raiseEvent({name:"regenerateToolbar"});}}));},W=function(X){var Y=I&&window.mstrmojo&&mstrmojo.all[I];if(!Y){Y=mstrmojo.insert({id:I,scriptClass:O.filterEditorScriptClass,onUpdateBrowseElementsParams:function(b,a){var Z=this.model;b.datasetID=Z.dsid;b.messageID=Z.messageID;b.templateNodeKey=Q.k;}});}Y.editorTitle=mstrmojo.desc(15544,"Advanced Filter Editor");Y.set("vizTitle",Q.title);X.targets=G.filter(X.targets,function(Z){switch(Z.t){case A.FILTER:return(Z.st!==C.CUSTOMGROUP);case A.CONS:return Z.st===C.NDE;}return !Z.olap;});O.limitMdxUnitIdsHashTable=O.getLimitMdxUnitIdsHashTable(X);Y.set("onSave",K);Y.set("model",X);Y.set("xtab",Q.boxContent);if(O.filterEditorScriptClass==="mstrmojo.vi.ui.editors.FilterEditor"){Y.set("docModel",V);}if(Y.mainExpr.items.length>0){P=M(Y.mainExpr.items[0],P);}Y.open();},R={taskId:"getRWGridViewFilter",nodeKey:N[0],rwb:V.bs,msgID:V.mid},S=V.newCallback({success:function U(Y){var X=mstrmojo.insert(Y);W(X);},failure:function J(X){mstrmojo.alert(X.code+": "+X.message);}});L.getViewFilter(R,S);}});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.fe.FilterEditor","mstrmojo.ui._HasScroller");var C=mstrmojo.hash,B=mstrmojo.expr,A=B.ET;mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree=mstrmojo.declare(mstrmojo.fe.RWViewLimitExprTree,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree",markupString:'<div id="{@id}"><div class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},levelSwitchValidTypes:[A.MQ,A.MC],getItemConfig:function(F,D,G){var E=this._super(F,D,G);return C.copy({getConditionTextPostfix:function(){return"";}},E);},setupScrollNodes:function(){this.scrollNode=this.scrollboxNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Editor","mstrmojo.Label","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.vi.ui.ConditionWalk","mstrmojo.fe.FilterUtils","mstrmojo.expr");mstrmojo.requiresDescs(15540);var I=mstrmojo.array,M=mstrmojo.hash,R=mstrmojo.Button.newWebButton,G=mstrmojo.mstr.EnumNodeDimty,P=I.hash([G.NodeDimtyUnspecified,G.NodeDimtyNone]),B=mstrmojo.fe.FilterUtils,J=mstrmojo.expr,Q=J.ET;mstrmojo.vi.ui.ConditionEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.ConditionEditor",cssClass:"mstrmojo-vi-ui-ConditionEditor",help:"Creating_a_Metric_Qualification.htm",title:mstrmojo.desc(15540,"Edit Qualification"),objectBrowsingEnabled:false,targets:null,targetsLastMod:null,ets:null,condition:null,model:null,hasPrompt:false,disableElementsBrowsing:null,inRelation:null,editor:null,children:[{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',cssDisplay:"inline-block",cssClass:"conditionBar",model:null,alias:"conditionBar",bindings:{model:"this.parent.model"},update:function(){var E=this.model,U=B.getExprNodeHtmlAndText(E.data?E.data:E,{emptyText:mstrmojo.desc(15413,"Qualification Details"),elemsEmpty:" "});if(this.containerNode){this.containerNode.innerHTML=U.html;this.containerNode.title=U.text;}}},{scriptClass:"mstrmojo.vi.ui.ConditionWalk",alias:"walk",dimtyTypes:P,delegateUpdateOkBtn:function D(V){var E=this.parent,W=E&&E.btnHbox,U=W&&W.okBtn;if(U){U.set("enabled",!!V);}},onOK:function O(){var U=this.condition,E=this.editor;E.onConditionEdit(U,this.model.get());},close:function L(){var E=this.condition;if(E&&E.isEmpty()){E.del();}},postmodeledit:function H(E){this.parent.updateConditionBar();},getIfDataSource:function S(){return this.parent.getIfDataSource();},onUpdateBrowseElementsParams:function N(E){this.parent.onUpdateBrowseElementsParams(E);},getDatasets:function F(){return this.parent.getDatasets();}}],buttons:[R(mstrmojo.desc(1442,"OK"),function(){var E=this.parent.parent;E.walk.onOK();E.close();},true,{enabled:true,alias:"okBtn"}),R(mstrmojo.desc(221,"Cancel"),function(){var E=this.parent.parent;E.close();})],updateConditionBar:function A(){this.conditionBar.update();},open:function K(V,E){this._super(V,E);var U={objectBrowsingEnabled:this.objectBrowsingEnabled,targets:this.targets,targetsLastMod:this.targetsLastMod,ets:this.ets,condition:this.condition,hasPrompt:this.hasPrompt,disableElementsBrowsing:this.disableElementsBrowsing,disableHierarchyLevel:this.disableHierarchyLevel,inRelation:this.inRelation,editor:this.editor};M.copy(U,this.walk);if(!(this.disableElementsBrowsing&&this.disableElementsBrowsing())){this.model.defaultETAttr=Q.AE;}this.walk.set("model",this.model);this.updateConditionBar();},onClose:function C(){this.walk.close();},getDatasets:mstrmojo.emptyFn,getIfDataSource:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.boxmodel","mstrmojo.Model","mstrmojo.VisUtility","mstrmojo.elementHelper","mstrmojo._CanProxyCallback","mstrmojo.EnumRWUnitType","mstrmojo.models.template.DataInterface","mstrmojo.StringBuffer","mstrmojo.EnumReadystate","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.vi.viz.EnumWidgetTypes","mstrmojo.DocSelector","mstrmojo.MetricSelectorUtility","mstrmojo.UUID","mstrmojo.ExpressVisList","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.vi.viz.MapHelper","mstrmojo.vi.models.VIComponentMap");var Bi=mstrmojo.EnumRWUnitType,BG=mstrmojo.EnumReadystate,AU=mstrmojo.hash,AC=AU.forEach,AZ=mstrmojo.func.wrapMethods,Ah=mstrmojo.Obj.free,BN=mstrmojo.array,Ap=mstrmojo.boxmodel,Af=mstrmojo.mixin,BO=mstrmojo.VisUtility,BW=mstrmojo.elementHelper,AW=mstrmojo.MetricSelectorUtility,BY=mstrmojo.UUID,z=mstrmojo.vi.viz.EnumVizStyles,a=mstrmojo.vi.viz.EnumWidgetTypes,Ba=mstrmojo.vi.viz.EnumDSSDropZones,p=mstrmojo.vi.viz.MapHelper,AI=mstrmojo.DocSelector.DATAPARAMS,N="\u001E";var Ac={},A5={},Aw="76CB9F3E366345DF89811386CBAA82CB",AX=mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_STYLE.DEFAULT,AP=[11826975,1381846,1810715,950271,12407690,2276796,13614615,8355711,15255470,9869567,9101208,7912447,14004421,9296859,15063710,13092807],Q=mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK,Au={ESRIMapVisualizationStyle:"com.microstrategy.web.vf.viewer.EsriMapApplicationViewer",GoogleMapVisualizationStyle:"com.microstrategy.web.vf.viewer.GoogleMapApplicationViewer",MapboxVisualizationStyle:"com.microstrategy.web.vf.viewer.MapboxApplicationViewer",KPICardVisualizationStyle:"com.microstrategy.web.vf.viewer.KPICardApplicationViewer"},AO="com.microstrategy.web.vf.viewer.CustomVisApplicationViewer";mstrmojo.MultiRWUnitFormatEventsType=null;var AL={isObservable:function(Bl){var Bk=Bl&&Bl.t;if((!Bk&&Bk!==Bi.LAYOUT)||!this.hasOwnProperty(Bk)||Bl.scriptClass){return false;}return(Bk!==Bi.SUBSECTION||!Bl.dt);},makeObservable:function(Bk){var Bl=Bk.audibles=this[Bk.t]||{};if(Bl.hasOwnProperty("readyState")){Bk.readyState=BG.IDLE;}return new mstrmojo.Model(Bk);}};AL[Bi.PANELSTACK]={"*":false,selKey:true,readyState:true};AL[Bi.GRID]={"*":false,readyState:true,ds:true};AL[Bi.GRAPH]={"*":false,readyState:true,ds:true};AL[Bi.GRIDGRAPH]={"*":false,qsm:true,ds:true};AL[Bi.SUBSECTION]={"*":false,resize:true,adjustSize:true};AL[Bi.VISUALIZATION]={"*":false,ds:true};AL[Bi.SELECTOR]={"*":false,cek:true,ds:true,readyState:true};AL[Bi.MOJOVISUALIZATION]={"*":false,ds:true};AL[Bi.LAYOUT]={"*":false,readyState:true};var Ar={};function AY(Bk){return Ar[Bk]||Ar["*"];}Ar["*"]={update:function g(Bl,Bm,Bk,Bn){AU.copy(Bk,Bm);if(Bk&&!Bk.ck){delete Bm.ck;}if(Bk&&!Bk.fs){delete Bm.fs;}}};Ar[Bi.PANEL]=Af({update:function g(Bl,Bm,Bk,Bn){delete Bm.layoutXML;if(Bm.isNavigation){delete Bm.exp;}this._super(Bl,Bm,Bk);}},Ar["*"]);function Aa(Bp,Bq){var Bl=Bp&&Bp.layoutMap&&Bp.layoutMap[Bq];if(Bl){if(!Bl.t){Bl.t=Bi.LAYOUT;}if(AL.isObservable(Bl)){Bl=Bp.layoutMap[Bq]=this.addDisposable(AL.makeObservable(Bl));}return Bl;}var Bk=Bp&&Bp.layouts,Bo=(Bk&&Bk.length)||0,Bn;for(Bn=0;Bn<Bo;Bn++){if(Bk[Bn].k===Bq){var Bm=Bk[Bn];if(!Bm.t){Bm.t=Bi.LAYOUT;}if(AL.isObservable(Bm)){Bk[Bn]=this.addDisposable(AL.makeObservable(Bm));}return Bk[Bn];}}return null;}function f(Bn,Bp,Bm,Bl){var Bk=Aa.call(this,Bn,Bp);if(Bm===Bp){Bk._lkz=Bp;return Bk;}if(Bk){var Bo=Bk.units[Bm];if(Bo){if(parseInt(Bo.t,10)===Bi.GRIDGRAPH){if(!Bk.units[Bm+"_0"]){Bk.units[Bm+"_0"]={ck:Bo.ck,fmts:Bo.fmts.gd,txi:Bo.txi,t:Bi.GRID};Bk.units[Bm+"_1"]={ck:Bo.ck,fmts:Bo.fmts.gp,t:Bi.GRAPH};}}if(!Bl&&AL.isObservable(Bo)){Bo=Bk.units[Bm]=AL.makeObservable(Bo);this.disposables.push(Bo);}Bo._lkz=Bp;}}return Bk&&Bk.units[Bm];}function BZ(Bo,Bn,Bm,Bk){var Bl=this.getChildren(Bo,Bn,0);return(mstrApp.isMobile?(BN.filter(Bl,function(Br){var Bp=Bm&&Bm.indexOf(Br.defn.t),Bq=Br.defn.dk;return Bk?(Bp>-1&&Bq===-1):(Bp<0||Bq!==-1);})):(Bk?[]:Bl));}var A3=function(Bk,Bl){var Bm=new mstrmojo.StringBuffer();if(Bl){Bm.append("*l"+Bl);}Bm.append("*k"+Bk.k);if(Bk.hasOwnProperty("wid")){Bm.append("*x"+Bk.wid);}Bm.append("*t"+this.buildTime);return Bm.toString();};function BV(Bm){var Bl,Bk,Bp=this.delta,Bn=this.pendingUpdate=this.pendingUpdate||{},Bo=[];if(!AU.isEmpty(Bp)){Bo.push("<updates>");for(Bl in Bp){if(Bp.hasOwnProperty(Bl)){Bk=Bp[Bl];Bo.push(Bk.getUpdates());}}Bn[Bm]=Bp;this.delta={};Bo.push("</updates>");}return Bo.join("");}function t(Bp,Bl){var Bo;if(Bp){var Bk=BN.isArray(Bp)?Bp:Bp.split(Bl||N),Bn=Bk.length,Bm;for(Bm=0;Bm<Bn;Bm++){Bo=Bo||{};Bo[Bk[Bm]]=f.call(this,this.defn,this.currlaykey,Bk[Bm]);}}return Bo;}function AG(Bk,Bl){return mstrmojo.all[A3.call(this,{k:Bk,wid:Bl},this.currlaykey)];}function A1(Bl,Bk){var Bm=this.getLayoutUnitDefn(Bl,Bk);return(Bm&&Bm.t===Bi.PANELSTACK&&Bm.ifw);}function AB(Bl,Bk){return !Bk||(Bl.wid===Bk);}function F(Bo,Bw){var Br=this,Bx=Br.getSliceCallback(Bw),Bm=Bx.shared,By=Bw.tks,Bl=Bw.eid,Bu=Br.getDataService();if(!By){return ;}var Bt=f.call(Br,Br.defn,Br.currlaykey,Bl);if(!Bt){return ;}var Bq=Bl,Bs=Bm.tgtDefs[By],Bk=function(){Bs.set("selKey",Bl);},Bn;Bs.newSelKey=Bl;if(Bt.l){var Bp=Bt.dirtyKeys;if(!!Bp){Bq=AU.keyarray(Bp).join(",");Bm.orignalTargetDefs=Bm.tgtDefs=t.call(Br,Bq,",");Bn=function(){Bk();AC(Bm.dataCacheUpdate.upd,function(Bz,B0){var B1=mstrmojo.all[B0];if(B1&&B1.setDirty){B1.setDirty(false);}});};}else{if(Bw.skipServerCall){Bk();return ;}Bu.requestPanelChangeDeferred(Bo,Bl,null,false,false,Br.newCallback({method:"slice",success:Bk}));return ;}}else{Bn=function(){Bk();Bt.l=true;};}var Bv=Bx.success;Bx.success=function(B0){if(!Br.checkStatus(B0)){return ;}Br.updateDefnCache(B0.defn,[Bl]);Bv(B0);Bn();var Bz=AG.call(Br,Bw.tks,0);if(Bz){Bz.clearDirtyChild(Bl);}};Bu.requestPanelChangeDeferred(Bo,Bl,Bq,true,!Bw.hasLoader,Bx);}function A6(Bk,Bl){if(Bl[AI.ELMSREADY]){Bk[AI.ELMSREADY]=Bl[AI.ELMSREADY];Bk.elms=Bl.elms;}if(Bl[AI.CESREADY]){Bk[AI.CESREADY]=Bl[AI.CESREADY];Bk.ces=Bl.ces;}if(Bl[AI.ELMSREQUEST]){Bk[AI.ELMSREQUEST]=Bl[AI.ELMSREQUEST];}if(Bl[AI.METRICVALUES]){AW.restoreMetricSelectorProps(Bk,Bl);Bk[AI.METRICVALUES]=Bl[AI.METRICVALUES];}if(Bl[AI.CSREADY]){Bk[AI.CSREADY]=Bl[AI.CSREADY];AW.restoreMetricSelectorSelections(Bk,Bl);}if(Bl[AI.DISABLED]){Bk[AI.DISABLED]=Bl[AI.DISABLED];}}function BK(Bl,Bk){if(Bl.defn&&Bl.defn.t>=Bi.GRID){mstrmojo.models.template.DataInterface.inflateGridData(Bl.data);}var Bn=Bl.id,Bm=Bk[Bn]&&Bk[Bn].data;if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&Bm&&Bl.defn.t===Bi.SELECTOR){if(!Bl.data){Bl.data={};}A6(Bl.data,Bm);}Bk[Bl.id]=Bl;return Bl;}function O(B5,Bu,Bk,Bq){var By=this.currlaykey,Bn;if(B5){Bn=B5.defn;By=(Bn&&Bn._lkz)||B5.k;}var CG=this.getLayoutDataCache(By),B6=(!Bk&&!AU.isEmpty(CG)),CC;if(!B5){CC=this.data;}else{var Bt=B5.data||B5;if(B6){CC=CG[A3.call(this,Bt,By)];CC=(CC&&CC.data)||CC||Bt;}else{CC=Bt;}}if(!!CC.sections){this._buildingLayoutKey=CC.k;}var Bl=CC?this.extractChildren(CC):[],B0=[];var B9=(Bl&&Bl.length)||0;if(B9){Bn=this.defn;var B2=!B5,Bw=B5?By:null,Bp=(B5&&((B5.defn)?B5.defn.t:f.call(this,Bn,Bw,B5.k).t));var Bm=(Bp===Bi.GRIDGRAPH),CA=(Bp===Bi.DETAILS),B8,B7;Bl=Bu(Bl);for(B8=0,B7=Bl.length;B8<B7;B8++){var CE=Bl[B8];if(Bm){CE.k=B5.k;CE.wid=B5.data.wid;}var CI=CE.k,Bx=CE.wid,B4=A3.call(this,CE,Bw),CF=!B2&&A1.call(this,CI,Bw),CD;if(!B2&&CF&&(!Bk||!this.getInfoWinByKey(CI))){var CB=this.getLayoutUnitDefn(CI),B1=BK({data:CE,defn:CB,id:B4,k:CI,p:CC},CG);if(!this.getInfoWinByKey(CI,Bx)){var Bo=this.infoWindows=this.infoWindows||{};Bo[CB.n]=B1;this.addInfoWinByKey(CI,B1);}continue;}else{if(!B2&&CF&&Bk){var Br=this.getInfoWinByKey(CI,Bx);if(Br){this.mergeInfoWin(CE,Br.data,this.getCurrentLayoutKey());}}}if(Bm){B4+="_"+B8;CD=f.call(this,Bn,Bw,CE.k+"_"+B8);}else{CD=f.call(this,Bn,Bw||CE.k,CE.k);}if(CA){CD.dt=true;}if(CG===null&&(CD.t===Bi.LAYOUT)){CG=this.getLayoutDataCache(CE.k);}var CH;if(CD.t===Bi.PANEL&&CG[B4]&&B6){var Bs=this.extractChildren(CE)||[],Bz=this.extractChildren(CG[B4].data)||[],Bv=false;if(Bs.length!=Bz.length){BN.forEach(Bz,function(CK){var CJ=BN.find(Bs,"k",CK.k);if(CJ>-1){Bs[CJ]=CK;Bv=true;}});if(Bv){Bz.splice(0,Bz.length);BN.forEach(Bs,function(CJ){Bz.push(CJ);});}}CH=CE;}else{CH=B6?(CG[B4]&&CG[B4].data)||CE:CE;}var B3={k:CE.k,id:B4,defn:CD,data:CH,p:CC};if(!CG[B4]){BK(B3,CG);}B0.push(B3);}}return Bq?{nodes:B0,total:B9}:B0;}function BP(Bq,Bl,Bp){var Bk=Ap.px2Inches,Bm=this.getZoomProps(),Bo=1,Bn=2;if((Bp&Bo)>0){Bq.FormattingPosition={Left:Bk(Bm,Bl.x||0),Top:Bk(Bm,Bl.y||0)};}if((Bp&Bn)>0){Bq.FormattingSize={Height:Bk(Bm,Bl.h||0),Width:Bk(Bm,Bl.w||0)};}}function AN(Bl){function Bk(Bn,Bm){return Bn<Bm?-1:(Bn>Bm?1:0);}Bl.sort(function(Bn,Bm){var Bo=Bk(Bn.levelID,Bm.levelID);return Bo!==0?Bo:Bk(Bn.elemID,Bm.elemID);});return Bl;}function Al(Bk,Bl){return Bk.map(function(Bm){return Bm[Bl];}).join(N);}function w(Bk){return Al(Bk,"levelID");}function X(Bk){return Al(Bk,"elemID");}function A2(Bl){if(Bl){A5={};}Ac={};var Bk=this.defn&&this.defn.epm;if(Bk){Bk.forEach(function(Bm){Bm.epmv.forEach(function(Bn){var Bp=AN(Bn.k.chn.map(function(Bs){var Br=Bs.emt!==2;return{levelID:Br?Bs.at.did:"-1",elemID:Br?Bs.ei:Bs.mt.did};})),Bq=w(Bp),Bo=X(Bp);if(!Ac[Bq]){Ac[Bq]={};}Ac[Bq][Bo]=JSON.parse(Bn.v.vv);});});}}function K(Bk){if(Bk){Bk=mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters(Bk);}return Bk;}function Ae(){var Bl=this.data&&this.data.layouts,Bk=Bl[BN.find(Bl,"k",this.getCurrentLayoutKey())],Bn=Bk&&Bk.gbys&&Bk.gbys.groupbys,Bm=false;BN.forEach(Bn,function(Bo){if(Bo.unit&&Bo.unit.elms&&Bo.unit.elms[Bo.unit.idx].v==="u;"){Bm=true;return false;}});return Bm;}function A8(Bk,Bm,Bl){Bk=Bk.replace(Bm,function(Bn,Bo){if(Bo==="&"){return(Bl+"&");}return Bl;});if(mstrmojo.dom.isIE){Bk+="&cb"+mstrmojo.now()+"=1";}return Bk;}mstrmojo.DocModel=mstrmojo.declare(mstrmojo.Model,[mstrmojo._CanProxyCallback],{scriptClass:"mstrmojo.DocModel",audibles:{"*":false,data:true,tsp:true},features:null,dataCache:null,searchElemsCache:null,controller:null,sdp:null,dpi:96,keySeed:0,currlaykey:"",init:function Bc(Bk){this._super(Bk);if(!this.features){this.features=new mstrmojo.Model();this.disposables.push(this.features);}this.ondefnChange();A2.call(this);this.buildTime=mstrmojo.now();},hasFeatures:function C(Bo){var Bm=this.features;if(!Bm){return false;}var Bl=Bo.split(","),Bk=Bl.length,Bn;for(Bn=0;Bn<Bk;Bn++){var Bp=Bl[Bn],Bq=Bp.match(/^!/);if(Bq){Bp=Bp.replace("!","");}if(!!Bq===!!Bm[Bp]){return false;}}return true;},makeObservable:function E(Bk){return AL.makeObservable(Bk);},checkStatus:function V(Bk){if(parseInt(Bk.status,10)===4){Bk.message=mstrmojo.desc(5781,"Request timed out.");mstrmojo.err(Bk);return false;}return true;},getDataService:function BI(){var Bl=this.dataService;if(!Bl){var Bk={rwb:this.bs,msgId:this.mid,stid:this.stid,cbKey:this.cbKey,model:this};if(mstrApp.modelFactory){Bl=mstrApp.modelFactory.newDataService("Document",Bk);}else{Bl=mstrApp.viewFactory.newDocDataService(Bk);}this.dataService=Bl;this.disposables.push(Bl);}return Bl;},getNextKey:function BX(){return"W"+(mstrmojo.resolveFeature("guid-as-node-identifier")?BY.create():this.keySeed++);},resetKeySeed:function At(Bk){this.keySeed=Bk;},getWidgetId:function Bd(Bk,Bl){return A3.call(this,Bk,Bl||this.getCurrentLayoutKey());},getUIState:function Az(){return{};},ondefnChange:function AF(){var Bp=this.defn,Bm=Bp&&Bp.layouts,Bl={};if(Bp){Bp.layoutMap=Bl;var Bo=(Bm&&Bm.length)||0,Bn;for(Bn=0;Bn<Bo;Bn++){var Bk=Bm[Bn];Bl[Bk.k]=Bk;}}},extractChildren:function BL(Bk){return Bk&&(Bk.sections||Bk.subsections||Bk.objects||Bk.panels||Bk.layouts||Bk.children);},getChildren:function R(Bm,Bl,Bp,Bk,Bo){Bp=Bp||0;var Bn=function(Bq){return Bq.slice(Bp,Bp+(Bk||Bq.length));};return O.call(this,Bm,Bn,Bl,Bo);},getChildrenByKey:function y(Bm,Bl,Bk,Bo){var Bn=function(Bq){var Bp=[],Br;BN.forEach(Bk,function(Bs){Br=BN.find(Bq,"k",Bs);if(Br!==-1){Bp.push(Bq[Br]);}});return Bp;};return O.call(this,Bm,Bn,Bl,Bo);},getTargetDefn:function AJ(Bk){return t.call(this,Bk);},getUnitDefinitions:function(Bl,Bk){return t.call(this,Bl,Bk);},getUnitInstance:function A(Bk,Bl){return mstrmojo.all[A3.call(this,{k:Bk,wid:Bl},this.currlaykey)];},getFirstUnitInstanceByName:function Be(Bn){var Bk=Aa.call(this,this.defn,this.currlaykey);if(Bk){var Bl=Bk.units,Bm;for(Bm in Bl){var Bo=Bl[Bm];if(Bo.n===Bn){return this.getUnitInstance(Bm,1);}}}return null;},getLayoutUnitDefn:function Am(Bl,Bk){return f.call(this,this.defn,Bk||this.currlaykey,Bl);},mergeInfoWin:function n(Bo,Bn,Bk){if(Bo.k&&Bn.k&&Bo.k===Bn.k){var Bm=this;var Bl=this.getLayoutUnitDefn(Bo.k,Bk);if(Bl&&Bl.t===Bi.PANELSTACK){BN.forEach(Bn.panels,function(Bq){var Bp=BN.filterOne(Bo.panels,function(Br){return Br.k&&Br.k===Bq.k;});if(!Bp){Bo.panels.push(Bq);}else{n.call(Bm,Bp,Bq,Bk);}});}else{BN.forEach(Bn.objects,function(Bq){var Bp=BN.filterOne(Bo.objects,function(Br){return Br.k&&Br.k===Bq.k;});if(!Bp){if(Bo.objects){Bo.objects.push(Bq);}}else{n.call(Bm,Bp,Bq,Bk);}});}}},getRawLayoutUnitDefn:function Bb(Bl,Bm,Bk){return f.call(this,Bm||this.defn,Bk||this.currlaykey,Bl,true);},getSelectedKey:function AA(Bk){return(!Bk&&this.currlaykey)||null;},getCurrentLayoutKey:function AT(){return this.currlaykey;},getLayoutKeyByUnitKey:function BQ(Bo){var Bm=this.defn,Bn=Bm&&Bm.layouts,Bk,Bl=null;BN.forEach(Bn,function(Bp){Bk=Bp.units;if(Bk[Bo]&&(!Bk[Bo]._isDeleted)){Bl=Bp.k;return !Bk[Bo];}});return Bl;},getLayoutDefn:function As(Bk){var Bl=this.defn,Bm=Bl&&Bl.layouts;return Bm&&Bm[BN.find(Bm,"k",Bk)];},getCurrentLayoutDef:function L(){return this.getLayoutDefn(this.getCurrentLayoutKey());},replaceLayout:function AR(Bs,Bl,Bt){var Bp=this.defn,Bo=this.data,Bm=Bl&&Bl.defn,Bk=Bl&&Bl.data,Bu=this.dataCache;if(Bu&&Bu[Bs]){Bu[Bs]={};}var Br=(Bo&&Bo.layouts)||(Bp&&Bp.layouts),Bn,Bq=false;for(Bn=(Br&&Br.length-1)||0;Bn>=0;Bn--){if(Br[Bn].k===Bs){break;}}if(Bt&&Bn<0){Bn=BN.find(Bk.layouts||Bm.layouts,"k",Bs);Bq=true;}this.bs=Bl.bs;if(Bk){if(Bq){BN.insert(Bo.layouts,Bn,[Bk.layouts[Bn]]);}else{Bo.layouts[Bn]=Bk.layouts[Bn];}Bo.elems=Bk.elems;}if(Bm){if(Bq){BN.insert(Bp.layouts,Bn,[Bm.layouts[Bn]]);}else{Bp.layouts[Bn]=Bm.layouts[Bn];}this.ondefnChange();}},loadLayout:function B(Bk,Bm,Bl){this.replaceLayout(Bk.currlaykey,Bk);this.raiseEvent({name:"rebuildLayout",unloadCache:!!Bm,restoreIW:!!Bl});},getLayoutDataNode:function d(Bl){var Bk=this.data&&this.data.layouts;return BN.filterOne(Bk,function(Bm){return Bm.k===Bl;});},getLayoutDataCache:function BS(Bl){if(!Bl){return null;}var Bk=this.dataCache;if(!Bk){Bk=this.dataCache={};}if(!Bk[Bl]){Bk[Bl]={};}return Bk[Bl];},saveRW:function An(Bl,Bn){var Bm=mstrmojo.desc,Bk=this.getDataService();Bk.saveRW({objName:Bl||this.n,folderID:this.pfid,saveAsFlags:1},Bn||{success:function(Bo){mstrmojo.alert(Bm(3819,"Document Saved")+": "+Bo.n);}});},saveAsRW:function Bf(Bo,Bn){var Bm=this,Bl=!!(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig&&mstrConfig.resolveOnly),Bk=Bm.prompt_option;switch(Bk){case 0:Bk=3;break;case 4:Bk=1;break;default:Bk=2;}var Bp=mstrmojo.hash.copy(Bo,{evt:3102,applyChanges:false,executionMode:2,parentFolderID:mstrApp.saveFolderId||Bm.sfid||Bm.pfid,saveFromDesignMode:false,saveAsReportSaveAsFlags:Bk,resolveOnly:Bl,rwb:Bm.bs});if(Bn){Bp.target=Bn;Bp.saveAsOrigin=13;}mstrmojo.form.send(Bp,null,"post");},getDocPropsActions:function q(Bk){var Bl={act:"setDocumentProperties",props:Bk};AU.forEach(Bk.RWDocumentProperties,function(Bn,Bm,Bo){Bo[Bm]=String(Bn);});return Bl;},saveDocProps:function Ab(Bk,Bm,Bn,Br){var Bq=this.getDataService(),Bp=Bn?null:mstrmojo.DocDataService.RAPID_EXEC,Bl=mstrmojo.DocDataService.REQUEST_DEFN_DATA,Bo=[this.getDocPropsActions(Bk)];if(Bm){this.controller.cmdMgr.execute({execute:function(){this.submit(Bo,Br||{},AU.copy(Bl,AU.copy(Bp,{})));},urInfo:Bm});}else{Bq.submitUpdates(Bo,Br||{},AU.copy(Bl,AU.copy(Bp,{preserveUndo:true})));}},partialUpdate:function BJ(Bp,Bk,Bn,Bm,Bl){if(Bn){this.updateDefnCache(Bn,Bm,Bl);}if(Bp){if(mstrApp){mstrApp.isPartialUpdate=true;}var Bo=this.updateDataCache(Bp,Bk,undefined,Bl);this.raiseEvent({name:"partialUpdate",tree:Bp,ids:Bo});if(mstrApp){mstrApp.isPartialUpdate=false;}return Bo;}},refreshDefinition:function BT(Bn,Bm,Bl,Bo){var Bk=this.getLayoutUnitDefn(Bn,Bl||this.getCurrentLayoutKey());if(!Bk){return ;}AY(Bk.t).update(this,Bk,Bm,Bo);},loadPartialData:function D(Bp,Bl){var Bn={};Bn[Bl]=f.call(this,this.defn,this.currlaykey,Bl);var Bm=this.updateDataCache(Bp,Bn),Bk=this.getLayoutDataCache(this.getCurrentLayoutKey()),Bo=this;BN.forEach(Bp.layouts,function(Bq){var Br=Bq&&Bq.xtabStyles;if(Br){Bo.raiseEvent({name:"updateStyles",key:Bq.k,updatedStyles:Br});}});AC(Bm,function(Br,Bq){if(Bq==="upd"){AC(Br,function(Bt,Bu){var Bs=mstrmojo.all[Bu];if(Bs&&Bs.update){Bs.update(Bk[Bu]);}});}});},updateDefnCache:function I(Bl,Br,Bo){var Bu=this.currlaykey,Bn=Aa.call(this,Bl,Bu),Bw=Aa.call(this,this.defn,Bu),Bs=function(Bx,By){var Bz;for(Bz in By){if(Bx[Bz]===undefined){Bx[Bz]=By[Bz];}}},Bv=Bn&&Bn.units,Bt=Bw&&Bw.units,Bm=Bn&&Bn.cgbMap,Bk=Bw&&Bw.cgbMap,Bp=Bo&&K(Bo).defn,Bq=this;BN.forEach(Br,function(Bx){Bq.refreshDefinition(Bx,Bv&&Bv[Bx],null,Bp&&Bp[Bx]);});if(Bv){Bs(Bt,Bv);}if(Bm){Bs(Bk,Bm);this.raiseEvent({name:"CGBMapChange",cgbMap:Bk});}},deleteDataCache:function A9(Bl){var Bk=this.getLayoutDataCache(this.getCurrentLayoutKey());if(Bk[Bl]){delete Bk[Bl];}},setDataReady:function A0(Bt,Bq,Bl,Br,Bk,Bu){var Bo=this.extractChildren(this.data),Bm=this.getLayoutDataCache(this.getCurrentLayoutKey()),Bp=this,Bs=false;if(!Bo){return ;}function Bn(Bv){if(!Bv){return ;}BN.forEach(Bv,function(Bw){if(Bw.k===Bt){if(Bl){Bw[Bl]=Br;}if(BN.isArray(Bk)&&Bu){BN.forEach(Bk,function(By,Bx){Bw[By]=Bu[Bx];});}else{if(Bk){Bw[Bk]=Bu;}}Bs=true;return false;}else{if(!Bs){Bn(Bp.extractChildren(Bw));}}});}Bn(Bo);if(!Bm[Bq]){Bm[Bq]={};}Bm[Bq][Bl]=Br;},updateDataCache:function e(Bv,Bu,Bk,Bo){var Bm=this.getLayoutDataCache(this.getCurrentLayoutKey()),Bl=Bo&&K(Bo).data,Bw={ifws:{},upd:{},tgts:{},def:{},secs:{}},Bq=this,Bt=function(Bz,Bx){var B0=Bq.extractChildren(Bz.data);if(B0){return ;}var B2=Bq.extractChildren(Bx);for(var By in (B2||[])){if(!!B2[By]){var B1=B2[By];if(B1.k===Bz.k){if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&B2[By]&&Bz.defn&&Bz.defn.t===Bi.SELECTOR){if(!Bz.data){Bz.data={};}A6(Bz.data,B2[By]);}B2[By]=Bz.data;}}}},Bp=function(B3,By,Bx){var B2=Bm[B3];if(Bl){var B1=mstrmojo.all[B3];if(B1){var Bz=B2.k,B0=Bl[Bz];if(B0){if(!AU.isEmpty(B0.exclude)){AU.copy(By.data,B2.data);}else{By.data=AU.copyProps(B0.serialized.split(";"),By.data,B2.data);}}}}BK(By,Bm);Bt(By,Bx);};function Bs(CD,CI,By,B1){var B3=false,CA=this.getChildren(CD,true),B8;if(!CA.length){return ;}if(By){B8=mstrmojo.all[CD.id];B3=!CD.id||!!B8;}var B2=CD.defn,Bz=CD.data,CF;if(B2&&B2.t===Bi.PANELSTACK&&B2.od){CF=Bz.selKey;}var CE,B7,CK=function(CL){return(CL.k===B7);};for(CE in CA){var CB=CA[CE],CC=CB.id,B0=null,CG;B7=CB.k;if(CI){var B4=this.extractChildren(CI);if(B4){CG=BN.filterOne(B4,CK);if(!CG){B4.push(AU.clone(CB.data));}}else{AU.copy(AU.clone(CD.data),CI);}}if(mstrmojo.all[CC]){B3=true;}if(Bu.hasOwnProperty(B7)){if(A1.call(this,B7)&&AB(CB.data,Bk)){Bp(CC,CB,CI);var CJ=this.getInfoWinByKey(B7);if(!B1&&CJ){Bw.ifws[B7]=CJ.id;}}B0=B7;if(B3){if(CF&&CF!==B7){continue;}if(!B1){Bw.tgts[CC]=true;}var Bx=B8&&B8.defn,CH=Bx&&Bx.t,B6=Bx&&Bx.ck;if(CH===Bi.SUBSECTION&&(B6&&B6.hasOwnProperty(B7))){Bw.secs[B8.id]=true;}}}if((B1||B0)&&(!CF||CF===B7)){Bp(CC,CB,CI);Bw.def[B7]=true;if(B3){Bw.upd[CC]=true;}}var B5=mstrmojo.all[CC],B2=B5?BO.getPropertyByPath(B5,"node.defn"):null;if(mstrApp.isInVFConfigMode&&B2&&B2.iifp){var B9=this.adjustNodeId(CB.id);if(mstrmojo.all[B9]){CB.id=B9;Bp(B9,CB,CI);CB.id=this.restoreNodeId(B9);Bw.upd[B9]=true;Bw.tgts[B9]=true;}else{if((B2.t===Bi.GRID||B2.t===Bi.GRAPH)&&B1&&Bu[mstrmojo.all[CB.id].k]){Bw.upd[CB.id]=true;Bw.tgts[CB.id]=true;}}}Bs.call(this,CB,CG,B3,B1||B0);}}if(Bv&&Bv.layouts&&Bu){var Bn=BN.filterOne(Bv.layouts,function(Bx){return(Bx.loaded);}),Br=this.data.layouts;if(Bn){Bs.call(this,Bn,Br[BN.find(Br,"k",Bn.k)],true);}}return Bw;},getDimensionAndPositionAction:function BU(Bl,Bk,Bn){var Bm=this.getUnitFormatAction(Bl,null,null,Bn);BP.call(this,Bm.format,Bk,3);return Bm;},getDimensionAction:function BU(Bl,Bk,Bn){var Bm=this.getUnitFormatAction(Bl,null,null,Bn);BP.call(this,Bm.format,Bk,2);return Bm;},getUnitFormatAction:function h(Bs,Bl,Br,Bn){var Bp=Bs.defn,Bt=(Bp&&Bp.t)||1,Bq=Bs.k,Bo=[Bq];var Bk={act:"format",unitKey:Bq,unitType:Bt===115?521:Bt,formatType:Bl||1,format:Br||{}};if(!Bn){Bk.partialRetrieval={nodes:Bo};}if(Bt===Bi.SELECTOR){var Bu=Bp.ck;Bk.keyContext=Bu;Bo[0]=this.getDataService().getNodeKeyFromKeyContext(Bu);}if(Bt===Bi.TEXTFIELD||Bt===Bi.IMAGE||Bt===Bi.HTMLCONTAINER){var Bm=Bs.nk||Bp.fgk;Bk.fieldKey=Bq;Bk.nodeKey=Bm;Bk.keyContext=Bt+N+Bm+N+Bq;Bo[0]=Bm;}return Bk;},updateUnitFormat:function W(Bl,Bn,Bo,Bp,Bk){var Bm=this.getUnitFormatAction(Bl,Bn,Bo);this.getDataService().submitUpdates(Bm,Bp,Bk);},selectPanelDeferred:function(Bp,Bo,Bn,Bm,Bl,Bk){F.call(this,Bp,{type:3,tks:Bo,eid:Bn,sid:Bm||1,ck:Bo,hasLoader:Bl,skipServerCall:Bk});},getSearchElemsCache:function Z(){var Bk=this.searchElemsCache;if(!Bk){Bk=this.searchElemsCache={};}return Bk;},getCGBMap:function Ai(){var Bk=Aa.call(this,this.defn,this.currlaykey);return Bk&&Bk.cgbMap;},getSliceCallback:function BC(Bk){var Bn=this,Bo={};Bo.dataCacheUpdate=null;Bo.tgtDefs=Bk.tks?t.call(this,Bk.tks):null;Bo.orignalTargetDefs=Bo.tgtDefs;var Bm=Bo.tgtDefs,Bl=function(Br){var Bs=Bm;if(Bk.disablePU){Bs=t.call(Bn,Bn.currlaykey);}AC(Bs,function(Bt){if(Bt&&Bt.set){Bt.set("readyState",Br);}});},Bq=this.newCallback({method:"slice",shared:Bo,submission:function(){Bl(BG.WAITING);},success:function(Bs){if(!Bn.checkStatus(Bs)){return ;}if(Bk.disablePU){Bn.loadLayout(Bs,Bk.isUConDS,Bk.restoreIW);return ;}if(Bs.pukeys){Bo.tgtDefs=t.call(Bn,Bs.pukeys);}Bo.dataCacheUpdate=Bn.updateDataCache(Bs.data,Bo.tgtDefs,Bk&&Bk.sid,Bs.puFilters);if(typeof Bs==="object"){AU.copyProps(["bs","exopt","dty"],Bs,Bn);}var Br={name:"partialUpdate",tree:Bs.data,ids:Bo.dataCacheUpdate,unloadCache:Bk.isUConDS};if(!mstrmojo.hash.isEmpty(Br.ids.ifws)){if(Bk&&!Bk.suppressIW&&(Bk.type===Bi.GRID||Bk.type===Bi.GRAPH)){Br.anchor=Bk.anchor;}else{Br.ids.ifws={};}}if(mstrApp){mstrApp.isPartialUpdate=true;}Bn.raiseEvent(Br);if(mstrApp){mstrApp.isPartialUpdate=false;}},complete:function(){Bl(BG.IDLE);}}),Bp={success:function(){AC(Bo.orignalTargetDefs,function(B3,B1){var B2=AG.call(Bn,B1,1);if(!B2){if(!!Bn.sdp&&!!Bn.sdp[B1]){var B0=Bn.getLayoutDataCache(Bn.getCurrentLayoutKey());var B4=A3.call(Bn,{k:B1,wid:1},Bn.getLayoutKeyByUnitKey(B1));Bn.raiseEvent({name:"secondaryDataSliced",key:B1,data:B0[B4].data});}return ;}if(Bo.dataCacheUpdate&&!Bo.dataCacheUpdate.def.hasOwnProperty(B1)){if(B2.setDirty){B2.setDirty(true);}}else{if(parseInt(B3.t,10)===Bi.PANELSTACK){B2.setDirtyChildren();}}});var Bz=Bk.events||{K0:Bk},Bv;for(Bv in Bz){var Br=AG.call(Bn,Bz[Bv].ctlKey,1);if(Br&&Bo.dataCacheUpdate&&!Bo.dataCacheUpdate.upd.hasOwnProperty(Br.id)){var By=(Br.children&&Br.children[0].selectedIndices)||{},Bu=Br.node.data,Bs=mstrmojo.DocSelector.STYLES,Bt=[];if(Br.isDynamicAttributeSelector()){Bu.exp=Br.expr;if(!Br.expr&&BN.find(Bu.elms,"v",BW.ELEM_ALL_ID)>=0){Bt.push(BW.ELEM_ALL);}}else{if(Br.style===Bs.SEARCH_BOX){var Bx=(Br.children&&Br.children[0].items)||[];BN.forEach(Bx,function(B0){Bt.push(AU.clone(B0));});}else{AU.forEach(By,function(B1,B0){if(B1){Bt.push(Bu.elms[B0]);}});}}var Bw=BN.find(Bt,"v",BW.ELEM_ALL_ID);if(Bw>-1){Bt=[Bt[Bw]];}Bu.ces=Bt;Br.selIdx=By;}}}};if(Bk.isUConDS||(parseInt(Bk.type,10)===Bi.GRAPH&&Bk.tty===1)){Bq.success=function(Br){Bn.controller.setData(Br,true);};return Bq;}if((parseInt(Bk.type,10)===3)){return Bq;}return AZ(Bq,Bp);},slice:function m(Bk){var Bl=this.getDataService(),Bm=Bl.newUpdateWithoutCmd();this.sliceDeferred(Bm,Bk);if(Bm.actions&&Bm.actions.length>0){Bl.addSuppressData(Bm.extras);Bm.submit();}},sliceDeferred:function(Bs,Bv){var Bq={};try{if(!Bv||(!mstrmojo.dom.isAndroid&&!Bv.tks&&!Bv.multiSelect&&(Bv.type===3||(Bv.type===Bi.GRAPH&&parseInt(Bv.tty,10)!==1)))){return Bq;}var Bn=this.getSliceCallback(Bv),B1=this,Bw=this.getDataService(),Bu=B1.controller.view;var B2=parseInt(Bv.type,10);if(B2===3){F.call(B1,Bs,Bv);return ;}if(Bv.multiSelect){if(Bv.selectorObjects.length>0){Bw.setMultiDocSelectorElements(Bv.selectorObjects,Bv.multiSelect,Bn);}return ;}if(B2===Bi.GRAPH){Bs.add(Bw.getGraphSelectionAction(Bv.src,Bv.cks,Bv.sid,Bv.x,Bv.y,(Bv.tty===1),Bv.w,Bv.h),Bn);if(!!Bv.showLoadingIcon){Bs.addExtras({config:mstrmojo.DocDataService.PROGRESS_CONFIG});}return ;}var Bk=Bv.events||{K0:Bv},Bt=[],B0,Bo={config:mstrmojo.DocDataService.PROGRESS_CONFIG},Bz=Bo.params={},Bx,Bl={},Bm=function(B4,B3){if(B4){Bl[B3]=B4.visName;}};for(Bx in Bk){Bv=Bk[Bx];if(!Bv){break;}if(Bv.hasOwnProperty("eid")){if(Bv.isUConDS){Bv.disablePU=true;}if(Ae.call(this)){Bv.disablePU=true;Bv.restoreIW=true;}B0=Bw.getSelectorElementsAction(Bv);if(B1.sdp){Bl={};AC(B1.sdp,Bm);Bz.sdpKeys=JSON.stringify(Bl);}if(Bv.disablePU){Bz.disablePU=true;}}else{if(Bv.fromGM){B0=Bw.getSelectorFromGMAction(Bv);}else{if(parseInt(Bv.srct,10)===4||Bv.fid){if(Bv.fid&&Ae.call(this)){Bv.disablePU=true;}B0=Bw.getSelectorExpressionAction(Bv);}else{if(Bv.unset){B0=Bw.getUnsetSelectorAction(Bv);}else{if(Bv.expr){B0=Bw.getAttributeSelectorExpressionAction(Bv);}else{if(parseInt(Bv.ct,10)===6){B0=Bw.getMultiUnitSelectorAction(Bv);B1.hasUnitSelector=Bv.selections&&Bv.selections.hasElements;}else{B0=Bw.getSelectorIncludeAction(Bv);}}}}}}Bt.push(B0);}Bs.add(Bt,Bn,Bo);var Br=function(B3){B3.extras.style={params:{treesToRender:3}};B3.callback=AZ({success:function B4(B5){B1.partialUpdate(B5.data,B1.getUnitDefinitions(Bv.cgb),B5.defn,Bv.cgb,B5.puFilters);}},B3.callback);return B3;};if(Bv.isNavigation){var Bp=(Bu._layouts||[]).filter(function(B3){return B3.k===Bv.layoutKey;})[0];if(Bp){if(!Bu.showLayout(Bp,null,Bs,Bv.panelKey)){Bs=Br(Bs);Bu.showPanel(Bv.panelKey,Bv.layoutKey,Bs);}}else{Bu.loadDocLayout({layoutKey:Bv.layoutKey,panelKey:Bv.panelKey},null,Bs);}}else{Bs=Br(Bs);}}catch(By){mstrmojo.err(By);}},getInfoWindow:function U(Bl){var Bk=this.infoWindows;return Bk&&Bk[Bl];},getTargetInfoWin:function(Bl){var Bk=[],Bm=t.call(this,Bl);if(Bm){var Bn;for(Bn in Bm){if(Bm[Bn]&&Bm[Bn].ifw){Bk.push(Bn);}}}return Bk;},cleanInfoWindowCache:function A7(){this.infoWinByKey={};},addInfoWinByKey:function Bg(Bl,Bk){if(!this.infoWinByKey){this.infoWinByKey={};}if(!this.infoWinByKey[Bl]){this.infoWinByKey[Bl]=[Bk];return ;}if(BN.find(this.infoWinByKey[Bl],"id",Bk.id)===-1){this.infoWinByKey[Bl].push(Bk);}},getInfoWinByKey:function u(Bm,Bk){var Bn=null,Bl=this.getCurrentLayoutKey();if(this.infoWinByKey&&this.infoWinByKey[Bm]){BN.forEach(this.infoWinByKey[Bm],function(Bo){var Bp=Bo&&Bo.id;if(Bp&&Bp.indexOf(Bm)>-1&&Bp.indexOf(Bl)>-1){if(!Bk||Bp.indexOf("*x"+Bk)>-1){Bn=Bo;return false;}}});}return Bn;},showInfoWin:function J(Bo,Bn,Bl,Bp,Bq,Bk){var Bm=this.getInfoWinByKey(Bo,Bk);if(Bm===null){return ;}this.raiseEvent({name:"showInfoWin",psId:Bm.id,psKey:Bm.k,anchor:Bn,anchorOrientation:Bl,anchorPosition:Bq,invalidate:Bp});},getSelectedXtabStyles:function G(Bm){var Bl=Bm||this.currlaykey;var Bo={};var Bk=this.data&&this.data.layouts,Bn;for(Bn in Bk){if(Bk[Bn].k===Bl){Bo=Bk[Bn].xtabStyles;break;}}return Bo;},downloadGridData:function BH(Bp,Bq){var Bn=this,Bm=Bp.xtabId,Bl=Bp.memo,Bo=mstrmojo.all[Bm],Bk=this.newCallback({success:function(By){function Br(B2,B4){var B5=Bn.getChildren(B2,true),B3=B5.length,B1;for(B1=0;B1<B3;B1++){var B6=B5[B1];if(B4===B6.id){return B6;}var B0=Br(B6,B4);if(B0){return B0;}}return null;}var Bv=Aa.call(Bn,By.data,Bn.currlaykey);if(Bv){if(Bn.restoreNodeId){Bm=Bn.restoreNodeId(Bm);}var Bu=Br(Bv,Bm);if(Bu){mstrmojo.models.template.DataInterface.inflateGridData(Bu.data);if(Bo){Bo.dataDownloaded(Bu,Bl);}}var Bx=Bv.xtabStyles;if(Bx){Bn.raiseEvent({name:"updateStyles",key:Bv.k,updatedStyles:Bx});}}var Bw=f.call(Bn,Bn.defn,Bn.currlaykey,Bp.nodeKey);if(Bw&&Bw.t===Bi.GRIDGRAPH&&Bl.recalculating){var Bt=Bo.parent,Bz=Bt&&Bt.getGraphWidget();if(Bz&&Bt.updateGraph){Bt.updateGraph(Br(Bv,Bz.id));}}if(By.pukeys){var Bs=t.call(Bn,By.pukeys);delete Bs[Bp.nodeKey];if(!AU.isEmpty(Bs)){Bn.partialUpdate(By.data,Bs);}}},failure:function(Br){if(Bo.dataDownloadErr){Bo.dataDownloadErr(Br);}else{mstrmojo.emptyFn();}}});this.getDataService().downloadGridData(Bp,AZ(Bk,Bq));},clearDisposables:function o(){var Bk=[];BN.forEach(this.disposables,function(Bl){if(Bl._lkz){Ah(Bl);}else{Bk.push(Bl);}});this.disposables=Bk;},getFixedHeaders:function(Bl,Bk){return BZ.call(this,Bl,Bk,[Bi.PAGEHEADER],true);},getFixedFooters:function(Bl,Bk){return BZ.call(this,Bl,Bk,[Bi.PAGEFOOTER],true);},getNonFixedSections:function(Bl,Bk){return BZ.call(this,Bl,Bk,[Bi.PAGEHEADER,Bi.PAGEFOOTER],false);},addAutoWidthID:function Ax(Bm){var Bl=this.aws||{},Bk=Bl[this.currlaykey]||[];Bk.push(Bm);Bl[this.currlaykey]=Bk;this.aws=Bl;},getAutoWidthIDs:function AD(){var Bm=this.aws,Bk=this.currlaykey;var Bl=Bm&&Bm[Bk];if(Bl){delete Bm[Bk];}return Bl;},getTransactionUpdates:function AM(Bk){return this.txDiscardTargets?"":BV.call(this,Bk);},clearTransactionUpdates:function AS(Bk){this.clearTxDeltaUpdate(Bk);},resetTransactionUpdates:function Bj(Bk){var Bl=this.pendingUpdate,Bm=this.delta;if(Bl&&Bl[Bk]){AC(Bl[Bk],function(Bn,Bo){if(Bm&&!Bm[Bo]){Bm[Bo]=Bn;}});delete Bl[Bk];}},transactionUpdate:function BB(Bm,Bl){if(!Bm.data){return null;}var Bo;if(Bl&&Bl.tks){Bo=t.call(this,Bl.tks);}if(Bm.pukeys){Bo=t.call(this,Bm.pukeys);var Bp;for(Bp in Bo){if(Bo[Bp]&&Bo[Bp].cek){Bo[Bp].cek=null;}}}if(Bm.txrcd){this.txrcd=Bm.txrcd;}else{delete this.txrcd;}var Bn=this.updateDataCache(Bm.data,Bo,Bl&&Bl.sid),Bk={name:"partialUpdate",tree:Bm.data,ids:Bn};if(!AU.isEmpty(Bn.ifws)){if(Bl&&Bl.type===Bi.GRID){Bk.anchor=Bl.anchor;}else{Bn.ifws={};}}this.raiseEvent(Bk);return Bn;},deltaUpdate:function BA(Bk){var Bl=this.delta;if(!Bl){Bl=this.delta={};}Bl[Bk.id]=Bk;},clearTxDeltaUpdate:function A4(Bl){var Bo=this.txDiscardTargets,Bk=!Bo,Bn=this.pendingUpdate,Bm=this;if(!Bk){AC(Bo,function(Bp,Bq){if(Bm.delta&&Bm.delta[Bq]){Bm.delta[Bq].clear();delete Bm.delta[Bq];}});}if(Bn&&Bn[Bl]){AC(Bn[Bl],function(Bp){Bp.clear();});delete this.pendingUpdate[Bl];}},sendTransactionActions:function x(Bl,Bk,Bn){var Bm=this;mstrmojo.mask.show("Running");if(!Bn){Bn={success:function(Bo){Bm.transactionUpdate(Bo);}};}Bm.getDataService().sendTransactionActions({keyContext:Bl,actions:Bk,txrcd:this.txrcd},mstrmojo.func.wrapMethods(Bn,{complete:function(){mstrmojo.mask.hide();}}));},sendTransactionUpdates:function Y(Bk){var Bm=this.getSliceCallback(Bk),Bl=this.getDataService();Bl.submitUpdates([Bl.getUpdateTransactionAction(Bk)],Bm);},addSDP:function Ad(Bl,Bk){if(!Bl||!Bk){return ;}if(!this.sdp){this.sdp={};}this.sdp[Bl]={k:Bk.k,visName:Bk.visName};},removeSDP:function AH(Bk){if(!Bk||!this.sdp||!this.sdp[Bk]){return ;}delete this.sdp[Bk];},getUpdateColorMapCallback:function s(){var Bk=this;return{success:function(Bl){Bk.defn.epm=Bl.defn&&Bl.defn.epm;A2.call(Bk);Bk.raiseEvent({name:"colorMapChanged"});}};},getUpdateThemePaletteCallbackHandler:function c(Bk){var Bl=this;return{success:function(Bm){Bl.thm=Bm.thm;Bl.plt=Bm.plt;Bl.defmts=Bm.defmts;A2.call(Bl,!Bk);Bl.layoutstyle=Bm.layoutstyle;}};},getUpdateThemePaletteCallback:function AE(Bm){var Bn=this,Bk,Bl;if(mstrApp.isInVFConfigMode){mstrApp.requireRestoreVFConfigMode=true;Bk=Bn.getVIMap().getComponent(Q);Bl=mstrApp.getRootController();mstrApp.isInVFConfigPage=false;Bl.view.closeInlineDialog();Bn.destroyVisualiztionselector();Bl.restorePanelStatus(Bk);Bl.maskMenuToolbar(false);}return this.getUpdateThemePaletteCallbackHandler(Bm);},getCurrentPaletteColors:function S(){return(this.plt&&this.plt.colors)||AP;},getCurrentPaletteId:function BM(){return this.plt&&this.plt.did;},getCurrentDefaultPaletteId:function Aj(){return(this.thm&&this.thm.dplt)||Aw;},getCurrentLayoutStyle:function AQ(){return this.layoutstyle||AX;},getColorBy:function(Bq,Bk){var Bo=Bk.map(function(Bs,Br){return{levelID:Bq[Br].toString(),elemID:Bs};});if(Bo&&Bo.length>1){AN(Bo);}var Bp=w(Bo),Bn=X(Bo),Bm=A5[Bp];if(!Bm){Bm=A5[Bp]={_currentColorIdx:0};}if(!Bm[Bn]){var Bl=this.getCurrentPaletteColors();Bm[Bn]=Bl[Bm._currentColorIdx];Bm._currentColorIdx=(Bm._currentColorIdx+1)%Bl.length;}if(Ac[Bp]&&Ac[Bp][Bn]){return{color:Ac[Bp][Bn].color,isManual:true};}return{color:Bm[Bn],isManual:false};},getZoomFactor:function k(){return this.getCurrentLayoutDef().zf||1;},getZoomProps:function BE(){return{dpi:this.dpi,zf:this.getZoomFactor()};},executeLink:function H(Bk,Bm,Bo){if(Bk.indexOf("prevMsgID")>0){Bk=A8(Bk,/prevMsgID=0($|&)/g,"prevMsgID="+this.mid);}if(Bk.indexOf("originMessageID")>0){Bk=A8(Bk,/originMessageID=[a-zA-Z0-9]*($|&)/g,"originMessageID="+this.mid);}Bk=mstrmojo.addCSRFTokenToURL(Bk);if(Bk.indexOf(mstrApp.name+"=")===-1&&!mstrmojo.isUrlExternal(Bk)){var Bn=mstrApp.servletState||mstrConfig.servletState||"";var Bl=mstrApp.name+"="+window.encodeURIComponent(Bn);if(Bk.indexOf("?")>-1){Bk+="&";}else{Bk+="?";}Bk+=Bl;}this.controller.onLink(this,{url:Bk,target:Bm,src:Bo||null,submitAsPost:!mstrmojo.isUrlExternal(Bk)});},getDatasetUnits:function BR(Bl,Bk,Bn,Bp){var Bo=this.datasets,Bm=[];AU.keyarray(Bo).forEach(function(Br){if(!Bn||Br===Bn){var Bs=Bo[Br],Bq=Bs,Bt=[];Bl.forEach(function(Bu){if(Bp!==undefined){Bq=Bs.tables[Bp];}(Bq[Bu]||[]).forEach(function(Bv){if(!Bk||Bk(Bv)){Bt.push(Bv);}});});Bm=Bm.concat(Bt.map(function(Bu){return mstrmojo.hash.copyProps(["did","attId","n","t","st","ndetype","formType","dt","f","hide","usedInDropZones","card","lock","fs","lvfs"],Bu,{ds:Bs.name,dsId:Br,dm:!!Bu.um,da:!!Bu.da,de:!!Bu.de});}));}});return Bm;},getMapLayerKeys:function AK(Bk){if(Bk&&Bk.getSdpKeyArr){return Bk.getSdpKeyArr();}return[];},getDeleteMapLayersActions:function BD(Bm){var Bk,Bn=[],Bl=this;(Bm||[]).forEach(function(Bo){Bk=Bl.getLayoutUnitDefn(Bo);Bn.push({act:"removeUnit",unitKey:Bo,unitType:(Bk&&Bk.t)||522});});return Bn;},syncLayerDefn:function i(Bo,Bm,Bl){var Bn=this.getCurrentLayoutDef(),Bk=(Bn&&Bn.units)||{};(Bm||[]).forEach(function(Bp){if(Bk[Bp]){if(Bl){Bk[Bp]._isDeleted=true;}else{delete Bk[Bp]._isDeleted;}}});if(Bl){mstrApp.primaryScdpMap[Bo]=[];}else{mstrApp.primaryScdpMap[Bo]=Bm;}},getFormatSDPAction:function Ay(Bm,Bl){var Bk={FormattingWidget:{SecondaryDataProviders:Bl.join(",")}};return this.getUnitFormatAction(Bm,1,Bk,true);},addMapLayerActions:function Aq(Bx,Bp,Bs,Br){var Bt=this.getNextKey(),Bn=this.getPanel().k,Bw=Bx.scriptClass==="mstrmojo.mapbox.VisMapbox",Bl=Bw?z.MAPBOX:z.GOOGLE_MAP,Bk=Bw?a.MAPBOX:a.GOOGLEMAP,Bv=this.getWidgetClassNameByStyle(Bl,Bk),Bu=this.getMapLayerKeys(Bx),Bm=Bx.defn.tt,Bq={k:Bt,defn:{t:521}},Bo={FormattingAppearance:{Visible:0,Name:Br}};Bp.push(this.getCopyEmptyTemplateAction(Bt,Bn));Bp.push({act:"updateTemplate",keyContext:Bt,actions:[{act:"createDefaultDropZones",nodeKey:Bt,treeType:Bm,datasetType:3,widgetType:Bk}]});Bp.push(this.getUnitChangeVizAction(Bl,Bv,Bq,Bs,Bo));Bp.push({act:"changeGridDisplayMode",nodeKey:Bt,displayMode:1});Bp.push(this.getFormatSDPAction(Bx,Bu.concat(Bt)));return Bt;},removeMapLayerActions:function l(Bm,Bl,Bn){var Bk=this.getLayoutUnitDefn(Bl);Bn.push({act:"removeUnit",unitKey:Bl,unitType:(Bk&&Bk.t)||522});Bn.push(this.getFormatSDPAction(Bm,this.getMapLayerKeys(Bm)));},removeGeometryInfoActions:function Bh(Bn,Bk){var Br=Bn.zonesModel.getZoneModelByZoneId(Ba.Geometry),Bq=Br&&Br.items&&Br.items[0],Bl;if(Bq){if(Bq.fs){if(Bq.fs.length===1){Bl=[{act:"removeDropZoneUnit",zoneId:Ba.Geometry,unitId:Bq.did,unitType:Bq.t}];}else{var Bm=p.getGeometryForm(Bq);Bl=[{act:"removeForm",unitId:Bq.did,unitType:Bm.t,attFormId:Bm.fid}];}}else{var Bp=Bn.zonesModel.getZoneModelByZoneId(Ba.GeoAttribute),Bo=Bp&&Bp.items&&Bp.items[0];Bl=[{act:"removeForm",unitId:Bo.did,unitType:Bq.t,attFormId:Bq.did}];}Bk.push({act:"updateTemplate",keyContext:Bn.k,actions:Bl});}return Bk;},getExtraActionsForChangeMapViz:function b(Bm,Bl,Bp){var Bn=Bm.parent,Bo,Bk=this;if(Bl&&Bl.length>0){BN.forEach(Bl,function(Bq){if(!Bm.isPrimaryKey(Bq)){Bo=Bk.clearVisAsFilterActionForMapLayer(Bn,Bm.fnGetWidget(Bq),true);if(Bo&&Bo.actions){Bp=Bp.concat(Bo.actions);}}});Bp=Bp.concat(this.getDeleteMapLayersActions(Bl));Bp.push(this.getFormatSDPAction(Bm,[]));this.syncLayerDefn(Bm.k,Bl,true);}return Bp;},isMapLayerNode:function Ag(Bl){var Bk=false;AU.forEach(mstrApp.primaryScdpMap,function(Bm){if(Bm.indexOf(Bl)>=0){Bk=true;return false;}});return Bk;},getHostKeyByNodeKey:function Av(Bl){var Bk=Bl;AU.forEach(mstrApp.primaryScdpMap,function(Bn,Bm){if(Bn.indexOf(Bl)>=0){Bk=Bm;return false;}});return Bk;},getMapLayersDataByHostKey:function P(Bq){var Bm={},Bp,Bo=this,Bn=mstrApp.primaryScdpMap[Bq],Bl=this.getCurrentLayoutKey(),Bk=this.getLayoutDataCache(Bl);BN.forEach(Bn,function(Br){Bp=Bk[A3.call(Bo,{k:Br,wid:1},Bl)];Bm[Br]=Bp&&Bp.data;});return Bm;},getNodeDataByKey:function Ak(Bl){var Bm=this.getLayoutKeyByUnitKey(Bl),Bk=this.getLayoutDataCache(Bm);return Bk&&Bk[A3.call(this,{k:Bl,wid:1},Bm)];},getMapLayerDataByLayerKey:function Ak(Bk){var Bl=this.getNodeDataByKey(Bk);return Bl&&Bl.data;},updatePrimaryScdpMap:function BF(Bo,Bm,Bl){var Bk,Bn=mstrApp.primaryScdpMap[Bo];if(!Bn){Bn=mstrApp.primaryScdpMap[Bo]=[];}Bk=Bn.indexOf(Bm);if(Bl&&Bk<0){Bn.push(Bm);}else{if(!Bl&&Bk>=0){Bn.splice(Bk,1);}}},updateWidgetsProps:function M(){this.raiseEvent({name:"updWgtsProps"});},restoreVFConfigMode:function AV(){var Bk=this;return{success:function(){if(mstrApp.requireRestoreVFConfigMode){mstrApp.requireRestoreVFConfigMode=false;var Bo=Bk,Bl=mstrApp.isVFEditingMode,Bn=mstrApp.restoreVFKey,Bm=mstrApp.restoreVFTitle;Bo.checkLargeItemsForVisFilter(Bn,function(){var Bp=Bo.addVisFilterContainer(),Bs=Bo.getSelectedViUnit(),Br;Bo.oldSelectedVizBoxId=Bs.id;mstrApp.isInVFConfigMode=true;Br=Bo.insertVizBox(Bn,Bp,{});Bo.controller.rootCtrl.initPanelStautsInConfigMode();Bo.selectVIUnit(Br.id,true,{isAddAction:true});mstrApp.getRootController().enterVizFilterConfigMode(Bm,Bl);if(Bl===false){mstrApp.restoreVFCreate=true;var Bq=mstrmojo.all.visualizationFilterToolbar;Bq.toggleSaveBtn(mstrApp.isEnableSaveBtn);}});}}};},getWidgetClassNameByStyle:function Ao(Bm,Bl){var Bk=mstrmojo.ExpressVisList.findWidgetName(Bm)||Au[Bm];if(!Bk&&parseInt(Bl)===a.CUSTOM){Bk=AO;}return Bk||"";},clearColorByMap:function j(){A5={};}});mstrmojo.DocModel.fnBuildId=A3;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu","mstrmojo.vi.ui.TargetSelector","mstrmojo.vi.ui.FilterBoxInlineDialog","mstrmojo.Label","mstrmojo.dom","mstrmojo.css","mstrmojo.func","mstrmojo.hash","mstrmojo.tooltip","mstrmojo.DocSelector","mstrmojo.vi.ui._HasMask","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.vi.models.EnumDragSources","mstrmojo.models.FormatModel","mstrmojo.EnumRWUnitType");var I=mstrmojo.css,W=mstrmojo.dom,AD=mstrmojo.func,AF=mstrmojo.string,Y=mstrmojo.hash,D="\u001E",x=mstrmojo.EnumRWUnitType,w=mstrmojo.models.FormatModel,y=w.getFormatUpdate,q=w.ENUM_PROPERTY_NAMES,U=mstrmojo.DocSelector.STYLES,Z=mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY,n=mstrmojo.DocDataService.EnumTreesToRender;function M(AK){return AK&&AK.did!=="-1"&&AK.t!==14;}function S(AK){var AL=AK.getCtxtDragData();return(AL.items||[]).filter(M)[0];}function E(AL){var AM=AL.getCtxtDragData(),AK=AM.items||[];return AM.src&&AK.some(M);}function AH(){return !!this.boxContent.defn.srcid;}function L(){var AL=this.boxContent.defn.srcid,AK=this.model.getDatasetUnits(["att","mx"],function(AM){return AM.did===AL;});return(AK.length&&AK[0])||null;}function P(){var AK=this;this.showControlOverlay([mstrmojo.Button.newWebButton(mstrmojo.desc(1088,"Edit"),function(){var AL=AK.boxContent;if(AL&&AL.expandOrEditToFetchElements){AL.expandOrEditToFetchElements();}AK.hideControlOverlay();},false,{alias:"ctrlEditBtn",enabled:true,cssClass:"filterBoxEdit"})]);I.toggleClass(this.ctrlOverlay&&this.ctrlOverlay.domNode,"editOverLay",true);}function AG(AK){return{scriptClass:"mstrmojo.vi.ui.FilterBoxInlineDialog",vis:AK};}function J(){var AK=this,AL=mstrmojo.Button.newWebButton(mstrmojo.desc(4799,"Select Target"),function(AM){var AN=mstrmojo.all[AK.id];mstrApp.rootCtrl.view.openInlineDialog(AG(AN));AM.cancel();},true,{alias:"btnSelect"});AL.cssClass+=" btn-select-targets";this.showControlOverlay([AL]);this.setSelectTargetsState(true);}function R(){var AK=this.boxContent;if(AK.isInvalid){this.showInvalidMessage();return ;}if(!AH.call(this)||(mstrApp&&(mstrApp.isAppStatePresentation()||mstrApp.isAppStatePrintPreview()))){return ;}if(this.getTargetKeys().length>0){if(Y.walk("boxContent.node.data.disabled",this)){P.call(this);}else{this.hideControlOverlay();}return ;}J.call(this);}function g(){return !this.defn.ob;}function AJ(AK){this.set("useRichTooltip",AK);}function V(){I.toggleClass(this.domNode,"horizontal",!!this.defn.horiz);}mstrmojo.vi.ui.rw.FilterBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,[mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu,mstrmojo.vi.ui._CanDropFromSchema,mstrmojo.vi.ui._HasMask],{scriptClass:"mstrmojo.vi.ui.rw.FilterBox",targetSelector:null,useRichTooltip:true,isDynamicTooltip:true,tooltipOpenDelay:Z,maskTooltip:mstrmojo.desc(15274,"Selector cannot be selected as target"),allowFilters:true,markupMethods:Y.mergeHashes(mstrmojo.vi.ui.rw.UnitContainer.prototype.markupMethods,{onenabledChange:function(){I.toggleClass(this.domNode,"inactive",!this.enabled);this.targetMask.set("useRichTooltip",!this.enabled);}}),init:function AE(AK){this._super(AK);I.addWidgetCssClass(this,"mstrmojo-FilterBox");},onclick:function p(AK){var AO=W.isPrimaryMouseBtn(AK.e),AL=AH.call(this),AN=W.contains(this.containerNode,AK.getTarget(),true,this.domNode),AM;if(AO&&AL){if(AN){AM=true;AK.e.ptvSelected=true;}else{if(!W.contains(this.titlebarNode,AK.getTarget(),true,this.domNode)){AK.e.ptvSelected=true;}}}this._super(AK);if(AM){this.getEditorModel().selectTargetByValue(mstrmojo.vi.models.editors.FilterEditorModel.SELECTOR_VALUE);}},moveTooltip:function c(AK,AM){var AL=W.findWidget(AK.target);if(AL.id!==this.boxContent.id){return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:this.getTooltipContent(),top:AK.clientY+15,left:AK.clientX-15};this._super(AK,AM);},getTooltipContent:function AI(){var AN=L.call(this),AM=AN&&AN.n,AK=this.getDisplayName(),AL=(AK!==AM);return('<div class="name">'+AF.encodeHtmlString(AK,true)+"</div>"+(AL?('<div class="dsc">'+AF.encodeHtmlString(mstrmojo.desc(15112,"Name in Dataset:")+" "+AM,true)+"</div>"):""));},setSelectTargetsState:function h(AK){var AL=(this.ctrlOverlay||{}).btnSelect;if(AL){AL.set("enabled",AK);AL.set("visible",AK);}},postBuildRendering:function d(){V.call(this);this._super();this.generateToolbar();var AK=this.boxContent;if(!AH.call(this)){this.setSelectTargetsState(false);AK.set("visible",false);this.showControlOverlay([{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(13258,"Drag object here.")}]);}else{if(AK&&AK.isInvalid){this.showInvalidMessage();}else{if(!this.getTargetKeys().length&&!mstrApp.isAppStatePresentation()){J.call(this);}else{if(Y.walk("node.data.disabled",AK)){P.call(this);}}}}var AL=L.call(this);if(!AL){this.set("title","");this.defn.set("ttl","");}if(this.model){I.toggleClass(this.domNode,"items-fit-content",this.model.itemsFitContent);}},showInvalidMessage:function O(){this.showControlOverlay([{scriptClass:"mstrmojo.Label",cssClass:"invalidMsg",text:this.boxContent.getInvalidTooltip()}]);},onRender:function G(){if(this._super){this._super();}AJ.call(this,!this.showTitleBar);if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&this.model&&this.model.hasRADataset()){this.set("isMasked",true);}},orientationHasChanged:function l(){if(g.call(this)){var AK=this.orientation,AN=AK==="h",AM=this.boxContent,AL=AM.content;this.defn.horiz=AN;if(AM.isRecursiveAttributeSelector()&&AL.isHoriz!==AN){this.rebuildBoxContent(AM.node);this.doLayout();}else{AL.isHoriz=AN;AL.set("orientation",AK);}V.call(this);}},addFormatProps:function z(AM,AL){AM=this._super(AM,AL);var AK=this.orientation;if(this.boxContent.content.orientation!==AK&&g.call(this)){AM=AM||this.model.getUnitFormatAction(this,NaN,null,AL);mstrmojo.models.FormatModel.getFormatUpdate(mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES.CONTROL_ORIENTATION,AK==="v"?0:1,AM.format);this.defn.horiz=AK==="h";if(!AL){window.setTimeout(function(){this.parent.rebuildChild(this);}.bind(this),0);}}return AM;},createDeleteUpdate:function o(){var AK=this.model,AL=AK.getRemoveControlUpdate(this.k,this.parent.k,this.defn.tks||"");if(this.defn.tks&&this.boxContent.isFilterNothing&&!this.boxContent.isFilterNothing()){AL.setTreesToRender(n.BOTH);}AL.addUpdate(AK.associatedNodesUpdate(this.parent.children));return AL;},updateToolbar:function t(AK){R.call(this);var AL=this.boxContent;if(this.canShowDesignMenuItems()&&AL&&AH.call(this)){this.addModeMenuItems(AK,AL);AK.addSeparator();this.addClearFilterMenuItem(AK,AL);AK.addSeparator();this.addQualMenuItems(AK,AL);this.addSetDisplayFormsMenuItem(AK,AL);AK.addSeparator();this.addFilterStyleMenuItem(AK,AL);this.addMultiSelectMenuItem(AK,AL);this.addAutoSearchMenuItem(AK,AL);AK.addSeparator();this.addMenuItemIfSelectTargetsValid(AK,AL,mstrmojo.desc(12288,"Target the following visualizations or filters:"));AK.addSeparator();this.addToggleTitleMenuItem(AK);AK.addSeparator();this.addReplaceWithMenuItem(AK,AL);AK.addSeparator();this.addBFAMenuItem(AK,AL);}return this._super(AK);},showControlOverlay:function m(AL,AK){this._super(AL,AK);I.addClass(this.domNode,"overlay");},hideControlOverlay:function C(){this._super();I.removeClass(this.domNode,"overlay");},onAppStateChange:function s(AK){var AN=mstrmojo.vi.VisualInsightApp.APP_STATES,AL=mstrApp.isAppStatePause(),AM=!!(AK.valueWas&AN.PAUSE);if(AL!==AM){if(this.model.hasRADataset()){this.set("isMasked",AL);}}if(this._super){this._super(AK);}},addContextMenuItems:function AB(AM,AL){this._super(AM,AL);var AK=this.boxContent;if(AH.call(this)&&!(AK&&AK.isInvalid)){this.addMenuItemIfSelectTargetsValid(AM,AK,mstrmojo.desc(12288,"Target the following visualizations or filters:"),false);}if(AK&&AK.isInvalid){this.addDeleteMenuItem(AM);}return AM;},getFormatMenuItemTarget:function H(AK){if(!AK||!W.contains(this.titlebarNode,AK.getTarget(),true,this.domNode)){return mstrmojo.vi.models.editors.FilterEditorModel.SELECTOR_VALUE;}return this._super(AK);},getTargetInfo:function b(){var AO=this.parent,AM=this.model,AK=this.boxContent,AN=[x.GRID,x.GRAPH,x.MOJOVISUALIZATION].concat(AM.isFromSolrCube(AK.defn.srcid)?[]:[x.SELECTOR]),AL=(AO&&AO.getTargetKeysByType(AN)).map(function(AP){var AR=AO.getUnitByKey(AP),AQ=AR.defn;return{n:AR.getDisplayName(),id:AP,st:AQ.style,src:AM.getObjectInfo(AQ.srcid)};}).filter(function(AP){return AP.id!==this.k&&AP.st!==U.ATTR_QUAL;},this)||[];return{keys:this.getTargetKeys(),items:AL};},toggleTitleBar:function f(AK){this._super(AK);AJ.call(this,!AK);},getDisplayName:function F(){return this._super()||mstrmojo.desc(6189,"Filter");},updateDisplayName:function K(AK,AL){this._super(AK,AL,true);},getAvatarCls:function u(){return this._super().concat(["filterAvatar"]);},allowDropFromDataset:function e(AK){return !AH.call(this)&&E.call(this,AK)&&mstrApp.allowWebDashboardDesign();},dropFromDataSource:function AC(AM){var Aa=S.call(this,AM),AW=this.id,Ac,AV,AU;if(Aa){var AN=this.getDocModel(),AY=AN.getDataService(),AO=this.defn,AL=this.getTargetKeys(),AZ=[this.k].concat(AL),AK=this.boxContent,AT=Y.valarray(AO.cgb).map(function(Ad){return[Ad,true];}),AS=(AM.actions||[]).concat([AY.getSetCtrlSourceAction(AO.ck,Aa.did,Aa.t,AT)]),AP=AD.wrapMethods(AM.callback,{success:function(Ad){var Ae=mstrmojo.all[AW];AN.partialUpdate(Ad.data,AN.getTargetDefn(AZ.join(D)),Ad.defn,[AK.defn.ckey]);if(!(mstrApp.isAppStatePause&&mstrApp.isAppStatePause())){Ae=Ae.parent.rebuildChild(Ae);}Ae.boxContent.set("visible",true);Ae.generateToolbar();}});this.titleBar.titleEdited(Aa.n,true,"");Ac=AN.getCtrlStyleFromDatasetUnit(Aa);AS=AS.concat(AN.getCtrlActionsByStyle(Aa,AK.ck,Ac,this.orientation==="v"?0:1,parseInt(this.height,10),parseInt(this.width,10)));AU=this.height;AV=0;if(Aa.t===4){AS.push(AN.getUnitFormatAction(this,5,y(q.SHOW_TITLE_BAR,true)));if(AU==="40px"){AV=20;}}if(this.orientation==="h"){var AX=this.parent,Ab=AX.boxLayoutConfig,AR=Ab.box,AQ=AR&&AR.children&&AR.children[Ab.getBoxPath(this)];AV=AV+AN.getICSCtrlMoveHeightByStyle(Ac);if(AQ&&AQ.f){AQ.l=AQ.l+AV;AS=AS.concat(AX.getChildPositionActions(true));AS=AS.concat(AX.getBoxLayoutActions(true));}}AN.submitDataDefnUpdate(AS,AP);}},dropFromDataset:function X(AK){this.dropFromDataSource(AK);},dropFromAllObjects:function AA(AK){this.augmentDropContextForSchema(AK,this.getDocModel());this.dropFromDataSource(AK);},validateTarget:function B(AK){return true;},setTargets:function i(AK){this.getDocModel().changeFilterTargets(this,this.getTargetKeys(),AK,true,true);},getTargetKeys:function A(){var AK=this.defn.tks;return(AK&&AK.split(D))||[];},isSelectionDirty:function Q(AK){return AK.length;},getTitleBarCfg:function N(){var AK=this._super(),AL=this;AK.titleEdited=function AM(AO,AS,AN){var AR=this.parent,AU={success:function AT(AV){AR.defn.ttl=AV;AR.set("title",AV);},failure:function AQ(AV){mstrApp.onerror(AV);AR.titleBar.set("title",AN);}};if(AS){var AP=AR.getDocModel();AP.updateTitle(AO,this.title,AR.k,AP.currlaykey,"ttl",AU);}AR.editingTitleCallback(false);};AK.getTooltipContent=function(){return AL.getTooltipContent();};AK.shouldShowTooltip=function(){return true;};AK.tooltipOpenDelay=Z;return AK;},applyCSSFormatToNode:function k(AL,AK){var AN=this.boxContent;if(AN&&AN.content&&AN.content.hasRendered){var AM=AN._inSyncPhase;AN._inSyncPhase=true;AN.content.refresh();AN._inSyncPhase=AM;}this._super(AL,AK);},getBoxConfiguration:function a(){var AK=this._super();if(this.showTitleBar){AK=mstrmojo.hash.clone(AK);AK.f.v+=20;}return AK;},cancel:function j(){this.refresh();}});mstrmojo.vi.ui.rw.FilterBox.boxConfiguration={f:{h:150,v:42},o:"v"};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.EnumDragSources","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.models.DatasetDoubleClick","mstrmojo.vi.models._CheckDataCards","mstrmojo.vi.util.TemplateUtils");var V=mstrmojo.hash,k=mstrmojo.array,AB=mstrmojo.func,b=mstrmojo.vi.util.TemplateUtils,u=mstrmojo.vi.ui.DatasetUnitMenuUtils,Y="00000000000000000000000000000000",l=mstrmojo.vi.models.EnumDragSources,X=mstrmojo.chart.model.enums.EnumDSSObjectType,e=mstrmojo.vi.enums.EnumFeatures,Z=mstrmojo.vi.viz.EnumDSSDropZones;var a={ABOVE:0,ON:1,BELOW:2};mstrmojo.vi.models.DropZoneItemType=null;mstrmojo.vi.models.DropZoneType=null;mstrmojo.vi.models.DropZonesEditorConfigType=null;function J(AK,AG,AI,AL,AO,AJ,AM,AN){var AH={act:AK,zoneId:AG,unitId:AI,unitType:AL};if(AO!==undefined){AH.unitPos=AO+1;}if(AN!==undefined){AH.is_disableonly=AN;}if(AJ){AH.datasetId=String(AJ);AH.datasetType=String(AM);}return AH;}function P(AG){return function(AH){var AI=[{t:AG,did:NaN}];return !!this.getAllowDropInfo(AH,AI,AH.items.length-1,a.BELOW,{src:{data:{src:l.DATASETS}}}).allowedItems.length;};}mstrmojo.vi.models.DropZonesModel=mstrmojo.declare(mstrmojo.Obj,[mstrmojo.vi.models._CheckDataCards],{scriptClass:"mstrmojo.vi.models.DropZonesModel",hostId:"",docModel:null,getDropZones:mstrmojo.emptyFn,getDZFlatStruct:function L(){var AJ=this.getHost().model.data,AK=AJ.gsi||{},AG=(AK.rows||[]).concat(AK.cols||[]),AI={},AH={};AG.forEach(function(AL){if(AL.hasOwnProperty("st")&&AL.hasOwnProperty("did")){AI[AL.did]=AL.st;}});if(AJ.dz){Object.keys(AJ.dz).forEach(function(AP){var AL=AJ.dz[AP],AM=AL.TemplateUnit||[],AO=AL.TemplateMetric||[],AN=AM.concat(AO);AN.forEach(function(AQ){var AR=AQ.id;if(AQ.st===undefined&&AI.hasOwnProperty(AR)){AQ.st=AI[AR];}});if(AM.length>0&&AO.length>0){AN.sort(function(AR,AQ){return AR.idx-AQ.idx;});}AH[AP]=AN;});}return AH;},getAvatarIconClass:function d(){throw new Error(this.scriptClass+" must implement getAvatarIconClass method.");},canSwapAxis:function t(){return false;},swapAxis:function A(){if(this.canSwapAxis()){throw new Error(this.scriptClass+" must implement swapAxis method if this.canSwapAxis returns true.");}},canDefineSubtotals:function(){var AG=this.getHost();if(AG&&AG.GMController&&AG.GMController.isWaterfall){return true;}return false;},hasVisibleSubtotals:function j(){var AG=this.getHost();return AG.getWidgetPropertyValue("totalShw")||(AG.getWidgetPropertyValue("intSumShw")&&AG.GMController.hasAttributesInDropzone("BreakBy"));},showQuickSubtotals:function I(){var AG=this.getHost();AG.writeGlobalProperty("totalShw:intSumShw",true);},hideDefinedSubtotals:function AA(){var AG=this.getHost();AG.writeGlobalProperty("totalShw:intSumShw",false);},getZoneMenuItems:function x(AH,AG){},getUnitMenuItems:function n(AH,AG,AJ,AI){},getMultiUnitsMenuItems:function i(AH,AG,AI){var AJ=this.id;if(!mstrApp.isInVFConfigMode&&u.getMultiSelectionShortcutMetricFunctions(AI).length&&mstrmojo.resolveFeature(e.INSERT_NEW_METRIC)){AH.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,function(){return mstrmojo.all[AJ].getMultipleMetricsCalcMenus(AG,AI,true);});}AH.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[AJ].deleteItems(AG,AI);});},deleteItem:function K(AH,AG){this.throwAbstractMethodError("deleteItem");},deleteItems:function K(AG,AH){this.throwAbstractMethodError("deleteItems");},addZoneItem:function h(AI,AJ){AI.t=AI.t||4;if(AI.did===undefined){AI.did=AI.id;}var AG=b.findUnitsById(this.getHost().model.data.gsi,AI.did)[0];if(AG){V.copyProps(["n","um"],AG,AI);}var AH=this.docModel.datasets,AL=false,AK=AI.t===4?"mx":"att";Object.keys(AH).every(function(AM){(AH[AM][AK]||[]).every(function(AO){if(AO.did===AI.did){AL=true;var AP,AN=AO.n;for(AP in AO){if(!AI.hasOwnProperty(AP)){AI[AP]=AO[AP];}}if(AN!==AI.n){AI.objectNameinDataset=AN;}}return !AL;});return !AL;});AJ.push(AI);},getZone:function w(AL,AK,AJ,AG,AH){var AI=[];(AJ||[]).forEach(function(AM){this.addZoneItem(V.copy(AM),AI,AH);},this);return{n:AL,id:AK,enabled:!AG,cssClass:(AH&&AH.allowSingle)?"singleUnitZone":"",getDropIconCls:function(){return"pivot";},title:(AH&&AH.title)||"",items:AI};},getZoneForObject:function S(AH){var AG=null;this.getDropZones().zones.every(function(AI){if(k.find(AI.items,"did",AH)>-1){AG=AI;return false;}return true;});return AG;},getUnitIndexInZone:function s(AG,AH){return k.find(AG.items,"did",AH.did);},isZoneDropAllowed:function W(AG){if(!AG.enabled){return false;}return true;},getAllowDropInfo:function C(AH,AI,AG,AJ){return{allowedItems:AI.concat(),removeReplaced:AJ===a.ON&&AH&&AH.items&&AH.items[AG]&&k.find(AI,"did",AH.items[AG].did)===-1};},getTargetEdgePortion:function Q(AG){return 0.33;},allowInsertNewMetric:P(4),allowInsertNewAttribute:P(12),unitsDropped:function AC(AG,AH,AI,AK,AJ){if(this.unitDropped!==mstrmojo.vi.models.DropZonesModel.prototype.unitDropped){return this.unitDropped(AG,AH,AI.idx,AI.edge,AK,AJ);}this.throwAbstractMethodError("unitsDropped");},getHost:function f(){return mstrmojo.all[this.hostId];},getHostModel:function B(){this.throwAbstractMethodError("getHostModel");},shouldMetricNameShowIcon:function AF(){return true;},addUnitsFromDataSource:function H(AN,AL,AJ,AH){var AO=this,AS=AO.docModel,AK=AS.controller,AG;AJ=AJ||[];var AI=false,AR=this.getHost(),AM=[],AT;[].concat(AN).forEach(function(AU){AT=this.isMetric(AU);AI=AT||AI;AG=mstrmojo.vi.models.DatasetDoubleClick.addObject(AU,AL,this);AJ=AJ.concat(AG);if(AT){AM.push(AU);}},this);if(AJ&&AJ.length){if(AI&&AG&&AG[0].actions){AG[0].actions.push(AR.model.getValuesDefaultFormatGridZoneAction(AM,true));}var AQ=AK._getXtabCallback(this.getHost());if(AH){AQ=AB.wrapMethods(AH,AQ);}var AP=function(){AS.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:AJ,zm:AO},function(){AJ=AS.wrapUnsetVisualizationFilterAction(AJ);return AK.submitUndoRedoUpdates(AJ,{},AQ);},function(){return AK.submitUndoRedoUpdates(AJ,{},AQ);});};if(this.existLargeOrManyItems()){this.warnAndExecCallBackForAddUnits(function(){AP();});return ;}if(this.getHost().isOutlineMode){this.warnAndExecCallBackForOutlineAddUnits(function(){AP();});return ;}AP();}},changeZoneUnits:function q(AH,AG,AI){},getZoneAddCandidates:function c(AG){return[];},getRequiredItemsInfo:function m(AH){if(!AH){return 0;}var AG=[];this.getDropZones().zones.forEach(function(AI){AG=AG.concat(AI.items);});return Number(AG.reduce(function(AI,AJ){if(parseInt(AJ.did,10)!==-1&&AJ.t===AH){return AI+1;}return AI;},0));},getUpdateCallback:function U(){var AG=this.id;return{success:function(){var AK=mstrmojo.all[AG];if(!AK){return ;}var AM=AK.getHost();if(!AM){return ;}var AL=mstrmojo.all.visualizationFilterToolbar,AJ=AK.docModel,AO,AI,AN,AH;if(mstrApp.isInVFConfigMode){AO=AM.zonesModel;AM.parent.selectVIUnit(true);AH=AO&&AO.isTemplateContainAttCategoryItem();mstrApp.isEnableSaveBtn=AH;AL.toggleSaveBtn(AH);}else{AI=AM.parent&&AM.parent.k;AN=AJ.getPanel().getUnitByKey(AI);if(AN){AN.selectVIUnit(true);}}}};},getUpdateTemplateAction:function O(AG,AH){return this.docModel.getDataService().getUpdateTemplateAction(AH||this.getHost().k,AG);},getReplaceCandidates:function N(AJ,AO){var AK=[],AI=AO.t,AG=AO.did,AH=this.getHostModel().datasetId,AM=AJ.id===Z.AdditionalMetrics,AN=this.getHost(),AL=AN.getChartStyle&&AN.getChartStyle()==="NewGraphMatrixVisualizationStyle";this.getDropZones().zones.forEach(function(AP){((AP&&AP.items)||[]).forEach(function(AR){var AS=AR.t,AQ=AR.did;if(AS!=undefined&&AQ!=undefined&&AS!==21&&AQ!=="-1"&&AQ!==Y&&((AS===4&&AI===4)||(AS!==4&&AI!==4))&&AQ!==AG&&k.find(AK,"did",AQ)===-1){AK.push(AR);}});});if(!AL||!AM){if(AH){this.docModel.getDatasetUnits(AI===4?["mx"]:["att"],null,AH).forEach(function(AP){if(k.find(AK,"did",AP.did)===-1&&AP.did!==AG&&!AP.hide&&!AN.model.hasSameRecursiveAttributeGroup(AP,AN.gridData,AO)){AK.push(AP);}});}}return u.getSortedDatasetUnits(AK);},getDropTargetIndex:function E(AH,AJ){var AG=AJ.idx,AI=(AJ.edge===a.ON&&!AJ.removeReplaced)?a.BELOW:AJ.edge,AL=AG,AK=this,AM={};AJ.allowedItems.forEach(function(AO){var AN=AK.getUnitIndexInZone(AH,AO);if(AN!==-1){AM[AN]=AO;}});V.forEach(AM,function(AO,AP){var AN=parseInt(AP,10);if(AN<AG){AL--;}else{if(AN===AG){AI=a.ON;}}});return AI===a.BELOW?(AL+1):AL;},getAddDropZoneUnitAction:function p(AH,AJ,AG,AI){return J("addDropZoneUnit",AH.id,AJ.did,AJ.t,AG,AI&&AI.datasetId,(AI&&AI.datasetType)||X.DssTypeReportDefinition);},getAddDropZoneUnitsActions:function AE(AH,AI,AG,AJ){return AI.reverse().map(function(AK){return J("addDropZoneUnit",AH.id,AK.did,AK.t,AG,AJ&&AJ.datasetId,(AJ&&AJ.datasetType)||X.DssTypeReportDefinition);});},getRemoveThresholdsActions:function M(AG,AI){var AN=AI.id||AI.did;var AJ=this.getHostModel(),AM=AJ&&AJ.gsi,AK=AM&&AM.thresholds&&AM.thresholds[AN]||[],AL=[];for(var AH=AK.length-1;AH>=0;AH--){AL.push({act:"clearThreshold",unitId:AN,unitType:AI.t,tid:AK[AH].tid});}return AL;},getRemoveDropZoneUnitActions:function G(AG,AJ,AK){if(AK===undefined||AK===null){AK=1;}var AL=[];var AI=this.getHost(),AH=AI.isCustomVis;if(AG.id===Z.ColorBy&&this.isMetric(AJ)&&!AH){AL=this.getRemoveThresholdsActions(AG,AJ);}if(AJ){AL.push(J("removeDropZoneUnit",AG.id,AJ.did,AJ.t,undefined,undefined,undefined,AK));}return AL;},checkAndAddThresholdAction:function z(AI,AG,AH){return false;},getAllZones:function(){return this.getDropZones().zones||[];},getClearAllUnitsActions:function R(){var AG=[];(this.getAllZones()).forEach(function(AH){((AH&&AH.items)||[]).forEach(function(AI){Array.prototype.push.apply(AG,this.getRemoveDropZoneUnitActions(AH,AI));},this);},this);return AG;},getClearAllUnitsUnTemplateActions:function g(){return[];},clearAllDropZones:function y(AK){var AH=this.docModel,AJ=this,AG=AJ.getAllZones().filter(function(AM){return AM&&AM.items&&AM.items.length;}).map(function(AM){return AM.id;}),AI=function(){AK=AK||{actions:[]};AK.actions=AH.wrapUnsetVisualizationFilterAction(AK.actions);AJ.clearAllDropZonesDeferred(AK);},AL=function(){AJ.clearAllDropZonesDeferred(AK);};return AH&&AH.checkAndNotifyVFChangeOnClearAll({zm:AJ,ca:AG,cmb:true},AI,AL);},clearAllDropZonesDeferred:function D(AP){var AI=this.getClearAllUnitsActions(),AK=this.getClearAllUnitsUnTemplateActions(),AR=this.getHost(),AN=AR.id,AJ=AR.gridData||AR.model.data||AR.node.data,AM=AJ.vlexpr,AS=this.docModel,AH=AR.model,AL=AS.controller,AO=AB.wrapMethods({success:function(){var AT=mstrmojo.all[AN];if(AT._viSelections){AT.clearSelections();AT.endSelections();}}},AL._getXtabCallback(AR),{success:function AQ(){mstrmojo.all[AN].raiseEvent({name:"regenerateToolbar"});}}),AG=AH.getKeepOnlyActionsForAssociatedNodes([],AO);if(AM){AG.actions.push(AL.dataService().getUpdateTemplateAction(AR.k,AH.getRemoveMetricLimitsAction(AM)));}if(AP){AP.actions=[].concat(AP.actions).concat(AG.actions);AP.callback=AB.wrapMethods(AP.callback,AG.callback);}else{AP=AG;}if(AK&&AK.length>0){AP.actions=AP.actions.concat(AK);}this.submitDropZoneTemplateUpdates(AI,AP);},submitDropZoneUpdates:function o(AM,AN,AI){var AK=this.getHost(),AH=this.docModel,AG=AH.controller,AJ=[].concat(AM||[]);if(AJ&&AJ.length){var AL=AN||AG._getXtabCallback(AK);AG.cmdMgr.execute({execute:function(){this.submit(AJ,AL,AI);},urInfo:{callback:AL}});}},submitDropZoneTemplateUpdates:function F(AG,AI){var AH=(AG&&AG.length)?[this.getUpdateTemplateAction(AG)]:[];if(AI&&AI.actions){AH=AH.concat(AI.actions);}this.submitDropZoneUpdates(AH,AI&&AI.callback,AI&&AI.extras);},getHighlightTargets:function AD(AH,AG){return[AG];}});mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION=a;mstrmojo.vi.models.DropZonesModel.ENUM_REQUIREMENT_TYPE={ATTRIBUTE:12,METRIC:4,LONGITUDE:"long",LATITUDE:"lat"};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.VisEnum","mstrmojo.VisLegend","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.gm.GMIdentities","mstrmojo.gm.GMUtility","mstrmojo.array","mstrmojo.string","mstrmojo.hash","mstrmojo._FormateVisLegend","mstrmojo.ui._HasScroller");var Al=mstrmojo,Ah=Al.gm,AE=Al.dom,Ag=Al.css,S=Al.hash,AS=Al.VisUtility,b=Ah.GMUtility,P=mstrmojo.array,Z=mstrmojo.string,AF=mstrmojo.ui.editors.controls.AdvancedColorPicker,g=Ah.ColorSquareIdentity,C=Al.VisEnum.ControlType,k=Ah.EnumLegendSlot,AQ=Ah.EnumDockPosition,o=Ah.EnumLegendSlot,AK=Ah.EnumIdentityType,AI=Ah.EnumShape,Ac=Al.VisEnum.GMLegendDataType,J=mstrmojo.desc(13966,"Size by:"),AA="px",F=1.35,a=0.75,X=5,K=20,m=K,AJ=5,A=5,AB=16,f=15,H=16,AN=20,G=150,w=15,Aj=1,AD="setAttribute",l=3,i=2,Q=8,t=15,AX=14,y=1,R=2,h=4,Am=8,Ak=16,L=10,AZ=3,AO=50,AU=-3,x=5,AV="gm-legend-lock-icon",AR=mstrmojo.desc(14442,"This metric has its axis scale set to custom min and max values"),O="http://www.w3.org/2000/svg",z="\u2026",N=/[ \-]/;var u=[{pos:o.LEFT_TOP},{pos:o.LEFT_MIDDLE},{pos:o.LEFT_BOTTOM},{pos:o.RIGHT_TOP},{pos:o.RIGHT_MIDDLE},{pos:o.RIGHT_BOTTOM}];function AW(As,Au,An,Av){if(!As){return ;}var Ap,Ay,Aq,Ax,At=As.style,Az=Au===AQ.TOP,Ao=Au===AQ.BOTTOM,Aw=Au===AQ.LEFT,Ar=Au===AQ.RIGHT;if(Az||Ao){Ap=An;Ay=1;Aq=-1;Ax=AU;if(Ao){Ax+=Av;}}else{if(Aw||Ar){Ap=1;Ay=Av;Ax=-1;Aq=AU;if(Ar){Aq+=An;}}}At.cssText="left:"+Aq+AA+";top:"+Ax+AA+";width:"+Ap+AA+";height:"+Ay+AA+";";if(mstrApp.isInVFInteractMode){At.cursor="default";}}function I(Ao){var An=String(Ao);return An.indexOf(" ")>=0||An.indexOf("-")>=0;}function Y(Ap,Ao,Aq){var An=typeof Ap==="string"?b.restoreSpecialChars(Ap):Ap;return AS.measureTextWidth(An,Ao,Aq,undefined,true,true);}function AM(Ar,Aq,Ao,An){var Ap=Y(Aq,Ao,L);Ar.setAttribute("measureWidth",Ap);if(Ap>An){Ap=An;}else{Ar.style.overflow="visible";}Ar.setAttribute("displayWidth",Ap);Ar.style.width=Ap+AA;return Ap;}function Ai(Ap,Ao){var An;if(parseInt(Ap.getAttribute("measureWidth"))>Ao&&Ap.innerText.indexOf(" ")>=0){An=parseInt(Ap.style.maxHeight);}else{An=parseInt(Ap.style.lineHeight);}return An;}function B(Ao){var An;if(Ao.textContent&&typeof (Ao.textContent)!==undefined){An=Ao.textContent;}else{An=Ao.innerText;}return An;}function c(Ap){var Ao=Ap.getAttribute("measureWidth"),An=Ap.getAttribute("displayWidth");if(!Ao){Ap[AD]("title","");}Ao=parseFloat(Ao,10);An=parseFloat(An,10);if((Ao-An)>0.1){Ap[AD]("title",B(Ap));}else{Ap[AD]("title","");}}function AP(Ar,An,Ao,Aq){var Ap=document.createElement("div");Ap[AD]("class","gm-legend-underLine");Ap.style.width=Aq-L+AA;Ap.style.left=An+5+AA;Ap.style.top=Ao+AA;Ar.appendChild(Ap);}function Ab(Aq,An,Ao){var Ap=document.createElement("div");Ap[AD]("class","gm-legend-underLine-anchorPoint");Ap.style.left=An+AA;Ap.style.top=Ao-3+AA;Aq.appendChild(Ap);}function AL(Aq,An,Ao,Ap){AP(Aq,An,Ao,Ap);Ab(Aq,An,Ao);}function n(Ap,A0,Aw,Au,Ay){var Av,Aq,Ax,An,Az=b.restoreSpecialChars(Ap.innerHTML),At=Az.length,Ar=0,Ao=At,As=false;if(Ap.scrollHeight>1.5*H){Av=Y(Ap.innerHTML,A0,L);Aq=Av-Aw+L;if(Aq>Ay){while((Ao-Ar)>1){Ax=(Ar+Ao)>>1;An=Az.substring(0,Ax)+z;Av=Y(An,A0,L);Aq=Av-Aw+L;if(Aq>Ay){Ao=Ax;}else{Ar=Ax;}}Ap.innerHTML=Z.encodeHtmlString(Az.substring(0,Ar)+z,true);Ap[AD]("title",Az);As=true;Av=Y(Ap.innerHTML,A0,L);Aq=Av-Aw+L;}AP(Ap,0,Au+H,(Aq<Ay)?Aq:Ay);}if(Aw>Ay){Ap[AD]("title",Az);}else{if(!As){Ap[AD]("title","");}}}function AC(An,Aw,As,Ao,Av,Ax){var Ap,Ar,At,Au,Aq=document.createElement("div");Aq[AD]("class","gm-legend-textcell");Aq[AD]("type",C.LGD_TEXT);Aq.style.lineHeight=f+AA;if(Av){Au=AM(Aq,Aw,Ax,Av);}if(Ao&y){Ap=(AN+AX)/2+As*AN;At=AB;}else{Ap=(w+AX)/2+As*w;if(Ao&Am){if(Ao&Ak){At=0;}else{At=t;}}else{if(Ao&h){At=Q;}else{At=0;}}}Ar=Au||t+L;Aq.innerText=Aw;Aq.identity={objType:AK.LEGEND_TEXT};AL(An,At,Ap,Ar);this.textDivs.push(Aq);An.appendChild(Aq);}function Ae(An,Aq){var Ao,As,Ar,Ap=0;if(An){Ar=An.elements;for(Ao=0,As=Ar.length;Ao<As;Ao++){Ap=Math.max(Ap,Y(Ar[Ao].label,Aq,L));}Ap+=AB+A*2+AZ;}return Ap;}function W(Aq,Ap){var At,An,As,Ar=Aq.items,Ao=0;if(!Ar){return 0;}At=Ar.length;As=Aq.custMetrics;for(An=0;An<At;An++){if(As&&As.indexOf(Ar[An])!==-1){Ao=Math.max(Ao,Y(Ar[An],Ap,L)+Q);}else{Ao=Math.max(Ao,Y(Ar[An],Ap,L));}}return Ao;}function AT(Aq,Ap){var An,As,Ar,Ao=0;if(Aq){Ar=Aq.elements;As=Ar.length;if(Aq.caseFlag===1){Ao=W(Aq,Ap);}else{if(Aq.caseFlag===0){for(An=0;An<As;An++){Ao=Math.max(Ao,Y("Max: "+Ar[An].v,Ap,L));}Ao+=w*l;Ao=Math.max(Ao,W(Aq,Ap));}else{if(Aq.caseFlag===2){for(An=0;An<As;An++){Ao=Math.max(Ao,Y(Ar[An].v,Ap,L));}Ao+=w*As+t;Ao=Math.max(Ao,W(Aq,Ap));}else{if(Aq.caseFlag===3){for(An=0;An<As;An++){Ao=Math.max(Ao,Y(Ar[An].v,Ap,L));}Ao+=w*x;}}}}Ao=Math.max(Ao,Y(J,Ap,L));Ao+=A*3;}return Ao;}function e(Ay,Aq,A2){if(!Ay||!Ay.length||Ay.length<1){return 0;}var Ar,Ao,A1,An,Au,Ax,At,Aw,Av,Ap,As,A0=m+2*Aj,Az=A0;for(Ar=0;Ar<Ay.length;Ar++){At=Ay[Ar];if(At.dataType===Ac.COLOR_BY){Aw=At.dataObj;if(Aw){Ap=2*AJ+H;A1=b.removeExtraSpace(Aw.item);Ax=Y(A1,A2,L);if((Ax+2*A>Aq-2*Aj)&&I(A1)){Ap+=H;}An=Aw.elements;Ao=An.length;Ap+=A;Ap+=i;An.forEach(function(A3){if(A3.bftp){Ah.GMLegend.IMAGE_SIZE_FIXED=G;AN=G;}});A0+=Ap+AN*Ao;Az+=Ap+(Ao>0?AN:0);}}else{if(At.dataType===Ac.SIZE_BY){Av=At.dataObj;if(Av){As=2*AJ+H;A1=b.removeExtraSpace(Av.item);Ax=Y(A1,A2,L);if((Ax+2*A>Aq-2*Aj)&&I(A1)){As+=H;}Au=Av.caseFlag;if(Au===1){Ao=0;}else{if(Au===0){Ao=2;}else{if(Av.caseFlag===2||Au===3){Ao=Av.elements.length;}}}Ao+=(Av.items&&Av.items.length)||0;As+=w*Ao;As+=A;As+=i;A0+=As;Az+=As;}}}}return{height:A0,minHeight:Az};}function Af(An,Ao){var Aq=0,Ap=0;P.forEach(An||[],function(Ar){var As;if(Ar.dataType===Ac.COLOR_BY){As=Ae(Ar.dataObj,Ao);if(As>Aq){Aq=As;}}else{if(Ar.dataType===Ac.SIZE_BY){As=AT(Ar.dataObj,Ao);if(As>Ap){Ap=As;}}}});return Math.max(Aq,Ap)+2*Aj;}function j(Ao,Au,As,Ar){var Ap=e(Ao,Au,Ar),An=Ap.height,At=As-X*2,Aq={};Aq.autoCollapse=Ap.minHeight>At;Aq.minHeight=Ap.minHeight;Aq.width=Au;Aq.height=Math.min(An,At);if(An>At){Aq.cutBy=An-At;}return Aq;}function E(Ao,Ap){var Aq=Ao.decodedColor||Ao.color||AF.VAL_AUTOMATIC,An;if(Aq.c1){An=Ag.buildGradient(Aq.or,Aq.c1,Aq.c2);Ap.style[Ag.convertCssToCamelCase(An.n)]=An.v;}else{Ap.style.backgroundColor=Aq;}if(Ao.image){Ap.style.backgroundImage=Ao.image;}if(Ao.opacity!==undefined){Ap.style.opacity=Ao.opacity;}Ap.identity=new g({objType:AK.COLOR_SQUARE,parentIdentity:this.identity,token:Ao.token,decodedColor:Ao.decodedColor,encodedColor:Ao.encodedColor,isDefaultColor:Ao.isDefaultColor});}function AY(){var A2,Az,Ax,An,Ay,A4,Ao,Av,At,Aq,A6=document,A5=this.triBtn,A1=this.closeBtn,As=this.cbContainer,Ap=this.sb1Container,A0=this.sb2Container,Au=this.cbTableContainer,Ar=null,A3=this.height-m-A-2*Aj,Aw=this.width-2*A-2*Aj;A5[AD]("class","gm-legend-tri-button-collapsed");if(this.autoCollapse){A5[AD]("title",mstrmojo.desc(13682,"There is not enough space to display the legend"));}else{A5[AD]("title",mstrmojo.desc(13683,"Maximize Legend"));}A1.style.display="none";this.splitter.style.display="none";this.domNode.style.overflow="hidden";for(A2=0;this.dataArray&&A2<this.dataArray.length;A2++){An=this.dataArray[A2];if(An.dataType===Ac.COLOR_BY){Ar=An.dataObj;break;}}As.style.display=Ar?"block":"none";Ap.style.display="none";A0.style.display="none";if(Ar){Ax=Ar.elements;Az=Ax.length;Ay=this.cbTitle;Ay.style.display="none";As.style.top=m+AA;As.style.width=Aw+AA;Au.style.top="0px";A4=this.cbTable;A4.innerHTML="";for(A2=0;A2<Az;A2++){Ao=A6.createElement("tr");Av=A6.createElement("td");Aq=A6.createElement("div");At=A6.createElement("div");Aq[AD]("class","gm-legend-colorbox-ctn-div");Aq[AD]("type",C.LGD_COLORBOX_CTN);Aq[AD]("title",Ax[A2].label);At[AD]("class","gm-legend-colorbox-div");At[AD]("type",C.LGD_COLORBOX);E.call(this,Ax[A2],At);Ao[AD]("class","gm-legend-tr");Ao.style.height=AN+AA;Av[AD]("class","gm-legend-colorbox");Aq.appendChild(At);Av.appendChild(Aq);Ao.appendChild(Av);A4.appendChild(Ao);if(A4.offsetHeight+AN>A3){break;}}A4.style.top="0px";A4.style.marginLeft="0px";Au.style.top=A+AA;Au.style.height=A4.offsetHeight+AA;}As.style.height=A3+AA;}function p(Ap,Ao,Ar,An){var Aq=document.createElementNS(O,"circle");Aq.setAttribute("cx",Ao);Aq.setAttribute("cy",Ar);Aq.setAttribute("r",An);Aq.setAttribute("class","gm-legend-sizeby-circle");Ap.appendChild(Aq);}function AH(Ap,Aq,At,Ao,As,Au,Ar){var An=document.createElementNS(O,"line");An.setAttribute("x1",Aq);An.setAttribute("y1",At);An.setAttribute("x2",Ao);An.setAttribute("y2",As);An.style.strokeWidth=Au;if(Ar){An.setAttribute("class",Ar);}Ap.appendChild(An);}function Ad(Ao,A2){var A1,Ap,Ar,As,Aq,An,A0,At,A3,Au,Ay=Math.PI,Av=A2.elements,Aw=Av.length,Ax=Aw*w,Az=Ao.getContext("2d"),A4={LINE_COLOR:"#b0b0b0",MIN_WIDTH:1,MAX_WIDTH:10},A5=AS.getPropertyByPath(this,"widget.model.data.visName")||AS.getPropertyByPath(this,"widget.model.data.vis.vn");switch(A5){case"GraphMatrixVisualizationStyle":if(this.shapeType===AI.SQUARE||this.shapeType===AI.TICK||this.shapeType===AI.LINE||this.shapeType===AI.BAR||this.shapeType===AI.AREA||this.shapeType===AI.RECTANGLE){Au="rectangle";}else{Au="circle";}break;case"VIHeatMapVisualizationStyle":Au="rectangle";break;default:Au="circle";break;}switch(A2.caseFlag){case 0:Az.save();if(mstrApp.getThemeClassName().indexOf("dark")>=0){Az.strokeStyle="rgba(116, 116, 117, 0.7)";Az.fillStyle="rgba(116, 116, 117, 0.7)";}else{Az.strokeStyle="rgba(188, 188, 189, 0.7)";Az.fillStyle="rgba(188, 188, 189, 0.7)";}Ax=w*l;A3=Math.floor(w*0.75+0.5);Ap=Math.floor(A3/3.5+0.5);if(Au==="circle"){As=A3+1;Aq=w;Az.beginPath();Az.arc(As,Aq,A3,0,2*Ay,false);Az.fill();Az.stroke();As=2*As+2*Ap;Aq=Math.floor(0.53*w+0.5);Az.beginPath();Az.arc(As,Aq,Ap,0,2*Ay,false);Az.fill();Az.stroke();}else{As=1;Aq=w-A3;Az.beginPath();Az.fillRect(As,Aq,2*A3,2*A3);As=2*A3+2+Ap;Aq=Math.floor(0.53*w-Ap+0.5);Az.beginPath();Az.fillRect(As,Aq,2*Ap,2*Ap);}Az.translate(0.5,0.5);Az.lineWidth=1;Az.strokeStyle="#9C9C9C";As=2*A3+3*Ap+3;Aq=Math.floor(0.53*w+0.5);Az.beginPath();Az.moveTo(As,Aq);Az.lineTo(Ax,Aq);Az.stroke();As=2*A3+2;Aq=Math.floor(1.53*w-Ap+0.5);Az.beginPath();Az.moveTo(As,Aq);Az.lineTo(As+Ap,Aq+Ap);Az.lineTo(Ax,Aq+Ap);Az.stroke();Az.restore();break;case 1:break;case 2:Ar=parseInt(Av[0].diameter,10);Ar=Math.min(Ar,Ax);Az.fillStyle="#ADADAC";Az.strokeStyle="#ADADAC";if(Au==="circle"){As=Ax>>1;Aq=As;Az.arc(As,Aq,Ar>>1,0,2*Ay,false);Az.fill();Az.stroke();}else{As=(Ax-Ar)>>1;Aq=As;Az.rect(As,Aq,Ar,Ar);Az.fill();Az.stroke();}break;case 3:An=A4.MIN_WIDTH;A0=(Aw===1?0:(A4.MAX_WIDTH-A4.MIN_WIDTH)/(Aw-1));Ax=Ao.width;At=w;As=0;Aq=w/2;Az.strokeStyle=A4.LINE_COLOR;for(A1=0;A1<Aw;A1++){Az.lineWidth=An;Az.beginPath();Az.moveTo(As,Aq);Az.lineTo(Ax-As,Aq);Az.stroke();Aq+=At;An+=A0;}break;default:break;}}function Aa(Ao,Aw){var Au=1,An,As=1.5*H,Av=Ao.innerHTML,At=b.restoreSpecialChars(Av),Ap=At.split(N),Ax,Aq;var Ar=function(Ay){Aq=At[Ay];return Aq!==undefined?Aq:"";};if(Ao.scrollHeight>As){if(!Ap[0]){return 0;}An=Ap[0]+Ar(Ap[0].length);while(Ap[Au]!==undefined){Ax=An+Ap[Au];Ax+=Ar(Ax.length);Ao.innerHTML=b.replaceSpecialChars(Ax);if(Ao.scrollHeight>As){break;}An=Ax;Au++;}Ao.innerHTML=Av;}else{An=At;}return Y(An,Aw,L);}function d(A3,A1,A2,Ax){var A0,Ap,As,Ar,Aw,Az,Av=A1.elements,Ay=Av.length,Au=[],A4=document,An=A4.createDocumentFragment(),Aq=false,At=this.styles,Ao=A2;switch(Ax){case 0:if(Ay>0){Au.push({v:"Min: "+Av[Ay-1].v});Au.push({v:"Max: "+Av[0].v});Ay=2;}break;case 1:Av=A1.items;P.forEach(Av,function(A5){Au.push({v:A5});});break;case 3:Au=Av;break;default:Au=Av;Aq=true;break;}Ay=Au.length;for(A0=0;A0<Ay;A0++){Ap=A4.createElement("tr");Ap[AD]("class","gm-legend-tr2");Ap.style.height=w+AA;if(Aq){As=A4.createElement("td");AC.call(this,As,Au[A0].sign,A0,R|Am|Ak);As[AD]("class","gm-legend-sign");Ap.appendChild(As);Ao-=t;}Ar=A4.createElement("td");Ar[AD]("class","gm-legend-desc");if(A1.custMetrics&&A1.custMetrics.indexOf(Au[A0].v)!==-1){AC.call(this,Ar,Au[A0].v,A0,R|h,Ao-Q,At);Az=parseInt(Ar.lastChild.style.width,10);Aw=A4.createElement("div");Aw.setAttribute("class",AV);Aw.setAttribute("title",AR);Ar.appendChild(Aw);Aw.style.top=(w-8)/2+A0*w+AA;Ar.lastChild.style.marginLeft=Az+AA;}else{if(Aq){AC.call(this,Ar,Au[A0].v,A0,R|Am,Ao,At);}else{AC.call(this,Ar,Au[A0].v,A0,R,Ao,At);}}Ap.appendChild(Ar);An.appendChild(Ap);}A3.appendChild(An);}function V(){var Ap="."+AV,An=this.domLegend.querySelectorAll(Ap),Ao;P.forEach(An,function(Aq){Ao=Aq.parentNode;if(Ao){Ao.removeChild(Aq);}});}function U(){var BG,A8,BL=0,BM,A3,BA,A4,Aq,BE,BH,Au,BK,BF,An=this.width-2*Aj,Ay=An-2*A,As=document,Ap=this.triBtn,A9=this.closeBtn,A7=this.cbContainer,Az=this.cbTableContainer,BN=this.sb1Container,At=this.sb2Container,Ax,Av,Ar,Aw,BC,A1,BB=this.cutBy,A6=m,BI=0,A5=this.styles,BD,BJ,A2=(H+AX)/2,Ao,A0;Ap[AD]("class","gm-legend-tri-button");Ap[AD]("title",mstrmojo.desc(13684,"Minimize Legend"));A9.style.display="block";A9[AD]("title",mstrmojo.desc(12002,"Hide Legend"));this.updateSplitter();V.call(this);this.domNode.style.overflow="visible";A7.style.display="none";BN.style.display="none";At.style.display="none";for(A8=0;this.dataArray&&A8<this.dataArray.length;A8++){Av=this.dataArray[A8];BC=null;A1=null;if(Av.dataType===Ac.COLOR_BY){BC=Av.dataObj;if(BC){A7.style.display="block";A4=b.removeExtraSpace(BC.item);Aq=BC.elements;BG=Aq.length;A7.style.top=A6+AA;A7.style.width=Ay+AA;BK=0;if(BI===0){Ag.addClass(this.sepLine1,"toggleHide");BI++;}BM=this.cbTitle;BM.style.display="block";AM(BM,A4,A5,Ay);BM.innerHTML=Z.encodeHtmlString(A4,true);BK+=Ai(BM,Ay)+2*AJ;Ao=Aa(BM,A5);n(BM,A5,Ao,A2,Ay);AL(BM,0,A2,(Ao<Ay)?Ao:Ay);A3=this.cbTable;A3.style.display="block";A3.style.width=(Ay-AZ)+AA;A3.style.marginLeft=AZ+AA;A3.innerHTML="";A3.appendChild(this.fillColorByTable(BC,0));BE=AN*BG+1;Az.style.top=BK+AA;A3.style.display="table";BK+=BE+A;if(BB){BK-=BB;BE-=BB;}A7.style.height=BK+AA;Az.style.height=BE+AA;A6+=BK+i;}}else{if(Av.dataType===Ac.SIZE_BY){A1=Av.dataObj;if(A1){BL++;if(BL===1){Ar=BN;Aw=this.sb1Title;BA=this.sb1MetricNamesTable;A3=this.sb1DataTable;Ax=this.sb1Canvas;}else{Ar=At;Aw=this.sb2Title;BA=this.sb2MetricNamesTable;A3=this.sb2DataTable;Ax=this.sb2Canvas;}Ar.style.display="block";A4=b.removeExtraSpace(A1.item);Aq=A1.elements;BG=Aq.length;Ar.style.top=A6+AA;Ar.style.width=Ay+AA;BK=0;if(BI===0){Ag.addClass(this.sepLine2,"toggleHide");BI++;}if(A1.caseFlag===0){BH=l*w;Au=2*w;}else{if(A1.caseFlag===3){BH=x*w;Au=BG*w;}else{BH=BG*w;Au=BH;}}BM=Aw;BM.innerHTML=Z.encodeHtmlString(A4,true);BJ=A1.custMetrics&&A1.custMetrics.indexOf(A4)!==-1;if(BJ){A0=Ay-Q;}else{A0=Ay;}AM(BM,A4,A5,A0);if(BJ){BD=As.createElement("div");BD.setAttribute("class",AV);BD.setAttribute("title",AR);Ar.appendChild(BD);BD.style.top=(BM.offsetHeight-8)/2+AJ+i+AA;BD.style.left=BM.offsetWidth+"px";}Ao=Aa(BM,A5);n(BM,A5,Ao,A2,A0);AL(BM,0,A2,(Ao<A0)?Ao:A0);BK+=Ai(BM,A0)+2*AJ;BF=Ay;BA.innerHTML="";if(A1.items&&A1.items.length>0){BA.style.display="block";d.call(this,BA,A1,BF,1);}else{BA.style.display="none";}BA.style.top=BK+AA;BA.style.left="0"+AA;BA.style.width=BF+AA;BK+=BA.offsetHeight;if(BH>0){BF-=BH+A;}A3.innerHTML="";if(A1.elements&&A1.elements.length>0){A3.style.display="block";d.call(this,A3,A1,BF,A1.caseFlag);}else{A3.style.display="none";}Ax.style.position="absolute";Ax.style.top=BK+AA;Ax.style.marginLeft=A+AA;A3.style.top=BK+AA;A3.style.left=(BH+A)+AA;A3.style.width=BF+AA;BK+=Au+A;Ar.style.height=BK+AA;A3.style.display="table";Ax.width=BH;Ax.height=Au;Ad.call(this,Ax,A1);A6+=BK+i;}}}}}function q(){var An,Ao=this.textDivs,Ap=Ao.length;for(An=0;An<Ap;An++){c(Ao[An]);}}mstrmojo.gm.GMLegend=mstrmojo.declare(mstrmojo.VisLegend,[mstrmojo._FormateVisLegend,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.gm.GMLegend",cssClass:"gm-legend",dropZoneHighlightCss:"gm-legend-slot",dockedPositions:null,dockPos:AQ.LEFT,GMW:0,GMH:0,isMinimal:false,shapeType:undefined,legendMarkup:'<div class="gm-legend-button"><div class="gm-legend-tri-button"></div><div class="gm-legend-name"></div><div class="gm-legend-close-button"></div></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><div class="gm-legend-table-container"><table class="gm-legend-table"></table></div></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><table class="gm-legend-table"></table><table class="gm-legend-table"></table><canvas type="lgd-canvas"></canvas></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><table class="gm-legend-table"></table><table class="gm-legend-table"></table><canvas type="lgd-canvas"></canvas></div><div class="gm-legend-resizer-v" draggable="false"></div><div class="gm-legend-resizeRect"></div>',init:function AG(Ao){this.styles={};this.cutBy=null;this.dataArray=null;this.textDivs=[];this.dockedPositions=[{pos:o.LEFT_TOP},{pos:o.LEFT_MIDDLE},{pos:o.LEFT_BOTTOM},{pos:o.RIGHT_TOP},{pos:o.RIGHT_MIDDLE},{pos:o.RIGHT_BOTTOM}];var Ap=Ao.placeholder,An=Ap.style;if(Ap){this.cssClass=Ap.getAttribute("class");if(!this.cssClass){this.cssClass="";}if(Ao.hasOwnProperty("width")===false){Ao.width=(An&&An.width)||Ap.clientWidth;}if(Ao.hasOwnProperty("height")===false){Ao.height=(An&&An.height)||Ap.clientHeight;}if(Ao.hasOwnProperty("left")===false){Ao.left=Ap.offsetLeft;}if(Ao.hasOwnProperty("top")===false){Ao.top=Ap.offsetTop;}}this._super(Ao);},setupScrollNodes:function M(){this.scrollNode=this.cbTableContainer;},getSplitterDockPos:function(){return(this.currDockedPositionIdx<3)?AQ.RIGHT:AQ.LEFT;},isOnRight:function(An){return(An===o.RIGHT_MIDDLE||An===o.RIGHT_TOP||An===o.RIGHT_BOTTOM||An===o.RIGHT);},updateAlignClass:function(){var Ar=this.getDockedPosition(),As=Ar&&Ar.pos,Ap=this.isOnRight(As),An=this.domLegend,Ao=this.domNode,Aq=this.resizeRect;if(Ap){Ag.removeClass(An,"gm-align-left");Ag.addClass(An,"gm-align-right");Ag.toggleClass(An,"gm-legend-alignRight",true);Ag.toggleClass(An,"gm-legend-alignLeft",false);Ag.toggleClass(Ao,"gm-legend-alignRight",true);Ag.toggleClass(Ao,"gm-legend-alignLeft",false);Ag.toggleClass(Aq,"gm-legend-alignRight",true);Ag.toggleClass(Aq,"gm-legend-alignLeft",false);}else{Ag.removeClass(An,"gm-align-right");Ag.addClass(An,"gm-align-left");Ag.toggleClass(An,"gm-legend-alignRight",false);Ag.toggleClass(An,"gm-legend-alignLeft",true);Ag.toggleClass(Ao,"gm-legend-alignRight",false);Ag.toggleClass(Ao,"gm-legend-alignLeft",true);Ag.toggleClass(Aq,"gm-legend-alignRight",false);Ag.toggleClass(Aq,"gm-legend-alignLeft",true);}},postBuildRendering:function(){this._super();var Az=this.styles,A1=this.domNode,Aq=this.domLegend.childNodes,Au=Aq[1],As=Aq[2],A0=Aq[3],A4={objType:AK.LEGEND};this.addSlots({lgdBtn:Aq[0],triBtn:Aq[0].firstChild,lgdName:Aq[0].childNodes[1],closeBtn:Aq[0].lastChild,cbContainer:Aq[1],sepLine1:Au.firstChild,cbTitle:Au.childNodes[1],cbTableContainer:Au.childNodes[2],cbTable:Au.childNodes[2].firstChild,sb1Container:As,sepLine2:As.firstChild,sb1Title:As.childNodes[1],sb1MetricNamesTable:As.childNodes[2],sb1DataTable:As.childNodes[3],sb1Canvas:As.childNodes[4],sb2Container:A0,sepLine3:A0.firstChild,sb2Title:A0.childNodes[1],sb2MetricNamesTable:As.childNodes[2],sb2DataTable:A0.childNodes[3],sb2Canvas:A0.childNodes[4],splitter:Aq[4],resizeRect:Aq[5]});Ah.GMLegend.applyHTML5Props(Az);this.bgColor=Az.background||Az.backgroundColor||"transparent";AS.applyStyle2Legend(Az,A1,this.domLegend);if(mstrApp.isInVFInteractMode){this.closeBtn.style.visibility="hidden";}var At=this.getSplitterDockPos(),A3=this.width-2*A-2*Aj,Av=this.cbTitle,Ao=Av.style,Ap=this.sb1Title,Ar=this.sb2Title,A2=Ap.style,An=Ar.style,Ay=this.sepLine1,Ax=this.sepLine2,Aw=this.sepLine3;Ay.style.width=A3+AA;Ax.style.width=A3+AA;Aw.style.width=A3+AA;Ao.lineHeight=H+AA;A2.lineHeight=H+AA;An.lineHeight=H+AA;Ao.maxHeight=2*H+AA;A2.maxHeight=2*H+AA;An.maxHeight=2*H+AA;Av.identity={objType:AK.LEGEND_TEXT,parentIdentity:A4};Ap.identity={objType:AK.LEGEND_TEXT,parentIdentity:A4};Ar.identity={objType:AK.LEGEND_TEXT,parentIdentity:A4};this.dockPos=At;this.identity=A1.identity=A4;this.updateAlignClass();},feedData:function(An,Ao){this.dataArray=An;this.isMinimal=Ao;this.textDivs=[];Ah.GMLegend.applyHTML5Props(this.styles);this.autoCollapseLegend();if(Ao||this.autoCollapse){AY.call(this);this.draggable=false;}else{U.call(this);this.draggable=true;}q.call(this);this.updateScrollbars();},autoCollapseLegend:function(){this.autoCollapse=false;},updateColorBySquare:function(Ap){var Aq,Ar,Ao,An;if(Ap){An=this.domNode.querySelectorAll(".gm-legend-colorbox-div");Aq=Ap.elements;Ar=Math.min(Aq.length,An.length);for(Ao=0;Ao<Ar;Ao++){E.call(this,Aq[Ao],An[Ao]);}}},updateContainerSize:function(An,Ao){this.GMW=An;this.GMH=Ao;this.calculateDockedPositions(An,Ao);},updateAfterResize:function(){Ah.GMLegend.applyHTML5Props(this.styles);var As=0,Ar=this.width,At=this.cbContainer,Av=this.sb1Container,Ap=this.sb2Container,Aq=this.sepLine1,Ao=this.sepLine2,An=this.sepLine3,Au=Ar-2*A-2*Aj;P.forEach(this.dataArray||[],function(Aw){if(Aw.dataType===Ac.COLOR_BY){if(Aw.dataObj){if(At){At.style.width=Au+AA;}}}else{if(Aw.dataType===Ac.SIZE_BY){if(Aw.dataObj){As++;if(As===1&&Av){Av.style.width=Au+AA;}if(As===2&&Ap){Ap.style.width=Au+AA;}}}}});if(Aq){Aq.style.width=Au+AA;}if(Ao){Ao.style.width=Au+AA;}if(An){An.style.width=Au+AA;}this.domLegend.style.width=this.width+AA;this.domLegend.style.height=this.height+AA;},updateStyle:function(An){this.styles=An;this.bgColor=An.background||An.backgroundColor||"transparent";AS.applyStyle2Legend(An,this.domNode,this.domLegend);},updateTitleLineHeight:function(){var Ao=this.cbTitle,Ar=Ao.style,Ap=this.sb1Title,An=this.sb2Title,As=Ap.style,Aq=An.style;Ah.GMLegend.applyHTML5Props(this.styles);Ar.lineHeight=H+AA;As.lineHeight=H+AA;Aq.lineHeight=H+AA;Ar.maxHeight=2*H+AA;As.maxHeight=2*H+AA;Aq.maxHeight=2*H+AA;},getSplitterPosition:function(Ap){var Ao=Ap.src.startPos+Ap.tgt.pos.x-Ap.src.pos.x,Ar=Ap.src.posInfo,Aq=Ar&&Ar.min,An=Ar&&Ar.max;if(Aq!==undefined){Ao=Math.max(Ao,Aq);}if(An!==undefined){Ao=Math.min(Ao,An);}return Ao;},positionResizeRect:function(An,Ao){var Aq=An.src.posInfo.dockPosition===AQ.LEFT,Ar=Ao-AU,As=Aq?Ar:0,Ap=Aq?this.width-Ar:Ar;this.resizeRect.style.left=(As-1)+AA;this.resizeRect.style.width=(Ap-2)+AA;},updateLegendSlot:function(Ap){var Ao=this.getDockedPosition(),An=Ao&&Ao.pos;if(An!==Ap){this.currDockedPositionIdx=this.getLegendDockPosIdx(Ap);this.dockPos=this.getSplitterDockPos();this.updateDropZonePosition();this.updateAlignClass();this.updateSplitter();this.widget.onLegendDropZoneChange(this.getDockedPosition());}},isDragValid:function s(An){return !mstrApp.isInVFInteractMode&&this._super(An);},ondragstart:function(An){var Ap=An.src.e.target,Ao=An.src.data;if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(false);}if(Ap===this.splitter){An.src.startPos=Ap.offsetLeft;An.src.posInfo=this.getSplitterInfo(Ap);this.positionResizeRect(An,An.src.startPos);Ag.addClass(this.resizeRect,"resizing");}else{this.cbTableScrollTop=this.cbTableContainer.scrollTop;this._super(An);if(!Ao||!Ao.isScrollBar){this.clearSelectedTargets();Ag.toggleClass(this.domNode,"gm-legend-hover",false);Ag.toggleClass(this.domLegend,"active",false);this.cbTableContainer.scrollTop=this.cbTableScrollTop;this.domLegend.style.background=this.bgColor;this.isDragging=true;}}},ondragmove:function D(An){var Ap=An.src.e.target,Ao;if(Ap===this.splitter){Ao=this.getSplitterPosition(An);Ap.style.left=Ao+AA;this.positionResizeRect(An,Ao);}else{this._super(An);}},ondragend:function(An){var Ap=An.src.e.target;if(Ap===this.splitter){Ag.removeClass(this.resizeRect,"resizing");this.splitterMoved(this.getSplitterPosition(An)-An.src.startPos,An.src.posInfo);}else{this._super(An);var Ao=An.src.data;if(!Ao||!Ao.isScrollBar){this.cbTableContainer.scrollTop=this.cbTableScrollTop;this.domLegend.style.background="transparent";this.isDragging=false;}delete this.cbTableScrollTop;}if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(true);}},onscroll:function(){var Ao,As,Ar=this.scrollNode.scrollTop,Aq,Ap,An;if(this.prevScrpllTop===Ar){return ;}As=(this.dataArray&&this.dataArray.length)||0;for(Ao=0;Ao<As;Ao++){Ap=this.dataArray[Ao];if(Ap.dataType===Ac.COLOR_BY){An=Ap.dataObj;break;}}if(An){Aq=this.cbTable;Aq.innerHTML="";Aq.appendChild(this.fillColorByTable(An,Math.floor(Ar/AN)));this.prevScrpllTop=Ar;this.scrollNode.scrollTop=Ar;this._super();}},fillColorByTable:function(A3,At){var A4,A1,Ap,As,Ar,Au,Av,Aw=this.styles,An,Az=this.cutBy,Ax=this.width-2*Aj-2*A,Ay,Aq,Ao,A5,A0,A6;Ay=A3.elements;A1=Ay.length;An=document.createDocumentFragment();Aq=Ax-AB-AZ;Ao=0;A5=AN*A1;A0=At*AN;function A2(A7){Ap=document.createElement("tr");As=document.createElement("td");Ap.style.height=A7+AA;As[AD]("class","gm-legend-colorbox");Ap.appendChild(As);An.appendChild(Ap);}if(At>0){A2(A0);}for(A4=At;A4<A1;A4++){Ap=document.createElement("tr");As=document.createElement("td");Ar=document.createElement("td");Au=document.createElement("div");Av=document.createElement("div");Au[AD]("class","gm-legend-colorbox-ctn-div");Au[AD]("type",C.LGD_COLORBOX_CTN);Av[AD]("class","gm-legend-colorbox-div");Av[AD]("type",C.LGD_COLORBOX);E.call(this,Ay[A4],Av);Ap[AD]("class","gm-legend-tr");Ap.style.height=AN+AA;As[AD]("class","gm-legend-colorbox");Ar[AD]("class","gm-legend-desc");A6=Ay[A4];if(A6.bftp){b.fillImageInDiv(Ar,A6.bftp,A6.label,"gm-img-legend");}else{AC.call(this,Ar,A6.label,A4,y,Aq,Aw);}Au.appendChild(Av);As.appendChild(Au);Ap.appendChild(As);Ap.appendChild(Ar);An.appendChild(Ap);Ao+=AN;if(Az&&(Az+Ao-AN)>A5){A2(A5-Ao-A0);break;}}return An;},calculateDockedPositions:function(Ao,Ar){var Aq,At=this.getWidth(),An=this.getHeight(),Ap=this.dockedPositions,As=function(Au){switch(Au.pos){case k.LEFT_TOP:Au.x=0;Au.y=X;break;case k.LEFT_MIDDLE:Au.x=0;Au.y=Math.max(X,(Ar-An)>>1);break;case k.LEFT_BOTTOM:Au.x=0;Au.y=Math.max(0,Ar-An-X);break;case k.RIGHT_TOP:Au.x=Ao-At;Au.y=X;break;case k.RIGHT_MIDDLE:Au.x=Ao-At;Au.y=Math.max(X,(Ar-An)>>1);break;case k.RIGHT_BOTTOM:Au.x=Ao-At;Au.y=Math.max(0,Ar-An-X);break;}};for(Aq=0;Aq<Ap.length;Aq++){As(Ap[Aq]);}this.updateDropZonePosition();},updateDropZonePosition:function(){var An=this.getDockedPosition(),Ao=this.dropZoneNode.style;Ao.left=An.x+AA;Ao.top=An.y+AA;},updateDropZoneNode:function(An){this._super(An);this.dockPos=this.getSplitterDockPos();this.updateSplitter();},onmouseover:function(An){var Ap=this.domLegend,At=An.getTarget(),Aq=At.getAttribute("type"),As=this.widget,Ao;if(this.isDragging){return ;}var Ar=S.copy(this.styles);Ar.opacity+=0.4;AS.applyStyles2DomNode(this.domNode,Ar);if(AE.contains(Ap,At,true)){Ag.addClass(Ap,"active");}if(Aq===C.LGD_COLORBOX){At=At.parentNode;Aq=At.getAttribute("type");}if(Aq===C.LGD_COLORBOX_CTN){Ao=At.firstChild.identity;if(!Ao||!Ao.comb){return ;}Ag.toggleClass(At,"hover-colorsquare",true);return ;}if(As.formattingMode){switch(Aq){case C.LGD_TITLE:case C.LGD_TEXT:Ag.toggleClass(Ap,"hover-txt",true);break;default:Ag.toggleClass(this.domNode,"gm-legend-hover",true);break;}}},onmouseout:function(Ao){var Aq=this.domLegend,An=Ao.e.toElement||Ao.e.relatedTarget,At=Ao.getTarget(),Ar=At.getAttribute("type"),As=this.widget,Ap;AS.applyStyles2DomNode(this.domNode,this.styles);if(!AE.contains(Aq,An,true)){Ag.removeClass(Aq,"active");}if(Ar===C.LGD_COLORBOX){At=At.parentNode;Ar=At.getAttribute("type");}if(Ar===C.LGD_COLORBOX_CTN){Ap=At.firstChild.identity;if(!Ap||!Ap.comb){return ;}Ag.toggleClass(At,"hover-colorsquare",false);return ;}if(As.formattingMode||As.isOnFormattingMode){switch(Ar){case C.LGD_COLORBOX_CTN:case C.LGD_COLORBOX:break;case C.LGD_TITLE:case C.LGD_TEXT:Ag.toggleClass(Aq,"hover-txt",false);break;default:Ag.toggleClass(this.domNode,"gm-legend-hover",false);break;}}},onclick:function(An){var Aq=An.getTarget(),Ao=Aq.getAttribute("type"),Ap=this.widget;if(Aq===this.triBtn){if(!this.autoCollapse){this.raiseEvent({name:"gm-legend-clicked",action:(this.isMinimal?"restore":"minimize")});}}else{if(Aq===this.closeBtn){this.raiseEvent({name:"gm-legend-clicked",action:"close",mousePos:An.e});}else{if(Ao===C.LGD_COLORBOX){Aq=Aq.parentNode;Ao=Aq.getAttribute("type");}if(Ap.formattingMode||Ap.isOnFormattingMode){if(Ao===C.LGD_COLORBOX_CTN){this.selectColorBox(Aq,true);}else{if(Ao===C.LGD_TEXT||Ao===C.LGD_TITLE){this.selectText();}else{this.selectLegendBody();}}}else{this.clearSelectedColorBox();}}}AE.stopPropogation(null,An.e);},attachClearEvent:function(){if(this.clearSelectTargetfn){return ;}var Ao=this,An=this.domLegend;this.clearSelectTargetfn=function(As){var Ar=As.target,Ap=Ao.widget.toolEditor,Aq;if(!AE.contains(An,Ar,true,An)){if(Ap){Aq=Ap.domNode;if(!AE.contains(Aq,Ar,true,Aq)){Ao.clearSelectedTargets();}}else{Ao.clearSelectedTargets();}}};AE.attachEvent(document.body,"mousedown",this.clearSelectTargetfn,true);},clearSelectedColorBox:function(){var An=this.selectedColorBox;if(An){Ag.toggleClass(An,"select",false);Ag.toggleClass(An,"selectfmt",false);this.selectedColorBox=undefined;}},clearSelectedText:function(){Ag.removeClass(this.domNode,"select-txt");},clearSelectedLegendBody:function(){Ag.removeClass(this.domNode,"gm-legend-select");},clearSelectedTargets:function(){this.clearSelectedColorBox();this.clearSelectedText();this.clearSelectedLegendBody();if(this.clearSelectTargetfn){AE.detachEvent(document.body,"mousedown",this.clearSelectTargetfn,true);delete this.clearSelectTargetfn;}},selectColorBox:function(Ap,Ao){var An=Ap.firstChild.identity;if(!An||!An.comb){return ;}this.clearSelectedText();this.clearSelectedLegendBody();if(this.selectedColorBox!==Ap){this.clearSelectedColorBox();this.selectedColorBox=Ap;if(Ao){Ag.toggleClass(Ap,"selectfmt",true);}else{Ag.toggleClass(Ap,"select",true);}this.attachClearEvent();}},selectText:function(){this.clearSelectedColorBox();this.clearSelectedLegendBody();Ag.addClass(this.domNode,"select-txt");this.attachClearEvent();},selectLegendBody:function(){this.clearSelectedColorBox();this.clearSelectedText();Ag.addClass(this.domNode,"gm-legend-select");this.attachClearEvent();},adjustColorPickerPos:function(An){var Aq=AE.position(An),Ao=0,Ap={};if(this.currDockedPositionIdx<3){Ap.x=Aq.x+Aq.w+Ao;Ap.alignLeft=true;}else{Ap.x=Aq.x-Ao;Ap.alignLeft=false;}Ap.y=Aq.y+Aq.h+Ao;return Ap;},getSplitterInfo:function(As){if(!As){return{};}var Ao=this.dockPos,Ar={},Aq=this.width,An=AO,Ap=Math.floor(this.GMW/3);Ar.dockPosition=Ao;if(Ao===AQ.LEFT){Ar.min=Math.min(Aq-Ap,0);Ar.max=Math.max(Aq-An,0);}else{if(Ao===AQ.RIGHT){Ar.min=An;Ar.max=Ap;}}Ar.min+=AU;Ar.max+=AU;return Ar;},splitterMoved:function(An,Ao){if(An===0){return ;}if(Ao.dockPosition===AQ.LEFT){An=-An;}this.raiseEvent({name:"gm-legend-resized",position:An});this.updateSplitter();if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(true);}},updateSplitter:function(){AW(this.splitter,this.dockPos,this.width,this.height);this.resizeRect.style.height=this.height-2+AA;},getLegendDockPosIdx:function(An){return P.find(u,"pos",An);},getLegendDockPosByIdx:function(An){return(An>=0&&An<u.length)?u[An].pos:o.RIGHT_MIDDLE;}});Ah.GMLegend.IMAGE_SIZE_FIXED=0;Ah.GMLegend.applyHTML5Props=function(Ap){var Aq=parseInt(Ap.fontSize,10)||8,Ao;if(Ap.fontSize.indexOf("px")>=0){Aq=Math.floor(Aq*a+0.5);}Ao=Math.floor(Aq/a*F+0.5);H=Math.max(Aq,8)+9;AX=Math.floor(Aq/a+0.5);f=Math.max(Ao,15);AN=Ah.GMLegend.IMAGE_SIZE_FIXED||(Math.max(Ao,20)+2);w=Math.max(Ao,14)+2;Aj=parseInt(Ap.borderWidth,10)||1;var An=parseInt(Ap.tbHeight,10);m=isNaN(An)?K:An;};Ah.GMLegend.getLegendSize4MinMode=function(Ao,Ap){var Ar,Aq,An=m+2*Aj;if(Ao){Aq=Ao.elements;Ar=Aq.length;An+=AN*Ar;An+=2*A;}An=Math.min(An,Ap-X*2);return{width:AB+5+7+2*Aj,height:An};};Ah.GMLegend.getLegendSize=function(A1,Aq,An,At,A3,Au){var Av,Ao,A2,As,Ar=At-X*2,Az=0,Ap=0,Ay={},Ax,Aw,A0;if(!A1||!A1.length||A1.length<1){return{};}if(Aq!==undefined){if(!Au){Au=Math.floor(Af(A1,A3)*Aq);}As=Math.min(Au,Math.floor(An/3));As=Math.max(As,50);return j(A1,As,At,A3);}As=Math.min(Math.floor(0.2*An),300);for(Av=0;Av<A1.length;Av++){Aw=A1[Av];if(Aw.dataType===Ac.COLOR_BY){Ax=Ae(Aw.dataObj,A3);if(Ax>Az){Az=Ax;}}else{if(Aw.dataType===Ac.SIZE_BY){Ax=AT(Aw.dataObj,A3);if(Ax>Ap){Ap=Ax;}}}}Ao=Math.max(Az,Ap)+2*Aj;Ay.width=Math.min(Ao,As);Ay.scale=Ay.width/Ao;A0=e(A1,Ay.width,A3);A2=A0.height;Ay.autoCollapse=A0.minHeight>Ar;Ay.minHeight=A0.minHeight;Ay.height=Math.min(A2,Ar);if(A2>Ar){Ay.cutBy=A2-Ar;}return Ay;};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.taphold","mstrmojo.VisUtility","mstrmojo.CustomVisUtility","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.ToolbarEditorConfig","mstrmojo.FormatControlHelper","mstrmojo.customviz.GraphicModel","mstrmojo.customviz.CustomVisEnums");mstrmojo.CUSTOM_CONTEXT_MENU={NORMAL:"normal",TOGGLE:"toggle",SUBMENU:"submenu",SEPARATOR:"seperator",SINGLE_SELECT_LIST:"single_select_list",MULTI_SELECT_LIST:"multiple_select_list",FORMAT:"format"};mstrmojo.DEFAULT_CONTEXT_MENU={KEEP_ONLY:"KEEP_ONLY",EXCLUDE:"EXCLUDE",DRILL:"DRILL",GROUP:"GROUP",CALCULATION:"CALCULATION",SHOW_DATA:"SHOW_DATA",GO_TO_TARGETS:"GO_TO_TARGETS",SHOW_LEGEND:"SHOW_LEGEND"};var N=mstrmojo.dom,h=mstrmojo.array,O=mstrmojo.hash,C=mstrmojo.css,l=mstrmojo.CustomVisUtility,z=mstrmojo.CUSTOM_CONTEXT_MENU,t=mstrmojo.DEFAULT_CONTEXT_MENU,U=l.log,m=mstrmojo.FormatControlHelper,AC=m.FORMAT_CONTROL_TYPE,Z=mstrmojo.VisUtility,a=mstrmojo.vi.enums.EnumFeatures,M=mstrmojo.customviz.CustomVisEnums,A=M.ENUM_LEGEND_PROPS,K=3,i="touchstart",n="mousedown",E=N.isIOSTouch,W=E?i:n,S,AA;function L(AF,AD){if(!AA||typeof AA.validate!=="function"){AA=new Ajv_d6({useDefaults:true});}var AE=AA.validate(AF,AD);if(!AE){U(AA.errorsText());}return AE;}function c(AE,AD){return AE&&AE[AD]&&AE[AD] instanceof Function;}function F(AD){return function(){AD(true);};}function q(AD){return function(){AD(false);};}function o(AF,AG,AD){var AE=AD.propertyName;if(AE){AD.currentValue=AF.getProperty(AE);AD.onClick=function(AH){AF.savePropertyAndUpdateWidget(AE,AH.toString(),AD.config,AD.showFormatPanel);};}AG.addToggleMenuItem(AD.name,AD.cls||"",F(AD.onClick),q(AD.onClick),AF.id,l.parseBoolean(AD.currentValue),AD.ctxt);}function p(AD){return h.map(AD,function(AE){return{text:AE.name,value:AE.value};});}function u(AG,AD,AE){var AF=AE.propertyName;if(AF){AE.currentValue=AG.getProperty(AF);AE.onClick=function(AH){AG.savePropertyAndUpdateWidget(AF,AH,AE.config,AE.showFormatPanel);};}AD.addRadioMenuGroup(AE.currentValue,AE.onClick,p(AE.items),AE.cls||"",AE.ctxt);}function J(AG,AD,AE){var AF=AE.propertyName,AH;if(AF&&AE.items){AH=AG.getProperty(AF)||{};h.forEach(AE.items,function(AK){var AJ=AK.propertyName,AI=O.clone(AH);if(AJ){AK.currentValue=AH[AJ];AK.onClick=function(AL){AI[AJ]=AL;AG.savePropertyAndUpdateWidget(AF,AI,AE.config,AE.showFormatPanel);};}AD.addToggleMenuItem(AK.labelText,AE.cls||"",F(AK.onClick),q(AK.onClick),AG.id,l.parseBoolean(AK.currentValue),AK.ctxt);});}}function V(AE,AF,AD){if(AD.isDisabled){AF.addNonInteractiveMenuItem(AD.name,AD.cls||"",true);}else{AF.addMenuItem(AD.name,AD.cls||"",AD.onClick,AD.ctxt);}}function g(AF,AG,AD,AE){AD.onClick=function(){AF.openFormatEditor(AE,AD.formatConfig);if(AD.showFormatPanelName){AF.openFormatPanelByName(AD.showFormatPanelName);}};AG.addMenuItem(AD.name,AD.cls||"",AD.onClick,AD.ctxt);}function B(AD){return h.filter(AD,function(AE){var AF;switch(AE.type){case z.NORMAL:AF=S.customConfig.validNormalSchema(AE);break;case z.TOGGLE:AF=S.customConfig.validToggleSchema(AE);break;case z.SEPARATOR:AF=true;break;case z.SUBMENU:AF=S.customConfig.validSubMenuSchema(AE);break;case z.SINGLE_SELECT_LIST:AF=S.customConfig.validSingleSelectListSchema(AE);break;case z.MULTI_SELECT_LIST:AF=S.customConfig.validMultiSelectListSchema(AE);break;case z.FORMAT:AF=S.customConfig.validFormatSchema(AE);break;default:AF=true;}return AF&&(AE.isShown!==false);});}function I(AE,AF,AD){var AG=new mstrmojo.ui.menus.MenuConfig();if(!S.customConfig.validCommonSchema(AF)){return ;}AF=B(AF);h.forEach(AF,function(AH){switch(AH.type){case z.NORMAL:V(AE,AG,AH);break;case z.TOGGLE:o(AE,AG,AH);break;case z.SEPARATOR:AG.addSeparator();break;case z.SUBMENU:if(AH.subMenuConfig){AH.getSubMenuConfig=function(){return I(AE,AH.subMenuConfig);};}AG.addPopupMenuItem(AH.name,AE.id,AH.getSubMenuConfig,AH.cls||"",AH.ctxt);break;case z.SINGLE_SELECT_LIST:u(AE,AG,AH);break;case z.MULTI_SELECT_LIST:J(AE,AG,AH);break;case z.FORMAT:g(AE,AG,AH,AD);break;default:AG.addNonInteractiveMenuItem(AH.name,"",true);}});return AG;}function j(AF,AH,AE){var AD=[],AG;if(!S.formatControlConfig.validCommonSchema(AH)){return ;}AH=B(AH);h.forEach(AH,function(AJ,AI){AJ.provideDefaultWidth=true;switch(AJ.type){case AC.FILLGROUP:if(S.formatControlConfig.validFillGroupSchema(AJ)){AG=m.getFillGroupControl(AF,AJ);}break;case AC.LINEGROUP:if(S.formatControlConfig.validLineGroupSchema(AJ)){AG=m.getLineGroupControl(AF,AJ);}break;case AC.CHARACTERGROUP:if(S.formatControlConfig.validCharacterGroupSchema(AJ)){O.copy({cssClass:"mstrmojo-ui-ToolbarCharacter cf",layoutConfig:null,width:"397px",height:"22px"},AJ);AG=m.getCharacterGroupControl(AF,AJ);}break;case AC.COLORBYGROUP:if(S.formatControlConfig.validColorByGroupSchema(AJ)){AG=m.getColorByFillGroupControl(AF,AJ);}break;}if(AG){if(AI>0&&AE){AG.cssClass=(AG.cssClass?AG.cssClass+" ":"")+"mstrmojo-ui-rowContainer";}AD.push(AG);}});return AD;}function G(AU,AV){var AW=this,AJ=AV.updateActions,AN={act:"updateTemplate",keyContext:AW.k,actions:[]},AR=AN.actions,AM=[Z.pick(AU,["did","t"])],AG=AV.drillFromUnit.id,AK=AV.drillFromUnit.n,AO=AW.zonesModel,AI=AO.getCustomDropZones(),AQ,AD,AS,AH,AF,AP,AE;if(AJ&&AJ instanceof Array){for(AE=0;AE<AJ.length;++AE){var AT=AJ[AE];AQ=parseInt(AT.dropZoneIndex);if(!isNaN(AQ)&&AQ>=0){AS=AO.getZoneModelByZoneId(AQ+K);if(AS){var AL=AI[AQ].maxCapacity||Infinity;AD={id:AQ+K};AH=AS.items||[];AP=Z.findInArray(AH,function(AX){return AX.did===AG;});if(!AT.keepParent){if(AP!==-1){AF=AH[AP];Array.prototype.push.apply(AR,AO.getRemoveDropZoneUnitActions(AD,AF));Array.prototype.push.apply(AR,AO.getAddDropZoneUnitsActions(AD,AM,AF.idx));}else{U('The attribute "'+AK+'" to replace does not exist in drop zone ['+AQ+"].");}}else{if(AH.length<AL){AF=AH[AP];Array.prototype.push.apply(AR,AO.getAddDropZoneUnitsActions(AD,AM,AF?AP+1:0));}else{U("Can not append attribute to drop zone ["+AQ+"].");}}}}else{U('The parameter "dropZoneIndex" is invalid in the item ['+AE+'] of the parameter "updateDropZoneActions".');}}}else{U('Parameter "updateDropZoneActions" does not exist or is invalid.');}return AN;}function y(AE,AD,AG){var AF={};AF[AE]=[{id:AD,n:AG}];return AF;}mstrmojo._HasCustomContextMenu=mstrmojo.provide("mstrmojo._HasCustomContextMenu",{_mixinName:"mstrmojo._HasCustomContextMenu",selectionSupportsVizFilter:function Q(AE){var AF=this.model,AD=true;if(!AF){return false;}h.forEach(AE,function(AG){h.forEach(AG,function(AH){if(!AF.supportsViewFilterActions(AH.tid)){AD=false;return false;}});});return AD;},getHost:function e(){return this;},canDrill:function R(AD){var AE={show:false,enable:false};if(!mstrApp.isInVFConfigMode&&mstrmojo.resolveFeature(a.WEB_DRILL_AND_LINK)){AE.show=true;if(Z.getDrillCandidates(this,AD.tid).length>0){AE.enable=true;}else{U('The drill action can not be performed, may be the given parameter "drillFrom" is not right or there is no attribute left to drill');}}else{U("The drill action not supported, may be you do not have the privilege or you are editing a viz filter.");}return AE;},canDoGroupCalculation:function D(){var AD={show:false,enable:false};if(!mstrApp.isAppStatePresentation()&&!mstrApp.isInVFConfigMode){AD.show=true;AD.enable=true;}else{U("The group/calculation action not supported, may be you are in the presentation mode or editing a viz filter.");}return AD;},canShowData:function Y(){var AD={show:false,enable:false};if(!mstrApp.isDossier&&!this.excludeData){AD.show=true;AD.enable=true;}else{U("The show data action not supported, may be you are in the pause mode or not editing a dossier.");}return AD;},getSelectionGroupMenuConfig:function P(AL,AP){var AM={},AK=AL.hasOwnProperty("group"),AN=AL.hasOwnProperty("calculation"),AH,AF,AJ,AE=AP[0].isAttributeSelector(),AD=true;h.forEach(AP,function(AR){if((AE&&!AR.isAttributeSelector())||(!AE&&AR.isAttributeSelector())){AD=false;U("The group/calculation action cannot be performed, because the context menu selection has both headers and data points.");return false;}AF=AR.getGroupHeaders();if(AF.length===0){AD=false;U('The group/calculation action cannot be performed, please check the format of parameter "headers" you passed to "setGroupOptions()" of graphic model.');return false;}for(AH=0;AH<AF.length;++AH){AJ=AF[AH];if(AJ.headerObj&&!c(AJ.headerObj,"getElementId")){AD=false;U('The group/calculation action cannot be performed, please check the format of parameter "headers" you passed to "setGroupOptions()" of graphic model.');return false;}}});if(!AD){return AM;}var AG=function(AR){return AR.getName();},AI,AQ=function(AT){var AR=[],AV,AU,AS={};h.forEach(AT,function(AW){AU=AW.getGroupHeaders();h.forEach(AU,function(AX){AV=AX.headerObj.getElementId();if(!AS.hasOwnProperty(AV)){AS[AV]=true;AR.push(AX.headerObj);}});});return AR;};if(AE){var AO=AP[0].getGroupHeaders()[0];AI=this.getCellForNode(AO.headerObj);AM=Z.getGroupAndCalculationContextMenu(this,AI,{skipSingleAttrCheck:true,selection:AQ(AP),fnCellName:AG,hideGroupMenu:AK,hideCalculationMenu:AN});}else{AM=Z.getGroupAndCalculationContextMenuForDataPoints(this,{selection:AP,fnCellName:AG,fnUnique:AQ,fnMakeNode:function(AR){return AR;},hideGroupMenu:AK,hideCalculationMenu:AN});}if(Object.getOwnPropertyNames(AM).length===0){U("The group/calculation action can not be performed, please check the given headers.");}return AM;},getCustomDrillMenu:function(AD,AJ,AF){var AI=AD,AH=AI.tid,AG=AI.n,AE={id:AH,n:AG};return Z.getDrillMenu.bind(Z,this,AH,AJ,{drillFromUnit:AE,updateActions:AF});},getMenuHandler:function b(AI){var AH=this,AL;switch(AI){case t.KEEP_ONLY:AL=function AE(){AH.updateAfterKeepOnly(true);};break;case t.EXCLUDE:AL=function AK(){AH.updateAfterKeepOnly(false);};break;case t.DRILL:AL=function AG(AM){Z.doDrill(AH,AM.ctxt.drillUnit,G,AM.ctxt);};break;case t.SHOW_DATA:AL=function AF(){AH.showData();};break;case t.GO_TO_TARGETS:AL=function AD(){AH.handleContextMenuSelectionData(true);};break;case t.SHOW_LEGEND:AL=function AJ(){AH.saveObjectProperty(M.LEGEND_PROPERTY_SET,A.SHOW_LEGEND,true,undefined,true);};break;default:AL=mstrmojo.emptyFn;break;}return AL;},getCustomMenuConfig:function s(AD,AE){AD=h.ensureArray(AD);return I(this,AD,AE);},getCommonMenuConfig:function H(AP){var AS=this.getContextMenuSelExtraInfo();if(AS.length===0){return this.getShowLegendMenuConfig(AP);}var AG=new mstrmojo.ui.menus.MenuConfig(),AO=new mstrmojo.ui.menus.MenuConfig(),AU=this.selectionSupportsVizFilter(this.getContextMenuSelections()),AM={filter:AG,showData:AO},AR,AT,AJ,AI,AE,AQ,AL,AK,AW,AD=AS[0]&&AS[0].getDrillHeader(),AV=AS[0]&&AS[0].getUpdateDropZoneActions();this.modelData=this.model.data;AL=h.find(AP,"type",t.GO_TO_TARGETS);if(AL!==-1){AQ=AP[AL];if(AU&&this.isLinkedFilterEnabled()){AE=this.getMenuHandler(AQ.type);AG.addMenuItem(mstrmojo.desc(15070,"Go to Targets"),"",AE);AG.addSeparator();}}AL=h.find(AP,"type",t.KEEP_ONLY);if(AL!==-1){AQ=AP[AL];if(AU){AE=this.getMenuHandler(AQ.type);AG.addMenuItem(mstrmojo.desc(11701,"Keep only"),AQ.cls||"",AE,AQ.ctxt);}}AL=h.find(AP,"type",t.EXCLUDE);if(AL!==-1){AQ=AP[AL];if(AU){AE=this.getMenuHandler(AQ.type);AG.addMenuItem(mstrmojo.desc(3946,"Exclude"),AQ.cls||"",AE,AQ.ctxt);}}AL=h.find(AP,"type",t.DRILL);if(AL!==-1){AQ=AP[AL];if(AU){AW=this.canDrill(AD);if(AW.show&&AW.enable){var AH;AH=this.getCustomDrillMenu(AD,this.getMenuHandler(AQ.type),AV);AG.addPopupMenuItem(mstrmojo.desc(145,"Drill"),AQ.cls||"",AH,AQ.ctxt);}else{if(AW.show&&!AW.enable){AG.addNonInteractiveMenuItem(mstrmojo.desc(145,"Drill"),AQ.cls||"",true);}}}}AL=h.find(AP,"type",t.SHOW_DATA);if(AL!==-1){AQ=AP[AL];if(AU){AW=this.canShowData();if(AW.show&&AW.enable){AE=this.getMenuHandler(AQ.type);AO.addMenuItem(mstrmojo.desc(13537,"Show Data..."),AQ.cls||"",AE,AQ.ctxt);}else{if(AW.show&&!AW.enable){AG.addNonInteractiveMenuItem(mstrmojo.desc(13537,"Show Data..."),AQ.cls||"",true);}}}}AL=h.find(AP,"type",t.GROUP);AK=h.find(AP,"type",t.CALCULATION);if(AL!==-1||AK!==-1){AW=this.canDoGroupCalculation();if(AW.show&&AW.enable){var AN={};AR=this.getSelectionGroupMenuConfig(AN,AS);}else{if(AW.show&&!AW.enable){AR={};}}}AJ={showLegend:this.getShowLegendMenuConfig(AP)};AI=Z.mergeHashes(AM,AR,AT,AJ);var AF=[{name:"filter"},{name:"editGroup"},{name:"editCalculation"},{name:"createDe"},{name:"showData"},{name:"renameDe"},{name:"showLegend"}];return Z.mergeMenuConfigs(AI,AF);},getShowLegendMenuConfig:function(AH){var AF=new mstrmojo.ui.menus.MenuConfig(),AE,AI,AD,AG;if(this.enableLegend){AE=h.find(AH,"type",t.SHOW_LEGEND);AI=this.getLegendProperty(A.SHOW_LEGEND);if(AE!==-1&&!AI){AD=AH[AE];AG=this.getMenuHandler(AD.type);AF.addMenuItem(mstrmojo.desc(12001,"Show Legend"),AD.cls||"",AG,AD.ctxt);}}return AF;},getMobileMenuConfig:function X(AF,AH){var AE,AG,AD={},AI=AH&&AH.getDrillHeader(),AJ=AH&&AH.getUpdateDropZoneActions();for(AE in t){AG=t[AE];if(h.find(AF,"type",AG)!==-1){if(AG===t.DRILL){AD[t.DRILL]={drillFrom:AI,updateDropZoneActions:AJ};}else{AD[AG]=true;}}}return AD;},getMousePositionFromEvent:function k(AD){if(AD.touches&&AD.touches.length>0){AD=AD.touches[0];}return N.getMousePosition(AD,window);},showContextMenu:function d(AD,AG,AK){var AE=this;if(mstrApp.isExpress||mstrApp.isInVFInteractMode){N.stopPropogation(window,AD);N.preventDefault(window,AD);return false;}if(AD.e){AD=AD.e;}var AM=this.getCommonMenuConfig(AG),AL=this.getCustomMenuConfig(AK,AD),AI={common:AM,custom:AL},AJ=[{name:"common"},{name:"custom"}],AH=Z.mergeMenuConfigs(AI,AJ),AF;if(!AH.hasMenuItems()){AF=false;}else{AH.hostId=this.id;AH.isHostedWithin=false;AH.position=this.getMousePositionFromEvent(AD);AH.menuCssClass+=" mstrmojo-customvis-contextmenu";if(c(this.contextMenu,"destroy")){this.contextMenu.destroy();}AF=true;if(!mstrApp.isDisplayOnMobile){this.contextMenu=AH.newInstance();if(this.contextMenu){this.contextMenu.onCloseMenuCallBack=function(){AE.applySelection([],{forContextMenu:true});AE.updateHighlight();h.removeItem(AE.disposables,this);};}this.openPopup(this.contextMenu);}AD.stopPropagation();AD.preventDefault();}return AF;},addSelectionBySelectors:function w(AN,AG,AO){var AM=this,AJ,AI,AE=AN[0]&&AN[0].isSelectAttr,AL,AD=0,AK=0,AH=0,AF={x:0,y:0};for(AJ=0;AJ<AN.length;++AJ){AI=AN[AJ];if(AE){AI=y(AI.tid,AI.eid,AI.n);}AL=AM.addSelectionBySingleSelector(AI,AE,false,AG,AO);if(AO){AD+=AL.xTotal;AK+=AL.yTotal;AH+=AL.count;}}if(AH===0&&AN.length!==0){U('We did not get any graphic model by the selector given what may lead to the functionality of restore context menu not work, please check the function "getGraphicModelBySelector()" you have implemented.');}else{if(AO){AF.x=AD/AH;AF.y=AK/AH;}}return AF;},updateContextMenu:function AB(AG,AH){var AE=this,AF,AD={x:0,y:0};AF=AE.isHighlightedAsTarget;AE.isHighlightedAsTarget=false;AD=this.addSelectionBySelectors(AG,true,true);this.addSelectionBySelectors(AH,false);AE.isHighlightedAsTarget=AF;if(this.plotted){this.updateHighlight();}var AI={messageType:"updatePosition",pos:AD};return Z.sendToMobileDevice(AI);},getContextMenuConfig:mstrmojo.emptyFn,openFormatEditor:function f(AG,AE){var AF=this.getHost(),AI=this.formatPopupPlaceholder;var AD=j(AF,AE,true);var AH=new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-ui-ToolbarBorderAndFill",children:AD}]});if(!AI){AI=document.createElement("div");AI.setAttribute("class","gm-menu-placeholder");this.formatPopupPlaceholder=AI;}AI.innerHTML="";document.body.appendChild(AI);AH.hostId=AF.id;AH.hostElement=AI;if(AG.e){AG=AG.e;}AH.position=this.getMousePositionFromEvent(AG);AH.isHostedWithin=false;if(l.isLibrary()){AH.hostProxyCssClass="mojo-theme-light";AH.cssClass="mstrmojo-FormatPopupEditor";}if(!AH.cssClass){AH.cssClass="";}this.openPopup(AH.newInstance({onClose:function(){C.toggleClass(document.body,"hasToolbarPopup",false);}}));C.toggleClass(document.body,"hasToolbarPopup",true);},init:function x(AE){if(this._super){this._super(AE);}if(!window.Ajv_d6){var AD=window.Ajv;delete window.Ajv;mstrmojo.requiresDepLib(mstrmojo.getJsRoot()+"libraries/ajv.min.js");window.Ajv_d6=Ajv;window.Ajv=AD;}}});S=mstrmojo._HasCustomContextMenu.ValidationHelper={customConfig:{validCommonSchema:function(AD){var AE={type:"array",items:[{type:"object",properties:{type:{type:"string",minLength:1},isShown:{type:"boolean"}},required:["type"]}]};return L(AE,AD);},validNormalSchema:function(AD){var AF={type:"object",properties:{name:{type:"string",minLength:1},isDisabled:{type:"boolean"}},required:["name"]},AE=L(AF,AD);if(!AD.isDisabled&&(!AD.onClick||typeof AD.onClick!=="function")){AE=false;U("onClick function is required for "+AD.type+" context menu");}return AE;},validToggleSchema:function(AD){var AF={type:"object",properties:{name:{type:"string",minLength:1},currentValue:{type:"boolean"},propertyName:{type:"string",minLength:1},showFormatPanel:{type:"boolean","default":true}},anyOf:[{required:["name","propertyName"]},{required:["name","currentValue","onClick"]}]},AE=L(AF,AD);if(!AD.propertyName&&typeof AD.onClick!=="function"){AE=false;U("onClick function is required for "+AD.type+" context menu when not bingding with property");}return AE;},validSingleSelectListSchema:function(AD){var AF={type:"object",properties:{currentValue:{type:"string",minLength:1},propertyName:{type:"string",minLength:1},showFormatPanel:{type:"boolean","default":true},items:{type:"array",items:{type:"object",properties:{name:{type:"string",minLength:1},value:{type:"string",minLength:1}},required:["name","value"]},minItems:1,uniqueItems:true}},required:["items"],anyOf:[{required:["propertyName"]},{required:["currentValue","onClick"]}]},AE=L(AF,AD);if(!AD.propertyName&&typeof AD.onClick!=="function"){AE=false;U("onClick function is required for "+AD.type+" context menu when not bingding with property");}return AE;},validMultiSelectListSchema:function(AD){var AE={type:"object",properties:{propertyName:{type:"string",minLength:1},showFormatPanel:{type:"boolean","default":true},items:{type:"array",items:{type:"object",properties:{labelText:{type:"string",minLength:1},propertyName:{type:"string",minLength:1}},required:["labelText","propertyName"]},uniqueItems:true,minItems:1}},required:["items","propertyName"]};return L(AE,AD);},validSubMenuSchema:function(AD){var AF={type:"object",properties:{name:{type:"string",minLength:1},subMenuConfig:{type:"array"}},required:["name"],anyOf:[{required:["subMenuConfig"]},{required:["getSubMenuConfig"]}]},AE=L(AF,AD);if(AD.getSubMenuConfig&&typeof AD.getSubMenuConfig!=="function"){AE=false;U("getSubMenuConfig must be a function for "+AD.type+" context menu");}return AE;},validFormatSchema:function(AD){var AE={type:"object",properties:{name:{type:"string",minLength:1,"default":mstrmojo.desc(1918,"Format")},isShown:{type:"boolean","default":!l.isLibrary()&&!l.isVIPresentationMode()},formatConfig:{type:"array"},showFormatPanelName:{type:"string",minLength:1}},required:["formatConfig"]};return L(AE,AD);}},formatControlConfig:{validCommonSchema:function(AD){var AE={type:"array",items:[{type:"object",properties:{type:{type:"string",minLength:1},isShown:{type:"boolean"},label:{type:"object",properties:{text:{type:"string"},width:{type:"string",minLength:1}},required:["text"]}},required:["type"]}]};return L(AE,AD);},validFillGroupSchema:function(AD){var AE={type:"object",properties:{propertyName:{type:"string",minLength:1},showFillColor:{type:"boolean"},showFillAlpha:{type:"boolean"},showFormatPanel:{type:"boolean","default":true}},required:["propertyName"]};return L(AE,AD);},validLineGroupSchema:function(AD){var AE={type:"object",properties:{propertyName:{type:"string",minLength:1},hideColorControl:{type:"boolean"},showFormatPanel:{type:"boolean","default":true}},required:["propertyName"]};return L(AE,AD);},validCharacterGroupSchema:function(AD){var AE={type:"object",properties:{propertyName:{type:"string",minLength:1},showFormatPanel:{type:"boolean","default":true}},required:["propertyName"]};return L(AE,AD);},validColorByGroupSchema:function(AD){var AE={type:"object",properties:{colorInfo:{type:"array",items:{type:"string",minLength:1},minItems:1},showFormatPanel:{type:"boolean","default":true}},required:["colorInfo"]};return L(AE,AD);}}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.string","mstrmojo.hash","mstrmojo.VisUtility","mstrmojo.gm.GMLegend","mstrmojo.gm.GMUtility","mstrmojo.customviz.CustomVisEnums");var K=mstrmojo.array,F=mstrmojo.dom,N=mstrmojo.hash,H=mstrmojo.gm.GMLegend,O=mstrmojo.gm.GMUtility,I=mstrmojo.customviz.CustomVisEnums,U=I.ENUM_LEGEND_DATA_TYPE,A=I.ENUM_LEGEND_DISPLAY_MODE,J=I.ENUM_LEGEND_DISPLAY_MODE,L=I.ENUM_LEGEND_PROPS,G=I.ENUM_FONT_STYLE;var C=5,M=0.000001,D="clrSqrClr";var B={lgdFntClr:L.LEGEND_FONT_COLOR,lgdFntSz:L.LEGEND_FONT_SIZE,lgdFntFml:L.LEGEND_FONT_FAMILY,lgdFntStyle:[L.LEGEND_FONT_ITALIC,L.LEGEND_FONT_WEIGHT,L.LEGEND_FONT_LINE_THROUGH,L.LEGEND_FONT_UNDERLINE],lgdBgFillClr:L.LEGEND_BG_COLOR,lgdBgFillTrans:L.LEGEND_BG_FILL_TRANSPARENCY};var E={fontItalic:G.FS_ITALIC,fontWeight:G.FS_BOLD,fontUnderline:G.FS_UNDERLINE,fontLineThrough:G.FS_STRIKETHROUGH};function V(W){var X=this.cachedDimension,Z=X&&X.scale,a=X&&X.fixedWidth,Y=W.getLegendProperty(L.LEGEND_WIDTH_SCALE);if(isNaN(Y)){Y=undefined;}if(Y===undefined){return{scale:undefined,fixedWidth:undefined};}if((Z===undefined)||(Math.abs(Z-Y)>=M)){return{scale:Y,fixedWidth:undefined};}return{scale:Z,fixedWidth:a};}function P(Y,W,Z){var X=N.clone(Y.getProperty(I.LEGEND_PROPERTY_SET))||{};if(W){X[W]=Z;}return X;}function R(X,W){if(!X||!W){return ;}X.fontWeight=(W[L.LEGEND_FONT_WEIGHT]?"bold":"normal");X.fontStyle=(W[L.LEGEND_FONT_ITALIC]?"italic":"normal");if(W[L.LEGEND_FONT_LINE_THROUGH]&&W[L.LEGEND_FONT_UNDERLINE]){X.textDecoration="line-through underline";}else{if(W[L.LEGEND_FONT_LINE_THROUGH]){X.textDecoration="line-through";}else{if(W[L.LEGEND_FONT_UNDERLINE]){X.textDecoration="underline";}else{X.textDecoration="none";}}}}function S(){var Y=this.widget,X={},W={};K.forEach([L.LEGEND_FONT_WEIGHT,L.LEGEND_FONT_ITALIC,L.LEGEND_FONT_UNDERLINE,L.LEGEND_FONT_LINE_THROUGH],function(Z){W[Z]=Y.getLegendProperty(Z);});X.backgroundColor=Y.getLegendProperty(L.LEGEND_BG_COLOR);X.opacity=Y.getLegendProperty(L.LEGEND_BG_FILL_TRANSPARENCY)/100;X.fontFamily=Y.getLegendProperty(L.LEGEND_FONT_FAMILY);X.fontSize=Y.getLegendProperty(L.LEGEND_FONT_SIZE);X.color=Y.getLegendProperty(L.LEGEND_FONT_COLOR);R(X,W);return X;}mstrmojo.customviz.CustomVisLegend=mstrmojo.declare(mstrmojo.gm.GMLegend,null,{scriptClass:"mstrmojo.customviz.CustomVisLegend",init:function(X){this._super(X);var W=this.widget.getLegendProperty(L.LEGEND_POSITION);this.currDockedPositionIdx=this.getLegendDockPosIdx(W);this.styles=S.call(this);this.cssClass="gm-legend";this._resetLegendSize();},postBuildRendering:function(){this._super();this._initListeners();this._toggleLegendDisplay(false);},renderLegend:function(){this._updateLegendStyle();this._measureLegendSize();this._updateLegend();},_updateLegendStyle:function(){if(this.canRenderLegend()){this.updateStyle(S.call(this));}},canRenderLegend:function(){return this.widget.canRenderLegend();},_getLegendWidth:function(){var W=this.width+this.padding;if(isNaN(W)){W=0;}return parseInt(W);},_resetLegendSize:function(){this.width=this.height=this.padding=0;},_measureLegendSize:function(){var Y,b=this.widget,X=b.getWidth(),W=b.getHeight(),a,Z;if(!this.canRenderLegend()){this._resetLegendSize();}else{Z=this.styles;H.applyHTML5Props(Z);a=V.call(this,b);Y=H.getLegendSize([{dataType:U.COLOR_BY,dataObj:this.colorByInfo},{dataType:U.SIZE_BY,dataObj:this.sizeByInfo}],a.scale,X,W,Z,a.fixedWidth);this.cutBy=Y.cutBy;if(b.getLegendProperty(L.LEGEND_MODE)===A.MINIMIZED||Y.autoCollapse){Y=H.getLegendSize4MinMode(this.colorByInfo,W);this.cutBy=undefined;}this.width=Y.width;this.height=Y.height;this.padding=C;}},_updateLegend:function(){var W=this.canRenderLegend();this._toggleLegendDisplay(W);if(W&&this.width>0&&this.height>0){var X=this.widget;this.domNode.style.width=this.width+"px";this.domNode.style.height=this.height+"px";this.updateContainerSize(X.getWidth(),X.getHeight());this.feedData([{dataType:U.COLOR_BY,dataObj:this.colorByInfo},{dataType:U.SIZE_BY,dataObj:this.sizeByInfo}],(X.getLegendProperty(L.LEGEND_MODE)===A.MINIMIZED));this.updateAfterResize();}},readGlobalProperty:function(a){var Z=this.widget,X,Y;var W=B[a];if(a===D){X=Z.colorSqureIdentity;if(X){Y={color:X.decodedColor,isDefaultColor:X.isDefaultColor};}else{Y={color:this.defaultGraphicColor,isDefaultColor:true};}}else{if(K.isArray(W)){Y=G.FS_NORMAL;K.forEach(W,function(b){if(Z.getLegendProperty(b)){Y|=E[b];}});}else{Y=Z.getLegendProperty(W);if(W.indexOf("Color")>0){Y=O.encodeColor(Y);}}}return Y;},writeGlobalProperty:function(c,d){var b=this.widget,W=B[c],X=P(b),Z,Y,a;if(c===D){Y=b.colorSqureIdentity;if(Y){b.updateColorMap(Y.comb,d);}return ;}if(K.isArray(W)){K.forEach(W,function(g){var f=X[g],e=(d&E[g])>0;X[g]=e;if(f!==e){Z=g;}});}else{if(W.indexOf("Color")>0){d=O.decodeColor(d);}X[W]=d;Z=W;}a=b._wrapLegendCallbackConfig(I.LEGEND_PROPERTY_SET,Z);b.savePropertyAndUpdateWidget(I.LEGEND_PROPERTY_SET,X,a);},configureLegendPopup:function(W,X){W.hostId=this.widget.id;W.hostElement=X;},_initListeners:function(){var W=this.id;this.resizeListener=this.attachEventListener("gm-legend-resized",W,function(X){this._onLegendResized(X.position);});this.clickListener=this.attachEventListener("gm-legend-clicked",W,function(X){this._onLegendClicked(X);});this.contextMenuHandler=F.attachMarkupEvent(W,this.domNode,"contextmenu");},_unSubscribeListeners:function(){if(this.resizeListener){this.resizeListener.clear();delete this.resizeListener;}if(this.clickListener){this.clickListener.clear();delete this.clickListener;}if(this.contextMenuHandler){F.detachEvent(this.domNode,"contextmenu",this.contextMenuHandler);delete this.contextMenuHandler;}},oncontextmenu:function(W){if(this.widget._isConsumeMode()){F.stopPropogation(window,W);F.preventDefault(window,W);return false;}this.handleRMCOnLegend(W);this.widget.openFormatPanelByProperty(I.LEGEND_PROPERTY_SET);},_onLegendResized:function(a){var Y=this.widget,X=Y.getLegendProperty(L.LEGEND_WIDTH_SCALE)||1,Z=this.width+a,W=(Z)/(this.width/X);this.cachedDimension={scale:W,fixedWidth:Z,resized:true};Y._cacheLegendDimension(this.cachedDimension);Y.savePropertyAndUpdateWidget(I.LEGEND_PROPERTY_SET,P(Y,L.LEGEND_WIDTH_SCALE,W));},_onLegendClicked:function(W){var Y=this.widget,X=W.action,Z={close:{prop:L.SHOW_LEGEND,val:false},minimize:{prop:L.LEGEND_MODE,val:J.MINIMIZED},restore:{prop:L.LEGEND_MODE,val:J.RESTORED}}[X];Y.savePropertyAndUpdateWidget(I.LEGEND_PROPERTY_SET,P(Y,Z.prop,Z.val));},_onLegendDropped:function(W){var Y=this.widget,X={callback:mstrmojo.emptyFn,clientUndoRedoCallback:function(a){var Z=this.legend,c=L.LEGEND_POSITION,b;if(Z){b=a&&a[c];if(b===undefined){b=this.getLegendProperty(c);}else{b=parseInt(b);}Z.updateLegendSlot(b);}}};Y.savePropertyAndUpdateWidget(I.LEGEND_PROPERTY_SET,P(Y,L.LEGEND_POSITION,W),X);},_getLegendPosition:function(){return this.getLegendDockPosByIdx(this.currDockedPositionIdx);},_toggleLegendDisplay:function(W){var X=this.domNode;if(X&&X.style){X.style.display=W?"block":"none";}},unrender:function Q(W){this._unSubscribeListeners();this._super(W);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.array","mstrmojo.hash","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.models.DropZonesModel");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");mstrmojo.requiresDescs(11819,11825,11827,16057,16058,16059,16060,16061,16062,16063,16064,16065,16066,16067,16068,16069,16070,16071,16072,16073,16074,16075,16076,16077,16078,16079,16080,16081,16082,16083,16084,16085,16086,16087,16088,16089,16090,16091,16092,16093,16208,16209);var c=mstrmojo,O=c.array,S=c.hash,G=mstrmojo.dom,V=mstrmojo.string,b=c.vi.viz,M=mstrmojo.vi.models.DropZonesModel.ENUM_REQUIREMENT_TYPE,N=M.ATTRIBUTE,W=M.METRIC,C=b.EnumVisualizationTemplates,R=b.EnumVizStyles,K=R.GRAPH_MATRIX,Z=R.NEW_GRAPH_MATRIX,e=b.EnumWidgetTypes.GRAPH_MATRIX,d=R.MAPBOX,B={},P="custom",U="plugins.";B[R.GOOGLE_MAP]=C.GOOGLEMAP;B[R.HEAT_MAP]=C.HEATMAP;B[R.ESRI_MAP]=C.ESRIMAP;B[R.NETWORK]=C.NETWORK;B[R.IMAGE_LAYOUT]=C.IMAGELAYOUT;var X=["plugins.KPIWidget.KPIWidget","plugins.SmartKPIWidget.SmartKPIWidget"];function H(i,h,l){var j=[],k=function(n,o){var m={t:n,r:o};if(n===W&&l){m.s=true;}j.push(m);};if(i){k(W,i);}if(h){k(N,h);}return j;}var Q=[{n:mstrmojo.desc(11820,"Bar Chart"),id:"BarChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALBARAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALBARAUTOMATIC}},{n:mstrmojo.desc(8121,"Line Chart"),id:"LineChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALLINEAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALLINEAUTOMATIC}},{n:mstrmojo.desc(11821,"Area Chart"),id:"AreaChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALAREAAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALAREAAUTOMATIC}},{n:mstrmojo.desc(11822,"Bubble Chart"),id:"BubbleChart",mr:H(2,1),vt:C.GRAPHMATRIXBUBBLECIRCLEMM},{n:mstrmojo.desc(11823,"Pie Chart"),id:"PieChart",mr:H(1,1),vt:C.GRAPHMATRIXPIE},{n:mstrmojo.desc(11824,"Combo Chart"),id:"ComboChart",mr:H(2,1),vt:C.GRAPHCOMBINATIONBARAREADUALAXIS}];Q.forEach(function(h){h.s=K;h.wtp=e;});var g=[{n:mstrmojo.desc(15130,"Clustered Bar Chart"),id:"ClusteredBarChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALBARCLUSTERED,h:C.GRAPHMATRIXHORIZONTALBARCLUSTERED}},{n:mstrmojo.desc(15129,"Stacked Bar Chart"),id:"BarChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALBARSTACKED,h:C.GRAPHMATRIXHORIZONTALBARSTACKED}},{n:mstrmojo.desc(8121,"Line Chart"),id:"LineChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALLINEAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALLINEAUTOMATIC}},{n:mstrmojo.desc(15233,"Stacked Area Chart"),id:"AreaChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALAREASTACKED,h:C.GRAPHMATRIXHORIZONTALAREASTACKED}},{n:mstrmojo.desc(11822,"Bubble Chart"),id:"BubbleChart",mr:H(2,1),vt:C.GRAPHMATRIXBUBBLECIRCLEMM},{n:mstrmojo.desc(11824,"Combo Chart"),id:"ComboChart",mr:H(2,1),vt:C.GRAPHCOMBINATIONBARAREADUALAXIS},{n:mstrmojo.desc(350,"Histogram"),id:"Histogram",mr:H(1,1,true),vt:C.GRAPHMATRIXVERTICALHISTOGRAM},{n:mstrmojo.desc(15411,"Grid Chart"),id:"GridChart",mr:H(0,0),vt:C.GRAPHMATRIXGRIDCHART},{n:mstrmojo.desc(3156,"Box Plot"),id:"BoxPlot",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALBOXPLOT,h:C.GRAPHMATRIXHORIZONTALBOXPLOT}},{n:mstrmojo.desc(5594,"Waterfall"),id:"Waterfall",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALWATERFALL,h:C.GRAPHMATRIXHORIZONTALWATERFALL}}];g.forEach(function(h){h.cls="ngm";h.s=Z;h.wtp=e;});var L={GridChart:{summary:mstrmojo.desc(16057,"Displays data in a tabular format"),example:mstrmojo.desc(16058,"Example: Create directory with customer information and key performance indicators (KPIs)"),requirements:mstrmojo.desc(16059,"Uses 1+ ##attributes### and/or 1+ #metrics###")},BarChart:{summary:mstrmojo.desc(16060,"Uses length to compare data values across categories"),example:mstrmojo.desc(16061,"Example: Compare profit data of different sales teams"),requirements:mstrmojo.desc(16062,"Uses 1+ ##attributes### and 1+ #metrics###")},ClusteredBarChart:{summary:mstrmojo.desc(16060,"Uses length to compare data values across categories"),example:mstrmojo.desc(16061,"Example: Compare profit data of different sales teams"),requirements:mstrmojo.desc(16062,"Uses 1+ ##attributes### and 1+ #metrics###")},LineChart:{summary:mstrmojo.desc(16065,"Uses a line to show the value of a metric over time"),example:mstrmojo.desc(16066,"Example: Show stock prices over the past decade"),requirements:mstrmojo.desc(16067,"Uses 1+ ##attributes### and 1+ #metrics### (time attribute recommended)")},AreaChart:{summary:mstrmojo.desc(16068,"Uses the area within a line chart to show the value of a metric over time"),example:mstrmojo.desc(16069,"Example: Compare the amount of revenue from different sources over time"),requirements:mstrmojo.desc(16067,"Uses 1+ ##attributes### and 1+ #metrics### (time attribute recommended)")},BubbleChart:{summary:mstrmojo.desc(16070,"Uses position, color and size to show relationships and correlations"),example:mstrmojo.desc(16071,"Example: Compare GDP, population and life expectancy for different countries"),requirements:mstrmojo.desc(16072,"Uses 1+ ##attributes### and 2+ #metrics###")},PieChart:{summary:mstrmojo.desc(16073,"Shows the composition of a total value broken by category"),example:mstrmojo.desc(16074,"Example: Compare the proportions of funding sources for a university"),requirements:mstrmojo.desc(16075,"Uses 1+ ##attributes### and 1 #metric###")},ComboChart:{summary:mstrmojo.desc(16076,"Combines a line and bar chart for comparison of metrics with different units"),example:mstrmojo.desc(16077,"Example: Compare monthly precipitation and temperature in a given region"),requirements:mstrmojo.desc(16078,"Uses 1+ ##attributes### and 2+ #metrics###")},Histogram:{summary:mstrmojo.desc(16087,"Uses length to show the frequency of values within given categories/metric ranges"),example:mstrmojo.desc(16088,"Example: Determine the number of employees that fall within a given salary range"),requirements:mstrmojo.desc(16075,"Uses 1+ ##attributes### and 1 #metric###")},BoxPlot:{summary:mstrmojo.desc(16089,"Uses several data points to visualize means, medians, ranges and outliers"),example:mstrmojo.desc(16090,"Example: Show how customer satisfaction scores vary among different survey questions"),requirements:mstrmojo.desc(16091,"Uses 1+ ##attributes### and 1+ #metrics###")},Waterfall:{summary:mstrmojo.desc(16092,"Uses bars and colors to show how categories increase or decrease a metric value"),example:mstrmojo.desc(16093,"Example: Examine how different spending and income categories impact monthly budgeting"),requirements:mstrmojo.desc(16091,"Uses 1+ ##attributes### and 1+ #metrics###")},VIHeatMapVisualizationStyle:{summary:mstrmojo.desc(16063,"Uses rectangles of varying sizes and colors to show hierarchical data"),example:mstrmojo.desc(16064,"Example: Compare sales from different clothing categories at a retail store"),requirements:mstrmojo.desc(16062,"Uses 1+ ##attributes### and 1+ #metrics###")},MapboxVisualizationStyle:{summary:mstrmojo.desc(16079,"Uses Mapbox to visualize data geographically"),example:mstrmojo.desc(16080,"Example: Use layering and clustering features to visualize frequency of earthquakes around the world"),requirements:mstrmojo.desc(16081,"Uses 1+ ##attributes### (including one geographic) and 1+ #metrics###")},NetworkVisualizationStyle:{summary:mstrmojo.desc(16084,"Uses links and nodes to show relationships between data"),example:mstrmojo.desc(16085,"Example: Create a family tree"),requirements:mstrmojo.desc(16086,"Uses 2+ ##attributes### and 1+ #metrics###")},GoogleMapVisualizationStyle:{summary:mstrmojo.desc(16082,"Uses ESRI maps to visualize data geographically"),example:mstrmojo.desc(16083,"Example: Create a density map of world population"),requirements:mstrmojo.desc(16081,"Uses 1+ ##attributes### (including one geographic) and 1+ #metrics###")},KPICardVisualizationStyle:{summary:mstrmojo.desc(16208,"Provides quick performance indications as a single numeric or with an additional trend indicator"),example:mstrmojo.desc(16209,"Example: View daily unique visitor counts for a website over the last month"),requirements:mstrmojo.desc(16075,"Uses 1+ ##attributes### and 1 #metric###")}};var F={BUILT_IN_LIST:1,CUSTOM_LIST:2};function I(j){var k=[],h=mstrConfig.pluginsVisList||{},i=function(l,n,m){m=m||[];n=isNaN(n)?0:parseInt(n,10);if(n>0){m.push({t:l,r:n});}return m;};Object.keys(h).forEach(function(s){var t=h[s],w=t.s,l=t.d,n=t.c,p=n.indexOf(U)!==-1?F.CUSTOM_LIST:F.BUILT_IN_LIST;if(!(j&p)){return ;}if(w===K){t.st.forEach(function(y){var x=O.find(Q,"id",y);if(x>=0){k.push(Q[x]);}});return ;}if(w===Z){if(mstrApp.supportFeature("ngm")){var m=mstrApp.supportFeature("ngmPartial");t.st.forEach(function(y){var x=O.find(g,"id",y);if(x>=0){if(m){if(y==="Waterfall"||y==="Histogram"||y==="BoxPlot"){k.push(g[x]);}}else{k.push(g[x]);}}});}return ;}if(w===d&&!mstrApp.supportFeature("mbx")){return ;}if(w==="VisBuilderNew"&&!mstrApp.isVisBuilder){return ;}if(X.indexOf(n)>=0){return ;}var q=t.desc;if(q){l=mstrmojo.desc(q,"");}var o;if(w===R.KPICARD){o=H(t.mm,t.ma,true);}else{o=i(N,t.ma,i(W,t.mm));}var u={n:l,s:w,mr:o,id:w,dz:t.dz,vt:B[w],wtp:t.wtp,isNS:t.isNS,pn:t.pn||null};if(t.summary&&t.example&&t.requirements){S.copyProps(["summary","example","requirements"],t,u);}k.push(u);});O.forEach(k,function(l){if(l.id in L){S.copyProps(["summary","example","requirements"],L[l.id],l);}});return k;}function J(h){return I(F.BUILT_IN_LIST+F.CUSTOM_LIST).filter(function(i){return i.s===h;}).map(function(i){return{s:i.s,vt:i.vt||-1};})[0];}function A(h,i){window.FormWrapper.doVisRemove(h,i);}mstrmojo.vi.ui.VizGalleryList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.VizGalleryList",init:function Y(h){this._super(h);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIGalleryList");this.items=(this.items||[]).concat(I(this.type));},items:null,useRichTooltip:true,itemMarkup:null,type:F.BUILT_IN_LIST,getItemMarkup:function E(h){if(!this.itemMarkup){this.itemMarkup=this._super(h).replace(">{@en@n}<",'><div><div><div class="unsafe-icn"></div></div></div><');}return this.itemMarkup;},getItemProps:function f(j,h){var i=this._super(j,h);i.addCls("ic-"+j.id);if(j.isNS){i.addCls("nonsafe");}if(this.type===F.CUSTOM_LIST){i.addCls(P);}return i;},select:function(k,h){if(!k){return ;}k=O.ensureArray(k);var m=this._removeAll(),o=this._addSelections(k),l;if(this.selectionPolicy!=="reselect"){for(l=m.length-1;l>=0;l--){var n=O.indexOf(o,m[l]);if(n>-1){m.splice(l,1);o.splice(n,1);}}}var j={name:"selectionChange",added:o,removed:m};if(h){if(this.onselectionChange){this.onselectionChange(j);}}else{this.raiseEvent(j);}},showTooltip:function D(t,m){var i=G.eventTarget(m,t);if(i.className.indexOf("unsafe-ic")===-1){return ;}G.stopPropogation(null,t);var o=G.findAncestorByAttr(i,"idx",true,this.domNode),k=o&&o.node,q=k&&k.className.indexOf(P)>-1,w=this.parent,p=q?w&&w.customVizList:w&&w.vizList,u=o&&p&&p.items[o.value],h=u&&u.n;if(!h||h===""){return ;}var l=G.position(k),s=mstrmojo.desc(15365,"Visualizations that use it may display as a grid when this dossier is opened in a context where these plugins are not available."),j=mstrmojo.desc(15364,"## plugin is only available on your local machine.").replace("##",h),n='<div class="name">'+j+'</div><div class="dsc">'+s+"</div>";this.richTooltip={posType:mstrmojo.tooltip.POS_TOPRIGHT,cssClass:"viGallery-tooltip vi-warning nsicn-tooltip vi-regular vi-tooltip-D",content:n,top:l.y-12,left:l.x-7,keepArrowYPos:true};this._super(t,m);},onItemContextMenu:function a(i,h){var j;if(i.pn&&!(mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode())){this.hideTooltip();j=new mstrmojo.ui.menus.MenuConfig({position:mstrmojo.dom.getMousePosition(h.e,h.hWin),isHostedWithin:false});j.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){A(i.id,i.pn);});this.openPopup(j.newInstance());}}});mstrmojo.vi.ui.VizGalleryList.getVizList=I;mstrmojo.vi.ui.VizGalleryList.getVisType=J;mstrmojo.vi.ui.VizGalleryList.VIZ_LIST_TYPE=F;}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Widget","mstrmojo.Label","mstrmojo.Box","mstrmojo.desc","mstrmojo.css","mstrmojo.hash","mstrmojo.dom","mstrmojo.array","mstrmojo.expr","mstrmojo.models.FormatModel","mstrmojo.ui._HasScroller","mstrmojo._HasPopup","mstrmojo.vi.ui.ConditionEditor","mstrmojo.threshold.ThresholdRow","mstrmojo.threshold.ConditionWalk","mstrmojo.threshold.PropertyPanel","mstrmojo.threshold.PropertyModel","mstrmojo.threshold.ThresholdRowPanel","mstrmojo.mstr.EnumNodeProperties","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes");var B=mstrmojo.css,P=mstrmojo.hash,O=mstrmojo.dom,E=mstrmojo.mstr.EnumNodeProperties,Z=mstrmojo.mstr.EnumDSSXMLObjectTypes,s=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,N=mstrmojo.expr,a=N.ET,h=N.BRANCH_FNS,d=mstrmojo.Button.newWebButton,m=mstrmojo.models.FormatModel.getFormatUpdate,i=600,L="";var Y=mstrmojo.models.FormatModel.ENUM_NUMBER_FORMAT_KEYS_OBJ,o=[Y.CATEGORY,Y.CURRENCY_POSITION,Y.CURRENCY_SYMBOL,Y.DECIMAL_PLACES,Y.FORMAT,Y.NEGATIVE_NUMBERS,Y.THOUSAND_SEPARATOR],W=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,x=[W.BORDER_TOP_STYLE,W.BORDER_RIGHT_STYLE,W.BORDER_BOTTOM_STYLE,W.BORDER_LEFT_STYLE],n={0:"none",1:"1pt solid",3:"1pt dashed",4:"1pt dotted",5:"1.5pt solid"};function k(y,AA){var z=[];if(AA){AA.forEach(function(AC){var AD=AC.fmt,AB={FormattingAppearance:{Visible:-1}};if(!!AD){AD.nth=AD.nth?-1:0;if(!!AD.bc&&!!AD.bc.c1){delete AD.gdc;delete AD.gda;}}P.forEach(AD,function(AE,AF){var AG=false;if(o.indexOf(AF)>-1){m(AF,AE,AB);}else{if(x.indexOf(AF)===-1){m(AF,AE,AB);}else{if(!AD.borderStyle&&!AG){m(W.BORDER_STYLE,n[AE],AB);}}}});y.setAttIdToNDE(AC.expr);z.push({n:AC.n,scope:AC.scope,rtp:AC.rtp,rtxt:AC.rtxt,expr:mstrmojo.fe.FilterUtils.getExprXml(AC.expr),fmt:AB});});}return z;}function q(AC){var z=this.controller,AA=this.model,AB=AA.thresholds,AD=this.metricId,AF=AB&&AB[AD],AE=AA.orgThresholds,y=AE&&AE[AD];z.onSubmitActions(k(AA,AF),y,AD,undefined,-1,AC,this.objectType);}function G(y){(y||[]).forEach(function(z){delete z.dmy;var AA=z.nds;if(AA){G(AA);}});}function c(){var AB=this.content,y=this.model,AF=y.thresholds,AA=this,AC=[],AE=AB.rowPanel,AD=AF&&AF[y.metricId],z=0;if(AD){AD.forEach(function(AG){G(AG.expr.nds);AC.push({scriptClass:"mstrmojo.threshold.ThresholdRow",threshold:AG,editor:AA,model:y,idx:z++});});}AE.destroyChildren(false);AE.addChildren(AC);this.updateScrollbars();}function l(){var AD=this.content.rowPanel,AB=AD.children,z=(AB&&AB.length)||0,AA=this.model,AE=AA.thresholds,AC=AE&&AE[AA.metricId],y={expr:{et:14,fn:19}},AF={et:a.AE};if(!AE){AE=AA.thresholds={};}if(!AC){AC=AE[AA.metricId]=[];}AC.push(y);AD.addChildren([{scriptClass:"mstrmojo.threshold.ThresholdRow",threshold:y,editor:this,model:AA,idx:z}]);if(this.disableElementsBrowsing&&this.disableElementsBrowsing()){AF.et=a.AQ;}AD.children[z].exprTree.newCondition(AF);this.updateScrollbars();}function u(z){var y=this.model,AB=y.thresholds,AA=AB&&AB[y.metricId];if(AA){AA.forEach(function(AC){y.toggleThresholdSelected(AC,z);});}}function J(AC,AD){var y=this.controller,z=this.model,AA=this.metricId,AB=z.selectedThresholds;if(AB.length>0){y.onSaveThresholds(k(z,AB),AA,-1,AC,AD);}}function M(z){var AB="mstrIVE_THRESHOLD_SAVER",y=z.controller.dataService.model,AA=mstrmojo.all[AB];if(!AA){AA=new mstrmojo.SaveAsEditor({id:AB,zIndex:z.zIndex+1,folderLinksContextId:32,rootFolderID:y.isnew?null:y.pfid,showCompletePath:false,saveParams:{},typeDesc:mstrmojo.desc(3647,"Thresholds"),saveAs:function(AE){var AC=this.contPanel;this.name=AC.name.value;this.desc=AC.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var AF=this.saveParams||{};AF.folderId=this.ob.currentFolder.did;AF.name=this.name||"New Thresholds";AF.saveAsOverwrite=!!AE;var AD=this.saveAsCallback();AD.failure=function(AH){var AG=AH.code,AI=this.parent;if(AG==="-2147217373"||AG==="-2147216857"){mstrmojo.warn(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",AI.typeDesc||"Object").replace("###",AI.name),{confirmBtn:{fn:function(){AI.saveAs(true);}}},{title:mstrmojo.desc(3179,"Confirm Overwrite"),zIndex:AI&&AI.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+AH.message);}};AD.parent=this;J.call(z,AF,AD);}});AA.render();}AA.open();}function g(AA){var AF="mstrIVE_THRESHOLD_LOADER",AD=mstrmojo.all[AF],z=AA.controller.dataService.model,AE=[72];if(!AD){AD=new mstrmojo.vi.ui.editors.ObjectPicker({id:AF,supportedTypes:mstrmojo.array.hash(AE),zIndex:AA.zIndex+1,rootFolderID:z.isnew?null:z.pfid,onOpen:function y(){this.browse();},postBuildRendering:function AC(){mstrmojo.Editor.prototype.postBuildRendering.apply(this);},OKFn:function(AG){if(AG){AA.controller.onLoadThresholds(AA.metricId,AG.did);}}});var AB=AD.ob;AB.set("folderLinksContextId",32);AB.set("multiSelect",false);AB.set("searchVisible",true);AB.set("upButtonVisible",true);AB.set("browsableTypes","8,"+AE.join(","));AD.render();}AD.open();}function S(z){if(!z){return ;}if(z.t===Z.Consolidation&&z.st===s.ConsolidationManaged){var y=mstrApp&&mstrApp.rootCtrl&&mstrApp.rootCtrl.docCtrl&&mstrApp.rootCtrl.docCtrl.model;if(y&&y.findUnitInDataSet){z=y.findUnitInDataSet(z.did);if(z&&z.attId){z=y.findUnitInDataSet(z.attId);}}}return z.t===Z.Attribute&&z.st===s.AttributeRecursive;}function F(z){var AA=P.clone(z);if(!(AA.node&E.CONDITION)&&S(AA.a)){AA={et:a.ANDOR,fn:mstrmojo.expr.FN.AND,node:E.CONDITION,nds:[AA]};}if(AA&&AA.et===a.ANDOR&&(AA.node&E.CONDITION)){var AB=P.valarray(N.findTargets(AA,"did"))[0],y={et:a.ANDOR,data:AA};switch(AB&&AB.t){case Z.Attribute:case Z.Consolidation:y.a=AB;break;case Z.Metric:y.m=AB;break;}return y;}return AA;}mstrmojo.threshold.AdvancedThresholdEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui._HasScroller,mstrmojo._HasPopup],{scriptClass:"mstrmojo.threshold.AdvancedThresholdEditor",cssClass:"adv-threshold",title:"Advanced Threshold Editor",help:"Advanced_Thresholds_Editor.htm",model:undefined,targets:undefined,content:undefined,buttonBar:undefined,init:function p(y){this._super(y);L=this.id;},postBuildRendering:function R(){this._super();var y=this.content;c.call(this);y.conditionWalk.set("editor",this);y.property.set("editor",this);},onOpen:function U(){c.call(this);this.setRowPanelVisibility(true);var y=this.content;y.conditionWalk.set("visible",false);y.property.set("visible",false);y.set("editorNode",this.editorNode);var z=this.buttonBar&&this.buttonBar.quickLink;if(!!z){z.set("visible",this.objectType!==12);}},setupScrollNodes:function j(){this.scrollNode=this.content.containerNode;},onClose:function b(){this.model.cleanUp();},onmodelChange:function A(){var y=this.model;if(y){y.attachEventListener("modelEdit",this.id,"onmodelEdit");y.attachEventListener("selectedThresholdsChange",this.id,"onselectedThresholdsChange");c.call(this);}},onselectedThresholdsChange:function I(){},openConditionWalk:function D(AE,AD){var AB=this,AC=AB.content,z=AD.tree.parent,y=P.clone(z.threshold),AA=O.position(AB.titleNode);y.expr=AE;var AF=new mstrmojo.threshold.ThresholdRow({alias:"thresholdRow",slot:"conditionNode",idx:z.idx,model:this.model,threshold:y,onclick:mstrmojo.emptyFn});AF.render();B.toggleClass(AB.content.domNode,"no-overflow",true);AB.openPopup("conditionEditorPopupRef",{editor:AB,objectBrowsingEnabled:AB.objectBrowsingEnabled,showLimits:true,targets:AB.targets,targetsLastMod:new Date(),ets:AD.tree.validExprTypes,condition:AD,hasPrompt:false,model:F(AE),left:parseInt(AA.x+(AA.w-i)/2,10)+"px",top:parseInt(AA.y+AA.h,10)+"px",zIndex:AB.zIndex+1,title:AD.isEmpty()?mstrmojo.desc(5893,"New Condition"):mstrmojo.desc(14916,"Edit Condition"),disableHierarchyLevel:true});},onmodelEdit:function V(){c.call(this);},openPropertyPanel:function H(y){this.setRowPanelVisibility(false);var AA=this.content.property,z=AA.model=new mstrmojo.threshold.PropertyModel({thresholdRow:y,threshold:P.clone(y.threshold),gridValueFormat:P.clone(this.model.getGridValueFormat())});this.disposables.push(z);z.attachEventListener("propertyModelChange",y.id,"onpropertyModelChange");AA.set("visible",true);this.toggleButtonStatus(false);this.updateScrollbars();},getDatasets:function f(){if(this.model){return this.model.controller.datasets;}return null;},getIfDataSource:function X(){if(this.model){return this.model.controller.dataService;}return null;},onUpdateBrowseElementsParams:mstrmojo.emptyFn,onConditionEdit:function K(AA,z){var y=this;y.model.setConditionData(AA,z);y.setRowPanelVisibility(true);y.toggleButtonStatus(true);y.updateScrollbars();},conditionEditorPopupRef:{scriptClass:"mstrmojo.vi.ui.ConditionEditor",isHostedWithin:false,getIfDataSource:function X(){return this.editor.getIfDataSource();},getDatasets:function f(){return this.editor.getDatasets();},onUpdateBrowseElementsParams:function w(y){this.editor.onUpdateBrowseElementsParams(y);}},openAndORPopup:function t(AB,y){var z=new mstrmojo.ui.menus.MenuConfig();z.hostId=this.id;z.hostElement=y;z.isHostedWithin=false;z.menuCssClass="andor-PopupList";var AA=function AA(AH){var AC=AB,AG=AH.ctxt.did,AF=AG>21?true:null,AE=AG-(AF?21:0);var AD=AC&&AC.parent;if(AD&&AD.data&&AD.data.et===a.ANDOR){AD.edit(AC,AE,AF);}else{var AI=AC&&AC.data;if(AI&&(AI.not!==AF)){AI.not=AF;AC.paint();}}};z.addMenuItem(h[19],"",AA,{did:19});z.addMenuItem(h[20],"",AA,{did:20});z.addMenuItem(h["19_21"],"",AA,{did:19+21});z.addMenuItem(h["20_21"],"",AA,{did:20+21});this.openPopup(z.newInstance());},toggleButtonStatus:function C(y){this.buttonBar.children.forEach(function(z){z.set("enabled",y);});},setRowPanelVisibility:function Q(z){var y=this.content;y.rowPanel.set("visible",z);y.newCondition.set("visible",z);this.updateScrollbars();},children:[{scriptClass:"mstrmojo.Widget",alias:"rulesTitles",markupString:"<div class='rulesTitles'><div class='container'></div><div class='order'>"+mstrmojo.desc(3095,"Order")+"</div><div class='condition'>"+mstrmojo.desc(11890,"Threshold Conditions")+"</div><div class='format'>"+mstrmojo.desc(11891,"Format Preview")+"</div></div>"},{scriptClass:"mstrmojo.Box",cssClass:"content",alias:"content",editorNode:undefined,markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="scroll-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},rowPanel:undefined,newCondition:undefined,conditionWalk:undefined,property:undefined,children:[{scriptClass:"mstrmojo.threshold.ThresholdRowPanel",alias:"rowPanel",children:[]},{scriptClass:"mstrmojo.Label",alias:"newCondition",cssClass:"link",text:mstrmojo.desc(4585,"New Threshold"),onclick:function e(){l.call(mstrmojo.all[L]);}},{scriptClass:"mstrmojo.threshold.ConditionWalk",alias:"conditionWalk",height:"300px",width:"750px",visible:false},{scriptClass:"mstrmojo.threshold.PropertyPanel",alias:"property",visible:false}]},{alias:"buttonBar",scriptClass:"mstrmojo.Box",slot:"buttonNode",children:[d(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.all[L].close();},false,{enabled:true,alias:"cancelBtn"}),d(mstrmojo.desc(1442,"OK"),function(){q.call(mstrmojo.all[L],false);mstrmojo.all[L].close();},true),d(mstrmojo.desc(2031,"Apply"),function(){q.call(mstrmojo.all[L],true);},true),{scriptClass:"mstrmojo.Label",cssClass:"link",alias:"quickLink",text:mstrmojo.desc(14004,"Quick Thresholds Editor..."),onclick:function e(){var AA=mstrmojo.all[L],z=AA.model,y=AA.controller,AC=z.isAdvanced(z.metricId),AD=function(){AA.close();z.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.SIMPLE_EDITOR;},AB=[d(AC?mstrmojo.desc(1442,"OK"):mstrmojo.desc(2827,"Clear"),function(){AD();y.openEditor();},AC,AC?undefined:{cssClass:"nosave"})];if(!AC){AB.push(d(mstrmojo.desc(2031,"Apply"),function(){AD();q.call(AA,true);},true));}AB.push(d(mstrmojo.desc(2223,"Cancel")));mstrmojo.warn(AC?mstrmojo.desc(13998,"This action will clear the thresholds definition. Do you want to proceed?"):mstrmojo.desc(13999,"Do you want to apply your thresholds before using the Quick Thresholds Editor?"),undefined,{cssClass:AC?undefined:"save-threshold-warning",buttons:AB});}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.expr","mstrmojo.Box","mstrmojo.Button","mstrmojo.Editor","mstrmojo.Dial","mstrmojo.Label","mstrmojo.fe.CreateSetEditor","mstrmojo.fe.FilterEditor","mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.vi.ui.ConditionWalk","mstrmojo.vi.ui.ConditionEditor","mstrmojo.vi.ui.editors.fe.ConditionWalk","mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree","mstrmojo.warehouse.EnumObjectTypes");mstrmojo.requiresDescs(118,2397,5758,14915,15540,15005,15014,15091);var c=mstrmojo.hash,W=mstrmojo.array,g=mstrmojo.css,L=mstrmojo.dom,a=mstrmojo.expr,i=mstrmojo.mstr.EnumDSSXMLObjectTypes,S={TEMPLATE:0,DATASET:1},O=a.ET,Y=a.BRANCH_FNS,B=mstrmojo.warehouse.EnumObjectTypes,K=mstrmojo.mstr.EnumNodeProperties,I="VFEmpty";var G=10,U=46,H=116,P=286,R=369,F=42;DL_LABEL_HEIGHT=26;function h(k){var j={et:k.defaultExpressionType};if(k.disableElementsBrowsing&&k.disableElementsBrowsing()){j={et:O.AQ};}k.mainExpr.newCondition(j,true);}function N(j){var k=G;if(j<G){k=G;}else{if(j<=U){k=U;}else{k=H;}}return k;}function A(o,AA){var w=o&&o.domNode,t=AA&&AA.domNode,k=w&&w.style,u=t&&t.style;var m=o.parent.domNode.offsetHeight;if(!AA){k.height=m+"px";if(o.updateScrollbars){o.updateScrollbars();}return ;}if(w&&t){var s=R-P;if(!o.editor.showLimits){s-=F+DL_LABEL_HEIGHT;}var j=m-s;var l=L.position(o.itemsContainerNode),p=L.position(AA.itemsContainerNode),y=l.h,z=p.h;var n=N(z),x=j-n;var q=Math.min(G+y,x);k.height=q+"px";u.height=j-q+"px";if(o.updateScrollbars){o.updateScrollbars();}if(AA.updateScrollbars){AA.updateScrollbars();}}}function D(k){var l=c.clone(k);if(k&&k.et===O.ANDOR&&(k.node&K.CONDITION)){var m=c.valarray(a.findTargets(k,"did"))[0],j={et:O.ANDOR,data:l};switch(m&&m.t){case i.Attribute:j.a=m;break;case i.Metric:j.m=m;break;}return j;}return l;}mstrmojo.vi.ui.editors.FilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditor,null,{scriptClass:"mstrmojo.vi.ui.editors.FilterEditor",titleMarkupString:'<div class="mstrmojo-Editor-title-container"><div class="mstrmojo-Editor-title"></div><div class="edt-title-btn mstrmojo-Editor-help" tooltip="'+mstrmojo.desc(1143,"help")+'"></div><div class="edt-title-btn mstrmojo-Editor-close" tooltip="'+mstrmojo.desc(2102,"Close")+'"></div></div><div class="mstrmojo-Editor-subtitle-container"></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:c.copy({subTitleNode:function X(){return this.showTitle?this.domNode.firstChild.children[1]:null;},containerNode:function e(){return this.domNode.firstChild.childNodes[3];},buttonNode:function J(){return this.domNode.firstChild.childNodes[4];},curtainNode:function E(){return this.domNode.lastChild;}},c.copy(mstrmojo.fe.FilterEditor.prototype.markupSlots)),help:"view_filter_editor_for_dossiers.htm",cssClass:"mstrmojo-charcoalboxe mstrmojo-FE mstrmojo-vi-ui-FE",postCreate:function C(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Box",slot:"subTitleNode",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14915,"New Qualification"),cssDisplay:"inline-block",cssClass:"mstrmojo-relation-relateby-text",bindings:{text:function(){return this.editor.isNewCond?mstrmojo.desc(14915,"New Qualification"):mstrmojo.desc(15540,"Edit Qualification");},editor:"this.parent.parent",visible:function(){return !!this.editor.showCondWalk;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"newQualificationBtn",cssText:"float: left",cssDisplay:"inline-block",text:mstrmojo.desc(15005,"Add New Qualification"),onclick:function(){h(this.editor);},bindings:{enabled:function(){return !this.editor.readOnly;},visible:function(){return !this.editor.showCondWalk;},editor:"this.parent.parent"}}]}]);if(this._super){this._super();}},editorTitle:mstrmojo.desc(5758,"Filter Editor"),defaultExpressionType:O.AE,disableElementsBrowsing:function Z(j){return !(!j||(j.did&&j.n));},onvizTitleChange:function(){this.set("title",this.editorTitle+" - "+this.vizTitle);},getExpressionContainerCfg:function(){var j=this._super();j.cssDisplay="flex";return j;},onOpen:function M(){var j=this.mainExpr,k=this.limitExpr;if(j){A(j,k);}if(!this.model.expr){h(this);}},getExpressionContentsConfig:function(){return[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15091,"Metric values are not aggregated."),cssClass:"mstrmojo-FE-expr-header dl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"ve",scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree",level:S.DATASET,bindings:{items:"this.editor.model.exprForest || []"},onBlankClick:function(o){this.parent.clearSelect(o);},supportRelation:true,postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);},onNew:function(p){p.data.isNew=true;if(!p.data.ph){this.editor.openWalk(p.data,p.widget.ctxtBuilder.itemWidgets[p.index],"condition");}var o=this.parent.vle;A(this,o);},onadd:function j(){g.toggleClass(this.parent.domNode,I,this.items.length===0);var o=this.parent.vle;A(this,o);},onremove:function l(){g.toggleClass(this.parent.domNode,I,this.items.length===0);var o=this.parent.vle;A(this,o);},onnodeadd:function k(){var o=this.tree.parent.vle;A(this.tree,o);},onnoderemove:function n(){var o=this.tree.parent.vle;A(this.tree,o);},onitemsChange:function m(){var p=this.items.length===0,o=this.parent;if(this.hasRendered){g.toggleClass(o.domNode,I,p);}else{if(p){g.addWidgetCssClass(o,I);}else{g.removeWidgetCssClass(o,I);}}}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15014,"Metric values are aggregated based on the attributes in the visualization."),cssClass:"mstrmojo-FE-expr-header tl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"vle",scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree",level:S.TEMPLATE,validExprTypes:W.hash([O.MQ,O.MC]),bindings:{visible:"this.editor.showLimits",items:"this.editor.model.limitExprForest || []"},onBlankClick:function(o){this.parent.clearSelect(o);},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("limitExpr",this);},onnodeadd:function k(){var o=this.tree.parent.ve;A(o,this.tree);},onnoderemove:function n(){var o=this.tree.parent.ve;A(o,this.tree);},onadd:function j(){var o=this.parent.ve;A(o,this);},onremove:function l(){var o=this.parent.ve;A(o,this);}}];},getConditionWalkConfig:function d(){return undefined;},toggleOkButtonStatus:function V(j){var k=this.buttonBar.children[0].btnSave;k.set("enabled",!!j);},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-FE-andOrPopup mstrmojo-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",slot:"containerNode",modal:false,autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var j=this.condition,m=j&&j.data&&j.data.not,n=j&&j.parent,k=n&&n.data,l=(k&&k.fn)+(m?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(l)?null:{did:l});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",animate:false,itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",renderOnScroll:false,items:[{did:19,n:Y[19]},{did:20,n:Y[20]},{did:19+21,n:Y["19_21"]},{did:20+21,n:Y["20_21"]}],onchange:function(){if(this.opening){return ;}var k=this.parent,j=k.condition,p=this.selectedItem,o=p&&p.did,n=o>21?true:null,m=o-(n?21:0);k.close();var l=j&&j.parent;if(l&&l.data&&l.data.et===O.ANDOR){l.edit(j,m,n);}else{var q=j&&j.data;if(q&&(q.not!==n)){q.not=n;j.paint();}}}}]},createSetPopupRef:{scriptClass:"mstrmojo.fe.CreateSetEditor",contentNodeCssClass:"",cssClass:"VI-CreateSet-Editor",slot:"containerNode",autoClose:true,showTitle:false,isHostedWithin:false},conditionEditorPopupRef:{scriptClass:"mstrmojo.vi.ui.ConditionEditor",isHostedWithin:false,getIfDataSource:function f(){return this.editor.getIfDataSource();},getDatasets:function Q(){return this.editor.getDatasets();},onUpdateBrowseElementsParams:function b(j){this.editor.onUpdateBrowseElementsParams(j);}},docModel:null,targetMetrics:null,_set_model:function(m,k){var l=this._super(m,k);if(l){var j=this.model.targets;this.targetMetrics=W.filter(j,function(n){n.title=n.n||"";return n.t===i.Metric;});}return l;},openWalk:function(o,p,u,w){var s=this,k=L.delta(p.domNode,s.containerNode);k.y+=(u==="andor"?16:parseInt(p.domNode.offsetHeight,10));var t={condition:p,zIndex:s.zIndex+10,left:k.x+"px",top:k.y+"px"},j;switch(u){case"andor":if(s.skipAndOrPopup){return ;}j="andOrPopupRef";break;case"createSet":case"createSetOpt":if(mstrApp&&mstrApp.isWSStyling&&w&&w.e&&w.e.target){var l=w&&w.e&&w.e.target,m=L.delta(l,s.containerNode);t.left=m.x+"px";t.top=m.y+parseInt(l.offsetHeight,10)+"px";}var q=s.model.targets;j="createSetPopupRef";t.type=u;t.model={attrs:W.filter(q,function(n){return n.t===B.ATTRIBUTE;}),metrics:W.filter(q,function(n){return n.t===B.METRIC;})};if(u==="createSetOpt"){t.condition=p.parent;t.model.childIdx=p.childIndex();}break;case"condition":var x=L.position(this.titleNode);t=c.copy({editor:s,objectBrowsingEnabled:s.objectBrowsingEnabled,showLimits:s.showLimits,targets:s.model.targets,targetsLastMod:s.modelLastSet,ets:p.tree.validExprTypes||s.validExprTypes,condition:p,hasPrompt:s.model.hasPrompt,disableElementsBrowsing:s.disableElementsBrowsing,inRelation:p.inRelation,model:D(o),left:x.x+50+"px",top:x.y+20+"px",draggable:!s.conditionEditorNotDraggable},t);if(!!o.isNew){t.title=mstrmojo.desc(14915,"New Qualification");}else{t.title=mstrmojo.desc(15540,"Edit Qualification");}j="conditionEditorPopupRef";}s.openPopup(j,t);},getIfDataSource:function f(){if(this.docModel){return this.docModel.getDataService();}return null;},onUpdateBrowseElementsParams:mstrmojo.emptyFn,getDatasets:function Q(){if(this.docModel){return this.docModel.datasets;}return null;},conditionEditorNotDraggable:false});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.func","mstrmojo.hash","mstrmojo.array","mstrmojo.ToolSeparator","mstrmojo.CheckBox","mstrmojo.Label","mstrmojo.Dialog","mstrmojo.Button","mstrmojo.fe._HasFilterEditor","mstrmojo.fe.FilterUtils","mstrmojo.vi.ui.editors.SQLCSIViewer","mstrmojo.ui.menus.MenuConfig","mstrmojo.vi.models.VIComponentMap","mstrmojo.vi.ui.VizBoxTitleBar","mstrmojo.vi.ui.ViewDataDialog","mstrmojo.vi.ui.VisAsFilterInlineDialog","mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.vi.ui.editors.VisAsFilterDialog","mstrmojo.vi.ui.editors.FilterEditor","mstrmojo.vi.ui.VizGalleryList","mstrmojo.EnumRWUnitType","mstrmojo.vi.viz.KnownVisualizations","mstrmojo.vi.viz.EnumWidgetTypes","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.enums.EnumFilterClearActionType","mstrmojo.DynamicClassFactory","mstrmojo._IsAccessibleMenu");mstrmojo.requiresDescs(2827,5282,6985,9126,11671,11672,13402,13528,14389,14810,15076,15123,15621);var AX=mstrmojo.css,AB=mstrmojo.dom,d=mstrmojo.func,P=mstrmojo.hash,K=mstrmojo.array,AH=mstrmojo.EnumRWUnitType,AU=mstrmojo.vi.viz.KnownVisualizations,AV=mstrmojo.fe.FilterUtils.isExprEmpty,U=mstrmojo.fe.FilterUtils.getExprText,AR=mstrmojo.vi.models.EnumDragSources,AT=mstrmojo.DocDataService.EnumTreesToRender,w="px",AO=0,AW=2,M=mstrmojo.vi.models.VIComponentMap.TYPES,F=mstrmojo.vi.enums.EnumFilterClearActionType;var b=mstrmojo;var s="invalid",l="hasViewFilter",Ag="hasSelector",x="visible",W="mouse-left",Ad="",AS="element",AD="recursive",N=0;var AZ=3,AA=4;var u="web-export-to-pdf-privilege",AL="web-export-to-excel-privilege",R="web-export-to-csv-privilege";var k=4;function O(Ah){mstrApp.onerror(Ah);}function g(Aj){var Ai=this.model,Am=this,An=mstrApp.isWSStyling,Ah=[{n:mstrmojo.desc(11670,"Copy to"),toLayoutTitle:mstrmojo.desc(13933,"Copy to #"),toNewLayoutTitle:mstrmojo.desc(16418,"Copy to a New Chapter"),crossLayoutMessage:mstrmojo.desc(12137,"Copying will clear all filters from the new visualization. Do you want to continue?"),cls:"",fn:function Al(Ao,Aq,Ar,Ap){Ai.copyVisualization(Ao,Aq,Ar,Ap);}},{n:mstrmojo.desc(10461,"Move to"),toLayoutTitle:mstrmojo.desc(13935,"Move to #"),toNewLayoutTitle:mstrmojo.desc(16417,"Move to a New Chapter"),crossLayoutMessage:mstrmojo.desc(13937,"Moving will clear all filters from the new visualization. Do you want to continue?"),cls:"",fn:function Al(Ao,Ar,As,Aq){var Ap=Ai.getVizContentPanel();Ap.restoreAnyMaxedVizBox();Ai.moveVisualization(Ao,Ar,As,Aq);}}],Ak=function Ak(Aq,Ap,Ao){return function(){mstrmojo.warn(Ap,{confirmBtn:{fn:Ao}},{title:Aq});};};Ah.forEach(function(Ao){Aj.addPopupMenuItem(Ao.n,null,function(){var Au=Ao.fn,Aq=new mstrmojo.ui.menus.MenuConfig(),Ar=Am.boxContent.builder.getLayoutVIMap(Ai.getCurrentLayoutKey()).getComponent(M.VIZ_CONTENT),Ap=Ai.getCurrentLayoutKey(),As=Ar.panels.filter(function(Av){return Av.k!==Ar.selectedKey;}),At=Ai.defn.layouts.filter(function(Av){return Av.k!==Ap;});As.forEach(function(Av){var Aw=Av.k;Aq.addMenuItem(Av.titleText,"",function(){Au(Am,Ar,Aw,Ap);});});Aq.addMenuItem(An?mstrmojo.desc(6985,"New Page"):mstrmojo.desc(11671,"New Panel"),"",function(){Au(Am,Ar,null,Ap);});Aq.addSeparator();At.forEach(function(Av){Aq.addMenuItem(Av.title,"",Ak(Ao.toLayoutTitle.replace("#",Av.title),Ao.crossLayoutMessage,function(){Au(Am,Ar,null,Av.k);}));});Aq.addMenuItem(An?mstrmojo.desc(14810,"New Chapter"):mstrmojo.desc(11672,"New Sheet"),"",Ak(Ao.toNewLayoutTitle,Ao.crossLayoutMessage,function(){Au(Am,Ar,null,null);}));return Aq;},Ao.cls);});}function H(){AX.toggleClass(this.domNode,Ag,!!(this.selectorMenuCfg));AX.toggleClass(this.domNode,l,!!(this.filterMenuCfg));AX.toggleClass(this.filterBtnNode,s,!(this.filterMenuCfg));AX.toggleClass(this.selectorBtnNode,s,!(this.selectorMenuCfg));var Ai=this.parent,Ah=!!(Ai&&Ai.hasMultipleChildren&&Ai.hasMultipleChildren()&&!mstrApp.isAppStateSelection());AX.toggleClass(this.maxRestoreBtnNode,s,!Ah);AX.toggleClass(this.maxRestoreBtnNode,"restore",this.isMaxed);}function j(Ah){AX.toggleClass(this.filterBtnNode,x,Ah);AX.toggleClass(this.filterBtnNode,W,!Ah);AX.toggleClass(this.selectorBtnNode,x,Ah);AX.toggleClass(this.selectorBtnNode,W,!Ah);AX.toggleClass(this.maxRestoreBtnNode,x,Ah);AX.toggleClass(this.maxRestoreBtnNode,W,!Ah);}function e(Ah){return{scriptClass:"mstrmojo.vi.ui.VisAsFilterInlineDialog",vis:Ah,tocPanel:mstrApp.rootCtrl.view.tocPanel,shouldNavigate:true};}function Q(){this.selectorMenuCfg=null;if(mstrApp.isAppStateSelection()){return ;}var Ap=this,Al=Ap.model,Aq=this.boxContent,Aj=Aq.model,Am,Ah=function(Ar,As){return Aq[Ar]&&Aq[Ar](As);},Ao=Aq.selectorControl||Ah("findSelectorControl"),Ai=Ah("isLinkedFilter"),Ak=function(){mstrApp.rootCtrl.view.openInlineDialog(e(Ap));},An=function(){var Av={},Au=Ah("getAssociatedNodes")||[],Aw=Aq.getFilterType(),At=Aq.isVisMap,As=Ah("getAllLayerKeys",true),Ar=Aj.getSelectorControlMapInfo&&Aj.getSelectorControlMapInfo();K.forEach(Au,function(Ax){if(At){K.forEach(As,function(Ay){Av[Ay]={c:true,v:false,ft:Aw,cgbs:Ar,k:Ay};});}else{Av[Ax.k]={c:true,v:false,ft:Aw,cgbs:Ar,k:Ax.k};}});Al.setVisAsFilter(Ap,{sc:Ao,targetKeys:Av});};if(Ai&&!mstrApp.isAppStatePresentation()){Am=this.addDisposable(new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstrmojo-viz-fe-menu",isHostedWithin:false,useTooltip:true}));Am.addMenuItem(mstrmojo.desc(15069,"Edit Targets..."),"",Ak);Am.addMenuItem(mstrmojo.desc(11473,"Clear All Targets"),"",An);}this.selectorMenuCfg=Am;}function A(){this.filterMenuCfg=null;if(mstrApp.isInVFInteractMode||mstrApp.isAppStateSelection()){return ;}var BB=mstrmojo.desc(2827,"Clear"),Ax=this.boxContent,Aq=false,A9=Ax.model,A1=this.k,BI=this.model.hasMDXRADataset(),Az=this,BL=Ax.controller,A6=Ax.node,BO=A6.data||null,A2=function(BQ,BT,BS){var BR=Az.boxContent;return BR&&BR[BQ]&&BR[BQ](BT,BS);},BD=mstrmojo.desc(5283,"OR"),Aw=mstrmojo.desc(5282,"AND"),BP=A2("makeBold",BD),A3=A2("makeBold",Aw);if(!BO){this.filterMenuCfg=null;return ;}var BG=BO.vfexpr,An,Ap=BO.vlexpr,Av=A2("getSelectorObjectsFromTemplateLimit"),A0,At=A2("hasKeepOnly",Av),Ai=this.model,As,Ah;An=Ai.getVfNdFromExpr(BG);As=!AV(An);Ah=An!==BG;var Al=this.model,Au=Al.getCurrentLayoutKey(),A5=(Al.defn.layouts).filter(function(BQ){return BQ.k===Au;})[0],BM=A5.cgbMap||{},BC=P.keyarray(BM).filter(function(BQ){return BM[BQ]===Az.k;}),BF,Aj,BH=["mstrmojo-viz-fe-menu"],BJ,BK,Am,A7=[],A4,Ar;function Ao(BS){var BU=" "+(BS?BP:BD)+" ",BT=" "+(BS?A3:Aw)+" ",BR=Aj.fn===20?BU:Aj.fn===19?BT:"",BQ=[BB+' "'];BK=A9.getSelectorDataFromViewFilter(Aj);K.forEach(BK,function(BV){Am=BV.isBranch;Ar=A2("getLinkingSelectorExpr",BV,BS);if(BQ.length>1){Ar=BR+Ar;}BQ.push(Ar);});BQ.push('"');return BQ.join("");}if(BC.length){K.forEach(BC,function(BQ){BF=Al.getLayoutUnitDefn(BQ);Aj=BF&&BF.t&&BF.t===AH.UNITCONTAINER&&BF.exp;if(Aj){BJ=BF.latestctlkey;if((K.filterOne(A5.units[BQ].scs,function(BR){return BR.ckey===BJ;})||{}).isNavigation){A7.push({menuString:Ao(),menuTtpString:Ao(true),ucKey:BQ,ckey:BJ,isBranch:Am});}}});}A4=A7.length;if(At||Ap||As||A4||Ah){var BA=function BA(BQ){var BS=d.wrapMethods(BL._getXtabCallback(Ax),{success:function BR(){var BT=Az.boxContent;if(BT){BT.raiseEvent({name:"regenerateToolbar"});}}});if(A4){BS=d.wrapMethods({success:function BR(BU){var BV=Az.boxContent,BT=BC;if(BV.getSdpKeyArr){BT=BC.concat(BV.getSdpKeyArr());}Al.partialUpdate(BU.data,Al.getUnitDefinitions(BT),BU.defn,BC,BU.puFilters);}},BS);}if(Ax.filterMenuHandler){Ax.filterMenuHandler(BQ.ctxt,BS);}};A0=this.addDisposable(new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstrmojo-viz-fe-menu",isHostedWithin:false,useTooltip:true}));if(!mstrApp.isDossier&&(At||A4||Ah)){A0.addMenuItem(mstrmojo.desc(1763,"Clear All"),"",BA,{type:F.CLEAR_ALL});}if(At){if(A0.hasMenuItems()){A0.addSeparator();}var Ay=A2("getFilterMenuPairs",Av)||[];K.forEach(Ay,function(BQ){if(!BQ.isBranch){Aq=true;}A0.addMenuItem({n:BQ.menuString,ttp:BQ.menuTtpString},BQ.isBranch?Ad:AS,BA,{type:F.CLEAR_KEEP_ONLY,idx:BQ.ctxt});});}if(Ah){if(A0.hasMenuItems()){A0.addSeparator();}A0.addMenuItem({n:mstrmojo.desc(15076,"Clear drill conditions"),ttp:U(Ai.getVfexprWithUpdatedVf(A1,null),true)},"",BA,{type:F.CLEAR_DRILLING});}if(As||Ap){if(A0.hasMenuItems()){A0.addSeparator();}var BE;var A8=[];var BN=U(An,true),Ak=U(Ap,true);if(BN){A8.push(BN);}if(Ak){A8.push(Ak);}A8=A8.join(" "+A3+" ");if(mstrApp.isWSStyling&&mstrApp.isAppStateDefault()){BE={n:mstrmojo.desc(14016,"Advanced Qualification")};A0.addMenuItem(BE,"",function(){Az.onShowFilterEditor(Az);});}else{if(!(mstrApp.isDossier||(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()))){BE={n:mstrApp.isWSStyling?mstrmojo.desc(15123,"Clear advanced qualification"):mstrmojo.desc(13528,"Clear existing filter"),ttp:A8||BO.vftext};A0.addMenuItem(BE,"",BA,{type:F.CLEAR_ADV_QUALIFICATION});}}}if(A4){A0.addSeparator();K.forEach(A7,function(BQ){if(!BQ.isBranch){Aq=true;}A0.addMenuItem({n:BQ.menuString,ttp:BQ.menuTtpString},BQ.isBranch?Ad:AS,BA,{type:F.CLEAR_LINKING,nodeKey:BQ.ucKey,ckey:BQ.ckey});});}}if(A0&&BI&&Aq){A0.menuCssClass=BH.concat(AD).join(" ");}this.filterMenuCfg=A0&&(A0.hasMenuItems()?A0:null);}function Ab(Ah){var Ai=mstrApp.isWorkstation&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode();return(Ah===AU.GRID&&!Ai&&(!!mstrApp.features[AL]||!!mstrApp.isSingleTier));}function X(Ah){return([AU.UNKNOWN].indexOf(Ah)===-1&&(!!mstrApp.features[u]||!!mstrApp.isSingleTier));}function L(){return !!mstrApp.features[R]||!!mstrApp.isSingleTier;}function AK(){var Ah=AU.getDefinition(this.boxContent.model.data.visName||"Grid").id;return !(mstrApp&&mstrApp.isVisBuilder)&&(Ab(Ah)||X(Ah)||L());}function Ac(Ah){var Ak=this.model.controller.id,Aj=this.boxContent,Ai=Aj.k;var Al=!P.walk("gridInfo.cols.length",Aj)&&!P.walk("gridInfo.rows.length",Aj),Am=mstrmojo.desc(246,"Export");if(Al){Ah.addNonInteractiveMenuItem(Am,null,true);}else{Ah.addPopupMenuItem(Am,this.id,function(){var Ao=new mstrmojo.ui.menus.MenuConfig(),An=AU.getDefinition(this.boxContent.model.data.visName||"Grid").id;if(Ab(An)){Ao.addMenuItem(mstrmojo.desc(3958,"Excel"),"exportToExcel",function(){mstrmojo.all[Ak].exportVisualization(Aj,AA);});}if(X(An)){Ao.addMenuItem(mstrmojo.desc(1877,"PDF"),"exportToPDF",function(){if(Aj.isClientExport&&Aj.exportVisualization){Aj.exportVisualization(AZ);}else{mstrmojo.all[Ak].exportVisualization(Aj,AZ);}});}if(L()){Ao.addMenuItem(mstrmojo.desc(11807,"Data"),"exportToCSV",function(){mstrmojo.all[Ak].exportCSV(Ai);});}return Ao;},"export");}}function i(Ai){var Aj=this.boxContent,Ah=(Aj.getDocModel&&Aj.getDocModel())||Aj.model.docModel;Ai.addPopupMenuItem(mstrmojo.desc(13165,"Change Visualization"),this.id,function(){var Am=new b.ui.menus.MenuConfig({supportsScroll:true,maxHeight:AB.windowDim().h-50}),An=Ah.getVizOfSelectedViUnit(),Ak=Aj.controller.galleryPanel,Ao=Ak.vizList,Ap=Ao.items.length>0,Aq=Ak.customVizList;function Al(Ar,As){if(Ar.id!=="VisGrid"&&b.ExpressVisList.getVis(Ar.s)===null){return ;}Am.addMenuItem(Ar.n,Ar.id===(An&&An.id)?"on":"",function(){var At=K.find(As.items,"id",Ar.id);As.select([At]);});}Am.hasToggleItem=true;if(Ap){Am.addMenuTitle(mstrmojo.desc(14119,"Built-in"));Ao.items.forEach(function(Ar){Al(Ar,Ao);});}if(Aq.items.length>0){if(Ap){Am.addSeparator();}Am.addMenuTitle(mstrmojo.desc(2056,"Custom"));Aq.items.forEach(function(Ar){Al(Ar,Aq);});}return Am;},"");}function AM(Ah,Aj){var Ai=Ah.getCtxtDragData();this.getZonesModel().addUnitsFromDataSource(Ai.items,Ai.dsid,Ah.actions,Aj?Ah.callback:null);}function Aa(){var Aj=this.parent,Ah=this.boxContent,Ai=false;if(Ah.handlesMultiSelection){if(mstrApp.isWSStyling){if(this.getDocModel().getVisibleUnitKeysByType([AH.GRID,AH.GRAPH,AH.MOJOVISUALIZATION]).length>1){Ai=true;}}else{if(Aj&&Aj.getTargetKeysByType([AH.GRID,AH.GRAPH,AH.MOJOVISUALIZATION]).length>1){Ai=true;}}}return Ai;}function AN(Ai,Ah,Al){var Am=this.id;Ai=document.createElement("div");Ai.className=Ah;var Aj=function(){var Ar=mstrmojo.all[Am],Ao=Ar[Al];Ao.hostId=Am;Ao.hostElement=Ai;Ao.hasAccessibility=Ar.boxContent.hasAccessibility;var Ap=mstrmojo.ui.menus.Menu;if(Ao.hasAccessibility){Ap=mstrmojo.DynamicClassFactory.newComponent(Ap,[mstrmojo._IsAccessibleMenu]);Ar.boxContent.isMenuClicked=true;}if(Ao.hasMenuItems()){var As=new Ap({popupConfig:Ao,getTooltipText:function An(At){return(At&&At.ttp)||"";}});As.tooltipCss={enableHover:true,leftCssClass:"menuTooltip mstrmojo-VIBox",rightCssClass:"menuTooltip mstrmojo-VIBox",updatePosition:function Aq(){mstrmojo.Tooltip.prototype.updatePosition.call(this);var A1=this.domNode,Ay=this.arrowNode,Az=A1.getBoundingClientRect(),At=Az.top,Av=Math.max(document.documentElement.clientHeight,window.innerHeight||0),A0=As._getItemNode(As._lastHoverIx),Ax=(A0&&A0.getBoundingClientRect())||{},Au=Az.top+this.containerNode.offsetHeight,Aw=Au+10-Av;if(Aw>0){A1.style.top=(At=Az.top-Aw)+"px";}if(Ax&&Ax.top){Ay.style.top=Ax.top-At+6+"px";}}};if(Ao.hasAccessibility){As.onCloseMenuCallBack=Ar.onMenuClose;}Ar.openPopup(As);}};var Ak=function(){var An=window.event,Ap=mstrmojo.dom.findWidget(this),Ao=Ap.boxContent.hasAccessibility;if(Ao&&An.keyCode===13){Aj();}};AB.attachEvent(Ai,"click",Aj);AB.attachEvent(Ai,"keydown",Ak);if(this.menuBtnInfo.btn){this.domNode.insertBefore(Ai,this.menuBtnInfo.btn);}else{this.domNode.appendChild(Ai);}this.installedEvtListeners.push({e:Ai,evt:"click",fn:Aj});this.installedEvtListeners.push({e:Ai,evt:"keydown",fn:Ak});return Ai;}function n(Ah){var Al=this.id;Ah=document.createElement("div");Ah.className="hover-max-restore-btn";Ah.setAttribute("tabindex","0");Ah.setAttribute("role","button");var Ak="Max-Restore for "+this.title;Ah.setAttribute("aria-label",Ak);var Ai=function(){var Am=mstrmojo.all[Al],An=Am.isMaxed;Am.parent.setPortalState(Am,An?AO:AW);if(An){delete Am.isMaxed;}else{Am.isMaxed=true;}AX.toggleClass(Ah,"restore",Am.isMaxed);};var Aj=function(){var Am=window.event,Ao=mstrmojo.dom.findWidget(this),An=Ao.boxContent.hasAccessibility;if(An&&Am.keyCode===13){Ai();}};AB.attachEvent(Ah,"click",Ai);AB.attachEvent(Ah,"keydown",Aj);if(this.menuBtnInfo.btn){this.domNode.insertBefore(Ah,this.menuBtnInfo.btn);}else{this.domNode.appendChild(Ah);}this.installedEvtListeners.push({e:Ah,evt:"click",fn:Ai});this.installedEvtListeners.push({e:Ah,evt:"keydown",fn:Aj});return Ah;}mstrmojo.vi.ui.rw.VizBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,[mstrmojo.vi.ui._CanDropFromSchema,mstrmojo.fe._HasFilterEditor],{scriptClass:"mstrmojo.vi.ui.rw.VizBox",filterEditorScriptClass:"mstrmojo.vi.ui.editors.FilterEditor",showTitleBar:true,titleBar:null,selectorMenuCfg:null,selectorBtnNode:null,filterMenuCfg:null,filterBtnNode:null,maxRestoreBtnNode:null,generateToolbarSub:null,init:function AE(Ah){this._super(Ah);AX.addWidgetCssClass(this,"mstrmojo-VIBox");this.isMaxed=(this.defn.ds===AW);this.installedEvtListeners=[];},unrender:function(Ah){K.forEach(this.installedEvtListeners,function(Ai){AB.detachEvent(Ai.e,Ai.evt,Ai.fn);});this.installedEvtListeners=[];delete this.filterBtnNode;delete this.selectorBtnNode;delete this.maxRestoreBtnNode;this._super(Ah);},getPanelForAddAction:function AQ(){return"editPanel";},getExcludedPanels:function AY(){return[];},getDocModel:function E(){var Ah=this.model;return Ah.docModel||Ah;},editingTitleCallback:function C(Ah){this._super(Ah);AX.toggleClass(this.filterBtnNode,"editing-title",Ah);AX.toggleClass(this.selectorBtnNode,"editing-title",Ah);AX.toggleClass(this.maxRestoreBtnNode,"editing-title",Ah);},getTitleBarCfg:function y(){var Ah=this._super();Ah.scriptClass="mstrmojo.vi.ui.VizBoxTitleBar";Ah.close=function Ak(){var Am=this.parent,Al=Am.parent;Al.deleteBoxAndSubmit(Am);Al.removeChildren(Am);Am.destroy();};Ah.beganEditingTitlebar=function Aj(){var Al=this.parent;Al.draggable=false;Al.editingTitleCallback(true);};Ah.titleEdited=function Ai(Am,Aq,Al){var Ap=this.parent;Ap.draggable=true;if(Aq){var Ao=Ap.getDocModel();Ao.renameRWUnitTitle(Am,this.title,Ap.k,{success:function Ar(As){Ap.defn.ttl=As;Ap.set("title",As);},failure:function An(As){O(As);Ap.titleBar.set("title",Al);}});}Ap.editingTitleCallback(false);};return Ah;},getTitleVisibilityFmts:function S(Ai){var Ah=this._super(Ai);Ah.FormattingView.ShowWidgetTitleBar=Ai;return Ah;},onclick:function z(Ah){if(Ah.e.pointerType){return ;}this.model.setVizBoxActive(this.id);this.titleBar.onclick();},switchPropertyOnClick:function AF(Ah){var Ai=this.boxContent;if(!Ai||!Ai.supportsEditorClickSwitching||Ah.e.justSwitched){return false;}return this._super();},postBuildRendering:function Ae(){try{this._super();var Ak="Filter for "+this.title,Ai=this.domNode;this.selectorBtnNode=AN.call(this,this.selectorBtnNode,"hover-selector-btn","selectorMenuCfg");var Al=this.filterBtnNode=AN.call(this,this.filterBtnNode,"hover-filter-btn","filterMenuCfg");Al.setAttribute("tabindex","0");Al.setAttribute("role","button");Al.setAttribute("aria-label",Ak);if(this.defn.ds===AW){this.parent.setPortalState(this,AW,true);}this.maxRestoreBtnNode=n.call(this,this.maxRestoreBtnNode);H.call(this);if(this.menuBtnInfo&&this.menuBtnInfo.btn){AB.attachEvent(this.menuBtnInfo.btn,"mousedown",function(){this.generateToolbar();}.bind(this));}var Aj=this;this.getDocModel().attachEventListener("vizBoxActive",Aj.id,function(Ao){j.call(Aj,Aj.id===Ao.id);var Aq=Aj.menuBtnInfo,Ap=Aj.dragIcon;if(Aq&&Aq.menuCfg){AX.toggleClass(Aq.btn,x,Aj.id===Ao.id);AX.toggleClass(Aq.btn,W,Aj.id!==Ao.id);}if(Ap&&!this.showTitleBar&&!mstrApp.isAppStatePresentation()){AX.toggleClass(Ap,x,Aj.id===Ao.id);AX.toggleClass(Ap,W,Aj.id!==Ao.id);}if(Aj.id===Ao.id){Aj.selectVIUnit();}});this.getDocModel().attachEventListener("visActive",Aj.id,function(Ao){if(Aj.boxContent&&Aj.boxContent.id===Ao.id){this.model.setVizBoxActive(Aj.id);}});if(mstrApp.isDossier&&(this.boxContent.getVisType&&this.boxContent.getVisType().vt===N)){AB.attachEvent(Ai,"focusin",this.onfocusin);AB.attachEvent(Ai,"focusout",this.onfocusout);this.installedEvtListeners.push({e:Ai,evt:"focusin",fn:this.onfocusin});this.installedEvtListeners.push({e:Ai,evt:"focusout",fn:this.onfocusout});}}catch(Am){var An=this.domNode.appendChild(document.createElement("div"));An.className="errorNode";An.innerText=mstrmojo.desc(11461,"There was an error rendering your visualization");this.getZonesModel=function Ah(){return null;};}},doLayout:function t(){var Ah=this.boxContent;if(Ah){Ah.skipReRender=true;}this._super();if(Ah){delete Ah.skipReRender;}},applyBoxSize:function V(Ah,Aj,An,Am){this._super(Ah,Aj,An,Am);var Al=this.boxContent,Ai=Al&&Al.getFormats();if(Ai){var Ak=this.titleBar.visible?AB.position(this.titlebarNode).h:0;Ai.height=(parseInt(Ah,10)-Ak)+w;Ai.width=Aj;}},updateDisplayName:function p(Ah,Ai){this._super(Ah,Ai,true);},createDeleteUpdate:function h(){var Al=this.model,Ao=Al.getDataService().newUpdate(),An=this.boxContent.node.k,Am=this.parent._tgtSelections,Ak=Al.getSourceFilterKeys(An,true),Ai=Ak.concat(Al.getTargetFilterKeys(this)),Aj=[],Ah;this.parent.children.forEach(function(Aq){var Ap=Aq.defn,Ar=Ap.tks;if(Ar){if((Ar||"").split("\u001E").indexOf(An)>-1){Ao.addActions(Al.getDataService().getRemoveCtrlTargetAction(Ap.ck,An,undefined,true));if(Aq.defn&&Aq.defn.srct&&Aq.defn.srct===k){Ao.setTreesToRender(AT.BOTH);}}}});if(Am){Am.remove(An);}if(Ai.length>0){Ao.setTreesToRender(AT.BOTH);}else{Ao.setTreesToRender(AT.DEFN);}Ao.addUpdate(Al.getRemoveUnitUpdate({unit:this,partialRetrievalKeys:Ai,clearTargets:true}));K.forEach(Ak,function(Ap){Ap=Al.getHostKeyByNodeKey(Ap);Ah=Al.getVisualizationByKey(Ap);if(Ah){Aj.push(Ah);}});Ao.addUpdate(Al.associatedNodesUpdate(Aj.concat(this.parent.children)));return Ao;},generateToolbar:function B(){var Am=this.parent,Ai=Am&&Am.parent;if(Ai){var Ah=this.model.controller,Ak=this.model.getLayoutKeyByUnitKey(Ai.k),Aj=Ah.view.getLayoutByKey(Ak),Al=Ah.view.layoutViewer;if(Aj){if(Aj.k===Al.k){if(this.generateToolbarSub){Aj.detachEventListener(this.generateToolbarSub);delete this.generateToolbarSub;}}else{if(!this.generateToolbarSub){this.generateToolbarSub=Aj.attachEventListener("generateVizBoxToolbar",this.id,"generateToolbar");}return ;}}}Q.call(this);A.call(this);if(this.hasRendered){H.call(this);}this._super();},updateToolbar:function Z(Ao){var Aq=this,At=this.boxContent,Ak=this.canShowDesignMenuItems(),Ar=At&&At.excludeData,Am=function(){if(!mstrApp.isDossier&&!mstrApp.isInVFConfigMode&&!Ar){Ao.addMenuItem(mstrmojo.desc(11476,"Show Data"),"shwd",function(){mstrmojo.vi.ui.ViewDataDialog.open(mstrmojo.all[Aq.id]);});}},Aj=mstrApp.isAppStatePresentation(),Ap=mstrApp.isLayoutModePreview(),As=mstrApp.isWSStyling,Al=As?mstrmojo.desc(15087,"Select Targets..."):mstrmojo.desc(11958,"Use as Filter..."),An=this.boxContent&&this.boxContent.hideUseAsFilterMenuItem;Ao.supportsScroll=true;Ao.isHostedWithin=false;Ao.maxHeight=AB.getMaxScrollHeight();if(!Aj&&mstrApp.allowWebDashboardDesign()){var Ai=this.model.hasMDXRADataset();i.call(this,Ao);if(At.getContainerMenuItems){At.getContainerMenuItems(Ao);}Ao.addSeparator();var Ah=At.zonesModel;if(Ah&&Ah.canSwapAxis()){Ao.addMenuItem(mstrmojo.desc(11658,"Swap"),"",function(){Ah.swapAxis();});Ao.addSeparator();}if(Ah&&Ah.canDefineSubtotals()){Ao.addToggleMenuItem(mstrmojo.desc(6193,"Show Totals"),"",function(){Ah.showQuickSubtotals();},function(){Ah.hideDefinedSubtotals();},null,Ah.hasVisibleSubtotals());Ao.addSeparator();}if(mstrApp.supportAdvFilter&&!mstrApp.isInVFInteractMode&&!Ai){Ao.addMenuItem(mstrmojo.desc(13402,"Edit Filter..."),"",function(){Aq.onShowFilterEditor(Aq);});}if(!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode){if(Aa.call(this)&&!An){Ao.addMenuItem(Al,"uaf",function(){var Av=mstrmojo.all[Aq.id],Au=Aq.model&&Aq.model.getVizContentPanel();if(Au){Au.restoreAnyMaxedVizBox();}mstrApp.rootCtrl.view.openInlineDialog(e(Av));});Ao.addSeparator();}}if(!Ar){Ao.addMenuItem(mstrmojo.desc(15621,"Query Details..."),"",function(){var Av=mstrmojo.all.sqlViewer,Aw=Aq.boxContent&&Aq.boxContent.model&&Aq.boxContent.model.data,Au=Aw&&Aw.csi;if(!Av){Av=mstrmojo.insert({id:"sqlViewer",title:mstrmojo.desc(15619,"Query Details"),scriptClass:"mstrmojo.vi.ui.editors.SQLCSIViewer"});}Av.set("csiText",Au||"");Av.open();});}Am();if(!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode){Ao.addMenuItem(mstrmojo.desc(14389,"Remove Data"),"",function(){Aq.vizRemoveDataHandler(At);});}Ao.addPopupMenuItem(mstrmojo.desc(12949,"Data Source"),this.id,function(){var Ay=new mstrmojo.ui.menus.MenuConfig(),Aw=Aq.model,Ax=Aw.datasets,Av=Aq.boxContent.model.data.datasetId||"",Au=[];P.forEach(Ax,function(Az,A0){Au.push({name:Az.name,id:A0});});if(!Ai){Au.push({name:mstrmojo.desc(5949,"None"),id:""});}Au.forEach(function(Az){var A0=Az.id;Ay.addMenuItem(Az.name,Av===A0?"on":"",function(){var A1=Aq.k,A2=A0;if(Av===A0){return ;}At.zonesModel.submitActionForDatasetUpdate({act:"editNode",nodeKey:A1,treeType:Aq.defn.tt,datasetId:A2||"00000000000000000000000000000000",partialRetrieval:{nodes:[A1]}});});});Ay.hasToggleItem=true;return Ay;});Ao.addSeparator();if(AK.call(this)&&!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode&&!Ar){Ac.call(this,Ao);}if(!Ap&&Ak&&!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode&&!mstrApp.isVisBuilder){Ao.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"dup",function(){var Au=Aq.model&&Aq.model.getVizContentPanel();if(Au){Au.restoreAnyMaxedVizBox();}Aq.model.duplicateVisualization(Aq);});g.call(this,Ao);}Ao.addSeparator();if(!mstrApp.isInVFConfigMode){this.addToggleTitleMenuItem(Ao);if(At.addToggleToolbarMenuItem){At.addToggleToolbarMenuItem(Ao);}}}else{Am();if(AK.call(this)&&!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode){Ac.call(this,Ao);}}this._super(Ao);if(!Aj&&mstrApp.allowWebDashboardDesign()&&!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode){Ao.addSeparator();Ao.addMenuItem(mstrmojo.desc(9126,"More Options...")+"...","",function(){var Au=Aq.getEditorModel(),Av=Au.getHost().model,Ax=Av&&Av.data,Aw=(Ax&&Ax.gsi&&Ax.gsi.prop)||{};if(At instanceof mstrmojo.vi.ui.rw.Xtab){Au.openMoreOptionsEditor(Aw,true,Ax.lhv);}else{Au.openMoreOptionsEditor(Aw);}});}return Ao;},vizRemoveDataHandler:function Y(Ah){if(Ah.isVisMap){Ah.reset();}else{var Ai=Ah&&Ah.zonesModel;if(Ai&&Ai.docModel){Ai.clearAllDropZones(Ai.docModel.clearVisAsFilterAction(this));}}},addFormatMenuItem:function G(Al,Ak,Ah){var Aj=this.getEditorModel(),Ai=Aj.getFormatToTargetFn&&Aj.getFormatToTargetFn();if(Ai){Ah=Ah?d.composite([Ah,Ai]):Ai;}return this._super(Al,Ak,Ah);},getFormatMenuItemTarget:function f(Aj){var Ah=this.boxContent;if(Ah.getFormatMenuItemTarget){var Ai=Ah.getFormatMenuItemTarget(Aj);if(Ai!==undefined){return Ai;}}return this._super(Aj);},getZonesModel:function AP(){return this.boxContent.zonesModel;},allowDropFromDataset:function AJ(Ah){var Ai=this.boxContent;if(Ai&&Ai.allowBoxDropFromDataset){return Ai.allowBoxDropFromDataset(Ah);}return true;},dropFromDataset:function o(Ah){AM.call(this,Ah,false);},dropFromAllObjects:function a(Ah){this.augmentDropContextForSchema(Ah,this.getZonesModel().docModel);AM.call(this,Ah,true);},isDragValid:function q(Ah){var Ai=this.boxContent;if(Ai.canOnlyDragOnTitleBar){if(!AB.contains(this.titleBar.getLabelNode(),Ah.src.node,true,this.domNode)){return false;}}return this._super(Ah)&&!this.isMaxed;},menuDisplayCallback:function I(Ah){this._super(Ah);j.call(this,Ah);},getAvatarCls:function AI(){return this._super().concat(["viz-avi"]);},ondragenter:function D(Ai){var Aj=this.boxContent,Ah=Ai.getCtxtDragData().src;if(Aj.handleDndForParentNode&&Aj.ondragenter){if(Ah===AR.DATASETS||Ah===AR.VIZ_EDITOR||Ah===AR.VIZ||Ah===AR.ALL_OBJECT_LIST){Aj.ondragenter(Ai);return ;}}this._super(Ai);},ondragleave:function m(Ai){var Aj=this.boxContent,Ah=Ai.getCtxtDragData().src;if(Aj.handleDndForParentNode&&Aj.ondragleave){if(Ah===AR.DATASETS||Ah===AR.VIZ_EDITOR||Ah===AR.VIZ||Ah===AR.ALL_OBJECT_LIST){Aj.ondragleave(Ai);return ;}}this._super(Ai);},setTitleBarVisibility:function c(Ah){this._super(Ah);this.titleBar.onclick();},onmouseenter:function AG(Ah){this._super(Ah);j.call(this,true);},onmouseleave:function Af(Ah){this._super(Ah);j.call(this,false);},validateTarget:function AC(){return true;},getNodeKeys:function J(){var Ai=this.boxContent,Ah=Ai&&Ai.isVisMap;return(Ah&&Ai.getNodeKeys)?Ai.getNodeKeys():[this.k];}});mstrmojo.vi.ui.rw.VizBox.ENUM_PORTAL_STATE={RESTORE:AO,MAXIMIZE:AW};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.threshold.ThresholdModel","mstrmojo.threshold.SimpleThresholdEditor","mstrmojo.threshold.AdvancedThresholdEditor","mstrmojo.mstr.EnumDSSXMLObjectTypes");var $HASH=mstrmojo.hash,SIMPLE_THRESHOLD_ID="mstrmojo-simple-threshold-editor",ADVANCED_THRESHOLD_ID="mstrmojo-advanced-threshold-editor",EDITOR_TYPES=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES,ENUM_OBJECT_TYPE=mstrmojo.mstr.EnumDSSXMLObjectTypes;mstrmojo.threshold.ThresholdController=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.ThresholdController",metricId:undefined,data:undefined,model:undefined,targets:undefined,editor:undefined,messageId:undefined,datasets:undefined,dataService:undefined,onSubmitActions:mstrmojo.emptyFn(),onSaveThresholds:mstrmojo.emptyFn(),onLoadThresholds:mstrmojo.emptyFn(),supportsFeature:function supportsFeature(featureId){return true;},init:function init(props){this._super(props);if(!window.numeral){var numeral=mstrmojo.loadFileSync(mstrmojo.getJsRoot()+"libraries/numeral.js.2.0.6/numeral.min.js");function evalInContext(){eval(numeral);}try{evalInContext.call(window);}catch(e){}}this.model=new mstrmojo.threshold.ThresholdModel({controller:this});},openEditor:function openEditor(){var data=this.data;if(!data){throw new Error("Visualization data not provided.");}var metricId=this.metricId,objectType=this.objectType,model=this.model,messageId=this.messageId,editor;model.set("data",$HASH.clone(data));model.metricId=metricId;model.objectType=objectType;var isAdvanced=model.isAdvanced(metricId),forceOpenEditorType=model.editorMode,forceOpenSimpleEditor=forceOpenEditorType===EDITOR_TYPES.SIMPLE_EDITOR,referenceMetricId=model.basedOnId||model.metricId;if(objectType===ENUM_OBJECT_TYPE.Metric&&!isAdvanced&&!model.isMetricAvailable(referenceMetricId)){model.thresholdMetricNotAvailable(model.basedOnName);return ;}if(forceOpenEditorType===EDITOR_TYPES.ADVANCED_EDITOR||(!forceOpenSimpleEditor&&isAdvanced)){editor=mstrmojo.all[ADVANCED_THRESHOLD_ID]||new mstrmojo.threshold.AdvancedThresholdEditor({id:ADVANCED_THRESHOLD_ID,onUpdateBrowseElementsParams:function onUpdateBrowseElementsParams(params){var datasetId,datasets=this.controller.datasets,findAttrFn=function(attribute){return attribute.did===params.attributeID;};for(datasetId in datasets){if(datasets[datasetId].att.filter(findAttrFn).length>0){params.datasetID=datasetId;break;}}params.messageID=messageId;params.templateNodeKey=data.k;}});}else{if(isAdvanced){model.clearData();}editor=mstrmojo.all[SIMPLE_THRESHOLD_ID]||new mstrmojo.threshold.SimpleThresholdEditor({id:SIMPLE_THRESHOLD_ID});}this.editor=editor;editor.set("model",model);editor.set("controller",this);editor.set("metricId",metricId);editor.set("objectType",objectType);editor.set("title",this.title);editor.set("targets",this.targets);editor.open();this.addDisposable([model,editor]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.VisBase","mstrmojo.Widget","mstrmojo.VisUtility","mstrmojo.VisEnum","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.ui.rw._XtabDE","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo._VizSelectionHelper","mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl","mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights","mstrmojo.Button","mstrmojo.models.template.DataInterface","mstrmojo.string","mstrmojo.dom","mstrmojo.array","mstrmojo.DocDataService","mstrmojo.hash","mstrmojo.gm.GMUtility","mstrmojo.func","mstrmojo.util.color","mstrmojo._colorPalette","mstrmojo.CustomVisUtility","mstrmojo.vi.ui.rw.GhostImageContainer","mstrmojo.ui.menus._HasMenuPopup","mstrmojo._HasCustomContextMenu","mstrmojo._HasExtraSelectionInfo","mstrmojo._SupportCustomVizBrushesAndHighlights","mstrmojo.customviz.GraphicModel","mstrmojo.customviz._TooltipHelper","mstrmojo.customviz.CustomVisEnums","mstrmojo.customviz.CustomVisLegend","mstrmojo._SupportPagination");var $DOM=mstrmojo.dom,$ARR=mstrmojo.array,$DSSOBJ_TYPES=mstrmojo.chart.model.enums.EnumDSSObjectType,$HASH=mstrmojo.hash,$NWB=mstrmojo.Button.newWebButton,$COMPOS=mstrmojo.func.composite,$FNEMPTY=mstrmojo.emptyFn,$UTIL=mstrmojo.VisUtility,$CLRUTIL=mstrmojo.util.color,$GM_UTIL=mstrmojo.gm.GMUtility,$CUSTOM_VIS_UTIL=mstrmojo.CustomVisUtility,CustomVisLegend=mstrmojo.customviz.CustomVisLegend,$CustomVisEnums=mstrmojo.customviz.CustomVisEnums,$ENUM_LEGEND_PROPS=$CustomVisEnums.ENUM_LEGEND_PROPS,$DEFAULT_LEGEND_PROP_VALUE=$CustomVisEnums.DEFAULT_LEGEND_PROP_VALUE,$ENUM_LEGEND_PROPERTY_TYPE=$CustomVisEnums.ENUM_LEGEND_PROPERTY_TYPE,$LEGEND_FORMATTING_PROPERTY=$CustomVisEnums.ENUM_LEGEND_FORMATTING_PROPERTY,$LOG=$CUSTOM_VIS_UTIL.log;var DARK_THEME_ID="F1FED8AC42B57AC1B0E9518FED0F89D6",DEFAULT_THEME_ID="0C2437E3440A676379C06C8C7C6E2AA6";var DEFAULT_GRAPHIC_COLOR="#436CD3";var ATTACHED_EVENTS=["mousemove","click","contextmenu"];var FILTER_TYPE={SHARED:0};var EXTERNAL_LIBS={D3:"d3"};var MARKUP_STRING_WITH_LEGEND='<div id="{@id}" class="custom-vis-layout {@cssClass}" style="position:absolute;font-size:8pt;width:{@width}px;height:{@height}px;z-index:{@zIndex};{@viewportCssText}" mstrAttach:contextmenu,click,mousemove><div class="canvasContainer"></div><div></div></div>',MARKUP_SLOTS_WITH_LEGEND={canvasContainer:function(){return this.domNode.firstChild;},legendPlaceHolder:function(){return this.domNode.lastChild;}};function setUserDefinedError(){var msg=this.errorMessage+" "+this.errorDetails;this.setError(msg);}function toggleError(show){setUserDefinedError.call(this);this.raiseEvent({name:"toggleCtrlOverlay",visible:show,controls:this.getVisEmptyMsgControls()});}function toggleLoading(show){var controls=[{scriptClass:"mstrmojo.Container",cssClass:"vis-loading",markupString:'<div class="{@cssClass}"><div class="loading-cell"><span></span><p>{@msg}</p></div></div>',msg:mstrmojo.desc(16650,"Rendering Visualization...")}];this.raiseEvent({name:"toggleCtrlOverlay",visible:show,controls:controls});}function hideFilterMenuOption(){var vizContainer=this.parent,titleBar=vizContainer&&vizContainer.titleBar,toolbarCfg=titleBar&&titleBar.getMenuConfig();if(!toolbarCfg){return ;}toolbarCfg.menus=$ARR.filter(toolbarCfg.menus,function(item){return item.cls!=="uaf";});}function openAndRefreshFormatPanel(){var docModel=this.getDocModel(),docCtrl=$HASH.walk("rootCtrl.docCtrl",mstrApp);if(docModel&&docCtrl&&(typeof docCtrl.selectViPanel==="function")){docCtrl.selectViPanel("propertiesPanel");docModel.selectVIUnit(this.parent.id,true);}}function getSetPropertiesAction(){var modelData=this.model.data,xmlDom,xmlString;var convertJSONToXML=function(object,tagName){if(object===undefined||object===null){return ;}var ret=xmlDom.createElement(tagName),key;if(object instanceof Object){for(key in object){if(object.hasOwnProperty(key)){var child=convertJSONToXML(object[key],key);if(child){ret.appendChild(child);}}}}else{ret.setAttribute("value",object);}return ret;},encodeXMLString=function(xmlString){return xmlString.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;");};xmlDom=(new DOMParser()).parseFromString("<props><widgetProps><fmt></fmt></widgetProps></props>","text/xml");xmlDom.firstChild.firstChild.firstChild.appendChild(convertJSONToXML(this.getProperties(),"cvp"));xmlString=(new XMLSerializer()).serializeToString(xmlDom);return[{act:"setProperty",nodeKey:modelData.k,prs:"FormattingWidget",pri:4,v:encodeXMLString(xmlString)}];}function isValidProperties(properties,level){var isObject=typeof properties==="object";if((level===0&&!isObject)||(level===2&&isObject)){return false;}for(var key in properties){var value=properties[key];if(typeof value==="object"&&!isValidProperties(value,level+1)){return false;}}return true;}function reserveExternalLibrarys(noConflictLibs){var _noConflictLibs=this._noConflictLibs,D3=EXTERNAL_LIBS.D3;if(!_noConflictLibs){_noConflictLibs=this._noConflictLibs={};}$ARR.forEach(noConflictLibs,function(lib){if(!_noConflictLibs[D3]){switch(lib){case D3:_noConflictLibs[D3]=window.d3;return ;}}});}function getNoConflictLibraryReference(noConflictLibraries){var code="",D3=EXTERNAL_LIBS.D3;$ARR.forEach(noConflictLibraries,function(lib){switch(lib){case D3:code+="var d3 = this._noConflictLibs['"+D3+"'];";return ;}});return code;}function getColorByAttsNames(colorByItems){var gts=$HASH.walk("dataInterface.data.gts",this),units=(gts.row||[]).concat(gts.col||[]),names="",index,item;$ARR.forEach(colorByItems,function(itm){index=$ARR.find(units,"id",itm.id);if(index>-1){item=units[index];names+=(item.dn||item.n)+" ";}});if(names.length>0){names=names.substring(0,names.length-1);}return names;}function getColorByInfo(){var zonesModel=this.zonesModel,colorByAttrs=zonesModel&&zonesModel.getColorByAttributes(),colorByMetric=zonesModel&&zonesModel.getColorByMetric(),index,colorByLabel="",colorByItems=[];if(colorByAttrs&&colorByAttrs.length>0){var colorByAttrInfo=this.getColorByAttInfo(colorByAttrs),element,singleItem;colorByLabel=getColorByAttsNames.call(this,colorByAttrs);for(index=1;index<colorByAttrInfo.length;index++){element=colorByAttrInfo[index];singleItem={};$HASH.copyProps(["color","encodedColor","isDefaultColor","opacity","comb"],element,singleItem);singleItem.decodedColor=element.color;singleItem.label=element.text;singleItem.token={elements:element.colorByElementIDs,levels:element.colorByAttributeIDs,types:element.colorByTypes};colorByItems.push(singleItem);}return{item:colorByLabel,elements:colorByItems};}if(colorByMetric){var colorByMetricId=colorByMetric.id,modelData=$HASH.walk("dataInterface.data",this),gsi=modelData&&modelData.gsi,mx=gsi&&gsi.mx,thresholds=gsi&&gsi.thresholds,cbMetric,colorThresholds,rankMode,nfs,fs,defaultColor;index=$ARR.find(mx,"did",colorByMetricId);if(colorByMetricId&&thresholds&&index>-1){cbMetric=mx[index];colorThresholds=thresholds[colorByMetricId];if(colorThresholds&&colorThresholds.length>0){rankMode=$UTIL.getRankMode(colorThresholds);nfs=$UTIL.getNumberFormat(modelData,index);fs=nfs?$UTIL.getColorByFormatStr(nfs.replace(/\'/g,'"'),rankMode):"";defaultColor=$CLRUTIL.getCSSColorString(DEFAULT_GRAPHIC_COLOR);colorByItems=$UTIL.getColorByItems(colorThresholds,rankMode,cbMetric.max,cbMetric.min,cbMetric.cnt,fs,defaultColor);colorByLabel=$UTIL.getColorByTitle(cbMetric.n,rankMode);return{item:colorByLabel,elements:colorByItems};}}}}function getSizeByInfo(){var zonesModel=this.zonesModel,sizeByMetric=zonesModel&&zonesModel.getSizeByMetric(),useAbsolute=zonesModel&&zonesModel.useAbsoluteSizeByValue(),row,col,maxFormatVal,minFormatVal,minValue=Infinity,maxValue=useAbsolute?0:-Infinity,sizeByLabel="",caseFlag=0,sizeByItems=[];if(sizeByMetric){var sizeByMetricId=sizeByMetric.id,modelData=$HASH.walk("dataInterface.data",this),gsi=modelData&&modelData.gsi,gvs=modelData&&modelData.gvs,mx=gsi&&gsi.mx,items=gvs&&gvs.items,itemsNum=(items&&items.length)||0,value,sizeByVal;col=$ARR.find(mx,"did",sizeByMetricId);if(sizeByMetricId&&col>-1){sizeByLabel=(useAbsolute?mstrmojo.desc(14741,"Absolute value of")+" ":"")+mx[col].n;for(row=0;row<itemsNum;row++){value=items[row].items[col];sizeByVal=useAbsolute?Math.abs(value.rv):value.rv;if(sizeByVal>maxValue){maxValue=sizeByVal;maxFormatVal=value.v;}if(sizeByVal<minValue){minValue=sizeByVal;minFormatVal=value.v;}}if(Math.abs(maxValue-minValue)<0.000001){caseFlag=2;sizeByItems=[{diameter:12,sign:"=",v:minFormatVal}];}else{sizeByItems.push({sign:"=",v:maxFormatVal});sizeByItems.push({sign:"=",v:minFormatVal});}return{item:sizeByLabel,elements:sizeByItems,caseFlag:caseFlag};}}}function transformLegendProperty(propName,propVal){if(propVal===undefined||propVal===null){return propVal;}if($ENUM_LEGEND_PROPERTY_TYPE[propName]==="Boolean"){return $CUSTOM_VIS_UTIL.parseBoolean(propVal);}if($ENUM_LEGEND_PROPERTY_TYPE[propName]==="Integer"){return parseInt(propVal);}if($ENUM_LEGEND_PROPERTY_TYPE[propName]==="Float"){return parseFloat(propVal);}return propVal;}function getBuiltInLegendProperties(){var themeName=this.isDefaultTheme()?"defaultTheme":"classicTheme";return $DEFAULT_LEGEND_PROP_VALUE[themeName];}mstrmojo.CustomVisBase=mstrmojo.declare(mstrmojo.VisBase,[mstrmojo.vi.ui.rw._XtabDE,mstrmojo.vi.ui.rw._HasVisSelections,mstrmojo._VizSelectionHelper,mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl,mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights,mstrmojo._colorPalette,mstrmojo.ui.menus._HasMenuPopup,mstrmojo._HasCustomContextMenu,mstrmojo._HasExtraSelectionInfo,mstrmojo._SupportCustomVizBrushesAndHighlights,mstrmojo.customviz._TooltipHelper,mstrmojo._SupportPagination],{scriptClass:"mstrmojo.CustomVisBase",plotted:false,markupString:'<div id="{@id}" class="custom-vis-layout {@cssClass}" style="position:absolute;font-size:8pt;width:{@width}px;height:{@height}px;z-index:{@zIndex};{@viewportCssText}" mstrAttach:contextmenu,click,mousemove></div>',supportPagination:false,markupSlots:{containerNode:function(){return this.domNode;},viewport:function(){return this.domNode;}},formatHandlers:{viewport:["background-color","left","top"]},bindings:{gridData:"this.model.data"},externalLibraries:null,cssFiles:null,errorMessage:"There is either not enough data to display the visualization or an error occurred while executing the visualization.",errorDetails:"",isDynamicTooltip:true,tooltipWin:null,tooltipObjsInOrder:[],additionalAttrIds:[],reuseDOMNode:false,noConflictLibraries:null,enableLegend:false,isCustomVis:true,dataInterface:null,hideUseAsFilterMenuItem:undefined,graphicModels:[],graphicModelsNA:false,noHighlightAfterKeepOnlyExcludeDrill:false,normalizedIdCache:{},splitDomNodes:function(){if(this.enableLegend){this.markupString=MARKUP_STRING_WITH_LEGEND;$HASH.copy(MARKUP_SLOTS_WITH_LEGEND,this.markupSlots);}},init:function init(props){this.splitDomNodes();if(window.mstrApp&&window.mstrApp.isVI){var viewportHandler=this.formatHandlers.viewport;if(viewportHandler){var idx=$ARR.indexOf(viewportHandler,"background-color");if(idx>-1){viewportHandler.splice(idx,1);}}}this._super(props);var cssFiles=this.cssFiles;if(cssFiles){mstrmojo.insertCSSLinks(cssFiles);}this.hideUseAsFilterMenuItem=true;this.graphicModels=[];this.graphicModelsNA=false;this.noHighlightAfterKeepOnlyExcludeDrill=false;this.initTooltip();},getFonts:function(){if(!this.enableLegend){return[];}return[{name:this.getLegendProperty($ENUM_LEGEND_PROPS.LEGEND_FONT_FAMILY),isItalic:this.getLegendProperty($ENUM_LEGEND_PROPS.LEGEND_FONT_ITALIC),isBold:this.getLegendProperty($ENUM_LEGEND_PROPS.LEGEND_FONT_WEIGHT)}];},plot:mstrmojo.emptyFn,getFilterType:function getFilterType(){return this.defn.ins||FILTER_TYPE.SHARED;},destroyLegend:function(){var legend=this.legend;if(this.enableLegend&&legend&&typeof legend.destroy==="function"){legend.destroy();this.legend=undefined;}},unrender:function unrender(ignoreDom){if(this.defn){this.clearCache();}this.destroyLegend();this._super(ignoreDom);},displayError:function displayError(){if(!this.destroyed){toggleError.call(this,true);}this.renderFinished=true;},renderVisualization:function renderVisualization(){if(this.graphicModelsNA||this.excludeData){this.plotted=false;return ;}function doRender(){try{this.renderFinished=false;var sub=this.attachEventListener("renderFinished",this.id,function(){var me=this;setTimeout(function(){me.renderFinished=true;},0);me.detachEventListener(sub);});toggleLoading.call(this,false);this._renderLegend();this._positionCanvasContainer();var noConflictLibraries=this.noConflictLibraries;if(noConflictLibraries&&noConflictLibraries.length>0){var codeString=this.plot.toString();eval(getNoConflictLibraryReference(noConflictLibraries)+codeString.substring(codeString.indexOf("{")+1,codeString.lastIndexOf("}")));}else{this.plot();this.updateHighlight();}this.plotted=true;}catch(e){this.displayError();this.plotted=false;}}toggleLoading.call(this,true);this.loadFonts(this.getFonts(),{success:doRender.bind(this),failure:doRender.bind(this)});},setForceReload:function(externalLibs){return externalLibs.map(function(lib){var l=$HASH.copy(lib,{});l.forceReload=!!lib.forceReload;return l;});},postBuildRendering:function postBuildRendering(){var me=this,libraries,res,sub;if(me.waitingForData){return ;}sub=me.listenToUpdateColorMap(function(){me.legendColorByInfo=getColorByInfo.call(me);me.render();if(sub&&me.detachUpdateColorMapListener instanceof Function){me.detachUpdateColorMapListener(sub);}});hideFilterMenuOption.call(me);if(this.isEmpty()){if($UTIL.isOnExpressMode()){$UTIL.renderWidgetErrorRSD(this,$HASH.walk("model.data.eg",this),ATTACHED_EVENTS);}else{this._super();}this.hasRendered=true;return false;}var exp=this.getExp(),gtsModel=this.getRowsAndCols();$UTIL.modifyScExp(exp,gtsModel,this.model,this.normalizedIdCache);res=this._super();if(!this.externalLibraries){libraries=undefined;}else{if(!$ARR.isArray(this.externalLibraries)){console.error("externalLibraries should be an array: ",this.externalLibraries);libraries=undefined;}else{libraries=this.setForceReload(this.externalLibraries);}}this._initLegend();this.renderFinished=false;if(libraries){var url,arr=this.scriptClass&&this.scriptClass.split("."),pluginName=arr&&arr[2],prefix;if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode()&&mstrApp.dossierServerBaseUrl&&mstrConfig.dossierServerPluginNames.indexOf(pluginName)>-1){prefix=mstrApp.dossierServerBaseUrl+"plugins/";$ARR.forEach(libraries,function(library,index){url=library.url;if(url.substr(0,7)==="file://"){url=url.substr(7);}if(url.substr(0,4)!=="http"&&url.substr(0,2)!=="//"){libraries[index].url=prefix+url;}});}toggleLoading.call(me,true);this.requiresExternalScripts(libraries,function(){if(me.destroyed){return ;}toggleLoading.call(me,false);var noConflictLibraries=me.noConflictLibraries;if(noConflictLibraries&&noConflictLibraries.length>0){reserveExternalLibrarys.call(me,noConflictLibraries);}me.renderVisualization();});}else{me.renderVisualization();}return res;},getCanvasContainerSize:function(){var legend=this.legend,width=this.getWidth(),height=this.getHeight(),legendWidth;if(legend&&this.canRenderLegend()){legendWidth=legend._getLegendWidth();width-=legendWidth;}return{width:width,height:height};},canRenderLegend:function(){if(!this.enableLegend){return false;}var showLegend=this.getLegendProperty($ENUM_LEGEND_PROPS.SHOW_LEGEND);return showLegend&&this.hasColorByOrSizeBy();},_initLegend:function(){if(!this.enableLegend){return ;}this.legend=this.addDisposable(new CustomVisLegend({widget:this,placeholder:this.legendPlaceHolder,defaultGraphicColor:DEFAULT_GRAPHIC_COLOR,colorByInfo:this.legendColorByInfo,sizeByInfo:this.legendSizeByInfo,cachedDimension:this._legendDimension}));this.legend.render();},_renderLegend:function(){if(this.enableLegend&&this.legend){this.legend.renderLegend();}},_cacheLegendDimension:function(dimension){this._legendDimension=dimension;},_wrapLegendCallbackConfig:function(propName,subPropName,config){if(propName===$CustomVisEnums.LEGEND_PROPERTY_SET&&$LEGEND_FORMATTING_PROPERTY.indexOf(subPropName)>=0){var callback=function(){var legend=this.legend;if(legend){legend._updateLegendStyle();}};return{callback:callback,clientUndoRedoCallback:callback};}return config;},_positionCanvasContainer:function(legendPosition){var canvasContainer=this.canvasContainer,containerSize=this.getCanvasContainerSize(),legend=this.legend;if(!this.enableLegend||!canvasContainer){return ;}canvasContainer.style.width=containerSize.width+"px";canvasContainer.style.height=containerSize.height+"px";if(!legend||!this.canRenderLegend()){canvasContainer.style.left="0px";return ;}if(legendPosition===undefined){legendPosition=legend._getLegendPosition();}canvasContainer.style.left=legend.isOnRight(legendPosition)?"0px":(legend._getLegendWidth()+"px");},onLegendDropZoneChange:function(dropZoneInfo){this._positionCanvasContainer(dropZoneInfo&&dropZoneInfo.pos);},onLegendDropped:function(legendDockPos){if(this.legend){this.legend._onLegendDropped(legendDockPos);}},_isConsumeMode:function(){return $CUSTOM_VIS_UTIL.isRWDExpressMode()||$CUSTOM_VIS_UTIL.isLibrary()||$CUSTOM_VIS_UTIL.isVIPresentationMode()||mstrApp.isInVFInteractMode||mstrApp.isDisplayOnMobile;},redraw:function redraw(){if(this.excludeData){return false;}if(this.reuseDOMNode){if(this.plotted){this.renderVisualization();}return this.plotted;}return false;},createZoneModel4ConvertedRWD:function createZoneModel4ConvertedRWD(nodeData){var customVis=this,dz=nodeData&&nodeData.dz;if(mstrApp.isExpress&&dz&&Object.keys(dz).length>0){var visName=this.getVisName(nodeData),zoneModelClassName=$HASH.walk("pluginsVisList."+visName+".dz",mstrConfig)||"vi.models.BaseVisDropZones",ViewClass;if(zoneModelClassName){mstrmojo.requiresCls("mstrmojo."+zoneModelClassName);ViewClass=$HASH.walk(zoneModelClassName,mstrmojo);customVis.zonesModel=customVis.addDisposable(new ViewClass({hostId:customVis.id,docModel:customVis.getDocModel(),visModel:customVis.model}));}}},update:function update(node){if(this._super&&!this._super(node)){return false;}this.clearError();var nodeData=this.getData();if(!nodeData){this.setError(mstrmojo.desc(8426,"No model provided"));return false;}var egt=nodeData.egt,eg=nodeData.eg;if(!this.excludeData&&(egt!==undefined||eg!==undefined)){this.setError(eg,egt);}if(this.isEmpty()||this.excludeData){this.graphicModelsNA=true;return ;}this.dataInterface=new mstrmojo.models.template.DataInterface(nodeData);this.createZoneModel4ConvertedRWD(nodeData);this.legendColorByInfo=getColorByInfo.call(this);this.legendSizeByInfo=getSizeByInfo.call(this);this.idTitleMapping=this.generateIdTitleMapping();var dropZoneModel=this.zonesModel;if(dropZoneModel){var tooltipOrder=dropZoneModel.getDefaultTooltipOrder();dropZoneModel.setTooltipObjsOrder(tooltipOrder);this.additionalAttrIds=dropZoneModel.getAdditionalAttrIds();}this.currColorbyAttrListIdx=0;try{this.graphicModels=this.createGraphicModels();this.graphicModelsNA=false;}catch(e){this.graphicModelsNA=true;setUserDefinedError.call(this);$LOG("Error occurred when creating the graphic models");}},getVisName:function getVisName(data){var visObj=data.vis,visName=data.visName||(visObj&&visObj.vn);return visName;},moveTooltip:function moveTooltip(evt,win){var target=evt.target||$DOM.eventTarget(evt.hWin,evt.e),that=this,content,getTitle=function getTitle(node){var i,children=node.childNodes;for(i=0;i<children.length;i++){var child=children[i];if(child.nodeName==="title"){return child;}}if(node!==that.domNode){return getTitle(node.parentNode);}return null;},title=getTitle(target);if(title){var tooltip=title.innerHTML||title.textContent;if(tooltip.length){content=tooltip;title.tt=tooltip;title.innerHTML="";}else{if(title.tt!==undefined){content=title.tt;}}}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:content,top:evt.clientY+12,left:evt.clientX-12,cssClass:"vi-regular vi-tooltip-A"};this._super(evt,win);},setError:function(msg,type){var translatedError=$UTIL.translateGridError(msg,type);this.error=translatedError.msg;this.errorType=translatedError.type;},clearError:function(){this.error=undefined;this.errorType=undefined;},hasError:function(){return this.error!==undefined||this.errorType!==undefined;},isEmpty:function(){return this.hasError();},getVisEmptyMsgControls:function getVisEmptyMsgControls(){return $UTIL.getVisEmptyMsgControls.call(this);},hasColorByOrSizeBy:function hasColorByOrSizeBy(){var zonesModel=this.zonesModel;if(!zonesModel){return false;}return zonesModel.getColorByAttributes().length>0||zonesModel.getColorByMetric()||zonesModel.getSizeByMetric();},getProperties:function getProperties(){var data=this.model.data,vp=data.vp;if(!vp){data.vp={cvp:{}};}else{if(!vp.cvp){vp.cvp={};}}return data.vp.cvp;},getDefaultProperties:function getDefaultProperties(){return this.dvp||{};},getLegendProperty:function(propertyName){if(!this.enableLegend){return ;}var legendPropSet=$CustomVisEnums.LEGEND_PROPERTY_SET,props=this.getProperties()[legendPropSet]||{},defProps=this.getDefaultProperties()[legendPropSet]||{},builtInDefProps=getBuiltInLegendProperties.call(this),propValue;propValue=props[propertyName];if(propValue===undefined){propValue=defProps[propertyName];if(propValue===undefined){propValue=builtInDefProps[propertyName];}}return transformLegendProperty(propertyName,propValue);},getLegendProperties:function(){var me=this,props={},propName;$ARR.forEach(Object.keys($ENUM_LEGEND_PROPS),function(key){propName=$ENUM_LEGEND_PROPS[key];props[propName]=me.getLegendProperty(propName);});return props;},setDefaultPropertyValues:function setDefaultPropertyValues(dvp){if(dvp instanceof Object){this.dvp=dvp;}else{this.dvp={};}},getProperty:function getProperty(propertyName){if(propertyName===$CustomVisEnums.LEGEND_PROPERTY_SET){return this.getLegendProperties();}var props=this.getProperties(),defProps=this.getDefaultProperties(),propValue;propValue=props[propertyName]===undefined?defProps[propertyName]:props[propertyName];if(typeof propValue==="object"){propValue=$HASH.copy(props[propertyName],defProps[propertyName]);}return propValue;},setProperty:function setProperty(propertyName,newValue,config){var properties=this.getProperties(),oldValue=properties[propertyName];if(properties&&!$HASH.equals(oldValue,newValue)){properties[propertyName]=newValue;if(config&&config.onPropertyChange instanceof Function){var changedProperties=config.onPropertyChange(propertyName,newValue);if(isValidProperties(changedProperties,0)){$HASH.copy(changedProperties,properties);}else{mstrmojo.warn("Results of onPropertyChange() is invalid. It must be an JSON object that contains the properties and values you want to change, and can't have child properties that exceeds two levels.",{},{buttons:[$NWB(mstrmojo.desc(1442,"OK"),mstrmojo.emptyFn)]});}}if(mstrApp.isDisplayOnMobile){return ;}var suppressData=!!(config&&config.suppressData),requestDefinition=config&&config.requestDefinition,customUndoRedoCallback=config&&config.clientUndoRedoCallback,hasClientUndoRedoCallback=customUndoRedoCallback&&(customUndoRedoCallback instanceof Function),me=this,visId=me.id,boxId=me.parent.id,visModel=me.model,docModel=visModel.docModel,controller=visModel.controller,actions=getSetPropertiesAction.call(this),callback,undoredoCallback,extra={},execute;var getClientUndoRedoCallback=function getClientUndoRedoCallback(val){return suppressData?function(){var vis=mstrmojo.all[visId],properties=vis.getProperties();properties[propertyName]=val;if(hasClientUndoRedoCallback){customUndoRedoCallback.call(vis,val);}else{vis.renderVisualization();}vis.getDocModel().selectVIUnit(vis.parent.id,true);}:$FNEMPTY;};if(suppressData){callback=mstrmojo.emptyFn;execute=function(){this.submitSilent(actions);};}else{callback=docModel.getSliceCallback({tks:visModel.data.k});callback.success=$COMPOS([callback.success,function(){docModel.selectVIUnit(boxId,true);}]);execute=function(){this.submit(actions,callback,extra);};}undoredoCallback=controller._getXtabCallback(me);undoredoCallback.success=$COMPOS([undoredoCallback.success,function(){docModel.selectVIUnit(boxId,true);}]);if(requestDefinition){$HASH.copy(mstrmojo.DocDataService.REQUEST_DEFN_DATA,extra);}controller.cmdMgr.execute({execute:execute,urInfo:{silent:suppressData,callback:undoredoCallback,redo:getClientUndoRedoCallback(newValue),undo:getClientUndoRedoCallback(oldValue)}});}},openFormatPanelByProperty:function openFormatPanelByProperty(propName){var edtModel=this.edtModel;this.openFormatPanelByIdx(function(){return $HASH.walk("propertyPanelIdxMap."+propName,edtModel);});},openFormatPanelWithColorbyGroup:function openFormatPanelWithColorbyGroup(){var edtModel=this.edtModel;this.openFormatPanelByIdx(function(){return $HASH.walk("colorbyGroupPanelIdx",edtModel);});},openFormatPanelByIdx:function openFormatPanelByIdx(getFormatPanelIdx){var edtModel=this.edtModel,formatPanelIdx;if($CUSTOM_VIS_UTIL.isLibrary()||$CUSTOM_VIS_UTIL.isRWDExpressMode()||$CUSTOM_VIS_UTIL.isVIPresentationMode()){return ;}openAndRefreshFormatPanel.call(this);if(typeof getFormatPanelIdx==="number"){formatPanelIdx=getFormatPanelIdx;}else{if(typeof getFormatPanelIdx==="function"){formatPanelIdx=getFormatPanelIdx();}}if(formatPanelIdx>=0){edtModel._targetPulldown.set("selectedIndex",formatPanelIdx);}},openFormatPanelByName:function openFormatPanelByName(name){this.openFormatPanelByIdx(function(){var edtModelPulldownItems=$HASH.walk("edtModel._targetPulldown.items",this);return $ARR.find(edtModelPulldownItems,"n",name);}.bind(this));},savePropertyAndUpdateWidget:function savePropertyAndUpdateWidget(propName,newValue,config,showFormatPanel){if(!config||config.suppressData===undefined){config=$HASH.copy({suppressData:true},config);}this.setProperty(propName,newValue,config);if(config.suppressData){var fn=config.callback instanceof Function?config.callback:this.renderVisualization.bind(this);fn.call(this);if(!this._isConsumeMode()){var propertiesPanel=this.controller.getViPanel("propertiesPanel"),isFormatPanelOpened=propertiesPanel&&propertiesPanel.getOpenStatus();if(!!showFormatPanel){this.openFormatPanelByProperty(propName);}else{if(isFormatPanelOpened){var edtModel=this.edtModel,targetPulldown=edtModel&&edtModel._targetPulldown,formatPanelIdx=targetPulldown&&targetPulldown.selectedIndex;if(formatPanelIdx>=0){this.openFormatPanelByIdx(formatPanelIdx);}}}}}},saveObjectProperty:function(propName,subPropName,newValue,config,showFormatPanel){var savedProperties=$HASH.clone(this.getProperty(propName))||{};savedProperties[subPropName]=newValue;config=this._wrapLegendCallbackConfig(propName,subPropName,config);this.savePropertyAndUpdateWidget(propName,savedProperties,config,showFormatPanel);},addThresholdMenuItem:function addThresholdMenuItem(){this.showThreshold=true;},addUseAsFilterMenuItem:function addUseAsFilterMenuItem(){var vizContainer=this.parent;this.hideUseAsFilterMenuItem=false;if(vizContainer&&vizContainer.generateToolbar){vizContainer.generateToolbar();}},getColorBy:function getColorBy(eids){if(!eids||!this.zonesModel){return null;}var zoneItems=this.zonesModel.getColorByAttributes(),colorObj,gts=this.dataInterface.data.gts,tids=[],isAttr=function(item){return item.t===$DSSOBJ_TYPES.DssTypeAttribute;},isConsolidation=function(item){return item.t===$DSSOBJ_TYPES.DssTypeConsolidation;},isCG=function(item){return item.t===$DSSOBJ_TYPES.DssTypeFilter;};$ARR.forEach(gts.row.concat(gts.col),function(item){$ARR.forEach(zoneItems,function(itm){if((isAttr(itm)||isConsolidation(itm)||isCG(itm))&&itm.id===item.id){tids.push(itm.id);}});});colorObj=this.model.docModel.getColorBy(tids,eids);return $GM_UTIL.decodeColor(colorObj.color);},getColorByAttInfo:function getColorByAttInfo(zoneItems){function getShapeColorAndOpacity(cbElements){var me=this,colorObj,tid,eid,strtid,streid,attr,opacity,props=this.props||{},opacities=props.attrColorByOpacity||{};cbElements.map(function(item){tid=item.colorByAttributeIDs;eid=item.colorByElementIDs;strtid=tid&&tid.join("|");streid=eid&&eid.join("|");attr=opacities[strtid]||{};opacity=attr&&attr[streid];if(opacity===undefined){opacity=100;}item.opacity=opacity;if(tid&&eid){colorObj=me.model.docModel.getColorBy(tid,eid);item.encodedColor=colorObj.color;item.color=$GM_UTIL.decodeColor(colorObj.color);item.isDefaultColor=!colorObj.isManual;}});}function getCbElements(zoneItems){var cbElements,cbAtt=[],gts=this.dataInterface.data.gts,units=(gts.row||[]).concat(gts.col||[]);$ARR.forEach(zoneItems,function(item){$ARR.forEach(units,function(itm){if(itm.id===item.id){cbAtt.push(itm);}});});function descartes(arr){var rs=[],len=arr.length,m,str,bothDescartes=function(arr1,arr2){var r=[],i,j,idx=0,len1=arr1.length,len2=arr2.es.length;for(i=0;i<len1;i++){for(j=0;j<len2;j++){str=arr1[i].text+" "+arr2.es[j].n;idx++;r.push({comb:arr1[i].comb.concat({eid:arr2.es[j].id,tid:arr2.id,tp:arr2.otp}),colorByAttributeIDs:arr1[i].colorByAttributeIDs.concat(arr2.id),colorByElementIDs:arr1[i].colorByElementIDs.concat(arr2.es[j].id),colorByTypes:arr1[i].colorByTypes.concat(arr2.otp),text:str});}}return r;};for(m=0;m<len;m++){if(m===0){var arr0=arr[0];$ARR.forEach(arr0.es,function(itm){rs.push({comb:[{tid:arr0.id,eid:itm.id,tp:arr0.otp}],colorByAttributeIDs:[arr0.id],colorByElementIDs:[itm.id],colorByTypes:[arr0.otp],text:itm.n});});}else{rs=bothDescartes(rs,arr[m]);}}return rs;}cbElements=descartes(cbAtt);cbElements.unshift({text:mstrmojo.desc(2461,"All"),color:"#ffffff",opacity:100,comb:[]});return cbElements;}var cbElements=getCbElements.call(this,zoneItems);getShapeColorAndOpacity.call(this,cbElements);return cbElements;},applySelection:function applySelection(selectInfo,config,extraInfo){if(!selectInfo){return ;}selectInfo=$ARR.ensureArray(selectInfo);extraInfo=$ARR.ensureArray(extraInfo);if(extraInfo.length>0&&extraInfo.length!==selectInfo.length){extraInfo=[];$LOG("extraInfo should be empty or same length with selectInfo, ignore the extraInfo here!");}config=config||{};if(!config.isModify){var clearSelectionsFN=config.forContextMenu?"clearCxtMnuSelection":"clearSelections";this[clearSelectionsFN]();}if(selectInfo.length>0){var isAttrSel=selectInfo[0].isSelectAttr,funcName=(config.isRemove===true?"remove":"add")+(config.forContextMenu===true?"ContextMenu":"")+(isAttrSel?"Attribute":"MetricValue")+"Selection",me=this;}$ARR.forEach(selectInfo,function(selection,index){if(isAttrSel){me[funcName](selection.tid,selection.eid,selection.n,extraInfo[index]);}else{me[funcName](selection,extraInfo[index]);}});if(!config.forContextMenu){this.endSelections();}},isDarkTheme:function isDarkTheme(){return $HASH.walk("model.docModel.thm.did",this)===DARK_THEME_ID;},isDefaultTheme:function(){return $HASH.walk("model.docModel.thm.did",this)===DEFAULT_THEME_ID;},getCellUnitIndex:function getCellUnitIndex(cell){return cell.o;},getCellForNode:function getCellForNode(headerObj){var h=headerObj&&headerObj.h,t=headerObj&&headerObj.t;return{at:h.at,dei:h.dei,dpt:h.dpt,o:h.o,n:t.n,tui:h.tui,ui:h.ui,axis:1,v:headerObj.getName(),tid:t.id};},isInSelection:function isInSelection(isSelectAttr,selector){if(isSelectAttr){return this.isAttSelected(selector.tid,selector.eid);}else{return this.isMetricValueSelected(selector);}},isInContextMenuSelection:function isInContextMenuSelection(isSelectAttr,selector){if(isSelectAttr){return this.isCtxMnuAttSelected(selector.tid,selector.eid);}else{return this.isCtxMnuMetricValueSelected(selector);}},graphicNeedsHighlight:function graphicNeedsHighlight(graphicModel,forContextMenu){var isSelectAttr=graphicModel.isAttributeSelector(),selector=graphicModel.getSelector();if(forContextMenu){return this.needContextMenuHighlight(isSelectAttr,selector);}else{return this.needHighlight(isSelectAttr,selector);}},createGraphicModels:function createGraphicModels(){return[];},getGraphicModels:function getGraphicModels(){return this.graphicModels;},sendMessageToMobileDevice:function sendMessageToMobileDevice(msgType,event,graphicModel){var viz=this,menuConfig=this.getContextMenuConfig(graphicModel),commonConfig=menuConfig&&menuConfig.common,selector=graphicModel&&graphicModel.getSelector(),messageToMobileDevice={messageType:msgType,selectedElement:selector||[],ctxMenuConfig:{pos:viz.getMousePositionFromEvent(event),items:commonConfig?viz.getMobileMenuConfig(commonConfig,graphicModel):[]},toolTip:graphicModel&&this.getTooltipContent(graphicModel)};$UTIL.sendToMobileDevice(messageToMobileDevice);},handleSelection:function handleSelection(event,graphicModel){var isMultiSelectMode=event.ctrlKey||event.metaKey,isSelectAttr=graphicModel&&graphicModel.isAttributeSelector(),selector=graphicModel&&graphicModel.getSelector(),isClearAllDisabled=this.isClearAllDisabled(),needUpdateHighlight=false;if(this.misMatchWithVisSelection){this.synchronizeToVisSelection();needUpdateHighlight=true;}if(graphicModel&&selector){var prevIsSelected=this.isInSelection(isSelectAttr,selector),single=this.getSelections().length===1;if(isMultiSelectMode){if(prevIsSelected&&((single&&!isClearAllDisabled)||!single)){this.applySelection(selector,{isModify:true,isRemove:true},graphicModel);needUpdateHighlight=true;}else{if(!prevIsSelected){this.applySelection(selector,{isModify:true,isRemove:false},graphicModel);needUpdateHighlight=true;}}}else{if(prevIsSelected&&single&&!isClearAllDisabled){this.applySelection([]);needUpdateHighlight=true;}else{if((prevIsSelected&&!single)||!prevIsSelected){this.applySelection(selector,null,graphicModel);needUpdateHighlight=true;}}}}else{if(!isClearAllDisabled){this.applySelection([]);needUpdateHighlight=true;}}if(mstrApp.isDisplayOnMobile){this.sendMessageToMobileDevice("singletap",event,graphicModel);}else{if(needUpdateHighlight){this.updateHighlight();}}},handleContextMenuSelection:function handleContextMenuSelection(event,graphicModel){var isSelectAttr=graphicModel&&graphicModel.isAttributeSelector(),selector=graphicModel&&graphicModel.getSelector();if(this.misMatchWithVisSelection){this.synchronizeToVisSelection();}if(graphicModel&&selector){var isNodeSelected=this.isInSelection(isSelectAttr,selector);if(!isNodeSelected){this.applySelection(selector,{forContextMenu:true},graphicModel);}else{this.synchronizeContextMenuSelection();}}else{this.applySelection([],{forContextMenu:true});}if(mstrApp.isDisplayOnMobile){this.sendMessageToMobileDevice("longpress",event,graphicModel);}else{var menuConfig=this.getContextMenuConfig(graphicModel),commonConfig=menuConfig&&menuConfig.common,customConfig=menuConfig&&menuConfig.custom;if(commonConfig&&customConfig){this.showContextMenu(event,commonConfig,customConfig);}this.updateHighlight();}},isClearAllDisabled:function isClearAllDisabled(){var sc=this.findSelectorControl();return sc&&!sc.showall;},generateIdTitleMapping:function generateIdTitleMapping(){var me=this,rowTitles=$HASH.walk("gridData.gts.row",this),cols=$HASH.walk("gridData.gts.col",this),colTitles=(cols&&cols.length===1)&&(cols[0].otp===-1)&&cols[0].es,idTitleMapping={};$ARR.forEach(rowTitles,function(title){idTitleMapping[title.id]=title.n;me.tooltipObjsInOrder.push(title.id);});$ARR.forEach(colTitles,function(title){idTitleMapping[title.oid]=title.n;me.tooltipObjsInOrder.push(title.oid);});return idTitleMapping;}});mstrmojo.CustomVisBase.ENUM_EXTERNAL_LIBS=EXTERNAL_LIBS;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.models.template.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.Button","mstrmojo.Label","mstrmojo.ui.CheckList","mstrmojo.ui.Pulldown","mstrmojo.models.datasets.DataInterface","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.models.VIComponentMap","mstrmojo.threshold.ThresholdController","mstrmojo.threshold.ThresholdModel","mstrmojo.chart.model.enums.EnumDSSAxisName","mstrmojo.chart.model.enums.EnumDSSDynamicShortcut","mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ME.MetricDataService","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType");var c=mstrmojo,N=c.array,S=c.hash,AQ=mstrmojo.chart.model.enums.EnumDSSObjectType,f=c.vi.ui.DatasetUnitMenuUtils,X=mstrmojo.models.datasets.DataInterface,AL=c.vi.models.VIComponentMap,g=mstrmojo.vi.viz.EnumDSSDropZones,I=mstrmojo.ME.MetricDataService,H=1,AJ=2,F=3,AS=4,P=5,AE=6,j=7,O=8,w=9,AV=10,A=11,AB=12,D="00000000000000000000000000000000",AH=-1,d=mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap,AD=mstrmojo.chart.model.enums.EnumDSSAxisName,Ac=mstrmojo.chart.model.enums.EnumDSSDynamicShortcut,R=mstrmojo.mstr.EnumDSSXMLBaseFormType,V=mstrmojo.mstr.EnumDSSXMLObjectTypes,Ab=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,G=mstrmojo.mstr.EnumDSSConsolidationType;function W(Ah){var Ai=this.getHost(),Aj=Ai.model.data.gsi;return Aj.cols.concat(Aj.rows).filter(function(Ak){return Ak.t===Ah;});}function z(Ah,Aj,Ai){return{act:"updateTemplate",keyContext:Ah.k,partialRetrieval:{nodes:Ai?null:[Ah.k]},actions:Aj};}function AR(Ak,Ai,Al){var Ap=this,Am=[],An=[],Aq={};if(Ai.useDropzone){Ak.useDropzone=true;Aq.dropzoneId=Ai.zone.id;if(Ai.item.ax!==undefined){Aq.ax=Ai.item.ax;}}Aq.position=Ai.idx+1+(Al.offset||0);if(Al.replaceSourceId){Ak.replaceSourceId=Al.replaceSourceId;}if(Al.addToTooltip){An.push({dropzoneId:w,position:Ap.gmZones.getTooltipDropzoneIdx(Ai.item)+1});}Ak.partialRetrieval={nodes:[Ak.nodeKey]};An.push(Aq);Ak.dropzones=An;Am.push(Ak);var Ao="$GUID_115",Ah=[],Aj=this.checkAndAddThresholdAction(Ai.zone.id,{did:Ao,t:4},Ah);if(Aj){Ak.newObjectIds=[Ao];Am.push(this.getUpdateTemplateAction(Ah));}return Am;}function Ag(Ak){var Ah=this.getHost().model.data.datasetId,Aj=N.ensureArray(Ak),Ai=N.hash(Aj);if(!Ah){S.forEach(this.docModel.datasets,function(An,Ao){var Al=(An.att||[]).concat(An.mx||[]),Am=Al.some(function(Ap){return Ai[Ap.did];});if(Am){Ah=Ao;return false;}});}return Ah;}function AW(Ah,Al,Ai){var Ao=this,At=this.docModel,An=Ah.item,Ar=f.getUnitFromDataset(Ao.docModel.datasets,An.did,An.t)||An,Au=this.getHost(),Aq=Ao.docModel.getDataService(),Am=Al==="edit",Ap=Au.getChartStyle&&Au.getChartStyle()==="NewGraphMatrixVisualizationStyle",Aj,Ak={dsid:Am?At.findDatasetIdFromUnit(Ar.did):Ag.call(Ao,Ar.did),alias:Ar.alias||Ar.n},As=null;if(Ar.t===V.Metric){if(Am){Aj={metricId:Ar.did,metric:Ar,action:{cmd:Al,n:Ar.n,alias:An.n}};Ak.did=Ar.did;Ak.nodeKey=Au.k;As=Aq.getEditDerivedMetricSubmitFunc(Ak);}else{Aj={metricId:"",action:{cmd:Al,refOi:{did:Ar.did,n:Ar.n}}};Ak.nodeKey=Au.k;Ak.idx=Ah.idx;Ak.host=Au;Ak.zoneid=Ah.zone.id;if(Ap){Ak.extraZone={id:w,idx:Ao.gmZones.getTooltipDropzoneIdx(Ah.item)};}if(Ai){Ak.replace={did:Ar.did,t:Ar.t};}if(Ah.useDropzone){As=Aq.getAddNewDerivedMetricToDropzoneSubmitFunc(Ak);}else{As=Aq.getAddNewDerivedMetricToXtabSubmitFunc(Ak);}}if(Ao.docModel.isFromSolrCube(Ar.did)||Ao.docModel.isFromMDXCube(Ar.did)){Aj.disableAFB=true;}Ao.docModel.controller.openDME(Au,Aj,As);}}mstrmojo.vi.models._DropZoneCommon=mstrmojo.provide("mstrmojo.vi.models._DropZoneCommon",{_mixinName:"mstrmojo.vi.models._DropZoneCommon",isMetric:function i(Ah){return Ah&&Ah.t===V.Metric&&Ah.id!==D;},isAttribute:function AF(Ah){return Ah&&Ah.t===V.Attribute;},isRecursiveAttribute:function b(Ah){return Ah&&Ah.t===V.Attribute&&Ah.st===Ab.AttributeRecursive;},isNewDerivedElement:function AM(Ah){return Ah.t===V.Consolidation&&Ah.st===Ab.ConsolidationManaged;},isNewDerivedRecursiveElement:function AM(Ah){return Ah.t===V.Consolidation&&Ah.st===Ab.ConsolidationManaged&&Ah.ndetype===G.DssRecursiveDerivedElement;},isConsolidation:function Aa(Ah){return Ah.t===V.Consolidation&&Ah.st===Ab.Consolidation;},isCustomGroup:function C(Ah){return Ah.t===V.Filter;},isAttrCategory:function Y(Ah){return Ah&&(Ah.t===V.Attribute||Ah.t===V.Filter||Ah.t===V.Consolidation||Ah.t===V.Dimension);},isMetricName:function AU(Ah){return Ah&&(Ah.id===D||Ah.did===D);},differInType:function U(Ai,Ah){return(this.isMetric(Ai)&&this.isAttrCategory(Ah))||(this.isAttrCategory(Ai)&&this.isMetric(Ah));},isDynamicLink:function J(Ai){if(this.isAttribute(Ai)){var Ah=Ai.fs||X.getFormsByAttrId(Ai.did,this.docModel.datasets);return Ah.length===2&&Ah[1].bftp===R.DssXmlBaseFormHTMLTag&&Ah[1].fnm==="DYNAMICLINK";}return false;},hasOldDEOverDatasets:function(Ak){var Aj=this.docModel.datasets,Ai=false,Ah;S.forEach(Aj,function(Al){Ah=N.find((Al.att||[]),"did",Ak);if(Ah!==-1&&Al.att[Ah].de){Ai=true;return false;}});return Ai;},getZoneModelByZoneId:function(Ah){var Ai=this.dropZones,Aj;if(!Ai&&typeof this.getDropZones==="function"){Ai=(this.getDropZones()||{}).zones;}N.forEach(Ai,function(Ak){if(Ak.id===Ah){Aj=Ak;return false;}});return Aj;},hGetItemOccurrence:function(Al,An){An=An||[];if(An.length===0){An=[H,AJ,F,AS,j,P,O,w,AE,AV];}var Aj,Ah,Ai,Am=An.length,Ak=[];for(Aj=0;Aj<Am;Aj++){Ai=this.getZoneModelByZoneId(An[Aj]);if(!Ai){continue;}Ah=this.getUnitIndexInZone(Ai,Al);if(Ah!==-1){Ak.push({zoneId:An[Aj],itemIndex:Ah});}}return Ak;},removeColorByItemFromBreakByIfExists:function AC(Ak,Am){var Al,Aj,Ah,Ai;Al=this.hGetItemOccurrence(Ak,[H,AJ,F,AS,P,O,AE]);if((Al.length===1)&&(Al[0].zoneId===P||Al[0].zoneId===AE)){Aj=Al[0];Ah=this.getZoneModelByZoneId(Aj.zoneId);Ai=Ah.items[Aj.itemIndex];if(Ai.hidden){Array.prototype.push.apply(Am,this.getRemoveDropZoneUnitActions(Ah,Ai));}}},updateBreakByAndSliceUnits:function l(){var Ah=this,Aj=[H,AJ,F,AS,j,O,A,AB],Ai=this.getZoneModelByZoneId(AE)||this.getZoneModelByZoneId(P),Ak;Ai.items.forEach(function(Al){if(Ah.isAttrCategory(Al)||Ah.isMetricName(Al)){Ak=Ah.hGetItemOccurrence(Al,Aj);if((Ak.length===1)&&(Ak[0].zoneId===j)){Al.hidden=true;}}});},getAxisSummary:function AN(){var Ah={};Ah[F]=this.getItemCountInZone(F);Ah[AS]=this.getItemCountInZone(AS);Ah[AV]=this.getItemCountInZone(AV);return Ah;},getItemCountInZone:function(Ah){var Ai=this.getZoneModelByZoneId(Ah);if(Ai){return Ai.items.length;}return 0;},isOnlyMetricZone:function h(Ah){var Aj,Al,Ak,Ai=this.getZoneModelByZoneId(Ah);if(!Ai){return false;}Ak=Ai.items;Al=Ak.length;if(Al===0){return false;}for(Aj=0;Aj<Al;Aj++){if(!this.isMetric(Ak[Aj])){return false;}}return true;},isMetricZone:function y(Ah){var Aj,Al,Ak,Ai=this.getZoneModelByZoneId(Ah);if(!Ai){return false;}Ak=Ai.items;Al=Ak.length;if(Al===0){return false;}for(Aj=0;Aj<Al;Aj++){if(!this.isMetric(Ak[Aj])){if(this.isMetricName(Ak[Aj])){continue;}else{return false;}}}return true;},getMetricCntInZone:function(Ah){var Aj=this,Ai=this.getZoneModelByZoneId(Ah),Al=Ai.items,Ak=0;N.forEach(Al,function(Am){if(Aj.isMetric(Am)){Ak++;}});return Ak;},isAttrCategoryZone:function(Ah){var Aj,Al,Ak,Ai=this.getZoneModelByZoneId(Ah);if(!Ai){return false;}Ak=Ai.items;Al=Ak.length;if(Al===0){return false;}for(Aj=0;Aj<Al;Aj++){if(!this.isAttrCategory(Ak[Aj])&&!this.isMetricName(Ak[Aj])){return false;}}return true;},getZoneSummary:function AK(Ah){var Ak=this,Ai=this.getZoneModelByZoneId(Ah),Am=Ai?Ai.items:[],Al=0,An=0,Aj=false;N.forEach(Am,function(Ao){if(Ak.isMetric(Ao)){Al++;}else{if(Ak.isAttrCategory(Ao)){An++;}else{if(Ak.isMetricName(Ao)){Aj=true;}}}});return{metricCount:Al,attributeCount:An,hasMetricName:Aj};},isTemplateContainAttCategoryItem:function AP(){var Ak=this,Aj=Ak.getHost(),Al=Aj.model.data.gsi,Ai=(Al.rows||[]).concat(Al.cols||[]),Ah=false;if(Ai&&Ai.length){N.forEach(Ai,function(Am){if(Ak.isAttrCategory(Am)){Ah=true;return false;}});}return Ah;},showNumberFormat:function(Ah){return mstrmojo.all[this.hostId].model.showNumberFormat(Ah);},renameItem:function(Ai,Ah){var Aj=this.id;f.renameItem(Ai,Ah,function(An){var Ap=mstrmojo.all[Aj],As=Ap.getHost(),Am=Ap.getHostModel().gsi,Ao=An.allowTrimming?An.text.trim():An.text,At=Ah.t===V.Metric,Al=At?Am.mx:Am.rows.concat(Am.cols),Ar=function(){Ap.submitDropZoneUpdates(z(As,[{act:"renameUnit",id:Ah.did,type:Ah.t,name:Ao,isDynamicAlias:false}]));},Ak=function(){An.set("text",Ah.n);},Aq=Al.some(function(Au){return Au.did!==Ah.did&&(At||Au.t===Ah.t)&&Au.n===Ao;});if(Aq){mstrmojo.warn(mstrmojo.desc(11664,'"##" already exists in the visualization. Do you want to proceed?').replace("##",Ao),{confirmBtn:{fn:Ar},cancelBtn:{fn:Ak}});}else{Ar();}},{allowEmptyText:true,cssClass:Ai.className});},getPageByUnit:function Ad(){var Ai=this.getHost(),Ah=Ai.builder.getLayoutVIMap(Ai.defn._lkz).getComponent(AL.TYPES.PAGEBY_PANEL);return Ah&&Ah.unit;},shouldShowDisplayFormsMenu:function E(Ak){if(!mstrmojo.resolveFeature("set-attributeform-display")||!this.isAttribute(Ak)&&!this.isNewDerivedRecursiveElement(Ak)||this.isDynamicLink(Ak)){return false;}var Ah=X.getFormsByAttrId(Ak.attId||Ak.did,this.docModel.datasets),Al=this.getHost().model.data,Ai=Al&&Al.gts,Aj=!!Ai&&Ah.length>1;if(Ai&&Ah.length===1){var Am=false;N.forEach((Ai.row||[]).concat(Ai.col||[]),function(An){if(An.id===Ak.did&&N.find(An.fs||[],"id",Ah[0].fid)>-1){Am=true;return false;}});if(!Am){Aj=true;}}return Aj;},getDisplayFormsMenu:function(Ai){var Ah=this;return f.getDisplayFormsMenu(Ai,Ah.getHost(),Ah.docModel.datasets,function(Aj){Ah.submitDropZoneUpdates(Aj);});},editDerivedMetric:function(Ah){AW.call(this,Ah,"edit");},newDerivedMetric:function(Ai){var Ah=mstrmojo.all[this.hostId].zonesModel.allowInsertNewMetric(Ai.zone);if(Ai.zone.id===j){Ah=false;}AW.call(this,Ai,"editNew",!Ah);},newDerivedAttribute:function e(An,Aj){var Ao=An.item,Am=f.getUnitFromDataset(this.docModel.datasets,Ao.did,Ao.t)||Ao,Al=this.getHost(),Ai=Al.getChartStyle&&Al.getChartStyle()==="NewGraphMatrixVisualizationStyle",Ak=this,Ah={forceRefresh:true,alias:"New Attribute",precreate:function(Aq){if(Ak.getAddItemActions){var Ap=Ak.getAddItemActions(An.zone,[{did:"$GUID_1",t:12}]);Aq.newObjectIds=["$GUID_1"];if(Aj){Ap=Ak.getRemoveDropZoneUnitActions(An.zone,Am).concat(Ap);}Aq=[Aq,{act:"updateTemplate",keyContext:Al.k,actions:Ap}];}else{Aq=S.copy({act:"addDAToTemplate",nodeKey:Al.k,treeType:Al.defn.tt},Aq);if(An.useDropzone){Aq.useDropzone=true;Aq.dropzones=[{dropzoneId:An.zone.id,position:0}];if(An.item.ax!==undefined){Aq.dropzones[0].ax=An.item.ax;}if(Aj){Aq.dropzones[0].replaceSourceId=Am.did;}}else{Aq.axis=An.axis;}if(Ai){Aq.dropzones.push({dropzoneId:w,position:Ak.getTooltipDropzoneIdx(An.item)+1});}}return Aq;}};this.docModel.controller.openDAE(this,Ah,mstrmojo.emptyFn,Am);},newDynamicLinkAttr:function x(Am,Ai){var An=Am.item,Al=f.getUnitFromDataset(this.docModel.datasets,An.did,An.t)||An,Ak=this.getHost(),Aj=this,Ah={forceRefresh:true,alias:"New Link",precreate:function(Ap){if(Aj.getAddItemActions){var Ao=Aj.getAddItemActions(Am.zone,[{did:"$GUID_1",t:12}]);Ap.newObjectIds=["$GUID_1"];if(Ai){Ao=Aj.getRemoveDropZoneUnitActions(Am.zone,Al).concat(Ao);}Ap=[Ap,{act:"updateTemplate",keyContext:Ak.k,actions:Ao}];}else{Ap=S.copy({act:"addDAToTemplate",nodeKey:Ak.k,treeType:Ak.defn.tt},Ap);if(Am.useDropzone){Ap.useDropzone=true;Ap.dropzoneId=Am.zone.id;if(Am.item.ax!==undefined){Ap.ax=Am.item.ax;}if(Ai){Ap.replaceSourceId=Al.did;}}else{Ap.axis=Am.axis;Ap.pos=Am.idx+2;}}return Ap;}};this.docModel.controller.openDynamicLinkEditor(this,Ah,mstrmojo.emptyFn,Al);},editDerivedAttribute:function(Ak){var Aj=this.getHost(),Am=Ak.item,Ai=f.getUnitFromDataset(this.docModel.datasets,Am.did,Am.t)||Am,Al=this.docModel.findDatasetIdFromUnit(Ai.did),Ah={dsid:Al,did:Ai.did,n:Ai.n,alias:Am.n,forms:Ai.fs,preupdate:function(Ao){var An=Ao.name;Ao.name=Ai.n;Ao=[Ao,z(Aj,[{act:"renameUnit",id:Ai.did,type:12,name:An}],true)];return Ao;}};if(this.isDynamicLink(Am)){this.docModel.controller.openDynamicLinkEditor(this,Ah,mstrmojo.emptyFn);}else{this.docModel.controller.openDAE(this,Ah,mstrmojo.emptyFn);}},getTemplateAttributes:function k(){return W.call(this,12);},getTemplateHierarchies:function Z(){return W.call(this,14);},getTemplateDEs:function AY(){var Ah=this.getHost(),Ai=Ah.model.data.gsi;return Ai.cols.concat(Ai.rows).filter(function(Aj){return Aj.st===Ab.ConsolidationManaged;});},getUnitInfoInTemplate:function n(Ai){var Aj={},Ah=this.getHost().model.data.gts;[{axis:H,name:"row"},{axis:AJ,name:"col"}].forEach(function(Ak){N.forEach(Ah[Ak.name],function(Am,Al){if(Am.id===Ai){Aj.axis=Ak.axis;Aj.axisName=Ak.name;Aj.tplIdx=Al;Aj.unit=Am;return false;}});});return Aj;},sortGrid:function s(An,Al){var Ao=this.getHost(),Ak=An.t,Am=An.did,Ah=null,Aj=null;if(Ak===AQ.DssTypeMetric){Aj=["","","",1];}else{Ah=this.getUnitInfoInTemplate(An.did);Aj=[Ah.unit.fid||(Ah.unit.fs&&Ah.unit.fs[0].id),"21","",Ah.axis];}var Ap=Ah?Ah.axis:H,Ai=Ao.model.data.gts[(Ap===H?"row":"col")+"SubPos"];Ao.controller.onSort(Ao,Ao.model.getSortGridAction(Ai,[Ak,Am].concat(Aj).join("!"),Ap,Al));},addSortMenu:function a(Ai,Am,Aq){var Ap=this,Ar=this.getHost(),As=Ai.item,Aj=Ai.axis,Ak=Ar.model.data,Ah=Ak.gts,Ao=Ak.gsi.tma,An=S.copy(As);if(As.t===AQ.DssTypeFilter){return ;}if(As.t===AQ.DssTypeDimension){N.forEach((Ah.row||[]).concat(Ah.col||[]),function(Au){if(Au.hid===An.did){An.did=Au.id;An.t=Au.otp;return false;}});}if(Aj!==AH||Ao!==H){if(Ai.zone.id!==AH||Ah.col.length<=1){Am.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",function(){Ap.sortGrid(An,true);});Am.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",function(){Ap.sortGrid(An,false);});}if(Ar.isVIXtab&&Ar.model.isRecursiveAttribute(As.did)&&mstrApp&&mstrApp.isAppStateDefault()&&!mstrApp.isDossier){Am.addMenuItem(mstrmojo.desc(15676,"Custom Sort..."),"xt",function(){if(Ar.customSort){Ar.customSort(N.filterOne(Ah.col.concat(Ah.row),function(Au){return Au.id===As.did;}),Aj);}});}}if(Aq){if(!Ar.excludeData){Am.addMenuItem(mstrmojo.desc(11099,"Advanced Sort..."),"xt",function(){if(Aj===AH){Aj=Ao;}Ar.controller.onGetAdvSortData(Ar,Aj,An.t);});}}else{var Al=Ak.gsi.sorts.some(function(Au){return !!Au.length;}),At=mstrmojo.desc(11699,"Clear Sort");if(Al){Am.addMenuItem(At,"",function(){Ap.submitDropZoneTemplateUpdates([{act:"clearSort"}]);});}}},convertToMetric:function o(An){var Am=this.getHost(),Ah=Am.model&&Am.model.data&&Am.model.data.datasetId,Aj=Am.k,Al=Am.defn.tt,Ak=An.item;if(!Ah){mstrmojo.hash.forEach(this.docModel.datasets,function(Ap,Aq){if(mstrmojo.array.find((Ap.att||[]),"did",Ak.did)!==-1){Ah=Aq;return false;}});}var Ai=mstrmojo.mstr.EnumFunction,Ao=AR.call(this,{act:"addShortcutMetric",nodeKey:Aj,treeType:Al,funcType:Ak.formType===2?Ai.FunctionSum:Ai.FunctionCount,units:[{id:Ak.did,type:Ak.t}],prs:[{n:"UseLookupForAttributes",v:"0"}],dsid:Ah,replaceSourceId:Ak.did},An);this.submitActionForDatasetUpdate(Ao);},getAddMetricNameAction:function(Aq,Am){if(!this.gmZones){return null;}var Ao=this,Ai=0,An=false,Al,Ah=Ao.gmZones.getZoneModelByZoneId((Am===H)?AS:F),Ap={n:"Metric Names",did:D,t:0},Ak=S.clone(Ap),Aj=Ao.gmZones.hGetItemOccurrence(Ak,[H,AJ,F,AS,j]);N.forEach(Ah.items,function(Ar){if(Ao.isMetric(Ar)){Ai++;}});if(Aj.length===0&&Ai<=1){An=true;}if(An){Al={act:"updateTemplate",keyContext:Aq.k,actions:Ao.gmZones.getUpdateMetricNameUnitActions(An,Am)};}return Al;},getAggregateByMetricSubMenu:function(Ai){var Am=this,Al=Ai.item,Ap=f.getUnitFromDataset(this.docModel.datasets,Al.did,Al.t)||Al,Ah=this.id,Aq=this.getHost(),Ak=Aq.k,Aj=Aq.defn.tt,An=this.submitActionForDatasetUpdate,Ao=Aq.getChartStyle&&Aq.getChartStyle()==="NewGraphMatrixVisualizationStyle";return f.getAggregateByMenu(Ap,function(Av,At){var As=Am.allowInsertNewMetric(Ai.zone),Ax=[];if(Ai.zone.id===j){As=false;}if(As&&Ai.useDropzone&&Am.gmZones){var Aw=Am.gmZones.getZoneModelByZoneId((Ai.zone.id===AS)?H:AJ);var Au=Am.getAddMetricNameAction(Aq,Aw.id);if(Au){Ax.push(Au);}Au=Am.gmZones.getUpdateGroupInfoActionForNewMetric(Ai.zone.id,Ai.idx+1,Al.ax===0);if(Au){Ax.push(Au);}}var Ar=[];if(I.isFuncHasUseLookupForAttributeProp(At)){Ar=[{n:"UseLookupForAttributes",v:"0"}];}An.call(mstrmojo.all[Ah],Ax.concat(AR.call(Am,{act:"addShortcutMetric",dsid:Ag.call(Am,Ap.did),nodeKey:Ak,treeType:Aj,funcType:At,units:[{id:Av.did,type:Av.t}],prs:Ar},Ai,{offset:As?1:0,replaceSourceId:As?null:Ap.did,addToTooltip:Ao})));});},getCalculationEditorCfg:function AT(Ah){var Am=this,Ap=this.getHost(),Al=this.submitActionForDatasetUpdate.bind(this),Ak=Ap.k,Ao=Ap.model.data.gsi,Ai=Ap.defn.tt,Aq=Am.allowInsertNewMetric(Ah.zone),Aj=[],An=Ap.getChartStyle&&Ap.getChartStyle()==="NewGraphMatrixVisualizationStyle";if(Ah.zone.id===j){Aq=false;}return f.getCalculationMetricEditor(Ao.mx,Ah.item,function(As,Ar,Aw,At){if(Aq&&Ah.useDropzone&&Am.gmZones){var Av=Am.gmZones.getZoneModelByZoneId((Ah.zone.id===AS)?H:AJ);var Au=Am.getAddMetricNameAction(Ap,Av.id);if(Au){Aj.push(Au);}Au=Am.gmZones.getUpdateGroupInfoActionForNewMetric(Ah.zone.id,Ah.idx+1,Ah.item.ax===0);if(Au){Aj.push(Au);}}Al(Aj.concat(AR.call(Am,{act:"addShortcutMetric",dsid:Ag.call(Am,Ah.item.did),nodeKey:Ak,treeType:Ai,funcType:Aw,funcType2:At,units:[As,Ar]},Ah,{offset:Aq?1:0,replaceSourceId:Aq?null:Ah.item.did,addToTooltip:An})));});},submitAddShortcutMetric:function(An,Az){var A1=this,Au=A1.id,Ar=this.getHost(),Ai=Ar.k,Ak=Ar.defn.tt,A2=A1.submitActionForDatasetUpdate,Ax=A1.allowInsertNewMetric(An.zone),Ap=[],As=Ar.getChartStyle&&Ar.getChartStyle()==="NewGraphMatrixVisualizationStyle";if(An.zone.id===j){Ax=false;}if(Ax&&An.useDropzone&&A1.gmZones){var Am=A1.gmZones.getZoneModelByZoneId((An.zone.id===AS)?H:AJ);var Aw=A1.getAddMetricNameAction(Ar,Am.id);if(Aw){Ap.push(Aw);}Aw=A1.gmZones.getUpdateGroupInfoActionForNewMetric(An.zone.id,An.idx+1,An.item.ax===0);if(Aw){Ap.push(Aw);}}var Ay=Az.item,Aq=Az.extraItem,A0=Az.funcType,Aj=Az.funcType2,Ao=Az.breakBys,Ah=Az.sortBys,Al=Az.prs,Av=[{id:Ay.did,type:Ay.t}],At;if(Aq){Av.push(Aq);}At={act:"addShortcutMetric",dsid:Ag.call(A1,Ay.did),nodeKey:Ai,treeType:Ak,funcType:A0,units:Av,breakBys:Ao,sortBys:Ah};if(Aj){At.funcType2=Aj;}if(Al){At.prs=Al;}if(I.isFuncHasUseLookupForAttributeProp(A0)){At.prs=At.prs||[];At.prs.push({n:"UseLookupForAttributes",v:"0"});}Ap=Ap.concat(AR.call(A1,At,An,{offset:Ax?1:0,replaceSourceId:Ax?null:Ay.did,addToTooltip:As}));A2.call(mstrmojo.all[Au],Ap);},getDynamicBreakByAxisOptions:function(Aj){var Al=this,Ak=Al.getHost(),Am=Ak.model.data.gsi,Ah=[],Ai=function Ai(An){return An.some(function(Ao){return Al.isAttribute(Ao)||Al.isNewDerivedElement(Ao)||Al.isCustomGroup(Ao)||Al.isConsolidation(Ao);});};if(Ai(Am.rows)){Ah.push({n:Aj?mstrmojo.desc(3326,"By Columns"):mstrmojo.desc(122,"Columns"),axes_bitmap:d.DssXmlAxisRowsBit,dmy:"@cols"});}if(Ai(Am.cols)){Ah.push({n:Aj?mstrmojo.desc(3327,"By Rows"):mstrmojo.desc(2968,"Rows"),axes_bitmap:d.DssXmlAxisColumnsBit,dmy:"@rows"});}return Ah;},getBreakByAxisOptions:function(Ai){var Ah=[{n:mstrmojo.desc(4531,"Automatic"),axes_bitmap:AD.DssAxisDynamicShortcutRoot+Ac.DssDynamicShortcutAuto,dmy:"@auto"},{n:Ai?mstrmojo.desc(13408,"By None"):mstrmojo.desc(2057,"None"),axes_bitmap:d.DssXmlAxisPagesBit,dmy:"@p"}];if(Ai){Ah.splice(1,0,{isSeparator:true});}return Ah.concat(this.getDynamicBreakByAxisOptions(Ai));},getBreakByAttributeOptions:function(){var Ah=this,Ai=[],Ak=Ah.getTemplateAttributes().concat(Ah.getTemplateDEs()),Aj=Ah.getPageByUnit();Ai=Ai.concat(Ak);if(Aj&&Aj.srcid){if(N.find(Ai,"did",Aj.srcid)===-1){Ai.push({n:Aj.n,did:Aj.srcid,t:Aj.srct});}}return Ai;},getDynamicBreakByOptions:function(Ah){var Ai=this,Aj=Ai.getBreakByAttributeOptions();if(Ah&&Aj.length){Aj.unshift({isSeparator:true});}return Ai.getBreakByAxisOptions(Ah).concat(Aj);},getDynamicLevelOptions:function(){var Ah=this,Aj=Ah.getBreakByAxisOptions(true),Ai=Ah.getBreakByAttributeOptions();Aj.some(function(Ak){if(Ak.axes_bitmap===d.DssXmlAxisPagesBit){Ak.n=mstrmojo.desc(3329,"Grand Total");return true;}});if(Ai.length){Ai.unshift({isSeparator:true});}return Aj.concat(Ai);},getShortcutMetricSubMenu:function(Al){var Ak=this,Ah=new mstrmojo.ui.menus.MenuConfig(),Am=Al.item,Aj=f.getUnitFromDataset(this.docModel.datasets,Am.did,Am.t)||Am,Ai=Ak.allowInsertNewMetric(Al.zone);if(Aj.t===V.Metric){Ak.addRankShortcutMenu(Al,Ah);Ak.addPercentileShortcutMenu(Al,Ah);Ak.addPercentToTotalShortcutMenu(Al,Ah);Ah.addSeparator();Ak.addPercentOfShortcutMenu(Al,Ah);Ak.addPercentChangeShortcutMenu(Al,Ah);Ak.addDifferenceShortcutMenu(Al,Ah);Ah.addSeparator();Ak.addMovingTotalShortcutMenu(Al,Ah);Ak.addRunningTotalShortcutMenu(Al,Ah);Ak.addPercentRunningTotalShortcutMenu(Al,Ah);}Ah.addSeparator();Ah.addMenuItem(mstrmojo.desc(11491,"More Functions..."),"",function(){AW.call(Ak,Al,"add",!Ai);},Aj);return Ah;},hasReplaceCandidates:function(Ah){var Ai=this.getReplaceCandidates(Ah.zone,Ah.item);return Ai&&Ai.length>0;},getReplaceSubMenu:function(Ai,Ak){var Ao,Ap=Ai.item,Al=Ai.zone,Aj=this.getReplaceCandidates(Al,Ap),Am=this;Ao=Ak?[Ak]:[];Ao.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"scrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:Aj,listHooks:{select:function An(Aq,Ar){Am.unitsDropped(Al,{src:{data:{item:Ar,items:[Ar],dsid:Ar.dsId}},getCtxtDragData:function(){var As=this.src;return(As&&As.data)||{};}},{allowedItems:[Ar],idx:N.find(Al.items,"did",Ap.did)===-1?Ap._renderIdx:N.find(Al.items,"did",Ap.did),edge:mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION.ON,removeReplaced:true});if(this.parent&&this.parent.parent&&this.parent.parent.closeAllMenus){this.parent.parent.closeAllMenus();}}}}]});return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"replaceReference",okVisible:false,cancelVisible:false,contents:Ao,onOpen:function Ah(){this.scrollableContainer.updateScrollbars();if(this.hasAccessibility&&this.enableAccessibility){this.enableAccessibility();}}});},addRankShortcutMenu:function q(Ak,Ai){var Aj=this,Am=this.id;function Ah(Ap,Ao,An){Aj.submitAddShortcutMetric(Ak,{item:Ap,funcType:mstrmojo.mstr.EnumFunction.FunctionRank,prs:[{n:"ASC",v:Ao}],breakBys:An});}function Al(An){return f.getRankMetricEditor(An.item,Aj.getDynamicBreakByOptions(),Ah);}Ai.addActionPopupMenuItem(mstrmojo.desc(2789,"Rank"),Am,function(){Ah(Ak.item,"0",[{dmy:"@auto"}]);},Al,"",Ak);},addPercentileShortcutMenu:function p(Aj,Ah){var Ai=this,Am=this.id;function Ak(An){var Ao;if(An.dmy){Ao={dmy:An.dmy};}else{Ao={id:An.did,type:An.t};}Ai.submitAddShortcutMetric(Aj,{item:Aj.item,funcType:mstrmojo.mstr.EnumFunction.FunctionPercentRank,breakBys:[Ao],prs:[{n:"inclusive",v:"False"}]});}function Al(){var Ao=new mstrmojo.ui.menus.MenuConfig(),An=Ai.getDynamicBreakByOptions(true);An.forEach(function(Ap){if(Ap.isSeparator){Ao.addSeparator();return ;}Ao.addMenuItem(Ap.n,"",function(){Ak(Ap);});});return Ao;}Ah.addActionPopupMenuItem(mstrmojo.desc(13409,"Percentile Rank"),Am,function(){Ak({dmy:"@auto"});},Al,"",Aj);},addPercentToTotalShortcutMenu:function AG(Ai,Ao){var Aq=this,Ah=this.id,Au=Ai.item,Av=Aq.getHost(),As=Av.getChartStyle&&Av.getChartStyle()==="NewGraphMatrixVisualizationStyle",Ap=Aq.submitActionForDatasetUpdate.bind(Aq),An=Aq.getDynamicLevelOptions(),Am=Av.k,Aj=Av.defn.tt,At=Aq.allowInsertNewMetric(Ai.zone),Al=[];if(Ai.zone.id===j){At=false;}function Ar(Aw){if(At&&Ai.useDropzone&&Aq.gmZones){var Ay=Aq.gmZones.getZoneModelByZoneId((Ai.zone.id===AS)?H:AJ);var Ax=Aq.getAddMetricNameAction(Av,Ay.id);if(Ax){Al.push(Ax);}Ax=Aq.gmZones.getUpdateGroupInfoActionForNewMetric(Ai.zone.id,Ai.idx+1,Ai.item.ax===0);if(Ax){Al.push(Ax);}}Ap(Al.concat(AR.call(Aq,{act:"addPercentToTotalMetric",nodeKey:Am,treeType:Aj,metric_id:Au.did,axes_bitmap:Aw.axes_bitmap||0,units:Aw.did&&[{id:Aw.did,type:Aw.t}]},Ai,{offset:At?1:0,replaceSourceId:At?null:Ai.item.did,addToTooltip:As})));}function Ak(){var Aw=new mstrmojo.ui.menus.MenuConfig();An.forEach(function(Ax){if(Ax.isSeparator){Aw.addSeparator();return ;}Aw.addMenuItem(Ax.n,"",function(){Ar(Ax);});});return Aw;}Ao.addActionPopupMenuItem(mstrmojo.desc(3323,"Percent to Total"),Ah,function(){Ar({axes_bitmap:AD.DssAxisDynamicShortcutRoot+Ac.DssDynamicShortcutAuto});},Ak,"",Ai);},addPercentOfShortcutMenu:function M(Al,Ah){var Ak=this,Am=this.id;function Aj(Ao,Ap,An){Ak.submitAddShortcutMetric(Al,{item:Ao,funcType:Ap,funcType2:mstrmojo.mstr.EnumFunction.FunctionDivide,breakBys:An,sortBys:[{dmy:"@auto"}]});}function Ai(An){return f.getRelativeReferenceMenu(An.item,mstrmojo.desc(13394,"Percent of:"),Ak.getDynamicBreakByOptions(),Aj);}Ah.addActionPopupMenuItem(mstrmojo.desc(13390,"Percent Of"),Am,function(){Aj(Al.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Ai,"",Al);},addPercentChangeShortcutMenu:function m(Ak,Ai){var Aj=this,Am=this.id;function Al(Ao,Ap,An){Aj.submitAddShortcutMetric(Ak,{item:Ao,funcType:Ap,funcType2:mstrmojo.mstr.EnumFunction.FunctionVar,breakBys:An,sortBys:[{dmy:"@auto"}]});}function Ah(An){return f.getRelativeReferenceMenu(An.item,mstrmojo.desc(146,"From:"),Aj.getDynamicBreakByOptions(),Al);}Ai.addActionPopupMenuItem(mstrmojo.desc(13391,"Percent Change"),Am,function(){Al(Ak.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Ah,"",Ak);},addDifferenceShortcutMenu:function K(Ak,Ah){var Aj=this,Am=this.id;function Ai(Ao,Ap,An){Aj.submitAddShortcutMetric(Ak,{item:Ao,funcType:Ap,funcType2:mstrmojo.mstr.EnumFunction.FunctionMinus,breakBys:An,sortBys:[{dmy:"@auto"}]});}function Al(An){return f.getRelativeReferenceMenu(An.item,mstrmojo.desc(146,"From:"),Aj.getDynamicBreakByOptions(),Ai);}Ah.addActionPopupMenuItem(mstrmojo.desc(11495,"Difference"),Am,function(){Ai(Ak.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Al,"",Ak);},addMovingTotalShortcutMenu:function AI(Aj,Ah){var Ai=this,Am=this.id;function Al(Aq,Ap,Ao,An){Ai.submitAddShortcutMetric(Aj,{item:Aq,funcType:Ap,breakBys:An,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"3"},{n:"OLAPWinStOffset",v:Ao.toString()},{n:"OLAPWinEndType",v:"2"}]});}function Ak(An){return f.getMovingTotalMenu(An.item,Ai.getDynamicBreakByOptions(),Al);}Ah.addActionPopupMenuItem(mstrmojo.desc(13392,"Moving Average"),Am,function(){Al(Aj.item,mstrmojo.mstr.EnumFunction.FunctionOLAPAvg,1,[{dmy:"@auto"}]);},Ak,"",Aj);},addRunningTotalShortcutMenu:function AZ(Al,Ah){var Ak=this,Am=this.id;function Aj(Ap,Ao,An){Ak.submitAddShortcutMetric(Al,{item:Ap,funcType:Ao,breakBys:An,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"0"},{n:"OLAPWinEndType",v:"2"}]});}function Ai(An){return f.getRunningTotalMenu(An.item,Ak.getDynamicBreakByOptions(),Aj);}Ah.addActionPopupMenuItem(mstrmojo.desc(11906,"Running Total"),Am,function(){Aj(Al.item,mstrmojo.mstr.EnumFunction.FunctionOLAPSum,[{dmy:"@auto"}]);},Ai,"",Al);},addPercentRunningTotalShortcutMenu:function B(Ak,Ai){var Aj=this,Am=this.id;function Ah(Ap,An){var Ao=[];An.forEach(function(Aq){if(Aq.dmy){Ao.push({dmy:Aq.dmy});}else{Ao.push({id:Aq.did,type:Aq.t});}});Aj.submitAddShortcutMetric(Ak,{item:Ap,funcType:mstrmojo.mstr.EnumFunction.FunctionOLAPSum,funcType2:mstrmojo.mstr.EnumFunction.FunctionDivide,breakBys:Ao,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"0"},{n:"OLAPWinEndType",v:"2"}]});}function Al(Ap){var Ao=new mstrmojo.ui.menus.MenuConfig(),An=Aj.getDynamicLevelOptions();An.forEach(function(Aq){if(Aq.isSeparator){Ao.addSeparator();return ;}Ao.addMenuItem(Aq.n,"",function(){Ah(Ap.item,[Aq]);});});return Ao;}Ai.addActionPopupMenuItem(mstrmojo.desc(13393,"Percent Running Total"),Am,function(){Ah(Ak.item,[{dmy:"@auto"}]);},Al,"",Ak);},getMultipleMetricsCalcMenus:function u(Ao,An,Aq){var Ap=this,Ar=this.getHost(),Am=this.submitActionForDatasetUpdate.bind(this),Ak=Ar.k,Ai=Ar.defn.tt,Aj=An.map(function(As){return As.did;}),Ah=Ao.items.map(function(As){return As.did;}),Al=-1;Aj.forEach(function(As){var At=N.indexOf(Ah,As);if(At>Al){Al=At;}});return f.getMultipleMetricsCalculationMenus(An,Ar.model.data.datasetId,function(Au){var At={act:"addShortcutMetric",dsid:Ag.call(Ap,Aj),nodeKey:Ak,treeType:Ai,funcType:Au.funcType,funcType2:Au.funcType2,units:Au.items.map(function(Aw){return{id:Aw.did,type:Aw.t};}),position:Al+2,partialRetrieval:{nodes:[Ak]}},Av=[],As;if(Aq){At.useDropzone=Aq;At.dropzoneId=Ao.id;}Av.push(At);if(Ap.gmZones){As=Ap.gmZones.getUpdateGroupInfoActionForNewMetric(Ao.id,Al+1,true);}if(As){Av.push(As);}Am(Av);});},getCreateOrEditElementGroupFunc:function Af(Ai){var Ah=this;return function(){var Am=Ah.getHost(),An=Am.model,Al=Ai.item,Ak=Al.did,Aj=Ah.getUnitInfoInTemplate(Ak),Ap="$GUID_1",Ao=Aj.unit.ost===Ab.ConsolidationManaged&&An.docModel.getDEObject(Ak);Am.controller.openDEEditor(Am,Ao?{deObj:Ao}:{dsId:An.data.datasetId,attId:Ak,attName:Al.n,deId:Ap,getExtraSaveActions:function(){var Aq=Ai.zone,Ar=Ah.getRemoveDropZoneUnitActions(Aq,Al);Ar.push(Ah.getAddDropZoneUnitAction(Aq,{did:Ap,t:AQ.DssTypeConsolidation},Ai.idx));return Ah.getUpdateTemplateAction(Ar);}});};},buildThresholdMenuOptions:function t(Ai,Aj,Ah){mstrmojo.all[this.hostId].model.buildThresholdMenuOptions(Ai,Aj,Ah,this.canSupportImageThreshold());},canSupportImageThreshold:function L(){return false;},getNumberFormatEditorCfg:function Q(Ah){return mstrmojo.all[this.hostId].model.getNumberFormatEditorCfg(Ah);},submitUpdatesAndPersistWidgetXMLIfNecessary:function Ae(Ak,Aj,Ai){var Ah=Ak.model.docModel,Al=Ah.getDataService(),An,Am;if(!Ak.isXMLDirty()){Ak.controller.onSubmitTemplateUpdates(Ak,Aj,Ai);}else{Am={act:"updateTemplate",keyContext:Ak.k,actions:Aj};An=Ak.getPersistAction();Al.submitUpdates([Am,An],mstrmojo.func.wrapMethods(Ak.controller._getXtabCallback(Ak),Ai));Ak.resetXMLDirtyFlag();}},submitActionForDatasetUpdate:function AO(Ai){var Ah=this.docModel;this.submitDropZoneUpdates(Ai,mstrmojo.func.wrapMethods(Ah.getDatasetsUpdateCallback(),Ah.controller._getXtabCallback(this.getHost())));},getVFNotifierBlackList:function AX(Aj,Ah){var Ai=11,Ak=12;switch(Aj){case"XtabGrid":return[g.Rows,g.Columns];case"GraphMatrixVisualizationStyle":case"NewGraphMatrixVisualizationStyle":if(Ah){return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.BreakBy,g.SliceBy,g.Angle,Ai,Ak];}else{return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.BreakBy,g.SliceBy,g.Angle];}case"VIHeatMapVisualizationStyle":return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.Grouping];case"NetworkVisualizationStyle":return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.FromItem,g.ToItem];case"ImageLayoutVisualizationStyle":return[g.GeoAttribute,g.Layout];case"GoogleMapVisualizationStyle":case"ESRIMapVisualizationStyle":case"MapboxVisualizationStyle":return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.SliceBy,g.Angle,g.GeoAttribute,g.Latitude,g.Longitude];case"KPICardVisualizationStyle":return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.Metric,g.BreakBy];default:return[];}},supportWebSort:function AA(){return !(mstrApp.isVI&&!mstrmojo.resolveFeature("web-sort"));}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabModel","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.models.template.DataInterface","mstrmojo.vi.models.EnumDragSources","mstrmojo.array","mstrmojo.expr","mstrmojo.func","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.fe.FilterUtils","mstrmojo.vi.enums.EnumVisFilterType","mstrmojo.EnumRWUnitType","mstrmojo.models.FormatModel","mstrmojo.models.template.DataInterface","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes");var M=mstrmojo.expr,Q=M.FN,U=M.ET,Y=mstrmojo.hash,t=mstrmojo.array,z=mstrmojo.vi.models.EnumDragSources,AL=mstrmojo.fe.FilterUtils.getExprXml,C=mstrmojo.fe.FilterUtils.isExprEmpty,AE=mstrmojo.vi.ui.DatasetUnitMenuUtils,n=mstrmojo.array,a=mstrmojo.string,AM=mstrmojo.models.FormatModel,O=AM.ENUM_PROPERTY_NAMES,AA=mstrmojo.vi.enums.EnumVisFilterType,X=mstrmojo.EnumRWUnitType,AK=mstrmojo.models.template.DataInterface,AR=AK.ENUM_GRID_RESIZE.FIT_TO_CONTENTS,I=mstrmojo.warehouse.EnumObjectTypes,y=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,j=mstrmojo.vi.enums.EnumFeatures,l=mstrmojo.elementHelper;var L=4,i=12,AB="-1";var B=3;var d=[O.GRID_VERTICAL_PADDING,O.GRID_HORIZONTAL_PADDING],q={},g="tp",R="lp";q[O.GRID_VERTICAL_PADDING]=g;q[O.GRID_HORIZONTAL_PADDING]=R;function K(AS){return AS.docModel.controller.cmdMgr;}function w(AV,AX){var AY=AV.xtab.k,AU=AV.docModel,AT=AU.getSelectedViUnit(),AS=AT&&AT.boxContent,AW=!(AS&&AS.isInFilterPanel&&AS.isInFilterPanel());return[AY].concat(AW?AU.getSourceFilterKeys(AY,true):[]);}function f(AV,AT,AU,AW,AS){AT.reverse().forEach(function(AX){AW.push(AV.model.getClearThresholdAction(AU,AS,AX.tid));});}mstrmojo.vi.models.DocXtabModel=mstrmojo.declare(mstrmojo.DocXtabModel,[mstrmojo.vi.ui._CanDropFromSchema],{scriptClass:"mstrmojo.vi.models.DocXtabModel",getUnHiddenDrillPathsForCell:function AG(AS,AW){var AU=this.getAllDrillPathsForCell(AS,AW),AV=this.docModel.datasets,AT=function(AX,Aa){var AY=n.find(AX,"did",Aa.id),AZ=AX[AY];if(AZ&&!AZ.hide){Aa.n=AZ.n;return true;}return false;};return n.filter(AU,function(AZ){var AX;for(AX in AV){var AY=AV[AX];if(AT(AY.att,AZ)){return true;}}return false;});},getAllDrillWithinPathsForCell:function o(AS,AV,AU){var AT=AU?this.getUnHiddenDrillPathsForCell(AS,AV):this.getAllDrillPathsForCell(AS,AV);return AT.filter(function(AW){return !!AW.within;});},sort:function AN(AU,AV){var AS=this;K(this).execute({execute:function AT(){var AW=AS.xtab.k;this.submit(AS.docModel.getDataService().getUpdateTemplateAction(AW,{act:"sort",sorts:AU.sorts,nodeKey:AW,subTotalsPos:AU.stp||AS.getSubTotalsPos(),stt:AU.stt||-1}),AV);}});},customSort:function AO(AV,AW,AS){var AT=this,AV=Y.clone(AV);K(this).execute({execute:function AU(){var AX=AT.xtab.k;this.submit(AT.docModel.getDataService().getUpdateTemplateAction(AX,AV),AW,AS);}});},drillGrid:function s(AU,AV){var AS=this;K(this).execute({execute:function AT(){this.submit(AS.docModel.getDataService().getDrillGridAction(AU),AV);}});},getClearThresholdAction:function F(AU,AS,AT){return{act:"clearThreshold",unitId:AU,unitType:AS,tid:AT};},getCreateSimpleThresholdAction:function W(AX,AV,AS,AW,AU,AT){return{act:"threshold",nodeKey:AV,thresholds:AX,thresholdType:AW,basedOnId:AU||AS,did:AS,objType:AT};},getZoneFormatAction:function N(Ad,Af,Aa,AW){var AY=AW&&AW.skipSubtotals,AU=AW&&AW.isSubtotalFormat,Ac=AW&&AW.isSubtotalUseGridFormatting,Ab=[],AV=[],AZ="h",AS="g",Ae="sh",AX="sg",AT=function(Ag,Ah){AV.push({axis:Ag,regions:Ah});};if(AU){if(Ad==="ch"){AT(2,[Ae]);}else{if(Ad==="rh"){AT(1,[Ae]);}else{if(Ad==="va"){AT(1,[AX]);AT(2,[AX]);}}}}else{if(Ad==="ch"){AT(1,[AZ]);AT(2,!AY&&Ac?[AZ,AS,Ae]:[AZ,AS]);}else{if(Ad==="rh"){AT(1,!AY&&Ac?[AS,Ae]:[AS]);}else{if(Ad==="va"){this.data.gsi.mx.forEach(function(Ag){Ab.push({unitId:Ag.did,unitType:4,regions:[AS]});});if(!AY&&Ac){AT(1,[AX]);AT(2,[AX]);}}}}}return{act:"formatGridZone",nodeKey:Aa,props:Af,units:Ab,axis:AV};},getApplyGridCellFormatToSubtotalAction:function S(AU){var AT={},AV,AY=this.xtab,AX=AY.gridInfo.fmts,AW=AX[AU];var AS;Y.forEach(AW,function(Aa,AZ){AS=AM.getFormatPropertyInfo(AZ);if(AS&&AS.ps!==AM.ENUM_PROPERTY_SETS.FORMATTING_NUMBER){AT=Y.mergeHashes(AT,AM.getFormatUpdate(AZ,(AS.pt==B)?Aa:AM.decodeValue(AZ,Aa)));}});AV=AY.model.getZoneFormatAction.call(AY.model,AU,AT,AY.k,{isSubtotalFormat:true});return AV;},getSelectorDataFromTemplateLimit:function P(AS){return this.getSelectorDataFromViewFilter(AS);},getSelectorDataFromViewFilter:function AD(AV){var AS=[],AW="The expression is not supported by the View Filter Exception Parser.",AT=function AT(Aa){if(l.isNullElem(Aa.id)&&a.isEmpty(Aa.v)){throw AW;}},AZ=function AZ(Ac){var Aa=null;if([U.AE,U.ANDOR].indexOf(Ac.et)>-1||(Ac.et===U.AQ&&Ac.fn===Q.IS_NULL)){if(!Ac){return true;}var Ab=Ac.nds;Aa=!(Ac.not||Ac.fn===Q.NOT||Ac.fn===Q.NOT_IN_LIST);if(Ab){Ab.every(function(Ad){Aa=Aa&&AZ(Ad);});}}else{throw AW;}return Aa;},AY=function AY(Ac){var Aa=false;if([U.AE,U.ANDOR].indexOf(Ac.et)>-1||(Ac.et===U.AQ&&Ac.fn===Q.IS_NULL)){Aa=(Ac.fn===Q.DESCENDANT);var Ab=Ac.nds;if(Ab){Ab.every(function(Ad){Aa=Aa||AY(Ad);});}}else{throw AW;}return Aa;},AU=function AU(Ac,Ae,Ag){var Ai=Ac&&Ac.nds,Ab=Ac.fn===Q.OR;Ag=Ag||Ae;if(Ai&&Ai.length){var Ad=Ae;Ai.forEach(function(Aj){if(Ab){Ad=[];}AU(Aj,Ad,Ag);if(Ab&&Ad.length>0){Ae.push(Ad);}});}else{if(Ac.fn===Q.IS_NULL){var Ah=Ac.a=Ac.a||{n:"Null Attribute",did:""};Ae.push({tn:Ah.n,tid:Ah.did,eid:null,v:""});}else{if(Ac.et===U.AE){var Aa=Ac.es||[];var Af=Aa.length;if(Af===1){AT(Aa[0]);Ae.push({tn:Ac.a.n,tid:Ac.a.did,eid:Aa[0].v,v:Aa[0].n});}else{if(Ag){Aa.forEach(function(Aj){AT(Aj);Ag.push([{tn:Ac.a.n,tid:Ac.a.did,eid:Aj.v,v:Aj.n}]);});}}}}}return Ae;};try{if(AV){(AV.nds||[]).forEach(function(Aa){var Ab=AU(Aa,[]);if(Ab.length>0){AS.push({keepOnly:AZ(Aa),isBranch:AY(Aa),data:Ab});}});}}catch(AX){if(AX!==AW){console.error("vi.models.DocXtabModel: Encountered a problem parsing the view filter expression ("+AX+")");}else{return[];}}return AS;},getRemoveMetricLimitsAction:function AJ(AS){var AU=[],AV=[],AT=function AT(AX,AY){if(!AX){return ;}var AW=AX.nds;if(AW){AW.forEach(function(Aa){var AZ=Aa.m;if(AZ!==undefined){AY.push(AZ.did);}else{AT(Aa,AY);}});}};if(AS){AT(AS,AU);AU.forEach(function(AW){AV.push({act:"removeMetricLimits",unitId:AW});});}return AV;},getAddTemplateUnitAction:function E(AW,AX,AU,AS){var AV=this._super(AW,AX,AU,AS),AT=w(this,AV);if(AT.length>0){AV.partialRetrieval={nodes:AT};}return AV;},getRemoveTemplateUnitAction:function AI(AU){var AT=this._super(AU),AS=w(this,AT);if(AU.axis!==undefined&&AU.unitPos!==undefined){AT.axis=AU.axis;AT.unitPos=AU.unitPos;}if(AS.length>0){AT.partialRetrieval={nodes:AS};}return AT;},getAdvancedPropertiesAction:function W(AS){return{act:"advancedProperties",props:AS};},canShowCellMenu:function AC(AS){return true;},isSubtotalValue:function D(AS){var AT=this.getCellDataUnion(AS);return !AS.stt&&AT.some(function(AU){return !!AU.isSubtotal;});},getKeepOnlyActionsForAssociatedNodes:function AF(AT,AZ,AV){var AS=this.docModel,AY=[AS.getKeepOnlyOrExcludeAction(this.xtab.k,AT)],AU=!!AV?AV:this.xtab,AX=!mstrApp.isInVFConfigMode?(AU.getAssociatedNodes&&AU.getAssociatedNodes()||[]):[];AZ=mstrmojo.func.wrapMethods(AZ,{success:function AW(){n.forEach(AX,function(Ab){var Aa=AS.getPanel().getUnitByKey(Ab.k);if(Aa&&Aa.boxContent){Aa.boxContent.raiseEvent({name:"regenerateToolbar"});}});}});n.forEach(AX,function(Aa){AY.push(AS.getKeepOnlyOrExcludeAction(Aa.k,AT));});return{actions:AY,callback:AZ};},getSaveViewFilterAction:function V(AT,AS){return{act:"saveViewFilter",nodeKey:(AT&&AT.k)||this.xtab.k,expr:C(AS)?'<exp><nd et="14" fn="19"></nd></exp>':AL(AS)};},getClearLinkingAction:function x(AS){var AV=[],AY=this.docModel,Aa=AS.k,AW=AY.getCurrentLayoutKey(),AZ=(AY.defn.layouts).filter(function(Ac){return Ac.k===AW;})[0],AX=AZ.cgbMap||{},AU=AZ.units||{},Ab,AT=Y.keyarray(AX).filter(function(Ac){if(AX[Ac]===Aa){Ab=AU[Ac];return Ab&&Ab.isNavigation;}return false;});n.forEach(AT,function(Ac){AV.push({act:"clearUCNodeCondition",nodeKey:Ac});});return AV;},getClearFiltersForVisActions:function m(Ae,Ad,AV,Ac){var Af=this.docModel,Ab=Af.getDataService(),AT=Ae.model,AW=Ae.gridData||Ae.model.data||Ae.node.data,AS=AW.vfexpr,AY=AW.vlexpr,AX=(Ad&&Ad.k)||this.xtab.k,Aa={actions:[],callback:Ac};AV=[].concat(AV);if(AV.indexOf(AA.KEEP_ONLY)>-1){Aa=AT.getKeepOnlyActionsForAssociatedNodes([],Aa.callback,Ad);}if(AV.indexOf(AA.ADV_QUALIFICATION)>-1){if(AY){Aa.actions.push(Ab.getUpdateTemplateAction(Ae.k,AT.getRemoveMetricLimitsAction(AY)));}if(AS){var AU=AV.indexOf(AA.DRILLING);if(AU>-1){Aa.actions.push(AT.getSaveViewFilterAction(Ad));AV.splice(AU,1);}else{Aa.actions.push(AT.getSaveViewFilterAction(Ad,Af.getVfexprWithUpdatedVf(AX)));}}}if(AV.indexOf(AA.DRILLING)>-1){var AZ=Af.getVfNdFromExpr(AS)||{et:14,nds:[]};Aa.actions.push(AT.getSaveViewFilterAction(Ad,AZ));}if(AV.indexOf(AA.LINKING)>-1){Aa.actions=Aa.actions.concat(AT.getClearLinkingAction(Ae));Aa.extras={style:{params:{treesToRender:3}}};}return Aa;},getObjectInfo:function H(AS){var AU=this.xtab.zonesModel,AT=null;if(AU){(AU.getDropZones().zones||[]).some(function(AV){return !!AV.items.some(function(AW){if(AW.did===AS){AT=AW;return true;}});});}else{AT=this._super(AS);}return AT;},getObjectInfoFromDataset:function H(AS){var AT;Y.forEach(this.docModel.datasets,function(AU){if(!AT){AT=(AU.mx.concat(AU.att)).filter(function(AV){return AV.did===AS;})[0];}});return AT;},hasDerivedElements:function A(AS){var AT=this.getObjectInfo(AS);return !!(AT&&AT.de);},isRecursiveAttribute:function u(AS){var AU=this.docModel.getDEObject(AS),AT=this.getObjectInfoFromDataset(AU?AU.attId:AS)||this.getObjectInfo(AU?AU.attId:AS);return AT&&AT.t===12&&AT.st===3076;},getNDEFormsFromDataset:function G(AT){var AS=this.getObjectInfoFromDataset(AT);return AS&&AS.fs;},hasRecursiveAttribute:function AH(AS){var AT=this,AU=(AS||this.data).gsi||{};return(AU.rows||[]).concat(AU.cols||[]).some(function(AV){return AT.isRecursiveAttribute(AV.did);});},hasSameRecursiveAttributeGroup:function p(AW,AU,AT){var AS=this.docModel,AY=AW.did,AV=AS.getDEObject(AY),AX=(AU||this.data).gsi||{};if(this.isRecursiveAttribute(AY)){return n.filterOne((AX.rows||[]).concat(AX.cols||[]),function(Ab){var AZ=Ab.did,Aa=AS.getDEObject(AZ);return n.find(n.ensureArray(AT),"did",AZ)<0&&(AZ!==AY)&&(AV?AV.attId:AY)===(Aa?Aa.attId:AZ);});}return false;},supportsViewFilterActions:function b(AS){var AT=this.getObjectInfo(AS);return AT&&!AT.de&&(AT.t!==1)&&(AT.t!==47||AT.st===12033);},addEditNodeForDatasetAction:function c(AT,AS){this.augmentDropContextForSchema(AT,this.docModel);var AW=AT.getCtxtDragData(),AV=AW.src;if(AV===z.DATASETS||AV===z.ALL_OBJECT_LIST){var AU=AT.getCtxtDragData().dsid,AX=AT.actions||[];if(AU){AX.push({act:"editNode",nodeKey:AS,datasetId:AU});}AT.actions=AX;}},getCurrentUnitAxisAndPosition:function AP(AS){return new mstrmojo.models.template.DataInterface(this.data).getUnitById(AS)||null;},getNumberFormatEditorCfg:function k(AT){var AX=this,AS=AX.xtab,AV=AX.data,AU=(AV.gnf||[]).concat(AV.gnfu),Ab=AT.item,Aa=n.find(AU,"id",Ab.did),AY=Aa===-1?{}:AU[Aa],AW=AS&&(!AS.defn.vis||!AS.defn.vis.ve);var AZ=AE.getNumberFormatEditor(AT.item,AY,function(Ag){var Ae=AX.docModel.getNumberFormatAction(Ab.did,Ab.t,Ag),Ad=!!Ae.partialRetrieval,Af,Ac;if(Ad){Af=mstrmojo.DocDataService.REQUEST_DEFN_DATA;Ac={treesToRender:3};}AS.controller.submitUndoRedoTemplateUpdates(AS,Ae,AX.docModel.controller._getXtabCallback(AS,undefined,Ad),Af,Ac);});return AZ;},showNumberFormat:function(Aa){var Ab=[1,2,8,9,11],AY;if(Aa.t===12){var AT=this.xtab.node.data,AS=AT&&AT.gts,AU=new mstrmojo.models.template.DataInterface(AT),AX=AS&&(AU.getRowTitles().titles||[]).concat(AU.getColTitles().titles||[]),AZ=n.filterOne(AX,function(Ac){return Aa.did===Ac.id;}),AW=((AZ&&AZ.fs)||[]).map(function(Ac){return Ac.id;});AY=(Aa.fs||[]).some(function(Ac){return Ab.indexOf(Ac.bftp)!==-1&&AW.indexOf(Ac.fid||Ac.id)!==-1&&!Ac.fgr;});}var AV=mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(j.NUMBER_FORMATTING);return(Aa.t===4&&Aa.did!==AB&&AV)||AY;},openThresholdEditor:function(Ag,AW,Ac){var AV=this,AT=AV.xtab,Ae=AV.docModel,Ab=AV.data,Ad=Ab.gsi,Aa=Ag.did||Ag.id,AS=mstrmojo.desc(3647,"Thresholds");if(Ag.t===L||Ag.t===i){var AZ=Y.clone(Ad.mx),AY;AZ.forEach(function(Ah){Ah.t=4;});AY=Ad.rows.concat(Ad.cols,AZ).filter(function(Aj){var Ah=Aj.t,Ak=Aj.st,Ai=Aj.did;return !((Ah===1&&Ak===257)||(Ah===47&&Ak===12032)||(AV.hasDerivedElements(Ai))||(Ai==="-1")||(Ah===14));});AY.forEach(function(Aj){if(Aj.t===12){var Ai=this.getObjectInfo(Aj.did);Aj.da=Ai?Ai.da:undefined;}else{if(Aj.t===47&&Aj.st===12033){var Ai=this.getObjectInfo(Aj.did);Aj.ndetype=Ai.ndetype;}else{if(Aj.t===4){var Ah=this.getObjectInfoFromDataset(Aj.did);Aj.dt=Ah&&Ah.dt;}}}},this);if(Aa!==AB){AS+=" - "+Ag.n;}var AX=mstrmojo.threshold.ThresholdModel.FEATURES,Af=new mstrmojo.threshold.ThresholdController({metricId:Aa,objectType:Ag.t,title:AS,data:Ab,targets:AY,messageId:Ae.mid,datasets:Ae.datasets,dataService:Ae.getDataService(),supportsFeature:function AU(Aj){switch(Aj){case AX.SHOW_ADVANCED_EDITOR:return !AW;case AX.SHOW_BASED_ON:return !AW;case AX.SHOW_IMAGE:return Ac;case AX.SHOW_VALUE_ITEM:var Ai=AV.getObjectInfoFromDataset(this.model.basedOnId),Ak=Ai&&Ai.dt,Ah=[8,9,10,14,15,16,30];return !Ak||Ah.indexOf(Ak)===-1;}},onSubmitActions:function(Ap,Aj,Ai,Ak,An,Ao,Ah){var Am=this,Al=[];if(Aj){f(AT,Aj,Ai,Al,Ah);}Al.push(AV.getCreateSimpleThresholdAction(Ap,AT.k,Ai,An,Ak,Ah));AT.controller.submitUndoRedoTemplateUpdates(AT,Al,{success:function(){if(Ao){Am.set("data",AV.data);Am.openEditor();Ao=false;}}});},onSaveThresholds:function(Aj,Ah,Ai,Al,Ak){this.dataService.saveThresholds(Y.copy(Al,{thresholds:JSON.stringify(Aj),basedOnId:Ah,thresholdType:Ai}),Ak,{hideFailureErr:true});},onLoadThresholds:function(Ai,Aj){var Ah=this.model;this.dataService.getThresholds({thresholdsID:Aj},{success:function(Ap){var Ao=Ap.thresholds,Al=[],Ak,Aq,An={};n.forEach(Ao||[],function(Ar){Ak=M.findTargets(Ar.expr,"did");Aq=true;Y.forEach(Ak,function(As,At){if(!AV.getObjectInfo(At)){An[At]=As.n;Aq=false;}});if(Aq){Al.push(Ar);}});if(!Y.isEmpty(An)){var Am=Y.valarray(An);mstrmojo.alert(mstrmojo.desc(15431,"The following objects: # are not on the visualization, so some thresholds will not be loaded...").replace("#",Am.join(",")));}Ah.addThresholds(Al);}});}});if(Ag.t===i){Af.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;}Af.openEditor();}},buildThresholdMenuOptions:function e(AX,AT,AW,Ad){var AV=this,AS=AV.xtab,Ac=AV.data,Ae=Ac.gsi,AU=Ae.thresholds,Af=AT.item,Ab=Af.did,Aa=AU&&AU[Ab],AY=mstrmojo.desc(13261,"Clear Thresholds"),AZ=AS.excludeData;if((!AZ&&Af.t===L)||Af.t===i&&!AV.docModel.isOldDEObject(Ab)){AX.addMenuItem(mstrmojo.desc(6050,"Thresholds..."),"",function(){AV.openThresholdEditor(Af,AW,Ad);},this);if(Ab!==AB){if(Aa){AX.addMenuItem(AY,"",function(){var Ag=[];f(AS,Aa,Ab,Ag,Af.t);AS.controller.submitUndoRedoTemplateUpdates(AS,Ag);},this);}}}},moveSubTotals:function Z(AS,AT){var AU=this;K(this).execute({execute:function AV(){var AX=AU.xtab,AW=AX.k;this.submit(AU.docModel.getDataService().getUpdateTemplateAction(AW,AU.getMoveSubTotalAction(AS.data,AT,AW)),AX.controller._getXtabCallback(AX));}});},getAttributeFormsInTemplate:function(AU){var AS=this.data.gts,AT=[];(AS.row||[]).concat(AS.col||[]).forEach(function(AV){if(AV.id===AU&&AV.fs){AT=AT.concat(AV.fs);}});return AT;},getPivotFormAction:function(Ac,AT,AY){var AU=this.getCellTitleInfo(Ac),AZ=AU.title,AV=AZ.fs,AW=AZ.id,AX=this.getAttributeFormsInTemplate(AW),Ab=(AZ.fix&&AZ.fix-1)||(Ac.fi||0),AS=AX[Ab],Aa;if(AT==="l"){Aa=Ab-1;}else{if(AT==="r"){Aa=Ab+1;}}return{act:"pivot",unitPos:Aa+1,attFormId:AS.id,unitId:AW,unitType:AY||"",originUnitPos:Ab+1};},getValuesDefaultFormatGridZoneAction:function(AZ,AW){var AU={},Ag,Ae=this.xtab,AX=Ae&&Ae.gridInfo,AT=AX&&AX.fmts,AY=[],Ad,AV={};Y.forEach(AZ,function(Ah){AY.push({unitId:Ah.did,unitType:L,regions:["g"]});});if(AT){var Aa=AT.va,Ac=AT.rh,AS=AT.ch;Y.forEach(AT.va,function(Ai,Ah){Ad=AM.getFormatPropertyInfo(Ah);if(Ad&&Ad.ps!==AM.ENUM_PROPERTY_SETS.FORMATTING_NUMBER){AU=Y.mergeHashes(AU,AM.getFormatUpdate(Ah,(Ad.pt==B)?Ai:AM.decodeValue(Ah,Ai)));}});var Af=Aa[g]?Aa:(Ac[g]?Ac:AS),Ab;t.forEach(d,function(Ah){Ad=AM.getFormatPropertyInfo(Ah);if(Ad){Ab=Af[q[Ah]];AU=Y.mergeHashes(AU,AM.getFormatUpdate(Ah,AM.decodeValue(Ah,Ab)));}});}AV.skipSubtotals=AW;Ag=Ae.model.getZoneFormatAction.call(Ae.model,"va",AU,Ae.k,AV);Ag.units=[].concat(AY);return Ag;},getRAExpandAction:function J(AT,AY,AV){var AX=this.getCellTitleInfo(AT).title.id,AW=this.docModel.getDEObject(AX),AS={act:"raExpandCollapse",sliceId:AY,depth:AT.dpt,ordinal:(AT.o!==undefined)?AT.o:AT._ei,id:AT._e&&AT._e.id,isExpand:AV?1:(AT.epd?0:1)},AU=w(this);if(AV){AS.expand_dsts=1;}AS[AW?"deId":"attId"]=AX;if(AU.length>0){AS.partialRetrieval={nodes:AU};}return AS;},getRAExpandAllAction:function AQ(AW,AV){var AU=this.docModel.getDEObject(AW),AS={act:"raExpandCollapseAll",isExpandAll:AV?1:0},AT=w(this);AS[AU?"deId":"attId"]=AW;if(AT.length>0){AS.partialRetrieval={nodes:AT};}return AS;},getCreateCSVizActions:function h(AT,AU,Ak,AS){var Aa=[],AZ=[],Ah=this.docModel,Ae=Ah.getDataService(),Ab=Ah.getVizContentPanel(),AY=Ab.k,Ao=this.xtab,AX=Ao.k,AW=Ao.parent;Aa.push({act:"macroCopyUnit",newKey:Ak,unitType:X.GRID,unitKey:AX,toKey:AY,partialRetrieval:{nodes:[Ak]}});var Ai=Ah.clearVisAsFilterAction(AW),Af=Ai&&Ai.actions;t.forEach(Af,function(Ap){if(!Ap.controlKey){Ap.nodeKey=Ak;Aa.push(Ap);}});var Ad=AW.parent.children,Ac,AV=Ao.getFilterType()===1;t.forEach(Ad,function(Ar){if(t.find(Ar.defn&&Ar.defn.an,"k",AX)!==-1){Aa.push({act:"associateNodes",nodeKey:Ar.k,targetKeys:[Ak]});var Aq=Ar.boxContent.selectorControl;if(Aq){var Ap=As===undefined||AV,As=Ap?Ah.getNextKey():As;Aa.push({act:"addVisToFilter",parentKey:AX,targetKey:Ak,ctrlKey:Aq.ckey,newCGB:Ap,cgbKey:As});}}});t.forEach(Ad,function(Aq){var Ap=Aq.defn,Ar=(Ap&&Ap.tks||"").split("\u001E");t.forEach(Ar,function(As){if(As===AX){var Av=Ap.ck,Au=Ap.srct,At=Ap.srcst,Aw=(Au===I.Consolidation&&At!==y.ConsolidationManaged)||Au===I.Filter;Aa.push(Ae.getAddCtrlTargetAction(Av,Ak,Ak,Aw));}});});var Aj=this.data,Al=Aj.gsi,Am=this,Ag=function(Ap,Aq){t.forEach(Ap,function(As,Ar){if(As.did==="-1"){t.forEach(Al.mx,function(Aw,Au){var Av=Y.copy(Aw);Av.axis=-1;Av.unitPos=Au+1;AZ.push(Am.getRemoveTemplateUnitAction(Av));});}else{if(As.did!==AT.id){var At=Y.copy(As);At.axis=Aq;At.unitPos=Ar+1;AZ.push(Am.getRemoveTemplateUnitAction(At));}}});};Ag(Al.rows,1);Ag(Al.cols,2);if(AU===2){AZ.push(this.getPivotUnitAction(1,0,AT.id,12,2,0));}AZ.push({act:"advancedProperties",props:{"Template Formatting":{ShowColumnHeaders:"-1",LockColumnHeaders:"-1"}}});var An=new AK(Aj);if(An.getColResizeScenario()!==AR){AZ.push({act:"changeXtabColWidthScenario",value:AR});}if(AS){AZ=AZ.concat(AS);}t.forEach(AZ,function(Ap){delete Ap.partialRetrieval;});Aa.push(Ae.getUpdateTemplateAction(Ak,AZ));return Aa;},getUnitNameInDataSet:function(AS){return this.docModel.findUnitNameInDataSetFromUnit(AS);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo.vi.ui._HasBoxLayout","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.BoxLayoutConfig","mstrmojo.vi.ui.rw.VizBox","mstrmojo.vi.ui.rw.FilterBox","mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.boxmodel","mstrmojo.models.FormatModel","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.controllers.EnumEvents","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.css","mstrmojo.vi.ui._HasGroup","mstrmojo.DocDataService","mstrmojo.EnumRWUnitType","mstrmojo.vi.util.snapGuide");var h=mstrmojo.func,P=mstrmojo.array,V=mstrmojo.hash,Ab=mstrmojo.css,a=mstrmojo.string,Ae=mstrmojo.vi.models.EnumDragSources,Ac=mstrmojo.vi.ui.rw.VizBox.ENUM_PORTAL_STATE,c=mstrmojo.models.FormatModel,AL=c.getFormatUpdate,Y=c.ENUM_PROPERTY_NAMES,AJ=mstrmojo.vi.enums.EnumFeatures,O=mstrmojo.vi.controllers.EnumEvents,H=mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE.LAYOUT,w=768,AU=mstrmojo.EnumRWUnitType,n=11,AV=0,y=1,AH=0,u=1;var b=2;function AF(Ai,Ah){Ai=Ai||[];(this.children||[]).forEach(function(Ak){var Aj=Ak.addFormatProps(undefined,Ah);if(Aj){Ai.push(Aj);}});return Ai;}function e(Ai,Ah){Ai.push(this.model.getUnitFormatAction(this,1,AL(Y.LAYOUT_XML,this.boxLayoutConfig.getBoxState()),Ah));return Ai;}function B(){(this.children||[]).forEach(function(Ah){Ah.generateToolbar();});}function Ag(){if(this.visible){this.raiseEvent({name:"panelDisplaying"});var Aj=this.node,Ai=Aj.defn,Ak=Aj.k,Ah=Ai._lkz;this.model.raiseEvent({name:"panelDisplaying",panelKey:Ak,layoutKey:Ah});}}function K(Ah){Ab.toggleClass(this.domNode,"undraggable-uc",Ah);}function M(){var Ah=!mstrApp.isAppStatePresentation()&&!mstrApp.isAppStateSelection(),Ai=this.domNode;Ab.toggleClass(this.domNode,"pulse",Ah);setTimeout(function(){Ab.toggleClass(Ai,"pulse",false);},500);}function AN(Aj,Ai){var Ah=parseInt(Aj,10)-parseInt(Ai,10);return Ah?(Ah<0?-1:1):0;}function U(An,Ap,As){var A0=this,Ao=[],Ax=A0.isManualMode(),Aq=Ax?An.floatChildren.length:0,Ai=0,Am=0,At={},Ar={},Aw={},Al=this.getGroupInfo();V.forEach(Al,function(A2,A1){A2.forEach(function(A3){Aw[A3]=A1;});});var Av=function(BA,A3,A7){if(BA.t==="c"){BA.f=true;BA.l=BA.h;var A9=BA.k,A4=Aw[A9],A8;if(A4&&A4!==""){A8=Ar[A4];if(!A8){A8=Ar[A4]=[];}A8.push(BA);At[A9]=A3?A3:BA;if(Ao.indexOf(A8)===-1){Ao.push(A8);}}else{BA.w=Ap;Ao.push(BA);}}else{if(BA.t==="flc"){var A1=A7===Aq-1,A6=A1?0:A0.childPadding,BB=BA.height.split("|"),BC=parseFloat(BB[1]),A2=parseFloat((BC+A6)/BC),A5=parseFloat(BB[0])*A2;BC+=A6;BA.fixed="1";BA.f=true;BA.l=BC;BA.width=100+"|"+Ap;BA.left="0|0px";BA.top=Ai+"|"+Am+"px";Am+=BC;Ai+=A5;Ao.push(BA);}else{P.forEach(Ax?BA.floatChildren:BA.children,function(BE,BD){Av(BE,BA,BD);});}}};Av(An);var Ak=[],Au=[],Az=[],Ay=0;Ao.forEach(function(A9){if(Array.isArray(A9)){var A7=A9.length,A2,A1,BN,BK,BM,BJ,BP,BL,BE,BQ=[],A4,A8,BG=0,BB=[],BC=false,A6=false,BF=0,BI,BH;var BD=function(BR){var BS=function(BT){if(BT.t==="b"){P.forEach(BT.children,function(BU){if(BU.t==="b"){BD(BU.children);}});}BT.f=false;BT.l=parseInt(BT.w/A4,10);};BR.forEach(function(BT){BS(BT);});};var BO=function(BS,BU){var BT,BV=false,BR=[];BS.forEach(function(BW){BT=undefined;BV=false;P.forEach(BU,function(BX){P.forEach(BX.children,function(BY){if(BY.k===BW.k){BT=BX;BV=false;}else{if(BY.t==="b"&&!BT){BT=BY;BV=true;}}});});if(BT&&BT.children.indexOf(BW)>=0){if(BR.indexOf(BT)<0&&!BV){BR.push(BT);}}else{BR.push(BW);}});return BR;};var A5=function(Be){var BS=A2.h<A1.h,Bb=BS?A2:A1,BZ=BS?A1:A2,Bf=At[Bb.k],BW=At[BZ.k],Bd,BY,Ba,Bk=function(Bp){var Bm,Bo;for(var Bn in Bp){Bo=Bp[Bn];if(Bo.t==="c"){Bm=Bo;break;}else{if(Bo.t==="b"){Bk(Bo.children);}}}return(Bm&&Bm.k)||Bb.k;},Bi=A0.getUnitByKey(Bk(Bf.children)),BV=null;if(Be){Bd=BW;BY=Bb;Ba=BS?BM:BJ;}else{Bd=Bf;BY=BZ;Ba=BS?BJ:BM;}var Bg=function(Bo){if(Bo.t==="c"){var Bn=A0.getUnitByKey(Bo.k),Bm=parseInt(Bn.top);BV=BV===null?Bm:Math.min(BV,Bm);}else{if(Bo.t==="b"){P.forEach(Bo.children,function(Bp){Bg(Bp);});}}};P.forEach(Bd.children,function(Bm){Bg(Bm);});BF=Be?++BF:0;if(Bd&&Bd.h){var BX=AN(Bd.h,Be?Bf.h:BY.h),Bl=AN(BV,Be?Bi.domNode.style.top:Ba.top);if(BF>1){BX=-1;}if(!BX&&!Bl){for(var BT in BE){var BU=BE[BT];if((Be||Bd.children.indexOf(BU)>=0)&&BP.indexOf(BU)<0){BP.push(BU);A9[BT]=undefined;}}BP.push(A1);A9[BH]=undefined;var Bh,BR,Bc,Bj=function(Bm){if(BB.indexOf(Bm)<0){BB.push(Bm);A4+=Bm.w;BG=Bm.h;var Bn=function(Bo){if(Bo.t==="c"){if(BP.indexOf(Bo)<0){BP.push(Bo);Bh=Ao.indexOf(Bo);if(Bh>=0){Ao.splice(Bh,1);}Bc=Ak.indexOf(Bo);if(Bc>=0){Ak.splice(Bc,1);Ay=Math.max(0,Ay-Bo.h);}BR=A9.indexOf(Bo);if(BR>=0){A9[BR]=undefined;}}}else{if(Bo.t==="b"){P.forEach(Bo.children,function(Bp){Bn(Bp);});}}};P.forEach(Bm.children,function(Bo){Bn(Bo);});}else{if(BE[BH]){A4+=Bm.w;}}};Bj(Bd);if(Be){Bj(Bf);}}else{if(BX===1){A5(true);}else{if(BX===-1){BC=true;P.forEach(BP,function(Bm){if(BL.indexOf(Bm)<0){Bm.w=Ap;Au.push(Bm);}});BP=BL;}}}}};for(BI=0;BI<A7;BI++){A2=A9[BI];if(!A2){continue;}A8=A2.h;BN=A0.getUnitByKey(A2.k);BM=BN.originalDim||BN.domNode.style;BN.originalDim=undefined;BP=[A2];BL=[A2];A4=A2.w;BE={};for(BH=BI+1;BH<A7;BH++){A1=A9[BH];if(!A1){continue;}BK=A0.getUnitByKey(A1.k);BJ=BK.originalDim||BK.domNode.style;BQ.push(BK);var A3=BM.top===BJ.top,BA=BM.height===BJ.height;if(A3&&BA){BP.push(A1);BL.push(A1);A9[BH]=undefined;A4+=A1.w;}else{if(BC){continue;}else{if(BM.left===BJ.left&&BM.width===BJ.width){BE[BH]=A1;continue;}else{A5();}}}}P.forEach(BP,function(BR){if(P.find(Az,"k",BR.k)<0){Az.push(BR);A6=true;}});if(A6){if(BP.length>1){if(!BC){BP=BO(BP,BB);}BD(BP);Ak.push({children:BP,o:"h",t:"b",f:true,l:Math.max(A8,BG),h:Math.max(A8,BG),w:Ap});}else{A2.w=Ap;Ak.push(A2);if(Au.length){Ak=Ak.concat(Au);Au=[];}}Ay+=Math.max(A8,BG);}else{if(Au.length){Au=[];}}}P.forEach(BQ,function(BR){BR.originalDim=undefined;});}else{Ak.push(A9);Ay+=A9.h||A9.l;}});var Aj=[],Ah=Ak.length;if(Ax){Aj=V.clone(Ak);Ak=[];}return{children:Ak,floatChildren:Aj,o:"v",t:"b",h:Ay+(Ax?0:(Ah-1)*As),w:Ap};}mstrmojo.vi.ui.rw.DocRelativePanel=mstrmojo.declare(mstrmojo.DocPanel,[mstrmojo.vi.ui._HasBoxLayout,mstrmojo.ui._HasScroller,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode,mstrmojo.vi.ui._HasGroup],{scriptClass:"mstrmojo.vi.ui.rw.DocRelativePanel",formatHandlers:null,childPadding:4,panelPadding:b,layoutMode:AH,allowPanelEdgeTargeting:true,children:null,model:null,titleText:null,previousLayout:null,dropZone:false,snapGuide:null,subPanelCssText:"position:absolute;",markupString:'<div id="{@id}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="{@containerNodeCssText}{@subPanelCssText}"><div></div></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{panelNode:function(){return this.domNode;},subPanelNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild.firstChild;},maskNode:function(){return this.domNode.lastChild;},scrollNode:function(){return this.domNode;}},allowDrop:function C(Ah){var Aj=Ah.src,Ai=Aj&&Aj.widget;return(Ai&&this.boxLayoutConfig.findFloatKey(Ai));},ondrop:function A(Aj){this.turnMask();var An=this.boxLayoutConfig,Am=Aj.src.widget;An.updateFloatLayout(null,Am);Aj.dropSuccessful=true;Am.updateSelfSplitter();this.snapGuide.boxIntervalOperations(Am,"insert");if(Aj.highLight){Am.toggleGuidesDiv(Aj.highLight,false);delete Aj.highLight;}var Ah=this,Ai=Ah.model,Al=mstrmojo.DocDataService,Ak=Ai.getUIState();Ak[V.keyarray(Ak)[0]].boxState=V.clone(Aj.box.initState);Ai.execute({execute:function(){Ah.saveBoxLayout(this);},urInfo:{extras:Al.SUPPRESS_DATA},undoUIState:Ak});},init:function AD(Ah){this._super(Ah);this.childPadding=mstrApp.getThemeProps(H).drpChildPadding;Ab.addWidgetCssClass(this,"mstrmojo-VIDocRelativePanel");var Aj=this.id,Ai=V.walk("node.defn.layoutXML.m",Ah);this.layoutMode=Ai&&Ai==="m"?u:AH;this.controller.view.getLayout(this.node.defn._lkz).attachEventListener("layoutRedisplay",Aj,function(){if(this.selected){Ag.call(this);}});this.markupMethods=h.override({onvisibleChange:function(){this._super();if(this.visible){B.call(this);}Ag.call(this);}},V.copy(this.markupMethods));this.boxLayoutConfig=new mstrmojo.vi.ui.BoxLayoutConfig({hostId:Aj,padding:this.childPadding,needsValidation:true,getBoxChildClass:function(Ak){return mstrmojo.all[Aj].getBoxLayoutChild(Ak).scriptClass;}});this.model.attachEventListener("viIconTabClicked",Aj,function(Al){var Ak=this.model.hgl;if(Al.id==="vi_flt"&&!Ak){M.call(this);}});this.model.attachEventListener(O.UPDATE_TOC,Aj,function(){if(this.isPanelDisplaying()){B.call(this);}}.bind(this));this.model.attachEventListener("visOutsideScrolled",Aj,function(Ak){if(this.scrollbarHostNode){this.scrollbarHostNode.scrollTop+=-Ak.deltaY;this.scrollbarHostNode.scrollLeft+=-Ak.deltaX;}}.bind(this));this.isInteractive=mstrApp.allowWebDashboardDesign();this.snapGuide=new mstrmojo.vi.util.snapGuide();},onAppStateChange:function(){if(this._tgtSelections&&!mstrApp.isAppStateSelection()){this._tgtSelections.clear();}},onLayoutModeChange:function(){this.isInteractive=mstrApp.allowWebDashboardDesign()&&!mstrApp.isLayoutModePreview();if(!mstrApp.supportFeature(AJ.SUPPORT_RESPONSIVE_RESIZING)){var Ai=this.controller.view.layoutViewer.docLayout,Ah=parseInt(Ai.width,10)||0;if(Ah<=w){this.buildBoxLayout();}}},onremoveChild:function Ad(){K.call(this,!this.hasMultipleChildren());},onaddChild:function F(){K.call(this,!this.hasMultipleChildren());},setupScrollNodes:function L(){if(mstrApp.supportFeature(AJ.SUPPORT_RESPONSIVE)){this.scrollNode=this.subPanelNode;this.scrollbarHostNode=this.panelNode;}else{this.scrollNode=null;this.scrollbarHostNode=null;}},isPanelDisplaying:function(){return this.selected&&this.node.defn._lkz===this.model.getCurrentLayoutKey();},getLayoutOffsets:function D(){var Ah=mstrApp.getThemeProps(H);return{h:8-2*b+Ah.drpLOHW_Compensation,w:8-2*b+Ah.drpLOHW_Compensation};},getBoxLayoutChild:function E(Ah){var Ai=this._super(Ah);if(!Ai){return this.getUnitByKey(Ah.k);}return Ai;},addChildren:function AX(Ak,Ah,Ai){this._super(Ak,Ah,Ai);var Aj=this.model,An=Aj.findKeyMap(this.node);if(An){var Am=this.boxLayoutConfig.replaceLayoutXmlKeys(An);if(Am){var Al=Aj.replaceKeyBoxes=Aj.replaceKeyBoxes||[];Al.push(this);}}this.buildBoxLayout();},refresh:function AT(){this.boxLayoutConfig.dirty=true;this._super();this.buildBoxLayout();},update:function i(Ak){var Aj=Ak.defn,Ah=Aj&&Aj.layoutXML,Ai=this.boxLayoutConfig;if(Ah){Ai.box=Ah;}else{this.defn.layoutXML=Ai.useDefaultBox(Ak.data.objects||[]);}this.titleText=Aj&&Aj.ttl;this.title=a.encodeHtmlString(this.titleText);},hasMultipleChildren:function k(){return(this.children.length>1);},hasMultipleRltChildren:function m(){var Ah=this.boxLayoutConfig.box&&this.boxLayoutConfig.box.floatChildren;return(this.children.length-(Ah?Ah.length:0)>=1);},hasMultipleFloatChildren:function AC(){return this.boxLayoutConfig.box.floatChildren.length>=1;},getSplitterHost:function AZ(){return this.containerNode;},getTargetKeysByType:function AW(Ah){return(this.children||[]).filter(function(Ai){return(Ah||[]).indexOf(parseInt(Ai.defn.t,10))>-1;}).map(function(Ai){return Ai.k;});},getTargetKeysExcludingTypes:function f(Ah){return(this.children||[]).filter(function(Ai){return(Ah||[]).indexOf(parseInt(Ai.defn.t,10))<0;}).map(function(Ai){return Ai.k;});},insertNewBoxAndSaveDeferred:function(An,Aj,Ak,Am,Ah,Ai){var Al=this.id;this.addChildren([Aj]);this._super(An,Aj,Ak,h.wrapMethods({failure:function(){mstrmojo.all[Al].removeChildren(Aj);Aj.destroy();}},Am),Ah,Ai);},addUnit:function x(Ak,Ai,Aj,Am,Al){this.addChildren([Ak]);var Ah=this.insertNewBox(Ak,Ai,Aj,Am);if(Am){this.addSaveBoxLayoutActions(Am,Al);}return Ah;},restoreAnyMaxedVizBox:function J(){var Ah=this.maximizedBox;if(!Ah||!Ah.isMaxed){return ;}this.setPortalState(Ah,Ac.RESTORE,false);delete Ah.isMaxed;Ab.toggleClass(Ah.maxRestoreBtnNode,"restore",Ah.isMaxed);},setPortalState:function z(Al,Ai,Ao){var Ah=this,Aj=this.id,Am=this.model,As=Al.defn,Ak=As.ds,Aq=function(Aw){var Av=mstrmojo.all[Aj];if(!mstrmojo.all[Al.id]){var Au=Al.k;mstrmojo.array.forEach(Av.children,function(Ay){if(Ay.k===Au){Al=Ay;return false;}});}if(!mstrmojo.all[Al.id]){return ;}var Ax=Al.isMaxed=Aw===Ac.MAXIMIZE,At=Ax?Ah.isManualMode()?99:2:1;if(Ax){Av.maximizedBox=Al;}else{if(Aw===Ac.RESTORE){delete Av.maximizedBox;}}K.call(this,Al.isMaxed);Al.set("zIndex",At);As.ds=Aw;Av.buildBoxLayout();Al.generateToolbar();};if(!Ao){Am.controller.cmdMgr.execute({execute:function Ap(){var Av=mstrmojo.all[Aj],Aw=Ai===Ac.MAXIMIZE,At=Aw?2:1,Ax=[Am.getUnitFormatAction(Al,1,{FormattingOrder:{ZIndex:At},FormattingView:{WindowState:Ai}})];AF.call(Av,Ax);this.submit(Ax,{failure:function Au(){Aq(Ak);}},mstrmojo.DocDataService.RAPID_EXEC);Aq(Ai);},urInfo:{silent:true,undo:function Ar(){Aq(Ak);},redo:function An(){Aq(Ai);}}});}else{Aq(Ai);}},buildBoxLayout:function AM(Ai,Ah){if(!this.visible){return ;}if(!this.children){return ;}var Ak=this.boxLayoutConfig,Am=mstrApp.isWSStyling;if(Ak.needsValidation){var Aj=this.children;if(!Ak.validateBoxLayout(Aj)){this.defn.layoutXML=Ak.useDefaultBox(Aj);}Ak.needsValidation=false;}if(Ak.box&&Ak.box.floatChildren){var An=Ak.box.floatChildren;An.forEach(function(Ap){if(!Ap.rk){Ap.rk=this.k;}},this);this.defn.layoutXML=Ak.box;}if(Am&&this.height&&this.width){this.height=(parseInt(this.height,10)-2*b)+"px";this.width=(parseInt(this.width,10)-2*b)+"px";}this._super(Ai,Ah);this.parentRect=this.getSplitterHost().getBoundingClientRect();if(this.hasRendered&&this.children[0].hasRendered){Ak.buildBoxTree(this);this.buildFloatBoxLayout();this.updateChildSplitter();}var Ao=this.maximizedBox;if(Ao){if(Ao.domNode){var Al=Ao.domNode.style;Ao.originalDim={top:Al.top,height:Al.height};}if(this.height!==undefined&&this.width!==undefined){Ao.updateLayout({left:"0px",top:"0px",height:this.height,width:this.width});}}if(Am&&this.height&&this.width){this.height=(parseInt(this.height,10)+2*b)+"px";this.width=(parseInt(this.width,10)+2*b)+"px";}if(mstrApp.isAppStateSelection()){this.model.raiseEvent({name:"buildBoxLayoutComplete"});}this.snapGuide.reconstructTree(this);},findValidRelativeKey:function Aa(Ah){var Aj=this.boxLayoutConfig,Ai=Aj.findTargetNodeInBoxTree(Ah,Aj.boxTree);return this.children.filter(function(Ak){return Ak.k!==Ai.k&&!Aj.findTargetNodeInBoxTree(Ak,Ai.children);}).concat(this);},moveBoxToRelative:function l(Ai,Ah){this.boxLayoutConfig.moveBoxToRelative(Ai,Ah);},calculateFloatBoxLayout:function t(Aj,Ai,Ah){return["left","top","width","height"].reduce(function(Ap,Aq,An){var Ak=Aj[Aq].split("|"),Am=parseFloat(Ak[0]),Ao=parseFloat(Ak[1]),Al=parseFloat(Ai[Aq]);Ap[Aq]=Ah&1<<An?An&2?Ao:(Al+Ao)+"px":An&2?Math.round(Am*Al/100)+"px":(Al+Math.round(Am/100*(An?Ai.height:Ai.width)))+"px";return Ap;},{});},buildFloatBoxLayout:function AP(){var Ah=this.boxLayoutConfig;if(!Ah.boxTree.length){return ;}this.buildFloatHelper(Ah,Ah.boxTree,{left:0,top:0,width:this.parentRect.width,height:this.parentRect.height});},buildFloatHelper:function d(Aj,Ai,Ah){if(mstrApp.isLayoutModePreview()&&Aj.box.h>Ah.height){Ah.width-=n;}Ai.forEach(function(Ap){var Am=Ah;if(Aj.findFloatKey(Ap.k)){var An=this.children[P.find(this.children,"k",Ap.k)],Am=this.calculateFloatBoxLayout(Ap,Ah,Ap.fixed),Ao=Aj.box.floatChildren,Ak=Ao[P.find(Ao,"k",Ap.k)],Al=V.walk("k",this.maximizedBox);Object.keys(Am).forEach(function(Aq,At){var Au=Ak[Aq],As=parseFloat(Am[Aq]),Ar=parseFloat(Ah[Aq]);Ak[Aq]=At&2?As/Ar*100+"|"+As:(As-Ar)/(At?Ah.height:Ah.width)*100+"|"+(As-Ar)+"px";});An.fixed=Ap.fixed;An.updateLayout(Am);if(Al!==Ap.k){An.set("zIndex",Ap.zIndex);}}else{Am=Ap;}this.buildFloatHelper(Aj,Ap.children,Am);},this);},updateChildSplitter:function AS(){this.children.forEach(function(Ah){Ah.updateSelfSplitter();});},beginBoxMove:function I(Ai,Ah){this._super(Ai,Ah);this.setIFramePointerEvents(false);},endBoxMove:function j(Ai,Ah){this._super(Ai,Ah);this.setIFramePointerEvents(true);this.toggleFloatChild(true);this.getSplitterHost().appendChild(Ah.domNode);},turnMask:function Af(){this.dropZone=!this.dropZone;this.maskNode.style.display=this.maskNode.style.display==="block"?"none":"block";},setIFramePointerEvents:function(Ah){(this.children||[]).forEach(function(Ak){var Ai=Ak.defn,Aj=Ak.boxContent;if(Aj&&Ai&&Ai.t===AU.HTMLCONTAINER&&Ak.htmlType===0){Aj.domNode.style.pointerEvents=Ah?"inherit":"none";}});},getChildPositionActions:function AQ(Ah){return AF.call(this,[],Ah);},getBoxLayoutActions:function G(Ah){return e.call(this,[],Ah);},getBoxLayoutSaveCallback:function N(){var Ah=this.id;return{success:function(){B.call(mstrmojo.all[Ah]);}};},addSaveBoxLayoutActions:function q(Ak,Ah){var Aj=this.id,Ai=Ak.actions;AF.call(this,Ai,Ah);e.call(this,Ai,Ah);Ak.addCallbacks({success:function(){B.call(mstrmojo.all[Aj]);}});},saveBoxLayout:function AO(Aj,Ah,Al,Ak,Ai){this._super(Aj,Ah,Al,Ak,Ai);this.defn.layoutXML=this.boxLayoutConfig.box;if(this.isManualMode()){this.model.raiseSetPositionSizeEvent();}if(Ak){Ak.addCallbacks(this.getBoxLayoutSaveCallback());}},postBuildBoxLayout:function W(){var Ah=this.model.getLatestSelectedViUnitKey(),Ai=Ah&&this.getUnitByKey(Ah);if(Ai){this.model.selectVIUnit(Ai.id);}else{this.selectFirstBox();}},postCalculateBoxLayout:function g(Ai,Ar,An){var Au=mstrmojo.vi.VisualInsightApp.LAYOUT_MODES,Ao=Au.PREVIEW_TOGGLED,Av=mstrApp.supportFeature(AJ.SUPPORT_RESPONSIVE_RESIZING),Aq=mstrApp.layoutMode,At=this.controller.view.layoutViewer.docLayout.docSection,Am=parseInt(At.width,10)||0;if(mstrApp.supportFeature(AJ.SUPPORT_RESPONSIVE)){if(Am<=w&&(Av||Aq===Ao)){if(!this.previousLayout){this.previousLayout=V.clone(Ai);}Ar.width=Math.min(Ar.width,parseInt(this.width,10));var Ah=this.isManualMode()?Ai.floatChildren:Ai.children,Ak=Ah[0];if(Ak&&!(Ak.h||Ak.w||Ak.width||Ak.height)){Ar.width-=n;An.call(this,Ai,Ar,0);Ar.width+=n;}if(this.maximizedBox){if(this.previousLayout){Ai=V.clone(this.previousLayout);}Ar.width=parseInt(this.width,10);Ar.height=parseInt(this.height,10);}else{if(Ah.length>1){var Al=this.containerNode,Aw=Al&&Al.clientHeight,Ap=Ai.h,As=Ar.height;if((Ap&&Ap<As)||(Aw&&Aw<As)){Ah.forEach(function(Ax){Ax.f=false;});An.call(this,Ai,Ar,0);}Ai=U.call(this,V.clone(Ai),Ar.width,this.boxLayoutConfig.padding);Ar.width=Ai.w;Ar.height=Ai.h;}}if(Ar.height>parseInt(this.height,10)){Ar.width-=n;}if(!mstrApp.isLayoutModePreview()&&Av){mstrApp.set("layoutMode",Au.PREVIEW_RESIZE);}}else{if(Aq!==Ao){if(this.previousLayout){Ai=V.clone(this.previousLayout);this.previousLayout=null;Ar.width=parseInt(this.width,10);Ar.height=parseInt(this.height,10);var Aj=this.domNode;if(Aj){Aj.scrollTop=0;}mstrApp.set("layoutMode",Au.DEFAULT);}}else{Ai=null;At.domNode.style.left=(Am-w)/2+"px";window.setTimeout(function(){At.set("width",w+"px");}.bind(this),0);}}}return Ai;},selectFirstBox:function Q(){var Ai=this.firstVizBoxId||this.firstBoxId,Ah=mstrApp.isAppStateSelection();if(this.visible&&Ai&&!Ah){this.model.selectVIUnit(Ai);}},selectVIUnit:function R(Ai,Ah){var Ak=this._tgtSelections,Aj=true;if(Ak){if(Ai.id===Ak.id){Aj=false;}else{Aj=Ak.toggleSelection(Ai.k);Ak.notify();}}else{this.model.selectVIUnit(Ai.id,Ah);}return Aj;},toggleFloatChild:function p(Ah){var Ai=this.children;(this.boxLayoutConfig.box.floatChildren||[]).forEach(function(Aj){Ai[P.find(Ai,"k",Aj.k)].domNode.style.display=Ah?"block":"none";});},applyzIndex:function AY(){var Ah=this.children;this.boxLayoutConfig.box.floatChildren.forEach(function(Ai){Ah[P.find(Ah,"k",Ai.k)].set("zIndex",Ai.zIndex);},this);},getUnitByKey:function AR(Ah){return(this.children||[]).filter(function(Ai){return Ai.k===Ah;})[0];},enterTargetSelectionMode:function s(Am,Al,Ak,Aq,Aj){if(!this._tgtSelections&&this.children&&this.children[0].hasRendered){this.children.forEach(function(Ar){Aq(Ar);});var Ao=this.model,Ap=Ao.getSelectedViUnit(),An=Ap&&Ap.id,Ai={},Ah=function(){return V.keyarray(Ai).filter(function(Ar){return Ai[Ar];});};this._tgtSelections={id:Al,notify:function(As,Ar){Am(Ah(),!!As,Ar);},toggleSelection:function(Ar){Ai[Ar]=!Ai[Ar];return Ai[Ar];},getSelections:function(){return Ah();},remove:function(Ar){if(Ai[Ar]!==undefined){delete Ai[Ar];}},restore:function(){Ao.selectVIUnit(An,true);},clear:function(){Aj();}};Ao.selectVIUnit("");(Ak||[]).forEach(function(Ar){Ao.getUnitInstance(Ar,1).parent.selectVIUnit();},this);}},exitTargetSelectionMode:function o(Ah,Ai){var Aj=this._tgtSelections;if(Aj){delete this._tgtSelections;this.children.forEach(function(Ak){Ai(Ak);});Aj.restore();if(Ah){Aj.notify(Ah);}}},unload:function AA(){this.destroyChildren();this.defn.l=false;this.builtChildren=false;},getPanelTargetEdge:function AE(Ah){if(Ah.src.widget.parent!==this&&Ah.getCtxtDragData().src!==Ae.FILTERS){return"";}return this._super(Ah);},setLastSelectionClass:function AB(Ak,Aj){if(Ak!==Aj){var Ai,Ah="lastSelected";if(Aj){Ai=this.getUnitByKey(Aj);Ab.removeClass(Ai.domNode,Ah);}if(Ak){Ai=this.getUnitByKey(Ak);Ab.addClass(Ai.domNode,Ah);}}},dropBox:function Z(Ak,Ai,Al,Ao){Ao=false;this._super(Ak,Ai,Al,Ao);var Ah=this,Aj=Ah.model,An=mstrmojo.DocDataService;var Am=Aj.getUIState();Am[V.keyarray(Am)[0]].boxState=V.clone(Ak.box.initState);Aj.execute({execute:function(){Ah.saveBoxLayout(this);},urInfo:{callback:An.EMPTY_CALLBACK,extras:An.SUPPRESS_DATA},undoUIState:Am});},convertToManual:function X(){if(this.isManualMode()){return ;}var Ah=this,Al=Ah.children,Ak=Ah.boxLayoutConfig,Ao=V.copy(Ak.box),Am=Ah.model.getUIState(),An={height:parseInt(Ah.height,10)-2*b,width:parseInt(Ah.width,10)-2*b,top:0,left:0},Aj=this.calculateBoxLayoutManual(Ak,An);Ak.box=Aj.box;var Ai=function(Ap){Ah.layoutMode=u;P.forEach(Al,function(Aq){Aq.toggleDock();});Ah.buildBoxLayout();Ah.saveBoxLayout(Ap,null,{success:function(){P.forEach(Al,function(Aq){Ak.refreshToolbar(Aq);});}});};this.model.execute({execute:function(){Ai(this);},urInfo:{callback:{success:function(){Ah.layoutMode=Ah.isManualMode()?AH:u;P.forEach(Al,function(Ap){Ap.toggleDock();});}},extras:mstrmojo.DocDataService.SUPPRESS_DATA},undoUIState:Am});},unDock:function S(Aj){var Ah=this,Ai=Ah.model;Ai.execute({execute:function(){Aj.toggleDock();Ah.boxLayoutConfig.deleteBox(Aj,true);Ah.boxLayoutConfig.addFloat(Aj);Ah.buildBoxLayout();Ah.saveBoxLayout(this,null,{success:function(){Ah.boxLayoutConfig.refreshToolbar(Aj);}});},urInfo:{callback:{success:function(){Aj.toggleDock();Ah.boxLayoutConfig.refreshToolbar(Aj);}},extras:mstrmojo.DocDataService.SUPPRESS_DATA}});},Dock:function AG(Aj){var Ah=this,Ai=Ah.model,Ak=function(){if(Aj.boxContent){Aj.generateToolbar();Ah.boxLayoutConfig.refreshToolbar(Aj);}};Ai.execute({execute:function(){Ah.boxLayoutConfig.deleteBox(Aj,true);Ah.boxLayoutConfig.insertNewRootChild(Aj,null,true);Aj.toggleDock();Ah.buildBoxLayout();Ah.saveBoxLayout(this,null,{success:Ak()});},urInfo:{callback:{success:function(){Aj.toggleDock();Ak();}},extras:mstrmojo.DocDataService.SUPPRESS_DATA}});},boxOperation:function AI(Ai,Aj){var Ah=this,Ak=this.model.getUIState();if(this.boxLayoutConfig[Ai]&&this.boxLayoutConfig[Ai](Aj)){Ah.model.execute({execute:function(){Ah.applyzIndex();Ah.saveBoxLayout(this);},urInfo:{extras:mstrmojo.DocDataService.SUPPRESS_DATA},undoUIState:Ak});}},isManualMode:function AK(){return this.layoutMode===u;}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.rw.DocRelativePanel,{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod});mstrmojo.vi.ui.rw.DocRelativePanel.getLayoutBreakPoint=function(){return w;};mstrmojo.vi.ui.rw.DocRelativePanel.EnumPreviewModes={DefaultDesktop:AV,DefaultPreview:y,TabletPreview:y};mstrmojo.vi.ui.rw.DocRelativePanel.EnumLayoutModes={Auto:AH,Manual:u};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.array","mstrmojo.vi.models.editors.ControlsViewFactory","mstrmojo.Label","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.vi.ui.editors.EditorGroup","mstrmojo.vi.ui.rw.DocRelativePanel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.vi.ui.editors.MoreOptionsEditor");var K=mstrmojo.hash,H=mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS,R="mstrmojo-more-options-editor",F="mstrmojo-more-options-editor-visfilter";mstrmojo.vi.models.editors.EditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.ControlsViewFactory,null,{scriptClass:"mstrmojo.vi.models.editors.EditorModel",hostId:"",help:"",getHost:function C(){return mstrmojo.all[this.hostId];},docModel:null,getEditorContents:mstrmojo.emptyFn,getGroupTitle:function D(U){return new mstrmojo.Label({cssClass:"edt-title",text:U});},getShowTitleCheckbox:function L(){var U=this.getHost();return this.getCheckboxAndLabel(U.parent.getTitleBarVisibility(),mstrmojo.desc(13599,"Show titlebar"),function(V){U.parent.toggleTitleBar(!!V);});},getTextAlign:function G(W,X,V){var U=new mstrmojo.vi.ui.TextAlignButtonBar(!V?null:{itemsValueMap:V});U.singleSelect(mstrmojo.array.find(U.items,"id",W));U.onValueChange=X;return U;},getWrapText:function Q(V,U){return this.getCheckboxAndLabel(V,mstrmojo.desc(13577,"Wrap text"),U);},getTextDirection:function E(V,W){var U=0;if(V){U=V===3?1:2;}return this.getLabelAndControl(mstrmojo.desc(11914,"Direction:"),this.getPulldown([{n:mstrmojo.desc(2066,"Horizontal"),v:0},{n:mstrmojo.desc(5155,"90 degrees"),v:90},{n:mstrmojo.desc(5156,"-90 degrees"),v:-90}],W,U));},getOverflow:function M(V,U){return this.getLabelAndControl(mstrmojo.desc(11915,"Overflow:"),this.getPulldown([{n:mstrmojo.desc(2974,"Clip"),v:false},{n:mstrmojo.desc(2976,"Scroll"),v:true}],U,V?1:0));},getChangeFormatPropertyFn:function A(U,V){var W=this.id;return function(Z,X){var Y=mstrmojo.all[W];Y.docModel.changeUnitFormatProperty(Y.getHost().parent,[{formatType:V||1,propertyName:U,newValue:Z,oldValue:X}]);};},getChangeGroupLayoutFn:function J(){var U=this.docModel;return function(V,Y,W){var X=["left","top","width","height"].indexOf(V)>-1,Z={};if(X){Z[V]=Y;U.changeUnitBoxLayout(Z);}};},getChangeGroupPropertyFn:function S(U){var V=this.id;return function(W,Y,X){(mstrmojo.all[V].getChangeFormatPropertyFn(W,U))(Y,X);};},getCharacterGroup:function B(X,U,V){var Y={onGroupValueChange:X};if(V){Y.visibleControls=V;}var W=new mstrmojo.ui.editors.controls.CharacterGroup(Y);W.setFormatSource(U);return W;},getContainerGroup:function P(U,Y,V,X){var W=this.docModel,Z=H.FILL_COLOR+H.BORDER+(W&&W.isFreeFormPanel()?H.SIZE_POSITION:0),a=new mstrmojo.ui.editors.controls.ContainerGroup(K.copy(X,{onGroupValueChange:Y||this.getChangeGroupPropertyFn(),onGroupLayoutChange:this.getChangeGroupLayoutFn(),visibleControls:V||Z}));a.setFormatSource(U);W.attachEventListener("setPositionAndSize",this.id,function(b){a.setPositionAndSize(b);});W.raiseSetPositionSizeEvent();return a;},getMoreOptionsEditorLink:function N(V,U,W){return new mstrmojo.Label({text:mstrmojo.desc(9126,"More options"),cssClass:"edt-link",onclick:function(){this.openMoreOptionsEditor(V,U,W);}.bind(this)});},openMoreOptionsEditor:function O(Y,U,Z){var X=this.getHost(),W;var V=function(c,a,g,b){var d=this.host,e=d.controller,f=[];if(!K.isEmpty(c)){g=mstrmojo.func.wrapMethods(e._getXtabCallback(d),g);f=[e.dataService().getUpdateTemplateAction(d.k,[d.model.getAdvancedPropertiesAction(c)])];}f=f.concat(a||[]);if(!K.isEmpty(f)){e.submitUndoRedoUpdates(f,null,g,b);}};if(mstrApp.isInVFConfigMode){W=mstrmojo.all[F]||new mstrmojo.vi.ui.editors.MoreOptionsEditor({id:F,submitAction:V});}else{W=mstrmojo.all[R]||new mstrmojo.vi.ui.editors.MoreOptionsEditor({id:R,submitAction:V});}W.set("data",Y);W.set("showHeadersSection",!!U);W.set("showSelectionLimitSection",!!X.GMController);W.set("lockHeadersCase",Z);W.set("host",X);W.open();return W;},replaceChildControls:function I(W,V){var U=[].concat(W.children||[]);W.removeChildren();U.forEach(function(X){X.destroy();});W.addChildren(V);W.doLayout();}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.vi.models.DocXtabModel","mstrmojo.EnumRWUnitType");var C=mstrmojo.array,B=mstrmojo.hash;var F="Metrics",D=2,H="\u001E",E="\u001F";mstrmojo.vi.models.DocVisModel=mstrmojo.declare(mstrmojo.vi.models.DocXtabModel,null,{scriptClass:"mstrmojo.vi.models.DocVisModel",getHMSelecAttrElemIdsInfo:function(R){var Q=R[0],L=Q.tid,N=Q.tids,M=Q.selections,K={},S=[],P=this.scm,O=(L&&P&&P[L]);C.forEach(M,function(V){var U=(V&&V.length)||0,W=U>0?V[U-1]:{},X=W.tid;if(P[X]){if(!K[X]){K[X]=[];}K[X].push(W.eid);}});B.forEach(K,function(U){S.push(U.join(H));});if(O&&O.showall&&S.length===0){C.forEach(N,function(U){S.push("OA:(All)");K[U]=[];});}return{eids:S.join(E),tids:Object.keys(K)};},getSelectedAttributeElementIdStr:function(S){var R=S[0],K=R.tid,L,M=R.selections,N=[],P=[];C.forEach(M||[],function(U){N=N.concat(C.filter(U,function(V){return V.tid===K;}));});N=C.distinct(N,"eid");(N||[]).forEach(function(U){P.push(U.eid);});L=P.join(H);var Q=this.scm,O=(K&&Q[K]);if(O&&O.showall&&P.length===0){L="OA:(All)";}return L;},getHMAction:function A(Z){var Y=Z[0],N=Y&&Y.at,R=Y.anchor,M=Y.selections,W=this.scm,K=[],O=[],Q=[],a=[],S,U,X,L,V,P;V=this.getHMSelecAttrElemIdsInfo(Z);L=V.eids;if(M.length!==0&&L===""){return null;}if(N&&((N&D)>0)&&W){C.forEach(V.tids,function(c){var b=W[c];if(b){K.push(b);O.push(b.ck);Q.push(b.ckey);a.push(b.tks);}});S=O.join(E);U=Q.join(E);X=a.join(H);if(K.length&&L!==""){P={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:R,ck:S,tks:X,eid:L,ctlKey:U,sliceId:this.xtab.sid,isUConDS:K[0].isUConDS,isDocVis:true}};}}return P;},getDrillWithinActionsForAssociatedNodes:function G(K,L,Q,R){var O=this,U=this.docModel,M=[U.getDataService().getDrillGridAction(this.getDrillAction(this.xtab.k,L,K))],S=!!R?R:this.xtab,N=!mstrApp.isInVFConfigMode?(S.getAssociatedNodes&&S.getAssociatedNodes()||[]):[];Q=mstrmojo.func.wrapMethods(Q,{success:function P(){C.forEach(N,function(W){var V=U.getPanel().getUnitByKey(W.k);if(V&&V.boxContent){V.boxContent.raiseEvent({name:"regenerateToolbar"});}});}});C.forEach(N,function(V){M.push(U.getDataService().getDrillGridAction(O.getDrillAction(V.k,L,K)));});return{actions:M,callback:Q};},getDrillAction:function I(L,N,K){function M(S){var R=[];for(var Q=0,O=S.length;Q<O;Q++){var V=S[Q];for(var P=0,W=V.length;P<W;P++){var U=V[P];if(mstrApp.useBinaryFormat){R.push(U.axis+"A"+(U.ui+1)+"A"+U.o);}else{R.push(U.axis+"A"+(U.ui+1)+"A"+U.o);}}}return(mstrApp.useBinaryFormat)?R:R.join(",");}return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,nodeKey:L,retainParent:K.retainParent||"",isWithin:K.drillPath.within,drillPathKey:K.drillPath.k,drillPathIndex:K.drillPath.dpi,drillElements:M(N)};},getAction:function J(U){var S=U[0],N=S&&S.at,P=S.anchor,K=S.tid,L,O,M=S.selections;L=this.getSelectedAttributeElementIdStr(U);if(M.length!==0&&L===""){return null;}if(N&&((N&D)>0)){var R=this.scm;var Q=(K&&R[K])||R[F];if(Q&&L!==""){O={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:P,ck:Q.ck,tks:Q.tks,eid:L,ctlKey:Q.ckey,sliceId:this.xtab.sid,isUConDS:Q.isUConDS,isDocVis:true}};}}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.DropZonesModel","mstrmojo.array","mstrmojo.hash","mstrmojo.vi.models._DropZoneCommon","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLBaseFormType");mstrmojo.requiresDescs(190,1388,3224,5188,11806,12287,13295,13296,13624,13625,14003,14655,14656,14717);var H=mstrmojo.array,C=mstrmojo.hash,E=mstrmojo.vi.ui.DatasetUnitMenuUtils,I="-1",D=mstrmojo.mstr.EnumDSSXMLBaseFormType,J=mstrmojo.vi.enums.EnumFeatures,F=mstrmojo.mstr.EnumDSSXMLObjectTypes;mstrmojo.vi.models.TemplateBasedDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{getClearAllUnitsActions:function G(){var L=[],K=this.getHost().model;this.getDropZones().zones.forEach(function(M){var N=M.id;M.items.forEach(function(P,O){if(P.did!==I){L.push(K.getRemoveTemplateUnitAction(C.copy(P,{axis:N,unitPos:O+1})));}});});return L;},getMultiUnitsMenuItems:function B(L,K,M){var N=this.id;if(!mstrApp.isInVFConfigMode&&E.getMultiSelectionShortcutMetricFunctions(M).length&&mstrmojo.resolveFeature(J.INSERT_NEW_METRIC)){L.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,function(){return mstrmojo.all[N].getMultipleMetricsCalcMenus(K,M,false);});L.addSeparator();}L.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[N].deleteItems(K,M);});},getExtraUnitMenuItems:function A(L,K,N,M){},getUnitMenuItems:function A(O,b,Z,a,X){if(!Z){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var U=b.items,K=this.getHost(),Y=U.length,M=b.id,P={zone:b,axis:M,idx:H.indexOf(U,Z),cnt:Y,item:Z,metricsAxis:(this.getHost().gridInfo||{}).tma,useDropzone:X?X:false},e=this,V=this.id,L=Z.did===I,Q=(Z.t===F.Consolidation&&Z.st===12033),f=mstrApp.isInVFConfigMode,N=mstrmojo.resolveFeature(J.INSERT_NEW_METRIC),W=this.docModel,c=Z.did;if(Q&&!f){O.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",function(){var g={otp:Z.t,id:c,n:Z.n,axis:b.id,ui:P.idx};K.derivedElementsEdit(g);});O.addSeparator();}if(!L){if(K.model.isRecursiveAttribute(Z.did)){O.addMenuItem(mstrmojo.desc(14655,"Expand All Levels"),"",function(){var g={id:Z.did};K.raExpandAll(g,true);});O.addMenuItem(mstrmojo.desc(14656,"Collapse All Levels"),"",function(){var g={id:Z.did};K.raExpandAll(g,false);});O.addSeparator();}if(this.supportWebSort()){this.addSortMenu(P,O,true);}O.addSeparator();if(Z.t===F.Metric&&!f){if(Z.um&&mstrmojo.resolveFeature(J.USE_METRIC_EDITOR)){O.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){e.editDerivedMetric(P);},P);O.addSeparator();}if(N){if(W.findDatasetIdFromUnit(c)&&!W.isFromSolrCube(c)&&!W.isFromMDXCube(c)){O.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",V,e.getAggregateByMetricSubMenu,P);O.addSeparator();}O.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),V,e.getCalculationEditorCfg,P);O.addSubMenuItem(mstrmojo.desc(12287,"Shortcut Metric"),"",V,e.getShortcutMetricSubMenu,P);O.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){e.newDerivedMetric(P);},P);}}if(Z.t===F.Attribute){var S=Z.did||"",R=S?E.getDatasetFromAttributeId(this.docModel.datasets,S):null,d=this.isDynamicLink(Z);if((!R||!this.docModel.isMDXDataset(R))&&!f){if(Z.da){O.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){e.editDerivedAttribute(P);},P);O.addSeparator();}if(((!R)||!E.isCGorCon(Z,R))&&!d&&N){O.addMenuItem(mstrmojo.desc(13625,"New Attribute..."),"",function(){e.newDerivedAttribute(P);},P);O.addMenuItem(mstrmojo.desc(14717,"Create Links..."),"",function(){e.newDynamicLinkAttr(P);},P);}}if(!f&&!E.hasOldDEOverDatasets(Z.did,this.docModel.datasets)&&!d&&Z.st!==3076){O.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",function(){var g={otp:Z.t,id:Z.did,n:Z.n,axis:b.id,ui:P.idx};K.derivedElementsEdit(g);});}}this.getExtraUnitMenuItems(O,b,Z,P);O.addSeparator();if(e.hasReplaceCandidates(P)&&(!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||!!mstrmojo.resolveFeature(J.WEB_DRILL_AND_LINK))){O.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",V,e.getReplaceSubMenu,P);}O.addMenuItem(mstrmojo.desc(1388,"Rename"),V,function(){mstrmojo.all[V].renameItem(a,Z);});O.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[V].deleteItem(b,P.idx);});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.TemplateBasedDropZones","mstrmojo.vi.models.EnumDragSources","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.array","mstrmojo.hash","mstrmojo.func");var I=mstrmojo.array,C=mstrmojo.hash,M="-1",P=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION;function O(){var Q=this.getHostModel();return Q?Q.gsi:null;}function L(Z,W,U,Y,Q){var a=this.getHost(),V=a.controller,S,X;S=Z.did;X=Z.t;if(Q){var R=this.getUnitIndexInZone(W,Z);if(R!==-1){if(R<Y){Y--;}}}V.submitUndoRedoUpdates(this.getUpdateTemplateAction([a.model.getPivotUnitAction(U,Y,S,X)]),null,mstrmojo.func.wrapMethods(V._getXtabCallback(a),this.getUpdateCallback()));}function J(U){var d=U.item,Y=U.zone,Q=U.dsid,b=U.index,R=U.edge,a=U.isPivot;var e=this.getHost(),X=e.controller,c=Y.items,W=e.model,S=Y.id,V=[];if(c.length){if(R===P.ON){var Z=c[b];V.push(W.getRemoveTemplateUnitAction(Z));}else{if(R===P.BELOW){b++;}}}else{b=0;}if(a&&R!==P.ON){L.call(this,d,Y,S,b,true);return ;}V.push(W.getAddTemplateUnitAction(d,Q,S,b));X.submitUndoRedoUpdates((U.actions||[]).concat(this.getUpdateTemplateAction(V)),null,mstrmojo.func.wrapMethods(X._getXtabCallback(e),this.getUpdateCallback()));}function K(Q){return Q.src.data.src===mstrmojo.vi.models.EnumDragSources.VIZ_EDITOR;}mstrmojo.vi.models.BaseVisDropZones=mstrmojo.declare(mstrmojo.vi.models.TemplateBasedDropZones,null,{scriptClass:"mstrmojo.vi.models.BaseVisDropZones",addZoneItem:function A(S,U,R){var V=R.mx,Q;if(S.did===M){I.forEach(V,function(W){Q={did:W.did,n:W.n,t:4};U.push(Q);});}else{this._super(S,U);}},getDropZones:function N(){var Q=O.call(this),R=this.getHost();return Q?{n:R.defn.ttl,zones:[this.getZone(mstrmojo.desc(3581,"Attributes"),1,Q.rows,false,{mx:Q.mx,title:mstrmojo.desc(13828)}),this.getZone(mstrmojo.desc(3582,"Metrics"),-1,Q.mx,false,{mx:Q.mx,title:mstrmojo.desc(13827)})]}:{n:R.defn.ttl,zones:[]};},getAvatarIconClass:function G(){return"viXtab";},getAllowDropInfo:function F(R,S,Q,V,U){var X=this._super(R,S,Q,V,U),W=R.id===-1;return C.copy({allowedItems:X.allowedItems.filter(function(Z){var Y=Z.t===4;return W?Y:!Y;})},X);},unitsDropped:function E(Q,S,U,W,V){var R=U.allowedItems[0];J.call(this,{item:R,zone:Q,dsid:S.src.data.dsid,index:U.idx,edge:U.edge,isPivot:K(S),actions:S.actions});},deleteItem:function B(R,Q){this.deleteItems(R,[R.items[Q]]);},deleteItems:function D(R,S){var U=this.getHost(),Q=U.controller,V=[];(S||[]).forEach(function(W){V.push(U.model.getRemoveTemplateUnitAction(W));});if(V.length){Q.submitUndoRedoUpdates(this.getUpdateTemplateAction(V),null,mstrmojo.func.wrapMethods(Q._getXtabCallback(U),this.getUpdateCallback()));}},getExtraUnitMenuItems:function H(R,Q,U,S){this._super(R,Q,U,S);if(U.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Metric&&this.getHost().showThreshold){R.addSeparator();this.buildThresholdMenuOptions(R,{item:U},true);}},getHostModel:function(){return this.getHost().model.data;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.EditorModel","mstrmojo.models.FormatModel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.vi.ui.rw.DocRelativePanel","mstrmojo.ui.editors.CharacterToolbarPopup","mstrmojo.array","mstrmojo.hash","mstrmojo.VisEnum");var B=0,I=mstrmojo.array,J=mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS,Y=mstrmojo.models.FormatModel,H=Y.ENUM_PROPERTY_NAMES.TEXT_ALIGN,M=mstrmojo.hash,Z=B,Q=B,L=mstrmojo.VisEnum.SERVER_JSON_ERROR_TYPE,W=mstrmojo.vi.ui.TextAlignButtonBar.TEXT_ALIGN;function N(f,a,c,g,d){var b=f===this.getTitleFormatCode(),e;if(c===H){e=function(h){return this.titleAlignButtonBar.items.filter(function(i){return i.v===h;})[0].id;}.bind(this);}this.getHost().parent.changeUnitFormats(b,f,a,c,g,d,e,function(h){this.raiseEvent({name:"BEMFormatChange",propertyName:c,value:h,isTitle:b});}.bind(this));}function V(b,c){var a=new mstrmojo.vi.ui.TextAlignButtonBar({includeJustify:false});this.titleAlignButtonBar=a;a.singleSelect(a.items.map(function(d){return d.id;}).indexOf(b));a.onValueChange=function(e,d){c(H,e,d);};return a;}function C(c){var f=this.getHost().getFormats(),i=f.ttl,g=[];if(i){var d=this,a=N.bind(this,this.getTitleFormatCode(),f),h=this.getHost(),b=h.parent.getTitleBarVisibility(),e=[this.getCharacterGroup(a,i),V.call(this,Y.getFormatBlockValue(i,H),a),this.getContainerGroup(i,a,J.FILL_COLOR,{showBackgroundNoFill:true})];e.forEach(function(j){j.set("enabled",b);});g.push(this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(4756,"Title")),this.getCheckboxAndLabel(b,mstrmojo.desc(13599,"Show titlebar"),function(k){var j=d.getHost();if(j){j.parent.toggleTitleBar(!!k);}})].concat(e),{cssClass:"bem-tc-title",showDivider:false}));}g.push(this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(11917,"Container")),this.getContainerGroup(f,N.bind(this,1,f),this.getContainerCtrlFlags(),{showBackgroundNoFill:true,showBorderNoFill:true})],{cssClass:"bem-tc-container"}));this.replaceChildControls(c,g.concat(this.getTitleAndContainerControls()));}function D(a){var c=this.getTargetPulldownItems(a);var b=this.getPulldown(c,function(d){if(c.length>1){Z=d;}else{Z=Q;}c[c.map(function(e){return e.v;}).indexOf(d)].h(d);if(a&&a.postUpdateFn){a.postUpdateFn();}});if(b.items&&b.items.length){b.set("selectedIndex",Math.max(c.map(function(d){return d.v;}).indexOf(Z),0));}return b;}mstrmojo.vi.models.editors.BaseEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.BaseEditorModel",titleAlignButtonBar:null,init:function S(a){this._super(a);Q=this.getInitialTarget(Z);Z=Q;},selectTargetByValue:function O(a){if(a!==undefined){var b=this._targetPulldown;if(b){b.selectItemByField("v",a);}}},getInitialTarget:function X(){return B;},getEditorContents:function R(a){var b=this.getEditorGroup([],{cssClass:"bem-dynamic-grp",showDivider:false,isNested:true,isContainer:true,postUpdateFn:a});var e=this._targetPulldown;if(e&&"function"===typeof e.destroy){I.removeItem(this.disposables,e);e.destroy();}var d=this._targetPulldown=D.call(this,b),c=[b].concat(this.getCommonControls());if(d.items.length>1){c.unshift(this.getEditorGroup([d]));}this.addDisposable(d);return c;},getFormattingToolbar:function F(b,g,c){if(b===B){var f=this.getHost(),a=f.getFormats(),e=a.ttl;if(e){e=M.copy(e);e[H]=this.titleAlignButtonBar.items.filter(function(h){return h.id===e["text-align"];});e[H]=e[H].length>0?e[H][0].v:W.LEFT;var d=new mstrmojo.ui.editors.CharacterToolbarPopup(M.copy({onGroupValueChange:N.bind(this,this.getTitleFormatCode(),a),textAlignJustify:false,textAlignFmtName:H,anchorElement:g},c));d.setFormatSource(e);return d;}}return null;},getCommonControls:function E(){return[];},getContainerCtrlFlags:function A(){var a=this.docModel&&this.docModel.isFreeFormPanel();return J.FILL_COLOR+J.BORDER+(a?J.SIZE_POSITION:0);},getTitleAndContainerControls:function U(){return[];},getTargetPulldownItems:function G(b){var d=this.getHost(),a=d.getFormats(),c=[];if(a&&(d.showTitleAndContainerFormats!==false)&&!mstrApp.isInVFConfigMode){c.push({n:mstrmojo.desc(12049,"Title and Container"),v:B,h:C.bind(this,b)});}return c;},getTitleFormatCode:function K(){return 2;},isNormalOrExcludeAllDataButNotInPauseMode:function P(c){var a=!c.isEmpty()||c.errorType===L.EMPTY_DATA,b=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();return a&&!b;}});mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE=B;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.vi.models.editors.ControlsViewFactory","mstrmojo.vi.models.editors.EditorModel","mstrmojo.models.FormatModel","mstrmojo.CustomVisBase","mstrmojo.ui.CheckList","mstrmojo.ui.editors.controls.Stepper","mstrmojo.NumGroupStepperContentProvider","mstrmojo.gm.GMEnums","mstrmojo.FormatControlHelper","mstrmojo.CustomVisUtility","mstrmojo.customviz.CustomVisEnums");mstrmojo.requiresClsP("mstrmojo.ui.editors.controls","ComboBox","PreviewButton","CharacterGroup","FillConfigGroup","LineConfigGroup");var Y=mstrmojo.emptyFn,R=mstrmojo.array,H=mstrmojo.hash,f=R.ensureArray,S=mstrmojo.Button.newWebButton,V=mstrmojo.FormatControlHelper,U=mstrmojo.CustomVisUtility,F=mstrmojo.customviz.CustomVisEnums,A=F.ENUM_LEGEND_PROPS,b="30%",c="70%";function Z(l,n){var m=null,o;if(typeof n==="number"){R.forEach(l,function(q,p){if(!o){m=p;}else{if((n-q.value)*(n-o.value)<=0){m=Math.abs(n-q.value)<Math.abs(n-o.value)?p:p-1;return false;}}o=q;});}else{if(typeof n==="string"){R.forEach(l,function(q,p){if(q.value.toString()===n){m=p;return false;}});}}return m;}function L(l){return f(l).map(function(m){return{n:m.name,v:m.value};});}function B(n,o,l){var m=this.getHost();m.savePropertyAndUpdateWidget(n,o,l);}function J(m,l){m.set("enabled",!l.disabled);var n=f(l.items);if(n.length>0&&m.getChildControl instanceof Function){n.forEach(function(o){var q=m.getChildControl(o.childName),p=o.disabled;if(q&&p!==undefined){q.set("enabled",!p);}});}}function e(l,o,n,m){l.forEach(function(s,q){s.slot="col"+(q+1)+"Node";});m=H.copy(m,{col1Width:o,col2Width:n,children:l});var p=new mstrmojo.ui.editors.controls.TwoColumnContainer(m);J(p,m);return p;}function d(q){var o=this,n=o.getHost(),l=q.propertyName,m=Z.call(this,q.items,n.getProperty(l));var p=this.getPulldown(L(q.items),function(s){B.call(o,l,s,q.config);},m||0);J(p,q);return p;}function j(m,l){var n={};if(l){m.forEach(function(p,o){var q=l[p.propertyName];if(U.parseBoolean(q)){n[o]=true;}});}return n;}function Q(s){var n=this,m=n.getHost(),l=s.propertyName,p=m.getProperty(l),q=U.parseBoolean(p);var o=this.getCheckboxAndLabel(q,s.labelText,function(t){B.call(n,l,t.toString(),s.config);});J(o,s);return o;}function g(m,l,q){var s=this,u=s.getHost(),o=m.propertyName,p=f(m.items).map(function(w){return{n:w.labelText,propertyName:w.propertyName};});var t={items:p,multiSelect:m.multiSelect,selectedIndices:j(p,u.getProperty(o)),postselectionChange:function(w){var z=w.added,AA=this.items[z?z[0]:w.removed[0]],y=!!z,x=H.clone(u.getProperty(o))||{};if(this.multiSelect){x[AA.propertyName]=y.toString();}else{this.items.forEach(function(AB){x[AB.propertyName]=(AB===AA?y:!y).toString();});}B.call(s,o,x,m.config);}};H.copy(q,t);var n=new l(t);J(n,m);return n;}function D(l){return g.call(this,l,mstrmojo.ui.ButtonBar,{showIcon:false});}function G(l){return g.call(this,l,mstrmojo.ui.CheckList,{cssClass:"selectors",orientation:l.orientation});}function E(n){var m=this,l=[];R.forEach(n,function(o){l.push(K.call(m,o));});return l;}function O(l){return new mstrmojo.Label({text:l});}function I(s){var p=this,o=p.getHost(),l=s.propertyName,m=s.config;var n={value:o.getProperty(l),onValid:function(){B.call(p,l,this.value,m);}};var q=new mstrmojo.ui.editors.controls.ValidationTextBox(n);J(q,s);return q;}function k(q){var o=this,n=o.getHost(),l=q.propertyName;var m={provider:new mstrmojo.NumStepperContentProvider({item:{interval:1,value:Number(n.getProperty(l))||q.min||0},min:q.min,max:q.max,container:this,onTraverse:function(){B.call(o,l,this.curVal,q.config);}})};var p=new mstrmojo.ui.editors.controls.Stepper(m);J(p,q);return p;}function C(q){var o=this,n=o.getHost(),l=q.propertyName;var m={selectedValue:n.getProperty(l),items:L(q.items),isHostedWithin:false,postselectedValueChange:function(s){B.call(o,l,s.value,q.config);}};var p=new mstrmojo.ui.editors.controls.ComboBox(m);J(p,q);return p;}function X(n){var m=this.getHost().id;var l=new mstrmojo.Button(mstrmojo.Button.newWebButton(n.labelText,function(){if(typeof n.callback==="function"){n.callback.call(mstrmojo.all[m]);}},n.isHotButton));J(l,n);return l;}function W(p,t,o,s){var n=p.style,q=p.propertyName,l=mstrmojo.vi.models.editors.CustomVisEditorModel.WIDGET_TYPE,m=/^[a-z A-Z\u4e00-\u9fa5:]{1}([\w]|[\u4e00-\u9fa5]|[-.:_]){1,}$/;if(n&&p.style!==l.TWOCOLUMN&&p.style!==l.EDITORGROUP){if(!!q&&o.indexOf(q)!==-1&&t.indexOf(q)===-1){t.push(q);}else{if(!!q&&o.indexOf(q)===-1){o.push(q);}}if(!m.test(q)&&s.indexOf(q)===-1){s.push(q);}return ;}else{if(n&&(p.style===l.TWOCOLUMN||p.style===l.EDITORGROUP)){W(f(p.items),t,o,s);}}R.forEach(p,function(u){W(u,t,o,s);});}function K(s){var q=this.getHost();switch(s.style){case P.TWOCOLUMN:var n=f(s.items),p=n[0],m=n[1],o,l;o=(p&&p.width)||b;l=(m&&m.width)||c;return e.call(this,E.call(this,n),o,l,s);case P.PULLDOWN:return d.call(this,s);case P.LABEL:return O.call(this,s.labelText);case P.BUTTONBAR:return D.call(this,s);case P.CHECKBOXANDLABEL:return Q.call(this,s);case P.CHECKLIST:return G.call(this,s);case P.TEXTBOX:return I.call(this,s);case P.STEPPER:return k.call(this,s);case P.COMBOBOX:return C.call(this,s);case P.CHARACTERGROUP:return V.getCharacterGroupControl(q,s);case P.FILLGROUP:return V.getFillGroupControl(q,s);case P.LINEGROUP:return V.getLineGroupControl(q,s);case P.COLORBYGROUP:return V.getColorByGroupControl(q,s);case P.BUTTON:return X.call(this,s);}}function i(m){var n=this,l=[];R.forEach(f(m),function(o){l.push(K.call(n,o));});return l;}function M(p,m){var l=[],n,o=this;R.forEach(p,function(q){n=f(q.items);switch(q.style){case"EditorGroup":if(n&&n.length){l.push(o.getEditorGroup(i.call(o,n)));}break;default:l.push(K.call(o,q));}});this.replaceChildControls(m,l);}function h(p){var s,l,o,q={},n=-1,m=function(u,t){R.forEach(u,function(y){var w=y.style,x=y.propertyName;if(w){if(w===P.TWOCOLUMN||w===P.EDITORGROUP){m(y.items,t);}else{if(w===P.COLORBYGROUP){n=t;}else{if(!!x){q[x]=t;}}}}});};for(o=0;o<p.length;o++){s=p[o];l=s&&s.v;m(l,o);}this.propertyPanelIdxMap=q;this.colorbyGroupPanelIdx=n;}function N(p){var s=this,q=s.getHost(),o=F.LEGEND_PROPERTY_SET,n=q.getLegendProperty(A.SHOW_LEGEND),l=q.getLegendProperty(A.LEGEND_WIDTH_SCALE),m=[],t;t=this.getCheckboxAndLabel(n,mstrmojo.desc(13600,"Show legend"),function(u){q.saveObjectProperty(o,A.SHOW_LEGEND,u.toString());});m.push(t);m.push(K.call(this,{style:P.CHARACTERGROUP,propertyName:o,disabled:!n}));m.push(K.call(this,{style:P.LABEL,labelText:mstrmojo.desc(13601,"Fill:")}));m.push(K.call(this,{style:P.FILLGROUP,propertyName:o,disabled:!n}));m.push(K.call(this,{style:P.BUTTON,labelText:mstrmojo.desc(16685,"Reset Width"),callback:function(){q.saveObjectProperty(o,A.LEGEND_WIDTH_SCALE,undefined);},disabled:!n||l===undefined}));this.replaceChildControls(p,[this.getEditorGroup(m)]);}mstrmojo.vi.models.editors.CustomVisEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.CustomVisEditorModel",getTargetPulldownItems:function a(q){var n=this._super(q),s,t=this,AA=this.getHost(),u=[],l=[],w=[],p=[],z,x;s=L(this.getCustomProperty());R.forEach(s,function(AB){if(!!AB.v){u=u.concat(AB.v);}});if(!!u.length){W(u,l,w,p);}z=l&&l.length;x=p&&p.length;if(z||x){var y="The following property name are repeated: ##.",m="The following property name are invalid: **.",o=(z&&x)?y+m:(z?y:m);mstrmojo.warn(mstrmojo.desc(null,o).replace("##",l).replace("**",p),{},{buttons:[S(mstrmojo.desc(1442,"OK"),mstrmojo.emptyFn)]});}else{if(s.length){n=(f(n)).concat(s);R.forEach(n,function(AB){if(AB.v){AB.h=M.bind(t,f(AB.v),q);}});h.call(this,n);}}if(AA.enableLegend&&!U.isInPauseMode()&&AA.hasColorByOrSizeBy()){n.push({n:mstrmojo.desc(2403,"Legend"),v:"CATEGORIES_LEGEND",h:N.bind(this,q)});this.propertyPanelIdxMap[F.LEGEND_PROPERTY_SET]=n.length-1;}return n;},getCustomProperty:Y});var P=mstrmojo.vi.models.editors.CustomVisEditorModel.WIDGET_TYPE={PULLDOWN:"PullDown",BUTTONBAR:"ButtonBar",CHECKLIST:"CheckList",STEPPER:"Stepper",COMBOBOX:"ComboBox",TEXTBOX:"TextBox",CHECKBOXANDLABEL:"CheckBoxAndLabel",EDITORGROUP:"EditorGroup",TWOCOLUMN:"TwoColumn",LABEL:"Label",CHARACTERGROUP:"CharacterGroup",FILLGROUP:"FillGroup",LINEGROUP:"LineGroup",COLORBYGROUP:"ColorByGroup",BUTTON:"Button"};mstrmojo.vi.models.editors.CustomVisEditorModel.ENUM_LINE_STYLE=mstrmojo.gm.EnumCombinedLineStyle;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.BaseVisDropZones","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.viz.EnumWidgetTypes","mstrmojo.vi.util.ThresholdUtils","mstrmojo.CustomVisUtility","mstrmojo.array","mstrmojo.hash","mstrmojo.func");var m=mstrmojo.array,Z=mstrmojo.hash,AG=mstrmojo.func,z=mstrmojo.vi.ui.DatasetUnitMenuUtils,n=mstrmojo.vi.models.EnumDragSources,y=mstrmojo.emptyFn,x="-1",AF=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,g=mstrmojo.vi.viz.EnumDSSDropZones,w=mstrmojo.vi.viz.EnumWidgetTypes,O=mstrmojo.vi.util.ThresholdUtils,A=mstrmojo.CustomVisUtility.error,P=mstrmojo.CustomVisUtility.warn;var AB=0,M=1,G=2,s=3;var c={ATTRIBUTE:":ATTR",METRIC:":METR"};var F=["XAxis","YAxis","BreakBy","SliceBy","ColorBy","SizeBy","AdditionalMetrics","Angle","Grouping","GeoAttribute","Layout","FromItem","ToItem","ItemSize","Latitude","Longitude","Metric","Trend"];function Q(AM){var AN={Angle:"AngleBy",Grouping:"Grp",GeoAttribute:"Geo",Layout:"layout",FromItem:"from",ToItem:"to",ItemSize:"itemsz",Latitude:"Lat",Longitude:"Long",Metric:"metric",Trend:"trend"};if(AN.hasOwnProperty(AM)){return AN[AM];}return AM;}function K(AM){return AM===-1||AM===g.Rows||AM===g.Columns;}function B(){var AP=[],AM=this.getHost().model,AO=this.getHostStructure(),AN=[{n:"rows",axis:g.Rows},{n:"cols",axis:g.Columns},{n:"mx",axis:-1}];m.forEach(AN,function(AQ){m.forEach(AO[AQ.n],function(AS,AR){if(AS.did!==x){AP.push(AM.getRemoveTemplateUnitAction(Z.copy(AS,{axis:AQ.axis,unitPos:AR+1})));}});});return AP;}function AK(AN){var AM=false;m.forEach(this.getCustomDropZones(),function(AP,AR){var AQ=F[AR],AO=g[AQ];if(AN.id===AO){AM=!!AP.isColorBy;return false;}});return AM;}function o(AM,AN){return AK.call(this,AM)&&this.isMetric(AN);}function AE(AS,AR,AO){var AT=this.getHost(),AU=AR&&AR[0],AP,AM,AN,AQ=false;if(o.call(this,AS,AU)){AP=this.getDefaultThresholdColorsAndBands();if(AP){AM=AP.colors;AN=AP.bands;if(!m.isArray(AM)||!m.isArray(AN)){A("Type of threshold colors and bands should be Array!");AQ=true;}if(AN.length!==AM.length-1){A("The length of threshold bands should be equal to the length of threshold colors - 1");AQ=true;}}if(AQ){AM=undefined;AN=undefined;}O.addThresholds(AT.model,AT,AT.node,AU,AO,AM,AN);}}function AA(AV,AU,AW,AN,AS){var AX=this.getHost(),AR=AX.model,AM=AV.id,AT=K(AM),AO={datasetId:AS},AP=[];if(!AT){var AQ=true;m.forEach(this.dropZones,function(AY){if(AY.items.length>0){AQ=false;return false;}});if(AQ){AP.push({act:"createDefaultDropZones",nodeKey:AX.k,treeType:AX.defn.tt,datasetId:AR.data.datasetId,datasetType:3,widgetType:w.CUSTOM,partialUpdate:{nodes:[AX.k]}});AP=AP.concat(B.call(this));}}if(AN){if(AT){AP.push(AR.getRemoveTemplateUnitAction(AN));}else{AP=AP.concat(this.getRemoveDropZoneUnitActions(AV,AN));}}if(AT){m.forEach(AU,function(AY){AP.push(AR.getAddTemplateUnitAction(AY,AS,AM,AW));});}else{AP=AP.concat(this.getAddDropZoneUnitsActions(AV,AU,AW,AO)||[]);}AE.call(this,AV,AU,AP);return AP;}function D(AN,AM){var AO=AN.allowObjectType;if(AN.isColorBy){if(!AM.cbDefined){AM.cbDefined=true;}else{P("More than one dropzone are marked as 'isColorBy'.");}if(AO===V.ATTRIBUTE_AND_METRIC){P("The dropzone marked as 'isColorBy' should NOT accept 'ATTRIBUTE_AND_METRIC' object type. Otherwise, we will use color by attributes by default.");}else{if(AO===V.METRIC&&AN.maxCapacity!==1){P("The 'maxCapacity' should be 1 for the dropzone marked as 'isColorBy' and allowObjectType is 'METRIC'. Otherwise we will only use the first metric.");}}}if(AN.isSizeBy){if(!AM.sbDefined){AM.sbDefined=true;}else{P("More than one dropzone are marked as 'isSizeBy'.");}if(AO!==V.METRIC){P("The dropzone marked as 'isSizeBy' should ONLY accept 'METRIC' object type.");}if(AN.maxCapacity!==1){P("The 'maxCapacity' should be 1 for the dropzone marked as 'isSizeBy'. Otherwise we will only use the first metric.");}}}function S(AN){var AT=AN&&AN.length;if(!AT){return null;}var AP=F.length;if(AT>AP){throw"ERROR: Defined drop zones exceeds max capacity: "+AP+"!";}var AS=this,AO=[],AQ=[],AM={};var AR=function(AW){var AU=false;try{if(AW){AU=(new Function("return "+AW)).call(this);}}catch(AV){AU=false;}return AU;};m.forEach(AN,function(AU,AW){var AX=AU.name,AV=F[AW];if(m.indexOf(AQ,AX)>-1){throw"ERROR: More than one drop zones have same name!";}AQ.push(AX);D(AU,AM);AO.push(AS.getZone(AX,g[AV],AS.getDZFlatStruct()[Q(AV)],AR.call(AS,AU.disabled),{title:AU.title,allowSingle:AU.maxCapacity===1}));});return AO;}function l(AN){var AM=-1;m.forEach(this.getCustomDropZones(),function(AO,AP){if(AO.name===AN){AM=AP;return false;}});return AM;}function Y(AS,AO,AN){var AT=this,AP=AB,AM=Number.MAX_VALUE,AR=-1;m.forEach(this.getCustomDropZones(),function(AW,AX){if(AW.name===AS.n){AP=AW.allowObjectType;AM=AW.maxCapacity;AR=AX;return false;}});if(AR===-1){return AO;}var AU=this.isReplacing(AN),AQ=this.getDropZoneObjectsByIndex(AR),AV=AQ.length;if(!AU&&AV>=AM){return[];}return m.filter(AO,function(AX){var AW=AT.isMetric(AX);switch(AP){case M:return !AW;case G:return AW;case s:return !AV?true:((AV===1&&AU)||(AT.isMetric(AQ[0])===AW));}return true;});}function AL(AN,AQ,AR){var AP=this,AM=AN.allowObjectType;if(AM!==AR&&AQ.length>0){if(AM===s&&AR===M&&m.filterOne(this._dropZoneTransitions,function(AS){return AS.toZoneId===g[F[l.call(AP,AN.name)]]&&!AP.isMetric(AS.obj);})){return ;}var AO=Math.min(AN.maxCapacity||Number.MAX_VALUE,AQ.length);this.transitionObjectsToZone(AN.name,AQ.splice(0,AO));}}function N(AN,AM,AO){var AR=this.getCustomDropZones(),AQ=[],AP=this;m.forEach(AR,function(AS,AT){if(AS[AN]){AQ=AP.getDropZoneObjectsByIndex(AT);return false;}});return m.filter(AQ,function(AS){return AM?AP.isMetric(AS):!AP.isMetric(AS);},AO);}function AI(AN,AM){return AN.indexOf(AM,AN.length-AM.length)!==-1;}mstrmojo.vi.models.CustomVisDropZones=mstrmojo.declare(mstrmojo.vi.models.BaseVisDropZones,null,{scriptClass:"mstrmojo.vi.models.CustomVisDropZones",getDropZones:function q(){var AO=this.getHostStructure(),AP=this.getHost(),AN=S.call(this,this.getCustomDropZones()),AM=AO?(AN||this._super().zones):[];this.dropZones=AM;return{n:AP.defn.ttl,zones:AM};},getAllowDropInfo:function C(AN,AO,AM,AQ,AP){AO=Y.call(this,AN,AO,AQ);return Z.copy(this.shouldAllowObjectsInDropZone(AN,AO,AM,AQ,AP),{allowedItems:AO.concat(),removeReplaced:AQ===AF.ON&&AN.items[AM]&&m.find(AO,"did",AN.items[AM].did)===-1});},unitsDropped:function AH(AU,AM,AW){var AX=this.getHost(),AS=AM.src.data,AQ=AM.actions||[],AY=AW.idx,AT,AO,AV=this,AZ=AV.docModel,AR=AW.allowedItems,AP=(this.isReplacing(AW.edge)&&AW.removeReplaced)?AU.items[AY]:null,AN=AA.call(this,AU,AR,this.getDropTargetIndex(AU,AW),AP,AS.dsid);AN=AN.concat(this.getActionsForObjectsDropped(AU,AR,this.getDropTargetIndex(AU,AW),AP,{datasetId:AS.dsid})||[]);AT=AQ.concat(this.getUpdateTemplateAction(AN));AO=function(Aa){return function(){var Ab=Aa?AX.model.wrapUnsetVisualizationFilterAction(AT):AT;AV.submitDropZoneUpdates(Ab,AG.wrapMethods(AM.callback,AX.model.docModel.controller._getXtabCallback(AX)));};};AZ.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:AT,zm:AV},AO(true),AO(false));},getRemoveDropZoneUnitActions:function E(AM,AN,AO){var AP=this._super(AM,AN,AO);if(o.call(this,AM,AN)){AP=this.getRemoveThresholdsActions(AM,AN).concat(AP);}return AP;},deleteItems:function H(AN,AO){var AP=this,AM=[];m.forEach(AO,function(AQ){if(K(AN.id)){AM.push(AP.getHost().model.getRemoveTemplateUnitAction(AQ));}else{AM=AM.concat(AP.getRemoveDropZoneUnitActions(AN,AQ));}});AM=AM.concat(this.getActionsForObjectsRemoved(AN,AO)||[]);this.submitDropZoneTemplateUpdates(AM);},getUnitMenuItems:function p(AS,AT,AW,AO){this._super(AS,AT,AW,AO,true);var AV=this.getHost(),AN=AS.getMenuItems(true),AU=m.find(AN,"n","Edit Groups..."),AR=m.find(AN,"n","Create Groups..."),AX=Z.walk("model.data.gts.row",AV),AQ=AX?m.find(AX,"id",AW.did):-1;if(AX&&AQ!==-1){var AM,AP=function(){var AY={otp:AW.t,id:AW.did,n:AW.n,axis:1,ui:AQ};AV.derivedElementsEdit(AY);};if(AU!==-1){AM=AN[AU];AM.fn=AP;}if(AR!==-1){AM=AN[AR];AM.fn=AP;}}if(!AV.showThreshold&&o.call(this,AT,AW)){AS.addSeparator();this.buildThresholdMenuOptions(AS,{item:AW},true);}this.getDropZoneContextMenuItems(AS,AT,AW,AO);},getClearAllUnitsActions:function R(){return mstrmojo.vi.models.DropZonesModel.prototype.getClearAllUnitsActions.call(this);},transitionDropZones:function I(AM,AN){this._dropZoneTransitions=[];this.customDropZonesTransition(AM,AN);return this._dropZoneTransitions;},getColorByAttributes:function(){return N.call(this,"isColorBy",false);},getColorByMetric:function(){return N.call(this,"isColorBy",true,{max:1})[0];},getSizeByMetric:function(){return N.call(this,"isSizeBy",true,{max:1})[0];},useAbsoluteSizeByValue:function(){var AN=this.getCustomDropZones(),AM=m.find(AN,"isSizeBy",true);return AM>-1?!!AN[AM].useAbsolute:false;},getDropZone:function(AM){switch(typeof AM){case"number":return this.dropZones[AM];case"string":return this.getDropZone(m.find(this.dropZones,"n",AM));case"object":return AM;default:return undefined;}},getDefaultTooltipOrder:function f(){var AN=this.getCustomDropZones(),AM=[];m.forEach(AN,function(AO){AM.push(AO.name);});return[AM];},setTooltipObjsOrder:function W(AN){var AR=this.getHost(),AV=[],AT=[],AQ,AP=AN.length,AS,AU,AO=this;for(var AM=0;AM<AP;AM++){AS=AN[AM];if(m.isArray(AS)){m.forEach(AS,function(AW){AU=undefined;if(AI(AW,c.ATTRIBUTE)){AW=AW.replace(c.ATTRIBUTE,"");AU=false;}if(AI(AW,c.METRIC)){AW=AW.replace(c.METRIC,"");AU=true;}AV=AO.getDropZoneObjectsByName(AW);m.forEach(AV,function(AX){if(AU===undefined||(AU===true&&AO.isMetric(AX))||(AU===false&&!AO.isMetric(AX))){if(AT.indexOf(AX.id)===-1){AT.push(AX.id);}}});});AQ=AT.length;if(AQ&&(AT[AQ-1]!=="seperate")&&(AM<(AP-1))){AT.push("seperate");}}}if(AT.length&&AT[0]==="seperate"){AT=AT.shift();}AQ=AT.length;if(AQ&&AT[AQ-1]==="seperate"){AT.pop();}AR.tooltipObjsInOrder=AT;},getNotAdditionalAttrIds:function L(){var AP=this.getCustomDropZones(),AN,AO=[],AM=this;m.forEach(AP,function(AQ){if(AQ.isAdditionalInfo!==true){AN=AM.getDropZoneObjectsByName(AQ.name);m.forEach(AN,function(AR){if(!AM.isMetric(AR)){AO.push(AR.id);}});}});return AO;},getAdditionalAttrIds:function e(){var AQ=this.getCustomDropZones(),AN,AP=[],AM=this,AO=this.getNotAdditionalAttrIds();m.forEach(AQ,function(AR){if(AR.isAdditionalInfo===true){AN=AM.getDropZoneObjectsByName(AR.name);m.forEach(AN,function(AS){if(!AM.isMetric(AS)&&(AO.indexOf(AS.id)===-1)){AP.push(AS.id);}});}});return AP;},getCustomDropZones:y,getActionsForDoubleClick:function(AO,AN){var AM=this;var AP=[];m.forEach(this.dropZones,function(AQ){if(AM.isObjectAllowedForDropZone(AO,AQ)){AP=AA.call(AM,AQ,[AO],AQ.items.length,null,AN);return false;}});return AP;},isObjectAllowedForDropZone:function(AQ,AR,AM,AP){var AN=this.getDropZone(AR);if(!AN){return false;}var AO=this.getAllowDropInfo(AN,[AQ],AM===undefined?AN.items.length:AM,AP===undefined?AF.BELOW:AP,{src:{data:{src:n.DATASETS}}});return AO.allowedItems.length>0;},getActionsForObjectsDropped:y,getActionsForObjectsRemoved:y,getDropZoneContextMenuItems:y,shouldAllowObjectsInDropZone:y,getDefaultThresholdColorsAndBands:y,getHostStructure:function AD(){var AM=this.getHostModel();return AM&&AM.gsi;},getDropZoneObjectsByIndex:function h(AM){return this.getDZFlatStruct()[Q(F[AM])]||[];},getAddDropZoneObjectsActions:function i(AS,AR,AQ,AM,AP){var AN=this.getDropZone(AR);var AO=this.getAddDropZoneUnitsActions(this.getZoneModelByName(AR),m.ensureArray(AQ),AM===undefined?AN.items.length:AM,AP);m.insert(AS,undefined,AO);},getRemoveDropZoneObjectsActions:function u(AP,AO,AN){var AM=this;m.forEach(m.ensureArray(AN),function(AQ){Array.prototype.push.apply(AP,AM.getRemoveDropZoneUnitActions(AM.getZoneModelByName(AO),AQ));});},getReplaceDropZoneObjectsActions:function(AQ,AP,AN,AM){var AO=this.getDropZone(AP).items;this.getRemoveDropZoneObjectsActions(AQ,AP,AO[AM]?[AO[AM]]:[]);this.getAddDropZoneObjectsActions(AQ,AP,[AN],AM);},getDropZoneObjectsByName:function k(AM){return this.getDropZoneObjectsByIndex(l.call(this,AM));},isMetric:function t(AM){return AM&&AM.t===4;},isGeoAttr:function(AM){return z.isGeoAttr(AM,AM.useAvailGeoFmsOnly);},isTimeAttr:function(AM){return z.isTimeAttr(AM);},isSameObject:function b(AN,AM){return AN&&AM&&(AN.did||AN.oid||AN.id)===(AM.did||AM.oid||AM.id);},isReplacing:function j(AM){return AM===AF.ON;},isObjectInZone:function X(AM,AO){var AN=this;return m.filter(AN.getDropZoneObjectsByName(AO),function(AP){return AN.isSameObject(AP,AM);}).length>0;},isZoneEmpty:function AJ(AM){return(this.getDropZoneObjectsByName(AM)||[]).length===0;},getZoneModelByName:function U(AM){return this.getZoneModelByZoneId(g[F[l.call(this,AM)]]);},getAvatarIconClass:function d(){return"viXtab";},getDropZoneName:function AC(AM){return AM&&AM.n;},transitionObjectsToZone:function a(AO,AN){var AM=this._dropZoneTransitions,AP=l.call(this,AO);if(AM&&AP!==-1&&AN){m.ensureArray(AN).forEach(function(AQ){AM.push({obj:AQ,toZoneId:g[F[AP]]});});}},customDropZonesTransition:function J(AN,AO){var AP=this,AM=this.getCustomDropZones()||[];AM.forEach(function(AQ){AL.call(AP,AQ,AN,G);AL.call(AP,AQ,AO,M);});}});mstrmojo.vi.models.CustomVisDropZones.ENUM_ALLOW_DROP_TYPE={ATTRIBUTE_AND_METRIC:AB,ATTRIBUTE:M,METRIC:G,ATTRIBUTE_OR_METRIC:s};var V=mstrmojo.vi.models.CustomVisDropZones.ENUM_ALLOW_DROP_TYPE;mstrmojo.vi.models.CustomVisDropZones.CUSTOM_DZ_SUFFIX=c;}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.Refine.DateTimeUtil=mstrmojo.declare(mstrmojo.Obj,null,null);Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};(function(){var B=Date,A=B.prototype,D=B.CultureInfo,G=function(I,H){if(!H){H=2;}return("000"+I).slice(H*-1);};A.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this;};A.setTimeToNow=function(){var H=new Date();this.setHours(H.getHours());this.setMinutes(H.getMinutes());this.setSeconds(H.getSeconds());this.setMilliseconds(H.getMilliseconds());return this;};B.today=function(){return new Date().clearTime();};B.compare=function(I,H){if(isNaN(I)||isNaN(H)){throw new Error(I+" - "+H);}else{if(I instanceof Date&&H instanceof Date){return(I<H)?-1:(I>H)?1:0;}else{throw new TypeError(I+" - "+H);}}};B.equals=function(I,H){return(I.compareTo(H)===0);};B.getDayNumberFromName=function(I){var M=D.dayNames,H=D.abbreviatedDayNames,L=D.shortestDayNames,K=I.toLowerCase();for(var J=0;J<M.length;J++){if(M[J].toLowerCase()==K||H[J].toLowerCase()==K||L[J].toLowerCase()==K){return J;}}return -1;};B.getMonthNumberFromName=function(I){var L=D.monthNames,H=D.abbreviatedMonthNames,K=I.toLowerCase();for(var J=0;J<L.length;J++){if(L[J].toLowerCase()==K||H[J].toLowerCase()==K){return J;}}return -1;};B.isLeapYear=function(H){return((H%4===0&&H%100!==0)||H%400===0);};B.getDaysInMonth=function(H,I){return[31,(B.isLeapYear(H)?29:28),31,30,31,30,31,31,30,31,30,31][I];};B.getTimezoneAbbreviation=function(K){var J=D.timezones,I;for(var H=0;H<J.length;H++){if(J[H].offset===K){return J[H].name;}}return null;};B.getTimezoneOffset=function(H){var K=D.timezones,J;for(var I=0;I<K.length;I++){if(K[I].name===H.toUpperCase()){return K[I].offset;}}return null;};A.clone=function(){return new Date(this.getTime());};A.compareTo=function(H){return Date.compare(this,H);};A.equals=function(H){return Date.equals(this,H||new Date());};A.between=function(I,H){return this.getTime()>=I.getTime()&&this.getTime()<=H.getTime();};A.isAfter=function(H){return this.compareTo(H||new Date())===1;};A.isBefore=function(H){return(this.compareTo(H||new Date())===-1);};A.isToday=function(){return this.isSameDay(new Date());};A.isSameDay=function(H){return this.clone().clearTime().equals(H.clone().clearTime());};A.addMilliseconds=function(H){this.setMilliseconds(this.getMilliseconds()+H);return this;};A.addSeconds=function(H){return this.addMilliseconds(H*1000);};A.addMinutes=function(H){return this.addMilliseconds(H*60000);};A.addHours=function(H){return this.addMilliseconds(H*3600000);};A.addDays=function(H){this.setDate(this.getDate()+H);return this;};A.addWeeks=function(H){return this.addDays(H*7);};A.addMonths=function(H){var I=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+H);this.setDate(Math.min(I,B.getDaysInMonth(this.getFullYear(),this.getMonth())));return this;};A.addYears=function(H){return this.addMonths(H*12);};A.add=function(I){if(typeof I=="number"){this._orient=I;return this;}var H=I;if(H.milliseconds){this.addMilliseconds(H.milliseconds);}if(H.seconds){this.addSeconds(H.seconds);}if(H.minutes){this.addMinutes(H.minutes);}if(H.hours){this.addHours(H.hours);}if(H.weeks){this.addWeeks(H.weeks);}if(H.months){this.addMonths(H.months);}if(H.years){this.addYears(H.years);}if(H.days){this.addDays(H.days);}return this;};var E,F,C;A.getWeek=function(){var O,N,M,L,K,J,I,H,Q,P;E=(!E)?this.getFullYear():E;F=(!F)?this.getMonth()+1:F;C=(!C)?this.getDate():C;if(F<=2){O=E-1;N=(O/4|0)-(O/100|0)+(O/400|0);M=((O-1)/4|0)-((O-1)/100|0)+((O-1)/400|0);Q=N-M;K=0;J=C-1+(31*(F-1));}else{O=E;N=(O/4|0)-(O/100|0)+(O/400|0);M=((O-1)/4|0)-((O-1)/100|0)+((O-1)/400|0);Q=N-M;K=Q+1;J=C+((153*(F-3)+2)/5)+58+Q;}I=(O+N)%7;L=(J+I-K)%7;H=(J+3-L)|0;if(H<0){P=53-((I-Q)/5|0);}else{if(H>364+Q){P=1;}else{P=(H/7|0)+1;}}E=F=C=null;return P;};A.getISOWeek=function(){E=this.getUTCFullYear();F=this.getUTCMonth()+1;C=this.getUTCDate();return G(this.getWeek());};A.setWeek=function(H){return this.moveToDayOfWeek(1).addWeeks(H-this.getWeek());};B._validate=function(K,J,H,I){if(typeof K=="undefined"){return false;}else{if(typeof K!="number"){throw new TypeError(K+" is not a Number.");}else{if(K<J||K>H){throw new RangeError(K+" is not a valid value for "+I+".");}}}return true;};B.validateMillisecond=function(H){return B._validate(H,0,999,"millisecond");};B.validateSecond=function(H){return B._validate(H,0,59,"second");};B.validateMinute=function(H){return B._validate(H,0,59,"minute");};B.validateHour=function(H){return B._validate(H,0,23,"hour");};B.validateDay=function(I,H,J){return B._validate(I,1,B.getDaysInMonth(H,J),"day");};B.validateMonth=function(H){return B._validate(H,0,11,"month");};B.validateYear=function(H){return B._validate(H,0,9999,"year");};A.set=function(H){if(B.validateMillisecond(H.millisecond)){this.addMilliseconds(H.millisecond-this.getMilliseconds());}if(B.validateSecond(H.second)){this.addSeconds(H.second-this.getSeconds());}if(B.validateMinute(H.minute)){this.addMinutes(H.minute-this.getMinutes());}if(B.validateHour(H.hour)){this.addHours(H.hour-this.getHours());}if(B.validateMonth(H.month)){this.addMonths(H.month-this.getMonth());}if(B.validateYear(H.year)){this.addYears(H.year-this.getFullYear());}if(B.validateDay(H.day,this.getFullYear(),this.getMonth())){this.addDays(H.day-this.getDate());}if(H.timezone){this.setTimezone(H.timezone);}if(H.timezoneOffset){this.setTimezoneOffset(H.timezoneOffset);}if(H.week&&B._validate(H.week,0,53,"week")){this.setWeek(H.week);}return this;};A.moveToFirstDayOfMonth=function(){return this.set({day:1});};A.moveToLastDayOfMonth=function(){return this.set({day:B.getDaysInMonth(this.getFullYear(),this.getMonth())});};A.moveToNthOccurrence=function(I,J){var H=0;if(J>0){H=J-1;}else{if(J===-1){this.moveToLastDayOfMonth();if(this.getDay()!==I){this.moveToDayOfWeek(I,-1);}return this;}}return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(I,+1).addWeeks(H);};A.moveToDayOfWeek=function(H,I){var J=(H-this.getDay()+7*(I||+1))%7;return this.addDays((J===0)?J+=7*(I||+1):J);};A.moveToMonth=function(J,H){var I=(J-this.getMonth()+12*(H||+1))%12;return this.addMonths((I===0)?I+=12*(H||+1):I);};A.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1;};A.getTimezone=function(){return B.getTimezoneAbbreviation(this.getUTCOffset());};A.setTimezoneOffset=function(J){var H=this.getTimezoneOffset(),I=Number(J)*-6/10;return this.addMinutes(I-H);};A.setTimezone=function(H){return this.setTimezoneOffset(B.getTimezoneOffset(H));};A.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset());};A.isDaylightSavingTime=function(){return(this.hasDaylightSavingTime()&&new Date().getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset());};A.getUTCOffset=function(){var I=this.getTimezoneOffset()*-10/6,H;if(I<0){H=(I-10000).toString();return H.charAt(0)+H.substr(2);}else{H=(I+10000).toString();return"+"+H.substr(1);}};A.getElapsed=function(H){return(H||new Date())-this;};if(!A.toISOString){A.toISOString=function(){function H(I){return I<10?"0"+I:I;}return'"'+this.getUTCFullYear()+"-"+H(this.getUTCMonth()+1)+"-"+H(this.getUTCDate())+"T"+H(this.getUTCHours())+":"+H(this.getUTCMinutes())+":"+H(this.getUTCSeconds())+'Z"';};}A._toString=A.toString;A.toString=function(J){var H=this;if(J&&J.length==1){var K=D.formatPatterns;H.t=H.toString;switch(J){case"d":return H.t(K.shortDate);case"D":return H.t(K.longDate);case"F":return H.t(K.fullDateTime);case"m":return H.t(K.monthDay);case"r":return H.t(K.rfc1123);case"s":return H.t(K.sortableDateTime);case"t":return H.t(K.shortTime);case"T":return H.t(K.longTime);case"u":return H.t(K.universalSortableDateTime);case"y":return H.t(K.yearMonth);}}var I=function(L){switch(L*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th";}};return J?J.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(L){if(L.charAt(0)==="\\"){return L.replace("\\","");}H.h=H.getHours;switch(L){case"hh":return G(H.h()<13?(H.h()===0?12:H.h()):(H.h()-12));case"h":return H.h()<13?(H.h()===0?12:H.h()):(H.h()-12);case"HH":return G(H.h());case"H":return H.h();case"mm":return G(H.getMinutes());case"m":return H.getMinutes();case"ss":return G(H.getSeconds());case"s":return H.getSeconds();case"yyyy":return G(H.getFullYear(),4);case"yy":return G(H.getFullYear());case"dddd":return D.dayNames[H.getDay()];case"ddd":return D.abbreviatedDayNames[H.getDay()];case"dd":return G(H.getDate());case"d":return H.getDate();case"MMMM":return D.monthNames[H.getMonth()];case"MMM":return D.abbreviatedMonthNames[H.getMonth()];case"MM":return G((H.getMonth()+1));case"M":return H.getMonth()+1;case"t":return H.h()<12?D.amDesignator.substring(0,1):D.pmDesignator.substring(0,1);case"tt":return H.h()<12?D.amDesignator:D.pmDesignator;case"S":return I(H.getDate());default:return L;}}):this._toString();};}());(function(){var Q=Date,G=Q.prototype,R=Q.CultureInfo,K=Number.prototype;G._orient=+1;G._nth=null;G._is=false;G._same=false;G._isSecond=false;K._dateElement="day";G.next=function(){this._orient=+1;return this;};Q.next=function(){return Q.today().next();};G.last=G.prev=G.previous=function(){this._orient=-1;return this;};Q.last=Q.prev=Q.previous=function(){return Q.today().last();};G.is=function(){this._is=true;return this;};G.same=function(){this._same=true;this._isSecond=false;return this;};G.today=function(){return this.same().day();};G.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun());}return false;};G.at=function(W){return(typeof W==="string")?Q.parse(this.toString("d")+" "+W):this.set(W);};K.fromNow=K.after=function(W){var X={};X[this._dateElement]=this;return((!W)?new Date():W.clone()).add(X);};K.ago=K.before=function(W){var X={};X[this._dateElement]=this*-1;return((!W)?new Date():W.clone()).add(X);};var E=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),H=("january february march april may june july august september october november december").split(/\s/),J=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),L=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),B=("final first second third fourth fifth").split(/\s/),U;G.toObject=function(){var X={};for(var W=0;W<J.length;W++){X[J[W].toLowerCase()]=this["get"+L[W]]();}return X;};Q.fromObject=function(W){W.week=null;return Date.today().set(W);};var S=function(W){return function(){if(this._is){this._is=false;return this.getDay()==W;}if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1);}this._isSecond=false;var Y=this._nth;this._nth=null;var X=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(W,Y);if(this>X){throw new RangeError(Q.getDayName(W)+" does not occur "+Y+" times in the month of "+Q.getMonthName(X.getMonth())+" "+X.getFullYear()+".");}return this;}return this.moveToDayOfWeek(W,this._orient);};};var F=function(W){return function(){var Y=Q.today(),X=W-Y.getDay();if(W===0&&R.firstDayOfWeek===1&&Y.getDay()!==0){X=X+7;}return Y.addDays(X);};};for(var P=0;P<E.length;P++){Q[E[P].toUpperCase()]=Q[E[P].toUpperCase().substring(0,3)]=P;Q[E[P]]=Q[E[P].substring(0,3)]=F(P);G[E[P]]=G[E[P].substring(0,3)]=S(P);}var V=function(W){return function(){if(this._is){this._is=false;return this.getMonth()===W;}return this.moveToMonth(W,this._orient);};};var I=function(W){return function(){return Q.today().set({month:W,day:1});};};for(var O=0;O<H.length;O++){Q[H[O].toUpperCase()]=Q[H[O].toUpperCase().substring(0,3)]=O;Q[H[O]]=Q[H[O].substring(0,3)]=I(O);G[H[O]]=G[H[O].substring(0,3)]=V(O);}var C=function(W){return function(){if(this._isSecond){this._isSecond=false;return this;}if(this._same){this._same=this._is=false;var b=this.toObject(),a=(arguments[0]||new Date()).toObject(),Z="",Y=W.toLowerCase();for(var X=(J.length-1);X>-1;X--){Z=J[X].toLowerCase();if(b[Z]!=a[Z]){return false;}if(Y==Z){break;}}return true;}if(W.substring(W.length-1)!="s"){W+="s";}return this["add"+W](this._orient);};};var D=function(W){return function(){this._dateElement=W;return this;};};for(var N=0;N<J.length;N++){U=J[N].toLowerCase();G[U]=G[U+"s"]=C(J[N]);K[U]=K[U+"s"]=D(U);}G._ss=C("Second");var A=function(W){return function(X){if(this._same){return this._ss(arguments[0]);}if(X||X===0){return this.moveToNthOccurrence(X,W);}this._nth=W;if(W===2&&(X===undefined||X===null)){this._isSecond=true;return this.addSeconds(this._orient);}return this;};};for(var M=0;M<B.length;M++){G[B[M]]=(M===0)?A(-1):A(M);}}());(function(){Date.Parsing={Exception:function(I){this.message="Parse error at '"+I.substring(0,10)+" ...'";}};var A=Date.Parsing;var C=A.Operators={rtoken:function(I){return function(J){var K=J.match(I);if(K){return([K[0],J.substring(K[0].length)]);}else{throw new A.Exception(J);}};},token:function(I){return function(J){return C.rtoken(new RegExp("^s*"+J+"s*"))(J);};},stoken:function(I){return C.rtoken(new RegExp("^"+I));},until:function(I){return function(J){var K=[],M=null;while(J.length){try{M=I.call(this,J);}catch(L){K.push(M[0]);J=M[1];continue;}break;}return[K,J];};},many:function(I){return function(J){var M=[],K=null;while(J.length){try{K=I.call(this,J);}catch(L){return[M,J];}M.push(K[0]);J=K[1];}return[M,J];};},optional:function(I){return function(J){var K=null;try{K=I.call(this,J);}catch(L){return[null,J];}return[K[0],K[1]];};},not:function(I){return function(J){try{I.call(this,J);}catch(K){return[null,J];}throw new A.Exception(J);};},ignore:function(I){return I?function(J){var K=null;K=I.call(this,J);return[null,K[1]];}:null;},product:function(){var J=arguments[0],K=Array.prototype.slice.call(arguments,1),L=[];for(var I=0;I<J.length;I++){L.push(C.each(J[I],K));}return L;},cache:function(K){var I={},J=null;return function(L){try{J=I[L]=(I[L]||K.call(this,L));}catch(M){J=I[L]=M;}if(J instanceof A.Exception){throw J;}else{return J;}};},any:function(){var I=arguments;return function(K){var L=null;for(var J=0;J<I.length;J++){if(I[J]==null){continue;}try{L=(I[J].call(this,K));}catch(M){L=null;}if(L){return L;}}throw new A.Exception(K);};},each:function(){var I=arguments;return function(K){var N=[],L=null;for(var J=0;J<I.length;J++){if(I[J]==null){continue;}try{L=(I[J].call(this,K));}catch(M){throw new A.Exception(K);}N.push(L[0]);K=L[1];}return[N,K];};},all:function(){var J=arguments,I=I;return I.each(I.optional(J));},sequence:function(I,J,K){J=J||C.rtoken(/^\s*/);K=K||null;if(I.length==1){return I[0];}return function(O){var P=null,Q=null;var S=[];for(var N=0;N<I.length;N++){try{P=I[N].call(this,O);}catch(R){break;}S.push(P[0]);try{Q=J.call(this,P[1]);}catch(M){Q=null;break;}O=Q[1];}if(!P){throw new A.Exception(O);}if(Q){throw new A.Exception(Q[1]);}if(K){try{P=K.call(this,P[1]);}catch(L){throw new A.Exception(P[1]);}}return[S,(P?P[1]:O)];};},between:function(J,K,I){I=I||J;var L=C.each(C.ignore(J),K,C.ignore(I));return function(M){var N=L.call(this,M);return[[N[0][0],r[0][2]],N[1]];};},list:function(I,J,K){J=J||C.rtoken(/^\s*/);K=K||null;return(I instanceof Array?C.each(C.product(I.slice(0,-1),C.ignore(J)),I.slice(-1),C.ignore(K)):C.each(C.many(C.each(I,C.ignore(J))),px,C.ignore(K)));},set:function(I,J,K){J=J||C.rtoken(/^\s*/);K=K||null;return function(Y){var L=null,N=null,M=null,O=null,P=[[],Y],X=false;for(var R=0;R<I.length;R++){M=null;N=null;L=null;X=(I.length==1);try{L=I[R].call(this,Y);}catch(V){continue;}O=[[L[0]],L[1]];if(L[1].length>0&&!X){try{M=J.call(this,L[1]);}catch(W){X=true;}}else{X=true;}if(!X&&M[1].length===0){X=true;}if(!X){var S=[];for(var Q=0;Q<I.length;Q++){if(R!=Q){S.push(I[Q]);}}N=C.set(S,J).call(this,M[1]);if(N[0].length>0){O[0]=O[0].concat(N[0]);O[1]=N[1];}}if(O[1].length<P[1].length){P=O;}if(P[1].length===0){break;}}if(P[0].length===0){return P;}if(K){try{M=K.call(this,P[1]);}catch(U){throw new A.Exception(P[1]);}P[1]=M[1];}return P;};},forward:function(I,J){return function(K){return I[J].call(this,K);};},replace:function(J,I){return function(K){var L=J.call(this,K);return[I,L[1]];};},process:function(J,I){return function(K){var L=J.call(this,K);return[I.call(this,L[0]),L[1]];};},min:function(I,J){return function(K){var L=J.call(this,K);if(L[0].length<I){throw new A.Exception(K);}return L;};}};var H=function(I){return function(){var J=null,M=[];if(arguments.length>1){J=Array.prototype.slice.call(arguments);}else{if(arguments[0] instanceof Array){J=arguments[0];}}if(J){for(var L=0,K=J.shift();L<K.length;L++){J.unshift(K[L]);M.push(I.apply(null,J));J.shift();return M;}}else{return I.apply(null,arguments);}};};var G="optional not ignore cache".split(/\s/);for(var D=0;D<G.length;D++){C[G[D]]=H(C[G[D]]);}var F=function(I){return function(){if(arguments[0] instanceof Array){return I.apply(null,arguments[0]);}else{return I.apply(null,arguments);}};};var E="each any all".split(/\s/);for(var B=0;B<E.length;B++){C[E[B]]=F(C[E[B]]);}}());(function(){var E=Date,K=E.prototype,F=E.CultureInfo;var G=function(M){var N=[];for(var L=0;L<M.length;L++){if(M[L] instanceof Array){N=N.concat(G(M[L]));}else{if(M[L]){N.push(M[L]);}}}return N;};E.Grammar={};E.Translator={hour:function(L){return function(){this.hour=Number(L);};},minute:function(L){return function(){this.minute=Number(L);};},second:function(L){return function(){this.second=Number(L);};},meridian:function(L){return function(){this.meridian=L.slice(0,1).toLowerCase();};},timezone:function(L){return function(){var M=L.replace(/[^\d\+\-]/g,"");if(M.length){this.timezoneOffset=Number(M);}else{this.timezone=L.toLowerCase();}};},day:function(L){var M=L[0];return function(){this.day=Number(M.match(/\d+/)[0]);};},month:function(L){return function(){this.month=(L.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(L)/4:Number(L)-1;};},year:function(L){return function(){var M=Number(L);this.year=((L.length>2)?M:(M+(((M+2000)<F.twoDigitYearMax)?2000:1900)));};},rday:function(L){return function(){switch(L){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break;}};},finishExact:function(L){L=(L instanceof Array)?L:[L];for(var N=0;N<L.length;N++){if(L[N]){L[N].call(this);}}var M=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=M.getDate();}if(!this.year){this.year=M.getFullYear();}if(!this.month&&this.month!==0){this.month=M.getMonth();}if(!this.day){this.day=1;}if(!this.hour){this.hour=0;}if(!this.minute){this.minute=0;}if(!this.second){this.second=0;}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12;}else{if(this.meridian=="a"&&this.hour==12){this.hour=0;}}}if(this.day>E.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.");}var O=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){O.set({timezone:this.timezone});}else{if(this.timezoneOffset){O.set({timezoneOffset:this.timezoneOffset});}}return O;},finish:function(L){L=(L instanceof Array)?G(L):[L];if(L.length===0){return null;}for(var Q=0;Q<L.length;Q++){if(typeof L[Q]=="function"){L[Q].call(this);}}var N=E.today();if(this.now&&!this.unit&&!this.operator){return new Date();}else{if(this.now){N=new Date();}}var R=!!(this.days&&this.days!==null||this.orient||this.operator);var S,P,O;O=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){N.setTimeToNow();}if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;R=true;}}if(!R&&this.weekday&&!this.day&&!this.days){var M=Date[this.weekday]();this.day=M.getDate();if(!this.month){this.month=M.getMonth();}this.year=M.getFullYear();}if(R&&this.weekday&&this.unit!="month"){this.unit="day";S=(E.getDayNumberFromName(this.weekday)-N.getDay());P=7;this.days=S?((S+(O*P))%P):(O*P);}if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null;}if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1;}if(this.month&&!this.day&&this.value){N.set({day:this.value*1});if(!R){this.day=this.value*1;}}if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;R=true;}if(R&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";S=(this.month-N.getMonth());P=12;this.months=S?((S+(O*P))%P):(O*P);this.month=null;}if(!this.unit){this.unit="day";}if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*O;}else{if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1;}this[this.unit+"s"]=this.value*O;}}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12;}else{if(this.meridian=="a"&&this.hour==12){this.hour=0;}}}if(this.weekday&&!this.day&&!this.days){var M=Date[this.weekday]();this.day=M.getDate();if(M.getMonth()!==N.getMonth()){this.month=M.getMonth();}}if((this.month||this.month===0)&&!this.day){this.day=1;}if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value);}if(R&&this.timezone&&this.day&&this.days){this.day=this.days;}return(R)?N.add(this):N.set(this);}};var H=E.Parsing.Operators,D=E.Grammar,J=E.Translator,B;D.datePartDelimiter=H.rtoken(/^([\s\-\.\,\/\x27]+)/);D.timePartDelimiter=H.stoken(":");D.whiteSpace=H.rtoken(/^\s*/);D.generalDelimiter=H.rtoken(/^(([\s\,]|at|@|on)+)/);var A={};D.ctoken=function(P){var O=A[P];if(!O){var Q=F.regexPatterns;var N=P.split(/\s+/),M=[];for(var L=0;L<N.length;L++){M.push(H.replace(H.rtoken(Q[N[L]]),N[L]));}O=A[P]=H.any.apply(null,M);}return O;};D.ctoken2=function(L){return H.rtoken(F.regexPatterns[L]);};D.h=H.cache(H.process(H.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),J.hour));D.hh=H.cache(H.process(H.rtoken(/^(0[0-9]|1[0-2])/),J.hour));D.H=H.cache(H.process(H.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),J.hour));D.HH=H.cache(H.process(H.rtoken(/^([0-1][0-9]|2[0-3])/),J.hour));D.m=H.cache(H.process(H.rtoken(/^([0-5][0-9]|[0-9])/),J.minute));D.mm=H.cache(H.process(H.rtoken(/^[0-5][0-9]/),J.minute));D.s=H.cache(H.process(H.rtoken(/^([0-5][0-9]|[0-9])/),J.second));D.ss=H.cache(H.process(H.rtoken(/^[0-5][0-9]/),J.second));D.hms=H.cache(H.sequence([D.H,D.m,D.s],D.timePartDelimiter));D.t=H.cache(H.process(D.ctoken2("shortMeridian"),J.meridian));D.tt=H.cache(H.process(D.ctoken2("longMeridian"),J.meridian));D.z=H.cache(H.process(H.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),J.timezone));D.zz=H.cache(H.process(H.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),J.timezone));D.zzz=H.cache(H.process(D.ctoken2("timezone"),J.timezone));D.timeSuffix=H.each(H.ignore(D.whiteSpace),H.set([D.tt,D.zzz]));D.time=H.each(H.optional(H.ignore(H.stoken("T"))),D.hms,D.timeSuffix);D.d=H.cache(H.process(H.each(H.rtoken(/^([0-2]\d|3[0-1]|\d)/),H.optional(D.ctoken2("ordinalSuffix"))),J.day));D.dd=H.cache(H.process(H.each(H.rtoken(/^([0-2]\d|3[0-1])/),H.optional(D.ctoken2("ordinalSuffix"))),J.day));D.ddd=D.dddd=H.cache(H.process(D.ctoken("sun mon tue wed thu fri sat"),function(L){return function(){this.weekday=L;};}));D.M=H.cache(H.process(H.rtoken(/^(1[0-2]|0\d|\d)/),J.month));D.MM=H.cache(H.process(H.rtoken(/^(1[0-2]|0\d)/),J.month));D.MMM=D.MMMM=H.cache(H.process(D.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),J.month));D.y=H.cache(H.process(H.rtoken(/^(\d\d?)/),J.year));D.yy=H.cache(H.process(H.rtoken(/^(\d\d)/),J.year));D.yyy=H.cache(H.process(H.rtoken(/^(\d\d?\d?\d?)/),J.year));D.yyyy=H.cache(H.process(H.rtoken(/^(\d\d\d\d)/),J.year));B=function(){return H.each(H.any.apply(null,arguments),H.not(D.ctoken2("timeContext")));};D.day=B(D.d,D.dd);D.month=B(D.M,D.MMM);D.year=B(D.yyyy,D.yy);D.orientation=H.process(D.ctoken("past future"),function(L){return function(){this.orient=L;};});D.operator=H.process(D.ctoken("add subtract"),function(L){return function(){this.operator=L;};});D.rday=H.process(D.ctoken("yesterday tomorrow today now"),J.rday);D.unit=H.process(D.ctoken("second minute hour day week month year"),function(L){return function(){this.unit=L;};});D.value=H.process(H.rtoken(/^\d\d?(st|nd|rd|th)?/),function(L){return function(){this.value=L.replace(/\D/g,"");};});D.expression=H.set([D.rday,D.operator,D.value,D.unit,D.orientation,D.ddd,D.MMM]);B=function(){return H.set(arguments,D.datePartDelimiter);};D.mdy=B(D.ddd,D.month,D.day,D.year);D.ymd=B(D.ddd,D.year,D.month,D.day);D.dmy=B(D.ddd,D.day,D.month,D.year);D.date=function(L){return((D[F.dateElementOrder]||D.mdy).call(this,L));};D.format=H.process(H.many(H.any(H.process(H.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(L){if(D[L]){return D[L];}else{throw E.Parsing.Exception(L);}}),H.process(H.rtoken(/^[^dMyhHmstz]+/),function(L){return H.ignore(H.stoken(L));}))),function(L){return H.process(H.each.apply(null,L),J.finishExact);});var I={};var C=function(L){return I[L]=(I[L]||D.format(L)[0]);};D.formats=function(M){if(M instanceof Array){var N=[];for(var L=0;L<M.length;L++){N.push(C(M[L]));}return H.any.apply(null,N);}else{return C(M);}};D._formats=D.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]);D._start=H.process(H.set([D.date,D.time,D.expression],D.generalDelimiter,D.whiteSpace),J.finish);D.start=function(L){try{var M=D._formats.call({},L);if(M[1].length===0){return M;}}catch(N){}return D._start.call({},L);};E._parse=E.parse;E.parse=function(L){var M=null;if(!L){return null;}if(L instanceof Date){return L;}try{M=E.Grammar.start.call({},L.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"));}catch(N){return null;}return((M[1].length===0)?M[0]:null);};E.getParseFunction=function(M){var L=E.Grammar.formats(M);return function(N){var O=null;try{O=L.call({},N);}catch(P){return null;}return((O[1].length===0)?O[0]:null);};};E.parseExact=function(L,M){return E.getParseFunction(M)(L);};}());}());